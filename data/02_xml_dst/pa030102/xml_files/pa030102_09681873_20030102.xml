<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030000205A1-20030102-M00001.NB SYSTEM "US20030000205A1-20030102-M00001.NB" NDATA NB>
<!ENTITY US20030000205A1-20030102-M00001.TIF SYSTEM "US20030000205A1-20030102-M00001.TIF" NDATA TIF>
<!ENTITY US20030000205A1-20030102-M00002.NB SYSTEM "US20030000205A1-20030102-M00002.NB" NDATA NB>
<!ENTITY US20030000205A1-20030102-M00002.TIF SYSTEM "US20030000205A1-20030102-M00002.TIF" NDATA TIF>
<!ENTITY US20030000205A1-20030102-D00000.TIF SYSTEM "US20030000205A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030000205A1-20030102-D00001.TIF SYSTEM "US20030000205A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030000205A1-20030102-D00002.TIF SYSTEM "US20030000205A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030000205A1-20030102-D00003.TIF SYSTEM "US20030000205A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030000205A1-20030102-D00004.TIF SYSTEM "US20030000205A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030000205A1-20030102-D00005.TIF SYSTEM "US20030000205A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030000205A1-20030102-D00006.TIF SYSTEM "US20030000205A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030000205A1-20030102-D00007.TIF SYSTEM "US20030000205A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030000205A1-20030102-D00008.TIF SYSTEM "US20030000205A1-20030102-D00008.TIF" NDATA TIF>
<!ENTITY US20030000205A1-20030102-D00009.TIF SYSTEM "US20030000205A1-20030102-D00009.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030000205</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>09681873</doc-number>
</application-number>
<application-number-series-code>09</application-number-series-code>
<filing-date>20010620</filing-date>
</domestic-filing-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>F01N003/00</ipc>
</classification-ipc-primary>
<classification-ipc-secondary>
<ipc>F01N007/00</ipc>
</classification-ipc-secondary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>060</class>
<subclass>285000</subclass>
</uspc>
</classification-us-primary>
<classification-us-secondary>
<uspc>
<class>060</class>
<subclass>277000</subclass>
</uspc>
</classification-us-secondary>
<classification-us-secondary>
<uspc>
<class>060</class>
<subclass>274000</subclass>
</uspc>
</classification-us-secondary>
</classification-us>
<title-of-invention>System and method for determining set point location for oxidant-based engine air/fuel control strategy</title-of-invention>
</technical-information>
<inventors>
<first-named-inventor>
<name>
<given-name>Donald</given-name>
<middle-name>James</middle-name>
<family-name>Lewis</family-name>
</name>
<residence>
<residence-us>
<city>Brighton</city>
<state>MI</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Kevin</given-name>
<middle-name>Ronald</middle-name>
<family-name>Carlstrom</family-name>
</name>
<residence>
<residence-us>
<city>Fort Wayne</city>
<state>IN</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Stanley</given-name>
<middle-name>Larue</middle-name>
<family-name>Bower</family-name>
<name-suffix>JR.</name-suffix>
</name>
<residence>
<residence-us>
<city>Ann Arbor</city>
<state>MI</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Stephen</given-name>
<middle-name>L.</middle-name>
<family-name>Hahn</family-name>
</name>
<residence>
<residence-us>
<city>Novi</city>
<state>MI</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<correspondence-address>
<name-1>FORD GLOBAL TECHNOLOGIES, INC</name-1>
<name-2></name-2>
<address>
<address-1>SUITE 600 - PARKLANE TOWERS EAST</address-1>
<address-2>ONE PARKLANE BLVD.</address-2>
<city>DEARBORN</city>
<state>MI</state>
<postalcode>48126</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">The invention relates to a new method and system for optimizing the efficiency of an automotive catalytic converter by adjusting the engine air/fuel ratio based on estimates of the actual amount of oxidants stored in the catalyst. An available oxidant storage capacity of the catalyst is determined by establishing an oxidant set point location, i.e., a location in the catalyst about which the system controls the oxidant storage. The oxidant set point is established based on the temperatures of the different potential set point locations and the levels of deterioration of the different potential set point locations, as well as the oxidant storage capacity of the emission control device system. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">BACKGROUND OF INVENTION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> The present invention relates generally to adjusting the air/fuel ratio in the cylinders of an internal combustion engine to control automotive emissions. More particularly, the present invention relates to a method and system for determining an oxidant set point location inside of a catalytic converter that is used in connection with a system that adjusts the air/fuel ratio in the cylinders based on the amount of oxidants stored in the catalytic converter. </paragraph>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> To minimize the amount of emissions exhausted into the atmosphere, modern automotive vehicles generally include one or more catalytic converters, or emission control devices, in the exhaust system of the vehicle. These emission control devices store oxygen and NOx (collectively, oxidants) from the vehicle exhaust stream when the engine is operated with a relatively lean air/fuel ratio. On the other hand, when the engine is operated with a relatively rich air/fuel ratio, they release the stored oxygen and NOx, which then react with the HC and CO produced by the engine. In this way, the emission of both NOx and hydrocarbons (HC and CO) into the atmosphere is minimized. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> The inventors have recognized a disadvantage with conventional air-fuel ratio control systems. In particular, the inventors have recognized that these systems attempt to maintain the engine at stoichiometry (or another desired air-fuel ratio). However, this has the disadvantage that engine air-fuel control is decoupled from the state of oxidant storage of the emission control device. The convention system relies on air-fuel feedback to compensate for this oversight. </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> To overcome disadvantages with prior approaches, the inventors have developed a method for controlling the engine air-fuel ratio to maintain the oxidant level stored in the emission system at a desired set-point level. However, the inventors have further recognized that there is another dimension to the emission system, namely the depth into catalyst along the direction of flow. I.e., oxidants are stored in different proportions depending on the depth, or length, of the catalyst brick. For example, at the front face of a catalyst brick, there is a high chance of oxidants being stored than at the back of the brick. As such, a control system that controls the engine based on the oxidants stored in the emission control device should consider where along the depth of the catalyst the set-point is chosen. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF INVENTION </heading>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> The above disadvantages are overcome by a method for controlling engine air-fuel ratio of an engine coupled to an emission control device having a predetermined length in a direction of exhaust flow. The method comprises: </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> selecting a position along the length of the emission control device; and </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> adjusting an operating parameter that affects engine air-fuel ratio based on an amount of oxidants stored in the emission control device and said position. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> By selecting a location along the length of the catalyst for use in adjusting engine air-fuel ratio, it is possible to provide a minimum amount of oxidants storage reserve to account for oxidant storage control errors, while at the same compensating for changes in catalyst temperature and catalyst degradation. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> In other words, oxidant storage capacity of a catalytic converter varies largely dependent on catalyst temperature and deterioration. Further, bricks in a multiple-brick catalytic converter tend to heat up (increasing their capacity) and deteriorate (decreasing their capacity) from the front of the catalytic converter to the rear. The inventive system for controlling engine air/fuel ratio recognizes that the available oxidant storage capacity of the catalyst is that which exists forward of the oxidant set point location. The present invention can then adjust the set point location in the catalyst based on the temperatures of the catalyst bricks, as well as their levels of deterioration. Specifically, the set point location starts out being positioned just behind the front-most brick in the catalyst. If the temperature of the second brick is sufficiently high to provide adequate oxidant storage capability, or if the deterioration level of the first brick exceeds a certain reference level, then the set point location is moved to just behind the second brick. This process is repeated for all of the bricks in the catalytic converter until a set point location is determined. The set point location also depends upon there being sufficient oxidant reserve capacity in the bricks positioned behind the set point. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> Thus, by maintaining sufficient, but not excessive, reserve capacity behind the selected control position, improved performance results. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> Note that the selection of the position along the catalyst length can be performed in various ways. The example outlined above is merely one example. Another example would be to select the position based on time since engine start. Further, a single location could be chosen for all vehicle operating conditions that compromises performance and simplicity in engine control. </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> Also note there are various ways to adjust an operating parameter that affects engine air-fuel ratio based on an amount of oxidants stored in the emission control device and said position. For example, fuel injection or engine airflow can be adjusted. As another example, engine breathing can be adjusted by changing engine valve timing. Further still, engine air-fuel ratio can be adjusted by adjusting fuel vapor purging, fuel injector pressure, or the number of fuel injections.</paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF DRAWINGS </heading>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is an illustrative block diagram of an internal combustion engine, according to a preferred embodiment of the invention. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a schematic diagram illustrating the major functions of a preferred embodiment of the invented system and method. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a flowchart that illustrates a preferred embodiment of the available oxidant storage estimator algorithm of the present invention. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a flowchart that illustrates a preferred embodiment of the oxidant set point location algorithm of the present invention. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is a schematic diagram illustrating the operation of the oxidant set point generator algorithm of the present invention. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a flowchart that illustrates a preferred embodiment of the current oxidant level estimator algorithm of the present invention. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> F<cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a schematic diagram illustrating the operation of the oxidant level/capacity controller algorithm of the present invention. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> F<cross-reference target="DRAWINGS">FIG. 8A</cross-reference> is a graph that illustrates the relationship between the temperature of a catalytic converter and a variable, C<highlight><subscript>1</subscript></highlight>, that is used to estimate an amount of oxidants stored in the catalytic converter. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> F<cross-reference target="DRAWINGS">FIG. 8B</cross-reference> is a graph that illustrates the relationship between the age of a catalytic converter and a variable, C<highlight><subscript>2</subscript></highlight>, that is used to estimate an amount of oxidants stored in the catalytic converter. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> F<cross-reference target="DRAWINGS">FIG. 8C</cross-reference> is a graph that illustrates the relationship between engine mass air flow and a variable, C<highlight><subscript>3</subscript></highlight>, that is used to estimate an amount of oxidants stored in the catalytic converter. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> F<cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a schematic diagram of an exemplary catalytic converter comprising three internal bricks. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> F<cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a graph that illustrates the relationship between flange temperature and spark retard gain. </paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION </heading>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> F<cross-reference target="DRAWINGS">FIG. 1</cross-reference> illustrates an exemplary internal combustion engine according to a preferred embodiment of the invention. Fuel delivery system <highlight><bold>11</bold></highlight> of a conventional automotive internal combustion engine <highlight><bold>13</bold></highlight> is controlled by controller <highlight><bold>15</bold></highlight>, such as an EEC or PCM. Engine <highlight><bold>13</bold></highlight> comprises fuel injectors <highlight><bold>18</bold></highlight>, which are in fluid communication with fuel rail <highlight><bold>22</bold></highlight> to inject fuel into the cylinders (not shown) of engine <highlight><bold>13</bold></highlight>, and temperature sensor <highlight><bold>132</bold></highlight> for sensing temperature of engine <highlight><bold>13</bold></highlight>. Fuel delivery system <highlight><bold>11</bold></highlight> has fuel rail <highlight><bold>22</bold></highlight>, fuel rail pressure sensor <highlight><bold>33</bold></highlight> connected to fuel rail <highlight><bold>22</bold></highlight>, fuel line <highlight><bold>40</bold></highlight> coupled to fuel rail <highlight><bold>22</bold></highlight> via coupling <highlight><bold>41</bold></highlight>, fuel delivery system <highlight><bold>42</bold></highlight>, which is housed within fuel tank <highlight><bold>44</bold></highlight>, to selectively deliver fuel to fuel rail <highlight><bold>22</bold></highlight> via fuel line <highlight><bold>40</bold></highlight>. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> EEngine <highlight><bold>13</bold></highlight> also comprises exhaust manifold <highlight><bold>48</bold></highlight> coupled to exhaust ports of the engine (not shown). Catalytic converter <highlight><bold>52</bold></highlight> is coupled to exhaust manifold <highlight><bold>48</bold></highlight>. In the preferred embodiment, catalytic converter <highlight><bold>52</bold></highlight> is a multiple brick catalyst. <cross-reference target="DRAWINGS">FIG. 9</cross-reference> illustrates an exemplary multiple brick catalyst having three bricks, <highlight><bold>52</bold></highlight>A, <highlight><bold>52</bold></highlight>B, and <highlight><bold>52</bold></highlight>C. Oxygen sensors <highlight><bold>902</bold></highlight>, <highlight><bold>904</bold></highlight>, and <highlight><bold>906</bold></highlight>, preferably being EGO, UEGO or HEGO sensors, are positioned respectively behind bricks <highlight><bold>52</bold></highlight>A, <highlight><bold>52</bold></highlight>B, and <highlight><bold>52</bold></highlight>C. Referring again to <cross-reference target="DRAWINGS">FIG. 1, a</cross-reference> first conventional exhaust gas oxygen (EGO) sensor <highlight><bold>54</bold></highlight> is positioned upstream of catalytic converter <highlight><bold>52</bold></highlight> in exhaust manifold <highlight><bold>48</bold></highlight>. A second conventional exhaust gas oxygen (EGO) sensor <highlight><bold>53</bold></highlight> is positioned downstream of catalytic converter <highlight><bold>52</bold></highlight> in exhaust manifold <highlight><bold>48</bold></highlight>. EGO sensors <highlight><bold>53</bold></highlight> and <highlight><bold>54</bold></highlight> may comprise other known oxygen or air/fuel ratio sensors, such as HEGO or UEGO sensors. Engine <highlight><bold>13</bold></highlight> further comprises intake manifold <highlight><bold>56</bold></highlight> coupled to throttle body <highlight><bold>58</bold></highlight> having throttle plate <highlight><bold>60</bold></highlight> therein. Intake manifold <highlight><bold>56</bold></highlight> is also coupled to vapor recovery system <highlight><bold>70</bold></highlight>. </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> VVapor recovery system <highlight><bold>70</bold></highlight> comprises charcoal canister <highlight><bold>72</bold></highlight> coupled to fuel tank <highlight><bold>44</bold></highlight> via fuel tank connection line <highlight><bold>74</bold></highlight>. Vapor recovery system <highlight><bold>70</bold></highlight> also comprises vapor control valve <highlight><bold>78</bold></highlight> positioned in intake vapor line <highlight><bold>76</bold></highlight> between intake manifold <highlight><bold>56</bold></highlight> and charcoal canister <highlight><bold>72</bold></highlight>. </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> CController <highlight><bold>15</bold></highlight> has CPU <highlight><bold>114</bold></highlight>, random access memory <highlight><bold>116</bold></highlight> (RAM), computer storage medium <highlight><bold>118</bold></highlight> (ROM), having a computer readable code encoded therein, which is an electronically programmable chip in this example, and input/output (I/O) bus <highlight><bold>120</bold></highlight>. Controller <highlight><bold>15</bold></highlight> controls engine <highlight><bold>13</bold></highlight> by receiving various inputs through I/O bus <highlight><bold>120</bold></highlight>, such as fuel pressure in fuel delivery system <highlight><bold>11</bold></highlight>, as sensed by pressure sensor <highlight><bold>33</bold></highlight>; relative exhaust air/fuel ratio as sensed by EGO sensor <highlight><bold>54</bold></highlight> and EGO sensor <highlight><bold>53</bold></highlight>, temperature of engine <highlight><bold>13</bold></highlight> as sensed by temperature sensor <highlight><bold>132</bold></highlight>, measurement of inducted mass airflow (MAF) from mass airflow sensor <highlight><bold>158</bold></highlight>, speed of engine (RPM) from engine speed sensor <highlight><bold>160</bold></highlight>, and various other sensors <highlight><bold>156</bold></highlight>. Controller <highlight><bold>15</bold></highlight> also creates various outputs through I/O bus <highlight><bold>120</bold></highlight> to actuate the various components of the engine control system. Such components include fuel injectors <highlight><bold>18</bold></highlight>, fuel delivery system <highlight><bold>42</bold></highlight>, and vapor control valve <highlight><bold>78</bold></highlight>. It should be noted that the fuel may comprise liquid fuel, in which case fuel delivery system <highlight><bold>42</bold></highlight> is an electronic fuel pump. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> FFuel delivery control system <highlight><bold>42</bold></highlight>, upon demand from engine <highlight><bold>13</bold></highlight> and under control of controller <highlight><bold>15</bold></highlight>, pumps fuel from fuel tank <highlight><bold>44</bold></highlight> through fuel line <highlight><bold>40</bold></highlight>, and into pressure fuel rail <highlight><bold>22</bold></highlight> for distribution to the fuel injectors during conventional operation. Controller <highlight><bold>15</bold></highlight> controls fuel injectors <highlight><bold>18</bold></highlight> to maintain a desired air/fuel (A/F) ratio. </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> RReferring now to the logical block diagram of <cross-reference target="DRAWINGS">FIG. 2, a</cross-reference> preferred embodiment of the invented method of and system for controlling various engine parameters, including the air/fuel ratio in the engine cylinders, engine spark and air mass flow, is described. <cross-reference target="DRAWINGS">FIG. 2</cross-reference> illustrates an overview of the invented system and method. Generally speaking, an object of the invention is to adjust the engine air/fuel ratio in such a manner as to maintain the oxidants stored in the catalyst <highlight><bold>52</bold></highlight> at or near a target oxidant set point. The oxidant set point can be determined in a variety of ways depending on the objectives of the engine control strategy. In a preferred embodiment of the invention, the oxidant set point is determined and adjusted dynamically in response to engine operating parameters. Another object of the invention is to control the oxidant storage capacity of the catalyst <highlight><bold>52</bold></highlight> by controlling the catalyst temperature through adjusting engine operating parameters, such as engine spark and induction air mass flow (MAF). </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> BBlocks <highlight><bold>202</bold></highlight> through <highlight><bold>222</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 2</cross-reference> identify the following input variables to the invented system: air mass flow in the intake manifold (<highlight><bold>202</bold></highlight>); engine speed (<highlight><bold>204</bold></highlight>); vehicle speed (<highlight><bold>206</bold></highlight>); catalyst temperature (<highlight><bold>208</bold></highlight>); catalyst age (<highlight><bold>210</bold></highlight>); exhaust air/fuel ratio (<highlight><bold>212</bold></highlight>); oxidant levels behind each brick in a multi-brick catalyst <highlight><bold>52</bold></highlight> (<highlight><bold>214</bold></highlight>); spark limits (<highlight><bold>216</bold></highlight>); throttle position (<highlight><bold>218</bold></highlight>); exhaust flange temperature (<highlight><bold>220</bold></highlight>); and mbt spark (minimum spark for best torque)(<highlight><bold>222</bold></highlight>). One skilled in the art will recognize that these system inputs can be measured, either directly or indirectly, or mathematically estimated according to various methods known in the art. Blocks <highlight><bold>224</bold></highlight>, <highlight><bold>226</bold></highlight>, <highlight><bold>228</bold></highlight>, <highlight><bold>230</bold></highlight>, and <highlight><bold>232</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 2</cross-reference> represent the major algorithms of the invented system, according to a preferred embodiment. </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> BBlock <highlight><bold>224</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 2</cross-reference> signifies an oxidant set point generator algorithm. The oxidant set point generator is an algorithm for establishing a desired (or target) volume of oxidants to be stored in the catalyst <highlight><bold>52</bold></highlight> as a percentage of the oxidant storage capacity of the catalyst. The target volume of oxidants is also referred to herein as the oxidant set point. Generally, the oxidant set point is determined based on engine speed and load (which is inferred from air mass flow), vehicle speed, and other operating parameters. The oxidant set point signal (<highlight><bold>225</bold></highlight>), i.e., the output of the oxidant set point generator (<highlight><bold>224</bold></highlight>), is used by the invented system, and particularly by the oxidant level/capacity controller (block <highlight><bold>232</bold></highlight>) to control engine operation. A more detailed description of the algorithm employed by the oxidant storage set point generator (<highlight><bold>224</bold></highlight>) is provided below in connection with a description of <cross-reference target="DRAWINGS">FIG. 5</cross-reference>. </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> BBlock <highlight><bold>226</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 2</cross-reference> signifies an available oxidant storage estimator algorithm. The available oxidant storage estimator algorithm (<highlight><bold>226</bold></highlight>) estimates the amount of oxidant storage capacity that is available in a catalyst brick. This algorithm is implemented for each brick in a multiple-brick catalyst <highlight><bold>52</bold></highlight>. The available oxidant storage of each brick is estimated based on the catalyst temperature (<highlight><bold>208</bold></highlight>) and the catalyst age (<highlight><bold>210</bold></highlight>). The estimated available oxidant signal (<highlight><bold>227</bold></highlight>) is provided to a current oxidant level estimator (block <highlight><bold>230</bold></highlight>) and the oxidant level/capacity controller (<highlight><bold>232</bold></highlight>). A more detailed description of the available oxidant storage estimator (<highlight><bold>226</bold></highlight>) is provided below in connection with the discussion of <cross-reference target="DRAWINGS">FIG. 3</cross-reference>. </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> BBlock <highlight><bold>228</bold></highlight> signifies a set point location algorithm, which, in connection with a system having a multiple-brick catalyst <highlight><bold>52</bold></highlight>, determines which of the bricks in the catalyst <highlight><bold>52</bold></highlight> is the key brick. The key brick is that brick in the catalyst <highlight><bold>52</bold></highlight> upon which the system bases its engine control strategy. In other words, the invented system attempts to control the engine operation to maintain a particular oxidant level at the key brick. The key brick changes from time to time based on various engine operating conditions. The set point location algorithm (<highlight><bold>228</bold></highlight>) determines the key brick based on the catalyst temperature (<highlight><bold>208</bold></highlight>), the catalyst age (<highlight><bold>210</bold></highlight>), and the available oxidant storage in each brick (signal <highlight><bold>227</bold></highlight>). The output signal of the set point location algorithm (<highlight><bold>229</bold></highlight>), i.e., the key brick location, is used by the oxidant storage set point generator (block <highlight><bold>224</bold></highlight>) to determine the oxidant set point value (signal <highlight><bold>225</bold></highlight>). A more detailed description of the set point location algorithm (<highlight><bold>228</bold></highlight>) is provided below in connection with the discussion of <cross-reference target="DRAWINGS">FIG. 4</cross-reference>. </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> BBlock <highlight><bold>230</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 2</cross-reference> signifies a current oxidant level estimator algorithm, which estimates the instantaneous oxidant level in a catalyst brick. In a system using a multiple brick catalyst <highlight><bold>52</bold></highlight>, the current oxidant level estimator algorithm is implemented for each brick. The oxidant level in each brick is estimated based on the air mass flow (<highlight><bold>202</bold></highlight>), the catalyst temperature (<highlight><bold>208</bold></highlight>), the exhaust air/fuel ratio (<highlight><bold>212</bold></highlight>), and the estimate of available oxidant storage capacity in each of the bricks (<highlight><bold>227</bold></highlight>). The estimated amount of oxidants stored in each brick (signal <highlight><bold>231</bold></highlight>) is provided to the oxidant level/capacity controller (<highlight><bold>232</bold></highlight>). A more detailed description of the current oxidant level estimator algorithm (<highlight><bold>230</bold></highlight>) is provided below in connection with the discussion of <cross-reference target="DRAWINGS">FIG. 6</cross-reference>. </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> BBlock <highlight><bold>232</bold></highlight> signifies an oxidant level/capacity controller, which calculates engine control signals intended to cause the engine <highlight><bold>13</bold></highlight> to function so as to control the oxidant level in the catalyst <highlight><bold>52</bold></highlight> close to the oxidant set point, as well as to control the oxidant storage capacity of the catalyst <highlight><bold>52</bold></highlight>. Specifically, the oxidant level/capacity controller (<highlight><bold>232</bold></highlight>) calculates an air/fuel control bias signal (<highlight><bold>238</bold></highlight>) that is used to adjust the air/fuel ratio provided to the engine cylinders. The air/fuel control bias signal (<highlight><bold>238</bold></highlight>) is the primary mechanism of adjusting the oxidant level in the catalyst <highlight><bold>52</bold></highlight>. The oxidant level/capacity controller (<highlight><bold>232</bold></highlight>) also calculates an air mass bias signal (<highlight><bold>236</bold></highlight>) and a delta spark signal (<highlight><bold>234</bold></highlight>). The air mass bias and delta spark signals are used to adjust the oxidant storage capacity of the catalyst <highlight><bold>52</bold></highlight> by controlling the temperature of the catalyst. The oxidant level/capacity controller (<highlight><bold>232</bold></highlight>) further calculates Reset/Adaptive Coefficients, which essentially cause the oxidant level prediction algorithms to be reset or adjusted based on feedback signals. A more detailed description of the oxidant level/capacity controller (<highlight><bold>232</bold></highlight>) is provided below in connection with a discussion of <cross-reference target="DRAWINGS">FIG. 7</cross-reference>. </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> RReferring now to <cross-reference target="DRAWINGS">FIG. 3, a</cross-reference> more detailed description of the available oxidant storage estimator algorithm (<highlight><bold>226</bold></highlight>) is provided. The available oxidant storage estimator (<highlight><bold>226</bold></highlight>) determines the total oxidant storage capacity that is available in a single brick of catalyst <highlight><bold>52</bold></highlight>. It is desirable to make this calculation for each brick in the catalyst <highlight><bold>52</bold></highlight> to facilitate the determination of the desired oxidant set point, or oxidant target, in block <highlight><bold>224</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 2</cross-reference>. Therefore, for multiple-brick catalysts <highlight><bold>52</bold></highlight>, the available oxidant storage estimator (<highlight><bold>226</bold></highlight>) is applied to each brick. </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> TThe available oxidant storage capacity in each brick is a function of the wash coat used on the catalyst <highlight><bold>52</bold></highlight>, the temperature of the brick (<highlight><bold>208</bold></highlight>), and the deterioration of the brick (<highlight><bold>210</bold></highlight>). The wash coat factor, which depends upon the adsorption characteristics of the particular wash coat used on the catalyst <highlight><bold>52</bold></highlight>, is measured in grams per cubic inch and is a constant parameter for a given catalyst. </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> TThe wash coat parameter can be pre-programmed into the algorithm at the time of manufacture. One skilled in the art will recognize that the temperature of each brick can either be measured using conventional temperature sensors or estimated using various mathematical models. </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> FFinally, the extent of catalyst deterioration can also be determined in a variety of ways. In the preferred embodiment of the invention, the extent of catalyst deterioration is inferred based on the current oxidant storage capacity of the catalyst. A first preferred method for doing so is disclosed in U.S. Pat. No. 5,848,528, which is hereby incorporated by reference. In summary, first, the catalyst is filled with oxidants by running the engine with a lean air/fuel ratio for an extended period of time. After the catalyst is filled, the air/fuel ratio provided to the engine is made rich. The pre-catalyst oxygen sensor <highlight><bold>54</bold></highlight> detects the rich air/fuel condition in the exhaust almost immediately. However, because the HC and CO produced by the rich engine air/fuel ratio reacts with the stored oxidants in the catalyst, there is a time delay until the post-catalyst oxygen sensor <highlight><bold>53</bold></highlight> detects a rich air/fuel ratio in the downstream exhaust. The length of the time delay is indicative of the oxidant storage capacity of the catalyst. Based upon the measured time delay, a deterioration factor between 0 and 1 (0 representing total deterioration and 1 representing no deterioration) is calculated. Alternatively, the method could be used in reverse, i.e., the catalyst could be depleted due to extended rich operation, after which the air/fuel ratio would be switched to lean operation. Similar to the original method, the length of the time delay until the post-catalyst sensor <highlight><bold>53</bold></highlight> registered a change in state would be indicative of the catalyst deterioration. </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> AA second preferred method of estimating the deterioration level of the catalyst uses the estimated current oxidant storage of the catalyst, as derived by the oxidant estimator model (described below in connection with <cross-reference target="DRAWINGS">FIG. 6</cross-reference>), to predict the level of deterioration of the catalyst. Specifically, as described above, the engine controller <highlight><bold>15</bold></highlight> receives feedback signals from downstream EGO sensor <highlight><bold>53</bold></highlight>. As is known in the art, when the output signal of an EGO sensor switches from indicating a lean air/fuel condition in the exhaust stream to a rich air/fuel condition (or visa versa), this is an indication of emission breakthrough. In the case of a switch from rich to lean, this is an indication that the oxidant content in the exhaust stream downstream of the catalyst is high, which means that the catalytic converter <highlight><bold>52</bold></highlight> has reached its capacity in terms of adsorbing oxidants. When this occurs, the oxidant estimator model (described in connection with <cross-reference target="DRAWINGS">FIG. 6</cross-reference>) is used to estimate the current volume of oxidants stored in the catalytic converter <highlight><bold>52</bold></highlight>. From this estimate of the current oxidant storage volume, the system controller <highlight><bold>15</bold></highlight> can determine the level and rate of catalyst deterioration in a variety of ways. For example, the controller <highlight><bold>15</bold></highlight> can compare the current catalytic capacity to previous estimated catalytic capacities to determine the rate of catalyst deterioration. Further, the controller can determine that the catalyst has expended its useful life at the time when the oxidant storage capacity of the catalyst declines to a pre-determined value. </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> RReturning to <cross-reference target="DRAWINGS">FIG. 3</cross-reference>, block <highlight><bold>302</bold></highlight> signifies the start of the available oxidant storage estimator algorithm. (<highlight><bold>226</bold></highlight>) Blocks <highlight><bold>208</bold></highlight> and <highlight><bold>210</bold></highlight> illustrate that the individual brick temperatures (<highlight><bold>208</bold></highlight>) and the catalyst deterioration factor (<highlight><bold>210</bold></highlight>) are dynamic inputs to the algorithm (<highlight><bold>226</bold></highlight>). The individual brick temperatures (<highlight><bold>208</bold></highlight>) are preferably measured with temperature sensors, and alternative preferred methods for determining the catalyst deterioration factor are described above. At block <highlight><bold>310</bold></highlight>, the theoretical maximum oxidant storage capacity of a catalyst brick during normal operating temperature is calculated. The maximum oxidant storage capacity, being a function of washcoat, is measured at a given temperature. This capacity is then multiplied by the deterioration factor to produce a theoretical maximum oxidant storage. &lsqb;00018&rsqb; However, if the current operating temperature is not normal, as during initial start-up conditions, then the current storage capacity of the brick may be less than its theoretical maximum value. Accordingly, the next step, at block <highlight><bold>314</bold></highlight>, is to estimate the current oxidant storage capacity of the brick based on the theoretical maximum storage capacity and the current temperature of the brick. The estimated current oxidant storage capacity is a function of the maximum oxidant storage capacity and the catalyst temperature. The estimated current storage capacity of each brick (in grams per cubic inch) is the final output (<highlight><bold>227</bold></highlight>) of the available oxidant storage estimator (<highlight><bold>226</bold></highlight>), and it is used as input to each of the other main algorithms described in this invention. The available oxidant storage estimator algorithm is stopped at block <highlight><bold>318</bold></highlight>. </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> RReferring now to <cross-reference target="DRAWINGS">FIG. 4, a</cross-reference> more detailed description of the oxidant set point location algorithm (<highlight><bold>228</bold></highlight>) will be described. An object of the oxidant set point location algorithm (<highlight><bold>228</bold></highlight>) is to identify the particular brick in a multiple-brick catalyst <highlight><bold>52</bold></highlight> at which it is desirable to control the oxidant storage, i.e. the set point location. Actually, the oxidant set point is positioned just behind a given brick. In this way, the available oxidant storage capacity of the catalyst is considered to be that of the set point brick plus all of the bricks forward of the set point brick in the catalyst. Because the bricks in a catalyst tend to fill with oxidants unevenly, normally from front to back, and because oxidant storage is largely a function of temperature, and because the storage capacity of catalyst bricks deteriorate over time, it is desirable to selectively choose where in the catalyst (i.e., which brick) to control the oxidant level around. Further, selectively choosing the key brick enables the system to better control the distribution of oxidant storage throughout the various bricks in the catalyst. </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> AAt block <highlight><bold>402</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>, the algorithm is started. Blocks <highlight><bold>208</bold></highlight> and <highlight><bold>210</bold></highlight> signify the individual brick temperatures and the catalyst deterioration factor, respectively, as inputs to the algorithm. The catalyst deterioration factor is determined according to one of the preferred methods described above. The individual brick temperatures (<highlight><bold>208</bold></highlight>), and the catalyst deterioration factor (<highlight><bold>210</bold></highlight>) are used subsequently in the set point location algorithm to determine the oxidant set point location. </paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> IIn block <highlight><bold>405</bold></highlight>, a required oxidant reserve capacity is calculated for the entire catalyst. The oxidant reserve capacity is the current storage capacity of the bricks positioned behind the oxidant set point. It is desirable to maintain a certain minimum oxidant reserve capacity to accommodate inaccuracies and transients in the system. The oxidant capacity reserve is maintained so that if an unexpected rich/lean break occurs at the set point, there is sufficient oxidant storage capability remaining in the catalyst (in the bricks positioned behind the set point) to prevent total system breakthrough. The catalyst reserve capacity is calculated from the amount of oxidant storage available in each brick (<highlight><bold>227</bold></highlight>), as well as induction air mass (<highlight><bold>202</bold></highlight>), engine speed (<highlight><bold>204</bold></highlight>), vehicle speed (<highlight><bold>206</bold></highlight>), and catalyst brick temperature (<highlight><bold>208</bold></highlight>), as shown in block <highlight><bold>407</bold></highlight>. Specifically, the catalyst capacity reserve equals the total oxidant storage capacity of the catalyst less the oxidant storage capacity in the bricks in front of the set point location. Because the engine control strategy focuses on controlling the air/fuel ratio based on the storage capacity of the bricks in front of the set point, any additional storage capacity of bricks located behind the set point (as a result of the temperature of subsequent bricks rising) constitutes the available capacity reserve. As described below, the preferred embodiment of the invention always maintains a certain storage capacity reserve by only adjusting the set point location if the resulting storage capacity reserve is greater than a certain minimum required reserve. </paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> Based on the individual brick temperatures (<highlight><bold>208</bold></highlight>), the catalyst deterioration factor (<highlight><bold>210</bold></highlight>) and the required oxidant storage reserve (<highlight><bold>405</bold></highlight>), the oxidant set point location algorithm (<highlight><bold>228</bold></highlight>) determines the set point location according to blocks <highlight><bold>406</bold></highlight>-<highlight><bold>418</bold></highlight> and per the following description. Initially, it is assumed that the set point location is the most forward brick (brick(<highlight><bold>1</bold></highlight>)) in the catalyst <highlight><bold>52</bold></highlight>. That is, the invented system will control the engine air/fuel ratio based on the oxidant storage capacity of the first brick only (which is the only brick located in front of the set point). At block <highlight><bold>406</bold></highlight>, it is determined if (i) the temperature of the second brick (brick(<highlight><bold>2</bold></highlight>)) in the catalyst <highlight><bold>52</bold></highlight> exceeds a predetermined minimum brick temperature or (ii) if the deterioration factor of the first brick (brick(<highlight><bold>1</bold></highlight>)) is greater than a predetermined maximum deterioration factor. If either of these conditions is true, and if the oxidant storage capacity reserve of the catalyst with the set point being the second brick (brick(<highlight><bold>2</bold></highlight>)) is greater than the required reserve, then the set point location moves from the first brick (brick(<highlight><bold>1</bold></highlight>)) to the second brick (brick(<highlight><bold>2</bold></highlight>)). If not, then the set point location remains at the first brick (brick(<highlight><bold>1</bold></highlight>)), as shown at block <highlight><bold>408</bold></highlight>. </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> AAt block <highlight><bold>410</bold></highlight>, a similar test is performed. It is determined if the temperature of the third brick (brick(<highlight><bold>3</bold></highlight>)) is greater than a predetermined minimum temperature or if the deterioration factor of the second brick (brick(<highlight><bold>2</bold></highlight>)) is greater than a predetermined maximum deterioration factor. If either of these conditions is true, and if the oxidant storage capacity reserve of the catalyst would be greater than the required reserve with the third brick being the set point, then the set point location moves from the second brick (brick(<highlight><bold>2</bold></highlight>)) to the third brick (brick(<highlight><bold>3</bold></highlight>)). If not, then the set point location remains at the second brick (brick(<highlight><bold>2</bold></highlight>)), as shown at block <highlight><bold>412</bold></highlight>. Thus, the invented system would control the engine air/fuel ratio based on the oxidant storage capacity of the first and second bricks together. </paragraph>
<paragraph id="P-0048" lvl="0"><number>&lsqb;0048&rsqb;</number> TThis same procedure is repeated, as shown in blocks <highlight><bold>414</bold></highlight>-<highlight><bold>418</bold></highlight> until a final set point location is determined. One skilled in the art will appreciate that the described oxidant set point location algorithm generally causes the set point to move from the forward bricks toward the rearward bricks as the temperature of the catalyst bricks increase from front to rear. This is because the storage capacity of catalyst bricks increases with brick temperature. Thus, during a cold start, the oxidant set point location will usually start out being the first (most forward) brick in the catalyst, and the set point location will migrate rearward as the temperature of the rearward bricks increase. Further, aging/deterioration of the catalyst will tend to move the oxidant set point location rearward in the chain of bricks more quickly, since the forward bricks will tend to have less capacity as they deteriorate. Finally, extended idle or low load (low air mass flow) operation of the vehicle may cause the set point location to migrate forward in the chain of bricks if the temperature of the rearward bricks falls. In general, it is desirable in the preferred embodiment of the invention to maintain the set point location at approximately one half to two thirds of the total catalyst storage capacity to provide a preferred reserve capacity capable of sufficiently accommodating system transient inaccuracies. </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> TThe preferred embodiment of the oxidant set point location algorithm described above involves identifying a particular brick as the set point. However, in an alternative preferred embodiment of the invention, the oxidant set point can be established within any of the bricks of a multiple-brick catalyst. Thus, instead of setting the set point behind brick <highlight><bold>1</bold></highlight> or brick <highlight><bold>2</bold></highlight>, for instance, the set point can be set at various points inside of brick <highlight><bold>1</bold></highlight> or brick <highlight><bold>2</bold></highlight>. The set point can then be moved through the interiors of the various bricks based on a calculation of the oxidant storage capacity before and after the set point within the brick. Using a model wherein the oxidant set point can be set inside of the various bricks may increase accuracy of the estimations and control of the oxidant storage. </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> RReferring now to <cross-reference target="DRAWINGS">FIG. 5, a</cross-reference> more detailed description of the oxidant set point generator (block <highlight><bold>224</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>) is provided. An object of the oxidant set point generator (<highlight><bold>224</bold></highlight>) is to calculate a desired target oxidant storage amount, i.e., the oxidant set point, that the invented system will attempt to maintain stored in the bricks in front of the set point location. As indicated previously, the following input parameters are provided to the oxidant set point generator: (i) air mass (<highlight><bold>202</bold></highlight>); (ii) engine speed (<highlight><bold>204</bold></highlight>); (iii) vehicle speed (<highlight><bold>206</bold></highlight>); (iv) available oxidant storage in each brick (<highlight><bold>227</bold></highlight>); (v) set point location (<highlight><bold>229</bold></highlight>); and (vi) throttle position (<highlight><bold>218</bold></highlight>). Based on these input parameters, the oxidant set point generator calculates a desired target oxidant storage level (<highlight><bold>225</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 2</cross-reference>) as a percentage of the total oxidant storage capacity of the catalyst <highlight><bold>52</bold></highlight>. This desired target oxidant storage level (<highlight><bold>225</bold></highlight>), or oxidant set point, is the critical value upon which the engine control signals are generated. </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> IIn a preferred embodiment of the invention, as shown in block <highlight><bold>504</bold></highlight>, the air mass (<highlight><bold>202</bold></highlight>), engine speed (<highlight><bold>204</bold></highlight>) and vehicle speed (<highlight><bold>206</bold></highlight>) parameters are used as index values into a three-dimensional look-up table (<highlight><bold>504</bold></highlight>). The output of the look-up table (<highlight><bold>504</bold></highlight>) is a value that represents a desired percentage of available oxidant storage capacity in the catalyst <highlight><bold>52</bold></highlight>. The values in the look-up table (<highlight><bold>502</bold></highlight>) are empirically determined based on optimal catalyst conversion efficiency, and they are preset at the time of manufacture. Steady state efficiencies are used as a basis for determining desired oxidant set points, and set points that provide the highest efficiencies with some immunity to disturbances are selected. At block <highlight><bold>506</bold></highlight>, a value indicative of the volume of available oxidant storage in the bricks in front of the oxidant set point location in the catalyst is determined based on the set point location (<highlight><bold>229</bold></highlight>) and the available oxidant storage per brick (<highlight><bold>227</bold></highlight>). To do so, the desired percentage of available oxidant storage in the catalyst <highlight><bold>52</bold></highlight> (from <highlight><bold>504</bold></highlight>) is multiplied by the volume of available oxidant storage in the bricks in front of the set point (from <highlight><bold>506</bold></highlight>) at block <highlight><bold>512</bold></highlight>. The resulting product is a base oxidant set point, which consists of a target amount of oxidants to be stored in the catalyst <highlight><bold>52</bold></highlight>. </paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> AA set point modulation function (<highlight><bold>508</bold></highlight>) is applied to the product at block <highlight><bold>514</bold></highlight> based on engine speed (<highlight><bold>204</bold></highlight>) and load (<highlight><bold>202</bold></highlight>) to improve catalyst efficiency, as is known by those skilled in the art. Finally, at block <highlight><bold>510</bold></highlight>, a look-ahead multiplier value is determined based upon air mass (<highlight><bold>202</bold></highlight>), engine speed (<highlight><bold>204</bold></highlight>), vehicle speed (<highlight><bold>206</bold></highlight>) and throttle position (<highlight><bold>218</bold></highlight>) parameters. A purpose of the look-ahead multiplier is to adjust the oxidant set point based on expected future operating conditions. For example, the oxidant set point may be established at a relatively low value after the vehicle operator tips out and the vehicle stops because it is reasonably certain that a tip-in condition will occur shortly thereafter. The expected tip-in condition will produce higher levels of NO<highlight><subscript>X</subscript></highlight>, and the low set point will compensate for this condition. The look-ahead multiplier is applied at block <highlight><bold>516</bold></highlight> by multiplying the look-ahead multiplier by the modulated base set point. The product is a final oxidant set point (<highlight><bold>225</bold></highlight>), representing a target oxidant storage level in the catalyst (in grams per cubic inch). </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> AAn alternative embodiment of the oxidant set point generator (<highlight><bold>224</bold></highlight>) involves using a four dimensional look-up table to combine the functions of the three dimensional look-up table (<highlight><bold>504</bold></highlight>) and the look-ahead multiplier determination (<highlight><bold>510</bold></highlight>). Essentially, the function of the look-ahead multiplier would be incorporated into the fourth dimension of the look-up table. In this embodiment, the oxidant set point would be determined from the four dimensional look-up table based on air mass (<highlight><bold>202</bold></highlight>), engine speed (<highlight><bold>204</bold></highlight>), vehicle speed (<highlight><bold>206</bold></highlight>), and throttle position (<highlight><bold>218</bold></highlight>). The output of the four-dimensional look-up table would be the target oxidant setpoint, and no modification based on a look-ahead multiplier would be necessary. </paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> IIn preferred embodiments of the invention, the oxidant set point is prevented from being set at a level that exceeds the functional limits of the catalytic converter, i.e., greater than the total oxidant storage capacity of the catalyst or less than zero. Preferably, the oxidant set point is limited to between about 30% and about 70% of the total catalyst storage capacity. In other preferred embodiments of the invention, parameters other than engine speed and load and vehicle speed, such as catalyst temperature, EGR and ignition timing, may be used to determine a desirable oxidant set point. Moreover, the present invention is equally applicable to systems wherein the oxidant set point is a constant value, such as, for example, 50% of the total oxidant storage capacity of the catalytic converter <highlight><bold>52</bold></highlight>, in which case the entire oxidant set point generator algorithm (<highlight><bold>224</bold></highlight>) could be replaced with a constant value. </paragraph>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> RReferring now to <cross-reference target="DRAWINGS">FIG. 6, a</cross-reference> more detailed description of the oxidant level estimator algorithm (<highlight><bold>230</bold></highlight>), which estimates the instantaneous oxidant levels in the bricks of catalyst <highlight><bold>52</bold></highlight>, is provided. The results of this algorithm are used ultimately by the oxidant level/capacity controller (<highlight><bold>232</bold></highlight>) to adjust the engine air/fuel ratio based on a comparison of the estimated oxidant storage in the catalyst with the oxidant set point. </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> TThe oxidant level estimator algorithm begins at block <highlight><bold>602</bold></highlight>. At block <highlight><bold>604</bold></highlight>, it is determined whether an oxidant state initialization is required, i.e., whether or not the vehicle has just been started. If the vehicle has just been started, then the oxidant estimator model must be initialized because oxidants tend to gradually fill the catalyst for a period after the vehicle has been turned off, then are released as the catalyst cools. An initialization of the oxidant estimator model involves determining the oxidant state of the catalyst <highlight><bold>52</bold></highlight> based on the soak time (time since the vehicle was turned off) and the current temperature of the catalyst. If the soak time is relatively long, then the current oxidant level of the catalyst <highlight><bold>52</bold></highlight> is determined to be a preset value corresponding to a cold start of the vehicle because it is assumed that the catalyst has filled with oxidant to a predictable level. On the other hand, if the soak time is relatively short, then catalyst <highlight><bold>52</bold></highlight> has likely not yet filled with oxidant to the same extent as during an extended soak. Therefore, the initial oxidant state of catalyst <highlight><bold>52</bold></highlight> is determined based on the last oxidant state (before the vehicle was turned off), the soak time, the current catalyst temperature, and an empirical time constant, as shown in block <highlight><bold>610</bold></highlight>. </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> RRegardless of the initial oxidant level in the catalyst bricks, the current oxidant levels are calculated according to the oxidant level predictor model, or observer, described below based on air mass (<highlight><bold>202</bold></highlight>), catalyst temperature (<highlight><bold>208</bold></highlight>), exhaust air/fuel ratio (<highlight><bold>212</bold></highlight>), available oxidant storage (<highlight><bold>227</bold></highlight>) and reset and adaptive feedback parameters (<highlight><bold>240</bold></highlight>) derived from the oxidant level controller (<highlight><bold>232</bold></highlight>). The oxidant predictor model calculation occurs at block <highlight><bold>608</bold></highlight> according to the following method. </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> The actual amount of oxidants stored in the catalytic converter <highlight><bold>52</bold></highlight> is continually estimated using a mathematical oxidant predictor model or observer. At preset times T, the oxidant predictor model estimates the amount of oxidants (&Dgr;O<highlight><subscript>2</subscript></highlight>) adsorbed and/or desorbed in the catalytic converter <highlight><bold>52</bold></highlight> over the time interval &Dgr;T from the previous time T<highlight><subscript>i-1 </subscript></highlight>to the current preset time T<highlight><subscript>i</subscript></highlight>. A running total value is maintained in the RAM memory <highlight><bold>116</bold></highlight> that represents the current estimate of the amount of oxidants stored in the catalytic converter <highlight><bold>52</bold></highlight>. The estimated change in the amount of oxidants (&Dgr;O<highlight><subscript>2</subscript></highlight>) stored in the catalytic converter is added to or subtracted from the running total value maintained in RAM <highlight><bold>116</bold></highlight> on an iterative basis. Therefore, at any one time, RAM memory <highlight><bold>116</bold></highlight> contains the most current estimate of the total amount of oxidants stored in the catalytic converter <highlight><bold>52</bold></highlight>. </paragraph>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> Details of how a preferred embodiment of the oxidant predictor model estimates the amount of oxidants adsorbed/desorbed at the various preset times T<highlight><subscript>1 </subscript></highlight>(block <highlight><bold>608</bold></highlight>) will now be described. First, the current air/fuel ratio provided to the engine cylinders is used to determine the amount of oxidants (O<highlight><subscript>2</subscript></highlight>) that is either available for storage in the catalytic converter <highlight><bold>52</bold></highlight> (as a result of lean air/fuel operation) or that is needed for oxidation of hydrocarbons (as a result of rich air/fuel operation), according to the following equation</paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>O</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;A</italic></highlight>&lsqb;(1&minus;&PHgr;)*(1<highlight><italic>y</italic></highlight>/4)&rsqb;*32&emsp;&emsp;(1)</in-line-formula></paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> In Equation 1 above, one skilled in the art will recognize that the variable y represents a value that varies depending upon the type of fuel used in the system. For a normal gasoline engine, y equals 1.85. The variable &phgr; represents the air/fuel ratio in the exhaust manifold <highlight><bold>48</bold></highlight> upstream of the catalytic converter <highlight><bold>52</bold></highlight>. In the preferred embodiment of the invention, the variable &phgr; is assigned the air/fuel ratio that is commanded by the controller <highlight><bold>15</bold></highlight> to be provided to the engine cylinders at a given time T. It is also possible to use the output of upstream EGO sensor <highlight><bold>54</bold></highlight> (in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>) as the value for &phgr; in Equation 1. Finally, the factor A represents the mole flow rate of air in the exhaust manifold <highlight><bold>48</bold></highlight>, which is calculated according to the following Equation 2 
<math-cwu id="MATH-US-00001">
<number>1</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>A</mi>
        <mo>=</mo>
        <mfrac>
          <mn>1</mn>
          <mrow>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mn>1</mn>
                <mo>+</mo>
                <mfrac>
                  <mi>y</mi>
                  <mn>4</mn>
                </mfrac>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mo>&it;</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <mi>M</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <msub>
                    <mi>W</mi>
                    <msub>
                      <mi>O</mi>
                      <mn>2</mn>
                    </msub>
                  </msub>
                </mrow>
                <mo>+</mo>
                <mrow>
                  <mi>M</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <msub>
                    <mi>W</mi>
                    <msub>
                      <mi>N</mi>
                      <mn>2</mn>
                    </msub>
                  </msub>
                </mrow>
                <mo>+</mo>
                <mn>3.76</mn>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>2</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00001" file="US20030000205A1-20030102-M00001.NB"/>
<image id="EMI-M00001" wi="216.027" he="25.9119" file="US20030000205A1-20030102-M00001.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> In Equation 2, the variable y is again a value that varies with the type of fuel used in the system, which is 1.85 for gasoline. The mole weight of oxidant (MWo<highlight><subscript>2</subscript></highlight>) is 32 and the mole weight of nitrogen (MWn<highlight><subscript>2</subscript></highlight>) is 28. Accordingly, for a gasoline engine, the factor A equals 0.00498 grams/sec. When Equation 1 is solved, a negative value for O<highlight><subscript>2 </subscript></highlight>indicates that oxidant is being adsorbed by the catalyst <highlight><bold>52</bold></highlight>, and a positive value for O<highlight><subscript>2 </subscript></highlight>indicates that oxidant is being desorbed by the catalyst <highlight><bold>52</bold></highlight> to react with hydrocarbons. </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> Once the amount of oxidants either available for storage in the catalytic converter or required for oxidation of the hydrocarbons being produced by the engine is determined, the next step is to estimate the volume of oxidants that are actually adsorbed/desorbed by the catalytic converter. In the preferred embodiment, this estimation depends on several factors, including the volume of the catalytic converter <highlight><bold>52</bold></highlight>, the flow rate of oxidants in the exhaust manifold <highlight><bold>48</bold></highlight>, the percentage of the catalytic converter that is already full of oxidants, and other physical and operational characteristics of the catalytic converter. According to the preferred embodiment of the present invention, the change in the amount of oxidants stored in the catalytic converter <highlight><bold>52</bold></highlight> between two preset times (&Dgr;T) is estimated based on the following model:  
<math-cwu id="MATH-US-00002">
<number>2</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>&Delta;</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <msub>
            <mi>O</mi>
            <mn>2</mn>
          </msub>
        </mrow>
        <mo>=</mo>
        <mrow>
          <msub>
            <mi>C</mi>
            <mn>1</mn>
          </msub>
          <mo>*</mo>
          <msub>
            <mi>C</mi>
            <mn>2</mn>
          </msub>
          <mo>*</mo>
          <msub>
            <mi>C</mi>
            <mn>3</mn>
          </msub>
          <mo>*</mo>
          <msub>
            <mi>C</mi>
            <mn>4</mn>
          </msub>
          <mo>&it;</mo>
          <mrow>
            <mo>&AutoLeftMatch;</mo>
            <mrow>
              <mrow>
                <mo>[</mo>
                <mrow>
                  <msub>
                    <mi>K</mi>
                    <mi>a</mi>
                  </msub>
                  <mo>*</mo>
                  <msup>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mn>1</mn>
                        <mo>-</mo>
                        <mfrac>
                          <mrow>
                            <mi>Stored</mi>
                            <mo>&it;</mo>
                            <mstyle>
                              <mtext>&emsp;</mtext>
                            </mstyle>
                            <mo>&it;</mo>
                            <msub>
                              <mi>O</mi>
                              <mn>2</mn>
                            </msub>
                          </mrow>
                          <mrow>
                            <mi>Max</mi>
                            <mo>&it;</mo>
                            <mstyle>
                              <mtext>&emsp;</mtext>
                            </mstyle>
                            <mo>&it;</mo>
                            <msub>
                              <mi>O</mi>
                              <mn>2</mn>
                            </msub>
                          </mrow>
                        </mfrac>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <msub>
                      <mi>N</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                  <mo>*</mo>
                  <msup>
                    <mrow>
                      <mo>(</mo>
                      <mfrac>
                        <mrow>
                          <msub>
                            <mi>O</mi>
                            <mn>2</mn>
                          </msub>
                          <mo>&it;</mo>
                          <mstyle>
                            <mtext>&emsp;</mtext>
                          </mstyle>
                          <mo>&it;</mo>
                          <mi>Flow</mi>
                          <mo>&it;</mo>
                          <mstyle>
                            <mtext>&emsp;</mtext>
                          </mstyle>
                          <mo>&it;</mo>
                          <mi>Rate</mi>
                        </mrow>
                        <mrow>
                          <mi>Base</mi>
                          <mo>&it;</mo>
                          <mstyle>
                            <mtext>&emsp;</mtext>
                          </mstyle>
                          <mo>&it;</mo>
                          <mi>Value</mi>
                        </mrow>
                      </mfrac>
                      <mo>)</mo>
                    </mrow>
                    <msub>
                      <mi>Z</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                  <mo>*</mo>
                  <mi>Cat</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>Vol</mi>
                  <mo>*</mo>
                  <mi>&Delta;</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>T</mi>
                </mrow>
                <mo>]</mo>
              </mrow>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>for</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>Oxygen</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>being</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>adsorbed</mi>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mstyle>
        <mtext>(3a)</mtext>
      </mstyle>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>&Delta;</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <msub>
            <mi>O</mi>
            <mn>2</mn>
          </msub>
        </mrow>
        <mo>=</mo>
        <mrow>
          <msub>
            <mi>C</mi>
            <mn>1</mn>
          </msub>
          <mo>*</mo>
          <msub>
            <mi>C</mi>
            <mn>2</mn>
          </msub>
          <mo>*</mo>
          <msub>
            <mi>C</mi>
            <mn>3</mn>
          </msub>
          <mo>*</mo>
          <msub>
            <mi>C</mi>
            <mn>4</mn>
          </msub>
          <mo>&it;</mo>
          <mrow>
            <mo>&AutoLeftMatch;</mo>
            <mrow>
              <mrow>
                <mo>[</mo>
                <mrow>
                  <msub>
                    <mi>K</mi>
                    <mi>d</mi>
                  </msub>
                  <mo>*</mo>
                  <msup>
                    <mrow>
                      <mo>(</mo>
                      <mfrac>
                        <mrow>
                          <mi>Stored</mi>
                          <mo>&it;</mo>
                          <mstyle>
                            <mtext>&emsp;</mtext>
                          </mstyle>
                          <mo>&it;</mo>
                          <msub>
                            <mi>O</mi>
                            <mn>2</mn>
                          </msub>
                        </mrow>
                        <mrow>
                          <mi>Max</mi>
                          <mo>&it;</mo>
                          <mstyle>
                            <mtext>&emsp;</mtext>
                          </mstyle>
                          <mo>&it;</mo>
                          <msub>
                            <mi>O</mi>
                            <mn>2</mn>
                          </msub>
                        </mrow>
                      </mfrac>
                      <mo>)</mo>
                    </mrow>
                    <msub>
                      <mi>N</mi>
                      <mn>2</mn>
                    </msub>
                  </msup>
                  <mo>*</mo>
                  <msup>
                    <mrow>
                      <mo>(</mo>
                      <mfrac>
                        <mrow>
                          <msub>
                            <mi>O</mi>
                            <mn>2</mn>
                          </msub>
                          <mo>&it;</mo>
                          <mstyle>
                            <mtext>&emsp;</mtext>
                          </mstyle>
                          <mo>&it;</mo>
                          <mi>Flow</mi>
                          <mo>&it;</mo>
                          <mstyle>
                            <mtext>&emsp;</mtext>
                          </mstyle>
                          <mo>&it;</mo>
                          <mi>Rate</mi>
                        </mrow>
                        <mrow>
                          <mi>Base</mi>
                          <mo>&it;</mo>
                          <mstyle>
                            <mtext>&emsp;</mtext>
                          </mstyle>
                          <mo>&it;</mo>
                          <mi>Value</mi>
                        </mrow>
                      </mfrac>
                      <mo>)</mo>
                    </mrow>
                    <msub>
                      <mi>Z</mi>
                      <mn>2</mn>
                    </msub>
                  </msup>
                  <mo>*</mo>
                  <mi>Cat</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>Vol</mi>
                  <mo>*</mo>
                  <mi>&Delta;</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>T</mi>
                </mrow>
                <mo>]</mo>
              </mrow>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>for</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>Oxygen</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>being</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>desorbed</mi>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mstyle>
        <mtext>(3b)</mtext>
      </mstyle>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00002" file="US20030000205A1-20030102-M00002.NB"/>
<image id="EMI-M00002" wi="216.027" he="90.01125" file="US20030000205A1-20030102-M00002.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> As indicated above, Equation (3a) is used to calculate the change in oxidant storage in the catalytic converter if the catalyst is in an adsorption mode and Equation (3b) is used if the catalyst is in a desorption mode. </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> IIn Equations (3a) and (3b), the variables C<highlight><subscript>1</subscript></highlight>, C<highlight><subscript>2</subscript></highlight>, and C<highlight><subscript>3 </subscript></highlight>are assigned values to compensate for various functional and operational characteristics of the catalytic converter. The value of C<highlight><subscript>1 </subscript></highlight>is determined according to a mathematical function or look-up table based on the catalyst temperature. The preferred embodiment of the invention uses a mathematical function represented by the graph in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>A, which illustrates that a catalytic converter is most active when the catalyst is hot and least active when it is cold. The catalyst temperature can be determined according to several different methods that are well-known to those of skill in the art, including by a catalyst temperature sensor. After determined, the catalyst temperature is used to assign a value to C<highlight><subscript>1 </subscript></highlight>according to the function shown in <cross-reference target="DRAWINGS">FIG. 8A</cross-reference>. </paragraph>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> TThe value of C<highlight><subscript>2 </subscript></highlight>in Equations (3a) and (3b) is determined based on the deterioration of the catalytic converter. The deterioration of the catalytic converter can be determined by a variety of well-known methods, including, for example, inferring such age or deterioration from the vehicl&prime;&Prime;s total mileage (recorded by the vehicl&prime;&Prime;s odometer) or total amount of fuel used over the vehicl&prime;&Prime;s lifetime. Further, a catalytic deterioration factor can be calculated according to one of the preferred methods described hereinabove. <cross-reference target="DRAWINGS">FIG. 8B</cross-reference> shows a graphical representation of a preferred mathematical function used to assign values to C<highlight><subscript>2 </subscript></highlight>in the preferred embodiment of the invention. <cross-reference target="DRAWINGS">FIG. 8B</cross-reference> illustrates that a catalytic converte&prime;&Prime;s efficiency (ability to adsorb and/or desorb oxidants) decreases with its age. </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> TThe value of C<highlight><subscript>3 </subscript></highlight>is determined by a mathematical function or map based on the mass airflow in the exhaust manifold <highlight><bold>48</bold></highlight>. <cross-reference target="DRAWINGS">FIG. 8C</cross-reference> graphically illustrates a preferred mathematical function used in the preferred embodiment of the invention to assign values to C<highlight><subscript>3</subscript></highlight>, depending on the mass airflow rate in the induction manifold <highlight><bold>48</bold></highlight>. As can be seen, the adsorption/desorption efficiency of the catalyst decreases as the mass flow rate increases. </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> TThe value of C<highlight><subscript>4 </subscript></highlight>is derived from the adaptive parameters (<highlight><bold>240</bold></highlight>) calculated by the oxidant level/capacity controller (<highlight><bold>232</bold></highlight>). The C<highlight><subscript>4 </subscript></highlight>value essentially provides feedback capabilities to the model, making the preferred embodiment of the model a closed-loop system. Specifically, the value of C<highlight><subscript>4 </subscript></highlight>is read from a two-dimensional look-up table of adaptive parameters. The primary index to the look-up table is air mass flow (<highlight><bold>202</bold></highlight>). For each air mass flow value, there are two C<highlight><subscript>4 </subscript></highlight>values one for when the catalyst is adsorbing oxidants (equation 3(a)) and one for when the catalyst is desorbing oxidants (equation 3(b)). Thus, the value of C<highlight><subscript>4 </subscript></highlight>used in equations 3(a) and 3(b) above varies from time to time with the measured air mass flow in the engine. Further, the values in the C<highlight><subscript>4 </subscript></highlight>look-up table are all adjusted from time to time based on a feedback error term. In particular, the C<highlight><subscript>4 </subscript></highlight>values initially start out as 1. During operation, the estimated oxidant storage level in the catalyst, as determined by this oxidant predictor model now being described, is compared to an oxidant level as measured by oxygen sensors in the catalyst (i.e., sensors <highlight><bold>902</bold></highlight>, <highlight><bold>904</bold></highlight>, <highlight><bold>906</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>) and outside of the catalyst in the exhaust stream (i.e., sensors <highlight><bold>53</bold></highlight> and <highlight><bold>54</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>). The difference between the estimated amount of stored oxidants and the measured amount of stored oxidants is considered an oxidant feedback error term. The values in the C<highlight><subscript>4 </subscript></highlight>look-up table are adjusted from time to time based on the oxidant feedback error. A more detailed discussion of the oxidant feedback error and the adjustment to the C<highlight><subscript>4 </subscript></highlight>values is set forth below in connection with the discussion of <cross-reference target="DRAWINGS">FIG. 7</cross-reference>. </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> TThe above-description of applying the feedback parameter C<highlight><subscript>4 </subscript></highlight>is different if the system does not have oxygen sensors positioned behind each of the bricks, as shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. If such oxygen sensors do not exist, then the system depends only on the feedback signal derived from post-catalyst oxygen sensor <highlight><bold>53</bold></highlight>. Thus, it is not possible to decouple individual adsorbtion/desorbtion rates from the individual bricks. Under these circumstances, a single two-dimensional look-up table (indexed by air mass values) of C<highlight><subscript>4 </subscript></highlight>values is used, and the same C<highlight><subscript>4 </subscript></highlight>parameter is multiplied by the oxidant storage estimate for each brick in the catalyst. When a single set of C<highlight><subscript>4 </subscript></highlight>parameters are used (as opposed to different C<highlight><subscript>4 </subscript></highlight>values for each brick), it is possible to weight the adsorbtion/desorbtion contributions of the bricks according to pre-determined weighting factors. </paragraph>
<paragraph id="P-0069" lvl="0"><number>&lsqb;0069&rsqb;</number> IIn Equation (3a), the value of k<highlight><subscript>a </subscript></highlight>represents the maximum adsorbing rate of the catalytic converter in terms of grams of oxidants per second per cubic inch. Similarly, in Equation (3b), the value of k<highlight><subscript>d </subscript></highlight>represents the maximum desorbing rate of the catalytic converter in terms of grams of oxidants per second per cubic inch. The values of k<highlight><subscript>a </subscript></highlight>and k<highlight><subscript>d </subscript></highlight>are pre-determined based on the specifications of the particular catalytic converter being used. </paragraph>
<paragraph id="P-0070" lvl="0"><number>&lsqb;0070&rsqb;</number> TThe value for Max O<highlight><subscript>2 </subscript></highlight>in both Equation (3a) and Equation (3b) represents the maximum amount of oxidants that the catalyst <highlight><bold>52</bold></highlight> is capable of storing in terms of grams. This is a constant value that is pre-determined according to the specifications of the particular catalytic converter used in the system. The value for Stored O<highlight><subscript>2 </subscript></highlight>in Equations (3a) and (3b) represents the previously-calculated current amount of oxidants stored in the catalytic converter <highlight><bold>52</bold></highlight> in terms of grams. The value for Stored O<highlight><subscript>2 </subscript></highlight>is read from RAM <highlight><bold>116</bold></highlight>. </paragraph>
<paragraph id="P-0071" lvl="0"><number>&lsqb;0071&rsqb;</number> TThe value for O<highlight><subscript>2 </subscript></highlight>Flow Rate in Equation (3a) and Equation (3b) represents the mass air flow rate in the induction manifold <highlight><bold>18</bold></highlight>, which is measured by mass air flow sensor <highlight><bold>158</bold></highlight>. The Base Value in Equation (3a) and Equation (3b) represents the oxygen flow rate where K<highlight><subscript>d </subscript></highlight>and K<highlight><subscript>a </subscript></highlight>were determined and it is (PPM O<highlight><subscript>2 </subscript></highlight>of input gas)*(volumetric flow rate)*(density of O<highlight><subscript>2</subscript></highlight>). </paragraph>
<paragraph id="P-0072" lvl="0"><number>&lsqb;0072&rsqb;</number> The Cat Vol parameter in Equation (3a) and Equation (3b) represents the total volume of the catalytic converter in terms of cubic inches. This value is pre-determined based on the type of catalytic converter being used. The value &Dgr;T in both equations represents the elapsed time in seconds since the last estimation of the change in oxidant storage in the catalyst. </paragraph>
<paragraph id="P-0073" lvl="0"><number>&lsqb;0073&rsqb;</number> FFinally, the values of N<highlight><subscript>1</subscript></highlight>, N<highlight><subscript>2</subscript></highlight>, Z<highlight><subscript>1</subscript></highlight>, and Z<highlight><subscript>2 </subscript></highlight>are exponents that express the probability of desorption/adsorption and they are determined by experimentally measuring rates of adsorption/desorption at given levels of storage and flow. The exponents are regressed from measurements and can be used to describe linear to sigmoid probabilities. </paragraph>
<paragraph id="P-0074" lvl="0"><number>&lsqb;0074&rsqb;</number> After the change in estimated oxidant storage in the catalyst <highlight><bold>52</bold></highlight> is calculated according to Equation (3a) or Equation (3b), the running total of the current oxidant storage maintained in RAM memory <highlight><bold>116</bold></highlight> is updated accordingly. Specifically, the amount of oxidants either adsorbed or desorbed is added/subtracted to the running total of oxidant storage, which is maintained in RAM memory <highlight><bold>116</bold></highlight>. </paragraph>
<paragraph id="P-0075" lvl="0"><number>&lsqb;0075&rsqb;</number> TThe oxidant predictor model may be employed either in an open loop manner or a closed loop manner, as is known to those skilled in the art in view of this disclosure. In an open loop embodiment, the oxidant predictor model described hereinabove estimates the volume of oxidants stored in the catalyst based on various parameters, such as temperature, air mass flow rate, etc., without input from any feedback parameters. Modifying equations 3(a) and 3(b) above to eliminate the C<highlight><subscript>4 </subscript></highlight>variable would illustrate a preferred open loop embodiment of the oxidant predictor model. </paragraph>
<paragraph id="P-0076" lvl="0"><number>&lsqb;0076&rsqb;</number> IIn a closed loop embodiment, on the other hand, the oxidant predictor model further includes a mechanism for adjusting the estimated volume of stored oxidants in the catalyst based on various feedback signals. In particular, after the oxidant predictor model estimates the volume of oxidants stored in the catalytic converter at a particular time, according to the method described above, this estimated value is used to calculate various other predicted parameters that are compared against corresponding measured feedback parameters. In the preferred embodiment of the invention described above, the C<highlight><subscript>4 </subscript></highlight>variable provides feedback based on the measurements of the catalyst oxygen sensors (i.e., sensors <highlight><bold>902</bold></highlight>, <highlight><bold>904</bold></highlight>, <highlight><bold>906</bold></highlight>) and the pre-catalyst oxygen sensor <highlight><bold>54</bold></highlight>. The feedback parameters could also comprise signals from the downstream EGO sensor <highlight><bold>53</bold></highlight> (shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>) or any of several other well-known feedback parameters. Regardless of the specific feedback signal used, the value of the feedback signal would be compared to the value of the parameter calculated from the estimated oxidant storage level in the catalyst, and the result of the comparison would be a feedback error term. The feedback error term would be used to increase or decrease the estimate of the volume of stored oxidants, as calculated by the oxidant predictor model per the method described above. The implementation of a closed-loop embodiment of the oxidant predictor model may be advantageous because the feedback signals may enable the oxidant predictor model to more accurately estimate the volume of oxidant stored in the catalyst. In the preferred embodiment of this invention, the C<highlight><subscript>4 </subscript></highlight>parameter, which is adjusted based on the adaptive parameters described in <cross-reference target="DRAWINGS">FIG. 7</cross-reference>, is applied to adjust the oxidant predictor model. Thus, the preferred embodiment of the invention adjusts the predicted level of oxidant stored in the catalyst in a closed-loop fashion. </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> IIn the preferred embodiment of the oxidant level predictor, a reset parameter also affects the model. In particular, if the comparison between the estimated amount of stored oxidants and the measured amount of stored oxidants produces a very large oxidant feedback error (i.e., greater than a certain reference value), which may occur as a result of large transients in the system, then it is desirable to reset the oxidant level predictor model instead of allowing the model to gradually correct itself. For example, if the measured oxidant level in the catalyst is very high, but the estimated oxidant level is very low, then the oxidant level predictor may reset itself to a relatively high storage value. Similarly, if the measured oxidant level in the catalyst is very low, but the estimated oxidant level is very high, then the oxidant level predictor may reset itself to a relatively low storage value. The reset function is a second form of corrective feedback in the model, and it facilitates more rapid correction of large errors. </paragraph>
<paragraph id="P-0078" lvl="0"><number>&lsqb;0078&rsqb;</number> TThose skilled in the art, in view of this disclosure, will recognize various modifications or additions that can be made to the above-described oxidant predictor model. For example, a well-known heated exhaust gas oxidant (HEGO) sensor, which generally provides an output signal indicative of only a lean or rich condition, can be used in place of the downstream EGO sensor <highlight><bold>53</bold></highlight>. In this case, when the downstream HEGO sensor provides a signal somewhere between lean and rich, no adjustment is made to the estimated amount of oxidants stored in the catalyst. On the other hand, when the downstream HEGO clearly indicates a lean air/fuel condition, the amount of estimated stored oxidant in the catalyst can be set to the maximum amount that can be stored at the current vehicle operating conditions. Further, when the downstream HEGO sensor indicates a clearly rich air/fuel condition, the estimated amount of stored oxidant can be set to zero. These adjustments represent a re-setting of the estimated amount of oxidants stored based on the downstream HEGO sensor. According to the present invention, the improvement in the estimated amount of oxidants stored in the catalyst <highlight><bold>52</bold></highlight> based on a feedback error signal can result in improved catalyst emissions. </paragraph>
<paragraph id="P-0079" lvl="0"><number>&lsqb;0079&rsqb;</number> RReferring now to <cross-reference target="DRAWINGS">FIG. 7</cross-reference>, the oxidant level/capacity controller (<highlight><bold>232</bold></highlight>) is described in more detail. A first object of the oxidant level/capacity controller (<highlight><bold>232</bold></highlight>) is to calculate an air/fuel control bias for the purpose of adjusting the air/fuel ratio in the engine cylinders to maintain the actual oxidant storage level in the catalyst <highlight><bold>52</bold></highlight> at or near the oxidant set point. A second object of the oxidant level/capacity controller (<highlight><bold>232</bold></highlight>) is to calculate an engine spark delta value and an air mass bias value, both of which are used to control the oxidant storage capacity of the catalyst <highlight><bold>52</bold></highlight> through adjusting the temperature of the catalyst. A final object of the oxidant level/capacity controller (<highlight><bold>232</bold></highlight>) is to calculate reset and adaptive parameters based on feedback signals from the oxygen sensors in the exhaust stream and in the catalyst. </paragraph>
<paragraph id="P-0080" lvl="0"><number>&lsqb;0080&rsqb;</number> TThe first function of the oxidant level/capacity controller (<highlight><bold>232</bold></highlight>) is generally accomplished by comparing the oxidant set point (<highlight><bold>225</bold></highlight>) to the estimated actual amount of oxidants stored in the catalytic converter <highlight><bold>52</bold></highlight> at a particular time T. The difference between the actual amount of oxidants stored in the catalytic converter <highlight><bold>52</bold></highlight> and the oxidant set point (<highlight><bold>225</bold></highlight>) is referred to herein as the set point error. The set point error indicates whether the volume of oxidants stored in the catalytic converter <highlight><bold>52</bold></highlight> is too high or too low relative to the oxidant set point. Based on the set point error, an air/fuel control bias signal is generated, which affects the ultimate air/fuel control signals sent by the controller <highlight><bold>15</bold></highlight> to the fuel injectors <highlight><bold>18</bold></highlight> to adjust the air/fuel ratio either more rich or more lean. Specifically, if the estimated actual amount of oxidants stored in the catalytic converter is less than the oxidant set point, then the controller <highlight><bold>15</bold></highlight> will adjust the amount of fuel supplied to the engine cylinders so that the engine air/fuel ratio is more lean. On the other hand, if the estimated actual amount of oxidants stored in the catalytic converter is more than the oxidant set point, then the controller will adjust the amount of fuel supplied to the engine cylinders so that the engine air/fuel ratio is more rich. </paragraph>
<paragraph id="P-0081" lvl="0"><number>&lsqb;0081&rsqb;</number> RReferring specifically to <cross-reference target="DRAWINGS">FIG. 7</cross-reference>, the following input parameters are used in connection with determining the air/fuel control bias value: (i) current oxidant storage per brick (<highlight><bold>231</bold></highlight>); and (ii) oxidant set point (<highlight><bold>225</bold></highlight>). First, at block <highlight><bold>711</bold></highlight>, the estimates of oxidants currently stored in each of the catalyst bricks (signal <highlight><bold>231</bold></highlight>) are summed, resulting in an estimate of the total amount of oxidants currently stored in all of the bricks of catalyst <highlight><bold>52</bold></highlight>. Next, the setpoint error is determined by comparing the total oxidants currently stored in the catalyst (<highlight><bold>711</bold></highlight>) to the oxidant set point (<highlight><bold>225</bold></highlight>) at block <highlight><bold>734</bold></highlight>. The set point error is provided to a proportional-integral controller (blocks <highlight><bold>736</bold></highlight>, <highlight><bold>738</bold></highlight>, and <highlight><bold>742</bold></highlight>), which calculates an air/fuel control bias term. In a preferred embodiment of the invention, the proportional-integral controller uses the set point error to calculate a closed-loop fuel bias term according to a proportional-integral strategy similar to that described in detail in U.S. Pat. No. 5,282,360 to Hamburg, which is hereby incorporated by reference. Specifically, as described in the Hamburg patent, a window is defined around the catalytic setpoint. For example, if the catalytic setpoint is determined to be X, then the lower limit of the window might be set at X&minus;Y and the upper limit of the window would be set at X&plus;Z. The variables X and Z represent specific variances from the catalytic setpoint. In relationship to the Hamburg patent, the lower and upper limits of the window (X&minus;Y) correspond to the rich and lean limits described in the Hamburg patent at lines 1:62-2:5. The upper and lower limits of the window are selectively determined based upon vehicle operating conditions, such as vehicle speed, engine load and engine temperature, as is known in the art. When the estimated oxidant volume (derived by the observer <highlight><bold>206</bold></highlight>) is outside of the window, then the commanded air/fuel ratio (provided to the engine cylinders) is linearly ramped so as to urge the oxidant storage in the catalyst toward the oxidant set point. For example, when the estimated oxidant volume is greater than the upper limit of the window, then the commanded air/fuel ratio is linearly ramped in the rich direction, and when the estimated oxidant volume is less than the lower limit of the window, then the commanded air/fuel ratio is linearly ramped in the lean direction. When the estimated oxidant volume is between the lower and upper limits of the window, the air/fuel ratio is urged toward the oxidant set point according to a value that is proportional to the difference between the estimated volume of oxidant stored in the catalyst <highlight><bold>52</bold></highlight> and the oxidant set point. Further details of the preferred proportional-integral air/fuel ratio control strategy are set forth in the Hamburg patent. </paragraph>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> IIn addition to calculating a proportional-integral fuel bias term, the set point error is also used to schedule an open loop fuel demand value based on the estimated oxidant level in the catalyst. At block <highlight><bold>744</bold></highlight>, the system determines whether to apply the closed-loop proportional-integral fuel bias term or the open loop fuel demand, based on various operating parameters, as is known in the art. For example, the open-loop fuel demand parameter may be used in place of the closed-loop fuel bias term in the event of a very large set point error value, indicating irregularities in the system. The open-loop fuel demand parameter may also be used just after the vehicle has been operated in a deceleration fuel shut-off mode, in which case a period of rich air/fuel operation is required to control the abundance of NOx in the system. Further, the open-loop fuel demand parameter may be used just after the vehicle has been operated according to an open-loop enrichment mode (where fuel is used to keep catalyst temperatures down during high load conditions), in which case a period of lean air/fuel operation is desirable to re-oxidize the catalyst and lower hydrocarbon emissions. Whether open loop rich or lean, the magnitude and duration are used to facilitate a rapid return to the O<highlight><subscript>2 </subscript></highlight>set point. Finally, as shown at block <highlight><bold>746</bold></highlight>, either the closed-loop fuel bias term or the open loop fuel demand parameter is provided to the engine controller <highlight><bold>15</bold></highlight>, which adjusts the fuel provided to the engine cylinders based thereon. </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> TThe second objective of the oxidant level/capacity controller (<highlight><bold>232</bold></highlight>), i.e., oxidant capacity control of the catalyst <highlight><bold>52</bold></highlight>, will now be discussed in more detail. Referring again to <cross-reference target="DRAWINGS">FIG. 7</cross-reference>, the following inputs are used to calculate delta spark and induction air mass bias values: (i) available oxidant storage in each brick (<highlight><bold>227</bold></highlight>); (ii) current oxidant storage in each brick (<highlight><bold>231</bold></highlight>); (iii) engine spark driveability limits (<highlight><bold>216</bold></highlight>); exhaust flange temperature (<highlight><bold>220</bold></highlight>); and MBT spark (<highlight><bold>222</bold></highlight>). First, the estimates of available oxidant storage and current oxidant storage in each of the catalyst bricks are summed (blocks <highlight><bold>710</bold></highlight> and <highlight><bold>711</bold></highlight>), resulting in an estimate of the total available oxidant storage in the catalyst and an estimate of the total current amount of oxidants stored in the catalyst, respectively. Then, the total available oxidant storage value (<highlight><bold>710</bold></highlight>) is compared to the total current estimated oxidant storage in the catalyst (<highlight><bold>711</bold></highlight>) at block <highlight><bold>713</bold></highlight>. At block <highlight><bold>702</bold></highlight>, a spark retard value is calculated based on the difference between available oxidant storage and current oxidant storage in the catalyst (from block <highlight><bold>713</bold></highlight>) and spark driveability limits (<highlight><bold>216</bold></highlight>). In the preferred embodiment of the invention, the spark retard value (<highlight><bold>702</bold></highlight>) is read from a look-up table, wherein the values are empirically determined. The spark retard values in the look-up table generally describe the well-known relationship between oxidant storage and brick temperature, as shown in the graph set forth in <cross-reference target="DRAWINGS">FIG. 8A</cross-reference>. The spark driveability limits, which are pre-determined inputs to the system, limit the magnitude of the spark retard (<highlight><bold>702</bold></highlight>) to ensure that vehicle driveability is not compromised. </paragraph>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> AAt block <highlight><bold>703</bold></highlight>, a spark retard gain is calculated based on the exhaust flange temperature (<highlight><bold>220</bold></highlight>). Generally, if the flange temperature (<highlight><bold>220</bold></highlight>) is relatively high, or increasing, due to high air mass flow or engine air/fuel ratio, then the oxidant storage capacity of the catalyst will increase independently of the spark. Thus, a relatively hot flange will permit the catalyst to achieve a desired temperature (and thus oxidant storage capacity) with a relatively lesser delta spark. This is desirable to improve fuel economy. In the preferred embodiment of the invention, the spark retard gain (<highlight><bold>703</bold></highlight>) is read from a look-up table, the values of which are empirically-determined. In general, the values in the spark retard gain table follow the graphical function illustrated in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>. The spark retard gain (<highlight><bold>703</bold></highlight>) is multiplied by the spark retard value (<highlight><bold>702</bold></highlight>), as shown at block <highlight><bold>704</bold></highlight>, which results in a delta spark value (<highlight><bold>728</bold></highlight>). The delta spark value (<highlight><bold>728</bold></highlight>) is provided to the engine controller <highlight><bold>15</bold></highlight> to adjust the engine spark, and ultimately the oxidant storage capacity of the catalyst. Generally speaking, the larger the difference between the total available oxidant storage in the catalyst and the total current oxidant storage in the catalyst, the greater the delta spark value. </paragraph>
<paragraph id="P-0085" lvl="0"><number>&lsqb;0085&rsqb;</number> However, as spark retard increases, engine rpm will fall if not compensated by additional air mass flow through the engine. Accordingly, the delta spark value (<highlight><bold>728</bold></highlight>) is used with the MBT spark input value (<highlight><bold>222</bold></highlight>) at block <highlight><bold>706</bold></highlight> to calculate a required engine torque value, as is known in the art. At block <highlight><bold>708</bold></highlight>, the induction air mass necessary to maintain the required torque is calculated. In the preferred embodiment of the invention, the desired air mass flow is calculated by dividing the base air mass flow requirements of the engine by an adjustment factor, which is read from a look-up table. The adjustment factors in the look-up table range from 1, when at MBT, to some fractional value down to zero as spark retard increases. Thus, as spark retard increases, the desired air mass flow increases. This air mass value comprises the air mass bias value (<highlight><bold>730</bold></highlight>), which is used by the engine controller <highlight><bold>15</bold></highlight> to adjust the induction air mass in the engine <highlight><bold>13</bold></highlight>. The adjustments to the engine spark and induction air mass adjust the temperature of the exhaust expelled from the engine and thus, ultimately, the temperature of the catalyst <highlight><bold>52</bold></highlight>. Because the oxidant storage capacity of the catalyst <highlight><bold>52</bold></highlight> depends on its temperature, the engine controller <highlight><bold>15</bold></highlight> is able to adjust the oxidant storage capacity of the catalyst <highlight><bold>52</bold></highlight> by adjusting the engine spark and induction air mass flow. This aspect of the invention is particularly useful during certain vehicle operating conditions when the catalyst temperature may fall to a level that would otherwise limit the oxidant storage capacity of the catalytic converter <highlight><bold>52</bold></highlight> to an undesirable small amount. By controlling engine operating conditions to provide a desired catalyst temperature, a certain minimum amount of total oxidant storage capacity can be maintained so that it is possible to control the actual oxidant storage to a mid-region and prevent break-through of emissions on the lean and rich air/fuel sides. </paragraph>
<paragraph id="P-0086" lvl="0"><number>&lsqb;0086&rsqb;</number> TThe third objective of the oxidant level/capacity controller is to determine reset/adaptive parameters that are used to adjust the operation of the system on a feed-back basis. The reset/adaptive parameters (<highlight><bold>732</bold></highlight>) are calculated based on the following inputs: (i) current oxidant storage in each brick (<highlight><bold>231</bold></highlight>); (ii) oxygen sensor feedback from each brick (<highlight><bold>214</bold></highlight>); (iii) induction air mass (<highlight><bold>202</bold></highlight>); and (iv) measured air/fuel ratio in the exhaust (<highlight><bold>212</bold></highlight>). The feedback signals from the oxygen sensors associated with each of the catalyst bricks (<highlight><bold>214</bold></highlight>) (exemplary sensors <highlight><bold>902</bold></highlight>, <highlight><bold>904</bold></highlight>, and <highlight><bold>905</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>), which are in terms of voltage levels, are converted to oxidant concentration values at block <highlight><bold>712</bold></highlight>. A similar function is performed at block <highlight><bold>716</bold></highlight> to convert the feedback signal from the pre-catalyst oxygen sensor <highlight><bold>54</bold></highlight> located in the exhaust stream to an oxidant concentration value. At block <highlight><bold>714</bold></highlight>, the measured air mass flow rate (<highlight><bold>202</bold></highlight>) in the induction passage is integrated over a sample time interval to provide a total air mass in terms of grams. At block <highlight><bold>718</bold></highlight>, a time constant value is determined from a look-up table based on air mass. The time constant is used to align the pre-catalyst oxygen sensor <highlight><bold>54</bold></highlight> and the post-catalyst oxygen sensor <highlight><bold>53</bold></highlight> in time to facilitate an accurate measure of the oxidants that are adsorbed or desorbed in the catalyst. </paragraph>
<paragraph id="P-0087" lvl="0"><number>&lsqb;0087&rsqb;</number> AAt block <highlight><bold>720</bold></highlight>, the measured oxidant concentrations of the individual bricks (from block <highlight><bold>721</bold></highlight>) are multiplied by the total air mass in grams (from block <highlight><bold>714</bold></highlight>). The result of block <highlight><bold>720</bold></highlight> is the amount of oxidants measured at the catalyst brick. Similarly, the time constant determined from the look-up table (block <highlight><bold>718</bold></highlight>) is multiplied by the total air mass (from block <highlight><bold>714</bold></highlight>) at block <highlight><bold>722</bold></highlight>. The result is the amount of oxidants measured in the exhaust stream. At block <highlight><bold>724</bold></highlight>, the results of blocks <highlight><bold>720</bold></highlight> and <highlight><bold>722</bold></highlight> are compared, and the result is integrated over a time constant (in block <highlight><bold>725</bold></highlight>) to give a total measured amount of oxidants in the exhaust stream over the given time period. The final integrated result is the total measured amount of oxidants stored in the catalyst <highlight><bold>52</bold></highlight>. At block <highlight><bold>726</bold></highlight>, the total measured amount of oxidants stored in the catalyst is compared to the estimated amount of oxidants stored in the catalyst (estimated from the oxidant predictor model). The result is an observer error. The observer error represents the degree of disagreement between the measured level of oxidant storage in the catalyst and the estimated level of oxidant storage in the catalyst. Based on the observer error, an observer gain is calculated at block <highlight><bold>728</bold></highlight>. The observer gain is used to adjust the two-dimensional look-up table of feedback parameters C<highlight><subscript>4 </subscript></highlight>(described above) that are used to adjust the oxidant level predictor (<highlight><bold>608</bold></highlight>). Specifically, at block <highlight><bold>730</bold></highlight>, the observer gain is multiplied by each of the C<highlight><subscript>4 </subscript></highlight>feedback parameters in the two-dimensional look-up table. At block <highlight><bold>732</bold></highlight>, the recalculated two-dimensional look-up table of C<highlight><subscript>4 </subscript></highlight>values is provided to the oxidant level predictor (<highlight><bold>608</bold></highlight>) and other algorithms in the system requiring closed-loop feedback adjustments. </paragraph>
<paragraph id="P-0088" lvl="0"><number>&lsqb;0088&rsqb;</number> FFurther, a reset parameter is calculated at block <highlight><bold>730</bold></highlight> based on the magnitude of the oxidant feedback error. If the oxidant feedback error is greater than a certain reference value, then a reset parameter indicative of resetting the oxidant predictor model (<highlight><bold>608</bold></highlight>) to either a low oxidant level or a high oxidant level, as the case may be, is determined </paragraph>
<paragraph id="P-0089" lvl="0"><number>&lsqb;0089&rsqb;</number> The description of the preferred embodiment of the invention focuses on a system having one catalytic converter (<highlight><bold>52</bold></highlight>). However, the scope of the invention also includes systems comprising multiple upstream and downstream catalytic converters, wherein each of the catalytic converters can have one or more internal catalyst bricks. For systems having multiple catalytic converters, the above-described system would be adapted as now described. </paragraph>
<paragraph id="P-0090" lvl="0"><number>&lsqb;0090&rsqb;</number> In particular, adaptation of the oxygen storage model from a single brick to multiple brick system is accomplished by cascading oxygen output from upstream bricks to downstream bricks. The ratio of air to fuel, a measure of excess/deficiency O<highlight><bold>2</bold></highlight> from stoichiometery, entering the first brick is measured or calculated from the fuel control algorithm. Therefore, the excess/deficiency of oxygen can be calculated as described earlier. The amount of oxygen adsorbed/desorbed by the first brick from the exhaust gas is calculated as described. By adding the oxygen stored or supplied to the exhaust feed gas the post brick a/f, excess/deficiency can be calculated. The second brick o<highlight><bold>2</bold></highlight> storage is then calculated with a similar set of equations, modified for temperature and washcoat differences. In this way output from one brick is cascaded to the following brick. </paragraph>
<paragraph id="P-0091" lvl="0"><number>&lsqb;0091&rsqb;</number> While preferred embodiments of the present invention have been described herein, it is apparent that the basic construction can be altered to provide other embodiments that utilize the processes and compositions of this invention. Therefore, it will be appreciated that the scope of this invention is to be defined by the claims appended hereto rather than by the specific embodiments that have been presented hereinbefore by way of example. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. A method for controlling engine air-fuel ratio of an engine coupled to an emission control device having a predetermined length in a direction of exhaust flow, comprising: 
<claim-text>selecting a position along the length of the emission control device; and </claim-text>
<claim-text>adjusting an operating parameter that affects engine air-fuel ratio based on an amount of oxidants stored in the emission control device and said position. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The method recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein said selected position is based on temperature of the emission control device. </claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The method recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein said selected position is based on an oxidant storage capacity of the emission control device. </claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The method recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein said selected position is based on a number of bricks in the emission control device. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. the method recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein said emission control device comprises multiple catalyst bricks. </claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The method recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein said selected position is based on temperatures along the length of the emission control device. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. The method recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein said selected position is based on degradation of the emission control device. </claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. A method for controlling engine air-fuel ratio of an engine coupled to an emission control device having a predetermined length in a direction of exhaust flow, comprising: 
<claim-text>selecting a position along the length of the emission control device based on an amount of oxidant storage capacity of the emission control device; and </claim-text>
<claim-text>adjusting an operating parameter that affects engine air-fuel ratio based on an amount of oxidants stored in the emission control device before said position. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. A system for controlling engine air-fuel ratio of an engine coupled to an emission control device having a predetermined length in a direction of exhaust flow, comprising: 
<claim-text>means for calculating an amount of oxidant storage capacity of the emission control device based on operating conditions; </claim-text>
<claim-text>means for selecting a position along the length of the emission control device based on said amount of oxidant storage capacity of the emission control device and temperatures along the length of the emission control device; and </claim-text>
<claim-text>means for adjusting an operating parameter that affects engine air-fuel ratio based on an amount of oxidants stored in the emission control device before said position. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. A method for controlling engine air-fuel ratio of an engine coupled to an emission control device having a predetermined length in a direction of exhaust flow, the emission control device having multiple catalyst bricks, the method comprising: 
<claim-text>selecting a position along the length of the emission control device based on temperatures of the bricks of the emission control device and deterioration of the emission control device to provide a predetermined amount of oxidant storage capacity behind said position; </claim-text>
<claim-text>calculating an amount of oxidants stored in the emission control device before said position based on engine operating conditions; and adjusting an operating parameter that affects engine air-fuel ratio based on said amount of oxidants stored in the emission control device.</claim-text>
</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>1</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030000205A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030000205A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030000205A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030000205A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030000205A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030000205A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030000205A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030000205A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030000205A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00009">
<image id="EMI-D00009" file="US20030000205A1-20030102-D00009.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
