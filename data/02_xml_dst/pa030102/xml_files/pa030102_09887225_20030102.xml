<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030002450A1-20030102-M00001.NB SYSTEM "US20030002450A1-20030102-M00001.NB" NDATA NB>
<!ENTITY US20030002450A1-20030102-M00001.TIF SYSTEM "US20030002450A1-20030102-M00001.TIF" NDATA TIF>
<!ENTITY US20030002450A1-20030102-M00002.NB SYSTEM "US20030002450A1-20030102-M00002.NB" NDATA NB>
<!ENTITY US20030002450A1-20030102-M00002.TIF SYSTEM "US20030002450A1-20030102-M00002.TIF" NDATA TIF>
<!ENTITY US20030002450A1-20030102-M00003.NB SYSTEM "US20030002450A1-20030102-M00003.NB" NDATA NB>
<!ENTITY US20030002450A1-20030102-M00003.TIF SYSTEM "US20030002450A1-20030102-M00003.TIF" NDATA TIF>
<!ENTITY US20030002450A1-20030102-M00004.NB SYSTEM "US20030002450A1-20030102-M00004.NB" NDATA NB>
<!ENTITY US20030002450A1-20030102-M00004.TIF SYSTEM "US20030002450A1-20030102-M00004.TIF" NDATA TIF>
<!ENTITY US20030002450A1-20030102-M00005.NB SYSTEM "US20030002450A1-20030102-M00005.NB" NDATA NB>
<!ENTITY US20030002450A1-20030102-M00005.TIF SYSTEM "US20030002450A1-20030102-M00005.TIF" NDATA TIF>
<!ENTITY US20030002450A1-20030102-M00006.NB SYSTEM "US20030002450A1-20030102-M00006.NB" NDATA NB>
<!ENTITY US20030002450A1-20030102-M00006.TIF SYSTEM "US20030002450A1-20030102-M00006.TIF" NDATA TIF>
<!ENTITY US20030002450A1-20030102-M00007.NB SYSTEM "US20030002450A1-20030102-M00007.NB" NDATA NB>
<!ENTITY US20030002450A1-20030102-M00007.TIF SYSTEM "US20030002450A1-20030102-M00007.TIF" NDATA TIF>
<!ENTITY US20030002450A1-20030102-M00008.NB SYSTEM "US20030002450A1-20030102-M00008.NB" NDATA NB>
<!ENTITY US20030002450A1-20030102-M00008.TIF SYSTEM "US20030002450A1-20030102-M00008.TIF" NDATA TIF>
<!ENTITY US20030002450A1-20030102-M00009.NB SYSTEM "US20030002450A1-20030102-M00009.NB" NDATA NB>
<!ENTITY US20030002450A1-20030102-M00009.TIF SYSTEM "US20030002450A1-20030102-M00009.TIF" NDATA TIF>
<!ENTITY US20030002450A1-20030102-D00000.TIF SYSTEM "US20030002450A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030002450A1-20030102-D00001.TIF SYSTEM "US20030002450A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030002450A1-20030102-D00002.TIF SYSTEM "US20030002450A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030002450A1-20030102-D00003.TIF SYSTEM "US20030002450A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030002450A1-20030102-D00004.TIF SYSTEM "US20030002450A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030002450A1-20030102-D00005.TIF SYSTEM "US20030002450A1-20030102-D00005.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030002450</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>09887225</doc-number>
</application-number>
<application-number-series-code>09</application-number-series-code>
<filing-date>20010622</filing-date>
</domestic-filing-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>H04L005/14</ipc>
</classification-ipc-primary>
<classification-ipc-secondary>
<ipc>H04B007/216</ipc>
</classification-ipc-secondary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>370</class>
<subclass>294000</subclass>
</uspc>
</classification-us-primary>
<classification-us-secondary>
<uspc>
<class>370</class>
<subclass>342000</subclass>
</uspc>
</classification-us-secondary>
<classification-us-secondary>
<uspc>
<class>370</class>
<subclass>347000</subclass>
</uspc>
</classification-us-secondary>
</classification-us>
<title-of-invention>Method and apparatus for transmitting data in a time division duplexed (TDD) communication system</title-of-invention>
</technical-information>
<inventors>
<first-named-inventor>
<name>
<given-name>Ahmad</given-name>
<family-name>Jalali</family-name>
</name>
<residence>
<residence-us>
<city>San Diego</city>
<state>CA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>John</given-name>
<middle-name>E.</middle-name>
<family-name>Smee</family-name>
</name>
<residence>
<residence-us>
<city>San Diego</city>
<state>CA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Mark</given-name>
<family-name>Wallace</family-name>
</name>
<residence>
<residence-us>
<city>Bedford</city>
<state>MA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<correspondence-address>
<name-1>QUALCOMM Incorporated</name-1>
<name-2>Attn: Patent Department</name-2>
<address>
<address-1>5775 Morehouse Drive</address-1>
<city>San Diego</city>
<state>CA</state>
<postalcode>92121-1714</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">Techniques to process data for transmission in a time division duplexed (TDD) communication system. In one aspect, the frequency response of a forward link is estimated at a base station based on reverse link transmissions (e.g., pilots) from a terminal. Prior to a data transmission on the forward link, the base station determines a reverse transfer function based on the pilots transmitted by the terminal, &ldquo;calibrates&rdquo; the reverse transfer function with a calibration function to derive an estimate of a forward transfer function, and preconditions modulation symbols based on weights derived from the forward transfer function. In another aspect, the terminal estimates the &ldquo;quality&rdquo; of the forward link and provides this information to the base station. The base station then uses the information to properly code and modulate data prior to transmission such that the transmitted data can be received by the terminal at the desired level of performance. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">BACKGROUND </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> 1. Field </paragraph>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> The present invention relates generally to data communication, and more specifically to techniques for processing data for transmission in a time division duplexed (TDD) communication system. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> 2. Background </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> A multi-channel communication system is often deployed to provide increased transmission capacity for various types of communication such as voice, data, and so on. Such a multi-channel system may be a multiple-input multiple-output (MIMO) communication system, an orthogonal frequency division modulation (OFDM) system, a MIMO system that utilizes OFDM, or some other type of system. A MIMO system employs multiple transmit antennas and multiple receive antennas to exploit spatial multiplexing to support a number of spatial subchannels, each of which may be used to transmit data. An OFDM system effectively partitions the operating frequency band into a number of frequency subchannels (or frequency bins or subbands), each of which is associated with a respective sub-carrier on which data may be modulated. A multi-channel communication system thus supports a number of &ldquo;transmission&rdquo; channels, each of which may correspond to a spatial subchannel in a MIMO system, a frequency subchannel in an OFDM system, or a spatial subchannel of a frequency subchannel in a MIMO system that utilizes OFDM. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> The transmission channels of a multi-channel communication system typically experience different link conditions (e.g., due to different fading and multipath effects) and may achieve different signal-to-noise-plus-interference ratios (SNRs). Consequently, the transmission capacities (i.e., the information bit rates) that may be supported by the transmission channels for a particular level of performance may be different from channel to channel. Moreover, the link conditions typically vary over time. As a result, the bit rates supported by the transmission channels also vary with time. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> A time division duplexed (TDD) communication system transmits data on the forward and reverse links via the same frequency band. The forward link refers to transmission from a base station to a terminal and the reverse link refers to transmission from the terminal to the base station. In the TDD system, the transmission time is partitioned into time slots, and some of the time slots are allocated for forward link transmission and remaining time slots are allocated for reverse link transmission. Because the forward and reverse links share the same frequency band, the characteristics of the forward link may be estimated by measuring the characteristics of the reverse link, and vice versa. This reciprocity property of the forward and reverse link propagation may be used to more easily characterize the communication link. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> Given the above, techniques that can be used to (1) exploit the reciprocal property of the forward and reverse links in a TDD communication system and (2) process data for transmission on multiple transmission channels with different capacities to achieve high performance are highly desirable. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY </heading>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> Aspects of the invention provide various techniques to process data for transmission in a time division duplexed (TDD) communication system. In one aspect, the frequency response of a forward link is estimated at a base station based on reverse link transmissions (e.g., pilot references) from a terminal. Initially, an overall transfer function, H<highlight><subscript>f</subscript></highlight>(&ohgr;), of a forward link transmission from the base station to the terminal and an overall transfer function, H<highlight><subscript>r</subscript></highlight>(&ohgr;), of a reverse link transmission on the reciprocal reverse link from the terminal to the base station are used to derive a calibration function, a(&ohgr;), which is descriptive of the difference between the forward and reverse transfer functions. Prior to a data transmission on the forward link, the base station determines the reverse transfer function based on the pilot references transmitted by the terminal. The base station then &ldquo;calibrates&rdquo; the reverse transfer function with the calibration function to derive an estimate of the forward transfer function, which is then used to precondition modulation symbols prior to transmission to the terminal. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> In another aspect, the terminal estimates the &ldquo;quality&rdquo; of the forward link and provides this information to the base station. The forward link quality may be quantified by a signal-to-noise-plus-interference ratio (SNR), a noise-plus-interference, or some other measurement. The forward link quality may be estimated at the terminal based on pilot reference, packet data, or some other signals transmitted on the forward link. The forward link quality estimate is then represented in a particular form and sent to the base station, which then uses the information to properly code and modulate data prior to transmission such that the transmitted data can be received by the terminal at the desired level of performance. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> The techniques described herein may be applied for data transmission on the forward and reverse links. The invention further provides methods, systems, and apparatus that implement various aspects, embodiments, and features of the invention, as described in further detail below.</paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> The features, nature, and advantages of the present invention will become more apparent from the detailed description set forth below when taken in conjunction with the drawings in which like reference characters identify correspondingly throughout and wherein: </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a diagram of a time division duplexed (TDD) communication system capable of implementing various aspects and embodiments of the invention; </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a flow diagram of an embodiment of a process to derive a calibration function and to precondition modulation symbols prior to transmission; </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> <cross-reference target="DRAWINGS">FIGS. 3A and 3B</cross-reference> show a block diagram of a specific design of a transmitter unit within a base station, which utilizes MIMO and OFDM and is capable of processing data in accordance with an embodiment of the invention; and </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a block diagram of a specific design of a receiver unit within a terminal, which is capable of receiving data in accordance with an embodiment of the invention.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION </heading>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a diagram of a time division duplexed (TDD) communication system <highlight><bold>100</bold></highlight> capable of implementing various aspects and embodiments of the invention. System <highlight><bold>100</bold></highlight> may be a wireless local area network (LAN) or some other type of system, and includes a base station <highlight><bold>110</bold></highlight> in communication with one or more terminals <highlight><bold>150</bold></highlight> (only one terminal is shown for simplicity). System <highlight><bold>100</bold></highlight> transmits data on the forward and reverse links in a time division duplexed manner via the same frequency band. For the TDD system, the transmission time is partitioned into time slots, and some of the time slots are allocated for forward link transmission and remaining time slots are allocated for reverse link transmission. For example, the forward and reverse links may be allocated alternating time slots. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> The techniques described herein may be applied for data transmission on the forward and reverse links. However, for clarity, various aspects and embodiments of the invention are specifically described below for the forward link transmission. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> System <highlight><bold>100</bold></highlight> supports one or more transmission channels on each of the forward and reverse links, and some or all of the available transmission channels may be used for data transmission at any given moment. The number of transmission channels on the forward link needs not be equal to the number of transmission channels on the reverse link. Multiple transmission channels may be provided via multiple-input multiple-output (MIMO), orthogonal frequency division modulation (OFDM), MIMO in combination with OFDM, or some other constructs. System <highlight><bold>100</bold></highlight> may also implement code division multiple access (CDMA), time division multiple access (TDMA), frequency division multiple access (FDMA), or some other multiple access techniques. Multiple access techniques can be used to support concurrent communication with a number of terminals. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> A MIMO system employs multiple (N<highlight><subscript>T</subscript></highlight>) transmit antennas and multiple (N<highlight><subscript>R</subscript></highlight>) receive antennas for data transmission. A MIMO channel formed by the N<highlight><subscript>T </subscript></highlight>transmit and N<highlight><subscript>R </subscript></highlight>receive antennas may be decomposed into N<highlight><subscript>C </subscript></highlight>independent channels, with N<highlight><subscript>C &lE;min &lcub;N</subscript></highlight><highlight><subscript>T</subscript></highlight>, N<highlight><subscript>R</subscript></highlight>&rcub;. Each of the N<highlight><subscript>C </subscript></highlight>independent channels is also referred to as a spatial subchannel of the MIMO channel and corresponds to a dimension. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> An OFDM system effectively partitions the operating frequency band into a number of (N<highlight><subscript>F</subscript></highlight>) frequency subchannels (i.e., frequency bins or subbands). At each time slot, a modulation symbol may be transmitted on each of the N<highlight><subscript>F </subscript></highlight>frequency subchannels. Each time slot corresponds to a particular time interval that may be dependent on the bandwidth of the frequency subchannel. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> System <highlight><bold>100</bold></highlight> may be operated to transmit data via one or more transmission channels on each of the forward and reverse links. If MIMO is employed but not OFDM, there is typically only one frequency subchannel and each spatial subchannel may be referred to as a transmission channel. If OFDM is employed but not MIMO, there is only one spatial subchannel for each frequency subchannel and each frequency subchannel may be referred to as a transmission channel. And if both MIMO and OFDM are employed, each spatial subchannel of each frequency subchannel may be referred to as a transmission channel. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> The techniques described herein may be applied to TDD systems employing one or more transmission channels. For clarity, various aspects are described below in which the TDD system employs MIMO and OFDM, although neither MIMO nor OFDM is necessary to implement the inventive techniques described herein. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, system <highlight><bold>100</bold></highlight> may be operated to employ a combination of antenna, frequency, and temporal diversity to increase spectral efficiency, improve performance, and enhance flexibility. In an aspect, base station <highlight><bold>110</bold></highlight> can be operated to estimate the characteristics of the communication link between the base station and terminal and to derive channel state information (CSI) indicative of the estimated link characteristics. Base station <highlight><bold>110</bold></highlight> can then be operated to adjust the processing (e.g., encoding, modulation, and preconditioning) of data prior to transmission to terminal <highlight><bold>150</bold></highlight> based on the CSI derived at the base station and/or the CSI provided to the base station (e.g., from the terminal). </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> At base station <highlight><bold>110</bold></highlight>, a data source <highlight><bold>112</bold></highlight> provides packet data (i.e., information bits) to a transmit (TX) data processor <highlight><bold>114</bold></highlight>, which (1) encodes the packet data in accordance with a particular encoding scheme, (2) interleaves (i.e., reorders) the encoded data based on a particular interleaving scheme, (3) channelizes the interleaved data and pilot data on their respective code channels (if code division multiplexing is used), and (4) maps the channelized packet and pilot data into modulation symbols for one or more transmission channels used for data transmission. The encoding increases the reliability of the data transmission. The interleaving provides time diversity for the coded bits, permits the data to be transmitted based on an average signal-to-noise-plus-interference-ratio (SNR) for the transmission channels used for the data transmission, combats fading, and further removes correlation between the coded bits used to form each modulation symbol. The interleaving may further provide frequency diversity if the coded bits are transmitted over multiple frequency subchannels. The channelization allows the packet and pilot data to be separated at the terminal. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> In an aspect, the coding, interleaving, and symbol mapping (or any combination thereof) may be performed based on the CSI available to base station <highlight><bold>110</bold></highlight>, as indicated in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. The encoding, interleaving, and symbol mapping at base station <highlight><bold>110</bold></highlight> may be performed based on numerous schemes, some of which are described in further detail below. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> A TX channel processor <highlight><bold>120</bold></highlight> receives and demultiplexes the modulation symbols from TX data processor <highlight><bold>114</bold></highlight> and further preconditions the modulation symbols as described below. If MIMO employed, TX channel processor <highlight><bold>120</bold></highlight> provides a stream of preconditioned modulation symbols for each antenna used for data transmission. If OFDM is employed, TX channel processor <highlight><bold>120</bold></highlight> provides a stream of preconditioned modulation symbol vectors for each antenna used for data transmission, one vector for each time slot with each vector including one modulation symbol for each frequency subchannel. Each stream is then received and modulated by a respective modulator (MOD) <highlight><bold>122</bold></highlight> and transmitted via an associated antenna <highlight><bold>124</bold></highlight>. </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> At terminal <highlight><bold>150</bold></highlight>, one or more antennas <highlight><bold>152</bold></highlight> receive the transmitted signals and each antenna provides a respective received signal to an associated demodulator (DEMOD) <highlight><bold>154</bold></highlight>. Each demodulator <highlight><bold>154</bold></highlight> performs processing complementary to that performed at modulator <highlight><bold>122</bold></highlight>. The received modulation symbols from all demodulators <highlight><bold>154</bold></highlight> are then provided to a receive (RX) channel processor <highlight><bold>156</bold></highlight>, which performs receiver processing complementary to the processing performed by TX channel processor <highlight><bold>120</bold></highlight>. RX channel processor <highlight><bold>156</bold></highlight> provides recovered modulation symbols to a RX data processor <highlight><bold>158</bold></highlight>, which processes the symbols to recover the transmitted data streams. RX data processor <highlight><bold>158</bold></highlight> performs processing complementary to that performed by TX data processor <highlight><bold>114</bold></highlight>. The decoded data is then provided to a data sink <highlight><bold>160</bold></highlight>. The processing by base station <highlight><bold>110</bold></highlight> and terminal <highlight><bold>150</bold></highlight> is described in further detail below. </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> The one or more transmission channels available to system <highlight><bold>100</bold></highlight> typically experience different link conditions (e.g., due to different fading and multipath effects) and may achieve different SNRs. Consequently, the capacity of the transmission channels may differ from channel to channel. This capacity may be quantified by the information bit rate (i.e., the number of information bits per modulation symbol) that may be transmitted on each transmission channel for a particular level of performance (e.g., a particular bit error rate (BER) or packet error rate (PER)). Since the link conditions typically vary with time, the supported information bit rates for the transmission channels also vary with time. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> To more fully utilize the capacity of the transmission channels, channel state information (CSI) descriptive of the forward link may be determined and used to process (e.g., encode, modulate, and precondition) data such that the transmitted information bit rates match the transmission capacities of the transmission channels. The CSI may include various types of information and may be derived and/or provided in various forms, some of which are described below. </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> One type of CSI relates to the &ldquo;quality&rdquo; of the forward link. This quality may be quantified by the SNRs of individual transmission channels or an average SNR of each group of transmission channels, the rates or average rate supported by the channels, and coding and modulation schemes supported by the channels, and so on, as described below. Information descriptive of the forward link quality may be used to properly code and modulate data prior to transmission such that the transmitted data may be recovered by the terminal with the desired level of performance (1% PER). Estimation and use of the forward link quality is described in further detail below. </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> Another type of CSI relates to the &ldquo;response&rdquo; of the forward link. This response may be quantified by the amplitude and phase across the entire operating frequency band for the propagation path between each transmit-receive antenna pair used for data transmission. Information descriptive of the forward link response may be used to precondition modulation symbols prior to transmission to orthogonalize the spatial subchannels, which may improve performance. Characterization of the forward link response and preconditioning of the modulation symbols are also described in further detail below. </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> Various types of transmission may be used to characterize the forward link response and to estimate the forward link quality. For example, pilot data (i.e., data of a known pattern such as a sequence of all zeros), packet data, signaling, and possibly other types of transmission may be used. For clarity, various aspects and embodiments of the invention, including the characterization of the forward link response and the estimation of the quality of the forward link, are described below based on the use of pilot reference. </paragraph>
</section>
<section>
<heading lvl="1">Characterization of Forward Link Response </heading>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> For a TDD communication system, a single frequency band is used for both the forward and reverse links, and the propagation paths for the forward and reverse links are reciprocal. In this case, the characteristics of the forward link may be estimated based on measurements of the reverse link, and vice versa, if the time-variant changes in the communication link are slow relative to the difference between the time the link is estimated and the time the estimates are used. For example, if the forward and reverse links are assigned alternating time slots, then the time slots should be short enough so that the communication link does not change appreciably between the time slot in which the link is characterized and the time slot in which the link characterization is applied for a data transmission. </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> In accordance with an aspect of the invention, the response of the forward link is estimated at the base station based on reverse link transmissions from the terminal. An overall transfer function, H<highlight><subscript>f</subscript></highlight>(&ohgr;), of a forward link transmission from the base station to the terminal and an overall transfer function, H<highlight><subscript>r</subscript></highlight>(&ohgr;), of a reverse link transmission on the reciprocal reverse link from the terminal to the base station may be expressed as:  
<math-cwu id="MATH-US-00001">
<number>1</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mrow>
              <msub>
                <mi>H</mi>
                <mi>f</mi>
              </msub>
              <mo>&af;</mo>
              <mrow>
                <mo>(</mo>
                <mi>&omega;</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>=</mo>
            <mrow>
              <mrow>
                <msub>
                  <mi>T</mi>
                  <mi>f</mi>
                </msub>
                <mo>&af;</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>&omega;</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>&it;</mo>
              <mrow>
                <mi>C</mi>
                <mo>&af;</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>&omega;</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>&it;</mo>
              <mrow>
                <msub>
                  <mi>R</mi>
                  <mi>f</mi>
                </msub>
                <mo>&af;</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>&omega;</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mo>,</mo>
          <mi>and</mi>
        </mrow>
        <mo>&it;</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <mrow>
            <mrow>
              <msub>
                <mi>H</mi>
                <mi>r</mi>
              </msub>
              <mo>&af;</mo>
              <mrow>
                <mo>(</mo>
                <mi>&omega;</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>=</mo>
            <mrow>
              <mrow>
                <msub>
                  <mi>T</mi>
                  <mi>r</mi>
                </msub>
                <mo>&af;</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>&omega;</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>&it;</mo>
              <mrow>
                <mi>C</mi>
                <mo>&af;</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>&omega;</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>&it;</mo>
              <mrow>
                <msub>
                  <mi>R</mi>
                  <mi>r</mi>
                </msub>
                <mo>&af;</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>&omega;</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mo>,</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Eq</mi>
        <mo>&it;</mo>
        <mstyle>
          <mtext>&emsp;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <mo>(</mo>
          <mn>1</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00001" file="US20030002450A1-20030102-M00001.NB"/>
<image id="EMI-M00001" wi="216.027" he="22.08465" file="US20030002450A1-20030102-M00001.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0035" lvl="7"><number>&lsqb;0035&rsqb;</number> where </paragraph>
<paragraph id="P-0036" lvl="2"><number>&lsqb;0036&rsqb;</number> T<highlight><subscript>f</subscript></highlight>(&ohgr;) is a transfer function for the aggregate processing at the base station for the forward link transmission (e.g., the transfer function for TX channel processor <highlight><bold>120</bold></highlight> and modulator <highlight><bold>122</bold></highlight> within base station <highlight><bold>110</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>); </paragraph>
<paragraph id="P-0037" lvl="2"><number>&lsqb;0037&rsqb;</number> R<highlight><subscript>f</subscript></highlight>(&ohgr;) is a transfer function for the aggregate processing at the terminal for the forward link transmission (e.g., the transfer function for demodulator <highlight><bold>154</bold></highlight> and RX channel processor <highlight><bold>156</bold></highlight> within terminal <highlight><bold>150</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>); </paragraph>
<paragraph id="P-0038" lvl="2"><number>&lsqb;0038&rsqb;</number> C(&ohgr;) is the channel frequency response (e.g., for a particular propagation path or transmit-receive antenna pair); </paragraph>
<paragraph id="P-0039" lvl="2"><number>&lsqb;0039&rsqb;</number> T<highlight><subscript>r</subscript></highlight>(&ohgr;) is a transfer function for the aggregate processing at the terminal for the reverse link transmission (e.g., the transfer function for TX channel processor <highlight><bold>162</bold></highlight> and modulator <highlight><bold>154</bold></highlight> within terminal <highlight><bold>150</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>); and </paragraph>
<paragraph id="P-0040" lvl="2"><number>&lsqb;0040&rsqb;</number> R<highlight><subscript>r</subscript></highlight>(&ohgr;) is a transfer function for the aggregate processing at the base station for the reverse link transmission (e.g., the transfer function for demodulator <highlight><bold>122</bold></highlight> and RX channel processor <highlight><bold>132</bold></highlight> within base station <highlight><bold>110</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>). </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> H<highlight><subscript>r</subscript></highlight>(&ohgr;) may be determined at the base station based on pilot reference transmitted from the terminal on the reverse link. Similarly, H<highlight><subscript>f</subscript></highlight>(&ohgr;) may be determined at the terminal based on pilot reference transmitted from the base station on the forward link, and may be subsequently provided to the base station. </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> As noted above, the forward and reverse links for a TDD system are generally reciprocal. Thus, if the signal processing (e.g., filtering) at the base station and terminal for the forward link transmission is identical to the signal processing at the terminal and base station for the reverse link transmission, then both the base station and terminal can measure identical transfer functions (i.e., H<highlight><subscript>f</subscript></highlight>(&ohgr;)&equals;H<highlight><subscript>r</subscript></highlight>(&ohgr;)), except for errors induced by estimation and imperfect calibration. However, in a practical implementation, the forward transfer function, H<highlight><subscript>f</subscript></highlight>(&ohgr;), may not be identical to the reverse transfer function, H<highlight><subscript>r</subscript></highlight>(&ohgr;). This may be due to, for example, different signal processing elements used at the base station and terminal for the forward and reverse link transmissions. For example, the frequency response of the transmit and receive filters for the forward link transmission may be different from the frequency response of the transmit and receive filters for the reverse link transmission. </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> In accordance with an aspect of the invention, the difference between the forward and reverse transfer functions for the forward and reverse link transmissions is determined and used to more accurately estimate the forward transfer function at the base station, which may provide improved performance. Initially, the base station determines the reverse transfer function, H<highlight><subscript>r</subscript></highlight>(&ohgr;), based on the pilot reference transmitted by the terminal. The terminal also determines the forward transfer function, H<highlight><subscript>f</subscript></highlight>(&ohgr;), based on the pilot reference transmitted by the base station. The terminal then sends information indicative of the forward transfer function, H<highlight><subscript>f</subscript></highlight>(&ohgr;), back to the base station, which then uses the information to perform a calibration. Since the signal processing at the base station and terminal typically does not change appreciably during a communication session, H<highlight><subscript>f</subscript></highlight>(&ohgr;), may be reported at the start of the session and may be updated thereafter, as necessary. </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> A calibration function, a(&ohgr;), may then be derived based on the forward and reverse transfer functions, as follows:  
<math-cwu id="MATH-US-00002">
<number>2</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>a</mi>
          <mo>&af;</mo>
          <mrow>
            <mo>(</mo>
            <mi>&omega;</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mrow>
              <msub>
                <mi>H</mi>
                <mi>f</mi>
              </msub>
              <mo>&af;</mo>
              <mrow>
                <mo>(</mo>
                <mi>&omega;</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mrow>
              <msub>
                <mi>H</mi>
                <mi>r</mi>
              </msub>
              <mo>&af;</mo>
              <mrow>
                <mo>(</mo>
                <mi>&omega;</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mfrac>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mrow>
                <mrow>
                  <msub>
                    <mi>T</mi>
                    <mi>f</mi>
                  </msub>
                  <mo>&af;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>&omega;</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>&it;</mo>
                <mrow>
                  <mi>C</mi>
                  <mo>&af;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>&omega;</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>&it;</mo>
                <mrow>
                  <msub>
                    <mi>R</mi>
                    <mi>f</mi>
                  </msub>
                  <mo>&af;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>&omega;</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mrow>
                <mrow>
                  <msub>
                    <mi>T</mi>
                    <mi>r</mi>
                  </msub>
                  <mo>&af;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>&omega;</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>&it;</mo>
                <mrow>
                  <mi>C</mi>
                  <mo>&af;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>&omega;</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>&it;</mo>
                <mrow>
                  <msub>
                    <mi>R</mi>
                    <mi>r</mi>
                  </msub>
                  <mo>&af;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>&omega;</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mfrac>
            <mo>=</mo>
            <mrow>
              <mfrac>
                <mrow>
                  <mrow>
                    <msub>
                      <mi>T</mi>
                      <mi>f</mi>
                    </msub>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>&omega;</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>&it;</mo>
                  <mrow>
                    <msub>
                      <mi>R</mi>
                      <mi>f</mi>
                    </msub>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>&omega;</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mrow>
                  <mrow>
                    <msub>
                      <mi>T</mi>
                      <mi>r</mi>
                    </msub>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>&omega;</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>&it;</mo>
                  <mrow>
                    <msub>
                      <mi>R</mi>
                      <mi>r</mi>
                    </msub>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>&omega;</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mfrac>
              <mo>.</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Eq</mi>
        <mo>&it;</mo>
        <mstyle>
          <mtext>&emsp;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <mo>(</mo>
          <mn>2</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00002" file="US20030002450A1-20030102-M00002.NB"/>
<image id="EMI-M00002" wi="216.027" he="18.96615" file="US20030002450A1-20030102-M00002.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0045" lvl="7"><number>&lsqb;0045&rsqb;</number> In equation (2), it is assumed that there are no zeros in the reverse transfer function, H<highlight><subscript>r</subscript></highlight>(&ohgr;), so that division by zero is not encountered. The calibration function, a(&ohgr;), typically includes a set of complex values for a set of frequencies. </paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> If MIMO is employed, then the calibration function may be derived based on the pilot transmitted on a particular propagation path (i.e., a particular transmit-receive antenna pair). If OFDM is employed, then the calibration function may be derived based on the pilot transmitted on all or a subset of the N<highlight><subscript>F </subscript></highlight>frequency subchannels. In this case, the calibration function, a(k), may be expressed as a function of k, the index of the frequency subchannels and would typically include N<highlight><subscript>F </subscript></highlight>complex values for the N<highlight><subscript>F </subscript></highlight>frequency subchannels. </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> The signal processing at both the base station and terminal may be a function of frequency, and a calibration function is typically derived for each propagation path (i.e., each transmit-receive antenna pair). The calibration function for propagation path (i,j,k) (i.e., the path for the k-th frequency subchannel from the i-th terminal antenna to the j-th base station antenna) may be expressed as:  
<math-cwu id="MATH-US-00003">
<number>3</number>
<math>
<mrow>
  <mrow>
    <mi>a</mi>
    <mo>&af;</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mi>j</mi>
        <mo>,</mo>
        <mi>k</mi>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>T</mi>
            <mi>f</mi>
          </msub>
          <mo>&af;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>k</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>&CenterDot;</mo>
        <mrow>
          <msub>
            <mi>R</mi>
            <mi>f</mi>
          </msub>
          <mo>&af;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>i</mi>
              <mo>,</mo>
              <mi>k</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mrow>
        <mrow>
          <msub>
            <mi>T</mi>
            <mi>r</mi>
          </msub>
          <mo>&af;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>i</mi>
              <mo>,</mo>
              <mi>k</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>&CenterDot;</mo>
        <mrow>
          <msub>
            <mi>R</mi>
            <mi>r</mi>
          </msub>
          <mo>&af;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>k</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
<mathematica-file id="MATHEMATICA-00003" file="US20030002450A1-20030102-M00003.NB"/>
<image id="EMI-M00003" wi="216.027" he="19.93005" file="US20030002450A1-20030102-M00003.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0048" lvl="7"><number>&lsqb;0048&rsqb;</number> For example, if there are two transmit antennas and two receive antennas, then four calibration functions may be derived, one for each of the four transmit-receive antenna pairs. </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> Prior to a data transmission from the base station to the terminal, the forward link response may be characterized at the base station based on the pilot reference transmitted on the reverse link. In an embodiment, the forward link response characterization entails estimating the response of each transmit-receive antenna pair of each frequency subchannel (i.e., each propagation path). A reverse transfer function h,(i,j,k) for propagation path (i,j,k) may be expressed as: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>h</italic></highlight><highlight><subscript>r</subscript></highlight>(<highlight><italic>i,j,k</italic></highlight>)&equals;<highlight><italic>T</italic></highlight><highlight><subscript>r</subscript></highlight>(<highlight><italic>i,k</italic></highlight>)&middot;<highlight><italic>c</italic></highlight>(<highlight><italic>i,j,k</italic></highlight>)&middot;<highlight><italic>R</italic></highlight><highlight><subscript>r</subscript></highlight>(<highlight><italic>j,k</italic></highlight>). </in-line-formula></paragraph>
<paragraph id="P-0050" lvl="7"><number>&lsqb;0050&rsqb;</number> This reverse transfer function h<highlight><subscript>r</subscript></highlight>(i,j,k) may be obtained by processing and measuring the pilot reference transmitted on propagation path (i,j,k). </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> The base station can then estimate the forward transfer function, h<highlight><subscript>f</subscript></highlight>(i,j,k), for propagation path (i,j,k) by multiplying the reverse transfer function, h<highlight><subscript>r</subscript></highlight>(i,j,k), with the calibration coefficient, a(i,j,k), as follows:  
<math-cwu id="MATH-US-00004">
<number>4</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <mrow>
                  <msub>
                    <mi>h</mi>
                    <mi>f</mi>
                  </msub>
                  <mo>&af;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>,</mo>
                      <mi>j</mi>
                      <mo>,</mo>
                      <mi>k</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <msub>
                      <mi>h</mi>
                      <mi>r</mi>
                    </msub>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>i</mi>
                        <mo>,</mo>
                        <mi>j</mi>
                        <mo>,</mo>
                        <mi>k</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>&CenterDot;</mo>
                  <mrow>
                    <mi>a</mi>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>i</mi>
                        <mo>,</mo>
                        <mi>j</mi>
                        <mo>,</mo>
                        <mi>k</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <msub>
                      <mi>T</mi>
                      <mi>r</mi>
                    </msub>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>i</mi>
                        <mo>,</mo>
                        <mi>k</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>&CenterDot;</mo>
                  <mrow>
                    <mi>c</mi>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>i</mi>
                        <mo>,</mo>
                        <mi>j</mi>
                        <mo>,</mo>
                        <mi>k</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>&CenterDot;</mo>
                  <mrow>
                    <msub>
                      <mi>R</mi>
                      <mi>r</mi>
                    </msub>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>j</mi>
                        <mo>,</mo>
                        <mi>k</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>&CenterDot;</mo>
                  <mfrac>
                    <mrow>
                      <mrow>
                        <msub>
                          <mi>T</mi>
                          <mi>f</mi>
                        </msub>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <mi>j</mi>
                            <mo>,</mo>
                            <mi>k</mi>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                      <mo>&CenterDot;</mo>
                      <mrow>
                        <msub>
                          <mi>R</mi>
                          <mi>f</mi>
                        </msub>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <mi>i</mi>
                            <mo>,</mo>
                            <mi>k</mi>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mrow>
                      <mrow>
                        <msub>
                          <mi>T</mi>
                          <mi>r</mi>
                        </msub>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <mi>i</mi>
                            <mo>,</mo>
                            <mi>k</mi>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                      <mo>&CenterDot;</mo>
                      <mrow>
                        <msub>
                          <mi>R</mi>
                          <mi>r</mi>
                        </msub>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <mi>j</mi>
                            <mo>,</mo>
                            <mi>k</mi>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                  </mfrac>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>=</mo>
              <mrow>
                <mrow>
                  <msub>
                    <mi>T</mi>
                    <mi>f</mi>
                  </msub>
                  <mo>&af;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>j</mi>
                      <mo>,</mo>
                      <mi>k</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>&CenterDot;</mo>
                <mrow>
                  <mi>c</mi>
                  <mo>&af;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>,</mo>
                      <mi>j</mi>
                      <mo>,</mo>
                      <mi>k</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>&CenterDot;</mo>
                <mrow>
                  <mrow>
                    <msub>
                      <mi>R</mi>
                      <mi>f</mi>
                    </msub>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>i</mi>
                        <mo>,</mo>
                        <mi>k</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>.</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mi>Eq</mi>
        <mo>&it;</mo>
        <mstyle>
          <mtext>&emsp;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <mo>(</mo>
          <mn>3</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00004" file="US20030002450A1-20030102-M00004.NB"/>
<image id="EMI-M00004" wi="216.027" he="43.91415" file="US20030002450A1-20030102-M00004.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> The forward transfer functions, h<highlight><subscript>f</subscript></highlight>(i,j,k), for all propagation paths may then be used to form one or more channel response matrices H<highlight><subscript>f</subscript></highlight>(k). Typically, one channel response metric H<highlight><subscript>f</subscript></highlight>(k) is formed for each frequency subchannel. Each channel response matrix H<highlight><subscript>f</subscript></highlight>(k) comprises an N<highlight><subscript>T</subscript></highlight>&times;N<highlight><subscript>R </subscript></highlight>matrix of forward transfer functions h<highlight><subscript>f</subscript></highlight>(i,j,k), where 1&lE;i&lE;N<highlight><subscript>R </subscript></highlight>and 1&lE;j&lE;N<highlight><subscript>T</subscript></highlight>, for the N<highlight><subscript>T</subscript></highlight>&middot;N<highlight><subscript>R </subscript></highlight>transmit-receive antenna pairs for the k-th frequency subchannel. Each channel response matrix H<highlight><subscript>f</subscript></highlight>(k) may then be used to derive weights, which are then used to precondition the modulation symbols for the k-th frequency subchannel, as described below. </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> For each frequency subchannel, an eigenvector decomposition of a Hermitian matrix formed by the product of the channel response matrix H<highlight><subscript>f </subscript></highlight>with its conjugate-transpose H<highlight><subscript>f</subscript></highlight><highlight><superscript>H </superscript></highlight>can be expressed as: </paragraph>
<paragraph lvl="0"><in-line-formula>H<highlight><subscript>f</subscript></highlight><highlight><superscript>H</superscript></highlight>H<highlight><subscript>f</subscript></highlight>&equals;E&Lgr;E<highlight><superscript>H</superscript></highlight>, &emsp;&emsp;Eq (4) </in-line-formula></paragraph>
<paragraph id="P-0054" lvl="7"><number>&lsqb;0054&rsqb;</number> where E is an eigenvector matrix and &Lgr; is a diagonal matrix of eigenvalues, both of dimension N<highlight><subscript>T</subscript></highlight>&times;N<highlight><subscript>T</subscript></highlight>, and the symbol &ldquo;H&rdquo; denotes the conjugate-transpose. The base station preconditions a vector of N<highlight><subscript>C </subscript></highlight>modulation symbols, b, for each time slot using the eigenvector matrix E, as follows: </paragraph>
<paragraph lvl="0"><in-line-formula>x&equals;Eb. &emsp;&emsp;Eq (5) </in-line-formula></paragraph>
<paragraph id="P-0055" lvl="7"><number>&lsqb;0055&rsqb;</number> The preconditioning in equation (5) can be more fully expressed as:  
<math-cwu id="MATH-US-00005">
<number>5</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <msub>
                    <mi>x</mi>
                    <mn>1</mn>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>x</mi>
                    <mn>2</mn>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>&vellip;</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>x</mi>
                    <msub>
                      <mi>N</mi>
                      <mi>T</mi>
                    </msub>
                  </msub>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mo>[</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <mrow>
                      <msub>
                        <mi>e</mi>
                        <mn>11</mn>
                      </msub>
                      <mo>,</mo>
                    </mrow>
                  </mtd>
                  <mtd>
                    <mrow>
                      <msub>
                        <mi>e</mi>
                        <mn>12</mn>
                      </msub>
                      <mo>,</mo>
                    </mrow>
                  </mtd>
                  <mtd>
                    <mi>&ctdot;</mi>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>e</mi>
                      <mrow>
                        <mn>1</mn>
                        <mo>&it;</mo>
                        <msub>
                          <mi>N</mi>
                          <mi>C</mi>
                        </msub>
                      </mrow>
                    </msub>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mrow>
                      <msub>
                        <mi>e</mi>
                        <mn>21</mn>
                      </msub>
                      <mo>,</mo>
                    </mrow>
                  </mtd>
                  <mtd>
                    <mrow>
                      <msub>
                        <mi>e</mi>
                        <mn>22</mn>
                      </msub>
                      <mo>,</mo>
                    </mrow>
                  </mtd>
                  <mtd>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>e</mi>
                      <mrow>
                        <mn>2</mn>
                        <mo>&it;</mo>
                        <msub>
                          <mi>N</mi>
                          <mi>C</mi>
                        </msub>
                      </mrow>
                    </msub>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mi>&vellip;</mi>
                  </mtd>
                  <mtd>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                  </mtd>
                  <mtd>
                    <mi>&utdot;</mi>
                  </mtd>
                  <mtd>
                    <mi>&vellip;</mi>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mrow>
                      <msub>
                        <mi>e</mi>
                        <mrow>
                          <msub>
                            <mi>N</mi>
                            <mi>T</mi>
                          </msub>
                          <mo>&it;</mo>
                          <mn>1</mn>
                        </mrow>
                      </msub>
                      <mo>,</mo>
                    </mrow>
                  </mtd>
                  <mtd>
                    <mrow>
                      <msub>
                        <mi>e</mi>
                        <mrow>
                          <msub>
                            <mi>N</mi>
                            <mi>T</mi>
                          </msub>
                          <mo>&it;</mo>
                          <mn>1</mn>
                        </mrow>
                      </msub>
                      <mo>,</mo>
                    </mrow>
                  </mtd>
                  <mtd>
                    <mi>&ctdot;</mi>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>e</mi>
                      <mrow>
                        <msub>
                          <mi>N</mi>
                          <mi>T</mi>
                        </msub>
                        <mo>&it;</mo>
                        <msub>
                          <mi>N</mi>
                          <mi>C</mi>
                        </msub>
                      </mrow>
                    </msub>
                  </mtd>
                </mtr>
              </mtable>
              <mo>]</mo>
            </mrow>
            <mo>&CenterDot;</mo>
            <mrow>
              <mo>[</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>b</mi>
                      <mn>1</mn>
                    </msub>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>b</mi>
                      <mn>2</mn>
                    </msub>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mi>&vellip;</mi>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>b</mi>
                      <msub>
                        <mi>N</mi>
                        <mi>C</mi>
                      </msub>
                    </msub>
                  </mtd>
                </mtr>
              </mtable>
              <mo>]</mo>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Eq</mi>
        <mo>&it;</mo>
        <mstyle>
          <mtext>&emsp;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <mo>(</mo>
          <mn>6</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00005" file="US20030002450A1-20030102-M00005.NB"/>
<image id="EMI-M00005" wi="216.027" he="47.03265" file="US20030002450A1-20030102-M00005.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0056" lvl="7"><number>&lsqb;0056&rsqb;</number> where </paragraph>
<paragraph id="P-0057" lvl="2"><number>&lsqb;0057&rsqb;</number> &lsqb;b<highlight><subscript>1</subscript></highlight>, b<highlight><subscript>2</subscript></highlight>, . . . b<highlight><subscript>N</subscript></highlight><highlight><subscript><highlight><subscript>C</subscript></highlight></subscript></highlight>&rsqb; are the modulation symbols for spatial subchannels <highlight><bold>1</bold></highlight>, <highlight><bold>2</bold></highlight>, . . . N<highlight><subscript>C</subscript></highlight>, respectively, where N<highlight><subscript>C</subscript></highlight>&lE;min &lcub;N<highlight><subscript>T</subscript></highlight>, N<highlight><subscript>R</subscript></highlight>&rcub;; </paragraph>
<paragraph id="P-0058" lvl="2"><number>&lsqb;0058&rsqb;</number> e<highlight><subscript>ij </subscript></highlight>are elements of the eigenvector matrix E, which is descriptive of the transmission characteristics from the base station antennas to the terminal antennas; and </paragraph>
<paragraph id="P-0059" lvl="2"><number>&lsqb;0059&rsqb;</number> &lsqb;x<highlight><subscript>1</subscript></highlight>, x<highlight><subscript>2</subscript></highlight>, . . . x<highlight><subscript>N</subscript></highlight><highlight><subscript><highlight><subscript>T</subscript></highlight></subscript></highlight>&rsqb; are the preconditioned modulation symbols, which can be expressed as:  
<math-cwu id="MATH-US-00006">
<number>6</number>
<math>
  <mrow>
    <mrow>
      <msub>
        <mi>x</mi>
        <mn>1</mn>
      </msub>
      <mo>=</mo>
      <mrow>
        <mrow>
          <msub>
            <mi>b</mi>
            <mn>1</mn>
          </msub>
          <mo>&CenterDot;</mo>
          <msub>
            <mi>e</mi>
            <mn>11</mn>
          </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
          <msub>
            <mi>b</mi>
            <mn>2</mn>
          </msub>
          <mo>&CenterDot;</mo>
          <msub>
            <mi>e</mi>
            <mn>12</mn>
          </msub>
        </mrow>
        <mo>+</mo>
        <mi>&hellip;</mi>
        <mo>+</mo>
        <mrow>
          <msub>
            <mi>b</mi>
            <msub>
              <mi>N</mi>
              <mi>C</mi>
            </msub>
          </msub>
          <mo>&CenterDot;</mo>
          <msub>
            <mi>e</mi>
            <mrow>
              <mn>1</mn>
              <mo>&it;</mo>
              <msub>
                <mi>N</mi>
                <mi>C</mi>
              </msub>
            </mrow>
          </msub>
        </mrow>
      </mrow>
    </mrow>
    <mo>,</mo>
    <mstyle>
      <mtext>&NewLine;</mtext>
    </mstyle>
    <mo>&it;</mo>
    <mrow>
      <msub>
        <mi>x</mi>
        <mn>2</mn>
      </msub>
      <mo>=</mo>
      <mrow>
        <mrow>
          <msub>
            <mi>b</mi>
            <mn>1</mn>
          </msub>
          <mo>&CenterDot;</mo>
          <msub>
            <mi>e</mi>
            <mn>21</mn>
          </msub>
        </mrow>
        <mo>+</mo>
        <mrow>
          <msub>
            <mi>b</mi>
            <mn>2</mn>
          </msub>
          <mo>&CenterDot;</mo>
          <msub>
            <mi>e</mi>
            <mn>22</mn>
          </msub>
        </mrow>
        <mo>+</mo>
        <mi>&hellip;</mi>
        <mo>+</mo>
        <mrow>
          <msub>
            <mi>b</mi>
            <msub>
              <mi>N</mi>
              <mi>C</mi>
            </msub>
          </msub>
          <mo>&CenterDot;</mo>
          <msub>
            <mi>e</mi>
            <mrow>
              <mn>2</mn>
              <mo>&it;</mo>
              <msub>
                <mi>N</mi>
                <mi>C</mi>
              </msub>
            </mrow>
          </msub>
        </mrow>
      </mrow>
    </mrow>
    <mo>,</mo>
    <mi>and</mi>
  </mrow>
</math>
<math>
  <mrow>
    <msub>
      <mi>x</mi>
      <msub>
        <mi>N</mi>
        <mi>T</mi>
      </msub>
    </msub>
    <mo>=</mo>
    <mrow>
      <mrow>
        <msub>
          <mi>b</mi>
          <mn>1</mn>
        </msub>
        <mo>&CenterDot;</mo>
        <msub>
          <mi>e</mi>
          <mrow>
            <msub>
              <mi>N</mi>
              <mi>T</mi>
            </msub>
            <mo>&it;</mo>
            <mn>1</mn>
          </mrow>
        </msub>
      </mrow>
      <mo>+</mo>
      <mrow>
        <msub>
          <mi>b</mi>
          <mn>2</mn>
        </msub>
        <mo>&CenterDot;</mo>
        <msub>
          <mi>e</mi>
          <mrow>
            <msub>
              <mi>N</mi>
              <mi>T</mi>
            </msub>
            <mo>&it;</mo>
            <mn>2</mn>
          </mrow>
        </msub>
      </mrow>
      <mo>+</mo>
      <mi>&hellip;</mi>
      <mo>+</mo>
      <mrow>
        <msub>
          <mi>b</mi>
          <msub>
            <mi>N</mi>
            <mi>C</mi>
          </msub>
        </msub>
        <mo>&CenterDot;</mo>
        <mrow>
          <msub>
            <mi>e</mi>
            <mrow>
              <msub>
                <mi>N</mi>
                <mi>T</mi>
              </msub>
              <mo>&it;</mo>
              <msub>
                <mi>N</mi>
                <mi>C</mi>
              </msub>
            </mrow>
          </msub>
          <mo>.</mo>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
</math>
<mathematica-file id="MATHEMATICA-00006" file="US20030002450A1-20030102-M00006.NB"/>
<image id="EMI-M00006" wi="216.027" he="36.0045" file="US20030002450A1-20030102-M00006.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0060" lvl="7"><number>&lsqb;0060&rsqb;</number> Since H<highlight><superscript>H</superscript></highlight>H is Hermitian, the eigenvector matrix E is unitary. Thus, if the elements of the vector b have equal power, the elements of the vector x (i.e., the preconditioned modulation symbols) also have equal power. </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> As shown in equations (5) and (6), for each frequency subchannel, the N<highlight><subscript>C </subscript></highlight>modulation symbols at each time slot are preconditioned to generate N<highlight><subscript>T </subscript></highlight>preconditioned modulation symbols. The preconditioning orthogonalizes the modulation symbol streams transmitted on the N<highlight><subscript>C </subscript></highlight>spatial subchannels, which may improve performance. </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a flow diagram of a process to derive the calibration function and to precondition modulation symbols prior to transmission on the forward link, in accordance with an embodiment of the invention. Initially (e.g., at the start of a communication session between a base station and a terminal), the terminal measures the forward transfer function, H<highlight><subscript>f</subscript></highlight>(&ohgr;), and sends it back to the base station, at step <highlight><bold>212</bold></highlight>. The base station also measures the reverse transfer function, H<highlight><subscript>r</subscript></highlight>(&ohgr;), at step <highlight><bold>214</bold></highlight>. The forward and reverse transfer functions, H<highlight><subscript>f</subscript></highlight>(&ohgr;) and H<highlight><subscript>r</subscript></highlight>(&ohgr;), are then used by the base station to derive the calibration function, a(&ohgr;), as shown in equation (2), at step <highlight><bold>216</bold></highlight>. Steps <highlight><bold>212</bold></highlight> through <highlight><bold>216</bold></highlight> may be performed prior to the first data transmission from the base station to the terminal, and may also be performed thereafter as needed during the communication session. </paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> A determination is then made whether or not there is a data transmission for the terminal, at step <highlight><bold>218</bold></highlight>. If there is no data to transmit, then the process returns to step <highlight><bold>218</bold></highlight> and waits (e.g., until the next time slot for the forward link). Otherwise, if there is data to transmit, the base station measures the reverse transfer function, H<highlight><subscript>r</subscript></highlight>(&ohgr;), at step <highlight><bold>220</bold></highlight>. The base station then derives the forward transfer function, H<highlight><subscript>f</subscript></highlight>(&ohgr;), based on the reverse transfer function, H<highlight><subscript>r</subscript></highlight>(&ohgr;), and the calibration function, a(&ohgr;), as shown in equation (3), at step <highlight><bold>222</bold></highlight>. The forward transfer function, H<highlight><subscript>f</subscript></highlight>(&ohgr;), is then used to process data prior to transmission to the terminal, at step <highlight><bold>224</bold></highlight>. More particularly, the forward transfer function, H<highlight><subscript>f</subscript></highlight>(&ohgr;), is used to derive the eigenvector matrix E, as shown in equation (4), which is then used to precondition the modulation symbols, as shown in equations (5) and (6). The process then returns to step <highlight><bold>218</bold></highlight> and waits for the next data transmission (or the next time slot). </paragraph>
</section>
<section>
<heading lvl="1">Receiver Processing </heading>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> The received signals at the terminal may be expressed as:  
<math-cwu id="MATH-US-00007">
<number>7</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <munder>
                  <mi>r</mi>
                  <mi>_</mi>
                </munder>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <msub>
                      <mi>H</mi>
                      <mi>f</mi>
                    </msub>
                    <mo>&it;</mo>
                    <munder>
                      <mi>x</mi>
                      <mi>_</mi>
                    </munder>
                  </mrow>
                  <mo>+</mo>
                  <munder>
                    <mi>n</mi>
                    <mi>_</mi>
                  </munder>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <msub>
                      <mi>H</mi>
                      <mi>f</mi>
                    </msub>
                    <mo>&it;</mo>
                    <mi>E</mi>
                    <mo>&it;</mo>
                    <munder>
                      <mi>b</mi>
                      <mi>_</mi>
                    </munder>
                  </mrow>
                  <mo>+</mo>
                  <munder>
                    <mi>n</mi>
                    <mi>_</mi>
                  </munder>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mi>Eq</mi>
        <mo>&it;</mo>
        <mstyle>
          <mtext>&emsp;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <mo>(</mo>
          <mn>7</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00007" file="US20030002450A1-20030102-M00007.NB"/>
<image id="EMI-M00007" wi="216.027" he="23.04855" file="US20030002450A1-20030102-M00007.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0065" lvl="7"><number>&lsqb;0065&rsqb;</number> where n is the channel noise. </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> To recover the transmitted modulation symbols, the terminal initially performs a channel-matched-filter operation, followed by a multiplication by the right eigenvector matrix. The result of the channel-matched-filter and multiplication operations is a vector y, which can be expressed as:  
<math-cwu id="MATH-US-00008">
<number>8</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <munder>
                  <mi>y</mi>
                  <mi>_</mi>
                </munder>
                <mo>=</mo>
                <mrow>
                  <msup>
                    <mi>E</mi>
                    <mi>H</mi>
                  </msup>
                  <mo>&it;</mo>
                  <msubsup>
                    <mi>H</mi>
                    <mi>f</mi>
                    <mi>H</mi>
                  </msubsup>
                  <mo>&it;</mo>
                  <munder>
                    <mi>r</mi>
                    <mi>_</mi>
                  </munder>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <msup>
                      <mi>E</mi>
                      <mi>H</mi>
                    </msup>
                    <mo>&it;</mo>
                    <msubsup>
                      <mi>H</mi>
                      <mi>f</mi>
                      <mi>H</mi>
                    </msubsup>
                    <mo>&it;</mo>
                    <msub>
                      <mi>H</mi>
                      <mi>f</mi>
                    </msub>
                    <mo>&it;</mo>
                    <mi>E</mi>
                    <mo>&it;</mo>
                    <munder>
                      <mi>b</mi>
                      <mi>_</mi>
                    </munder>
                  </mrow>
                  <mo>+</mo>
                  <mrow>
                    <msup>
                      <mi>E</mi>
                      <mi>H</mi>
                    </msup>
                    <mo>&it;</mo>
                    <msubsup>
                      <mi>H</mi>
                      <mi>f</mi>
                      <mi>H</mi>
                    </msubsup>
                    <mo>&it;</mo>
                    <munder>
                      <mi>n</mi>
                      <mi>_</mi>
                    </munder>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <mi>&Lambda;</mi>
                    <mo>&it;</mo>
                    <munder>
                      <mi>b</mi>
                      <mi>_</mi>
                    </munder>
                  </mrow>
                  <mo>+</mo>
                  <munder>
                    <mover>
                      <mi>n</mi>
                      <mo>^</mo>
                    </mover>
                    <mi>_</mi>
                  </munder>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mi>Eq</mi>
        <mo>&it;</mo>
        <mstyle>
          <mtext>&emsp;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <mo>(</mo>
          <mn>8</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00008" file="US20030002450A1-20030102-M00008.NB"/>
<image id="EMI-M00008" wi="216.027" he="37.9323" file="US20030002450A1-20030102-M00008.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0067" lvl="7"><number>&lsqb;0067&rsqb;</number> where {circumflex over (n)} is the noise term after the receiver processing at the terminal. The channel response matrix, H<highlight><subscript>f</subscript></highlight>, for the forward link used to perform the channel-matched-filter operation may be determined at the terminal based on the pilot reference transmitted from the base station. As shown in equation (8), the resultant vector y is a scaled version of the vector b, which includes the modulation symbols prior to the preconditioning with the eigenvector matrix E at the base station. The scaling between the vectors b and y is based on the eigenvalues in the matrix &Lgr;. </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> The noise term {circumflex over (n)} after the receiver processing has a covariance that can be expressed as:  
<math-cwu id="MATH-US-00009">
<number>9</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <mrow>
                  <mi>E</mi>
                  <mo>&it;</mo>
                  <mrow>
                    <mo>{</mo>
                    <mrow>
                      <munder>
                        <mover>
                          <mi>n</mi>
                          <mo>^</mo>
                        </mover>
                        <mi>_</mi>
                      </munder>
                      <mo>&it;</mo>
                      <msup>
                        <munder>
                          <mover>
                            <mi>n</mi>
                            <mo>^</mo>
                          </mover>
                          <mi>_</mi>
                        </munder>
                        <mi>H</mi>
                      </msup>
                    </mrow>
                    <mo>}</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mi>E</mi>
                  <mo>&af;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <msup>
                        <mi>E</mi>
                        <mi>H</mi>
                      </msup>
                      <mo>&it;</mo>
                      <msubsup>
                        <mi>H</mi>
                        <mi>f</mi>
                        <mi>H</mi>
                      </msubsup>
                      <mo>&it;</mo>
                      <msup>
                        <munder>
                          <mi>nn</mi>
                          <mi>_</mi>
                        </munder>
                        <mi>H</mi>
                      </msup>
                      <mo>&it;</mo>
                      <mi>HE</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <mo>=</mo>
                <mrow>
                  <msup>
                    <mi>E</mi>
                    <mi>H</mi>
                  </msup>
                  <mo>&it;</mo>
                  <msubsup>
                    <mi>H</mi>
                    <mi>f</mi>
                    <mi>H</mi>
                  </msubsup>
                  <mo>&it;</mo>
                  <msub>
                    <mi>H</mi>
                    <mi>f</mi>
                  </msub>
                  <mo>&it;</mo>
                  <mi>E</mi>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <mo>=</mo>
                <mi>&Lambda;</mi>
              </mrow>
              <mo>,</mo>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mi>Eq</mi>
        <mo>&it;</mo>
        <mstyle>
          <mtext>&emsp;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <mo>(</mo>
          <mn>9</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00009" file="US20030002450A1-20030102-M00009.NB"/>
<image id="EMI-M00009" wi="216.027" he="36.9684" file="US20030002450A1-20030102-M00009.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0069" lvl="7"><number>&lsqb;0069&rsqb;</number> where E&lcub;&rcub; is the expectation operation. From equation (9), the noise components for the spatial subchannels, after the receiver processing at the terminal, are independent with variances given by the eigenvalues. If the elements of b have equal power and if E&lcub;{circumflex over (n)}{circumflex over (n)}<highlight><superscript>H</superscript></highlight>&rcub;&equals;I, then the SNR of the i-th component of the vector y (i.e., the i-th spatial subchannel) is &lgr;<highlight><subscript>i</subscript></highlight>, which is the i-th diagonal element of the matrix &Lgr; of eigenvalues. </paragraph>
</section>
<section>
<heading lvl="1">Pilot Transmission Schemes </heading>
<paragraph id="P-0070" lvl="0"><number>&lsqb;0070&rsqb;</number> Various schemes may be used to transmit a pilot reference from a transmitter unit (e.g., a terminal) to a receiver unit (e.g., a base station) to allow the receiver unit to characterize the communication link. The pilot reference is typically transmitted from all or a subset of the antennas at the transmitter unit and on a sufficient number of frequency subchannels such that an accurate characterization of the communication link can be made. The transmitted pilot reference is received by all antennas at the receiver unit and processed to characterize the link response. </paragraph>
<paragraph id="P-0071" lvl="0"><number>&lsqb;0071&rsqb;</number> The particular pilot transmission scheme to be used may be selected based on various system constraints and considerations. The transmission scheme used for the reverse link may not be the same as that used for the forward link. As an example, the forward link may support MIMO whereas the reverse link may only support single-input multiple-output (SIMO), in which case the pilot transmission scheme should account for this difference. Some schemes for transmitting the pilot reference on the reverse link from the terminal to the base station are described below. </paragraph>
<paragraph id="P-0072" lvl="0"><number>&lsqb;0072&rsqb;</number> In one pilot transmission scheme, the terminal transmits the pilot reference continuously (i.e., in all time slots allocated for the reverse link) from all antennas and on a sufficient number of subchannels. The pilot reference may be transmitted along with other packet data. For this scheme, the pilot reference is readily available to the base station for channel characterization at all times. </paragraph>
<paragraph id="P-0073" lvl="0"><number>&lsqb;0073&rsqb;</number> If the pilot reference is transmitted from multiple antennas on a particular frequency subchannel (there may be only one frequency subchannel if OFDM is not employed) in a given time slot, then the pilot transmitted on different antennas should be orthogonal to each other. This would then allow the base station to recover the individual pilot reference transmitted on each antenna. In a single-carrier system, orthogonality may be achieved by transmitting the pilot on a different code channel from each antenna (e.g., covering the pilot data for each antenna with a different Walsh code). </paragraph>
<paragraph id="P-0074" lvl="0"><number>&lsqb;0074&rsqb;</number> If OFDM is employed, the frequency response of the communication link may be determined for a subset of the frequency subchannels instead of all frequency subchannels. For example, if N<highlight><subscript>F </subscript></highlight>frequency subchannels and N<highlight><subscript>R </subscript></highlight>antennas are available at the terminal, then the pilot reference may be transmitted on N<highlight><subscript>F</subscript></highlight>/N<highlight><subscript>R </subscript></highlight>frequency subchannels of each of the N<highlight><subscript>R </subscript></highlight>antennas. The N<highlight><subscript>F</subscript></highlight>/N<highlight><subscript>R </subscript></highlight>frequency subchannels used for pilot transmission on each antenna are selected such that an accurate estimate of the frequency response may be made. For example, the pilot reference may be transmitted on frequency subchannels that are spaced over the entire frequency band and are N<highlight><subscript>R </subscript></highlight>channels apart. The N<highlight><subscript>F</subscript></highlight>/N<highlight><subscript>R </subscript></highlight>frequency subchannels for each antenna may be staggered (i.e., offset) relative to those of other antennas. In general, the number of frequency subchannels selected for pilot transmission for each antenna should be sufficient to allow for an accurate sampling of the spectrum of the communication link. The frequency domain sampling allows the forward link response to be estimated using fewer pilot transmissions. </paragraph>
<paragraph id="P-0075" lvl="0"><number>&lsqb;0075&rsqb;</number> In another pilot transmission scheme, the terminal transmits a pilot reference in a time division multiplexed (TDM) manner from all antennas and on all or a subset of the frequency subchannels. For example, the pilot reference may be transmitted on all or a subset of the frequency subchannels from one antenna at each available time slot in a sequential manner (e.g., in a round-robin manner). Thus, the pilot reference may be transmitted from antenna <highlight><bold>1</bold></highlight> at a particular time slot, from antenna <highlight><bold>2</bold></highlight> at the next available time slot, and so on. Numerous other TDM schemes may also be used to transmit the pilot reference from the terminal. </paragraph>
<paragraph id="P-0076" lvl="0"><number>&lsqb;0076&rsqb;</number> In yet another pilot transmission scheme, multiple terminals are able to concurrently transmit pilot references at the same time via code division multiplexing (CDM). For example, terminal <highlight><bold>1</bold></highlight> may transmit the pilot reference on a first set of code channels (from all or a subset of the antennas), terminal <highlight><bold>2</bold></highlight> may transmit the pilot reference on a second set of code channels, and so on. The code channels are designed to be orthogonal to each other so that the pilot references from different terminals can be individually recovered at the base station, which then allows the base station to characterize the forward link response for each of the terminals. </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> In yet another pilot transmission scheme, multiple terminals are able to concurrently transmit pilot references at the same time via time division multiplexing (TDM). In an implementation, one terminal may be designated to transmit pilot reference on the reverse link at any given time slot. In a first embodiment, the pilot transmissions on the reverse link are scheduled by the base station using a scheme such as polling. Whenever the base station needs to transmit data to a particular terminal, that terminal is notified prior to the data transmission. The terminal then transmits pilot reference on all or a subset of the frequency subchannels and from all or a subset of the antennas to allow the base station to characterize the forward link for this terminal. In a second embodiment, the terminals are assigned fixed time slots for pilot transmission. For example, terminal <highlight><bold>1</bold></highlight> may be assigned to transmit the pilot reference in every n-th time slot starting with a particular time slot (from all or a subset of the antennas and on all or a subset of the frequency subchannels), terminal <highlight><bold>2</bold></highlight> may be assigned to transmit the pilot reference on every n-th time slot starting with the next available time slot, and so on. For TDM pilot transmission schemes, the time slots are assigned to the terminals such that the forward link can be characterized a close to the time of actual data transmission on the forward link. In this way, accurate forward link characterization may be obtained. </paragraph>
<paragraph id="P-0078" lvl="0"><number>&lsqb;0078&rsqb;</number> In yet another pilot transmission scheme, multiple terminals are able to concurrently transmit pilot references at the same time via frequency division multiplexing (FDM). For example, at time slot n, terminal <highlight><bold>1</bold></highlight> may transmit the pilot reference on frequency subchannel <highlight><bold>1</bold></highlight> (from all or a subset of the antennas), terminal <highlight><bold>2</bold></highlight> may transmit the pilot reference on frequency subchannel <highlight><bold>2</bold></highlight>, and so on. </paragraph>
<paragraph id="P-0079" lvl="0"><number>&lsqb;0079&rsqb;</number> As described above, the forward link frequency response for each terminal may be sampled using a subset of the frequency subchannels. For example, N<highlight><subscript>X </subscript></highlight>terminals may be designated to transmit pilot references on N<highlight><subscript>F </subscript></highlight>frequency subchannels, and each terminal may be allocated N<highlight><subscript>F</subscript></highlight>/N<highlight><subscript>X </subscript></highlight>frequency subchannels for pilot transmission. The N<highlight><subscript>F</subscript></highlight>/N<highlight><subscript>X </subscript></highlight>frequency subchannels for each terminal are selected such that an accurate estimate of the frequency response may be made. The pilot reference may be transmitted on frequency subchannels that are spaced over the entire frequency band and are N<highlight><subscript>X </subscript></highlight>channels apart. </paragraph>
<paragraph id="P-0080" lvl="0"><number>&lsqb;0080&rsqb;</number> Using the techniques described above, the base station is able to characterize the response of the forward link based on the pilot reference transmitted by the terminal. This characterization typically includes estimates of the frequency response for the communication link (e.g., the MIMO channel). This information may be used to orthogonalize the spatial subchannels, as described above. </paragraph>
<paragraph id="P-0081" lvl="0"><number>&lsqb;0081&rsqb;</number> In some other embodiments, the forward link is characterized at the terminal based on the pilot transmitted from the base station. The forward link characterization is then sent back to the base station, which then uses the information to process data (e.g., precondition the modulation symbols) for the forward link transmissions. </paragraph>
</section>
<section>
<heading lvl="1">Forward Link Quality Estimate/Coding and Modulation Scheme </heading>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> In accordance with another aspect of the invention, the terminal estimates the &ldquo;quality&rdquo; of the forward link and provides this information to the base station. The forward link quality may be quantified by the SNR, the noise-plus-interference, or some other measurement. The SNR may be estimated for each transmission channel, each transmit-receive antenna pair, or for groups of these transmission channels or antenna pairs. The forward link quality may be estimated based on the pilot reference, data, or some other signals transmitted on the forward link. The forward link quality estimate is then represented in a particular form and sent to the base station, which then uses the information to properly code and modulate data prior to transmission such that the transmitted data can be received by the terminal at the desired level of performance (e.g., 1% PER). </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> In an embodiment, one coding and modulation scheme is used for all transmission channels to be used for the forward link transmission. In this case, the terminal can estimate the average SNR across all transmission channels and report this average SNR to the base station. For example, the terminal can process the pilot reference received on each antenna and estimate the SNR for each propagation path, and may further derive the average SNR from the individual SNRs. Reporting the average SNR instead of the individual SNRs can significantly reduce the amount of information to be sent back to the base station. </paragraph>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> In another embodiment, a number of data streams may be transmitted on a number of groups of transmission channels. Each data stream may be independently processed (i.e., coded and modulated) with a particular coding and modulation scheme, or multiple data streams may share a common coding and modulation scheme. Each group of channels may include any number and type of transmission channels. For example, one group may be defined for each antenna at the base station, with each group including all frequency subchannels for the associated antenna. As another example, one group may be defined for each frequency subchannel, with each group including all spatial subchannels for the associated frequency subchannel. As yet another example, one group may be defined for each different subset of frequency subchannels, with each group including all spatial subchannels for the associated frequency subchannels. Alternatively, each group may include one transmission channel. </paragraph>
<paragraph id="P-0085" lvl="0"><number>&lsqb;0085&rsqb;</number> The forward link quality may be reported to the base station via various forms. In an embodiment, the SNRs for the individual transmission channels or an average SNR for each group of channels may be determined and reported. In another embodiment, the terminal can map the estimated SNR to a particular rate (e.g., a data rate indicator (DRI)) and send the rate information back to the base station. The rate indicator may be indicative of the maximum data rate that may be transmitted on the corresponding group of transmission channels for the required level of performance. In yet another embodiment, the terminal may report an indication of a particular coding and modulation scheme to be used by the base station for each data stream to be independently processed. In yet another embodiment, the noise or interference power for all or a single frequency subchannel, the average channel noise variance, or some other measurement, may be reported. Various other forms may also be used to report the forward link quality and are within the scope of the invention. In general, the terminal may report any type of information that can be used at the base station to properly code and modulate data prior to transmission on the forward link. </paragraph>
<paragraph id="P-0086" lvl="0"><number>&lsqb;0086&rsqb;</number> The terminal can thus estimate the forward link quality for each group of transmission channels and report information indicative of the estimated quality (e.g., the average SNR, a rate indicator, or an indication of a coding and modulation scheme) to the base station. By reporting information for each group, the base station is able to individually and independently code and modulate each data stream based on the received information for the associated group of transmission channels, which may provide improved performance. For example, the base station may be able to transmit different data streams on different antennas, with each data stream having a particular bit rate supported by the transmission channels used to transmit the data stream. </paragraph>
<paragraph id="P-0087" lvl="0"><number>&lsqb;0087&rsqb;</number> In certain embodiments, the forward link quality can be estimated at the base station based on the pilot reference transmitted by the terminal. Because the forward and reverse links are reciprocal, the quality of the forward link can be estimated based on the quality of the reverse link, which can be estimated by the base station. Initially, the base station can estimate the SNR (e.g., average SNR ) for the reverse link based on the pilot reference transmitted by the terminal (i.e., the same pilot reference used to derive the reverse channel response matrix H<highlight><subscript>r </subscript></highlight>at the base station). The base station is able to estimate the channel noise variance. </paragraph>
<paragraph id="P-0088" lvl="0"><number>&lsqb;0088&rsqb;</number> As shown in equation (8), the vector z recovered at the terminal is equal to the vector b scaled by the eigenvalues in the matrix &Lgr;. The matrix &Lgr; can also be derived at the base station based on the forward channel response matrix H<highlight><subscript>f</subscript></highlight>. The base station can thus estimate the signal power at the terminal (based on the matrix &Lgr; and the vector b). The SNR at the terminal is then estimated based on the signal power and the channel noise variance computed at the base station. The estimated SNR can then be used to properly code and modulate the data. </paragraph>
<paragraph id="P-0089" lvl="0"><number>&lsqb;0089&rsqb;</number> For the embodiments wherein the forward link quality is estimated at the base station, the coding and modulation scheme(s) selected for use by the base station may be sent to the terminal so that it can use the corresponding demodulation and decoding scheme(s) to recover the transmitted data. Alternatively, the terminal may perform &ldquo;blind&rdquo; decoding whereby it processes the received signals based on a number of hypotheses corresponding to a number of possible coding and modulation schemes. </paragraph>
<paragraph id="P-0090" lvl="0"><number>&lsqb;0090&rsqb;</number> Various techniques may be used to estimate the link quality. Some of these techniques are described in the following patents, which are all assigned to the assignee of the present application and incorporated herein by reference: </paragraph>
<paragraph id="P-0091" lvl="2"><number>&lsqb;0091&rsqb;</number> U.S. Pat. No. 5,799,005, entitled &ldquo;SYSTEM AND METHOD FOR DETERMINING RECEIVED PILOT POWER AND PATH LOSS IN A CDMA COMMUNICATION SYSTEM,&rdquo; issued Aug. 25, 1998, </paragraph>
<paragraph id="P-0092" lvl="2"><number>&lsqb;0092&rsqb;</number> U.S. Pat. No. 5,903,554, entitled &ldquo;METHOD AND APPARATUS FOR MEASURING LINK QUALITY IN A SPREAD SPECTRUM COMMUNICATION SYSTEM,&rdquo; issued May 11, 1999, </paragraph>
<paragraph id="P-0093" lvl="2"><number>&lsqb;0093&rsqb;</number> U.S. Pat. Nos. 5,056,109, and 5,265,119, both entitled &ldquo;METHOD AND APPARATUS FOR CONTROLLING TRANSMISSION POWER IN A CDMA CELLULAR MOBILE TELEPHONE SYSTEM,&rdquo; respectively issued Oct. 8, 1991 and Nov. 23, 1993, and </paragraph>
<paragraph id="P-0094" lvl="2"><number>&lsqb;0094&rsqb;</number> U.S. Pat. No. 6,097,972, entitled &ldquo;METHOD AND APPARATUS FOR PROCESSING POWER CONTROL SIGNALS IN CDMA MOBILE </paragraph>
<paragraph id="P-0095" lvl="0"><number>&lsqb;0095&rsqb;</number> TELEPHONE SYSTEM,&rdquo; issued Aug. 1, 2000. </paragraph>
<paragraph id="P-0096" lvl="0"><number>&lsqb;0096&rsqb;</number> Methods for estimating a single transmission channel based on a pilot reference or a data transmission may also be found in a number of papers available in the art. One such channel estimation method is described by F. Ling in a paper entitled &ldquo;Optimal Reception, Performance Bound, and Cutoff-Rate Analysis of References-Assisted Coherent CDMA Communications with Applications,&rdquo; IEEE Transaction On Communication, October 1999, and incorporated herein by reference. </paragraph>
</section>
<section>
<heading lvl="1">Transmitter Unit At the Base Station </heading>
<paragraph id="P-0097" lvl="0"><number>&lsqb;0097&rsqb;</number> <cross-reference target="DRAWINGS">FIGS. 3A and 3B</cross-reference> show a block diagram of a specific design of a transmitter unit <highlight><bold>110</bold></highlight><highlight><italic>a </italic></highlight>at a base station, which utilizes MIMO and OFDM and is capable of processing data in accordance with an embodiment of the invention. Transmitter unit <highlight><bold>110</bold></highlight><highlight><italic>a </italic></highlight>includes a TX data processor <highlight><bold>114</bold></highlight><highlight><italic>a </italic></highlight>that receives and processes information bits to provide modulation symbols, a TX channel processor <highlight><bold>120</bold></highlight><highlight><italic>a </italic></highlight>that preconditions the modulation symbols, and a number of modulators <highlight><bold>122</bold></highlight> that process the preconditioned modulation symbols to generate a number of modulated signals suitable for transmission to the terminal. </paragraph>
<paragraph id="P-0098" lvl="0"><number>&lsqb;0098&rsqb;</number> In the embodiment shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>A, TX data processor <highlight><bold>114</bold></highlight><highlight><italic>a </italic></highlight>includes a number of data stream processors <highlight><bold>310</bold></highlight><highlight><italic>a </italic></highlight>through <highlight><bold>310</bold></highlight><highlight><italic>n, </italic></highlight>one data stream processor <highlight><bold>310</bold></highlight> for each data stream to be independently coded and modulated. (One data stream may be transmitted on all transmission channels, on each group of transmission channels, or on each transmission channel.) Each data stream processor <highlight><bold>310</bold></highlight> includes an encoder <highlight><bold>312</bold></highlight>, an interleaver <highlight><bold>314</bold></highlight>, a channelizer <highlight><bold>316</bold></highlight>, and a symbol mapping element <highlight><bold>318</bold></highlight>. Encoder <highlight><bold>312</bold></highlight> receives the information bits for a particular data stream and encodes the received bits in accordance with a particular encoding scheme to provide coded bits. Channel interleaver <highlight><bold>314</bold></highlight> interleaves the coded bits based on a particular interleaving scheme to provide diversity. </paragraph>
<paragraph id="P-0099" lvl="0"><number>&lsqb;0099&rsqb;</number> Pilot data (e.g., data of a known pattern) may also be multiplexed with the processed information bits. The pilot data may be transmitted using any one of the pilot transmission schemes described above. The pilot reference may be used at the terminal to characterize the forward link and to estimate the link quality, as described above. </paragraph>
<paragraph id="P-0100" lvl="0"><number>&lsqb;0100&rsqb;</number> If code division multiplexing is utilized, channelizer <highlight><bold>316</bold></highlight> receives and channelizes the interleaved packet data and the pilot data on their assigned code channels. Symbol mapping element <highlight><bold>318</bold></highlight> then maps the channelized packet and pilot data into modulation symbols for the selected transmission channels. </paragraph>
<paragraph id="P-0101" lvl="0"><number>&lsqb;0101&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>A, the data encoding and interleaving by each data stream processor <highlight><bold>310</bold></highlight> may be achieved based on a respective coding control that identifies the specific coding and interleaving schemes to be used for the data stream. The symbol mapping by each data stream processor <highlight><bold>310</bold></highlight> may also be achieved based on a respective modulation control that identifies the specific modulation scheme to be used for the data stream. The specific coding and modulation scheme used for each data stream may be selected based on the forward link quality (e.g., as reported by the terminal) </paragraph>
<paragraph id="P-0102" lvl="0"><number>&lsqb;0102&rsqb;</number> In one type of coding and modulation scheme, the coding for each data stream is achieved by using a fixed base code and adjusting the puncturing to achieve the desired code rate, as supported by the SNRs of the transmission channels used to transmit the data stream. The base code may be a Turbo code, a convolutional code, a concatenated code, or some other code. The base code may also be of a particular rate (e.g., a rate &frac13;code). For this type of scheme, the puncturing may be performed after the interleaving to achieve the desired code rate. </paragraph>
<paragraph id="P-0103" lvl="0"><number>&lsqb;0103&rsqb;</number> Symbol mapping element <highlight><bold>318</bold></highlight> can be designed to group sets of channelized bits to form non-binary symbols, and to map each non-binary symbol into a point in a signal constellation corresponding to the modulation scheme selected for use. The modulation scheme may be QPSK, M-PSK, M-QAM, or some other scheme. Each mapped signal point corresponds to a modulation symbol. One modulation scheme may be selected for each transmission channel used to transmit the data stream, or a common modulation scheme may be used for all transmission channels used to transmit the data stream. </paragraph>
<paragraph id="P-0104" lvl="0"><number>&lsqb;0104&rsqb;</number> The encoding, interleaving, and symbol mapping at transmitter unit <highlight><bold>110</bold></highlight><highlight><italic>a </italic></highlight>can be performed based on numerous schemes. Some coding and modulation schemes are described in the following patent applications, which are all assigned to the assignee of the present application and incorporated herein by reference: </paragraph>
<paragraph id="P-0105" lvl="2"><number>&lsqb;0105&rsqb;</number> U.S. patent application Ser. No. 09/532,492, entitled &ldquo;HIGH EFFICIENCY, HIGH PERFORMANCE COMMUNICATIONS SYSTEM EMPLOYING MULTI-CARRIER MODULATION,&rdquo; filed Mar. 22, 2000; </paragraph>
<paragraph id="P-0106" lvl="2"><number>&lsqb;0106&rsqb;</number> U.S. patent application Ser. No. 09/776,075, entitled &ldquo;CODING SCHEME FOR A WIRELESS COMMUNICATION SYSTEM,&rdquo; filed Feb. 1, 2001; </paragraph>
<paragraph id="P-0107" lvl="2"><number>&lsqb;0107&rsqb;</number> U.S. patent application Ser. No. 09/826,481, &ldquo;METHOD AND APPARATUS FOR UTILIZING CHANNEL STATE INFORMATION IN A WIRELESS COMMUNICATION SYSTEM,&rdquo; filed Mar. 23, 2001; and </paragraph>
<paragraph id="P-0108" lvl="2"><number>&lsqb;0108&rsqb;</number> U.S. patent application Ser. No. 09/854,235, entitled &ldquo;METHOD AND APPARATUS FOR PROCESSING DATA IN A MULTIPLE-INPUT MULTIPLE-OUTPUT (MIMO) COMMUNICATION SYSTEM UTILIZING CHANNEL STATE INFORMATION,&rdquo; filed May 11, 2001. </paragraph>
<paragraph id="P-0109" lvl="0"><number>&lsqb;0109&rsqb;</number> The modulation symbols from TX data processor <highlight><bold>114</bold></highlight><highlight><italic>a </italic></highlight>are provided to TX channel processor <highlight><bold>120</bold></highlight><highlight><italic>a</italic></highlight>, which is one embodiment of TX channel processor <highlight><bold>120</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. Within TX channel processor <highlight><bold>120</bold></highlight><highlight><italic>a</italic></highlight>, a multiplexer/demultiplexer <highlight><bold>322</bold></highlight> receives and demultiplexes the modulation symbol from data stream processors <highlight><bold>310</bold></highlight><highlight><italic>a </italic></highlight>through <highlight><bold>310</bold></highlight><highlight><italic>n </italic></highlight>to the proper MIMO processors <highlight><bold>324</bold></highlight><highlight><italic>a </italic></highlight>through <highlight><bold>324</bold></highlight><highlight><italic>l</italic></highlight>. One MIMO processor <highlight><bold>324</bold></highlight> is provided to perform the preconditioning for each frequency subchannel. </paragraph>
<paragraph id="P-0110" lvl="0"><number>&lsqb;0110&rsqb;</number> Each MIMO processor <highlight><bold>324</bold></highlight> receives a stream of modulation symbols for the spatial subchannels of a particular frequency subchannel assigned to the MIMO processor. Each MIMO processor <highlight><bold>324</bold></highlight> further receives an eigenvector matrix E(k) for the frequency subchannel, which is a matrix of weights derived from the channel response matrix H<highlight><subscript>f</subscript></highlight>(k). Each MIMO processor <highlight><bold>324</bold></highlight> then preconditions the modulation symbols with the eigenvector matrix E(k), as shown in equations (5) and (6), to generate the preconditioned modulation symbols. </paragraph>
<paragraph id="P-0111" lvl="0"><number>&lsqb;0111&rsqb;</number> The preconditioned modulation symbols from MIMO processors <highlight><bold>324</bold></highlight><highlight><italic>a </italic></highlight>through <highlight><bold>3241</bold></highlight> are provided to combiners <highlight><bold>326</bold></highlight><highlight><italic>a </italic></highlight>through <highlight><bold>326</bold></highlight><highlight><italic>t. </italic></highlight>One combiner <highlight><bold>326</bold></highlight> is provided for each antenna at the base station. Each combiner <highlight><bold>326</bold></highlight> receives and combines up to N<highlight><subscript>F </subscript></highlight>preconditioned modulation symbols for N<highlight><subscript>F </subscript></highlight>frequency subchannels for a particular antenna to form a modulation symbol vector V. </paragraph>
<paragraph id="P-0112" lvl="0"><number>&lsqb;0112&rsqb;</number> TX channel processor <highlight><bold>120</bold></highlight><highlight><italic>a </italic></highlight>thus receives and processes the modulation symbols to provide up to N<highlight><subscript>T </subscript></highlight>modulation symbol vectors, V<highlight><subscript>1 </subscript></highlight>through V<highlight><subscript>Nt</subscript></highlight>, one modulation symbol vector for each antenna for data transmission. Each modulation symbol vector V covers a single time slot, and each element of the modulation symbol vector V is associated with a specific frequency subchannel having a unique subcarrier on which the modulation symbol is conveyed. </paragraph>
<paragraph id="P-0113" lvl="0"><number>&lsqb;0113&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3B</cross-reference> is a block diagram of an embodiment of modulators <highlight><bold>122</bold></highlight> for OFDM. The modulation symbol vectors V<highlight><subscript>1 </subscript></highlight>through V<highlight><subscript>Nt </subscript></highlight>from TX channel processor <highlight><bold>120</bold></highlight><highlight><italic>a </italic></highlight>are provided to modulators <highlight><bold>122</bold></highlight><highlight><italic>a </italic></highlight>through <highlight><bold>122</bold></highlight><highlight><italic>t, </italic></highlight>respectively. In the embodiment shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>B, each modulator <highlight><bold>122</bold></highlight> includes an inverse Fast Fourier Transform (IFFT) <highlight><bold>340</bold></highlight>, a cyclic prefix generator <highlight><bold>342</bold></highlight>, and an upconverter <highlight><bold>344</bold></highlight>. </paragraph>
<paragraph id="P-0114" lvl="0"><number>&lsqb;0114&rsqb;</number> IFFT <highlight><bold>340</bold></highlight> converts each received modulation symbol vector V into its time-domain representation (which is referred to as an OFDM symbol) using IFFT. IFFT <highlight><bold>340</bold></highlight> can be designed to perform the IFFT on any number of frequency subchannels (e.g., <highlight><bold>8</bold></highlight>, <highlight><bold>16</bold></highlight>, <highlight><bold>32</bold></highlight>, . . . , or N<highlight><subscript>F</subscript></highlight>). In an embodiment, for each modulation symbol vector converted to an OFDM symbol, cyclic prefix generator <highlight><bold>342</bold></highlight> repeats a portion of the time-domain representation of the OFDM symbol to form a &ldquo;transmission symbol&rdquo; for a specific antenna. The cyclic prefix insures that the transmission symbol retains its orthogonal properties in the presence of multipath delay spread, thereby improving performance against deleterious path effects. The cyclic prefix is selected to be sufficiently long relative to the expected amount of delay spread. The implementation of IFFT <highlight><bold>340</bold></highlight> and cyclic prefix generator <highlight><bold>342</bold></highlight> is known in the art and not described in detail herein. </paragraph>
<paragraph id="P-0115" lvl="0"><number>&lsqb;0115&rsqb;</number> The time-domain representations from each cyclic prefix generator <highlight><bold>342</bold></highlight> (i.e., the transmission symbols for each antenna) are further processed (e.g., converted into an analog signal, modulated, amplified, and filtered) by upconverter <highlight><bold>344</bold></highlight> to generate a modulated signal suitable for transmission over the forward link. The modulated signal generated by each modulator <highlight><bold>122</bold></highlight> is then transmitted from an associated antenna <highlight><bold>124</bold></highlight>. </paragraph>
<paragraph id="P-0116" lvl="0"><number>&lsqb;0116&rsqb;</number> OFDM modulation is described in further detail in a paper entitled &ldquo;Multicarrier Modulation for Data Transmission: An Idea Whose Time Has Come,&rdquo; by John A. C. Bingham, IEEE Communications Magazine, May 1990, which is incorporated herein by reference. </paragraph>
</section>
<section>
<heading lvl="1">Receiver Unit At the Terminal </heading>
<paragraph id="P-0117" lvl="0"><number>&lsqb;0117&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a block diagram of a specific design of a receiver unit <highlight><bold>150</bold></highlight><highlight><italic>a </italic></highlight>of a terminal, which is capable of receiving data in accordance with an embodiment of the invention. The transmitted signals from N<highlight><subscript>T </subscript></highlight>antennas at the base station are received by each of N<highlight><subscript>R </subscript></highlight>antennas <highlight><bold>152</bold></highlight><highlight><italic>a </italic></highlight>through <highlight><bold>152</bold></highlight><highlight><italic>r </italic></highlight>at the terminal and routed to a respective demodulator <highlight><bold>154</bold></highlight>. Each demodulator <highlight><bold>154</bold></highlight> conditions, processes, and digitizes the respective received signal to provide samples, which are provided to a RX channel processor <highlight><bold>156</bold></highlight><highlight><italic>a. </italic></highlight></paragraph>
<paragraph id="P-0118" lvl="0"><number>&lsqb;0118&rsqb;</number> Within RX channel processor <highlight><bold>156</bold></highlight><highlight><italic>a</italic></highlight>, the samples for each receive antenna <highlight><bold>152</bold></highlight> are provided to a respective FFT processor <highlight><bold>406</bold></highlight>, which generates transformed representations of the received samples and provides a respective stream of modulation symbol vectors. The N<highlight><subscript>R </subscript></highlight>streams of modulation symbol vectors from FFT processors <highlight><bold>406</bold></highlight><highlight><italic>a </italic></highlight>through <highlight><bold>406</bold></highlight><highlight><italic>r </italic></highlight>are then provided to multiplexer/demultiplexer <highlight><bold>408</bold></highlight>, which first demultiplexes the stream of modulation symbol vectors from each FFT processor <highlight><bold>406</bold></highlight> into N<highlight><subscript>F </subscript></highlight>streams of modulation symbols, one stream for each of the N<highlight><subscript>F </subscript></highlight>frequency subchannels. Multiplexer/demultiplexer <highlight><bold>408</bold></highlight> then multiplexes the N<highlight><subscript>R </subscript></highlight>streams of modulation symbols for each frequency subchannel into a stream of modulation symbol vector, r, with each vector in the stream including N<highlight><subscript>R </subscript></highlight>modulation symbols for the N<highlight><subscript>R </subscript></highlight>antennas. Multiplexer/demultiplexer <highlight><bold>408</bold></highlight> provides the N<highlight><subscript>F </subscript></highlight>streams of modulation symbol vectors, one stream at a time, to a spatial processor <highlight><bold>410</bold></highlight>. </paragraph>
<paragraph id="P-0119" lvl="0"><number>&lsqb;0119&rsqb;</number> For each frequency subchannel, a match filter <highlight><bold>412</bold></highlight> within spatial processor <highlight><bold>410</bold></highlight> filters the modulation symbol vector stream r by performing a pre-multiplication with the conjugate-transpose channel response matrix H<highlight><subscript>f</subscript></highlight><highlight><superscript>H</superscript></highlight>, as shown above in equation (8). The channel coefficient matrix H<highlight><subscript>f </subscript></highlight>for the forward link may be estimated by a channel estimator <highlight><bold>416</bold></highlight> based on the pilot reference transmitted from the base station. An eigenvector matrix E is then derived by a matrix processor <highlight><bold>418</bold></highlight> based on the channel coefficient matrix H<highlight><subscript>f</subscript></highlight>, as shown in equation (4). The filtered vectors from match filter <highlight><bold>412</bold></highlight> are further pre-multiplied by a multiplier <highlight><bold>414</bold></highlight> with the conjugate-transpose eigenvector matrix E<highlight><superscript>H </superscript></highlight>to generate the vectors of recovered modulation symbols y, as shown in equation (8). </paragraph>
<paragraph id="P-0120" lvl="0"><number>&lsqb;0120&rsqb;</number> A selector <highlight><bold>420</bold></highlight> receives the vectors of recovered modulation symbols, y, and extracts the modulation symbols corresponding to a particular data stream to be recovered. Selector <highlight><bold>420</bold></highlight> may then provide a number of symbol streams, z, corresponding to a number of data streams to be recovered by the terminal. Each symbol stream z includes recovered modulation symbols that correspond to, and are estimates of, the modulation symbols b after the symbol mapping (but prior to the preconditioning) at the base station for a particular data stream. Each recovered symbol stream z is then provided to a RX data processor <highlight><bold>158</bold></highlight><highlight><italic>a. </italic></highlight></paragraph>
<paragraph id="P-0121" lvl="0"><number>&lsqb;0121&rsqb;</number> Within RX data processor <highlight><bold>158</bold></highlight><highlight><italic>a</italic></highlight>, the stream of recovered modulation symbols for a particular data stream is demodulated by a demodulation element <highlight><bold>432</bold></highlight> in accordance with a demodulation scheme (e.g., M-PSK, M-QAM) that is complementary to the modulation scheme used for the data stream. Demodulation element <highlight><bold>432</bold></highlight> further performs decovering of the demodulated data, if the data is channelized at the base station by covering with orthogonal codes. The demodulated data is then de-interleaved by a de-interleaver <highlight><bold>434</bold></highlight> in a complementary manner to that performed by interleaver <highlight><bold>314</bold></highlight>, and the de-interleaved data is further decoded by a decoder <highlight><bold>436</bold></highlight> in a complementary manner to that performed by encoder <highlight><bold>312</bold></highlight>. For example, a Turbo decoder or a Viterbi decoder may be used for decoder <highlight><bold>436</bold></highlight> if Turbo or convolutional coding, respectively, is performed at the base station. The decoded data stream from decoder <highlight><bold>436</bold></highlight> represents an estimate of the transmitted data stream being recovered. </paragraph>
<paragraph id="P-0122" lvl="0"><number>&lsqb;0122&rsqb;</number> A CSI processor <highlight><bold>422</bold></highlight> receives the pilot and/or data transmission and estimates the forward link quality, as described above. For example, CSI processor <highlight><bold>422</bold></highlight> may compute a noise covariance matrix based on the received data and/or pilot and may further compute the SNR of a transmission channel. The SNR may be estimated similar to conventional pilot assisted single and multi-carrier systems, as is known in the art. The frequency response for all propagation paths (i.e., H<highlight><subscript>f</subscript></highlight>) derived by channel estimator <highlight><bold>416</bold></highlight> and the forward link quality (e.g., the SNR) estimated by CSI processor <highlight><bold>422</bold></highlight> may comprise the CSI that is reported by the terminal to the base station. The CSI is then provided to a TX data processor <highlight><bold>162</bold></highlight> (see <cross-reference target="DRAWINGS">FIG. 1</cross-reference>) for transmission back to the base station. </paragraph>
<paragraph id="P-0123" lvl="0"><number>&lsqb;0123&rsqb;</number> Referring back to <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, the CSI (e.g., H<highlight><subscript>f </subscript></highlight>and/or SNR) determined by RX channel processor <highlight><bold>156</bold></highlight> is provided to TX data processor <highlight><bold>162</bold></highlight>, which processes the CSI based on a particular processing scheme. TX data processor <highlight><bold>162</bold></highlight> further receives and process pilot data for transmission from one or more antennas and on one or more frequency subchannels. The processed CSI and pilot are then received and further processed by a TX channel processor <highlight><bold>164</bold></highlight> and then provided to one or more modulators <highlight><bold>154</bold></highlight>. Modulators <highlight><bold>154</bold></highlight> further condition and transmit the CSI and pilot on the reverse link to the base station. </paragraph>
<paragraph id="P-0124" lvl="0"><number>&lsqb;0124&rsqb;</number> At the base station, the CSI and pilot transmitted on the reverse link are received by antennas <highlight><bold>124</bold></highlight>, demodulated by demodulators <highlight><bold>122</bold></highlight>, and provided to a RX channel processor <highlight><bold>132</bold></highlight>. RX channel processor <highlight><bold>132</bold></highlight> processes the received pilot to derive the channel response matrix H<highlight><subscript>r </subscript></highlight>for the reverse link. RX channel processor <highlight><bold>132</bold></highlight> and a RX data processor <highlight><bold>134</bold></highlight> also process the received data in a complementary manner to that performed by TX channel processor <highlight><bold>164</bold></highlight> and TX data processor <highlight><bold>162</bold></highlight> to recover the </paragraph>
<paragraph id="P-0125" lvl="0"><number>&lsqb;0125&rsqb;</number> A controller <highlight><bold>136</bold></highlight> uses the recovered CSI to perform a number of functions including (1) determining the coding and modulation scheme to be used for each data stream, (2) deriving the eigenvector matrix E to be used to precondition the modulation symbols, and (3) computing the calibration function a(&ohgr;). Controller <highlight><bold>136</bold></highlight> then provides the coding and modulation control to TX data processor <highlight><bold>114</bold></highlight> and the preconditioning control to TX channel processor <highlight><bold>120</bold></highlight>, as shown in <cross-reference target="DRAWINGS">FIG. 3A</cross-reference>. </paragraph>
<paragraph id="P-0126" lvl="0"><number>&lsqb;0126&rsqb;</number> In the above description, the modulation symbols are preconditioned at the transmitter system based on the eigenvector matrix E derived from the channel response matrix H<highlight><subscript>f </subscript></highlight>for the forward link. In certain embodiments or for certain transmissions in which the channel response matrix H<highlight><subscript>f </subscript></highlight>is not available, the modulation symbols may be transmitted without preconditioning. In this case, linear spatial processing may be performed on the received symbols (for a non-dispersive MIMO channel with flat fading) or space-time processing may be performed (for a dispersive MIMO channel with frequency selective fading) at the terminal to null out the undesired signals and to maximize the received SNR of each of the constituent signals in the presence of noise and interference from other signals. The ability to effectively null undesired signals or optimize SNR depends upon the correlation in the channel response matrix H<highlight><subscript>f</subscript></highlight>. </paragraph>
<paragraph id="P-0127" lvl="0"><number>&lsqb;0127&rsqb;</number> The spatial processing may be achieved using linear spatial processing techniques such as a channel correlation matrix inversion (CCMI) technique, a minimum mean square error (MMSE) technique, and others. The space-time processing may be achieved using linear space-time processing techniques such as a MMSE linear equalizer (MMSE-LE), a decision feedback equalizer (DFE), a maximum-likelihood sequence estimator (MLSE), and others. The CCMI, MMSE, MMSE-LE, and DFE techniques are described in further detail in the aforementioned U.S. patent application Ser. Nos. 09/826,481 and 09/854,235. </paragraph>
<paragraph id="P-0128" lvl="0"><number>&lsqb;0128&rsqb;</number> For clarity, various aspects have been described for data transmission on the forward link from the base station to the terminal. The techniques described herein may also be applied for data transmission on the reverse link from the terminal to the base station. </paragraph>
<paragraph id="P-0129" lvl="0"><number>&lsqb;0129&rsqb;</number> The elements of the base station (e.g., as shown in <cross-reference target="DRAWINGS">FIGS. 1, 3A</cross-reference>, and <highlight><bold>3</bold></highlight>B) and the elements of the terminal (e.g., as shown in <cross-reference target="DRAWINGS">FIGS. 1 and 4</cross-reference>) may each be implemented with one or more digital signal processors (DSPs), application specific integrated circuits (ASICs), processors, microprocessors, controllers, microcontrollers, field programmable gate arrays (FPGAs), programmable logic devices, other electronic units, or any combination thereof. Some of the functions and processing described herein may also be implemented with software executed on a processor. Certain aspects of the invention may also be implemented with a combination of software and hardware. For example, the computations to determine the channel response matrix H<highlight><subscript>f </subscript></highlight>and the eigenvector matrix E and the preconditioning at the base station may be performed based on program codes executed on a processor (e.g., controller <highlight><bold>136</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>). Similarly, the computations to determine the channel response matrix H<highlight><subscript>f </subscript></highlight>and the eigenvector matrix E and the receiver processing at the terminal may be performed based on program codes executed on a processor. </paragraph>
<paragraph id="P-0130" lvl="0"><number>&lsqb;0130&rsqb;</number> Headings are included herein for reference and to aid in locating certain sections. These headings are not intended to limit the scope of the concepts described therein under, and these concepts may have applicability in other sections throughout the entire specification. </paragraph>
<paragraph id="P-0131" lvl="0"><number>&lsqb;0131&rsqb;</number> The previous description of the disclosed embodiments is provided to enable any person skilled in the art to make or use the present invention. Various modifications to these embodiments will be readily apparent to those skilled in the art, and the generic principles defined herein may be applied to other embodiments without departing from the spirit or scope of the invention. Thus, the present invention is not intended to be limited to the embodiments shown herein but is to be accorded the widest scope consistent with the principles and novel features disclosed herein.</paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is claimed is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. In a time division duplexed (TDD) communication system, a method for transmitting data from a transmitter unit over a wireless communication link to a receiver unit, the method comprising: 
<claim-text>receiving via the communication link a first transmission from the receiver unit; </claim-text>
<claim-text>estimating characteristics of the communication link based on the received first transmission; </claim-text>
<claim-text>coding and modulating the data based on one or more coding and modulation schemes to provide modulation symbols; </claim-text>
<claim-text>preconditioning the modulation symbols based on weights derived at least in part from the estimated characteristics of the communication link; and </claim-text>
<claim-text>transmitting the preconditioned modulation symbols from the transmitter unit via the communication link to the receiver unit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, further comprising: 
<claim-text>deriving a calibration function indicative of a difference between a first transfer function for a data transmission from the transmitter unit to the receiver unit and a second transfer function for a data transmission from the receiver unit to the transmitter unit, and </claim-text>
<claim-text>wherein the weights are further derived based on the calibration function. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00002">claim 2</dependent-claim-reference>, wherein the first transfer function is derived at the receiver unit and provided to the transmitter unit. </claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, further comprising: 
<claim-text>transmitting pilot reference from the transmitter unit via the communication link to the receiver unit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the TDD communication system implements orthogonal frequency division modulation (OFDM), and wherein the communication link comprises a plurality of frequency subchannels. </claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the TDD communication system implements multiple-input multiple-output (MIMO), and wherein the communication link comprises a plurality of spatial subchannels. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00006">claim 6</dependent-claim-reference>, wherein the TDD communication system further implements OFDM. </claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the communication link comprises a plurality of propagation paths, each propagation path corresponding to a path between a particular antenna at the transmitter unit and a particular antenna at the receiver unit. </claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00008">claim 8</dependent-claim-reference>, wherein the estimated characteristics of the communication link relate to frequency response of the propagation paths used to transmit the data to the receiver unit. </claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the first transmission from the receiver unit is a pilot reference. </claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00005">claim 5</dependent-claim-reference>, wherein the first transmission from the receiver unit is a pilot reference transmitted over all frequency subchannels. </claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00005">claim 5</dependent-claim-reference>, wherein the first transmission from the receiver unit is a pilot reference transmitted over a subset of all frequency subchannels. </claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00006">claim 6</dependent-claim-reference>, wherein the first transmission from the receiver unit is a pilot reference transmitted from all antennas at the receiver unit. </claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00006">claim 6</dependent-claim-reference>, wherein the first transmission from the receiver unit is a pilot reference transmitted from a subset of all antennas at the receiver unit in each particular time slot. </claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00006">claim 6</dependent-claim-reference>, wherein the first transmission from the receiver unit is a pilot reference transmitted from one or more antennas at the receiver unit, and wherein the pilot reference is transmitted on a different code channel for each of the one or more antennas. </claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, further comprising: 
<claim-text>receiving an indication of a quality of the communication link, and </claim-text>
<claim-text>wherein the one or more coding and modulation schemes are selected based on the received indication of the communication link quality. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the data is transmitted via a plurality of data streams, and wherein each data stream is coded and modulated with a respective coding and modulation scheme. </claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein the communication link quality is estimated at the receiver unit and provided to the transmitter unit. </claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein the communication link quality is estimated at the transmitter unit. </claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein the received indication is indicative of a signal-to-noise-plus-interference ratio (SNR). </claim-text>
</claim>
<claim id="CLM-00021">
<claim-text><highlight><bold>21</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00022">claim 20</dependent-claim-reference>, wherein an average SNR is received for each data stream to be independently coded and modulated. </claim-text>
</claim>
<claim id="CLM-00022">
<claim-text><highlight><bold>22</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein the received indication is indicative of a particular rate to be used for each data stream to be independently coded and modulated. </claim-text>
</claim>
<claim id="CLM-00023">
<claim-text><highlight><bold>23</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein the received indication is indicative of a particular coding and modulation scheme to be used for each data stream to be independently coded and modulated. </claim-text>
</claim>
<claim id="CLM-00024">
<claim-text><highlight><bold>24</bold></highlight>. In a time division duplexed (TDD) communication system, a method for transmitting data from a transmitter unit over a wireless communication link to a receiver unit, the method comprising: 
<claim-text>deriving a calibration function indicative of a difference between a first transfer function for a data transmission from the transmitter unit to the receiver unit and a second transfer function for a data transmission from the receiver unit to the transmitter unit; </claim-text>
<claim-text>receiving via the communication link a first transmission from the receiver unit; </claim-text>
<claim-text>estimating characteristics of the communication link based on the received first transmission; </claim-text>
<claim-text>coding and modulating the data based on one or more coding and modulation schemes to provide modulation symbols; </claim-text>
<claim-text>preconditioning the modulation symbols based on weights derived from the estimated characteristics of the communication link and the calibration function; and </claim-text>
<claim-text>transmitting the preconditioned modulation symbols from the transmitter unit via the communication link to the receiver unit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00025">
<claim-text><highlight><bold>25</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00022">claim 24</dependent-claim-reference>, wherein the TDD communication system implements multiple-input multiple-output (MIMO) and orthogonal frequency division modulation (OFDM). </claim-text>
</claim>
<claim id="CLM-00026">
<claim-text><highlight><bold>26</bold></highlight>. A transmitter unit in a time division duplexed (TDD) communication system, comprising: 
<claim-text>a receiver processor operative to receive via a communication link a first transmission from a receiver unit and to estimate characteristics of the communication link based on the received first transmission; </claim-text>
<claim-text>a transmit data processor operative to code and modulate data based on one or more coding and modulation schemes to provide modulation symbols; </claim-text>
<claim-text>a transmit channel processor operative to receive and precondition the modulation symbols based on weights derived at least in part from the estimated characteristics of the communication link; and </claim-text>
<claim-text>a modulator operative to receive, condition, and transmit the preconditioned modulation symbols via the communication link to the receiver unit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00027">
<claim-text><highlight><bold>27</bold></highlight>. The transmitter unit of <dependent-claim-reference depends_on="CLM-00022">claim 26</dependent-claim-reference>, further comprising: 
<claim-text>a controller operative to provide a first control indicative of the one or more coding and modulation schemes used to code and modulate the data and a second control indicative of the weights used to precondition the modulation symbols. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00028">
<claim-text><highlight><bold>28</bold></highlight>. The transmitter unit of <dependent-claim-reference depends_on="CLM-00022">claim 27</dependent-claim-reference>, wherein the controller is further operative to derive a calibration function indicative of a difference between a first transfer function for a data transmission from the transmitter unit to the receiver unit and a second transfer function for a data transmission from the receiver unit to the transmitter unit, and wherein the weights are further derived based on the calibration function </claim-text>
</claim>
<claim id="CLM-00029">
<claim-text><highlight><bold>29</bold></highlight>. The transmitter unit of <dependent-claim-reference depends_on="CLM-00022">claim 26</dependent-claim-reference>, wherein the transmit data processor is further operative to process pilot data for transmission via the communication link to the receiver unit. </claim-text>
</claim>
<claim id="CLM-00030">
<claim-text><highlight><bold>30</bold></highlight>. A receiver unit in a time division duplexed (TDD) communication system, comprising: 
<claim-text>one or more antennas, each antenna configured to receive via a communication link one or more modulated signals transmitted from a transmitter unit; </claim-text>
<claim-text>one or more front-end units, each front-end unit operative to process a signal from an associated antenna to provide a respective stream of received modulation symbols; </claim-text>
<claim-text>a spatial processor operative to receive and process the one or more streams of received modulation symbols to provide estimated characteristics of the communication link and to further process the received modulation symbols based at least in part on the estimated characteristics of the communication link to provide one or more streams of recovered modulation symbols; and </claim-text>
<claim-text>a receive data processor operative to receive and decode the one or more streams of recovered modulation symbols to provide one or more decoded data streams. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00031">
<claim-text><highlight><bold>31</bold></highlight>. The receiver unit of <dependent-claim-reference depends_on="CLM-00033">claim 30</dependent-claim-reference>, further comprising: 
<claim-text>a channel state information (CSI) processor operative to estimate the quality of the communication link based on the recovered modulation symbols; and </claim-text>
<claim-text>a transmit data processor operative to receive and process the estimated communication link quality for transmission from the receiver unit to the transmitter unit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00032">
<claim-text><highlight><bold>32</bold></highlight>. The receiver unit of <dependent-claim-reference depends_on="CLM-00033">claim 30</dependent-claim-reference>, further comprising: 
<claim-text>a transmit processor operative to process pilot data for transmission from the receiver unit to the transmitter unit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00033">
<claim-text><highlight><bold>33</bold></highlight>. The receiver unit of <dependent-claim-reference depends_on="CLM-00033">claim 32</dependent-claim-reference>, wherein the transmit processor is further operative to transmit the estimated characteristics of the communication link from the receiver unit to the transmitter unit. </claim-text>
</claim>
<claim id="CLM-00034">
<claim-text><highlight><bold>34</bold></highlight>. The receiver unit of <dependent-claim-reference depends_on="CLM-00033">claim 30</dependent-claim-reference>, wherein the spatial processor is operative to match filter the received modulation symbols based on a channel response matrix indicative of the estimated characteristics of the communication link and to multiply the filtered modulation symbols with a eigenvector matrix to provide the recovered modulation symbols. </claim-text>
</claim>
<claim id="CLM-00035">
<claim-text><highlight><bold>35</bold></highlight>. The receiver unit of <dependent-claim-reference depends_on="CLM-00033">claim 30</dependent-claim-reference>, wherein the one or more modulated signals are generated at the transmitter unit by 
<claim-text>coding and modulating the data based on one or more coding and modulation schemes to provide modulation symbols, </claim-text>
<claim-text>preconditioning the modulation symbols based on weights derived from estimated characteristics of the communication link derived at the transmitter unit, and </claim-text>
<claim-text>processing the preconditioned modulation symbols to provide the one or more modulated signals, one modulated signal for each antenna at the transmitter unit.</claim-text>
</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>1</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030002450A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030002450A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030002450A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030002450A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030002450A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030002450A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
