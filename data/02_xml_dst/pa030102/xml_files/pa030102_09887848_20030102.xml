<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030001516A1-20030102-M00001.NB SYSTEM "US20030001516A1-20030102-M00001.NB" NDATA NB>
<!ENTITY US20030001516A1-20030102-M00001.TIF SYSTEM "US20030001516A1-20030102-M00001.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00000.TIF SYSTEM "US20030001516A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00001.TIF SYSTEM "US20030001516A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00002.TIF SYSTEM "US20030001516A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00003.TIF SYSTEM "US20030001516A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00004.TIF SYSTEM "US20030001516A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00005.TIF SYSTEM "US20030001516A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00006.TIF SYSTEM "US20030001516A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00007.TIF SYSTEM "US20030001516A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00008.TIF SYSTEM "US20030001516A1-20030102-D00008.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00009.TIF SYSTEM "US20030001516A1-20030102-D00009.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00010.TIF SYSTEM "US20030001516A1-20030102-D00010.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00011.TIF SYSTEM "US20030001516A1-20030102-D00011.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00012.TIF SYSTEM "US20030001516A1-20030102-D00012.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00013.TIF SYSTEM "US20030001516A1-20030102-D00013.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00014.TIF SYSTEM "US20030001516A1-20030102-D00014.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00015.TIF SYSTEM "US20030001516A1-20030102-D00015.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00016.TIF SYSTEM "US20030001516A1-20030102-D00016.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00017.TIF SYSTEM "US20030001516A1-20030102-D00017.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00018.TIF SYSTEM "US20030001516A1-20030102-D00018.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00019.TIF SYSTEM "US20030001516A1-20030102-D00019.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00020.TIF SYSTEM "US20030001516A1-20030102-D00020.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00021.TIF SYSTEM "US20030001516A1-20030102-D00021.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00022.TIF SYSTEM "US20030001516A1-20030102-D00022.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00023.TIF SYSTEM "US20030001516A1-20030102-D00023.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00024.TIF SYSTEM "US20030001516A1-20030102-D00024.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00025.TIF SYSTEM "US20030001516A1-20030102-D00025.TIF" NDATA TIF>
<!ENTITY US20030001516A1-20030102-D00026.TIF SYSTEM "US20030001516A1-20030102-D00026.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030001516</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>09887848</doc-number>
</application-number>
<application-number-series-code>09</application-number-series-code>
<filing-date>20010622</filing-date>
</domestic-filing-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>H05B037/02</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>315</class>
<subclass>224000</subclass>
</uspc>
</classification-us-primary>
<classification-us-secondary>
<uspc>
<class>315</class>
<subclass>291000</subclass>
</uspc>
</classification-us-secondary>
</classification-us>
<title-of-invention>Electronic ballast</title-of-invention>
</technical-information>
<inventors>
<first-named-inventor>
<name>
<given-name>Robert</given-name>
<middle-name>C.</middle-name>
<family-name>Newman</family-name>
<name-suffix>JR.</name-suffix>
</name>
<residence>
<residence-us>
<city>Emmaus</city>
<state>PA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Stuart</given-name>
<family-name>DeJonge</family-name>
</name>
<residence>
<residence-us>
<city>Riegelsville</city>
<state>PA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Mark</given-name>
<family-name>Taipale</family-name>
</name>
<residence>
<residence-us>
<city>Harleysville</city>
<state>PA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Dominick</given-name>
<family-name>Travaglini</family-name>
</name>
<residence>
<residence-us>
<city>Doylestown</city>
<state>PA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Joel</given-name>
<middle-name>S.</middle-name>
<family-name>Spira</family-name>
</name>
<residence>
<residence-us>
<city>Coopersburg</city>
<state>PA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<assignee>
<organization-name>Lutron Electronics Co., Inc</organization-name>
<assignee-type>02</assignee-type>
</assignee>
<correspondence-address>
<name-1>Patent Department</name-1>
<name-2>Lutron Electronics Company, Inc.</name-2>
<address>
<address-1>7200 Suter Road</address-1>
<city>Coopersburg</city>
<state>PA</state>
<postalcode>18036-1299</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">An electronic ballast for driving a gas discharge lamp includes a rectifier, a valley-fill circuit, an inverter having first and second series-connected controllably conductive switches having complementary duty cycles, a control circuit for controlling the controllably conductive switches, and an independent cat ear power supply to provide power to the ballast control circuits. The result is a ballast having substantially improved power factor, THD, and current crest factor. In a preferred embodiment, the valley-fill circuit includes an energy storage device that stores energy in response to a controllably conductive switch. In an especially preferred embodiment, the controllably conductive switch of the valley-fill circuit is also one of the switches of the inverter. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">FIELD OF THE INVENTION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> The present invention relates to electronic ballasts and, more particularly, to electronic dimming ballasts for gas discharge lamps, such as fluorescent lamps. </paragraph>
</section>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> Electronic ballasts for fluorescent lamps typically can be analyzed as comprising a &ldquo;front end&rdquo; and a &ldquo;back end&rdquo;. The front end typically includes a rectifier for changing alternating current (AC) mains line voltage to a direct current (DC) bus voltage and a filter circuit for filtering the DC bus voltage. Electronic ballasts also often use a boost circuit for boosting the magnitude of the DC bus voltage. The filter circuit typically comprises a capacitive low-pass filter. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> The ballast back end typically includes a switching inverter for converting the DC bus voltage to a high-frequency AC voltage, and a resonant tank circuit having a relatively high output impedance for coupling the high-frequency AC voltage to the lamp electrodes. The ballast back end also typically includes a feedback circuit that monitors the lamp current and generates control signals to control the switching of the inverter so as to maintain a desired lamp current magnitude. </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> In order to maintain stable lamp operation, typical prior art electronic ballasts filter the DC bus voltage to minimize the amount of bus voltage ripple. This is usually accomplished by providing a bus capacitor having a relatively large capacitance and hence, a relatively large energy storage capacity. By providing a relatively large bus capacitor, the amount of decay from the rectified peak voltage is minimized from one half-cycle to the next half-cycle. Minimizing the amount of ripple on the DC bus also tends to minimize the current crest factor (CCF) of the lamp current. The CCF is defined as the ratio of the magnitude of the peak lamp current to the magnitude of the root-mean-square (RMS) value of the lamp current.  
<math-cwu id="MATH-US-00001">
<number>1</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>CCF</mi>
        <mo>&Congruent;</mo>
        <mfrac>
          <msub>
            <mi>I</mi>
            <mrow>
              <mi>p</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>k</mi>
            </mrow>
          </msub>
          <msub>
            <mi>I</mi>
            <mrow>
              <mi>R</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>MS</mi>
            </mrow>
          </msub>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>Equation</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mn>1</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00001" file="US20030001516A1-20030102-M00001.NB"/>
<image id="EMI-M00001" wi="216.027" he="18.96615" file="US20030001516A1-20030102-M00001.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> However, using a relatively large bus capacitor to minimize ripple on the DC bus voltage comes with its disadvantages. The bus capacitor must be fairly large, and is therefore more expensive and consumes more area on a printed circuit board, or the like, and volume within the ballast. Also, because the bus capacitor is discharging whenever the bus voltage level is above the absolute value of the AC mains voltage, the bus capacitor is recharging during a relatively short duration of each line half-cycle centered about the peak of the line voltage. This results in the typical prior art ballast having a tendency to draw a relatively large amount of current during the time that the bus capacitor is charging, as shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. Consequently, this results in a distorted input current waveform giving rise to unwanted harmonics and undesirable total harmonic distortion (THD)) and power factor for the ballast. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> One approach to lowering the THD and improving the ballast power factor has been to employ an active power factor correction (APFC) circuit. This approach has resulted in tradeoffs. Using an APFC circuit results in added ballast complexity, more components, greater cost, lower reliability, and possibly increased power consumption. Moreover, the ballast typically uses a relatively large bus capacitor with its attendant disadvantages as noted above. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> Another approach to lowering THD and improving ballast power factor has been to employ a valley-fill circuit between a rectifier and an inverter. One disadvantage of typical prior art valley-fill circuits is that they can have greater bus ripple, which results in higher lamp CCF, which can in turn shorten lamp life. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> Prior art approaches to providing electronic ballasts having improved power factor are and THD are discussed in T. -F. Wu, Y. -J. Wu, C. -H. Chang and Z. -R. Liu, &ldquo;Ripple-Free, Single-Stage Electronic Ballasts with Dither-Booster Power Factor Corrector&rdquo;, IEEE Industry Applications Society Annual Meeting, pp. 2372-77, 1997; Y. -S. Youn, G. Chae, and G. -H. Cho, &ldquo;A Unity Power Factor Electronic Ballast for Fluorescent Lamp having Improved Valley Fill and Valley Boost Converter&rdquo;, IEEE PESC97 Record, pp. 53-59, 1997; and G. Chae, Y. -S. Youn, and G. -H. Cho, &ldquo;High Power Factor Correction Circuit using Valley Charge-Pumping for Low Cost Electronic Ballasts&rdquo;, IEEE 0-7803-4489-8/98, pp. 2003-8, 1998. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> Prior art patents representative of attempts to provide electronic ballasts having improved power factor and THD include U.S. Pat. No. 5,387,847, &ldquo;Passive Power Factor Ballast Circuit for the Gas Discharge Lamps&rdquo;, issued Feb. 7, 1995 to Wood; U.S. Pat. No. 5,399,944, &ldquo;Ballast Circuit for Driving Gas Discharge&rdquo;, issued Mar. 21, 1995 to Konopka et al.; U.S. Pat. No. 5,517,086, &ldquo;Modified Valley Fill High Power Factor Correction Ballast&rdquo;, issued May 14, 1996 to El-Hamamsy et al.; and U.S. Pat. No. 5,994,847, &ldquo;Electronic Ballast with Lamp Current Valley-Fill Power Factor Correction&rdquo;, issued Nov. 30, 1999. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> In accordance with a first feature of the invention, a novel electronic ballast for driving a gas discharge lamp includes a rectifier to convert an AC mains input voltage to a rectified pulsating voltage, a valley-fill circuit including an energy storage element to which energy is delivered through a switched impedance to fill the valleys between successive rectified voltage peaks to produce a substantially DC bus voltage, a DC-to-AC voltage inverter having series-connected switching devices to convert the substantially DC bus voltage to a high-frequency AC voltage signal for driving the gas discharge lamp, a resonant tank for coupling the high-frequency AC voltage signal to the gas discharge lamp, and a control circuit for controlling the switching action of the switching devices to deliver a desired current to the gas discharge lamp. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> In a preferred embodiment of the ballast, the energy storage element of the valley-fill circuit includes a bus capacitor that stores energy during a first predetermined charging portion of each half-cycle of the AC mains voltage, and delivers energy to the gas discharge lamp during a second predetermined discharge portion of each half-cycle of the AC mains voltage. The switched impedance of the valley-fill circuit includes a resistor in series with a controllably conductive device (a field effect transistor), through which the bus capacitor is charged. </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> In an alternative embodiment, the energy storage device of the valley-fill circuit includes a bus capacitor, and the switched impedance includes a buck inductor in series with a field effect transistor, connected together in a buck converter configuration. The bus capacitor stores energy during a first predetermined charging portion of each half-cycle of the AC mains voltage, and delivers energy to the gas discharge lamp during a second predetermined discharge portion of each half-cycle of the AC mains voltage. The buck inductor stores energy in response to conduction of the field effect transistor during the charging period of the bus capacitor, and transfers the stored energy to the bus capacitor in response to non-conduction of the field effect transistor during the charging period of the bus capacitor. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> In an alternative embodiment, the buck inductor is provided with a tap connected to the bus voltage through a commutation diode to provide different energy storage and energy transfer times. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> In accordance with a second feature of the invention, a novel electronic ballast for driving a gas discharge lamp includes a rectifier to convert an AC mains input voltage to a rectified pulsating voltage, a valley-fill circuit to fill the valleys between successive rectified voltage peaks to produce a substantially DC bus voltage, a DC-to-AC voltage inverter having series-connected switching devices to convert the substantially DC bus voltage to a high-frequency AC voltage signal for driving the gas discharge lamp, a resonant tank for coupling the high-frequency AC voltage signal to the gas discharge lamp, a control circuit for controlling the switching action of the switching devices to deliver a desired current to the gas discharge lamp, and means for drawing input current near the zero crossing of the AC mains input voltage waveform so that the input current THD is substantially reduced, and the power factor of the ballast is increased. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> In a preferred embodiment of the ballast, the means for drawing current near the zero crossing is a cat ear power supply that supplies the power necessary to operate the control circuit. The cat ear power supply draws current from the AC mains from near the zero crossing of the AC mains voltage at either the leading edge of each half-cycle, or the trailing edge of each half-cycle, or both. The cat ear power supply derives its name from the shape of its input current waveform which &ldquo;fills in&rdquo; the current waveform drawn by the ballast from the AC mains around the zero crossings. The cat ear power supply may be provided with circuitry that &ldquo;cuts in&rdquo; and &ldquo;cuts out&rdquo; the power supply in response to fixed input voltage levels. Alternatively, the cat ear power supply may be provided with circuitry to monitor the current drawn by the ballast back end and cause the power supply to draw input current only when the back end is not drawing current. </paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a representation of voltage and current waveforms in a prior art electronic ballast with no APFC or valley-fill circuits with idealized waveforms shown as dashed lines; </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a simplified block diagram of the electronic ballast of the invention; </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a simplified schematic diagram of a first embodiment of a valley-fill circuit using a buck converter for use in an electronic ballast of the invention; </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a simplified representation of bus voltage in the buck converter of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> illustrating the method of operation; </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is a simplified schematic of the buck converter of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> illustrating a first mode of operation; </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a simplified schematic of the buck converter of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> illustrating a second mode of operation; </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a simplified representation of various voltage and current waveforms in an electronic ballast including the buck converter of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> at full light output; </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a simplified representation of various voltage and current waveforms in an electronic ballast including the buck converter of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> at ten percent light output; </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a simplified schematic diagram of a second embodiment of a valley-fill circuit having a buck converter integrated with an inverter in accordance with the present invention; </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a simplified schematic diagram of a third embodiment of a valley-fill circuit having an integrated buck converter with a tapped buck inductor in accordance with the invention; </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is a simplified schematic diagram of another alternative embodiment of a valley-fill circuit having a flyback transformer for recharging the bus capacitor; </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a simplified schematic diagram of a fourth embodiment of a valley-fill circuit in accordance with the present invention; </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is a simplified schematic diagram of a fifth embodiment of a valley-fill circuit in accordance with the present invention; </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 14</cross-reference> is a simplified schematic diagram of a sixth embodiment of a valley-fill circuit integrated with an inverter in accordance with the present invention; </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 15</cross-reference> is a simplified schematic diagram of a seventh embodiment of a valley-fill circuit in accordance with the present invention; </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 16</cross-reference> is a simplified schematic diagram of an eighth embodiment of a valley-fill circuit in accordance with the present invention; </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> <cross-reference target="DRAWINGS">FIGS. 17 and 18</cross-reference> are simplified schematic diagrams of a ballast constructed in accordance with the invention; </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 19</cross-reference> is a simplified diagram illustrating the duty cycle of the inverter switches changing over a half-cycle of the line voltage, and the resultant line current drawn by the ballast; </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> <cross-reference target="DRAWINGS">FIGS. 20 and 21</cross-reference> are simplified schematic diagrams of a second embodiment of an electronic ballast constructed in accordance with the invention; </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 22</cross-reference> is a simplified partial schematic diagram of the ballast of <cross-reference target="DRAWINGS">FIGS. 20 and 21</cross-reference> showing details of the control, waveshaping, and feedback circuitry; </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 23</cross-reference> is a simplified schematic diagram of an automatic gain control circuit of the waveshaping circuit of <cross-reference target="DRAWINGS">FIG. 22</cross-reference>; </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 24</cross-reference> is a simplified block diagram of a second embodiment of the feedback circuit of <cross-reference target="DRAWINGS">FIG. 20</cross-reference>; </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 25</cross-reference> is a simplified block diagram of a third embodiment of the feedback circuit of <cross-reference target="DRAWINGS">FIG. 20</cross-reference>; </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 26</cross-reference> is a simplified flowchart illustrating the operation of the feedback circuits of <cross-reference target="DRAWINGS">FIGS. 24 and 25</cross-reference>; </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 27</cross-reference> is a simplified schematic of a prior art cat ear power supply; </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 28</cross-reference> is a simplified waveform diagram illustrating the line current drawn by the cat ear power supply of <cross-reference target="DRAWINGS">FIGS. 20 and 22</cross-reference>; </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 29</cross-reference> is a simplified schematic diagram of a first embodiment of a cat ear power supply having fixed cut-in and cut-out points in accordance with the invention; </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 30</cross-reference> is a simplified schematic diagram of a second embodiment of a cat ear power supply including active monitoring of back end current; and </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 31</cross-reference> is a simplified waveform diagram illustrating the line current drawn by the electronic ballast of <cross-reference target="DRAWINGS">FIGS. 20 and 21</cross-reference>.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF THE INVENTION </heading>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> The foregoing summary, as well as the following detailed description of the preferred embodiments, is better understood when read in conjunction with the appended drawings. For the purposes of illustrating the invention, there is shown in the drawings an embodiment that is presently preferred, in which like numerals represent similar parts throughout the several views of the drawings, it being understood, however, that the invention is not limited to the specific methods and instrumentalities disclosed. </paragraph>
<paragraph id="P-0046" lvl="7"><number>&lsqb;0046&rsqb;</number> Ballast Overview </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> Referring first to <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, there is shown a simplified schematic diagram of an electronic ballast <highlight><bold>810</bold></highlight> constructed in accordance with the invention. The ballast <highlight><bold>810</bold></highlight> includes a rectifier <highlight><bold>820</bold></highlight> capable of being connected to an AC power supply such as a typical 60 Hz AC main. The rectifier <highlight><bold>820</bold></highlight> converts the AC input voltage to a rectified pulsating DC voltage. The rectifier <highlight><bold>820</bold></highlight> is connected to a novel valley-fill circuit <highlight><bold>830</bold></highlight>, to be described, through a diode <highlight><bold>840</bold></highlight>. A high-frequency filter capacitor <highlight><bold>850</bold></highlight> is connected across the inputs to the valley-fill circuit <highlight><bold>830</bold></highlight>. The valley-fill circuit <highlight><bold>830</bold></highlight> selectively charges and discharges an energy-storage device so as to reduce the amount of bus voltage ripple. The outputs of the valley-fill circuit <highlight><bold>830</bold></highlight> are in turn connected to the inputs to an inverter <highlight><bold>860</bold></highlight>. The inverter <highlight><bold>860</bold></highlight> converts the rectified DC voltage to a high-frequency AC voltage. The outputs of the inverter <highlight><bold>860</bold></highlight> are connected to an output circuit <highlight><bold>870</bold></highlight>, which typically includes a resonant tank, and may also include a coupling transformer. The output circuit filters the inverter <highlight><bold>860</bold></highlight> output to supply essentially sinusoidal voltage, as well as provide voltage gain and increased output impedance. The output circuit <highlight><bold>870</bold></highlight> is capable of being connected to drive a load <highlight><bold>880</bold></highlight> such as a gas discharge lamp; for example, a fluorescent lamp. An output current sense circuit <highlight><bold>890</bold></highlight> coupled to the load <highlight><bold>880</bold></highlight> provides load current feedback to a control circuit <highlight><bold>882</bold></highlight>. The control circuit <highlight><bold>882</bold></highlight> generates control signals to control the operation of the valley-fill circuit <highlight><bold>830</bold></highlight> and the inverter <highlight><bold>860</bold></highlight> so as to provide a desired load current to the load <highlight><bold>880</bold></highlight>. A power supply <highlight><bold>884</bold></highlight> is connected across the outputs of the rectifier <highlight><bold>820</bold></highlight> to provide the necessary power for proper operation of the control circuit <highlight><bold>882</bold></highlight>. </paragraph>
<paragraph id="P-0048" lvl="7"><number>&lsqb;0048&rsqb;</number> The Valley-Fill Circuit </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> Turning now to <cross-reference target="DRAWINGS">FIG. 3</cross-reference>, there is shown a schematic diagram of a first embodiment <highlight><bold>910</bold></highlight> of the valley-fill circuit <highlight><bold>830</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 2</cross-reference> in the form of a buck converter. Connected across first and second input terminals <highlight><bold>912</bold></highlight> and <highlight><bold>914</bold></highlight> is an energy-storage device <highlight><bold>916</bold></highlight>, in the form of a bus capacitor, in series with a first diode <highlight><bold>918</bold></highlight>. The function of the buck converter <highlight><bold>910</bold></highlight> is to provide a controlled charging current for the bus capacitor <highlight><bold>916</bold></highlight>. Connected to the junction of the bus capacitor <highlight><bold>916</bold></highlight> and the cathode of the first diode <highlight><bold>918</bold></highlight> is a buck inductor <highlight><bold>920</bold></highlight> which is connected in series with a second (optional) diode <highlight><bold>922</bold></highlight> and a controllably conductive switch <highlight><bold>924</bold></highlight> to a circuit common. Switch <highlight><bold>924</bold></highlight> is shown as a metal-oxide-silicon field-effect transistor (MOSFET), but may be a bipolar junction transistor (BJT), insulated gate bipolar transistor (IGBT), or other controllably conductive switching device. The buck converter <highlight><bold>910</bold></highlight> also includes a third commutating diode <highlight><bold>926</bold></highlight>, which may also be a suitably controlled synchronous rectifier or FET, connected between the junction of the buck inductor <highlight><bold>920</bold></highlight> and the second diode <highlight><bold>922</bold></highlight>, and the end of the bus capacitor <highlight><bold>916</bold></highlight> connected to the input <highlight><bold>912</bold></highlight>. A first output terminal <highlight><bold>928</bold></highlight> is connected to input terminal <highlight><bold>912</bold></highlight>, bus capacitor <highlight><bold>916</bold></highlight>, and the cathode of commutating diode <highlight><bold>926</bold></highlight>. A second output terminal <highlight><bold>930</bold></highlight> is connected to the second input terminal <highlight><bold>914</bold></highlight>, circuit common, the anode of diode <highlight><bold>918</bold></highlight>, and the switch <highlight><bold>924</bold></highlight>. </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> The operation of the buck converter <highlight><bold>910</bold></highlight> will be described in connection with <cross-reference target="DRAWINGS">FIGS. 4, 5</cross-reference>, and <highlight><bold>6</bold></highlight>. The buck converter <highlight><bold>910</bold></highlight> operates under two different conditions. In condition I (interval I in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>), the instantaneous rectified line voltage <highlight><bold>1010</bold></highlight> applied to the buck converter <highlight><bold>910</bold></highlight> is equal to or less than the voltage <highlight><bold>1012</bold></highlight> across the bus capacitor <highlight><bold>916</bold></highlight>, and the bus capacitor <highlight><bold>916</bold></highlight> is discharging its stored energy into the inverter. In this condition, the diode <highlight><bold>840</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 2</cross-reference>) is reverse biased, and the diode <highlight><bold>918</bold></highlight> is forward biased into conduction. This establishes a discharge path for the bus capacitor <highlight><bold>916</bold></highlight> from circuit common <highlight><bold>930</bold></highlight>, through the diode <highlight><bold>918</bold></highlight> and the bus capacitor <highlight><bold>916</bold></highlight>, to the buck converter output <highlight><bold>928</bold></highlight>. Switch <highlight><bold>924</bold></highlight> alternately opens and closes at a frequency substantially greater than the frequency of the rectified line voltage, typically about 30 kHz or greater. When the switch <highlight><bold>924</bold></highlight> is conducting, any residual energy remaining in the buck inductor <highlight><bold>920</bold></highlight> from the previous charging cycle is discharged through the diode <highlight><bold>922</bold></highlight> and the switch <highlight><bold>924</bold></highlight> to circuit common. Thereafter, the diodes <highlight><bold>922</bold></highlight> and <highlight><bold>926</bold></highlight> are reverse biased so that no further current flows through the buck inductor <highlight><bold>920</bold></highlight>. </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> In condition II (interval II in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>), the instantaneous rectified line voltage is greater than the voltage across the bus capacitor <highlight><bold>916</bold></highlight>, and the bus capacitor <highlight><bold>916</bold></highlight> is increasing its stored energy. During interval II, the operation of the buck converter depends on the conduction state of the switch <highlight><bold>924</bold></highlight>. </paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> When the switch <highlight><bold>924</bold></highlight> is conducting, the buck converter <highlight><bold>910</bold></highlight> reduces to the simplified form shown in <cross-reference target="DRAWINGS">FIG. 5</cross-reference> and the voltage across the buck inductor <highlight><bold>920</bold></highlight> is equal to the instantaneous rectified line voltage minus the voltage across the bus capacitor <highlight><bold>916</bold></highlight>. Thus, the bus capacitor <highlight><bold>916</bold></highlight> is charged by a current flowing from the input <highlight><bold>912</bold></highlight>, through the bus capacitor <highlight><bold>916</bold></highlight>, the buck inductor <highlight><bold>920</bold></highlight>, and the switch <highlight><bold>924</bold></highlight>, to circuit common. When the switch <highlight><bold>924</bold></highlight> is not conducting (as depicted in <cross-reference target="DRAWINGS">FIG. 6</cross-reference>), then the current <highlight><bold>1210</bold></highlight> flowing through the buck inductor <highlight><bold>920</bold></highlight> commutates through the diode <highlight><bold>926</bold></highlight> and flows into the bus capacitor <highlight><bold>916</bold></highlight>, thus transferring some or all of the energy stored in the inductor <highlight><bold>920</bold></highlight> to the bus capacitor <highlight><bold>916</bold></highlight>. Note that in condition II, the bus capacitor <highlight><bold>916</bold></highlight> is charging both when switch <highlight><bold>924</bold></highlight> is closed, and when switch <highlight><bold>924</bold></highlight> is open. </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> The result of the operation of the buck converter <highlight><bold>910</bold></highlight> is that the bus capacitor <highlight><bold>916</bold></highlight> charges over a longer period of time <highlight><bold>1310</bold></highlight>, as shown in <cross-reference target="DRAWINGS">FIG. 7</cross-reference> wherein the ballast is operating at full light output. The charging of the bus capacitor <highlight><bold>916</bold></highlight> preferably takes place over more than 90 degrees of each line half cycle. More preferably, the bus capacitor <highlight><bold>916</bold></highlight> charges for more than 100 degrees of each half cycle. However, as the charging time increases, so too does the bus voltage ripple. </paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> Another advantage of the buck converter valley-fill circuit is that the inrush current to the bus capacitor <highlight><bold>916</bold></highlight> at the beginning of each charge cycle is limited by the buck inductor <highlight><bold>920</bold></highlight>. This can also be seen in <cross-reference target="DRAWINGS">FIG. 7</cross-reference> in that the peak line current <highlight><bold>1312</bold></highlight> is greatly reduced as compared to the peak line current <highlight><bold>1314</bold></highlight> of typical prior art ballasts having no APFC or valley-fill circuitry. Inrush limiting is even more significant at initial ballast turn-on. </paragraph>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> Another advantage of the buck converter <highlight><bold>910</bold></highlight> is that it provides over-voltage protection for the bus capacitor <highlight><bold>916</bold></highlight>. That is, in an unloaded condition, such as when no lamp is present, the bus capacitor <highlight><bold>916</bold></highlight> will charge to no more than the peak rectified line voltage. This is in contrast to traditional boost and buck-boost converters wherein extra circuitry must be added to prevent charging of the bus capacitor to potentially catastrophically high voltages in an unloaded condition. </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>, as the lamp is dimmed down to about 10 percent light output, the charging time of the bus capacitor <highlight><bold>916</bold></highlight> decreases while the ballast input current approaches a smoother, more sinusoidal shape. Simultaneously, the bus ripple is also reduced, leading to lower lamp CCF. </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> Turning now to <cross-reference target="DRAWINGS">FIG. 9</cross-reference>, there is shown a second embodiment <highlight><bold>1410</bold></highlight> of the buck converter. In this embodiment, the buck converter <highlight><bold>1410</bold></highlight> and the inverter <highlight><bold>860</bold></highlight> share the controllably conductive switch <highlight><bold>924</bold></highlight>. The second embodiment <highlight><bold>1410</bold></highlight> of the buck converter operates essentially in the same way as the first embodiment <highlight><bold>910</bold></highlight>. </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> Turning now to <cross-reference target="DRAWINGS">FIG. 10</cross-reference>, there is shown a third embodiment <highlight><bold>1510</bold></highlight> of the buck converter in which the buck inductor <highlight><bold>920</bold></highlight> is replaced with a tapped inductor <highlight><bold>1520</bold></highlight> and the anode of the commutation diode <highlight><bold>926</bold></highlight> is coupled to the inductor <highlight><bold>1520</bold></highlight> tap, rather than the junction of the inductor <highlight><bold>1520</bold></highlight> and the diode <highlight><bold>922</bold></highlight>. The inductor tap provides the capability to vary the discharge time of the inductor <highlight><bold>1520</bold></highlight>. The continuous mode operation of the buck converter may be reduced, or eliminated altogether. However, this extra flexibility comes with the tradeoff of extra voltage stress on the switch <highlight><bold>924</bold></highlight>. When the inductor <highlight><bold>1520</bold></highlight> is transferring energy to the bus capacitor <highlight><bold>916</bold></highlight>, the tapped inductor <highlight><bold>1520</bold></highlight> acts so that the voltage applied across the switch <highlight><bold>924</bold></highlight> is equal to the voltage across the capacitor <highlight><bold>916</bold></highlight> multiplied by the turns ratio of the tapped inductor <highlight><bold>1520</bold></highlight>. A snubber circuit including a snubber diode <highlight><bold>1552</bold></highlight>, in series with the parallel combination of a snubber resistor <highlight><bold>1554</bold></highlight> and a snubber capacitor <highlight><bold>1556</bold></highlight>, is coupled between the junction of the buck inductor <highlight><bold>1520</bold></highlight> and the diode <highlight><bold>922</bold></highlight>, and circuit common, to dissipate uncoupled residual energy in the tapped inductor. </paragraph>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> In the tapped buck inductor embodiment of <cross-reference target="DRAWINGS">FIG. 10</cross-reference>, capacitor <highlight><bold>916</bold></highlight> is a parallel combination of two 47 microfarad, 250 volt capacitors, diodes <highlight><bold>918</bold></highlight> and <highlight><bold>926</bold></highlight> are MUR160 diodes, diodes <highlight><bold>922</bold></highlight> and <highlight><bold>1552</bold></highlight> are 1000 volt, 1 ampere diodes, resistor <highlight><bold>1554</bold></highlight> is a series combination of two 91 kilohm, 1 watt resistors, capacitor <highlight><bold>1556</bold></highlight> is a 0.0047 microfarad, 630 volt capacitor, and switch <highlight><bold>924</bold></highlight> is a 500 volt IRF1634G MOSFET. The tapped inductor <highlight><bold>1520</bold></highlight> has a total number of about 180 turns from the cathode of diode <highlight><bold>918</bold></highlight> to the anode of diode <highlight><bold>922</bold></highlight>, corresponding to an inductance of about 1.427 milliHenries, with the number of turns from the cathode of diode <highlight><bold>918</bold></highlight> to the tap being about 75, corresponding to an inductance of about 244 microHenries, and the number of turns from the tap to the anode of diode <highlight><bold>922</bold></highlight> being about 105, corresponding to an inductance of about 492 microHenries. </paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> In each embodiment of the valley-fill circuit <highlight><bold>830</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 2</cross-reference>), charging current increases with longer conduction times of the controllably conductive switch. This means that at low end, when the lamp is being dimmed, and the switch is conducting longer, then the accumulated charge is greater, which tends to raise the bus voltage. It is advantageous to have higher bus voltage at low end since the lamp voltage increases at low end and a higher bus voltage allows the lamp to be driven through a higher impedance. Higher output impedance improves lamp stability, as is discussed in U.S. Pat. No. 5,041,763, issued Aug. 20, 1991 to Sullivan et al., and assigned to Lutron Electronics Co., Inc. </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> The charging current also increases as the voltage differential between the rectified line voltage and the voltage across the bus capacitor increases. This results in the charging current in the buck converter being highest in the middle of the line half cycle, and lower towards the tails of the line half cycle, which in turn results in improved power factor and THD for the ballast. </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> Turning now to <cross-reference target="DRAWINGS">FIG. 11</cross-reference>, there is shown another embodiment <highlight><bold>1570</bold></highlight> of a valley-fill circuit. In this embodiment, the valley-fill circuit <highlight><bold>1570</bold></highlight> includes, in addition to the bus capacitor <highlight><bold>916</bold></highlight>, the diode <highlight><bold>922</bold></highlight>, and the switch <highlight><bold>924</bold></highlight>, a diode <highlight><bold>1572</bold></highlight> connected between the capacitor <highlight><bold>916</bold></highlight> and the terminal <highlight><bold>912</bold></highlight>, and a diode <highlight><bold>1574</bold></highlight> and a &ldquo;flyback&rdquo; transformer <highlight><bold>1576</bold></highlight>. The &ldquo;primary&rdquo; winding of the transformer <highlight><bold>1576</bold></highlight> is connected between the anode of the diode <highlight><bold>922</bold></highlight> and the terminal <highlight><bold>928</bold></highlight> of the valley-fill circuit <highlight><bold>1570</bold></highlight>. The &ldquo;secondary&rdquo; winding of the transformer <highlight><bold>1576</bold></highlight> is connected between circuit common and to the anode of the diode <highlight><bold>1574</bold></highlight>, the cathode of which is in turn connected to the junction of the capacitor <highlight><bold>916</bold></highlight> and the anode of the diode <highlight><bold>1572</bold></highlight>. </paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> When the rectified line voltage exceeds the voltage across the bus capacitor <highlight><bold>916</bold></highlight>, then the voltage developed across the &ldquo;secondary&rdquo; winding of the flyback transformer <highlight><bold>1576</bold></highlight> recharges the bus capacitor <highlight><bold>916</bold></highlight> through the diode <highlight><bold>1574</bold></highlight> when the &ldquo;secondary&rdquo; winding voltage exceeds the bus capacitor voltage. When the rectified line voltage falls below the voltage across the bus capacitor, then the bus capacitor <highlight><bold>916</bold></highlight> alternate discharges when the &ldquo;secondary&rdquo; winding voltage is lower than the bus capacitor voltage, and recharges when the &ldquo;secondary&rdquo; winding voltage exceeds the bus capacitor voltage. </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> Turning now to <cross-reference target="DRAWINGS">FIG. 12</cross-reference>, there is shown a fourth embodiment <highlight><bold>1610</bold></highlight> of a valley-fill circuit. In this embodiment, the valley-fill circuit <highlight><bold>1610</bold></highlight> includes a first energy storage capacitor <highlight><bold>1632</bold></highlight> connected in series with a first diode <highlight><bold>1634</bold></highlight> across first and second input terminals <highlight><bold>912</bold></highlight>, <highlight><bold>914</bold></highlight> to the circuit <highlight><bold>1610</bold></highlight>. A second energy storage capacitor <highlight><bold>1616</bold></highlight> is connected in series with a second diode <highlight><bold>1636</bold></highlight>, the cathode of which is tied to the input <highlight><bold>912</bold></highlight>. A third diode <highlight><bold>1638</bold></highlight> is connected between the junction of capacitor <highlight><bold>1632</bold></highlight> and diode <highlight><bold>1634</bold></highlight>, and the junction of capacitor <highlight><bold>1616</bold></highlight> and diode <highlight><bold>1636</bold></highlight>. The other end of energy storage capacitor <highlight><bold>1616</bold></highlight> is connected to the second input terminal <highlight><bold>914</bold></highlight> by means of a fourth diode <highlight><bold>1618</bold></highlight> in parallel with a resistor <highlight><bold>1620</bold></highlight>. </paragraph>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> When the rectified voltage across the input terminals <highlight><bold>912</bold></highlight>, <highlight><bold>914</bold></highlight> exceeds the sum of the voltages across the capacitors <highlight><bold>1632</bold></highlight> and <highlight><bold>1616</bold></highlight> by the forward voltage drop across the diode <highlight><bold>1638</bold></highlight>, then the diodes <highlight><bold>1634</bold></highlight>, <highlight><bold>1636</bold></highlight>, and <highlight><bold>1618</bold></highlight> are reverse biased, the diode <highlight><bold>1638</bold></highlight> is forward biased, and the energy storage capacitors <highlight><bold>1632</bold></highlight>, <highlight><bold>1616</bold></highlight> charge through the series path of capacitor <highlight><bold>1632</bold></highlight>, diode <highlight><bold>1638</bold></highlight>, capacitor <highlight><bold>1616</bold></highlight>, and resistor <highlight><bold>1620</bold></highlight>. Resistor <highlight><bold>1620</bold></highlight> limits the inrush charging current into the energy storage capacitors <highlight><bold>1632</bold></highlight>, <highlight><bold>1616</bold></highlight> to reduce current spikes in the current drawn by the ballast from the line, thereby improving power factor and THD. The capacitors <highlight><bold>1632</bold></highlight>, <highlight><bold>1616</bold></highlight> typically each have the same value and charge to approximately one-half the peak input voltage. </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> When the rectified voltage across the input terminals <highlight><bold>912</bold></highlight>, <highlight><bold>914</bold></highlight> falls below the sum of the voltage across capacitors <highlight><bold>1632</bold></highlight>, <highlight><bold>1616</bold></highlight>, then diode <highlight><bold>1638</bold></highlight> is reverse biased. Once the voltage across the input terminals <highlight><bold>912</bold></highlight>, <highlight><bold>914</bold></highlight> falls below the voltage across the capacitor <highlight><bold>1632</bold></highlight> by more than the turn-on voltage of the diode <highlight><bold>1634</bold></highlight>, then capacitor <highlight><bold>1632</bold></highlight> discharges through diode <highlight><bold>1634</bold></highlight> and output terminals <highlight><bold>928</bold></highlight> and <highlight><bold>930</bold></highlight>. Once the voltage across the input terminals <highlight><bold>912</bold></highlight>, <highlight><bold>914</bold></highlight> falls below the voltage across the capacitor <highlight><bold>1616</bold></highlight> by more than the turn-on voltage of the diode <highlight><bold>1636</bold></highlight>, then capacitor <highlight><bold>1616</bold></highlight> discharges through the diode <highlight><bold>1636</bold></highlight>, the resistor <highlight><bold>1620</bold></highlight>, and the output terminals <highlight><bold>928</bold></highlight>, <highlight><bold>930</bold></highlight>. When the voltage drop across the resistor <highlight><bold>1620</bold></highlight> exceeds the turn-on voltage of the diode <highlight><bold>1618</bold></highlight>, then capacitor <highlight><bold>1616</bold></highlight> discharges through diodes <highlight><bold>1636</bold></highlight>, <highlight><bold>1618</bold></highlight> and the output terminals <highlight><bold>928</bold></highlight>, <highlight><bold>930</bold></highlight>. </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> In summary, the capacitors <highlight><bold>1632</bold></highlight>, <highlight><bold>1616</bold></highlight> charge in series, and discharge in parallel, delivering their stored energy to the lamp. The amount of ripple in the bus voltage is thereby reduced, which in turn leads to improved current crest factor in the ballast. </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> The valley-fill circuit <highlight><bold>1610</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 12</cross-reference> differs significantly from the valley-fill circuit of Wood in U.S. Pat. No. 5,387,847. Most notably, Wood, in <cross-reference target="DRAWINGS">FIG. 2</cross-reference> of his patent, shows a resistor in series with a diode connected between two capacitors. In contrast, the valley-fill circuit of <cross-reference target="DRAWINGS">FIG. 12</cross-reference> provides the resistor <highlight><bold>1620</bold></highlight> in parallel with the diode <highlight><bold>1618</bold></highlight>, the pair connected between the capacitor <highlight><bold>1616</bold></highlight> and circuit common. This novel arrangement provides the desired degree of power factor improvement, but does so in a manner that more readily lends itself to additional improvements in power factor. </paragraph>
<paragraph id="P-0069" lvl="0"><number>&lsqb;0069&rsqb;</number> To further improve the power factor of the ballast, the valley-fill circuit <highlight><bold>1610</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 12</cross-reference> may be modified by adding a controllably conductive switch <highlight><bold>924</bold></highlight> in series with the resistor <highlight><bold>1620</bold></highlight> as shown in <cross-reference target="DRAWINGS">FIG. 13</cross-reference>. The switch <highlight><bold>924</bold></highlight> will typically be operated at a high frequency, that is, many times greater than the fundamental line frequency. The power factor of the ballast may be improved by controlling the switching action of switch <highlight><bold>924</bold></highlight> so that the conduction time of the switch <highlight><bold>924</bold></highlight> is reduced near the &ldquo;tails&rdquo; or zero crossings of the line voltage, and increased near the center or peak of each line half cycle. This results in a ballast input current waveform that more nearly matches the line voltage waveform. </paragraph>
<paragraph id="P-0070" lvl="0"><number>&lsqb;0070&rsqb;</number> The valley-fill circuit <highlight><bold>1710</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 13</cross-reference> may be integrated with the ballast inverter as shown in <cross-reference target="DRAWINGS">FIG. 14</cross-reference> wherein the controllable switch <highlight><bold>924</bold></highlight> is shared by the valley-fill circuit <highlight><bold>1810</bold></highlight> and the inverter. </paragraph>
<paragraph id="P-0071" lvl="0"><number>&lsqb;0071&rsqb;</number> Resistive losses in the valley-fill circuit <highlight><bold>1710</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 13</cross-reference> may be reduced as shown in <cross-reference target="DRAWINGS">FIG. 15</cross-reference> by replacing resistor <highlight><bold>1620</bold></highlight> with an inductor <highlight><bold>1920</bold></highlight> in series with switch <highlight><bold>924</bold></highlight>. In an alternative arrangement, the combination of the inductor <highlight><bold>1920</bold></highlight> and the switch <highlight><bold>924</bold></highlight> may be replaced by a single large inductor. However, the high-frequency switching action of switch <highlight><bold>924</bold></highlight> permits a relatively small, and inexpensive, inductor <highlight><bold>1920</bold></highlight> to be used. </paragraph>
<paragraph id="P-0072" lvl="0"><number>&lsqb;0072&rsqb;</number> As an alternative to switch <highlight><bold>924</bold></highlight>, a secondary winding <highlight><bold>2024</bold></highlight> from a high-frequency transformer may be substituted as shown in <cross-reference target="DRAWINGS">FIG. 16</cross-reference>. High-frequency transformers are typically present in ballasts. By the addition of the proper number of turns of a secondary winding (preferably to an already existing transformer), a voltage of alternating polarity may be introduced in series with inductor <highlight><bold>1920</bold></highlight>, alternately opposing and aiding the flow of current through the inductor <highlight><bold>1920</bold></highlight>. The winding <highlight><bold>2024</bold></highlight> thereby effectively functions as a switch. The high-frequency &ldquo;switching&rdquo; action of the winding <highlight><bold>2024</bold></highlight> causes the inductor <highlight><bold>1920</bold></highlight> to present a higher effective impedance to the current flowing therethrough, thereby allowing a relatively small-valued inductor to be used. </paragraph>
<paragraph id="P-0073" lvl="7"><number>&lsqb;0073&rsqb;</number> The Inverter </paragraph>
<paragraph id="P-0074" lvl="0"><number>&lsqb;0074&rsqb;</number> As can be seen in <cross-reference target="DRAWINGS">FIGS. 17 and 18</cross-reference>, connected to the output of the bus capacitor <highlight><bold>916</bold></highlight> and the buck converter <highlight><bold>1510</bold></highlight> is a high-frequency DC-to-AC inverter <highlight><bold>2110</bold></highlight> for providing a high-frequency AC signal for driving a gas discharge lamp. The inverter <highlight><bold>2110</bold></highlight> includes series-connected first and second switching devices <highlight><bold>2112</bold></highlight> and <highlight><bold>924</bold></highlight>. The bus voltage is the greater of either the rectified line voltage, or the voltage across the bus capacitor <highlight><bold>916</bold></highlight>. When the input line voltage is greater than the voltage on the bus capacitor <highlight><bold>916</bold></highlight>, then the inverter <highlight><bold>2110</bold></highlight> draws current directly from the AC line. When the rectified line voltage is less than the bus capacitor <highlight><bold>916</bold></highlight> voltage, then the inverter draws current from the capacitor <highlight><bold>916</bold></highlight>. </paragraph>
<paragraph id="P-0075" lvl="0"><number>&lsqb;0075&rsqb;</number> The operation of the inverter <highlight><bold>2110</bold></highlight> will now be described in connection with <cross-reference target="DRAWINGS">FIG. 19</cross-reference>. The inverter <highlight><bold>2110</bold></highlight> uses a fixed frequency, D(1-D) complementary duty cycle switching mode of operation. This means that one, and only one, of the switching devices <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight> is conducting at all times. In this discussion, the duty cycle D refers to the conduction time of the first switch <highlight><bold>2112</bold></highlight>, and the complementary duty cycle 1-D refers to the conduction time of the second switch <highlight><bold>924</bold></highlight>. When switch <highlight><bold>2112</bold></highlight> (referred to in <cross-reference target="DRAWINGS">FIG. 19</cross-reference> as SW<highlight><bold>1</bold></highlight>) is conducting, then the output of the inverter <highlight><bold>2110</bold></highlight> is pulled upwardly toward the bus voltage. When the switching device <highlight><bold>924</bold></highlight> (referred to as SW<highlight><bold>2</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 19</cross-reference>) is conducting, then the output of the inverter <highlight><bold>2110</bold></highlight> is pulled downwardly toward circuit common. Maximum output is achieved when the duty cycle D is equal to 0.5, that is, when the conduction times of the two switching devices <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight> are equal. This occurs near the tails of each line voltage half-cycle, that is, near the line voltage zero crossings. The conduction times of the switching devices <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight> are controlled by a control circuit <highlight><bold>882</bold></highlight> in response to the current flowing through the gas discharge lamps <highlight><bold>2210</bold></highlight>, <highlight><bold>2212</bold></highlight>. The operation of the control circuit is described in detail below. The control circuit <highlight><bold>882</bold></highlight> drives the inverter switches <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight> in a manner so that more line current is drawn by the ballast near the peak of each line half-cycle, and less current is drawn near the zero crossings. A more nearly sinusoidal input current waveform is achieved, as shown in <cross-reference target="DRAWINGS">FIG. 19</cross-reference>. This results in improved power factor and input line current THD. </paragraph>
<paragraph id="P-0076" lvl="7"><number>&lsqb;0076&rsqb;</number> The Resonant Tank </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> Referring again to <cross-reference target="DRAWINGS">FIGS. 17, 18</cross-reference>, the output of the inverter <highlight><bold>2110</bold></highlight> is connected to a resonant tank circuit <highlight><bold>2220</bold></highlight> comprising an inductor <highlight><bold>2222</bold></highlight> and a capacitor <highlight><bold>2224</bold></highlight>. The resonant tank <highlight><bold>2220</bold></highlight> filters the inverter <highlight><bold>2110</bold></highlight> output voltage to supply essentially sinusoidal voltage to the lamps <highlight><bold>2210</bold></highlight>, <highlight><bold>2212</bold></highlight>. In addition, the resonant tank <highlight><bold>2220</bold></highlight> provides voltage gain and increased output impedance. The output of the resonant tank <highlight><bold>2220</bold></highlight> is coupled to the electrodes of the gas discharge lamps <highlight><bold>2210</bold></highlight>, <highlight><bold>2212</bold></highlight> by means of a transformer <highlight><bold>2230</bold></highlight>. ADC blocking capacitor <highlight><bold>2232</bold></highlight> prevents DC current from flowing through the primary windings of the transformer <highlight><bold>2230</bold></highlight>. </paragraph>
<paragraph id="P-0078" lvl="7"><number>&lsqb;0078&rsqb;</number> The Current Sense Circuit </paragraph>
<paragraph id="P-0079" lvl="0"><number>&lsqb;0079&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 18</cross-reference>, the ballast also includes a current sense circuit <highlight><bold>2240</bold></highlight> comprising first and second diodes <highlight><bold>2242</bold></highlight> and <highlight><bold>2244</bold></highlight>, and resistor <highlight><bold>2246</bold></highlight>, coupled in series with the lamps <highlight><bold>2210</bold></highlight>, <highlight><bold>2212</bold></highlight>. The current sense circuit <highlight><bold>2240</bold></highlight> generates a half-wave rectified voltage that is proportional to lamp current and represents a measure of actual light output. The half-wave rectified voltage is supplied as an input to the control circuit <highlight><bold>882</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 17</cross-reference>. In an alternative embodiment, the current sensing may be performed in a well-known manner by using a current transformer, or alternatively, a full-wave rectification diodes. For non-dimming ballasts, and dimming ballasts where only modest performance is required, the current sense circuit may be omitted. </paragraph>
<paragraph id="P-0080" lvl="7"><number>&lsqb;0080&rsqb;</number> The Control Circuit </paragraph>
<paragraph id="P-0081" lvl="0"><number>&lsqb;0081&rsqb;</number> The control circuit <highlight><bold>882</bold></highlight> will be described with reference to <cross-reference target="DRAWINGS">FIGS. 20, 21</cross-reference>, and <highlight><bold>22</bold></highlight>. A first embodiment of the control circuit <highlight><bold>882</bold></highlight> generates output drive signals to control the conduction of the switching devices <highlight><bold>2112</bold></highlight> and <highlight><bold>924</bold></highlight>. The control circuit <highlight><bold>882</bold></highlight> receives as an input the half-wave rectified voltage from the current sense circuit <highlight><bold>2240</bold></highlight> and generates a DC voltage that represents actual light output from the lamps. This DC voltage, representative of light output, is compared to a reference voltage, indicative of a desired light level, to adjust the duty cycles of the switching devices <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight> so as to minimize the difference between the light output voltage and the reference voltage. In a dimming electronic ballast, the reference voltage may be provided by an external input such as a 0-to-10 Volt control signal. Alternatively, the reference voltage may be generated by detecting a phase angle control signal applied to the ballast by means of the AC line voltage. In yet another embodiment, the reference voltage may be generated from a phase angle control signal applied to the ballast via an additional input to the ballast, such as is depicted in <cross-reference target="DRAWINGS">FIGS. 20, 22</cross-reference> by the &ldquo;Dimmed Hot&rdquo; input. </paragraph>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> The control circuit includes a feedback circuit <highlight><bold>2440</bold></highlight> connected to receive inputs from the current sense circuit <highlight><bold>2240</bold></highlight> and a control input circuit <highlight><bold>2460</bold></highlight>, and supplies drive signals to the gates of the switches <highlight><bold>2112</bold></highlight> and <highlight><bold>924</bold></highlight>. The control circuit may optionally include a waveshaping circuit <highlight><bold>2480</bold></highlight> to provide an additional input to the feedback circuit <highlight><bold>2440</bold></highlight>, as will be described in detail below. </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> As can be seen in <cross-reference target="DRAWINGS">FIG. 22</cross-reference>, the feedback circuit <highlight><bold>2440</bold></highlight> includes a differential amplifier <highlight><bold>2442</bold></highlight> connected to receive at its inverting terminal <highlight><bold>2444</bold></highlight> the input signal representative of lamp light output from the current sense circuit <highlight><bold>2240</bold></highlight>, and to receive at its non-inverting terminal <highlight><bold>2446</bold></highlight> the desired light level reference signal. The differential amplifier <highlight><bold>2442</bold></highlight> produces an error signal representative of the difference between the actual light output and the desired light output. The error signal is in turn provided to a pulse-wave modulation (PWM) circuit <highlight><bold>2448</bold></highlight> that generates the drive signals that are applied to the gates of the inverter switches <highlight><bold>2112</bold></highlight> and <highlight><bold>924</bold></highlight>. The PWM circuit <highlight><bold>2448</bold></highlight> is well-known in the art and hence will not be described in detail here. </paragraph>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> The control circuit may be designed to have either a &ldquo;fast&rdquo; response, or a &ldquo;slow&rdquo; response. That is, if the control circuit has a fast response, then it will react quickly to changes in lamp drive current to alter the duty cycles of the inverter switches <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight> so as to adjust the output voltage of the inverter <highlight><bold>2110</bold></highlight> to bring the lamp drive current back to the desired value. While a control circuit having a fast response improves the crest factor of the lamp drive current, this improvement comes at the expense of increased THD for the ballast input current. </paragraph>
<paragraph id="P-0085" lvl="0"><number>&lsqb;0085&rsqb;</number> If the control circuit has a slow response, then it will react slowly to changes in lamp drive current. A control circuit having a slow response improves the ballast input current THD, but at the expense of increased lamp drive current crest factor. Striking the appropriate balance between having a control circuit with a fast response or a slow response can be difficult. </paragraph>
<paragraph id="P-0086" lvl="0"><number>&lsqb;0086&rsqb;</number> The optional waveshaping circuit <highlight><bold>2480</bold></highlight> provides an additional means for controlling the rate and manner of response of the control circuit. The waveshaping circuit <highlight><bold>2480</bold></highlight> provides an AC reference voltage signal that is summed with the essentially DC reference voltage signal from the control input circuit <highlight><bold>2460</bold></highlight>. While the shape of the AC reference voltage signal can be made to take on a variety of waveshapes depending upon the desires of the circuit designer and the complexity of the waveshaping circuit, a particularly effective, yet simple, circuit can be designed that takes advantage of the waveforms already present in the ballast. </paragraph>
<paragraph id="P-0087" lvl="0"><number>&lsqb;0087&rsqb;</number> The waveshaping circuit <highlight><bold>2480</bold></highlight>, shown in detail in <cross-reference target="DRAWINGS">FIG. 22</cross-reference>, includes a voltage divider including a resistor <highlight><bold>2482</bold></highlight> connected in series with an automatic gain control (AGC) circuit <highlight><bold>2690</bold></highlight> that provides a scaled version of the bus voltage from the buck converter <highlight><bold>1510</bold></highlight>. Details of the AGC <highlight><bold>2690</bold></highlight> are shown in <cross-reference target="DRAWINGS">FIG. 23</cross-reference> and discussed below. If it is not necessary to adjust the gain of the waveshaping circuit <highlight><bold>2480</bold></highlight>, such as in non-dimming ballasts, then the AGC <highlight><bold>2690</bold></highlight> may optionally be replaced by a passive impedance element, such as a resistor. </paragraph>
<paragraph id="P-0088" lvl="0"><number>&lsqb;0088&rsqb;</number> The scaled voltage signal from the divider is clipped by means of a diode <highlight><bold>2486</bold></highlight> having its anode connected to the output of the divider and its cathode connected to a DC reference voltage VREF. The clipped signal is then passed through a DC blocking capacitor <highlight><bold>2488</bold></highlight> to be summed with the DC reference voltage from the control input circuit <highlight><bold>2460</bold></highlight>. </paragraph>
<paragraph id="P-0089" lvl="0"><number>&lsqb;0089&rsqb;</number> The control circuit also includes a low end clamp <highlight><bold>2680</bold></highlight> connected between the common tie point for the control input, waveshaping, and feedback circuitry, and circuit common. The low end clamp <highlight><bold>2680</bold></highlight> prevents the reference voltage from going so low that the current through the lamp cannot be sustained. This prevents the lamp from having to be re-struck each half-cycle. </paragraph>
<paragraph id="P-0090" lvl="0"><number>&lsqb;0090&rsqb;</number> The addition of the AC reference signal has the effect of reducing the combined reference voltage when the bus voltage is lower, such as near the zero crossings of the input line voltage, and increasing the combined reference voltage as the bus voltage is increasing, such as when the input line voltage is approaching a peak. The desired lamp current supplied to the lamp by the inverter <highlight><bold>2110</bold></highlight> will likewise be less when the bus voltage is lower, and increasing when the bus voltage is increasing. Thus, the addition of the AC reference signal, which tracks or follows the bus voltage, has the effect of shaping the current drawn by the lamp to the bus voltage, thereby improving the power factor and THD of the line current drawn by the ballast. However, this improvement in power factor and THD comes at the expense of greater lamp CCF. </paragraph>
<paragraph id="P-0091" lvl="0"><number>&lsqb;0091&rsqb;</number> An additional feature of the waveshaping circuit <highlight><bold>2480</bold></highlight> is the diode <highlight><bold>2486</bold></highlight> for clipping the peaks of the AC reference signal. During the time when the AC reference voltage signal is clipped, the combined reference voltage remains constant while the bus voltage is peaking. The overall response of the control circuit is designed to be &ldquo;fast&rdquo;, so the control circuit responds quickly during the peaks in the bus voltage so as to reduce the duty cycle of switch <highlight><bold>2112</bold></highlight> so as to deliver a constant voltage, and thus, a constant current, to the lamp. The net effect is to &ldquo;shave off&rdquo; the peaks of the lamp drive current envelope by reducing the duty cycle of the switch <highlight><bold>2112</bold></highlight> so as to reduce peak lamp drive current, and thus reduce lamp CCF. At the same time, the duty cycle of switch <highlight><bold>924</bold></highlight> increases, thereby increasing the charging time, and hence, the charging current drawn by the bus capacitor <highlight><bold>916</bold></highlight>, so as to keep the line current drawn by the ballast more nearly sinusoidal so as to reduce ballast input current THD. Electronic dimming ballasts constructed with the waveshaping circuit as described have achieved stable operation with ballast input current THD below 20 percent and lamp drive current crest factor below 1.7. </paragraph>
<paragraph id="P-0092" lvl="0"><number>&lsqb;0092&rsqb;</number> The AGC circuit <highlight><bold>2690</bold></highlight>, shown in <cross-reference target="DRAWINGS">FIG. 23</cross-reference>, reduces the gain of the waveshaping circuit <highlight><bold>2480</bold></highlight> when it is desired to dim the lamp. The AGC circuit <highlight><bold>2690</bold></highlight> includes first and second transistors <highlight><bold>2691</bold></highlight> and <highlight><bold>2692</bold></highlight>, resistors <highlight><bold>2693</bold></highlight>, <highlight><bold>2694</bold></highlight>, and <highlight><bold>2695</bold></highlight>, and diode <highlight><bold>2696</bold></highlight>. The conduction of the first transistor <highlight><bold>2691</bold></highlight> is controlled by the output of the control input <highlight><bold>2460</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 22</cross-reference>). When the input voltage goes low, indicating a dimming condition, conduction of the first transistor <highlight><bold>2691</bold></highlight> decreases, raising the voltage at the base of the second transistor <highlight><bold>2692</bold></highlight>, thereby causing the second transistor <highlight><bold>2692</bold></highlight> to become more conductive, effectively lowering the impedance of the AGC circuit <highlight><bold>2690</bold></highlight> presented to the waveshaping circuit <highlight><bold>2480</bold></highlight>, resulting in lower gain for the sampled waveform. Raising the input voltage, such as when it is desired to increase the light level, causes the first transistor <highlight><bold>2691</bold></highlight> to become more conductive, lowering the voltage at the base of the second transistor <highlight><bold>2692</bold></highlight>, thereby causing the second transistor <highlight><bold>2692</bold></highlight> to become less conductive, thereby causing the AGC circuit <highlight><bold>2690</bold></highlight> to present an effectively greater impedance to the waveshaping circuit <highlight><bold>2480</bold></highlight>, thereby increasing the gain of the sampled waveform. </paragraph>
<paragraph id="P-0093" lvl="0"><number>&lsqb;0093&rsqb;</number> A second embodiment of the feedback circuit <highlight><bold>2440</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 20</cross-reference> is shown in <cross-reference target="DRAWINGS">FIG. 24</cross-reference> and includes a microcontroller <highlight><bold>26102</bold></highlight> coupled to receive as inputs representative of the desired light level and the lamp current, and produce as outputs signals for driving the gates of the inverter switches. One such microcontroller suitable for use is manufactured by Motorola Corporation under the model number MC68HC08. For simplicity, analog-to-digital and digital-to-analog circuits necessary for interfacing the microcontroller <highlight><bold>26102</bold></highlight> with the analog circuitry of the ballast are considered to be within the ordinary skill of the art and are not shown here. </paragraph>
<paragraph id="P-0094" lvl="0"><number>&lsqb;0094&rsqb;</number> A third embodiment of the feedback circuit <highlight><bold>2440</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 20</cross-reference> is shown in <cross-reference target="DRAWINGS">FIG. 25</cross-reference> and includes in addition to the microcontroller <highlight><bold>26102</bold></highlight> a gate driver circuit <highlight><bold>26104</bold></highlight> that receives a single gate drive signal from the microcontroller <highlight><bold>26102</bold></highlight> and produces signals capable of controlling the operation of the inverter switches. One such gate driver circuit suitable for use is manufactured by International Rectifier under the part number IR2111. Of course, other suitable microcontrollers (such as a PIC16C54A from Power Integrations) and gate drivers may be substituted for the specific embodiments mentioned here. In addition, an application specific integrated circuit (ASIC) (not shown) may be substituted to provide the same functionality as the microcontrollers disclosed herein. </paragraph>
<paragraph id="P-0095" lvl="0"><number>&lsqb;0095&rsqb;</number> A high-level flowchart illustrating the operation of the feedback control circuit embodiment of <cross-reference target="DRAWINGS">FIGS. 24 and 25</cross-reference>, shown in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>, includes the steps of measuring the lamp current IL (step <highlight><bold>26110</bold></highlight>), and measuring the dimming signal VDIM representative of the desired light level (step <highlight><bold>26120</bold></highlight>). The measured lamp current IL is compared to the measured dimming signal VDIM (step <highlight><bold>26130</bold></highlight>) and, if IL is less than VDIM, then the duty cycle D of the inverter is increased by increasing the pulse width of the gate drive signal (step <highlight><bold>26140</bold></highlight>). If IL is greater than VDIM, as determined in step <highlight><bold>26150</bold></highlight>, then the duty cycle D is decreased by decreasing the pulse width of the gate drive signal (step <highlight><bold>26160</bold></highlight>). If IL is equal to VDIM, then the duty cycle remains unchanged and the process repeats. </paragraph>
<paragraph id="P-0096" lvl="7"><number>&lsqb;0096&rsqb;</number> The Cat Ear Power Supply </paragraph>
<paragraph id="P-0097" lvl="0"><number>&lsqb;0097&rsqb;</number> Cat ear power supplies have been used for years to provide power for control circuits in two-wire, triac-based dimmers for incandescent lamps and fan motors. A typical prior art cat ear power supply is shown in <cross-reference target="DRAWINGS">FIG. 27</cross-reference>. In such applications, the dimmer is located between the AC mains and the load, receiving as input sinusoidal voltage and providing as output &ldquo;truncated&rdquo; form of the sinusoidal input voltage in which the leading edge of the input voltage waveform is blocked by the non-conducting triac, and only the trailing portion of the input voltage waveform is passed on to the load by the triac which is turned on at a predetermined time and conducts until the next zero crossing of the input voltage waveform. By varying the phase conduction angle of the triac, the amount of power delivered to the load may be controlled. The prior art cat ear power supply draws power from the AC mains during a portion of the input voltage waveform when the triac is not conducting. In other words, the prior art cat ear power supply draws current from the line during the time that the load is &ldquo;off line&rdquo;. However, until now, cat ear power supplies are not believed to have been used for the purpose of deliberately shaping the current drawn from the line by an electronic ballast (or other electronic devices, such as switch-mode power supplies or line-to-DC converters) so as to improve the power factor and THD of the ballast (or other electronic device) by rendering the current drawn by the ballast more nearly sinusoidal. </paragraph>
<paragraph id="P-0098" lvl="0"><number>&lsqb;0098&rsqb;</number> The novel ballast of the invention includes a cat ear power supply <highlight><bold>884</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 20</cross-reference>) connected across the outputs of the rectifier <highlight><bold>820</bold></highlight>. The cat ear power supply may be generally defined as a power supply that is designed to draw current from the line during predetermined portions of the line cycle. The cat ear power supply may thus be used for shaping the ballast input current waveform so as to improve ballast power factor and ballast input current THD. Indeed, the cat ear power supply may be used for shaping the input current waveform of a variety of electronic devices, such as the previously mentioned switch-mode power supplies and line-to-DC converters, for the purpose shaping the input current waveform, improving power factor, and reducing input current THD. </paragraph>
<paragraph id="P-0099" lvl="0"><number>&lsqb;0099&rsqb;</number> The cat ear supply <highlight><bold>884</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 2</cross-reference>) draws current from the rectifier <highlight><bold>820</bold></highlight> only at the &ldquo;tails&rdquo; of the input line cycle, that is, the regions of the input line cycle adjacent to the line voltage zero crossings, as shown in <cross-reference target="DRAWINGS">FIG. 28</cross-reference>. The cat ear power supply <highlight><bold>884</bold></highlight> &ldquo;fills in&rdquo; the tails of the input line current drawn from the AC mains by the ballast when the back end of the ballast is not drawing current from the line. By filling in the tails, the line current drawn by the ballast is made more nearly sinusoidal, thereby reducing input line current THD, and improving power factor. </paragraph>
<paragraph id="P-0100" lvl="0"><number>&lsqb;0100&rsqb;</number> In a first embodiment <highlight><bold>2810</bold></highlight> of the cat ear power supply <highlight><bold>884</bold></highlight>, shown in <cross-reference target="DRAWINGS">FIG. 29</cross-reference>, the cat ear power supply <highlight><bold>2810</bold></highlight> is designed with fixed voltage cut-in and cut-out points. That is, the first embodiment <highlight><bold>2810</bold></highlight> of the cat ear power supply will only draw current from the AC mains when the rectified line voltage is below a fixed value. This condition will occur from a predetermined time before a line voltage zero crossing to a predetermined time after the line voltage zero crossing. The cut-out and cut-in voltage points can be adjusted so that the cat ear power supply <highlight><bold>2810</bold></highlight> draws current during a first interval from a time just after the line voltage zero crossing to a time when the bus capacitor <highlight><bold>916</bold></highlight> begins drawing charging current from the line, and during a second interval from a time when the bus capacitor <highlight><bold>916</bold></highlight> stops drawing charging current from the line until the next line voltage zero crossing. </paragraph>
<paragraph id="P-0101" lvl="0"><number>&lsqb;0101&rsqb;</number> When the rectified line voltage is lower than a predetermined voltage, a charging transistor <highlight><bold>2812</bold></highlight> conducts to allow charging of energy-storage device capacitor <highlight><bold>2814</bold></highlight>, which charges toward a voltage VCC. The rate of charge of the capacitor <highlight><bold>2814</bold></highlight> is determined by a resistor <highlight><bold>2816</bold></highlight> in series with the drain of the MOSFET transistor <highlight><bold>2812</bold></highlight>, which, in conjunction with the value of the capacitor <highlight><bold>2814</bold></highlight>, can be chosen so as to substantially match the value of VCC to the predetermined cut-out and cut-in voltages. This allows for a substantially piece-wise continuous ballast input current. Although the transistor <highlight><bold>2812</bold></highlight> is shown as a MOSFET, it may be any suitable controllably conductive device, such as, without limitation, a BJT or an IGBT. </paragraph>
<paragraph id="P-0102" lvl="0"><number>&lsqb;0102&rsqb;</number> When the rectified line voltage is equal to or greater than the predetermined voltage, then cut-out transistor <highlight><bold>2818</bold></highlight> begins conducting. The collector of the cut-out transistor <highlight><bold>2818</bold></highlight> pulls the cathode of a Zener diode <highlight><bold>2820</bold></highlight> toward VCC, which effectively turns off the charging transistor <highlight><bold>2812</bold></highlight>. The predetermined cut-in and cut-out voltages are determined by the resistive voltage divider network including resistors <highlight><bold>2822</bold></highlight> and <highlight><bold>2824</bold></highlight>, to which the base of the cut-out transistor <highlight><bold>2818</bold></highlight> is connected. </paragraph>
<paragraph id="P-0103" lvl="0"><number>&lsqb;0103&rsqb;</number> In a second embodiment <highlight><bold>2910</bold></highlight> of the cat ear power supply <highlight><bold>884</bold></highlight>, shown in <cross-reference target="DRAWINGS">FIG. 30</cross-reference>, the cat ear supply <highlight><bold>2910</bold></highlight> includes a circuit that actively monitors current drawn from the back end of the ballast and only draws current from the line when the back end is not drawing current above a predetermined value. The current monitor circuit includes transistor <highlight><bold>2930</bold></highlight>, capacitor <highlight><bold>2932</bold></highlight>, resistors <highlight><bold>2934</bold></highlight> and <highlight><bold>2936</bold></highlight>, and diodes <highlight><bold>2938</bold></highlight> and <highlight><bold>2940</bold></highlight>. When the ballast back end is drawing current above the predetermined value, the voltage at the emitter of transistor <highlight><bold>2930</bold></highlight> goes negative by a voltage equivalent to the combined forward voltage drops of diodes <highlight><bold>2938</bold></highlight>, <highlight><bold>2940</bold></highlight>. The resulting forward bias across the base-emitter junction of transistor <highlight><bold>2930</bold></highlight> turns transistor <highlight><bold>2930</bold></highlight> on, effectively pulling the gate of transistor <highlight><bold>2812</bold></highlight> low, thereby turning off transistor <highlight><bold>2812</bold></highlight>. When back end current falls below the predetermined value, capacitor <highlight><bold>2932</bold></highlight> discharges to ground, transistor <highlight><bold>2930</bold></highlight> turns off, allowing transistor <highlight><bold>2812</bold></highlight> to turn on and provide a charging path for capacitor <highlight><bold>2814</bold></highlight>. This second embodiment yields a slight improvement in THD over the first embodiment. </paragraph>
<paragraph id="P-0104" lvl="0"><number>&lsqb;0104&rsqb;</number> In addition to providing a means for shaping the input current drawn by the ballast so as to improve power factor and THD, the cat ear power supply advantageously provides a faster start-up of the ballast and is not affected by the operating mode of the ballast in the same way that typical prior art trickle-charge and bootstrap systems are affected. </paragraph>
<paragraph id="P-0105" lvl="0"><number>&lsqb;0105&rsqb;</number> The result of combining the improved valley-fill circuits, control circuits, and cat ear power supply of the present invention may be seen in <cross-reference target="DRAWINGS">FIG. 31</cross-reference>. </paragraph>
<paragraph id="P-0106" lvl="0"><number>&lsqb;0106&rsqb;</number> The cat ear power supply comprises means for drawing input current near the zero crossing of the AC input voltage waveform so that the input current THD is substantially reduced. In other words, the cat ear power supply fills in the current waveform near the zero crossings. </paragraph>
<paragraph id="P-0107" lvl="0"><number>&lsqb;0107&rsqb;</number> The improved valley-fill circuits of the invention comprise means for storing energy in an energy storage device over a substantial portion of each half-cycle of the AC input voltage so that the ballast power factor and THD are substantially improved. This is depicted in <cross-reference target="DRAWINGS">FIG. 31</cross-reference> wherein it may be seen that the middle portion of each line half-cycle current waveform conforms substantially to an ideal sinusoidal current waveform. </paragraph>
<paragraph id="P-0108" lvl="0"><number>&lsqb;0108&rsqb;</number> The combination of the cat ear power supply and the improved valley-fill circuits comprises means for selectively drawing current from the AC power supply so that the input current to the ballast is essentially sinusoidal. </paragraph>
<paragraph id="P-0109" lvl="0"><number>&lsqb;0109&rsqb;</number> The operation of the ballast is further enhanced by the control circuit disclosed herein which comprises means for selectively varying the complementary duty cycles of the inverter switches in response to the bus voltage so as to cause an energy storage device to draw more current from the AC power supply around the peak of each line half-cycle of the bus voltage, and draw less current near the troughs of each line half-cycle of the bus voltage. </paragraph>
<paragraph id="P-0110" lvl="0"><number>&lsqb;0110&rsqb;</number> While the embodiments heretofore described have been primarily directed to improving the THD, lamp current crest factor, and power factor of an electronic ballast, either of the dimming or non-dimming variety, the inventors believe that provision of an independent power supply in an electronic ballast is itself novel. That is, insofar as the inventors have been able to discover, all prior art electronic ballasts that have included control circuits for controlling the operation of an inverter stage have drawn the power for operating such control circuits from a transformer within the ballast, usually associated with the inverter stage, or an AFPC stage. This is so because such transformers have been present for the normal operating functions of the ballast. It is very easy to provide an additional secondary winding on such transformers for the purpose of drawing off power to drive the control circuits. </paragraph>
<paragraph id="P-0111" lvl="0"><number>&lsqb;0111&rsqb;</number> Unfortunately, while it may be more cost effective to simply add another secondary winding to an already present transformer, it becomes more complicated to start up the ballast in a controlled manner upon application of power. This has lead to more complex circuitry for handling abnormal and transient conditions within such ballasts. </paragraph>
<paragraph id="P-0112" lvl="0"><number>&lsqb;0112&rsqb;</number> The provision of an independent power supply, that is, one that derives its power directly from the line at the front end of the ballast, either through the ballast&apos;s own rectifier stage, or through its own dedicated rectifier, rather than from the secondary of a transformer associated with the ballast back end, greatly simplifies the handling of transient conditions upon start up, shut down, and during abnormal or fault conditions. In the present case, the preferred form of such an independent power supply is the previously described cat ear power supply. Thus, the independent power supply of the preferred embodiment allows one to decouple the power supply from the back end, thereby simplifying control of the ballast, while simultaneously providing a means to more precisely control the manner in which current is drawn from the line so as to reduce THD and improve power factor. </paragraph>
<paragraph id="P-0113" lvl="0"><number>&lsqb;0113&rsqb;</number> Although the present invention has been described in relation to particular embodiments thereof, many other variations and modifications and other uses will become apparent to those skilled in the art. It is preferred, therefore, that the present invention be limited not by the specific disclosure herein, but only by the appended claims.</paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is claimed is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. An electronic ballast for driving a gas discharge lamp, the ballast drawing an essentially sinusoidal AC input current from an AC power supply, the ballast comprising: 
<claim-text>a rectifier for rectifying said AC input voltage from said AC power supply to produce a rectified bus voltage; </claim-text>
<claim-text>an inverter for converting said rectified bus voltage to a high-frequency AC drive voltage to drive said lamp; and </claim-text>
<claim-text>current drawing means coupled to receive said rectified bus voltage for selectively drawing current from said AC power supply so that the input current to said ballast is essentially sinusoidal. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The electronic ballast according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein said current drawing means includes a cat ear power supply. </claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The electronic ballast according to <dependent-claim-reference depends_on="CLM-00002">claim 2</dependent-claim-reference> wherein said cat ear power supply includes means for drawing current from said AC power supply when said AC input voltage waveform is less than a predetermined value. </claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The electronic ballast according to <dependent-claim-reference depends_on="CLM-00002">claim 2</dependent-claim-reference> wherein said cat ear power supply includes means for drawing current from said AC power supply when the current drawn by said inverter from is substantially zero. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. An electronic ballast for driving a gas discharge lamp, the ballast having improved input current total harmonic distortion (THD), the ballast comprising: 
<claim-text>a rectifier for rectifying an AC input voltage from an AC power supply to produce a rectified bus voltage; </claim-text>
<claim-text>an inverter for converting the rectified bus voltage to a high-frequency AC output voltage to drive said lamp; and </claim-text>
<claim-text>means for drawing current from the AC power supply near the zero crossing of the AC input voltage so that the input current THD is substantially reduced. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The electronic ballast according to <dependent-claim-reference depends_on="CLM-00005">claim 5</dependent-claim-reference> further comprising a control circuit connected to drive said inverter; and 
<claim-text>wherein said means for drawing comprises a cat ear power supply for supplying power to operate said control circuit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. The electronic ballast according to <dependent-claim-reference depends_on="CLM-00006">claim 6</dependent-claim-reference> wherein said cat ear power supply includes means for drawing current from said AC power supply when said AC input voltage waveform is less than a predetermined value. </claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The electronic ballast according to <dependent-claim-reference depends_on="CLM-00006">claim 6</dependent-claim-reference> wherein said cat ear power supply includes means for drawing current from said AC power supply when the current drawn by said inverter from said AC power supply is substantially zero. </claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. An electronic ballast for driving a gas discharge lamp, the ballast having improved power factor and total harmonic distortion, the ballast comprising: 
<claim-text>a rectifier for rectifying an AC input voltage from an AC power supply to produce a rectified bus voltage; </claim-text>
<claim-text>a valley-fill circuit having an energy storage device, said valley-fill circuit electrically coupled to receive said rectified bus voltage; </claim-text>
<claim-text>an inverter for converting said rectified bus voltage to a high-frequency AC output voltage to drive said lamp; and </claim-text>
<claim-text>energy delivery control means for controlling the delivery of energy to said energy storage device over a substantial portion of each half-cycle of the AC input voltage so that the ballast power factor and THD are substantially improved. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. The electronic ballast according to <dependent-claim-reference depends_on="CLM-00009">claim 9</dependent-claim-reference> wherein said energy delivery control means includes a buck inductor. </claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. The electronic ballast according to <dependent-claim-reference depends_on="CLM-00009">claim 9</dependent-claim-reference> wherein said energy delivery control means includes a tapped buck inductor. </claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. The electronic ballast according to <dependent-claim-reference depends_on="CLM-00009">claim 9</dependent-claim-reference> wherein: 
<claim-text>said inverter includes first and second series-connected controllably conductive devices; and </claim-text>
<claim-text>said energy delivery control means includes one of said controllably conductive devices. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. The electronic ballast according to <dependent-claim-reference depends_on="CLM-00011">claim 12</dependent-claim-reference> wherein: 
<claim-text>said first controllably conductive device is connected between said filtered bus voltage and an inverter output; </claim-text>
<claim-text>said second controllably conductive device is connected between said inverter output and a circuit common; and </claim-text>
<claim-text>said energy delivery control means includes said second controllably conductive device. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. An electronic ballast for driving a gas discharge lamp, the ballast having improved input current THD comprising: 
<claim-text>a rectifier for rectifying an AC input voltage from an AC power supply to produce a rectified bus voltage; </claim-text>
<claim-text>a valley-fill circuit having an energy storage device connected to filter said rectified bus voltage; </claim-text>
<claim-text>an inverter including series connected first and second switching elements having duty cycles D and 1-D, respectively, where 0&lt;&equals;D&lt;&equals;1; and </claim-text>
<claim-text>means for varying said duty cycle D responsive to said bus voltage to cause said energy storage device to draw more current from said AC power supply around the peak of each half-cycle of said bus voltage and to cause said energy storage device to draw less current from said AC power supply around the trough of each half-cycle of said bus voltage. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. The electronic ballast according to <dependent-claim-reference depends_on="CLM-00011">claim 14</dependent-claim-reference> wherein said valley-fill circuit comprises a buck converter. </claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. An electronic ballast for driving a gas discharge lamp, the ballast including a valley-fill circuit including a bus capacitor, the ballast having integral over-voltage protection for the bus capacitor, the ballast comprising: 
<claim-text>a rectifier; </claim-text>
<claim-text>an inverter; and </claim-text>
<claim-text>said valley-fill circuit connected between said rectifier and said inverter, said valley-fill circuit including a buck converter connected between an output of said rectifier and an input of said inverter. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. An electronic ballast for driving a gas discharge lamp, the ballast including a rectifier for receiving a supply of sinusoidal alternating current power and producing a rectified direct current bus voltage, a valley-fill circuit for receiving the rectified direct current bus voltage and maintaining the bus voltage above a predetermined minimum voltage, an inverter for receiving the bus voltage and producing a high-frequency alternating current voltage for driving the gas discharge lamp, and a control circuit for producing control signals to control the operation of the inverter, the ballast comprising: 
<claim-text>a cat ear power supply for supplying power to the control circuit, said power supply adapted to draw power from the supply of sinusoidal alternating current power only during a predetermined portion of each half-cycle of the sinusoidal alternating current power. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00011">claim 17</dependent-claim-reference> wherein the valley-fill circuit and inverter draw power from the supply of sinusoidal alternating current power during a first predetermined portion of each said half-cycle and said cat ear power supply draws power from the supply of sinusoidal alternating current power only during a second, non-overlapping, predetermined portion of each said half-cycle. </claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference> wherein said cat ear power supply includes a fixed voltage cut-in circuit for causing said cat ear power supply to draw power from a first time when the voltage of the supply of sinusoidal alternating current power is decreasing through a first predetermined voltage level, to a second time when the voltage of the supply of sinusoidal alternating current power is substantially zero. </claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference> wherein said cat ear power supply includes a fixed voltage cut-out circuit for causing said cat ear power supply to draw power from a third time when the voltage of the supply of sinusoidal alternating current power is substantially zero, to a fourth time when the voltage of the supply of sinusoidal alternating current power is increasing through a second predetermined voltage level. </claim-text>
</claim>
<claim id="CLM-00021">
<claim-text><highlight><bold>21</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference> wherein said cat ear power supply includes a back-end monitoring circuit for monitoring back-end current, herein defined as the current drawn by the valley-fill circuit and the inverter, the back-end monitoring circuit for causing said cat ear power supply to draw power from the supply of sinusoidal alternating current power only during a time when the back-end current is substantially zero. </claim-text>
</claim>
<claim id="CLM-00022">
<claim-text><highlight><bold>22</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00011">claim 19</dependent-claim-reference> wherein said fixed voltage cut-in circuit includes voltage sensing means for sensing said first predetermined voltage, and enabling means responsive to said sensing means for enabling said cat ear power supply to draw power from said first time to said second time. </claim-text>
</claim>
<claim id="CLM-00023">
<claim-text><highlight><bold>23</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 20</dependent-claim-reference> wherein said fixed voltage cut-out circuit includes voltage sensing means for sensing said second predetermined voltage, and enabling means responsive to said sensing means for enabling said cat ear power supply to draw power from said third time to said fourth time. </claim-text>
</claim>
<claim id="CLM-00024">
<claim-text><highlight><bold>24</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 21</dependent-claim-reference> wherein said back-end monitoring circuit includes sensing means operatively connected to the valley-fill circuit and the inverter for sensing said back end current, and disabling means responsive to said sensing means for preventing said cat ear power supply from drawing power when said back-end current exceeds a predetermined level. </claim-text>
</claim>
<claim id="CLM-00025">
<claim-text><highlight><bold>25</bold></highlight>. An electronic ballast for driving a gas discharge lamp, the ballast comprising: 
<claim-text>a rectifier for receiving a supply of sinusoidal alternating current power and producing a rectified direct current bus voltage; </claim-text>
<claim-text>a valley-fill circuit for receiving the rectified direct current bus voltage and maintaining the bus voltage above a predetermined minimum voltage; </claim-text>
<claim-text>an inverter for receiving the bus voltage and producing a high-frequency alternating current voltage for driving the gas discharge lamp; and </claim-text>
<claim-text>a control circuit for producing control signals to control the operation of the inverter; </claim-text>
<claim-text>said valley-fill circuit including an energy storage element, an impedance, and a switch; </claim-text>
<claim-text>said energy storage element adapted to be connected between said bus voltage and a circuit common by means of said impedance when said switch is in a first predetermined conductive state so as to store energy. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00026">
<claim-text><highlight><bold>26</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 25</dependent-claim-reference> wherein said energy storage element comprises a capacitor. </claim-text>
</claim>
<claim id="CLM-00027">
<claim-text><highlight><bold>27</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 25</dependent-claim-reference> wherein said impedance comprises an inductor. </claim-text>
</claim>
<claim id="CLM-00028">
<claim-text><highlight><bold>28</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 25</dependent-claim-reference> wherein said impedance comprises a resistor. </claim-text>
</claim>
<claim id="CLM-00029">
<claim-text><highlight><bold>29</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 25</dependent-claim-reference> wherein said switch comprises a field-effect transistor. </claim-text>
</claim>
<claim id="CLM-00030">
<claim-text><highlight><bold>30</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 27</dependent-claim-reference> wherein said inductor comprises a tapped inductor including a tap, and said valley-fill circuit further includes a second switch connected between said tap and said bus voltage, whereby said inductor delivers stored energy to said energy storage device through said second switch when said first switch is in a second predetermined conductive state substantially opposite to said first predetermined conductive state. </claim-text>
</claim>
<claim id="CLM-00031">
<claim-text><highlight><bold>31</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00033">claim 30</dependent-claim-reference> wherein said second switch is a commutation diode. </claim-text>
</claim>
<claim id="CLM-00032">
<claim-text><highlight><bold>32</bold></highlight>. An electronic ballast for driving a gas discharge lamp, including: 
<claim-text>a rectifier for receiving a supply of sinusoidal alternating current power and producing a rectified direct current bus voltage; </claim-text>
<claim-text>a valley-fill circuit for receiving the rectified direct current bus voltage and maintaining the bus voltage above a predetermined minimum voltage; </claim-text>
<claim-text>an inverter for receiving the bus voltage and producing a high-frequency alternating current voltage for driving the gas discharge lamp; and </claim-text>
<claim-text>a control circuit for producing control signals to control the operation of the inverter; </claim-text>
<claim-text>the improvement comprising: 
<claim-text>a power supply operatively connected to draw power from said supply of sinusoidal alternating current power, said power supply further operatively connected to supply power to said control circuit, said power supply being the sole source of power for said control circuit. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00033">
<claim-text><highlight><bold>33</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00033">claim 32</dependent-claim-reference> wherein said power supply comprises means for drawing power from said supply of sinusoidal alternating current power during a predetermined portion of each half-cycle of said sinusoidal alternating current power. </claim-text>
</claim>
<claim id="CLM-00034">
<claim-text><highlight><bold>34</bold></highlight>. A method for causing an electronic ballast, of the type including a control circuit, to draw more nearly sinusoidal input current from a source of sinusoidal alternating current power, said method comprising the steps of: 
<claim-text>providing a power supply in said ballast for drawing current from said source of sinusoidal alternating current power during a predetermined portion of each half-cycle of said sinusoidal alternating current power; </claim-text>
<claim-text>causing said power supply to draw said current from said source of sinusoidal alternating current power during said predetermined portion of each half-cycle of said sinusoidal alternating current power; and </claim-text>
<claim-text>causing said power supply to supply power to said control circuit throughout each said half-cycle. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00035">
<claim-text><highlight><bold>35</bold></highlight>. In an electronic ballast, of the type including a valley-fill circuit having an energy storing device that stores energy in response to conduction of a first controllably conductive device, the valley-fill circuit coupled to a half-bridge inverter having second and third series-connected controllably conductive devices connected between a voltage bus and a circuit common, the ballast drawing its power from an AC power supply, a method for decreasing ballast input current total harmonic distortion and reducing lamp current crest factor comprising the steps of: 
<claim-text>switching the second and third series-connected controllably conductive devices so that they have complementary duty cycles; </claim-text>
<claim-text>within each half-cycle of the voltage supplied by the AC power supply, varying the duty cycles of the second and third series-connected controllably conductive devices so that the duty cycles are substantially unequal during the middle portion of each said half-cycle, and substantially equal during the beginning and ending portions of each said half-cycle; </claim-text>
<claim-text>within each said half-cycle, varying the conduction of the first controllably device in a predetermined manner so that the energy storing device draws more current from the AC supply during the middle portion of each said half-cycle, and less current from the AC supply during the beginning and ending portions of each said half-cycle. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00036">
<claim-text><highlight><bold>36</bold></highlight>. In an electronic ballast, of the type including a valley-fill circuit having an energy storing device that stores energy in response to conduction of a first controllably conductive device, the ballast drawing its power from an AC power supply, a method for decreasing ballast input current total harmonic distortion comprising the steps of: 
<claim-text>within each half-cycle of the AC power supply voltage, varying the conduction of the first controllably device in a predetermined manner so that the energy storing device draws more current from the AC supply during the middle portion of each said half-cycle, and less current from the AC supply during the beginning and ending portions of each said half-cycle.</claim-text>
</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>2</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030001516A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030001516A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030001516A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030001516A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030001516A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030001516A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030001516A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030001516A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030001516A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00009">
<image id="EMI-D00009" file="US20030001516A1-20030102-D00009.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00010">
<image id="EMI-D00010" file="US20030001516A1-20030102-D00010.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00011">
<image id="EMI-D00011" file="US20030001516A1-20030102-D00011.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00012">
<image id="EMI-D00012" file="US20030001516A1-20030102-D00012.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00013">
<image id="EMI-D00013" file="US20030001516A1-20030102-D00013.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00014">
<image id="EMI-D00014" file="US20030001516A1-20030102-D00014.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00015">
<image id="EMI-D00015" file="US20030001516A1-20030102-D00015.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00016">
<image id="EMI-D00016" file="US20030001516A1-20030102-D00016.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00017">
<image id="EMI-D00017" file="US20030001516A1-20030102-D00017.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00018">
<image id="EMI-D00018" file="US20030001516A1-20030102-D00018.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00019">
<image id="EMI-D00019" file="US20030001516A1-20030102-D00019.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00020">
<image id="EMI-D00020" file="US20030001516A1-20030102-D00020.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00021">
<image id="EMI-D00021" file="US20030001516A1-20030102-D00021.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00022">
<image id="EMI-D00022" file="US20030001516A1-20030102-D00022.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00023">
<image id="EMI-D00023" file="US20030001516A1-20030102-D00023.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00024">
<image id="EMI-D00024" file="US20030001516A1-20030102-D00024.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00025">
<image id="EMI-D00025" file="US20030001516A1-20030102-D00025.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00026">
<image id="EMI-D00026" file="US20030001516A1-20030102-D00026.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
