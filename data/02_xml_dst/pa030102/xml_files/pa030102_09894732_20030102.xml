<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030000535A1-20030102-D00000.TIF SYSTEM "US20030000535A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030000535A1-20030102-D00001.TIF SYSTEM "US20030000535A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030000535A1-20030102-D00002.TIF SYSTEM "US20030000535A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030000535A1-20030102-D00003.TIF SYSTEM "US20030000535A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030000535A1-20030102-D00004.TIF SYSTEM "US20030000535A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030000535A1-20030102-D00005.TIF SYSTEM "US20030000535A1-20030102-D00005.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030000535</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>09894732</doc-number>
</application-number>
<application-number-series-code>09</application-number-series-code>
<filing-date>20010627</filing-date>
</domestic-filing-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>A61B018/02</ipc>
</classification-ipc-primary>
<classification-ipc-secondary>
<ipc>A61B018/14</ipc>
</classification-ipc-secondary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>128</class>
<subclass>898000</subclass>
</uspc>
</classification-us-primary>
<classification-us-secondary>
<uspc>
<class>606</class>
<subclass>020000</subclass>
</uspc>
</classification-us-secondary>
<classification-us-secondary>
<uspc>
<class>606</class>
<subclass>034000</subclass>
</uspc>
</classification-us-secondary>
<classification-us-secondary>
<uspc>
<class>606</class>
<subclass>041000</subclass>
</uspc>
</classification-us-secondary>
</classification-us>
<title-of-invention>Method and apparatus for collecting and processing physical space data for use while performing image-guided surgery</title-of-invention>
</technical-information>
<inventors>
<first-named-inventor>
<name>
<given-name>Robert</given-name>
<middle-name>L.</middle-name>
<family-name>Galloway</family-name>
<name-suffix>JR.</name-suffix>
</name>
<residence>
<residence-us>
<city>Nashville</city>
<state>TN</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>William</given-name>
<middle-name>C.</middle-name>
<family-name>Chapman</family-name>
</name>
<residence>
<residence-us>
<city>Nashville</city>
<state>TN</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>James</given-name>
<middle-name>D.</middle-name>
<family-name>Stefansic</family-name>
</name>
<residence>
<residence-us>
<city>Nashville</city>
<state>TN</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Alan</given-name>
<middle-name>J.</middle-name>
<family-name>Herline</family-name>
</name>
<residence>
<residence-us>
<city>Nashville</city>
<state>TN</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Candice</given-name>
<middle-name>D.</middle-name>
<family-name>Pinson</family-name>
</name>
<residence>
<residence-us>
<city>Mountain View</city>
<state>CA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<assignee>
<organization-name>Vanderbilt University</organization-name>
<address>
<city>Nashville</city>
<state>TN</state>
</address>
<assignee-type>02</assignee-type>
</assignee>
<correspondence-address>
<name-1>AKIN, GUMP, STRAUSS, HAUER &amp; FELD, L.L.P.</name-1>
<name-2></name-2>
<address>
<address-1>ONE COMMERCE SQUARE, SUITE 2200</address-1>
<address-2>2005 MARKET STREET</address-2>
<city>PHILADELPHIA</city>
<state>PA</state>
<postalcode>19103</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">A method and apparatus for collecting and processing physical space data used while performing image-guided surgery is disclosed. Physical space data is collected by probing physical surface points of surgically exposed tissue. The physical space data provides three-dimensional (3-D) coordinates for each of the physical surface points. Based on the physical space data collected, point-based registrations used to indicate surgical position in both image space and physical space are determined. The registrations are used to map into image space, image data describing the physical space of an ablative instrument used to perform the image-guided surgery, an ablation zone of the instrument, the surgically exposed tissue, and a particular portion of the tissue to be resected or ablated. The image data is updated on a periodic basis. </paragraph>
</subdoc-abstract>
<subdoc-description>
<federal-research-statement>
<heading lvl="1">STATEMENT REGARDING FEDERALLY SPONSORED RESEARCH OR DEVELOPMENT </heading>
<paragraph-federal-research-statement id="P-0001"><number>&lsqb;0001&rsqb;</number> This work was supported in part by grants from the National Institutes of Health (NIH) and the National Science Foundation (NSF) (NIH grants NIGMS GM52798 and NRSA &num;1 F32 DK 09671-01 SB; and NSF grant BES-9703714) and the U.S. Government may therefore have certain rights in this invention.</paragraph-federal-research-statement>
</federal-research-statement>
<summary-of-invention>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> 1. Field of the Invention </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> The present invention relates to using image-guided surgery techniques to collect data to insure accurate tracking of an ablation device. </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> 2. Background Information </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> For over fifty years, diagnostic images have been used for surgical guidance, especially in the field of neurosurgery. Image-guided surgery implements two fundamental ideas: first, the concept of an image-space to physical-space mapping or registration, and second, the use of an extracranial device for accurate surgical guidance without direct visualization. Such ideas gave birth to stereotactic neurosurgery, a technique for locating targets of surgical interest within the brain relative to an external frame of reference. This is traditionally defined as the temporary attachment of a mechanical frame to the skull or scalp in order to define a 3-D frame space around a patient. With the advent of computed tomography (CT), the coordinates of a target (i.e. tumor) in image space could be assigned coordinates in frame space if the CT images were obtained with the attached frame. Unfortunately, frames are uncomfortable to patients, must be applied prior to imaging, and are cumbersome in the imaging environment and the operating room. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> These factors led to the development of frameless stereotactic surgical systems, or interactive, image-guided surgery (IIGS) systems. In traditional IIGS systems, present surgical position is tracked during an operation and displayed on pre-operatively obtained tomographic images. As the surgeon changes the current surgical position, displayed images are updated in real time. In one of the earliest IIGS systems, physical space surgical position was determined using articulated arms. The position of an articulated pointer was calculated using a personal computer (PC) and overlayed on tomographic images. Magnetic resonance images (MRI) and CT negative films were scanned into the computer and displayed as images on a video interface. Other early image-guided surgical systems also used electromechanical 3-D coordinate digitizers to indicate present surgical position on various representations of patient data, including 2-D transverse, coronal and sagittal CT or MRI slices, and on image renderings of the physical object surface. Since it was necessary to have computers capable of managing large volumes of image information (&gt;100 Mbytes) and updating the display quickly, most early IIGS systems were developed with VME bus devices running UNIX. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> Early IIGS systems were developed on PCs using multiple processors. In a task-oriented asymmetric multiprocessing (TOAM) system developed in 32 bit extended DOS, discrete tasks such as physical space localization, data fetching, and display were conducted asynchronously on specialized processors which communicated with inexpensive, general purpose processors that worked as loaders and schedulers. For physical space localization, several articulated arms with six degrees of freedom were first developed. These cumbersome arm devices were eventually replaced with lightweight cylindrical pen-like probes which could be tracked more easily in the operating room using an optical triangulation system. The spatial location of the guidance instrument was determined using a collection of discrete processors which continually update the physical space location. This location was then passed to the central processor where it was mapped into image space. Once the image space map was complete, the appropriate tomographic slices were selected and displayed. Because this system was designed before the advent of large memory availability, image display relied heavily on hardware manipulation using disk controllers to load images directly from the hard drive. Control of the bus was passed from the main processor to the disk drive controller, where the correct image was fetched and sent to the display processor. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> With the continuing increase in performance to price, processes which could only be performed on workstation class machines are now routinely performed on PCs. As the PC hardware evolved, however, it became apparent that DOS-based systems would not have the continuing support of hardware vendors. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> Because of these considerations, a need for an operating room image-oriented navigation system (ORION) emerged. ORION was developed in Windows NT using MS Visual C&plus;&plus; 6.0 with the Win32 API. Not only was this system designed to be faster than the previous one, but it was not necessary to redesign the software with each hardware advance. Components of the system were developed as dynamic link libraries (DLLs), so that new technology could be incorporated into the system without a complete software rewrite. The system is also somewhat portable. It runs adequately on any PC with a 200 MHz or higher Pentium processor and 128 MB of memory which also has the appropriate video card and 3-D localizer hardware and software. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> When designing an image-guided surgical system, it is critical that the precise location of an ablative instrument used to perform image-guided surgery be determined on a continuous basis (e.g., update rates approaching 30 frames per second). Further, in an effort to insure the utmost in precision, an ablation zone of the ablative instrument, the tissue being operated on, and a particular portion of the tissue to be resected or ablated during surgery must also be continuously and accurately tracked. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> What is needed is a method and apparatus for collecting and processing physical space data for use while performing image-guided surgery, such that tumors and lesions in the tissue of a living patient can be accurately located, and resected or ablated with a precisely tracked ablative instrument. The present invention fulfills such a need. </paragraph>
</section>
<section>
<heading lvl="1">BRIEF SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> In interactive, image-guided surgery, current physical space position in the operating room is displayed on various sets of medical images used for surgical navigation. The present invention is a PC-based surgical guidance system which synchronously displays surgical position on up to four image sets and updates them in real time. There are three essential components and techniques which have been developed for this system: 1) accurately tracked ablative instruments, 2) accurate registration techniques to map physical space to image space, and 3) methods and apparatus to display and update the image sets on a computer monitor. For each of these components, a set of dynamic link libraries has been developed in MS Visual C&plus;&plus; 6.0 supporting various hardware tools and software techniques. Surgical (i.e., ablative) instruments are tracked in physical space using an active optical tracking system. Several different registration algorithms were developed with a library of robust math kernel functions, and the accuracy of all registration techniques have been thoroughly investigated. The present invention was developed using the Win32 API for windows management and tomographic visualization, a frame grabber for live video capture, and OpenGL for visualization of surface renderings. This current implementation of the present invention can be used for several surgical procedures, including open and minimally invasive liver surgery. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> In a method according to the present invention, physical space data is collected and processed for use while performing image-guided surgery. Tissue of a living patient is surgically exposed. Physical space data is then collected by probing a plurality of physical surface points of the exposed tissue, the physical space data providing three-dimensional (3-D) coordinates for each of the physical surface points. Based on the physical space data collected, point-based registrations used to indicate surgical position in both image space and physical space are determined. The registrations are used to map into image space, image data describing the physical space of an ablative instrument used to perform the image-guided surgery, an ablation zone of the instrument, the tissue, and a particular portion of the tissue to be resected or ablated. The image data is updated on a periodic basis. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> The collection of physical space data may be performed by sweeping an optically tracked localization probe over the surface of the exposed tissue. The tissue may be the patient&apos;s liver and the particular portion of tissue to be resected or ablated may be a hepatic metastatic tumor. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> Prior to surgery, tissue of the patient may be scanned to acquire, store and process a 3-D description of the organ or structure of interest (e.g., a 3-D reference). A triangularized mesh may be created based on the scanned tissue. The volumetric center of a particular portion of the tissue to be resected or ablated during the surgery may be determined, wherein an algorithm using the triangularized mesh and the collected physical space data may be implemented to determine the point-based registrations. The algorithm may be a Besl and Mackay iterative closest point (ICP) registration algorithm. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> The scanning of the tissue may be performed by one of a computerized tomography (CT) scanner, a magnetic resonance imaging (MRI) scanner and a positron emission tomography (PET) scanner. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> The ablative instrument may emit a plurality of intermittent infrared signals used to triangulate the position of the ablative instrument in 3-D image space. The signals may be emitted from a plurality of infrared emitting diodes (IREDs) distributed over the surface of a handle of the ablative instrument in a spiraling fashion. The IREDs may flash in time sequence. Each IRED may have a 60 degree transmission angle. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> The image data may be updated in real time at 30 Hz or greater. The ablative instrument may use one of radio-frequency and cryoablation to resect or ablate the particular portion of the tissue. The ablative instrument may have a tip comprising an ablation device. The ablation zone may extend 1 centimeter from the tip of the ablative instrument. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> Information from the localizer may also be used in conjunction with laparoscopic or endoscopic imaging. Points from 3-D physical space may be mapped to 2-dimensional (2-D) image space. Points from 3-D physical space may be mapped to 2-dimensional (2-D) laparoscopic video space using a direct linear transformation (DLT). Points from 3-D physical space may be mapped to 3-D tomographic image space. Points from 3-D physical space may be mapped to 2-dimensional (2-D) endoscopic image space. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> In an apparatus according to the present invention, physical space data is collected and processed for use while performing image-guided surgery. The apparatus comprises a probe instrument, an ablative instrument and an image data processor. The probe instrument collects physical space data by probing a plurality of physical surface points of surgically exposed tissue of a living patient. The physical space data provides three-dimensional (3-D) coordinates for each of the physical surface points. The ablative instrument may resect or ablate a particular portion of the exposed tissue. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> The image data processor comprises a computer-readable medium holding computer-executable instructions which, based on the physical space data collected by the probe instrument, determine point-based registrations used to indicate surgical position in both image space and physical space. Using the point-based registrations to map into image space, image data describing the physical space of an ablative instrument used to perform the image-guided surgery, an ablation zone of the ablative instrument, the tissue, and a particular portion of the tissue to be resected or ablated. The image data is updated on a periodic basis. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> The probe instrument may be swept over the surface of the exposed tissue. The apparatus may also comprise a scanning device for scanning tissue of the patient to acquire, store and process a 3-D reference of tissue prior to the tissue being surgically exposed. The image data processor creates a triangularized mesh based on the scanned tissue, determines the volumetric center of a particular portion of the tissue to be resected or ablated during the surgery, and implements an algorithm using the triangularized mesh and the physical space data collected by the probe instrument to determine the point-based registrations. The algorithm is a Besl and Mackay iterative closest point (ICP) registration algorithm. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> The scanning device may be one of the following scanners: a computerized tomography (CT) scanner, a magnetic resonance imaging (MRI) scanner and a positron emission tomography (PET) scanner. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> The ablative instrument may emit a plurality of intermittent infrared signals used to triangulate the position of the ablative instrument in 3-D image space, the signals being emitted from a plurality of infrared emitting diodes (IREDs) distributed over the surface of a handle of the ablative instrument in a spiraling fashion. The IREDs may flash in time sequence. Each IRED may have a 60 degree transmission angle. The image data may be updated in real time at 30 Hz or greater. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> The ablative instrument may use one of radio-frequency and cryoablation to resect or ablate the particular portion of the tissue. The ablative instrument may have a tip comprising an ablation device. The ablation zone may extend 1 centimeter from the tip of the ablative instrument. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> Points from 3-D physical space may be mapped to 2-dimensional (2-D) image space. Points from 3-D physical space may be mapped to 2-dimensional (2-D) laparoscopic video space using a direct linear transformation (DLT). Points from 3-D physical space may be mapped to 3-D tomographic image space. Points from 3-D physical space may be mapped to 2-dimensional (2-D) endoscopic image space. </paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE SEVERAL VIEWS OF THE DRAWINGS </heading>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> The following detailed description of preferred embodiments of the present invention would be better understood when read in conjunction with the appended drawings. For the purpose of illustrating the present invention, there are shown in the drawings embodiments which are presently preferred. However, the present invention is not limited to the precise arrangements and instrumentalities shown. In the drawings: </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> shows a general flow chart in accordance with the present invention. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> shows a detailed flow chart illustrating how collected and processed physical space data is used to perform image-guided surgery in accordance with the present invention. </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> shows the hardware system configuration of the present invention. </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> shows the basic software architecture of the present invention, including the three divisions of run-time dynamic link libraries. </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5 a</cross-reference> flow chart for software used by the present invention.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF THE INVENTION </heading>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> shows some of the major events involved in preparing for and performing IIGS. In step <highlight><bold>105</bold></highlight>, it is determined if any extrinsic markers will be attached to the patient. These makers, or fiducials, are designed to be imaged and then localized in both image space and physical space for use in a point-based registration algorithm. Appropriate image volumes for a patient are then acquired, stored and processed (step <highlight><bold>110</bold></highlight>). Most image volumes are acquired as a set of slices, 256&times;256 or 512&times;512 pixels per slice at 2 bytes per pixel with 20-200 images per volume. These images are acquired on a computerized tomography (CT) scanner, a magnetic resonance imaging (MRI) scanner or a positron emission tomography (PET) scanner. Images are typically transferred from PACS servers in radiology to image-guided surgical computers, where they are processed for display before surgery if necessary. Transverse, sagittal, or coronal tomographic slices require minor processing before display. In order to visualize surface renderings, a triangulated surface can be created from the volume and displayed. These triangulated surfaces can also be used in registration algorithms to map a physical surface to an image surface. </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> Once the surgeon has prepared and positioned the patient for surgery, it is necessary to register or map patient or physical space to image space before images can be used interactively (step <highlight><bold>115</bold></highlight>). Physical space data is collected using an instrument whose position is tracked in the operating room. For point-based registrations, corresponding points that can be localized accurately in both image space and physical space are used to create the mapping. These can include extrinsic fiducials that were attached to the patient before imaging or intrinsic fiducials which include anatomic landmarks visible in both physical and image space. For surface-based registrations, a surface of physical space points is collected and mapped onto a triangulated surface. After the accuracy of the registration is assessed, the tracked instrument is moved in physical space and the corresponding position in image space is displayed (steps <highlight><bold>120</bold></highlight>, <highlight><bold>125</bold></highlight> and <highlight><bold>130</bold></highlight>) and used as a guide during the surgical procedure. </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> In order to carry out the tasks of determining the location of a tracked probe in space, registering that position into image space, and displaying the appropriate image or images on a computer screen, three divisions of run-time dynamic link libraries (DLLs) were initially developed for our system. The first is a localizer division, which is responsible for determining current surgical position based on the location of an instrument in space. The second is a registration division, which calculates accurate mappings between image space and physical space. The third is a display division, which displays various types of medical images on the computer screen. By separating the system into several DLL divisions, the present invention allows for modularity. Depending on a particular surgical case, for instance, a surgeon may choose one type of localizer, one or more types of displays, and one or more types of registration to indicate surgical position on the images. </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> Because an image-guided surgical system is, by definition, used in surgery by surgeons and surgical staff, the present invention has an intuitive interface and display to minimize the potential for distraction. Using a simple pushbutton interface, a patient is selected from the database, physical space data is collected, and a registration between physical space and image space is calculated. Images are then selected and displayed in one of four quadrants on the screen and updated as surgical position changes. </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> A surgeon can use the present invention for guidance in extremely delicate procedures, such as removing a tumor from a sensitive region of the brain or resect multiple lesions in regions of the liver near major blood vessels. It is important that current surgical position displayed on medical images be as close to actual surgical position as possible. It is also imperative that the images are updated quickly, since a surgeon may change his or her current location rapidly in order to gather spatial information about a certain structure and its surroundings. Accordingly, there are two performance goals in the development of the present invention: accuracy and speed. It is necessary to develop accurate, automatic registration algorithms to map physical space to image space. These algorithms should also be computationally efficient since time constraints are always a concern in surgical applications. It is also important to develop accurately tracked instruments to indicate current surgical position in physical space. Once the registration is calculated and instrument location is mapped into image space, it is necessary to update the images as fast as possible, since surgeons are sensitive to display speed. One of the worst possible scenarios would be for the surgeon to move the probe and make a decision based on the current display, only to find that the display indicated a previous position. A true image-guided surgical system should update images in real time at 30 Hz as surgical position changes. </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> The present invention collects and processes physical space data for use while performing image-guided surgery, as illustrated in the flow chart of <cross-reference target="DRAWINGS">FIG. 2</cross-reference>. Prior to surgery, tissue of the patient is scanned to acquire, store and process a 3-D reference (step <highlight><bold>205</bold></highlight>). A triangularized mesh is then created based on the scanned tissue (step <highlight><bold>210</bold></highlight>). The volumetric center of a particular portion of the tissue to be resected or ablated during the surgery is determined, wherein an algorithm using the triangularized mesh and the collected physical space data may be implemented to determine the point-based registrations (step <highlight><bold>215</bold></highlight>). The algorithm may be a Besl and Mackay iterative closest point (ICP) registration algorithm. </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> Tissue of a living patient is then surgically exposed (step <highlight><bold>220</bold></highlight>). Physical space data is then collected by probing a plurality of physical surface points of the exposed tissue, the physical space data providing three-dimensional (3-D) coordinates for each of the physical surface points (step <highlight><bold>225</bold></highlight>). Based on the physical space data collected, point-based registrations used to indicate surgical position in both image space and physical space are determined (step <highlight><bold>230</bold></highlight>). The registrations are used to map into image space, image data describing the physical space of an ablative instrument used to perform the image-guided surgery, an ablation zone of the instrument, the tissue, and a particular portion of the tissue to be resected or ablated (step <highlight><bold>235</bold></highlight>). The image data is updated on a periodic basis (step <highlight><bold>240</bold></highlight>). </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> shows the hardware system configuration <highlight><bold>300</bold></highlight> of the present invention. ORION was developed in Windows NT and is currently running on a 400 MHz processor Micron PC (an image data processor) <highlight><bold>305</bold></highlight> with 256 MB of memory and a display monitor <highlight><bold>310</bold></highlight>. The display mode is 1280&times;1024 mode. This computer also contains two specialized cards. The VigraVision-PCI card (VisiCom Inc., Burlington, Vt.) is a combination color frame grabber and accelerated SVGA display controller which is capable of displaying NTSC video images in real time. An ISA high-speed serial port card communicates with the optical localization probe <highlight><bold>320</bold></highlight> via control box <highlight><bold>315</bold></highlight>. Additional hardware for implementing the present invention include an optical tracking sensor <highlight><bold>325</bold></highlight>, optical localization probe(s) <highlight><bold>320</bold></highlight>, and an optical reference emitter <highlight><bold>330</bold></highlight>. </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> Other paradigms for indicating surgical position could be used, including articulated arms. One preferred localization tool for use with the present invention is the Optotrak 3020 (Northern Digital Inc., Waterloo, Ontario). The optical tracking sensor <highlight><bold>325</bold></highlight> contains three cylindrical lenses which receive light from sequentially strobed infrared light-emitting diodes (IREDs). Triangulation is used to find each IRED relative to the position of the optical tracking sensor <highlight><bold>325</bold></highlight>. </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> In order for the position and orientation of ablative instrument <highlight><bold>320</bold></highlight> to be measured by the optical tracking sensor <highlight><bold>325</bold></highlight>, the ablative instrument must have a handle (rigid body) with multiple IREDs distributed over the surface of a handle of the ablative instrument <highlight><bold>320</bold></highlight> so that at least three IREDs are visible in all of the appropriate orientations of the ablative instrument <highlight><bold>320</bold></highlight>. If three or more IREDs attached to the handle of the ablative instrument <highlight><bold>320</bold></highlight> are detected by the lenses of the optical tracking sensor <highlight><bold>325</bold></highlight>, the tip and ablation zone of the ablative instrument <highlight><bold>320</bold></highlight> can be accurately localized in physical space without placing constraints on how the ablative instrument <highlight><bold>320</bold></highlight> needs to be handled by the surgeon. </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> The typical ablative instrument <highlight><bold>320</bold></highlight> used in neurosurgical applications has 24 IREDs which spiral around the instrument&apos;s handle. It is appropriate for use as a surgical pointer because it is light, easily directed and is extremely accurate with a tip location error of 0.35 mm in 3-D space. For endoscopic applications, a special rigid body was created for ablative instrument <highlight><bold>320</bold></highlight> which is more sensitive to roll for more complex manipulations. This 24 IRED &ldquo;ovoid structure&rdquo; attached to the endoscope weighs less than 200 g (adding less than 10% to the weight of a typical endoscope). The tip of the endoscope may be tracked with an accuracy of approximately 1.2 mm. An optically tracked radiofrequency probe is placed within the center of tumors, where it is used to microwave or heat-kill lesions. The present invention is able to track the tip of this device with an accuracy of 3.0 mm. </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> For surgical applications using the present invention, an ablative instrument <highlight><bold>320</bold></highlight> is used which not only defines a coordinate system in physical space but also preserves the registration if the patient is moved. The optical tracking sensor <highlight><bold>325</bold></highlight> can localize both the ablative instrument <highlight><bold>320</bold></highlight> and the reference emitter <highlight><bold>330</bold></highlight> in sensor unit space. By mapping the position of the ablative instrument <highlight><bold>320</bold></highlight> into the space defined by the position and orientation of the reference emitter <highlight><bold>330</bold></highlight>, the location of the optical tracking sensor <highlight><bold>325</bold></highlight> drops out of the equations. The optical tracking sensor <highlight><bold>325</bold></highlight> can be flexibly placed before surgery and moved during the procedure to accommodate any surgical requirements. </paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> All of the image-guided surgical software in accordance with the present invention was written using Visual C&plus;&plus; 6.0 in Windows NT 4.0. Because the Win32 API offers the greatest versatility in exploiting the features of Windows, this interface was chosen to create and manage the windows created in the system. </paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> The present invention incorporates an executable program of a software system which contains the main entry point to the Windows program. Windows NT passes all user input to programs in the form of messages. Thus, the present invention implements a message pump that receives and dispatches these messages to the appropriate message handler(s). At startup, the present invention is responsible for initializing the image-guided surgery system. This task involves creating and managing the four 512&times;512 child windows used for image display, saving log information with the time and date the system is run, and loading the dynamic link libraries (DLLs). After initialization, the message pump in the present invention is responsible for receiving and dispatching any messages in the queue. If no messages are present, it sends information concerning the current position of the localized instrument(s) to the child windows. </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> shows the basic software architecture of the present invention, including the three divisions of run-time dynamic link libraries. For each of the three divisions, a core set of functions and structures define an interface to the DLLs. The interface represents the functionality that is required to interoperate with the present invention. Any additional functionality present within the DLL is expected to be specific to that individual DLL and not visible to the present invention. There are two functions that are common to all of the DLL interfaces, one which can be called by the present invention to receive a message related to the most recent error that occurred within the library, and another which is called to receive the identification tag for a particular type of DLL. A brief description of DLL division structure is included in the sections below, along with details about the development of particular types within a division. </paragraph>
<paragraph id="P-0048" lvl="0"><number>&lsqb;0048&rsqb;</number> The localizer division <highlight><bold>405</bold></highlight> consists of all the DLLs developed to track the position of instruments in physical space. The DLL interface for this division defines a common communication mechanism to various hardware devices which typically rely on vendor-supplied custom APIs for device communication. The task of implementing a localizer DLL is therefore largely a matter of grouping the API functions of the vendor into the required localizer interface functions, and ensuring correct data type conversion and error handling. A single localizer DLL is selected at startup, and all communications are performed through the interface. </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> Currently, localizer DLL <highlight><bold>405</bold></highlight> is written for the Optotrak 3020 system described previously using the Northern Digital software libraries. Several instruments can be tracked in space at once, if necessary. A function in the DLL returns 4&times;4 matrices that indicate the position and orientation of the optically tracked instrument(s). If either the tracked instrument(s) or the reference rigid body are blocked from the camera view or are unable to be localized with a certain accuracy, an error message is generated and the user is notified. Individual points can be collected with the Optotrak and stored in a file for use in registration algorithms or other analysis, and an entire set of data points can be collected as well. DLLs may be used for other optical tracking devices, such as the Polaris system from Northern Digital, or other non-optical systems, such as articulated arms. </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> The registration division <highlight><bold>410</bold></highlight> consists of all DLLs developed to perform registrations between image space and physical space. A generalized user interface (not shown) is used to select physical and image data models to be passed to the appropriate registration DLL. Within the individual DLLs, specific registration algorithms are used to calculate a mapping between the data sets. The interface of the present invention also allows multiple registrations for a given data set, if desired. </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> Two point-based registration DLLs map 3-D physical space into 3-D image space using rigid body transformations. One DLL finds a closed-form solution based on unit quaternions to create this transformation matrix. The other DLL uses singular value decomposition (SVD) to find the closed-form solution. In order to determine the transformation matrix, both algorithms require the localization of three or more corresponding non-colinear fiducial points in both 3-D spaces. The SVD algorithm is implemented using the Intel Math Kernel Library, which contains a set of robust math kernel functions that are performance optimized for Pentium processors. Another DLL implements a projective registration algorithm based on the direct linear transformation (DLT). If 6 or more non-coplanar fiducials are accurately localized in the two spaces, a projective registration between 3-D physical space and 2-D endoscopic video space can be created. The Intel library is used to calculate the SVD utilized in the DLT registration. A surface-based registration DLL based on the iterative closest-point algorithm of Besl and McKay is performed using the present invention. </paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> One performance goal of the present invention is to develop accurate registration algorithms. For the rigid body point-based registrations, two measures of error are defined. The residual error determined in mapping the fiducial points from one 3-D space to the other is called fiducial registration error (FRE). If a mapped point not used in the creation of the transformation matrix is compared to its actual position, the difference is referred to as target registration error (TRE). For 600 neurosurgical applications conducted using externally attached fiducial markers for registration purposes, the mean TRE in mapping from physical space to CT image space was 0.67&plusmn;0.25 mm, with a worse case of 1.15 mm. The accuracy of the DLT registration algorithm used to project 3-D physical space into endoscopic video space has been investigated, and it has been found that registration accuracy improves as more fiducials are used to calculate the transformation matrix. When 11 fiducials are utilized in the computation of the DLT, average TRE is 0.70 mm. Considerable work has been performed in quantifying the accuracy of many other types of registrations as well. All of the registration DLLs developed will return an appropriate quality of fit measure which helps indicate the accuracy of the registration technique(s) utilized in the surgical procedure. If the registration is point-based, a TRE/FRE metric is used for assessing registration quality. If the registration is surface-based, a new metric has been developed which includes holding out certain subsurfaces from inclusion in the registration process. These surfaces are then used as an independent check of registration quality, along with visual assessment. </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> The display division <highlight><bold>415</bold></highlight> consists of all the DLLs necessary to display any type of medical image. Two display DLLs have been developed, one type for the display of any tomographic image (MR, CT, PET), and another type for the display of any NTSC video image. </paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> For each child window displaying a tomographic view, a device independent bitmap (DIB) is created. Images are displayed through a bit-block transfer of 8 bit data corresponding to a rectangle of pixels from the specified source device context into a destination device context (i.e., one of the four child windows). </paragraph>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> Since most medical images are represented using 4096 individual gray levels (12 bits) and standard video hardware can only display 256 different gray levels (8 bits), some form of compression must be implemented. The compression used by the present invention is piecewise linear and is defined by the window and level parameters. The level parameter determines the uncompressed intensity that is mapped to the middle gray level. The window parameter describes the range of uncompressed intensities surrounding the level value that are mapped to shades of gray. Anything below this window is mapped to black (zero intensity) and anything above the window is mapped as white (full intensity). Tomographic images utilized during surgery are loaded into memory and saved in one of two formats depending on the desired method of display. In one format, the 12 bit/pixel grayscale images are temporarily loaded into memory and compressed to 8 bits/pixel based on the default window and level. The 12 bit images are deleted and the 8 bit images are stored in memory. When the position of the tracked instrument is moved, the appropriate 8 bit image is displayed using a bit-block transfer. Images displayed using this method are updated at greater than 30 Hz when all four windows are displaying tomograms. If the window and level of an image is changed, the entire corresponding volume must be reloaded and each image in the volume is compressed to 8 bits using the new values. The time required to compress the images with the updated window and level varies with the size and quantity of the images. Since a surgeon may want to change the window and level of an image set multiple times during a procedure in order to view different structures more clearly, a second alternative display method may be implemented. </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> In the alternative display method, the 12 bit volume is loaded just once. Once an appropriate image is selected for viewing, its 12 bit data is compressed to 8 bits based on the given window and level and the resulting DIEB is displayed. This &ldquo;compress on the fly&rdquo; method allows images to be windowed and leveled without reloading the entire corresponding volume. On our 400 MHz PC, images displayed using this method are updated at 15-20 Hz when all four windows are displaying tomograms. Either method can currently be used for display during surgery. As faster processors are developed, the &ldquo;compress on the fly&rdquo; method will update tomograms at an acceptable speed (&gt;30 Hz) to meet performance goals of the present invention and the first method will be eliminated. </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> Cropped NTSC video images (512&times;480) are captured with the VigraVision-PCI color frame grabber. This can be used to display an endoscopic or intraoperative ultrasound (10US) view. One video image can be updated at 30 Hz in any of the four quadrants. A still video image can be captured and stored in one of several formats, such as a TIFF or a bitmap. When the image is frozen, the position and orientation of the tracked endoscope or 10US can be saved, and points on the image can be localized and used for projective registration purposes. </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> Several new display DLLs have been developed for surgical applications. In a graphics DLL, an OpenGL, a 3-D graphics library, is used to render object surfaces created from triangulated tomographic volumes. Tumors or other structures segmented from these volumes can be also rendered and projected onto the object surface to aid in localization. For surgical applications, the rendering view is updated &ldquo;on the fly&rdquo; as surgical position is changed. In the rotation DLL, renderings and vascular projection images are created pre-operatively and the desired angular projection is displayed. The position of the probe and trajectory information is projected onto the view according to the reconstruction angle. </paragraph>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> shows a software cycle for image-guided surgery in accordance with the present invention. After execution in Windows NT, the system is initialized and all appropriate DLLs are loaded. A patient information file is then selected from a database. This file contains a list of files indicating image sets that are available for the particular surgical case. Each image set has an associated information file which is included in the patient file. This image information file contains a path to the actual image data, a tag to identify the appropriate DLL for its display, various parameters needed to visualize the data, and all registration types and corresponding image data needed for mapping physical space to image space. Once the image sets are loaded and their child window location is determined, it is usually appropriate to collect some type of physical space data using the localizer DLL. This data may be surface points or fiducial points which can be used in the surface-based or point-based registration algorithms described previously. Physical space and image space data is passed to the appropriate registration DLL and a mapping in the form of a matrix is returned to the present invention. Following registration between physical space and image space, the image sets or other display type is then visualized in some or all of the four child windows. The present invention then enters its message loop and maintains a message queue. The program is now ready to receive any keyboard or mouse input from the user. If there is a message in the queue, the present invention responds to the message and checks for other messages. There is &ldquo;dead time&rdquo; in the present invention when the program is idle waiting for messages (e.g., keyboard and mouse inputs). If no messages exist in the queue, the present invention receives matrix information from the localizer DLL concerning the current position of the probe(s) in physical space and passes this and any registration matrices to the appropriate display DLLs. The display DLLs map this physical space position into image space using the appropriate registration result and display the updated images, along with a colored circle to indicate current surgical position. </paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> There are several pushbuttons and mouse commands in the present invention that produce messages. For example, if the user presses the right mouse key in a tomogram display window, the window and level of the image volume can be adjusted. The surgeon can also perform another type of registration, collect some type of physical space data with the tracked instrument, or change the display by pressing one of several pushbuttons on the main window. Each of these tasks are kept behind the simple pushbutton so that during surgery the physician can concentrate on the images displayed. As in the first example, the present invention receives a mouse click over a pushbutton as a message and responds to this request before updating the probe position and the images. </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> Interactive, image-guided surgery is being utilized in more and more applications, including neurosurgery, spinal surgery, and endonasal surgery. The present invention can be used for general surgical applications, including hepatic surgery. </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> Surgical treatment of hepatic tumors is performed by removal or ablation of involved segments of the liver. These tumors are localized by preoperative imaging studies, primarily CT imaging, intra-operative ultrasound and palpation. Of these localization techniques only the preoperative tomograms provide high-resolution, 3-D views of the tumor and the surrounding anatomy. However, at present, the tomographic information cannot be actively utilized for surgical guidance in the operating room. Thus, surgeons use other methods for operative tumor localization. It is especially important to accurately localize the tumor during liver ablation procedures, where precise probe placement within the volumetric center of a tumor is critical in the radiofrequency (heat-kill) or cryoablation (freeze-thaw) of the lesion. It is believed that the development of the present invention for hepatic surgery will improve both open and minimally invasive resection and ablation procedures in the liver. Minimally invasive hepatic surgery is currently conducted on a very limited basis. An endoscopic-IIGS system would combine the strengths of real time video imaging and the tomographic guidance from IIGS and make these procedures feasible. Deep-seated tumors which are indicated on CT images will be mapped onto video images of the liver surface using the direct linear transformation (DLT) and then displayed to allow the surgeon more accuracy in performing resections or ablative procedures under endoscopic guidance. </paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> The present invention has been used in the laboratory on phantom livers. These model livers were constructed with rubber silicone, which was poured into a plaster mold along with spherical &ldquo;tumors&rdquo; constructed from cork. CT images of the phantom were acquired and a surface was created for registration purposes. The surface of the liver is digitized using the tracked probe and the present invention. The registration of the digitized liver surface to the surface of the liver created from the CT scan was calculated using an implementation of the iterative closest point registration algorithm. Experiments using the phantom liver and the described registration technique produced an average registration error of 1.8 mm. This surface registration calculation and the tracked RF probe have been used to localize the centers of &ldquo;tumors&rdquo; within the phantom on the CT images, and it was possible to place the tip of the instrument to within 1.2-6.0 mm of tumor centroids. Errors in this range can be achieved using the surface of the liver intraoperatively. </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> Experiments have been also conducted to develop a surgical protocol for using the present invention for open hepatic resection in patients with liver tumors, and tracked points on the liver to determine respiratory associated hepatic movement. An ablative instrument was placed on three anatomical points on the liver. Approximately 950 localization points (x,y,z) were continuously collected using the present invention. Each patient (n&equals;2) had &gt;2800 localization points collected during continuous respiratory cycles with standard continuous mandatory ventilator cycling. The change in position of the tracked points with respiration was calculated relative to the resting base position of the liver. Average motion with respiration for all anatomical points was 10.3&plusmn;2.5 mm. </paragraph>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> Interactive, image-guided surgery has improved the quality and feasibility of many surgical procedures, including neurosurgery and ENT surgery. It is crucial that these systems provide measures of system performance in a manner which parallels the surgical process. The systems must provide fast and accurate registration processes to map physical space into image space, and must also include instruments which precisely indicate current surgical position. In addition, images must be displayed and updated in real time to allow ease in tracking structures across slices or surface renderings. </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> A Windows-based image-guided surgical system has been developed on a low cost personal computer with an active optical tracking system. The present invention was developed in Visual C&plus;&plus; with the Win32 API for windows management. Since the present invention was developed using a module library for each of the different components, code migration and maintenance is simplified. At any given time, a subtask contained within a particular DLL used in the system can be &ldquo;checked out&rdquo; of a Visual C&plus;&plus; SourceSafe database that stores the most recently edited master copy. </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> The present invention is capable of applications beyond neurosurgery, including open and minimally invasive hepatic procedures. Target errors on the order of 2 mm for the phantom registration studies were higher than those seen in clinical neurosurgical cases. This number is acceptable since the liver is much more homogeneous than the brain and higher accuracy is not as critical an issue. </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> The present invention may be implemented with any combination of hardware and software. If implemented as a computer-implemented apparatus, the present invention is implemented using means for performing all of the steps and functions described above. </paragraph>
<paragraph id="P-0069" lvl="0"><number>&lsqb;0069&rsqb;</number> The present invention can be included in an article of manufacture (e.g., one or more computer program products) having, for instance, computer useable media. The media has embodied therein, for instance, computer readable program code means for providing and facilitating the mechanisms of the present invention. The article of manufacture can be included as part of a computer system or sold separately. </paragraph>
<paragraph id="P-0070" lvl="0"><number>&lsqb;0070&rsqb;</number> It will be appreciated by those skilled in the art that changes could be made to the embodiments described above without departing from the broad inventive concept thereof. It is understood, therefore, that this invention is not limited to the particular embodiments disclosed, but it is intended to cover modifications within the spirit and scope of the present invention as defined by the appended claims. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is claimed is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. A method of collecting and processing physical space data for use while performing image-guided surgery, the method comprising: 
<claim-text>(a) surgically exposing tissue of a living patient; </claim-text>
<claim-text>(b) collecting physical space data by probing a plurality of physical surface points of the exposed tissue, the physical space data providing three-dimensional (3-D) coordinates for each of the physical surface points; </claim-text>
<claim-text>(c) based on the physical space data collected in step (b), determining point-based registrations used to indicate surgical position in both image space and physical space; </claim-text>
<claim-text>(d) using the registrations determined in step (c) to map into image space, image data describing the physical space of an ablative instrument used to perform the image-guided surgery, an ablation zone of the instrument, the tissue, and a particular portion of the tissue to be resected or ablated; and </claim-text>
<claim-text>(e) updating the image data on a periodic basis. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the ablative instrument emits a plurality of intermittent infrared signals used to triangulate the position of the ablative instrument in 3-D image space, the signals being emitted from a plurality of infrared emitting diodes (IREDs) distributed over the surface of a handle of the ablative instrument in a spiraling fashion. </claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00002">claim 2</dependent-claim-reference>, wherein the IREDs flash in time sequence. </claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein each IRED has a 60 degree transmission angle. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, further comprising: 
<claim-text>(f) prior to surgery, scanning tissue of the patient to acquire, store and process a 3-D reference; </claim-text>
<claim-text>(g) creating a triangularized mesh based on the scanned tissue; and </claim-text>
<claim-text>(h) determining the volumetric center of a particular portion of the tissue to be resected or ablated during the surgery, wherein an algorithm using the triangularized mesh and the physical space data collected in step (b) is implemented to determine the registrations in step (c). </claim-text>
</claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00005">claim 5</dependent-claim-reference>, wherein the algorithm is a Besl and Mackay iterative closest point (ICP) registration algorithm. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00005">claim 5</dependent-claim-reference>, wherein step (f) is performed by one of a computerized tomography (CT) scanner, a magnetic resonance imaging (MRI) scanner and a positron emission tomography (PET) scanner. </claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the ablative instrument has a tip comprising an ablation device. </claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00008">claim 8</dependent-claim-reference>, wherein the ablation zone extends <highlight><bold>1</bold></highlight> centimeter from the tip of the ablative instrument. </claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein step (b) comprises sweeping an optically tracked localization probe over the surface of the exposed tissue. </claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the tissue is the patient&apos;s liver and the particular portion of tissue to be resected or ablated is a hepatic metastatic tumor. </claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the image data is updated in real time at <highlight><bold>30</bold></highlight> Hz or greater. </claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the ablative instrument uses one of radio-frequency and cryoablation to resect or ablate the particular portion of the tissue. </claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein points from 3-D physical space are mapped to 2-dimensional (2-D) image space. </claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein points from 3-D physical space are mapped to 2-dimensional (2-D) laparoscopic video space using a direct linear transformation (DLT). </claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein points from 3-D physical space are mapped to 3-D tomographic image space. </claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein points from 3-D physical space are mapped to 2-dimensional (2-D) endoscopic image space. </claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. Apparatus for collecting and processing physical space data for use while performing image-guided surgery, the apparatus comprising: 
<claim-text>(a) a probe instrument for collecting physical space data by probing a plurality of physical surface points of surgically exposed tissue of a living patient, the physical space data providing three-dimensional (3-D) coordinates for each of the physical surface points; </claim-text>
<claim-text>(b) an ablative instrument for resecting or ablating a particular portion of the exposed tissue; and </claim-text>
<claim-text>(c) an image data processor comprising a computer-readable medium holding computer-executable instructions for: 
<claim-text>(i) based on the physical space data collected by the probe instrument, determining point-based registrations used to indicate surgical position in both image space and physical space; </claim-text>
<claim-text>(ii) using the point-based registrations to map into image space, image data describing the physical space of an ablative instrument used to perform the image-guided surgery, an ablation zone of the ablative instrument, the tissue, and a particular portion of the tissue to be resected or ablated; and </claim-text>
<claim-text>(iii) updating the image data on a periodic basis. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference>, wherein the ablative instrument emits a plurality of intermittent infrared signals used to triangulate the position of the ablative instrument in 3-D image space, the signals being emitted from a plurality of infrared emitting diodes (IREDs) distributed over the surface of a handle of the ablative instrument in a spiraling fashion. </claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 19</dependent-claim-reference>, wherein the IREDs flash in time sequence. </claim-text>
</claim>
<claim id="CLM-00021">
<claim-text><highlight><bold>21</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00022">claim 20</dependent-claim-reference>, wherein each IRED has a 60 degree transmission angle. </claim-text>
</claim>
<claim id="CLM-00022">
<claim-text><highlight><bold>22</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference>, further comprising: 
<claim-text>(d) a scanning device for scanning tissue of the patient to acquire, store and process a 3-D reference of tissue prior to the tissue being surgically exposed, wherein the image data processor creates a triangularized mesh based on the scanned tissue, determines the volumetric center of a particular portion of the tissue to be resected or ablated during the surgery, and implements an algorithm using the triangularized mesh and the physical space data collected by the probe instrument to determine the point-based registrations. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00023">
<claim-text><highlight><bold>23</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00022">claim 22</dependent-claim-reference>, wherein the algorithm is a Besl and Mackay iterative closest point (ICP) registration algorithm. </claim-text>
</claim>
<claim id="CLM-00024">
<claim-text><highlight><bold>24</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00022">claim 22</dependent-claim-reference>, wherein the scanning device is one of the following scanners: a computerized tomography (CT) scanner, a magnetic resonance imaging (MRI) scanner and a positron emission tomography (PET) scanner. </claim-text>
</claim>
<claim id="CLM-00025">
<claim-text><highlight><bold>25</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference>, wherein the ablative instrument has a tip comprising an ablation device. </claim-text>
</claim>
<claim id="CLM-00026">
<claim-text><highlight><bold>26</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00022">claim 25</dependent-claim-reference>, wherein the ablation zone extends 1 centimeter from the tip of the ablative instrument. </claim-text>
</claim>
<claim id="CLM-00027">
<claim-text><highlight><bold>27</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference>, wherein the probe instrument is swept over the surface of the exposed tissue. </claim-text>
</claim>
<claim id="CLM-00028">
<claim-text><highlight><bold>28</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference>, wherein the image data is updated in real time at 30 Hz or greater. </claim-text>
</claim>
<claim id="CLM-00029">
<claim-text><highlight><bold>29</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference>, wherein the ablative instrument uses one of radio-frequency and cryoablation to resect or ablate the particular portion of the tissue. </claim-text>
</claim>
<claim id="CLM-00030">
<claim-text><highlight><bold>30</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference>, wherein points from 3-D physical space are mapped to 2-dimensional (2-D) image space. </claim-text>
</claim>
<claim id="CLM-00031">
<claim-text><highlight><bold>31</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference>, wherein points from 3-D physical space are mapped to 2-dimensional (2-D) laparoscopic video space using a direct linear transformation (DLT). </claim-text>
</claim>
<claim id="CLM-00032">
<claim-text><highlight><bold>32</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference>, wherein points from 3-D physical space are mapped to 3-D tomographic image space. </claim-text>
</claim>
<claim id="CLM-00033">
<claim-text><highlight><bold>33</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference>, wherein points from 3-D physical space are mapped to 2-dimensional (2-D) endoscopic image space. </claim-text>
</claim>
<claim id="CLM-00034">
<claim-text><highlight><bold>34</bold></highlight>. An article of manufacture for collecting and processing physical space data for use while performing image-guided surgery, the article of manufacture comprising a computer-readable medium holding computer-executable instructions for performing a method comprising: 
<claim-text>(a) determining point-based registrations used to indicate surgical position in both image space and physical space by processing physical space data collected by probing a plurality of physical surface points of surgically exposed tissue of a living patient, the physical space data providing three-dimensional (3-D) coordinates for each of the physical surface points; </claim-text>
<claim-text>(b) using the point-based registrations to map into image space, image data describing the physical space of an ablative instrument used to perform the image-guided surgery, an ablation zone of the ablative instrument, the tissue, and a particular portion of the tissue to be resected or ablated; and </claim-text>
<claim-text>(c) updating the image data on a periodic basis. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00035">
<claim-text><highlight><bold>35</bold></highlight>. The article of manufacture of <dependent-claim-reference depends_on="CLM-00033">claim 34</dependent-claim-reference>, wherein the computer-executable instructions perform a method further comprising: 
<claim-text>(d) creating a triangularized mesh based on a 3-D reference of tissue of the patient, the 3-D reference being acquired, stored and processed prior to the tissue being surgically exposed; </claim-text>
<claim-text>(e) determining the volumetric center of a particular portion of the tissue to be resected or ablated during the surgery; and </claim-text>
<claim-text>(f) implementing an algorithm using the triangularized mesh and the physical space data to determine the point-based registrations. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00036">
<claim-text><highlight><bold>36</bold></highlight>. The article of manufacture of <dependent-claim-reference depends_on="CLM-00033">claim 35</dependent-claim-reference>, wherein the algorithm is a Besl and Mackay iterative closest point (ICP) registration algorithm. </claim-text>
</claim>
<claim id="CLM-00037">
<claim-text><highlight><bold>37</bold></highlight>. The article of manufacture of <dependent-claim-reference depends_on="CLM-00033">claim 34</dependent-claim-reference>, wherein points from 3-D physical space are mapped to 2-dimensional (2-D) image space. </claim-text>
</claim>
<claim id="CLM-00038">
<claim-text><highlight><bold>38</bold></highlight>. The article of manufacture of <dependent-claim-reference depends_on="CLM-00033">claim 34</dependent-claim-reference>, wherein points from 3-D physical space are mapped to 2-dimensional (2-D) laparoscopic video space using a direct linear transformation (DLT). </claim-text>
</claim>
<claim id="CLM-00039">
<claim-text><highlight><bold>39</bold></highlight>. The article of manufacture of <dependent-claim-reference depends_on="CLM-00033">claim 34</dependent-claim-reference>, wherein points from 3-D physical space are mapped to 3-D tomographic image space. </claim-text>
</claim>
<claim id="CLM-00040">
<claim-text><highlight><bold>40</bold></highlight>. The article of manufacture of <dependent-claim-reference depends_on="CLM-00033">claim 34</dependent-claim-reference>, wherein points from 3-D physical space are mapped to 2-dimensional (2-D) endoscopic image space.</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>3</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030000535A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030000535A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030000535A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030000535A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030000535A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030000535A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
