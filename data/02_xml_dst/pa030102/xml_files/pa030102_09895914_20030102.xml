<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030004957A1-20030102-D00000.TIF SYSTEM "US20030004957A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030004957A1-20030102-D00001.TIF SYSTEM "US20030004957A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030004957A1-20030102-D00002.TIF SYSTEM "US20030004957A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030004957A1-20030102-D00003.TIF SYSTEM "US20030004957A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030004957A1-20030102-D00004.TIF SYSTEM "US20030004957A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030004957A1-20030102-D00005.TIF SYSTEM "US20030004957A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030004957A1-20030102-D00006.TIF SYSTEM "US20030004957A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030004957A1-20030102-D00007.TIF SYSTEM "US20030004957A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030004957A1-20030102-D00008.TIF SYSTEM "US20030004957A1-20030102-D00008.TIF" NDATA TIF>
<!ENTITY US20030004957A1-20030102-D00009.TIF SYSTEM "US20030004957A1-20030102-D00009.TIF" NDATA TIF>
<!ENTITY US20030004957A1-20030102-D00010.TIF SYSTEM "US20030004957A1-20030102-D00010.TIF" NDATA TIF>
<!ENTITY US20030004957A1-20030102-D00011.TIF SYSTEM "US20030004957A1-20030102-D00011.TIF" NDATA TIF>
<!ENTITY US20030004957A1-20030102-D00012.TIF SYSTEM "US20030004957A1-20030102-D00012.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030004957</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>09895914</doc-number>
</application-number>
<application-number-series-code>09</application-number-series-code>
<filing-date>20010629</filing-date>
</domestic-filing-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>G06F007/00</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>707</class>
<subclass>100000</subclass>
</uspc>
</classification-us-primary>
</classification-us>
<title-of-invention>Automated document formatting tool</title-of-invention>
</technical-information>
<inventors>
<first-named-inventor>
<name>
<given-name>Paul</given-name>
<family-name>Broman</family-name>
</name>
<residence>
<residence-us>
<city>Renton</city>
<state>WA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Glenn</given-name>
<family-name>Frankel</family-name>
</name>
<residence>
<residence-us>
<city>Seattle</city>
<state>WA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Roberto</given-name>
<family-name>Taboada</family-name>
</name>
<residence>
<residence-us>
<city>Bothell</city>
<state>WA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<assignee>
<organization-name>Microsoft Corporation</organization-name>
<assignee-type>02</assignee-type>
</assignee>
<correspondence-address>
<name-1>MERCHANT &amp; GOULD</name-1>
<name-2></name-2>
<address>
<address-1>P.O. BOX 2903</address-1>
<city>MINNEAPOLIS</city>
<state>MN</state>
<postalcode>55402-0903</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">A formatting tool enables &ldquo;smart&rdquo; copy and paste functions. The &ldquo;smart&rdquo; copy and paste functions can be invoked in a context-sensitive manner, depending on the conditions under which the copy and paste functions are implemented. The present invention will automatically include in a selection a paragraph marker at the end of a selected paragraph, if every other textual character in the paragraph has been selected. The present invention will discard a paragraph mark that is included in pasted text if the pasted text is pasted into the middle of another paragraph, indicating that the user prefers the formatting of the pasted-into paragraph. The present invention also reduces inconsistencies in formatting styles that may exist between source and target documents automatically redefining a style in the target document to conform to a corresponding style in the source document. The present invention also automatically adjusts paragraph spacing, in response to text being pasted into a target document. In respose to various scenarios, the present invention will determine the most likely paragraph spacing intended by the user and will apply the most probable paragraph spacing to the pasted paragraph. The present invention also automatically adjusts list, table, and spreadsheet formatting, in response to such document elements being pasted into a differently-formatted target document. Finally, the present invention provides a convenient recovery dialog that may be invoked to alter any automatically-implemented formatting decisions. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">FIELD OF THE INVENTION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> The present invention generally relates to editing electronic documents. More particularly, the present invention relates to automatically formatting text that is copied, cut, or pasted. </paragraph>
</section>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> Copying and pasting text is the most widely-used means of introducing content to a word processor document. The popularity of the copy and paste functions stems in large part from the fact that a user can use the functions to quickly import material from a variety of sources. Word processor users commonly copy and paste material from source documents, such as word processor documents, e-mail notes, spreadsheets documents, and web pages. Unfortunately, pasting material into a target document often results in unpredictable formatting behavior. The text that is pasted into the target document is often in a format that is either inconsistent with the rest of the document or inconsistent with the user&apos;s expectations. This problem is often made worse by the fact that the format of the text in the source document may be different than the formatting of text in the target document. Conventional pasting functions also fail to provide recovery mechanisms. Consequently, when a user pastes text into a word processor document, the user must take affirmative steps to format the pasted text to the user&apos;s liking. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> One approach to solving this problem has been to provide a &ldquo;Paste Special&rdquo; function that permits the user to select from various formats at the time of pasting the text into the target document. Unfortunately, the user must be aware of the availability of the &ldquo;Paste Special&rdquo; functionality and must make an affirmative step to implement this function. Studies of the results provided by instrumented versions of word processor application programs indicate that the &ldquo;Paste Special&rdquo; functionality is not commonly used. </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> Therefore, there is a need in the art for a formatting tool that can automatically determine the most likely formatting choices based on the context and on the user&apos;s behavior. The formatting tool also should enable the user to quickly select the formatting of the pasted text. The formatting tool should operate within the confines of a document editor&apos;s normal operation, in that it does not require the user to take alternative steps to invoke the automatic formatting. The formatting tool also should provide a recovery mechanism that enables the user to quickly re-format text that has been automatically formatted, when the automatic formatting is not the desired formatting. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> The present invention satisfies the above-described needs by providing a formatting tool that enables &ldquo;smart&rdquo; copy and paste functions. The &ldquo;smart&rdquo; copy and paste functions can be invoked in a context-sensitive manner, depending on the conditions under which the copy and paste functions are implemented. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> When a user selects a paragraph or a portion of a paragraph to copy, the user may or may not select the paragraph marker at the end of the paragraph. When a user pastes text having a paragraph marker at the end, the formatting of that pasted text may be different than if the user had pasted text without the paragraph marker at the end. Usability studies indicate that users commonly inadvertently include or exclude a paragraph mark from selected text. As a result, a user will commonly be surprised by the formatting behavior upon pasting such selected text. The present invention will automatically include in a selection a paragraph marker at the end of a selected paragraph, if every other textual character in the paragraph has been selected. This behavior is based on the assumption that the user intends to select the entire paragraph, as a paragraph, rather than as unformatted text. The user may override this behavior by moving the selection cursor to the left of the paragraph marker before finalizing the text selection. In addition, the present invention will discard a paragraph mark that is included in pasted text if the pasted text is pasted into the middle of another paragraph, indicating that the user prefers the formatting of the pasted-into paragraph. Thus, the present invention assists a user in selecting and pasting text where a paragraph marker may alter the formatting of the pasted text. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> The present invention also reduces inconsistencies in formatting styles that may exist between source and target documents. When a user pastes styled text from a source document the style of the pasted text may be inconsistent with a corresponding style in the target document having the same style name. In cases where the corresponding style has not been used or explicitly redefined in the target document, pasting styled text from a source document will redefine the corresponding style in the target document. This functionality can also be applied to all other styles. However, in one embodiment of the present invention, if any style of a group of styles is presently in use in the target document, then none of the other styles in that group will be redefined when the text is pasted into the target document. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> The present invention also automatically adjusts paragraph spacing, in response to text being pasted into a target document. Pasting text into a target document often results in unwarted empty paragraphs or inconsistent paragraph spacing. In response to various scenarios, the present invention will determine the most likely paragraph spacing intended by the user and will apply the most probable paragraph spacing to the pasted paragraph. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> The present invention also automatically adjusts list formatting, in response to text in a list being pasted into a differently-formatted list in a target document. Pasting list text into an existing list in a target document often results in inconsistent list formatting. In response to various scenarios, the present invention will determine the most likely list format intended by the user and will apply the most probable list format to the pasted list text. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> The present invention also automatically adjusts table cell formatting, in response to text from a table being pasted into a differently-formatted table or into a non-table paragraph in a target document. Pasting table text into an existing table in a target document often results in inconsistent table formatting or in an unwanted nested table. Similarly, pasting table text into a non-table paragraph can result in the creation of a new unwanted table in the target document. In response to various scenarios, the present invention will determine the most likely table formatting (or non-table formatting) intended by the user and will apply the most probable formatting to the pasted text. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> The present invention also automatically determines whether a user pasting a table from a spreadsheet intends to paste an image of the spreadsheet, an object of the spreadsheet application program, or a link to the spreadsheet document file. </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> The present invention also automatically resolves style conflicts between the source document and the target document to determine the most-likely formatting intentions of the user. The present invention will apply a style to pasted text in accordance with this formatting determination. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> Finally, the present invention will provide a convenient recovery dialog that may be invoked to alter any automatically-implemented formatting decisions. Thus, if the present invention makes an incorrect determination regarding the user&apos;s formatting intentions, the formatting may be easily altered. The user may also turn the automatic formatting tools off in a preferences dialog box. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> The various aspects of the present invention may be more clearly understood and appreciated from a review of the following detailed description of the disclosed embodiments and by reference to the drawings and claims.</paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a block diagram illustrating an exemplary operating environment for implementation of the present invention. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a block diagram depicting an exemplary formatting component operating within the context of a word processor. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a flow chart depicting an exemplary method for automatically re-formatting a document element, in response to the triggering of a formatting rule. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a flow chart that depicts an exemplary method for automatically determining whether to include or exclude a paragraph mark from a portion of pasted text. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is a flow chart depicting an exemplary method for recognizing and eliminating an unwanted paragraph mark from selected text. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a flow chart depicting an exemplary method for redefining styles in a target document. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a flow chart depicting an exemplary method for eliminating empty paragraphs from target and source documents. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a flow chart that depicts an exemplary method for merging and creating lists, in response to a paste operation. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a flow chart depicting an exemplary method for formatting a table, in response to copy and paste operations. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a flow chart depicting an exemplary method for pasting spreadsheet elements. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is flow chart depicting an exemplary method for automatically adjusting the formatting of pasted text. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a flow chart depicting an exemplary method for pasting a spreadsheet chart into a document.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION </heading>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> In one embodiment of the present invention, a formatting tool is provided that enables &ldquo;smart&rdquo; copy and paste functions. The &ldquo;smart&rdquo; copy and paste functions can be invoked in a context-sensitive manner, depending on the conditions under which the copy and paste functions are implemented. The present invention will automatically include in a selection a paragraph marker at the end of a selected paragraph, if every other textual character in the paragraph has been selected. The present invention will discard a paragraph mark that is included in pasted text if the pasted text is pasted into the middle of another paragraph, indicating that the user prefers the formatting of the pasted-into paragraph. </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> An embodiment of the present invention reduces inconsistencies in formatting styles that may exist between source and target documents automatically redefining a style in the target document to conform to a corresponding style in the source document. The present invention also automatically adjusts paragraph spacing, in response to text being pasted into a target document. In response to various scenarios, the present invention will determine the most likely paragraph spacing intended by the user and will apply the most probable paragraph spacing to the pasted paragraph. The present invention also automatically adjusts list, table, and spreadsheet formatting, in response to such document elements being pasted into a differently-formatted target document. Finally, exemplary embodiments of the present invention provide a convenient recovery dialog that may be invoked to alter any automatically-implemented formatting decisions. </paragraph>
<paragraph id="P-0029" lvl="7"><number>&lsqb;0029&rsqb;</number> An Exemplary Operating Environment </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> Exemplary embodiments of the present invention will hereinafter be described with reference to the drawings, in which like numerals represent like elements throughout the several figures. <cross-reference target="DRAWINGS">FIG. 1</cross-reference> illustrates an exemplary operating environment for implementation of the present invention. The exemplary operating environment includes a general-purpose computing device in the form of a conventional personal computer <highlight><bold>120</bold></highlight>. Generally, the personal computer <highlight><bold>120</bold></highlight> includes a processing unit <highlight><bold>121</bold></highlight>, a system memory <highlight><bold>122</bold></highlight>, and a system bus <highlight><bold>123</bold></highlight> that couples various system components including the system memory <highlight><bold>122</bold></highlight> to the processing unit <highlight><bold>121</bold></highlight>. The system bus <highlight><bold>123</bold></highlight> may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. The system memory includes a read only memory (ROM) <highlight><bold>124</bold></highlight> and a random access memory (RAM) <highlight><bold>125</bold></highlight>. A basic input/output system (BIOS) <highlight><bold>126</bold></highlight>, containing the basic routines that help to transfer information between elements within personal computer <highlight><bold>120</bold></highlight>, such as during start-up, is stored in ROM <highlight><bold>124</bold></highlight>. </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> Personal computer <highlight><bold>120</bold></highlight> further includes a hard disk drive <highlight><bold>127</bold></highlight> for reading from and writing to a hard disk, not shown, a magnetic disk drive <highlight><bold>128</bold></highlight> for reading from or writing to a removable magnetic disk <highlight><bold>129</bold></highlight>, and an optical disk drive <highlight><bold>130</bold></highlight> for reading from or writing to a removable optical disk <highlight><bold>131</bold></highlight> such as a CD-ROM or other optical media. Hard disk drive <highlight><bold>127</bold></highlight>, magnetic disk drive <highlight><bold>128</bold></highlight>, and optical disk drive <highlight><bold>130</bold></highlight> are connected to system bus <highlight><bold>123</bold></highlight> by a hard disk drive interface <highlight><bold>132</bold></highlight>, a magnetic disk drive interface <highlight><bold>133</bold></highlight>, and an optical disk drive interface <highlight><bold>134</bold></highlight>, respectively. Although the exemplary environment described herein employs hard disk <highlight><bold>127</bold></highlight>, removable magnetic disk <highlight><bold>129</bold></highlight>, and removable optical disk <highlight><bold>131</bold></highlight>, it should be appreciated by those skilled in the art that other types of computer readable media which can store data that is accessible by a computer, such as magnetic cassettes, flash memory cards, digital video disks, Bernoulli cartridges, RAMs, ROMs, and the like, may also be used in the exemplary operating environment. The drives and their associated computer readable media provide nonvolatile storage of computer-executable instructions, data structures, program modules, and other data for personal computer <highlight><bold>120</bold></highlight>. </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> A number of program modules may be stored on hard disk <highlight><bold>127</bold></highlight>, magnetic disk <highlight><bold>129</bold></highlight>, optical disk <highlight><bold>131</bold></highlight>, ROM <highlight><bold>124</bold></highlight>, or RAM <highlight><bold>125</bold></highlight>, including an operating system <highlight><bold>135</bold></highlight>, a document editor <highlight><bold>136</bold></highlight>, a formatting component <highlight><bold>138</bold></highlight>, and a formatting rules component <highlight><bold>139</bold></highlight>. Program modules include routines, sub-routines, programs, objects, components, data structures, etc., which perform particular tasks or implement particular abstract data types. Aspects of the present invention may be implemented in the form of a formatting component <highlight><bold>138</bold></highlight> that can be incorporated into or otherwise in communication with the document editor <highlight><bold>136</bold></highlight>. The document editor <highlight><bold>136</bold></highlight> generally comprises computer-executable instructions for creating or modifying an electronic document. The formatting component <highlight><bold>138</bold></highlight> generally comprises computer-executable instructions for applying and modifying formatting to text and/or other document elements. The formatting component <highlight><bold>138</bold></highlight> is generally accessible to the document editor <highlight><bold>136</bold></highlight>, but can also be implemented as an integral part of the document editor. </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> A user may enter commands and information into personal computer <highlight><bold>120</bold></highlight> through input devices, such as a keyboard <highlight><bold>140</bold></highlight> and a pointing device <highlight><bold>142</bold></highlight>. Other input devices (not shown) may include a microphone, joystick, game pad, satellite dish, scanner, or the like. These and other input devices are often connected to processing unit <highlight><bold>122</bold></highlight> through a serial port interface <highlight><bold>146</bold></highlight> that is coupled to the system bus <highlight><bold>123</bold></highlight>, but may be connected by other interfaces, such as a parallel port, game port, a universal serial bus (USB), or the like. A display device <highlight><bold>147</bold></highlight> may also be connected to system bus <highlight><bold>123</bold></highlight> via an interface, such as a video adapter <highlight><bold>148</bold></highlight>. In addition to the monitor, personal computers typically include other peripheral output devices (not shown), such as speakers and printers. </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> The personal computer <highlight><bold>120</bold></highlight> may operate in a networked environment using logical connections to one or more remote computers <highlight><bold>149</bold></highlight>. Remote computer <highlight><bold>149</bold></highlight> may be another personal computer, a server, a client, a router, a network PC, a peer device, or other common network node. While a remote computer <highlight><bold>149</bold></highlight> typically includes many or all of the elements described above relative to the personal computer <highlight><bold>120</bold></highlight>, only a memory storage device <highlight><bold>150</bold></highlight> has been illustrated in the figure. The logical connections depicted in the figure include a local area network (LAN) <highlight><bold>151</bold></highlight> and a wide area network (WAN) <highlight><bold>152</bold></highlight>. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets, and the Internet. </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> When used in a LAN networking environment, the personal computer <highlight><bold>120</bold></highlight> is often connected to the local area network <highlight><bold>151</bold></highlight> through a network interface or adapter <highlight><bold>153</bold></highlight>. When used in a WAN networking environment, the personal computer <highlight><bold>120</bold></highlight> typically includes a modem <highlight><bold>154</bold></highlight> or other means for establishing communications over WAN <highlight><bold>152</bold></highlight>, such as the Internet. Modem <highlight><bold>154</bold></highlight>, which may be internal or external, is connected to system bus <highlight><bold>123</bold></highlight> via serial port interface <highlight><bold>146</bold></highlight>. In a networked environment, program modules depicted relative to personal computer <highlight><bold>120</bold></highlight>, or portions thereof, may be stored in the remote memory storage device <highlight><bold>150</bold></highlight>. It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used. </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> Moreover, those skilled in the art will appreciate that the present invention may be implemented in other computer system configurations, including hand-held devices, multiprocessor systems, microprocessor based or programmable consumer electronics, network person computers, minicomputers, mainframe computers, and the like. The invention may also be practiced in distributed computing environments, where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules may be located in both local and remote memory storage devices. </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a block diagram depicting an exemplary formatting component <highlight><bold>204</bold></highlight> operating within the context of a word processor <highlight><bold>200</bold></highlight>. In this exemplary embodiment of the present invention word processor <highlight><bold>200</bold></highlight> is a document editor that can be used to create and manipulate a source document <highlight><bold>202</bold></highlight> and a target document <highlight><bold>203</bold></highlight>. The formatting component <highlight><bold>204</bold></highlight> works in cooperation with the word processor <highlight><bold>200</bold></highlight> to provide formatting and editing tools for the source document <highlight><bold>202</bold></highlight> and for the target document <highlight><bold>203</bold></highlight>. The formatting component <highlight><bold>204</bold></highlight> can maintain information about the documents <highlight><bold>202</bold></highlight>, <highlight><bold>203</bold></highlight> including, but not limited to, information about text formatting, table formatting, chart formatting, and list formatting. The formatting component <highlight><bold>204</bold></highlight> also can control the way that document elements (e.g., text) are cut, copied, and pasted within and between the source document <highlight><bold>202</bold></highlight> and the target document <highlight><bold>203</bold></highlight>. </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> Text formatting is typically applied to text in he document <highlight><bold>202</bold></highlight>, <highlight><bold>203</bold></highlight> as a style or as a direct formatting property. Styles are simply named collections of formatting properties. For example, a &ldquo;body text&rdquo; style may include the formatting properties, font: Times Roman, font size: 12 point, bold: no, alignment: justified, while a &ldquo;Headline&rdquo; style may include the formatting properties, font: Arial, font size: 20, bold: yes. The styles may be applied to text thereby formatting the text in accordance with the formatting properties that are members of the named style. Of course, each formatting property can be individually applied to text. </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> Individualized application of formatting properties to text is referred to as direct formatting. Text may be formatted identically through direct formatting and the application of a style. However, style application is a quicker and easier method of applying formatting properties to the text in a portion of a document. Moreover, styles are used to verify formatting consistency among portions of a document that have the same style applied to them. Changes to the collection of formatting properties in a style will simultaneously change the format of all text to which that styles is applied. The formatting component <highlight><bold>204</bold></highlight> of an exemplary embodiment of the present invention maintains a record of the formatting properties associated with each portion of the document <highlight><bold>202</bold></highlight>. </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> The formatting component <highlight><bold>204</bold></highlight> of an exemplary embodiment of the present invention can automatically re-format a document element that is cut, copied or pasted between documents or between portions of the same document. The formatting component <highlight><bold>204</bold></highlight> can re-format a document element, based on the properties of the document element, the behavior of a user, the context from which the document element was cut or copied, and/or context into which the document element is pasted. </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> One means by which the formatting component <highlight><bold>204</bold></highlight> can automatically trigger re-formatting is through the use of rules maintained in a formatting rules component <highlight><bold>206</bold></highlight>. The formatting rules component can maintain a list of rules that describe events that can trigger an automatic re-formatting. For example, one rule might recognize the occurrence of an event wherein the user attempts to copy and past a single cell of a table. The formatting rules component <highlight><bold>206</bold></highlight> may also have a list of responsive actions associated with the list of rules. When a rule is triggered, the formatting rules component <highlight><bold>206</bold></highlight> may instruct the formatting component <highlight><bold>204</bold></highlight> to execute the associated responsive action. Notably, those skilled in the art will appreciate that not all of the formatting rules need be implemented simultaneously. </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> The formatting component <highlight><bold>204</bold></highlight> of an exemplary embodiment of the present invention also can provide an On-Object User Interface (OOUI) to enable a user to recover from or reconfigure an automatic reformatting. The OOUI may be automatically displayed within the context of a document editor (e.g., spreadsheet program, word processor, presentation, web page editor), in response to an automatic reformatting action taken by the formatting component <highlight><bold>204</bold></highlight>. The OOUI can be selected by a user to provide a drop-down menu of available recovery options. Thus, the user is not required to accept the automatic reformatting action taken by the formatting component <highlight><bold>204</bold></highlight>. A more detailed description of the OOUI can be found in co-pending U.S. patent application Ser. No. 09/620,876, filed on Jul. 21, 2000 and assigned to Microsoft Corporation of Redmond, Wash. That patent application is entitled &ldquo;ON-OBJECT USER INTERFACE&rdquo; and is hereby incorporated by reference. </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> Although the descriptions of the inventions provided in connection with FIGS. <highlight><bold>4</bold></highlight>-<highlight><bold>12</bold></highlight> often describe the formatting, copying, and pasting of text, it will be appreciated by those skilled in the art that the present invention can be used to automatically format any document element. Document elements can include, but are not limited to, text, spreadsheets, tables, list, and charts. </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> It will also be appreciated that the OOUI or other recovery user interface can be displayed following an automatic formatting action to allow a user to reverse the formatting action. In addition, the recovery user interface can be displayed following a user&apos;s selection of a recovery action and the performance of that recovery action. Accordingly, the user can sequentially select various recovery actions from a recovery user interface to determine the effects of each, before deciding on a preferred recovery action. Although the descriptions provided in connection with FIGS. <highlight><bold>4</bold></highlight>-<highlight><bold>12</bold></highlight> may not describe the provision of a recovery user interface following an automatic action or a recovery action, those skilled in the art will appreciate that such a recovery user interface could be provided within the scope of the embodiments of the present invention. </paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a flow chart depicting an exemplary method for automatically re-formatting a document element, in response to the triggering of a formatting rule. The method begins at step <highlight><bold>300</bold></highlight> and proceeds to step <highlight><bold>302</bold></highlight>. At step <highlight><bold>302</bold></highlight>, text is selected for copying or cutting. Typically, this is performed by a user who selects text using a pointing device (e.g., a mouse) that controls a selection cursor and then selecting to copy or cut the selected text from the source document. The method proceeds from step <highlight><bold>302</bold></highlight> to decision block <highlight><bold>304</bold></highlight>. At decision block <highlight><bold>304</bold></highlight>, a determination is made as to whether a selection formatting rule is applicable. If a selection formatting rule is applicable, the method proceeds to step <highlight><bold>306</bold></highlight> and the selected text is adjusted according to the formatting rule. The method then proceeds to step <highlight><bold>308</bold></highlight> and the paste point is selected in the target document. If, on the other hand, a determination is made at decision block <highlight><bold>304</bold></highlight> that no selection rule is applicable, the method will branch directly from decision block <highlight><bold>304</bold></highlight> to step <highlight><bold>308</bold></highlight>. </paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> The method proceeds from step <highlight><bold>308</bold></highlight> to decision block <highlight><bold>310</bold></highlight>. At decision block <highlight><bold>310</bold></highlight>, a determination is made as to whether a paste formatting rule is applicable. If a paste formatting rule is applicable, the method branches to step <highlight><bold>312</bold></highlight> and the pasted text is re-formatted, in accordance with a paste formatting rule. The method then proceeds to decision block <highlight><bold>314</bold></highlight>, wherein a determination is made as to whether the re-formatting action is associated with a recovery action. If a determination is made that the re-formatting action is not associated with a recovery action, the method branches to step <highlight><bold>320</bold></highlight> and ends. </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> If, on the other hand, the re-formatting is associated with a recovery action, the method branches to step <highlight><bold>316</bold></highlight> and the recovery user interface is displayed (e.g., OOUI). The method then proceeds to decision block <highlight><bold>318</bold></highlight>, wherein a determination is made as to whether a recovery action is selected. If a recovery action is not selected, the method branches to step <highlight><bold>320</bold></highlight> and ends. If a recovery action is selected, the method branches to step <highlight><bold>322</bold></highlight> and the selected recovery action is performed, the method proceeds from step <highlight><bold>322</bold></highlight> to step <highlight><bold>320</bold></highlight> and ends. Although not depicted in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>, the recovery user interface also may continue to be displayed after the selected recovery action is performed (i.e., after step <highlight><bold>322</bold></highlight>), so that the first selected recovery action can be undone. </paragraph>
<paragraph id="P-0048" lvl="0"><number>&lsqb;0048&rsqb;</number> It will be appreciated by those skilled in the art that various methods for triggering re-formatting actions and for providing access to recovery actions may be used within the scope of the present invention. FIGS. <highlight><bold>4</bold></highlight>-<highlight><bold>12</bold></highlight> are flow charts that define exemplary methods for re-formatting document elements and for providing recovery options, following such a re-formatting. The flow charts of FIGS. <highlight><bold>4</bold></highlight>-<highlight><bold>12</bold></highlight> do not necessarily describe the triggering of a formatting rule. However, it will appreciated by those skilled in the art that the methods described in FIGS. <highlight><bold>4</bold></highlight>-<highlight><bold>12</bold></highlight> could be implemented with a collection of rules and associated response of actions or by various other well-known means. For the purposes of this description, a document from which text is cut or copied, is referred to as the source document. The document to which selected text is pasted is referred to as the target document. Those skilled in the art will appreciate that the source document and the target document may be the same document. </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a flow chart that depicts an exemplary method for automatically determining whether to include or exclude a paragraph mark from a portion of pasted text. Often, a user may select and copy or cut a paragraph mark (i.e., return character) inadvertently. When such a user pastes the selected text containing the unwanted paragraph mark, the paragraph mark will create a new paragraph in the target document. If, for example, the user only wanted to add a sentence to an existing paragraph, the paragraph mark would break the target paragraph into two paragraphs. The user would then be required to delete the paragraph mark from the target paragraph to return the target paragraph to its original single-paragraph form. </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> Conversely, the user may select an entire paragraph with a paragraph mark at the end, intending to create a new paragraph in a target document with the selected paragraph. This user may inadvertently omit the paragraph mark from the end of the selected paragraph. In such a case, the selected text will be pasted into the target document as part of the paragraph into which it is pasted. To remedy this problem, the user must normally find the end of the pasted paragraph and insert a paragraph mark. The method of <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is intended to automatically determine whether the user intended to select the paragraph mark and to re-format the pasted text accordingly. </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> begins with step <highlight><bold>400</bold></highlight> and proceeds to step <highlight><bold>402</bold></highlight>. At step <highlight><bold>402</bold></highlight>, text is selected for copying or cutting (collectively, copying). The method then proceeds to step <highlight><bold>404</bold></highlight>, wherein the portion of the last paragraph selected is determined. In the case of a single paragraph, this step will determine how much of the paragraph was selected for copying. In the case where a user is selecting a group of paragraphs, a determination of the portion of the last paragraph selected will be made. The method proceeds from step <highlight><bold>404</bold></highlight> to decision block <highlight><bold>406</bold></highlight>. At decision block <highlight><bold>406</bold></highlight>, a determination is made as to whether every textual character in the last paragraph was selected. That is, a determination is made as to whether every visible character in the last paragraph has been selected for copying by the user. If the user has selected every textual character in the last paragraph, it may be assumed that the user intended to copy the paragraph as a paragraph (i.e., with a paragraph mark at the end). If on the other hand the user has selected only a portion of the last paragraph, then it can be assumed that the user only intended to select the selected text and to paste the selected text as part of a paragraph in the existing target document. If a determination is made that not every character in the last paragraph was selected, the method branches to step <highlight><bold>408</bold></highlight> and ends. If on the other hand, a determination is made that every textual character in the last paragraph was selected, the method branches to decision block <highlight><bold>410</bold></highlight>. </paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> At decision block <highlight><bold>410</bold></highlight>, a determination is made as to whether the paragraph mark was selected. If the paragraph mark was selected, the method branches to decision block <highlight><bold>414</bold></highlight>. If on the other hand, a determination is made that the paragraph mark was not selected, a method branches to step <highlight><bold>412</bold></highlight>. At step <highlight><bold>412</bold></highlight>, the user&apos;s selected text is extended to include the un-selected paragraph mark. This step essentially converts the pasted text from a non-paragraph to a paragraph. The method proceeds from step <highlight><bold>412</bold></highlight> to decision block <highlight><bold>414</bold></highlight>. </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> At decision block <highlight><bold>414</bold></highlight> a determination is made as to whether the user moves the selected cursor to the left. If the user never moves the selected cursor to the left, it may be assumed that the user intends to copy the entire paragraph, including the paragraph mark. If, on the other hand, the user moves the selection cursor to the left after the selecting the text, it may be assumed that the user seeks to copy only the text and does not seek to paste the selected text as an independent paragraph in the target document. If a determination is made that the user has not moved the selected cursor to the left, the method branches to step <highlight><bold>418</bold></highlight> and ends. If, on the other hand, a determination is made that the user has moved the selection cursor to the left, the method branches to step <highlight><bold>416</bold></highlight>. At step <highlight><bold>416</bold></highlight>, the selection is extracted to exclude the paragraph mark, thus converting the selected text from an independent paragraph to a non-paragraph. The method then proceeds to step <highlight><bold>418</bold></highlight> and ends. </paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is a flow chart depicting an exemplary method for recognizing and eliminating an unwanted paragraph mark from selected text. The method begins at step <highlight><bold>500</bold></highlight> and proceeds to step <highlight><bold>502</bold></highlight>. At step <highlight><bold>502</bold></highlight>, text is selected for copying or cutting (collectively, copying). The method proceeds to step <highlight><bold>504</bold></highlight>, wherein the paste point is determined. Typically, a user will determine the paste point by placing an insertion cursor at a location within a target document. The method proceeds from step <highlight><bold>504</bold></highlight> to decision block <highlight><bold>506</bold></highlight>. At decision block <highlight><bold>506</bold></highlight>, a determination is made as to whether one paragraph mark is included in the selected text. If more than one paragraph mark is included in the selected text, it may be assumed that the user intends to paste the selected text as independent paragraphs. On the other hand, if only one paragraph mark was included in the selection, it may be assumed that the user may want to paste the selected text as part of a paragraph existing in the target document, rather than as a new, independent paragraph. </paragraph>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> If one paragraph mark is included in the selection, the method branches to decision block <highlight><bold>508</bold></highlight>. If, on the other hand, less than or more than one paragraph mark is included in the selection the method branches to step <highlight><bold>516</bold></highlight>, wherein the selected text is pasted in the paste point. The method proceeds from step <highlight><bold>516</bold></highlight> to step <highlight><bold>518</bold></highlight> and ends. </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> At decision block <highlight><bold>508</bold></highlight>, a determination is made as to whether the paste point is within an existing paragraph in the target document. If the paste point is within the target paragraph, it may be assumed that the user may want the selected text to be pasted as part of the target paragraph. On the other hand, if the paste point is at the beginning or end of paragraphs in the target document, it may be assumed that the user may want to create a new, independent paragraph in the target document. If a determination is made that the paste point is in the middle of a target paragraph, the method branches from decision block <highlight><bold>508</bold></highlight> to step <highlight><bold>514</bold></highlight>. At step <highlight><bold>514</bold></highlight>, the single paragraph mark in the selected text is eliminated. This elimination will insure that the selected text is pasted as a part of the existing paragraph. The method then proceeds to step <highlight><bold>516</bold></highlight>, wherein the selected text is pasted in the paste point. The method proceeds from step <highlight><bold>516</bold></highlight> to step <highlight><bold>518</bold></highlight> and ends. </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> Returning now to decision block <highlight><bold>508</bold></highlight>, if a determination is made that the paste point is not in the middle of a target paragraph (i.e., the target location is at the beginning or end of one or more paragraphs in the target document), the method branches to decision block <highlight><bold>510</bold></highlight>. At decision block <highlight><bold>510</bold></highlight>, a determination is made as to whether the paste point is within a numbered or bulleted list. If the paste point is not within a numbered or bulleted list, the method branches from decision block <highlight><bold>510</bold></highlight> to step <highlight><bold>516</bold></highlight>. At step <highlight><bold>516</bold></highlight>, the selected text is pasted at the paste point and the method proceeds to step <highlight><bold>518</bold></highlight> and ends. </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> If, at decision block <highlight><bold>510</bold></highlight>, a determination is made that the paste point is within a numbered or bulleted list the method branches to decision block <highlight><bold>512</bold></highlight>. At decision block <highlight><bold>512</bold></highlight>, a determination is made as to whether the selected text was a bulleted or numbered list item in the source document. If a determination is made that the selected text is a bulleted or numbered list item the method branches to step <highlight><bold>516</bold></highlight> and the selected text is pasted as described above. If, on the other hand, a determination is made at the selected text is not a bulleted or numbered list item, the method branches to step <highlight><bold>514</bold></highlight>. At step <highlight><bold>514</bold></highlight>, the paragraph mark is eliminated from the selected text and the method proceeds to step <highlight><bold>516</bold></highlight>, wherein the selected text is pasted as described above. By determining whether the selected text was originally a bulleted or numbered list item, the method can make an assumption as to whether the user intended to paste the selected text as a new list item or simply as a part of an existing list item. </paragraph>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a flow chart depicting an exemplary method for redefining styles in a target document. The method of <cross-reference target="DRAWINGS">FIG. 6</cross-reference> starts at step <highlight><bold>600</bold></highlight> and proceeds to step <highlight><bold>602</bold></highlight>. At step <highlight><bold>602</bold></highlight>, text is selected from a source document for copying or cutting. For the purposes of this description, the term &ldquo;copying&rdquo; will be used to describe the function of copying and pasting in the context of a word processor. The method proceeds to step <highlight><bold>604</bold></highlight>, wherein the target document and the paste point within the target document are determined. As described in connection with <cross-reference target="DRAWINGS">FIG. 5</cross-reference>, this determination is usually made by a user defining an insertion point. The method then proceeds to decision block <highlight><bold>606</bold></highlight>, wherein a determination is made as to whether the selected text has a style associated with the selected text. </paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> Text formatting is typically applied to text in a document as a style or as a direct formatting property. Styles are well known and are simply named collections of formatting properties. Styles may be applied to text to format the text in accordance with the formatting properties that are members of the style. Individualized application of formatting properties to text is referred to as direct formatting. Text may be formatted identically through direct formatting or through the application of a style. Advantageously, styles can be used to insure formatting consistency among portions of a document that have the same style associated with them. </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> If a determination is made at step <highlight><bold>606</bold></highlight> that the selected text has an associated style, the method branches to decision block <highlight><bold>607</bold></highlight>. At decision block <highlight><bold>607</bold></highlight>, a determination is made as to whether a corresponding style exists in the target document. If a corresponding style exists in the target document, then the styles must be reconciled. If on the other hand, no corresponding style exists in the target document, the method branches to step <highlight><bold>612</bold></highlight>. At step <highlight><bold>612</bold></highlight>, the selected text is pasted at the paste point. The method proceeds from step <highlight><bold>612</bold></highlight> to step <highlight><bold>614</bold></highlight>. At step <highlight><bold>614</bold></highlight>, the pasted text is formatted in its original, associated style. The method then proceeds to <highlight><bold>616</bold></highlight> and ends. </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> If a determination is made at decision block <highlight><bold>607</bold></highlight> that a corresponding style exists in the target document, the method branches to decision block <highlight><bold>608</bold></highlight>. At decision block <highlight><bold>608</bold></highlight>, a determination is made as to whether a corresponding style in the target document belongs to a style group. Style groups are well-known collections of styles that are grouped for various reasons. For example, heading styles may be used to associate various heading styles with a particular hierarchy. Such a hierarchy may be used, for example, to create an ordered table of contents. If, on the other hand, a determination is made that a corresponding style exists in the target document, the method branches from decision block <highlight><bold>607</bold></highlight> to decision block <highlight><bold>608</bold></highlight>. </paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> If, at decision block <highlight><bold>608</bold></highlight>, a determination is made that the corresponding style does not belong to a style group, the method proceeds to decision block <highlight><bold>610</bold></highlight>. At decision block <highlight><bold>610</bold></highlight>, a determination is made as to whether the corresponding style as been used or redefined in the target document. If the corresponding style has not been used or redefined in the target document then the style of the selected text can be used to redefine the corresponding style. In this case, the method branches from decision block <highlight><bold>610</bold></highlight> to step <highlight><bold>618</bold></highlight>. At step <highlight><bold>618</bold></highlight>, the corresponding style is set equal to the source document style (i.e., the style of the selected text). The method then proceeds to step <highlight><bold>612</bold></highlight> and proceeds as described above. Returning now to decision block <highlight><bold>610</bold></highlight>, if the corresponding style has been used or redefined in the target document, the style in the target document will not be redefined to match the style of the selected text. In this case, the method branches from decision block <highlight><bold>610</bold></highlight> to step <highlight><bold>612</bold></highlight> and proceeds as described above. Notably, the pasted text will maintain its original style, but the style in the target document will not, nonetheless, be redefined. </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> Returning now to decision block <highlight><bold>608</bold></highlight>, if a determination is made that the corresponding style in the target document belongs to a style group, the method branches to decision block <highlight><bold>620</bold></highlight>. At decision block <highlight><bold>620</bold></highlight>, a determination is made as to whether any style in the style group has been used or redefined in the target document. If any style in the style group has been used or redefined in the target document, then it may be assumed that the user may want to retain the definitions of the styles in the style group. In this case, the method branches from decision block <highlight><bold>620</bold></highlight> to step <highlight><bold>612</bold></highlight> and proceeds as described above. If, on the other hand, no style in the style group has been used or redefined in the target document, the method branches from decision block <highlight><bold>620</bold></highlight> to step <highlight><bold>618</bold></highlight>. At step <highlight><bold>618</bold></highlight>, the corresponding style is set equal to the source document style, as described above. The method then proceeds to step <highlight><bold>612</bold></highlight> and the selected text is pasted in the paste point. </paragraph>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> Although the method of <cross-reference target="DRAWINGS">FIG. 6</cross-reference> describes maintaining the pasted text in its original style, it will be appreciated by those skilled in the art that the pasted text may be reconfigured to adopt the formatting properties of the corresponding style. This option may be selected by the user in a preferences file or may be selected by user using an OOUI, as described above on a case-by-case basis. Additionally, the methodof <cross-reference target="DRAWINGS">FIG. 6</cross-reference> may be modified within the scope of the present invention to include the step of displaying a recovery user interface to enable the selection of recovery actions associated with the performance of a particular paste action and/or style reformatting (e.g., after step <highlight><bold>612</bold></highlight>). In one embodiment of the present invention, one such recovery action includes negating an automatic application of a source document style and the application of a corresponding target document style to the pasted text or vice versa. </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a flow chart depicting an exemplary method for eliminating empty paragraphs from target and source documents. Often, a user will cut text from a source document for pasting into a target document, but will leave the source document with unwanted empty paragraphs. Additionally, when a user pastes text into a target document the user will often paste unwanted paragraphs into the target document. The method of <cross-reference target="DRAWINGS">FIG. 7</cross-reference> can determine when it is most likely that the user intended to eliminate an empty paragraph from either the selected (copied or cut) text or from the pasted text. </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> The method starts at step <highlight><bold>700</bold></highlight> and proceeds to step <highlight><bold>702</bold></highlight>. At step <highlight><bold>702</bold></highlight>, text is selected from the source document for cutting or copying. The method then proceeds to decision block <highlight><bold>704</bold></highlight>, wherein a determination is made as to whether the text selection was made by a copy action. If the text selection was made by a copying action, the method branches to step <highlight><bold>712</bold></highlight>. If, on the other hand, the text was not selected by a copying action (i.e., the text was selected by a cut action), the method branches to decision block <highlight><bold>706</bold></highlight>. </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> At decision block <highlight><bold>706</bold></highlight>, a determination is made as to whether the text was cut from the beginning or end of the source document. If the text was cut from either the beginning or the end of the source document, the method branches to step <highlight><bold>712</bold></highlight>. If, on the other hand, the text was not cut from either the beginning or the end of the source document, the method branches to decision block <highlight><bold>708</bold></highlight>. At decision block <highlight><bold>708</bold></highlight>, a determination is made as to whether the number or empty paragraphs between the closest non-empty paragraphs are more than a pre-defined threshold value. The pre-defined threshold value may simply be an estimate as to the number of empty paragraphs present in the source document that may indicate that the user intends to remove empty paragraphs from the source document by virtue of the cutting action. If the number of empty paragraphs is more than the pre-defined threshold value, the method branches to step <highlight><bold>712</bold></highlight>. If the number of empty paragraphs is less than or equal to the threshold value, the method branches to step <highlight><bold>710</bold></highlight>. </paragraph>
<paragraph id="P-0069" lvl="0"><number>&lsqb;0069&rsqb;</number> At step <highlight><bold>710</bold></highlight>, all empty paragraphs found between the cut point and the next (following) non-empty paragraph are eliminated from the source document. Naturally, this step is performed when a determination is made (by decision block <highlight><bold>708</bold></highlight>) that the user intended for the empty paragraphs to be removed from the source document. The method proceeds from step <highlight><bold>710</bold></highlight> to step <highlight><bold>712</bold></highlight>. At step <highlight><bold>712</bold></highlight>, the target document and paste point are determined. Typically, this will be performed by a user opening and/or instantiating a target document and selecting a paste point with a pointing device, such as a mouse. </paragraph>
<paragraph id="P-0070" lvl="0"><number>&lsqb;0070&rsqb;</number> The method proceeds from step <highlight><bold>712</bold></highlight> to decision block <highlight><bold>714</bold></highlight>. At decision block <highlight><bold>714</bold></highlight>, a determination is made as to whether the paste point is in a non-empty paragraph. If the paste point is not in a non-empty paragraph, the method branches to decision block <highlight><bold>724</bold></highlight>. At decision block <highlight><bold>724</bold></highlight>, a determination is made as to whether the paste point is at the beginning or the end of the target document. If the paste point is not at either the beginning or the end of the target document, the method branches to step <highlight><bold>726</bold></highlight>. At step <highlight><bold>726</bold></highlight>, the selected text (i.e., the copied text or the cut text) is pasted in the target document at the paste point and no paragraph adjustments are made to the text in the target document. The method proceeds from step <highlight><bold>726</bold></highlight> to step <highlight><bold>734</bold></highlight> and ends. </paragraph>
<paragraph id="P-0071" lvl="0"><number>&lsqb;0071&rsqb;</number> Returning now to decision block <highlight><bold>714</bold></highlight>, if a determination is made that the paste point is in a non-empty paragraph, the method branches to decision block <highlight><bold>716</bold></highlight>. At decision block <highlight><bold>716</bold></highlight>, a determination is made as to whether the selected text consists of only one paragraph. If the selected text consists of only one paragraph, the method branches to step <highlight><bold>726</bold></highlight> and proceeds as described above. If, on the other hand, a determination is made at decision block <highlight><bold>716</bold></highlight> that the selected text consists of more than one paragraph, the method branches to step <highlight><bold>718</bold></highlight>. At step <highlight><bold>718</bold></highlight>, a spacing adjustment is set equal to the number of empty paragraphs between the non-empty paragraph containing the paste point and a preceding non-empty paragraph. </paragraph>
<paragraph id="P-0072" lvl="0"><number>&lsqb;0072&rsqb;</number> The method proceeds from step <highlight><bold>718</bold></highlight> to decision block <highlight><bold>720</bold></highlight>. At decision block <highlight><bold>720</bold></highlight>, a determination is made as to whether the paste point is located in a list of the target document. If the paste point is located in a list, then the spacing adjustment is set to zero. The method proceeds from step <highlight><bold>722</bold></highlight> to step <highlight><bold>732</bold></highlight>. At step <highlight><bold>732</bold></highlight>, the selected text is pasted at the paste point and the target document and the number of paragraphs between each pasted non-empty paragraph is set to the spacing adjustment determined above (e.g., step <highlight><bold>718</bold></highlight>, step <highlight><bold>722</bold></highlight>). The method then proceeds to step <highlight><bold>734</bold></highlight> and ends. Notably, and an alternative embodiment, a determination can be made as to whether the spacing adjustment is greater than a predefined threshold value. If the spacing adjustment is greater than that pre-defined threshold value, the spacing adjustment can be set equal to the pre-defined threshold value. </paragraph>
<paragraph id="P-0073" lvl="0"><number>&lsqb;0073&rsqb;</number> Returning to decision block <highlight><bold>720</bold></highlight>, if a determination is made that the paste point is not in a list, the method branches to decision block <highlight><bold>728</bold></highlight>. At decision block <highlight><bold>728</bold></highlight>, a determination is made as to whether the selected text is itself a list. If a determination is made that the selected text is a list, a method branches to step <highlight><bold>726</bold></highlight> and the selected text is pasted as the paste point with no paragraph spacing adjustments. The method then proceeds to step <highlight><bold>734</bold></highlight> and ends. </paragraph>
<paragraph id="P-0074" lvl="0"><number>&lsqb;0074&rsqb;</number> If, on the other hand, a determination is made at decision block <highlight><bold>728</bold></highlight> that the selected text is not a list, the method branches to step <highlight><bold>732</bold></highlight>. At step <highlight><bold>732</bold></highlight>, the selected text is pasted in the target document at the paste point and the number of empty paragraphs between each pasted non-empty paragraph is set to the spacing adjustment determined above (i.e., step <highlight><bold>718</bold></highlight>). The method then proceeds to step <highlight><bold>734</bold></highlight> and ends. Returning now to decision block <highlight><bold>724</bold></highlight>, if a determination is made that the paste point is at the beginning or the end of the target document, the method branches from decision block <highlight><bold>724</bold></highlight> to step <highlight><bold>730</bold></highlight>. At step <highlight><bold>730</bold></highlight>, the spacing adjustment is set equal to the number of empty paragraphs between the first non-empty paragraph preceding the paste point and the first non-empty paragraph following the paste point. The method then proceeds to decision block <highlight><bold>720</bold></highlight> and proceeds as described above. </paragraph>
<paragraph id="P-0075" lvl="0"><number>&lsqb;0075&rsqb;</number> Step <highlight><bold>710</bold></highlight> is also performed when the method branches from decision blocks <highlight><bold>704</bold></highlight>, <highlight><bold>706</bold></highlight>, and <highlight><bold>708</bold></highlight>. If, at decision block <highlight><bold>704</bold></highlight>, a determination is made that the selected text was selected by way of a copy action, then the method branches to step <highlight><bold>712</bold></highlight> to determine the target document and paste point. Because no cutting action is involved, there is no need to perform step <highlight><bold>710</bold></highlight>, which eliminates empty paragraphs from the source document. Likewise, when a determination is made at decision block <highlight><bold>706</bold></highlight> that the selected text was cut from the beginning or end of the source document, an assumption is made that empty paragraphs need not be removed, and the method branches around step <highlight><bold>710</bold></highlight> to step <highlight><bold>712</bold></highlight>. Finally, where a determination is made at decision block <highlight><bold>708</bold></highlight> that the number of empty paragraphs between the closest (to the cut point) non-empty paragraphs is greater than the predefined threshold value, then an assumption is made that not empty paragraphs need to be removed. Thus, the method branches from decision block <highlight><bold>708</bold></highlight> to step <highlight><bold>712</bold></highlight>. </paragraph>
<paragraph id="P-0076" lvl="0"><number>&lsqb;0076&rsqb;</number> As described, the method of <cross-reference target="DRAWINGS">FIG. 7</cross-reference> analyzes the selected text from a source document, the selection action (e.g., cutting or copying), and the paste point in the target document to determine whether empty paragraphs should be eliminated from either document during a cut/copy and/or paste operation. When the selected text is at the beginning or end of the source document, the selected text will be cut from the source document without any paragraph elimination. Similarly, if the paste point is at the beginning or end of the target document, the selected text will be pasted without any empty paragraph elimination. The threshold values for cutting and/or pasting may be predetermined by a hard-coded configuration file, a configurable user preferences file, or an options dialog box. Essentially, however, the threshold value is simply an estimate as to the number of preceding or following paragraphs that will be recognized as an indication that a user intends for empty paragraphs to be present. </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a flow chart that depicts an exemplary method for merging and creating lists, in response to a paste operation. The method starts at <highlight><bold>800</bold></highlight> and proceeds to step <highlight><bold>802</bold></highlight>. At step <highlight><bold>802</bold></highlight>, the list text is selected for copying. List text is text that is an item in a numbered or bulleted list. The list text may be a portion of a list item (i.e.,not containing a paragraph mark) or an entire list item (i.e. containing at least one paragraph mark). </paragraph>
<paragraph id="P-0078" lvl="0"><number>&lsqb;0078&rsqb;</number> The method proceeds from step <highlight><bold>802</bold></highlight> to step <highlight><bold>804</bold></highlight>. At step <highlight><bold>804</bold></highlight>, the paste point is determined. Typically, the paste point will be determined by a user&apos;s defining an insertion point in a target document. The method proceeds from step <highlight><bold>804</bold></highlight> to decision block <highlight><bold>806</bold></highlight>. At decision block <highlight><bold>806</bold></highlight>, a determination is made as to whether the paste point is immediately preceded or followed by a list paragraph. That is, it is determined whether the paste point is next to a list item in a list. If the paste point is immediately preceded or followed by a list paragraph (i.e., list item), the method branches to step <highlight><bold>808</bold></highlight>. At step <highlight><bold>808</bold></highlight>, the selected list text is merged with the list in which the list paragraph resides. That is, the pasted text is made part of the existing list in the target document. Merging the selected text with the existing list may also include formatting the selected list text as the existing list is formatted. </paragraph>
<paragraph id="P-0079" lvl="0"><number>&lsqb;0079&rsqb;</number> The method proceeds from step <highlight><bold>808</bold></highlight> to step <highlight><bold>816</bold></highlight> and the selected text is pasted into the target document at the paste point as part of the existing list preceding or following the paste point. At step <highlight><bold>816</bold></highlight>, an assumption is made that the user intends for the pasted list text to be made part of the existing list. Those skilled in the art will appreciate that an alternative embodiment of the present invention could use another default assumption, such as making the pasted text a new, independent list. </paragraph>
<paragraph id="P-0080" lvl="0"><number>&lsqb;0080&rsqb;</number> The method proceeds from step <highlight><bold>816</bold></highlight> to step <highlight><bold>814</bold></highlight> and a recovery user interface is displayed. In one embodiment of the present invention, the recovery interface may provide the options to merge the pasted list text as part of the target document&apos;s existing list or to make the pasted list text a new, independent list. Of course, other recovery options also may be provided. The method proceeds from step <highlight><bold>814</bold></highlight> to decision block <highlight><bold>820</bold></highlight>. At decision block <highlight><bold>820</bold></highlight>, a determination is made as to whether a recovery selection is made. If a recovery selection is made, the method branches to step <highlight><bold>812</bold></highlight> and the selected recovery action is performed. In the example of <cross-reference target="DRAWINGS">FIG. 8</cross-reference>, step <highlight><bold>812</bold></highlight> formats the pasted text as a new, independent list as a recovery action corresponding to the default action performed in step <highlight><bold>816</bold></highlight> (pasting the selected text as a part of the original list). The method proceeds from step <highlight><bold>812</bold></highlight> to step <highlight><bold>818</bold></highlight> and ends. If a determination is made at decision block <highlight><bold>820</bold></highlight> that no recovery action is selected, the method branches to step <highlight><bold>818</bold></highlight> and ends. </paragraph>
<paragraph id="P-0081" lvl="0"><number>&lsqb;0081&rsqb;</number> Returning now to decision <highlight><bold>806</bold></highlight>, if a determination is made that the paste point is not immediately preceded or followed by a list paragraph, the method branches to step <highlight><bold>810</bold></highlight>, the selected list text is pasted at the paste point as a new, independent list. The method then proceeds to step <highlight><bold>818</bold></highlight> and ends. </paragraph>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a flow chart depicting an exemplary method for formatting a table, in response to copy and paste operation. The method of <cross-reference target="DRAWINGS">FIG. 9</cross-reference> starts at step <highlight><bold>900</bold></highlight> and proceeds to step <highlight><bold>902</bold></highlight>. At step <highlight><bold>902</bold></highlight>, table text is selected for copying or cutting (collectively, copying). Table text is any text that is at least part of a table in a source document. Tables are typically divided into columns and rows of cells. Oftentimes, when table text is copied and pasted, it is difficult to determine whether it is intended to be pasted as a new table, part of an existing table, or simply as non-table text. The method of <cross-reference target="DRAWINGS">FIG. 9</cross-reference> automatically selects between these options, based on the location of the selected table text, the paste point and the actions of the user with respect to a recovery user interface. </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> The method proceeds from step <highlight><bold>902</bold></highlight> to step <highlight><bold>904</bold></highlight>. In step <highlight><bold>904</bold></highlight>, the paste point is determined. Typically, the paste point will be determined by the user&apos;s placement of an insertion point cursor in the target document. The method proceeds from step <highlight><bold>904</bold></highlight> to decision block <highlight><bold>906</bold></highlight>. At decision block <highlight><bold>906</bold></highlight>, a determination is made as to whether the paste point is an immediately preceded or followed by a table. If the paste point is not immediately preceded or followed by a table, the method branches to decision block <highlight><bold>908</bold></highlight>. At decision block <highlight><bold>908</bold></highlight>, a determination is made as to whether the paste point is within a table. If the paste point is not within a table, the method branches to step <highlight><bold>910</bold></highlight>. At step <highlight><bold>910</bold></highlight>, a determination is made as to whether the selected table text is a single cell. If the selected table text is not a single cell, the method branches to step <highlight><bold>920</bold></highlight> and ends. </paragraph>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> Returning now to decision block <highlight><bold>906</bold></highlight>, if a determination is made that the paste location is immediately preceded or followed by a table, the method branches to decision block <highlight><bold>912</bold></highlight>. At decision block <highlight><bold>912</bold></highlight>, a determination is made as to whether the selected table text and the preceding or following table have the same number of columns. If the selected table text and the existing table do not have the same number of columns, the method branches from decision block <highlight><bold>912</bold></highlight> to step <highlight><bold>918</bold></highlight>. At step <highlight><bold>918</bold></highlight>, the selected table text is pasted at the paste point and is formatted as the target table is formatted. The method then proceeds from step <highlight><bold>918</bold></highlight> to step <highlight><bold>920</bold></highlight> and ends. </paragraph>
<paragraph id="P-0085" lvl="0"><number>&lsqb;0085&rsqb;</number> Returning now to decision block <highlight><bold>912</bold></highlight>, if a determination is made that the selected table text and the existing table have the same number of columns, the method branches to step <highlight><bold>914</bold></highlight>. At step <highlight><bold>914</bold></highlight> the selected table text is merged with the target table. The merger of the table elements creates a single table and pasted table text will have the same table formatting as the existing table. The method proceeds from step <highlight><bold>914</bold></highlight> to <highlight><bold>916</bold></highlight>. At decision block <highlight><bold>916</bold></highlight>, a determination is made as to whether a recovery action has been selected. Typically, the recovery action will be made available via an OOUI (not shown). If no recovery action is selected, the method branches from decision block <highlight><bold>916</bold></highlight> to step <highlight><bold>920</bold></highlight> and ends. If, on the other hand, the user selects a recovery action, the method will branch to step <highlight><bold>918</bold></highlight> and the selected table text will be pasted in the paste point as originally formatted. Thus, the table merger of step <highlight><bold>914</bold></highlight> will be overridden by the selection of the recovery action. The method proceeds from step <highlight><bold>918</bold></highlight> to <highlight><bold>920</bold></highlight> and ends. </paragraph>
<paragraph id="P-0086" lvl="0"><number>&lsqb;0086&rsqb;</number> Returning now to step <highlight><bold>908</bold></highlight>, if a determination is made that the paste point is within an existing table, the method branches to step <highlight><bold>926</bold></highlight>. At step <highlight><bold>926</bold></highlight>, the selected table is pasted in the pasted location as a nested table. That is, the pasted table text will be an independent table within the existing table. Notably, the selected table text will be pasted as it was originally formatted in the source document. The method proceeds from step <highlight><bold>926</bold></highlight> to step <highlight><bold>928</bold></highlight>. At step <highlight><bold>928</bold></highlight>, a recovery user interface (e.g., an OOUI) is displayed. The method then proceeds to decision block <highlight><bold>930</bold></highlight>. At decision block <highlight><bold>930</bold></highlight>, a determination is made as to whether the user selects a recovery action from the recovery user interface. If no recovery selection is made, the method branches to step <highlight><bold>946</bold></highlight> and ends. If, on the other hand a determination is made at decision <highlight><bold>930</bold></highlight> that a recovery action has been selected, the method branches to decision block <highlight><bold>934</bold></highlight>. </paragraph>
<paragraph id="P-0087" lvl="0"><number>&lsqb;0087&rsqb;</number> At decision block <highlight><bold>934</bold></highlight>, a determination is made as to whether the merge table recovery action has been selected. If the merge table recovery action has been selected, the method branches from decision block <highlight><bold>934</bold></highlight> to step <highlight><bold>948</bold></highlight>. At step <highlight><bold>948</bold></highlight>, the selected table text is merged with the existing table (i.e., the target table). As described above, the selected table text will be formatted in accordance with the target table. The method then proceeds to step <highlight><bold>946</bold></highlight> and ends. </paragraph>
<paragraph id="P-0088" lvl="0"><number>&lsqb;0088&rsqb;</number> Returning now to decision block <highlight><bold>934</bold></highlight>, if a determination is made at decision block <highlight><bold>934</bold></highlight> that the merge table recovery action has not been selected, the method branches to decision block <highlight><bold>936</bold></highlight>. At decision block <highlight><bold>936</bold></highlight>, a determination is made as to whether the insert as new rows recovery action is selected by the user. If the insert as new rows recovery action is selected by the user, the method branches to step <highlight><bold>924</bold></highlight>. At step <highlight><bold>924</bold></highlight>, the selected table text is inserted within the target table as new rows. Obviously, the columns may or may not line up with the columns of the columns of the target table. The method proceeds from step <highlight><bold>924</bold></highlight> to step <highlight><bold>920</bold></highlight> and ends. </paragraph>
<paragraph id="P-0089" lvl="0"><number>&lsqb;0089&rsqb;</number> Notably, if a determination is made at decision block <highlight><bold>936</bold></highlight> that the insert as new rows recovery action has not been selected, the method branches from decision block <highlight><bold>936</bold></highlight> to step <highlight><bold>922</bold></highlight>. At step <highlight><bold>922</bold></highlight> the selected table text is pasted into the target table by overwriting existing cells. The method proceeds from step <highlight><bold>922</bold></highlight> to <highlight><bold>920</bold></highlight> and ends. </paragraph>
<paragraph id="P-0090" lvl="0"><number>&lsqb;0090&rsqb;</number> Returning now to decision block <highlight><bold>910</bold></highlight>, if a determination is made that the selected table text is a single cell, the method branches to step <highlight><bold>938</bold></highlight>. At step <highlight><bold>938</bold></highlight>, the cell contents are pasted as regular text at the paste point. The method proceeds to step <highlight><bold>940</bold></highlight>, wherein a recovery user interface is displayed. The method proceeds from step <highlight><bold>940</bold></highlight> to decision block <highlight><bold>942</bold></highlight>. At decision block <highlight><bold>942</bold></highlight>, a determination is made as to whether a recovery action is selected. If no recovery action is selected, the method branches to step <highlight><bold>946</bold></highlight> and ends. On the other hand, if a recovery action is selected, the method branches to step <highlight><bold>944</bold></highlight>. At step <highlight><bold>944</bold></highlight>, the cell is pasted as a single cell table. The method proceeds from step <highlight><bold>944</bold></highlight> to <highlight><bold>946</bold></highlight> and ends. </paragraph>
<paragraph id="P-0091" lvl="0"><number>&lsqb;0091&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a flow chart depicting an exemplary method for pasting spreadsheet elements. The method of <cross-reference target="DRAWINGS">FIG. 10</cross-reference> starts at step <highlight><bold>1000</bold></highlight> and proceeds to step <highlight><bold>1002</bold></highlight>. At step <highlight><bold>1002</bold></highlight>, at least a portion of a spreadsheet table is selected for copying or cutting (collectively, copying). The spreadsheet table may be in a document hosted by a spreadsheet application program (such as Microsoft Excel, marketed and manufactured by Microsoft Corporation of Redmond, Wash.) or may be a spreadsheet object embedded in a source document. In either case, the spreadsheet functionality may be imported into the target document maintaining a link with the spreadsheet. On the other hand, a non-functional spreadsheet table of values may be pasted into the target document. </paragraph>
<paragraph id="P-0092" lvl="0"><number>&lsqb;0092&rsqb;</number> The method proceeds from step <highlight><bold>1002</bold></highlight> to step <highlight><bold>1004</bold></highlight>. At step <highlight><bold>1004</bold></highlight>, a paste point is determined. Typically the paste point is determined by the user defining an insertion point in the target document. The method proceeds from step <highlight><bold>1004</bold></highlight> to decision block <highlight><bold>1006</bold></highlight>. At decision block <highlight><bold>1006</bold></highlight>, a determination is made as to whether the selected table has been imported from a spreadsheet. If the table has not been imported from a spreadsheet, then the method branches to step <highlight><bold>1030</bold></highlight> and the spreadsheet is simple pasted as a table with the default formatting of the target document. On the other hand, if a determination is made at decision block <highlight><bold>1006</bold></highlight> that the selected table is imported from a spreadsheet, the method branches to decision block <highlight><bold>1008</bold></highlight>. At decision block <highlight><bold>1008</bold></highlight>, a determination is made as to whether the selected table is a single cell table. If the selected table is not a single cell table, the method branches to step <highlight><bold>1010</bold></highlight>. At step <highlight><bold>1010</bold></highlight>, the spreadsheet is pasted in the target document as a table with its original formatting. The method then proceeds to step <highlight><bold>1014</bold></highlight>. </paragraph>
<paragraph id="P-0093" lvl="0"><number>&lsqb;0093&rsqb;</number> Returning now to decision block <highlight><bold>1008</bold></highlight>, if a determination is made that the selected table is a single cell table, a method branches to step <highlight><bold>1012</bold></highlight>. At step <highlight><bold>1012</bold></highlight>, the cell contents are simple pasted in the target document as text. The method then proceeds to step <highlight><bold>1014</bold></highlight>. At step <highlight><bold>1014</bold></highlight>, a recovery user interface is displayed. The method then proceeds to decision block <highlight><bold>1016</bold></highlight>. At decision block <highlight><bold>1016</bold></highlight>, a determination is made as to whether a match target table style recovery action is selected from the recovery user interface. If the matched target table style recovery action is selected, the method branches from decision block <highlight><bold>1016</bold></highlight> to step <highlight><bold>1024</bold></highlight>. At step <highlight><bold>1024</bold></highlight>, the spreadsheet table is pasted as a table with the default formatting of the target document then proceeds to step <highlight><bold>1022</bold></highlight> and ends. </paragraph>
<paragraph id="P-0094" lvl="0"><number>&lsqb;0094&rsqb;</number> If at decision block <highlight><bold>1016</bold></highlight>, a determination is made that the user has not selected the matched target table style recovery action, the method branches to decision block <highlight><bold>1018</bold></highlight>. At decision block <highlight><bold>1018</bold></highlight> a determination is made as to whether the user has selected the keep text only recovery action. If the user has selected the keep text only recovery action, the method branches to step <highlight><bold>1026</bold></highlight>. At step <highlight><bold>1026</bold></highlight>, the spreadsheet table is pasted as unformatted text. The method then proceeds to step <highlight><bold>1022</bold></highlight> and ends. If, on the other hand, at decision block <highlight><bold>1018</bold></highlight> a determination is made that the user has not selected the keep text only recovery action, the method branches to decision block <highlight><bold>1020</bold></highlight>. At decision block <highlight><bold>1020</bold></highlight>, a determination is made as to whether the user has selected the keep source formatting with link recovery action. If the user has selected this recovery action, the method branches to step <highlight><bold>1028</bold></highlight>. At step <highlight><bold>1028</bold></highlight>, the spreadsheet table is pasted as a table with its original formatting and with a link to the original spreadsheet table. This link will maintain the functionality of the spreadsheet within the target document so that changes to the original spreadsheet will be reflected in the pasted spreadsheet table. The method then proceeds to step) <highlight><bold>1022</bold></highlight> and ends. If at decision block <highlight><bold>1020</bold></highlight>, a determination is made that the user has not selected the keep source formatting with link recovery action, the method branches to decision block <highlight><bold>1032</bold></highlight>. </paragraph>
<paragraph id="P-0095" lvl="0"><number>&lsqb;0095&rsqb;</number> At decision block <highlight><bold>1032</bold></highlight>, a determination is made as to whether the user has selected the match target table formatting with link recovery action. If the user has selected this recovery action, the method branches to step <highlight><bold>1030</bold></highlight>. At step <highlight><bold>1030</bold></highlight>, the spreadsheet table as pasted as a table with the default formatting of the target document. The method then proceeds to step <highlight><bold>1022</bold></highlight> and ends. </paragraph>
<paragraph id="P-0096" lvl="0"><number>&lsqb;0096&rsqb;</number> If at decision block <highlight><bold>1032</bold></highlight>, a determination is made that the user has not selected the match target table formatting with link recovery action, the method branches to decision block <highlight><bold>1034</bold></highlight>. At decision block <highlight><bold>1034</bold></highlight>, a determination is made as to whether the apply style or formatting recovery action has been selected. If this recovery action has been selected, the method branches to step <highlight><bold>1036</bold></highlight>. At step <highlight><bold>1036</bold></highlight>, a formatting user interface is displayed with which the user may format the selected table text. A detailed description of the formatting user interface is described in a co-pending U.S. patent application Ser. No. ______ , (Attorney Docket No.: 60001.0046US01) also assigned to Microsoft Corporation of Redmond, Wash. That patent application is entitled &ldquo;INTERACTIVE FORMATTING INTERFACE&rdquo; and is hereby incorporated by reference. The method of <cross-reference target="DRAWINGS">FIG. 10</cross-reference> proceeds from step <highlight><bold>1036</bold></highlight> to step <highlight><bold>1038</bold></highlight> and ends. Returning to decision block <highlight><bold>1034</bold></highlight>, if a determination is made that the user has not selected the apply style or formatting recovery action, then it is assumed that the user has not selected a recovery action in the method branches to step <highlight><bold>1038</bold></highlight> and ends. </paragraph>
<paragraph id="P-0097" lvl="0"><number>&lsqb;0097&rsqb;</number> In an alternative embodiment of the present invention, the methods of <cross-reference target="DRAWINGS">FIGS. 9 and 10</cross-reference> can be integrated, such that the pasting of a spreadsheet table (<cross-reference target="DRAWINGS">FIG. 10</cross-reference>) can be processed identically as any other table processed according to the method of <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. In this embodiment, the method of <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is modified to follow the &ldquo;NO&rdquo; branch from decision block <highlight><bold>1006</bold></highlight> to step <highlight><bold>904</bold></highlight> of the method of <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. The method of <cross-reference target="DRAWINGS">FIG. 10</cross-reference> could be further modified by following the &ldquo;YES&rdquo; branch from decision block <highlight><bold>1006</bold></highlight> to a new decision block that determines whether the paste point is immediately preceded or followed by a table. If it is determined that the paste point is immediately preceded or followed by a table, then the method of this embodiment would branch to step <highlight><bold>926</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. If it is determined that the paste point is not immediately preceded or followed by a table, then the method would branch to a second new decision block, wherein a determination is made as to whether the paste point is within a table. If the paste point is within a table, the method branches to step <highlight><bold>938</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. If the paste point is not within a table, then the method branches to step <highlight><bold>1008</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 10</cross-reference>. </paragraph>
<paragraph id="P-0098" lvl="0"><number>&lsqb;0098&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is flow chart depicting an exemplary method for automatically adjusting the formatting of pasted text. Like the method depicted in <cross-reference target="DRAWINGS">FIG. 6</cross-reference>, the method of <cross-reference target="DRAWINGS">FIG. 11</cross-reference> provides automatic format adjustment for pasted text. However, the method of <cross-reference target="DRAWINGS">FIG. 11</cross-reference> also provides a recovery user interface that allows the reversal of an automatic formatting. </paragraph>
<paragraph id="P-0099" lvl="0"><number>&lsqb;0099&rsqb;</number> The method of <cross-reference target="DRAWINGS">FIG. 11</cross-reference> starts at step <highlight><bold>1100</bold></highlight> and proceeds to step <highlight><bold>1102</bold></highlight>. At step <highlight><bold>1102</bold></highlight>, text is selected for a copying or cutting. The method then proceeds to step <highlight><bold>1104</bold></highlight>. At step <highlight><bold>1104</bold></highlight>, the paste point is determined. The method then proceeds from step <highlight><bold>1104</bold></highlight> to decision block <highlight><bold>1106</bold></highlight>. </paragraph>
<paragraph id="P-0100" lvl="0"><number>&lsqb;0100&rsqb;</number> At decision block <highlight><bold>1106</bold></highlight>, a determination is made as to whether the selected text has an associated style that has been used and/or modified in the target document. If the selected text has such a style, the method branches to step <highlight><bold>1110</bold></highlight>. At step <highlight><bold>1110</bold></highlight>, the text is pasted at the paste point with the style of the target document. Any direct formatting that has been applied to the pasted text (in the source document) is retained. The method proceeds from step <highlight><bold>1110</bold></highlight> to step <highlight><bold>1114</bold></highlight>. If at decision block <highlight><bold>1106</bold></highlight>, a determination is made that the selected text is not associated with a style that has been used or modified in the target document, the method branches to step <highlight><bold>112</bold></highlight>. At step <highlight><bold>1112</bold></highlight>, the selected text is pasted at the paste point with the style of the source document and all direct formatting is retained. The method then proceeds to step <highlight><bold>1114</bold></highlight>. </paragraph>
<paragraph id="P-0101" lvl="0"><number>&lsqb;0101&rsqb;</number> At step <highlight><bold>1114</bold></highlight>, a recovery user interface is displayed. The method proceeds from step <highlight><bold>1114</bold></highlight> to decision block <highlight><bold>1116</bold></highlight>. At decision block <highlight><bold>1116</bold></highlight>, a determination is made as to whether the match target document styles recovery action is selected from the recovery user interface. If the matched target document styles recovery action is selected, the method branches to step <highlight><bold>1124</bold></highlight>. At step <highlight><bold>1124</bold></highlight>, the selected text is pasted at the paste point with the style of the target document and all direct formatting is retained. The method then proceeds to step <highlight><bold>1122</bold></highlight> and ends. </paragraph>
<paragraph id="P-0102" lvl="0"><number>&lsqb;0102&rsqb;</number> If at decision block <highlight><bold>1116</bold></highlight>, a determination is made that the match target document styles recovery action is not selected, the method branches to decision block <highlight><bold>1118</bold></highlight>. At decision block <highlight><bold>1118</bold></highlight>, a determination is made as to whether the keep source styles recovery option is selected. If this recovery option is selected, the method branches to step <highlight><bold>1126</bold></highlight>. At step <highlight><bold>1126</bold></highlight>, the selected text is pasted at the paste point with the style of the source document and all direct formatting is retained. The method then proceeds to step <highlight><bold>1122</bold></highlight> and ends. </paragraph>
<paragraph id="P-0103" lvl="0"><number>&lsqb;0103&rsqb;</number> If at decision block <highlight><bold>1118</bold></highlight>, a determination is made that the keep source styles recovery action is not selected, the method branches to decision block <highlight><bold>1120</bold></highlight>. At decision block <highlight><bold>1120</bold></highlight>, a determination is made as to whether the keep text only recovery action has been selected. If this recovery action has been selected, the method branches to step <highlight><bold>1128</bold></highlight> and the selected text is pasted at the paste point as unformatted text. The method then proceeds to step <highlight><bold>1122</bold></highlight> and ends. </paragraph>
<paragraph id="P-0104" lvl="0"><number>&lsqb;0104&rsqb;</number> If a determination is made as decision block <highlight><bold>112</bold></highlight>O that the keep text only recovery action had not been selected, the method branches to decision block <highlight><bold>1130</bold></highlight>. At decision block <highlight><bold>1130</bold></highlight>, a determination is made as to whether the apply style or formatting recovery action has been selected. If this recovery action has been selected, the method proceeds to step <highlight><bold>1132</bold></highlight>. If this recovery action has not been selected, the method branches to step <highlight><bold>1134</bold></highlight> and ends. At step <highlight><bold>1132</bold></highlight>, the formatting user interface described above in connection with <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is displayed. This user interface allows the user to format the selected text as desired. The method proceeds from step <highlight><bold>1132</bold></highlight> to step <highlight><bold>1134</bold></highlight> and ends. </paragraph>
<paragraph id="P-0105" lvl="0"><number>&lsqb;0105&rsqb;</number> The method of <cross-reference target="DRAWINGS">FIG. 11</cross-reference> also could be modified to include other recovery options in addition to the recovery actions provided by step <highlight><bold>1124</bold></highlight> (matching the styles of the target document), step <highlight><bold>1126</bold></highlight> (keeping source formatting), and step <highlight><bold>1128</bold></highlight> (keeping the source text only). For example, a recovery action that preserves the styles of the source document could be added (like step <highlight><bold>1112</bold></highlight>). Those skilled in the art will appreciate that various recovery options could be added to the recovery user interface within the scope of the present invention. </paragraph>
<paragraph id="P-0106" lvl="0"><number>&lsqb;0106&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a flow chart depicting an exemplary method for pasting a spreadsheet chart into a document. The method of <cross-reference target="DRAWINGS">FIG. 12</cross-reference> starts at step <highlight><bold>1200</bold></highlight> and proceeds to step <highlight><bold>1202</bold></highlight>, the spreadsheet chart is selected for copying. A spreadsheet chart is generally a graphical representation of data in a spreadsheet. If the spreadsheet chart is pasted as an object or with a link, the spreadsheet chart may retain its functionality. If the spreadsheet chart is pasted as a picture, the original values will be retained, but the functionality of the chart will not be retained. </paragraph>
<paragraph id="P-0107" lvl="0"><number>&lsqb;0107&rsqb;</number> The method proceeds from step <highlight><bold>1202</bold></highlight> to <highlight><bold>1204</bold></highlight>. At step <highlight><bold>1204</bold></highlight>, a paste point is determined. The method then proceeds to step <highlight><bold>1206</bold></highlight>. At step <highlight><bold>1206</bold></highlight>, the spreadsheet chart is pasted into the target document as a picture. The method proceeds from step <highlight><bold>1206</bold></highlight> to step <highlight><bold>1208</bold></highlight>. </paragraph>
<paragraph id="P-0108" lvl="0"><number>&lsqb;0108&rsqb;</number> At step <highlight><bold>1208</bold></highlight>, a recovery user interface is displayed. The method proceeds to decision block <highlight><bold>1210</bold></highlight>, wherein a determination is made as to whether the paste as object recovery action has been selected from the recovery user interface. If this recovery action has been selected, the method branches to step <highlight><bold>1216</bold></highlight>. If this recovery action has not been selected, the method branches to decision block <highlight><bold>1212</bold></highlight>. At step <highlight><bold>1216</bold></highlight>, the spreadsheet chart is pasted into the target document as an object. Those skilled in the art will appreciate that an object will maintain all or portion of the functionality of the application program in which the spreadsheet chart was created. The method proceeds from step <highlight><bold>1216</bold></highlight> to <highlight><bold>1214</bold></highlight> and ends. </paragraph>
<paragraph id="P-0109" lvl="0"><number>&lsqb;0109&rsqb;</number> If a determination is made at decision block <highlight><bold>1210</bold></highlight> that the paste as object recovery action has not been selected, the method branches to decision block <highlight><bold>1212</bold></highlight>. At decision block <highlight><bold>1212</bold></highlight>, a determination is made as to whether the paste as object with link recovery action has been selected. If this recovery action has been selected, the method branches to step <highlight><bold>1218</bold></highlight>. If this recovery action has not been selected, the method branches to step <highlight><bold>1214</bold></highlight> and ends. At step <highlight><bold>1218</bold></highlight>, the spreadsheet chart is pasted as an object with a link to the original spreadsheet. The link will insure that changes to the original spreadsheet will be reflected in the pasted spreadsheet chart. The method proceeds from step <highlight><bold>1218</bold></highlight> to step <highlight><bold>1214</bold></highlight> and ends. </paragraph>
<paragraph id="P-0110" lvl="0"><number>&lsqb;0110&rsqb;</number> Although the present invention has been described in connection with various exemplary embodiments, those of ordinary skill in the art will understand that many modifications can be made thereto within the scope of the claims that follow. For example, although the embodiments of the present invention have been described in which the formatting component and formatting rules component are independent components, those skilled in the art will appreciate that the invention may be implemented such that these components are integral parts of the document editor. Accordingly, it is not intended that the scope of the invention in any way be limited by the above description, but instead be determined entirely by reference to the claims that follow. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is claimed is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. A system for formatting a document, comprising: 
<claim-text>a source document having at least one document element; </claim-text>
<claim-text>a target document; </claim-text>
<claim-text>a formatting component operative to copy the document element from the source document and to paste the document element into the target document; and </claim-text>
<claim-text>a formatting rules component containing at least one formatting rule, an associated formatting action, and an associated recovery action; </claim-text>
<claim-text>wherein the formatting component formats the document element in accordance with the formatting action, in response to a determination that the formatting rule has been triggered; and </claim-text>
<claim-text>wherein the formatting component performs the recovery action, in response to receiving a recovery selection. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. A method for formatting a document element, the method comprising: 
<claim-text>determining the selection of the document element in a source document; </claim-text>
<claim-text>determining whether a first formatting rule applies to the selection of the document element; </claim-text>
<claim-text>formatting the document element in response to a determination that the first formatting rule applies to the selection of the document element; </claim-text>
<claim-text>determining the selection of a paste point; </claim-text>
<claim-text>determining whether a second formatting rule applies to the selection of the paste point; </claim-text>
<claim-text>formatting the document element in response to a determination that the second formatting rule applies to the selection of the document element; and </claim-text>
<claim-text>pasting the document element into a target document. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00002">claim 2</dependent-claim-reference>, further comprising the steps of: 
<claim-text>displaying an available recovery action; </claim-text>
<claim-text>determining whether the available recovery action has been selected; and </claim-text>
<claim-text>re-formatting the document element in accordance with the recovery action, in response to the determination that the recovery action has been selected. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. A method for adding and eliminating a paragraph mark from a document element selected from a paragraph in a source document, the method comprising: 
<claim-text>determining the selection of the document element; </claim-text>
<claim-text>determining the portion of the paragraph represented by the document element; </claim-text>
<claim-text>determining whether a first paragraph mark is included in the document element; </claim-text>
<claim-text>determining whether a selection action indicates a desire to select the entire paragraph; </claim-text>
<claim-text>adding a second paragraph mark to the document element, in response to a determination that the entire paragraph has been selected and that the first paragraph mark has not been included in the document element; </claim-text>
<claim-text>eliminating the first paragraph mark from the document element, in response to a determination that the entire paragraph has been selected and that the selection action does not indicate a desire to select the entire paragraph. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00004">claim 4</dependent-claim-reference>, wherein the selection of the document element includes an instruction to copy the document element. </claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00004">claim 4</dependent-claim-reference>, wherein the selection of the document element includes an instruction to cut the document element. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00004">claim 4</dependent-claim-reference>, wherein the determination of whether the selection action indicates a desire to select the entire paragraph comprises determining whether the selection cursor has been moved in a leftward direction. </claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. A method for eliminating a paragraph mark from a document element selected from a source document, the method comprising: 
<claim-text>determining the selection of the document element in the source document; </claim-text>
<claim-text>determining a paste point in a target document; </claim-text>
<claim-text>determining whether a first paragraph mark is included in the document element; </claim-text>
<claim-text>determining whether the paste point is within a second paragraph in the target document; and </claim-text>
<claim-text>eliminating the first paragraph mark from the document element, in response to a determination that the paste point is within the second paragraph in the target document and that the first paragraph mark is included in the document element. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00008">claim 8</dependent-claim-reference>, further comprising the steps of: 
<claim-text>determining whether the document element is a list item; </claim-text>
<claim-text>determining whether the paste point is within a list in the target document; and </claim-text>
<claim-text>eliminating the first paragraph mark from the document element, in response to a determination that the paste point is within the list in the target document, that the first paragraph mark is included in the document element, and that the document element is not a list item. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. A method for defining a formatting style in a target document, the method comprising the steps of: 
<claim-text>determining the selection of the document element in the source document, the document element having an associated formatting style; </claim-text>
<claim-text>determining a paste point in a target document, the target document having a corresponding formatting style; </claim-text>
<claim-text>receiving an instruction to paste the document element in the target document at the paste point; </claim-text>
<claim-text>determining whether the corresponding formatting style and the associated formatting style are identical; </claim-text>
<claim-text>determining whether the corresponding formatting style has been used or redefined in the target document; </claim-text>
<claim-text>defining the corresponding formatting style to be identical to the associated formatting style, in response to a determination that the corresponding formatting style and the associated formatting style are not identical and that the corresponding formatting style has been used or redefined in the target document. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 10</dependent-claim-reference>, further comprising the steps of: 
<claim-text>pasting the document element in the target document at the paste point; </claim-text>
<claim-text>applying the associated style to the pasted document element; and </claim-text>
<claim-text>renaming the associated style, in response to a determination that the corresponding formatting style has been used or redefined in the target document and that the corresponding formatting style and the associated formatting style are not identical. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 10</dependent-claim-reference>, further comprising the steps of: 
<claim-text>determining whether the corresponding formatting style belongs to a formatting style group; </claim-text>
<claim-text>determining whether a member formatting style in the formatting style group has been used or redefined in the target document; </claim-text>
<claim-text>applying the associated style to the pasted document element; and renaming the associated style, in response to a determination that the member formatting style in the formatting style group has been used or redefined in the target document and that the corresponding formatting style and the associated formatting style are not identical. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. A method for eliminating empty paragraphs from a document, the method comprising the steps of: 
<claim-text>determining the selection of a document element in a source document; </claim-text>
<claim-text>determining a first number of preceding empty paragraphs adjacent to the document element; </claim-text>
<claim-text>determining a first number of following empty paragraphs adjacent to the document element; </claim-text>
<claim-text>determining a total of the first number of preceding empty paragraphs and the first number of preceding empty paragraphs; </claim-text>
<claim-text>eliminating the following empty paragraphs from the source document, in response to a determination that the total is less than a first predetermined threshold value. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 13</dependent-claim-reference>, further comprising the steps of: 
<claim-text>determining a paste point in a target document; </claim-text>
<claim-text>determining a second number of preceding empty paragraphs adjacent to the paste point; </claim-text>
<claim-text>determining a second number of following empty paragraphs adjacent to the paste point; </claim-text>
<claim-text>determining a total of the second number of preceding empty paragraphs and the second number of preceding empty paragraphs; </claim-text>
<claim-text>eliminating at least one following empty paragraphs from the target document, in response to a determination that the total is less than a second predetermined threshold value. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. A method for merging and creating a list, the method comprising: 
<claim-text>determining the selection of a document element in a source document; </claim-text>
<claim-text>determining a paste point in a target document; </claim-text>
<claim-text>determining whether the document element is a first list item; </claim-text>
<claim-text>determining whether the paste point is adjacent to a second list item in a first list in the target document; </claim-text>
<claim-text>pasting the document element as a third list item in the first list, in response to a determination that the document element is the first list item and that the paste point is adjacent to the second list item in the first list in the target document. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference>, further comprising the following steps: 
<claim-text>displaying a recovery action user interface; and </claim-text>
<claim-text>removing the third list item from the first list and pasting the document element as a first item in a second list, in response to receiving a recovery action selection. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. A method for formatting a table in a target document, the method comprising the steps of: 
<claim-text>determining the selection of a document element in a source document; </claim-text>
<claim-text>determining whether the document element is a first table item; </claim-text>
<claim-text>determining a paste point in a target document; </claim-text>
<claim-text>determining whether the paste point is adjacent to a first table in the target document; </claim-text>
<claim-text>merging the document element with the first table, in response to a determination that the document element is the first table item and that the paste point is adjacent to the first table in the target document. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 17</dependent-claim-reference>, further comprising the steps of: 
<claim-text>displaying a recovery action user interface; and </claim-text>
<claim-text>removing the document element from the first table and pasting the document element as an independent table in the target document, in response to receiving a recovery action selection. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 17</dependent-claim-reference>, further comprising the steps of: 
<claim-text>determining whether the paste point is within the first table in the target document; </claim-text>
<claim-text>pasting the document element into the first table as a nested table, in response to a determination that the document element is the first table item and that the paste point is within the first table in the target document. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 17</dependent-claim-reference>, further comprising the steps of: 
<claim-text>determining whether the document element is a single table cell; </claim-text>
<claim-text>pasting the document element into the target document as a non-table text item, in response to a determination that the document element is the single table cell. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00021">
<claim-text><highlight><bold>21</bold></highlight>. A method for pasting spreadsheet elements, the method comprising: 
<claim-text>determining the selection of a spreadsheet element having a first set of formatting properties in a source document; </claim-text>
<claim-text>determining a paste point in a target document; </claim-text>
<claim-text>pasting the spreadsheet element as a table in the target document with the first set of formatting properties applied thereto; </claim-text>
<claim-text>displaying a recovery action user interface; and </claim-text>
<claim-text>removing the table from the target document and pasting the spreadsheet element as a table in the target document with a second set of formatting properties applied thereto.</claim-text>
</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>1</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030004957A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030004957A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030004957A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030004957A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030004957A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030004957A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030004957A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030004957A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030004957A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00009">
<image id="EMI-D00009" file="US20030004957A1-20030102-D00009.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00010">
<image id="EMI-D00010" file="US20030004957A1-20030102-D00010.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00011">
<image id="EMI-D00011" file="US20030004957A1-20030102-D00011.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00012">
<image id="EMI-D00012" file="US20030004957A1-20030102-D00012.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
