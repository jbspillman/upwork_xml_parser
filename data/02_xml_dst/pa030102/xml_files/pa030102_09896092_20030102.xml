<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030004428A1-20030102-D00000.TIF SYSTEM "US20030004428A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00001.TIF SYSTEM "US20030004428A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00002.TIF SYSTEM "US20030004428A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00003.TIF SYSTEM "US20030004428A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00004.TIF SYSTEM "US20030004428A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00005.TIF SYSTEM "US20030004428A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00006.TIF SYSTEM "US20030004428A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00007.TIF SYSTEM "US20030004428A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00008.TIF SYSTEM "US20030004428A1-20030102-D00008.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00009.TIF SYSTEM "US20030004428A1-20030102-D00009.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00010.TIF SYSTEM "US20030004428A1-20030102-D00010.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00011.TIF SYSTEM "US20030004428A1-20030102-D00011.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00012.TIF SYSTEM "US20030004428A1-20030102-D00012.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00013.TIF SYSTEM "US20030004428A1-20030102-D00013.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00014.TIF SYSTEM "US20030004428A1-20030102-D00014.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00015.TIF SYSTEM "US20030004428A1-20030102-D00015.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00016.TIF SYSTEM "US20030004428A1-20030102-D00016.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00017.TIF SYSTEM "US20030004428A1-20030102-D00017.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00018.TIF SYSTEM "US20030004428A1-20030102-D00018.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00019.TIF SYSTEM "US20030004428A1-20030102-D00019.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00020.TIF SYSTEM "US20030004428A1-20030102-D00020.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00021.TIF SYSTEM "US20030004428A1-20030102-D00021.TIF" NDATA TIF>
<!ENTITY US20030004428A1-20030102-D00022.TIF SYSTEM "US20030004428A1-20030102-D00022.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030004428</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>09896092</doc-number>
</application-number>
<application-number-series-code>09</application-number-series-code>
<filing-date>20010628</filing-date>
</domestic-filing-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>A61N001/18</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>600</class>
<subclass>544000</subclass>
</uspc>
</classification-us-primary>
</classification-us>
<title-of-invention>Seizure sensing and detection using an implantable device</title-of-invention>
</technical-information>
<inventors>
<first-named-inventor>
<name>
<given-name>Benjamin</given-name>
<middle-name>D.</middle-name>
<family-name>Pless</family-name>
</name>
<residence>
<residence-us>
<city>Atherton</city>
<state>CA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Stephen</given-name>
<middle-name>T.</middle-name>
<family-name>Archer</family-name>
</name>
<residence>
<residence-us>
<city>Sunnyvale</city>
<state>CA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Craig</given-name>
<family-name>Baysinger</family-name>
</name>
<residence>
<residence-us>
<city>Livermore</city>
<state>CA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Barbara</given-name>
<family-name>Gibb</family-name>
</name>
<residence>
<residence-us>
<city>Palo Alto</city>
<state>CA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Suresh</given-name>
<middle-name>K.</middle-name>
<family-name>Gurunathan</family-name>
</name>
<residence>
<residence-us>
<city>Santa Clara</city>
<state>CA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Bruce</given-name>
<family-name>Kirkpatrick</family-name>
</name>
<residence>
<residence-us>
<city>Santa Clara</city>
<state>CA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Thomas</given-name>
<middle-name>K.</middle-name>
<family-name>Tcheng</family-name>
</name>
<residence>
<residence-us>
<city>Pleasant Hill</city>
<state>CA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<correspondence-address>
<name-1>NEUROPACE, INC.</name-1>
<name-2></name-2>
<address>
<address-1>255 SANTA ANA COURT</address-1>
<city>SUNNYVALE</city>
<state>CA</state>
<postalcode>94085</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">A system and method for detecting and predicting neurological events with an implantable device uses a relatively low-power central processing unit in connection with signal processing circuitry to identify features (including half waves) and calculate window-based characteristics (including line lengths and areas under the curve of the waveform) in an electrographic signal received from a patient&apos;s brain. The features and window-based characteristics are combinable in various ways according to the invention to detect and predict neurological events in real time, enabling responsive action by the implantable device. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">FIELD OF THE INVENTION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> The invention relates to systems and methods for detecting and predicting neurological dysfunction characterized by abnormal electrographic patterns, and more particularly to a system and method for detecting and predicting epileptic seizures and their onsets by analyzing electroencephalogram and electrocorticogram signals with an implantable device. </paragraph>
</section>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> Epilepsy, a neurological disorder characterized by the occurrence of seizures (specifically episodic impairment or loss of consciousness, abnormal motor phenomena, psychic or sensory disturbances, or the perturbation of the autonomic nervous system), is debilitating to a great number of people. It is believed that as many as two to four million Americans may suffer from various forms of epilepsy. Research has found that its prevalence may be even greater worldwide, particularly in less economically developed nations, suggesting that the worldwide figure for epilepsy sufferers may be in excess of one hundred million. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> Because epilepsy is characterized by seizures, its sufferers are frequently limited in the kinds of activities they may participate in. Epilepsy can prevent people from driving, working, or otherwise participating in much of what society has to offer. Some epilepsy sufferers have serious seizures so frequently that they are effectively incapacitated. </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> Furthermore, epilepsy is often progressive and can be associated with degenerative disorders and conditions. Over time, epileptic seizures often become more frequent and more serious, and in particularly severe cases, are likely to lead to deterioration of other brain functions (including cognitive function) as well as physical impairments. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> The current state of the art in treating neurological disorders, particularly epilepsy, typically involves drug therapy and surgery. The first approach is usually drug therapy. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> A number of drugs are approved and available for treating epilepsy, such as sodium valproate, phenobarbital/primidone, ethosuximide, gabapentin, phenytoin, and carbamazepine, as well as a number of others. Unfortunately, those drugs typically have serious side effects, especially toxicity, and it is extremely important in most cases to maintain a precise therapeutic serum level to avoid breakthrough seizures (if the dosage is too low) or toxic effects (if the dosage is too high). The need for patient discipline is high, especially when a patient&apos;s drug regimen causes unpleasant side effects the patient may wish to avoid. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> Moreover, while many patients respond well to drug therapy alone, a significant number (at least 20-30%) do not. For those patients, surgery is presently the best-established and most viable alternative course of treatment. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> Currently practiced surgical approaches include radical surgical resection such as hemispherectomy, corticectomy, lobectomy and partial lobectomy, and less-radical lesionectomy, transection, and stereotactic ablation. Besides being less than fully successful, these surgical approaches generally have a high risk of complications, and can often result in damage to eloquent (i.e., functionally important) brain regions and the consequent long-term impairment of various cognitive and other neurological functions. Furthermore, for a variety of reasons, such surgical treatments are contraindicated in a substantial number of patients. And unfortunately, even after radical brain surgery, many epilepsy patients are still not seizure-free. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> Electrical stimulation is an emerging therapy for treating epilepsy. However, currently approved and available electrical stimulation devices apply continuous electrical stimulation to neural tissue surrounding or near implanted electrodes, and do not perform any detection&mdash;they are not responsive to relevant neurological conditions. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> The NeuroCybernetic Prosthesis (NCP) from Cyberonics, for example, applies continuous electrical stimulation to the patient&apos;s vagus nerve. This approach has been found to reduce seizures by about 50% in about 50% of patients. Unfortunately, a much greater reduction in the incidence of seizures is needed to provide clinical benefit. The Activa device from Medtronic is a pectorally implanted continuous deep brain stimulator intended primarily to treat Parkinson&apos;s disease. In operation, it supplies a continuous electrical pulse stream to a selected deep brain structure where an electrode has been implanted. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> Continuous stimulation of deep brain structures for the treatment of epilepsy has not met with consistent success. To be effective in terminating seizures, it is believed that one effective site where stimulation should be performed is near the focus of the epileptogenic region. The focus is often in the neocortex, where continuous stimulation may cause significant neurological deficit with clinical symptoms including loss of speech, sensory disorders, or involuntary motion. Accordingly, research has been directed toward automatic responsive epilepsy treatment based on a detection of imminent seizure. </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> A typical epilepsy patient experiences episodic attacks or seizures, which are generally electrographically defined as periods of abnormal neurological activity. As is traditional in the art, such periods shall be referred to herein as &ldquo;ictal&rdquo;. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> Most prior work on the detection and responsive treatment of seizures via electrical stimulation has focused on analysis of electroencephalogram (EEG) and electrocorticogram (ECoG) waveforms. In general, EEG signals represent aggregate neuronal activity potentials detectable via electrodes applied to a patient&apos;s scalp. ECoG signals, deep-brain counterparts to EEG signals, are detectable via electrodes implanted on or under the dura mater, and usually within the patient&apos;s brain. Unless the context clearly and expressly indicates otherwise, the term &ldquo;EEG&rdquo; shall be used generically herein to refer to both EEG and ECoG signals. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> Much of the work on detection has focused on the use of time-domain analysis of EEG signals. See, e.g., J. Gotman, Automatic seizure detection: improvements and evaluation, Electroencephalogr. Clin. Neurophysiol. 1990; 76(4): 317-24. In a typical time-domain detection system, EEG signals are received by one or more implanted electrodes and then processed by a control module, which then is capable of performing an action (intervention, warning, recording, etc.) when an abnormal event is detected. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> It is generally preferable to be able to detect and treat a seizure at or near its beginning, or even before it begins. The beginning of a seizure is referred to herein as an &ldquo;onset.&rdquo; However, it is important to note that there are two general varieties of seizure onsets. A &ldquo;clinical onset&rdquo; represents the beginning of a seizure as manifested through observable clinical symptoms, such as involuntary muscle movements or neurophysiological effects such as lack of responsiveness. An &ldquo;electrographic onset&rdquo; refers to the beginning of detectable electrographic activity indicative of a seizure. An electrographic onset will frequently occur before the corresponding clinical onset, enabling intervention before the patient suffers symptoms, but that is not always the case. In addition, there are changes in the EEG that occur seconds or even minutes before the electrographic onset that can be identified and used to facilitate intervention before electrographic or clinical onsets occur. This capability would be considered seizure prediction, in contrast to the detection of a seizure or its onset. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> In the Gotman system, EEG waveforms are filtered and decomposed into &ldquo;features&rdquo; representing characteristics of interest in the waveforms. One such feature is characterized by the regular occurrence (i.e., density) of half-waves exceeding a threshold amplitude occurring in a specified frequency band between approximately 3 Hz and 20 Hz, especially in comparison to background (non-ictal) activity. When such half-waves are detected, it is believed that seizure activity is occurring For related approaches, see also H. Qu and J. Gotman, A seizure warning system for long term epilepsy monitoring, Neurology 1995; 45: 2250-4; and H. Qu and J. Gotman, A Patient-Specific Algorithm for the Detection of Seizure Onset in Long-Term EEG Monitoring: Possible Use as a Warning Device, IEEE Trans. Biomed. Eng. 1997; 44(2): 115-22. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> The Gotman articles address half wave characteristics in general, and introduce a variety of measurement criteria, including a ratio of current epoch amplitude to background; average current epoch EEG frequency; average background EEG frequency; coefficient of variation of wave duration; ratio of current epoch amplitude to following time period; average wave amplitude; average wave duration; dominant frequency (peak frequency of the dominant peak); and average power in a main energy zone. These criteria are variously mapped into an n-dimensional space, and whether a seizure is detected depends on the vector distance between the parameters of a measured segment of EEG and a seizure template in that space. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> It should be noted that the schemes set forth in the above articles are not tailored for use in an implantable device, and hence typically require more computational ability than would be available in such a device. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> U.S. Pat. No. 6,018,682 to Rise describes an implantable seizure warning system that implements a form of the Gotman system. However, the system described therein uses only a single detection modality, namely a count of sharp spike and wave patterns within a timer period. This is accomplished with relatively complex processing, including averaging over time and quantifying sharpness by way of a second derivative of the signal. The Rise patent does not disclose how the signals are processed at a low level, nor does it explain detection criteria in any sufficiently specific level of detail. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> A more computationally demanding approach is to transform EEG signals into the frequency domain for rigorous spectrum analysis. See, e.g., U.S. Pat. No. 5,995,868 to Dorfineister et al., which analyzes the power spectral density of EEG signals in comparison to background characteristics. Although this approach is generally believed to achieve good results, for the most part, its computational expense renders it less than optimal for use in long-term implanted epilepsy monitor and treatment devices. With current technology, the battery life in an implantable device computationally capable of performing the Dorfmeister method would be too short for it to be feasible. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> Also representing an alternative and more complex approach is U.S. Pat. No. 5,857,978 to Hively et al., in which various non-linear and statistical characteristics of EEG signals are analyzed to identify the onset of ictal activity. Once more, the calculation of statistically relevant characteristics is not believed to be feasible in an implantable device. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> U.S. Pat. No. 6,016,449 to Fischell, et al. (which is hereby incorporated by reference as though set forth in full herein), describes an implantable seizure detection and treatment system. In the Fischell system, various detection methods are possible, all of which essentially rely upon the analysis (either in the time domain or the frequency domain) of processed EEG signals. Fischell&apos;s controller is preferably implanted intracranially, but other approaches are also possible, including the use of an external controller. When a seizure is detected, the Fischell system applies responsive electrical stimulation to terminate the seizure, a capability that will be discussed in further detail below. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> All of these approaches provide useful information, and in some cases may provide sufficient information for accurate detection and prediction of most imminent epileptic seizures. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> However, none of the various implementations of the known approaches provide 100% seizure detection accuracy in a clinical environment. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> Two types of detection errors are generally possible. A &ldquo;false positive,&rdquo; as the term is used herein, refers to a detection of a seizure or ictal activity when no seizure or other abnormal event is actually occurring. Similarly, a &ldquo;false negative&rdquo; herein refers to the failure to detect a seizure or ictal activity that actually is occurring or shortly will occur. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> In most cases, with all known implementations of the known approaches to detecting abnormal seizure activity solely by monitoring and analyzing EEG activity, when a seizure detection algorithm is tuned to catch all seizures, there will be a significant number of false positives. While it is currently believed that there are minimal or no side effects to limited amounts of over-stimulation (e.g., providing stimulation sufficient to terminate a seizure in response to a false positive), the possibility of accidentally initiating a seizure or increasing the patient&apos;s susceptibility to seizures must be considered. </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> As is well known, it has been suggested that it is possible to treat and terminate seizures by applying electrical stimulation to the brain. See, e.g., U.S. Pat. No. 6,016,449 to Fischell et al., and H. R. Wagner, et al., Suppression of cortical epileptiform activity by generalized and localized ECoG desynchronization, Electroencephalogr. Clin. Neurophysiol. 1975; 39(5): 499-506. And as stated above, it is believed to be beneficial to perform this stimulation only when a seizure (or other undesired neurological event) is occurring or about to occur, as inappropriate stimulation may result in the initiation of seizures. </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> Furthermore, it should be noted that a false negative (that is, a seizure that occurs without any warning or treatment from the device) will often cause the patient significant discomfort and detriment. Clearly, false negatives are to be avoided. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> It has been found to be difficult to achieve an acceptably low level of false positives and false negatives with the level of computational ability available in an implantable device with reasonable battery life. </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> Preferably, the battery in an implantable device, particularly one implanted intracranially, should last at least several years. There is a substantial risk of complications (such as infection, blood clots, and the overgrowth of scar tissue) and lead failure each time an implanted device or its battery is replaced. Rechargeable batteries have not been found to provide any advantage in this regard, as they are not as efficient as traditional cells, and the additional electronic circuitry required to support the recharging operation contributes to the device&apos;s size and complexity. Moreover, there is a need for patient discipline in recharging the device batteries, which would require the frequent transmission of a substantial amount of power over a wireless link and through the patient&apos;s skin and other tissue. </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> As stated above, the detection and prediction of ictal activity has traditionally required a significant amount of computational ability. Moreover, for an implanted device to have significant real-world utility, it is also advantageous to include a number of other features and capabilities. Specifically, treatment (via electrical stimulation or drug infusion) and/or warning (via an audio annunciator, for example), recording of EEG signals for later consideration and analysis, and telemetry providing a link to external equipment are all useful capabilities for an implanted device capable of detecting or predicting epileptiform signals. All of these additional subsystems will consume further power. </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> Moreover, size is also a consideration. For various reasons, intracranial implants are favored. A device implanted intracranially (or under the scalp) will typically have a lower risk of failure than a similar device implanted pectorally or elsewhere, which require a lead to be run from the device, through the patient&apos;s neck to the electrode implantation sites in the patient&apos;s head. This lead is also prone to receive additional electromagnetic interference. </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> As is well known in the art, the computational ability of a processor-controlled system is directly related to both size and power consumption. In accordance with the above considerations, therefore, it would be advantageous to have sufficient detection and prediction capabilities to avoid a substantial number of false positive and false negative detections, and yet consume little enough power (in conjunction with the other subsystems) to enable long battery life. Such an implantable device would have a relatively low-power central processing unit to reduce the electrical power consumed by that portion. </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> At the current time, there is no known implantable device that is capable of detecting and predicting seizures and yet has adequate battery life and the consequent acceptably low risk factors for use in human patients. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> Accordingly, an implantable device according to the invention for detecting and predicting epileptic seizures includes a relatively low-speed and low-power central processing unit, as well as customized electronic circuit modules in a detection subsystem. As described herein, the detection subsystem also performs prediction, which in the context of the present application is a form of detection that occurs before identifiable clinical symptoms or even obvious electrographic patterns are evident upon inspection. The same methods, potentially with different parameters, are adapted to be used for both detection and prediction. Generally, as described herein, an event (such as an epileptic seizure) may be detected, an electrographic &ldquo;onset&rdquo; of such an event (an electrographic indication of an event occurring at the same time as or before the clinical event begins) may be detected (and may be characterized by different waveform observations than the event itself), and a &ldquo;precursor&rdquo; to an event (electrographic activity regularly occurring some time before the clinical event) may be detected as predictive of the event. </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> As described herein and as the terms are generally understood, the present approach is generally not statistical or stochastic in nature. The invention, and particularly the detection subsystem thereof, is specifically adapted to perform much of the signal processing and analysis requisite for accurate and effective event detection. The central processing unit remains in a suspended &ldquo;sleep&rdquo; state characterized by relative inactivity a substantial percentage of the time, and is periodically awakened by interrupts from the detection subsystem to perform certain tasks related to the detection and prediction schemes enabled by the device. </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> Much of the processing performed by an implantable system according to the invention involves operations on digital data in the time domain. Preferably, to reduce the amount of data processing required by the invention, samples at ten-bit resolution are taken at a rate less than or equal to approximately 500 Hz (2 ms per sample). </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> As stated above, an implantable system according to the invention is capable of accurate and reliable seizure detection and prediction. To accomplish this, the invention employs a combination of signal processing and analysis modalities, including data reduction and feature extraction techniques, mostly implemented as customized digital electronics modules, minimally reliant upon a central processing unit. </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> In particular, it has been found to be advantageous to utilize two different data reduction methodologies, both of which collect data representative of EEG signals within a sequence of uniform time windows each having a specified duration. </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> The first data reduction methodology involves the calculation of a &ldquo;line length function&rdquo; for an EEG signal within a time window. Specifically, the line length function of a digital signal represents an accumulation of the sample-to-sample amplitude variation in the EEG signal within the time window. Stated another way, the line length function is representative of the variability of the input signal. A constant input signal will have a line length of zero (representative of substantially no variation in the signal amplitude), while an input signal that oscillates between extrema from sample to sample will approach the maximum line length. It should be noted that while the line length function has a physical-world analogue in measuring the vector distance traveled in a graph of the input signal, the concept of line length as treated herein disregards the horizontal (X) axis in such a situation. The horizontal axis herein is representative of time, which is not combinable in any meaningful way in accordance with the invention with information relating to the vertical (Y) axis, generally representative of amplitude, and which in any event would contribute nothing of interest. </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> The second data reduction methodology involves the calculation of an &ldquo;area function&rdquo; represented by an EEG signal within a time window. Specifically, the area function is calculated as an aggregation of the EEG&apos;s signal total deviation from zero over the time window, whether positive or negative. The mathematical analogue for the area function defined above is the mathematical integral of the absolute value of the EEG function (as both positive and negative signals contribute to positive area). Once again, the horizontal axis (time) makes no contribution to accumulated energy as treated herein. Accordingly, an input signal that remains around zero will have a small area value, while an input signal that remains around the most-positive or mostnegative values will have a high area value. </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> Both the area and line length functions may undergo linear or non-linear transformations. An example would be to square each amplitude before summing it in the area function. This non-linear operation would provide an output that would approximate the energy of the signal for the period of time it was integrated. Likewise linear and non-linear transformations of the difference between sample values are advantageous in customizing the line length function to increase the effectiveness of the detector for a specific patient. </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> The central processing unit receives the line length function and area function measurements performed by the detection subsystem, and is capable of acting based on those measurements or their trends. </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> Feature extraction, specifically the identification of half waves in an EEG signal, also provides useful information. A half wave is an interval between a local waveform minimum and a local waveform maximum; each time a signal &ldquo;changes directions&rdquo; (from increasing to decreasing, or vice versa), subject to limitations that will be set forth in further detail below, a new half wave is identified. </paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> The identification of half waves having specific amplitude and duration criteria allows some frequency-driven characteristics of the EEG signal to be considered and analyzed without the need for computationally intensive transformations of normally time-domain EEG signals into the frequency domain. Specifically, the half wave feature extraction capability of the invention identifies those half waves in the input signal having a duration that exceeds a minimum duration criterion and an amplitude that exceeds a minimum amplitude criterion. The number of half waves in a time window meeting those criteria is somewhat representative of the amount of energy in a waveform at a frequency below the frequency corresponding to the minimum duration criterion. And the number of half waves in a time window is constrained somewhat by the duration of each half wave (i.e., if the half waves in a time window have particularly long durations, relatively fewer of them will fit into the time window), that number is highest when a dominant waveform frequency most closely matches the frequency corresponding to the minimum duration criterion. </paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> As stated above, the half waves, line length function, and area function of various EEG signals are calculated by customized electronics modules with minimal involvement by the central processing unit, and are selectively combined by a system according to the invention to provide detection and prediction of seizure activity, so that appropriate action can then be taken. </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> Accordingly, in one embodiment of the invention, a system according to the invention includes a central processing unit, a detection subsystem located therein that includes a waveform analyzer. The waveform analyzer includes waveform feature analysis capabilities (such as half wave characteristics) as well as window-based analysis capabilities (such as line length and area under the curve), and both aspects are combined to provide enhanced neurological event detection. A central processing unit is used to consolidate the results from multiple channels and coordinate responsive action when necessary.</paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0048" lvl="0"><number>&lsqb;0048&rsqb;</number> These and other objects, features, and advantages of the invention will become apparent from the detailed description below and the accompanying drawings, in which: </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a schematic illustration of a patient&apos;s head showing the placement of an implantable neurostimulator according to an embodiment of the invention; </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a schematic illustration of a patient&apos;s cranium showing the implantable neurostimulator of <cross-reference target="DRAWINGS">FIG. 1</cross-reference> as implanted, including leads extending to the patient&apos;s brain; </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a block diagram illustrating context in which an implantable neurostimulator according to the invention is implanted and operated; </paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a block diagram illustrating the major functional subsystems of an implantable neurostimulator according to the invention; </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is a block diagram illustrating the functional components of the detection subsystem of the implantable neurostimulator shown in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>; </paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a block diagram illustrating the functional components of the sensing front end of the detection subsystem of <cross-reference target="DRAWINGS">FIG. 5</cross-reference>; </paragraph>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a block diagram illustrating the components of the waveform analyzer of the detection subsystem of <cross-reference target="DRAWINGS">FIG. 5</cross-reference>; </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a block diagram illustrating the functional arrangement of components of the waveform analysis of the detection subsystem of <cross-reference target="DRAWINGS">FIG. 5</cross-reference> in one possible programmed embodiment of the invention; </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a graph of an exemplary EEG signal, illustrating decomposition of the signal into time windows and samples; </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a graph of the exemplary EEG signal of <cross-reference target="DRAWINGS">FIG. 9</cross-reference>, illustrating the extraction of half waves from the signal; </paragraph>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is a flow chart illustrating the process performed by hardware functional components of the waveform analyzer of <cross-reference target="DRAWINGS">FIG. 7</cross-reference> in extracting half waves as illustrated in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>; </paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a flow chart illustrating the process performed by software in the central processing unit in extracting and analyzing half waves from an EEG signal; </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is a flow chart illustrating the process performed by software in the central processing unit in the application of an X of Y criterion to half wave windows; </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 14</cross-reference> is a graph of the exemplary EEG signal of <cross-reference target="DRAWINGS">FIG. 9</cross-reference>, illustrating the calculation of a line length function; </paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 15</cross-reference> is a flow chart illustrating the process performed by hardware functional components of the waveform analyzer of <cross-reference target="DRAWINGS">FIG. 7</cross-reference> in calculating the line length function as illustrated in <cross-reference target="DRAWINGS">FIG. 14</cross-reference>; </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 16</cross-reference> is a flow chart illustrating the process performed by software in the central processing unit in calculating and analyzing the line length function of an EEG signal; </paragraph>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 17</cross-reference> is a graph of the exemplary EEG signal of <cross-reference target="DRAWINGS">FIG. 9</cross-reference>, illustrating the calculation of an area function; </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 18</cross-reference> is a flow chart illustrating the process performed by hardware functional components of the waveform analyzer of <cross-reference target="DRAWINGS">FIG. 7</cross-reference> in calculating the area function as illustrated in <cross-reference target="DRAWINGS">FIG. 17</cross-reference>; </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 19</cross-reference> is a flow chart illustrating the process performed by software in the central processing unit in calculating and analyzing the area function of an EEG signal; </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 20</cross-reference> is a flow chart illustrating the process performed by event-driven software in the central processing unit to analyze half wave, line length, and area information for detection according to the invention; </paragraph>
<paragraph id="P-0069" lvl="0"><number>&lsqb;0069&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 21</cross-reference> is a flow chart illustrating the combination of analysis tools into detection channels in an embodiment of the invention; and </paragraph>
<paragraph id="P-0070" lvl="0"><number>&lsqb;0070&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 22</cross-reference> is a flow chart illustrating the combination of detection channels into event detectors in an embodiment of the invention. </paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF THE INVENTION </heading>
<paragraph id="P-0071" lvl="0"><number>&lsqb;0071&rsqb;</number> The invention is described below, with reference to detailed illustrative embodiments. It will be apparent that a system according to the invention may be embodied in a wide variety of forms. Consequently, the specific structural and functional details disclosed herein are representative and do not limit the scope of the invention. </paragraph>
<paragraph id="P-0072" lvl="0"><number>&lsqb;0072&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> depicts an intracranially implanted device <highlight><bold>110</bold></highlight> according to the invention, which in one embodiment is a small self-contained responsive neurostimulator. As the term is used herein, a responsive neurostimulator is a device capable of detecting or predicting ictal activity (or other neurological events) and providing electrical stimulation to neural tissue in response to that activity, where the electrical stimulation is specifically intended to terminate the ictal activity, treat a neurological event, prevent an unwanted neurological event from occurring, or lessen the severity or frequency of certain symptoms of a neurological disorder. As disclosed herein, the responsive neurostimulator detects ictal activity by systems and methods according to the invention. </paragraph>
<paragraph id="P-0073" lvl="0"><number>&lsqb;0073&rsqb;</number> Preferably, an implantable device according to the invention is capable of detecting or predicting any kind of neurological event that has a representative electrographic signature. While the disclosed embodiment is described primarily as responsive to epileptic seizures, it should be recognized that it is also possible to respond to other types of neurological disorders, such as movement disorders (e.g. the tremors characterizing Parkinson&apos;s disease), migraine headaches, chronic pain, and neuropsychiatric disorders such as depression. Preferably, neurological events representing any or all of these afflictions can be detected when they are actually occurring, in an onset stage, or as a predictive precursor before clinical symptoms begin. </paragraph>
<paragraph id="P-0074" lvl="0"><number>&lsqb;0074&rsqb;</number> In the disclosed embodiment, the neurostimulator is implanted intracranially in a patient&apos;s parietal bone <highlight><bold>210</bold></highlight>, in a location anterior to the lambdoidal suture <highlight><bold>212</bold></highlight> (see <cross-reference target="DRAWINGS">FIG. 2</cross-reference>). It should be noted, however, that the placement described and illustrated herein is merely exemplary, and other locations and configurations are also possible, in the cranium or elsewhere, depending on the size and shape of the device and individual patient needs, among other factors. The device <highlight><bold>110</bold></highlight> is preferably configured to fit the contours of the patient&apos;s cranium <highlight><bold>214</bold></highlight>. In an alternative embodiment, the device <highlight><bold>110</bold></highlight> is implanted under the patient&apos;s scalp <highlight><bold>112</bold></highlight> but external to the cranium; it is expected, however, that this configuration would generally cause an undesirable protrusion in the patient&apos;s scalp where the device is located. In yet another alternative embodiment, when it is not possible to implant the device intracranially, it may be implanted pectorally (not shown), with leads extending through the patient&apos;s neck and between the patient&apos;s cranium and scalp, as necessary. </paragraph>
<paragraph id="P-0075" lvl="0"><number>&lsqb;0075&rsqb;</number> It should be recognized that the embodiment of the device <highlight><bold>110</bold></highlight> described and illustrated herein is preferably a responsive neurostimulator for detecting and treating epilepsy by detecting seizures or their onsets or precursors, and preventing and/or terminating such epileptic seizures. </paragraph>
<paragraph id="P-0076" lvl="0"><number>&lsqb;0076&rsqb;</number> In an alternative embodiment of the invention, the device <highlight><bold>110</bold></highlight> is not a responsive neurostimulator, but is an apparatus capable of detecting neurological conditions and events and performing actions in response thereto. The actions performed by such an embodiment of the device <highlight><bold>110</bold></highlight> need not be therapeutic, but may involve data recording or transmission, providing warnings to the patient, or any of a number of known alternative actions. Such a device will typically act as a diagnostic device when interfaced with external equipment, as will be discussed in further detail below. </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> The device <highlight><bold>110</bold></highlight>, as implanted intracranially, is illustrated in greater detail in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>. The device <highlight><bold>110</bold></highlight> is affixed in the patient&apos;s cranium <highlight><bold>214</bold></highlight> by way of a ferrule <highlight><bold>216</bold></highlight>. The ferrule <highlight><bold>216</bold></highlight> is a structural member adapted to fit into a cranial opening, attach to the cranium <highlight><bold>214</bold></highlight>, and retain the device <highlight><bold>110</bold></highlight>. </paragraph>
<paragraph id="P-0078" lvl="0"><number>&lsqb;0078&rsqb;</number> To implant the device <highlight><bold>110</bold></highlight>, a craniotomy is performed in the parietal bone anterior to the lambdoidal suture <highlight><bold>212</bold></highlight> to define an opening <highlight><bold>218</bold></highlight> slightly larger than the device <highlight><bold>110</bold></highlight>. The ferrule <highlight><bold>216</bold></highlight> is inserted into the opening <highlight><bold>218</bold></highlight> and affixed to the cranium <highlight><bold>214</bold></highlight>, ensuring a tight and secure fit. The device <highlight><bold>110</bold></highlight> is then inserted into and affixed to the ferrule <highlight><bold>216</bold></highlight>. </paragraph>
<paragraph id="P-0079" lvl="0"><number>&lsqb;0079&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, the device <highlight><bold>110</bold></highlight> includes a lead connector <highlight><bold>220</bold></highlight> adapted to receive one or more electrical leads, such as a first lead <highlight><bold>222</bold></highlight>. The lead connector <highlight><bold>220</bold></highlight> acts to physically secure the lead <highlight><bold>222</bold></highlight> to the device <highlight><bold>110</bold></highlight>, and facilitates electrical connection between a conductor in the lead <highlight><bold>222</bold></highlight> coupling an electrode to circuitry within the device <highlight><bold>110</bold></highlight>. The lead connector <highlight><bold>220</bold></highlight> accomplishes this in a substantially fluid-tight environment with biocompatible materials. </paragraph>
<paragraph id="P-0080" lvl="0"><number>&lsqb;0080&rsqb;</number> The lead <highlight><bold>222</bold></highlight>, as illustrated, and other leads for use in a system or method according to the invention, is a flexible elongated member having one or more conductors. As shown, the lead <highlight><bold>222</bold></highlight> is coupled to the device <highlight><bold>110</bold></highlight> via the lead connector <highlight><bold>220</bold></highlight>, and is generally situated on the outer surface of the cranium <highlight><bold>214</bold></highlight> (and under the patient&apos;s scalp <highlight><bold>112</bold></highlight>), extending between the device <highlight><bold>110</bold></highlight> and a burr hole <highlight><bold>224</bold></highlight> or other cranial opening, where the lead <highlight><bold>222</bold></highlight> enters the cranium <highlight><bold>214</bold></highlight> and is coupled to a depth electrode (see <cross-reference target="DRAWINGS">FIG. 4</cross-reference>) implanted in a desired location in the patient&apos;s brain. If the length of the lead <highlight><bold>222</bold></highlight> is substantially greater than the distance between the device <highlight><bold>110</bold></highlight> and the burr hole <highlight><bold>224</bold></highlight>, any excess may be urged into a coil configuration under the scalp <highlight><bold>112</bold></highlight>. As described in U.S. Pat. No. 6,006,124 to Fischell, et al., which is hereby incorporated by reference as though set forth in full herein, the burr hole <highlight><bold>224</bold></highlight> is sealed after implantation to prevent further movement of the lead <highlight><bold>222</bold></highlight>; in an embodiment of the invention, a burr hole cover apparatus is affixed to the cranium <highlight><bold>214</bold></highlight> at least partially within the burr hole <highlight><bold>224</bold></highlight> to provide this functionality. </paragraph>
<paragraph id="P-0081" lvl="0"><number>&lsqb;0081&rsqb;</number> The device <highlight><bold>110</bold></highlight> includes a durable outer housing <highlight><bold>226</bold></highlight> fabricated from a biocompatible material. Titanium, which is light, extremely strong, and biocompatible, is used in analogous devices, such as cardiac pacemakers, and would serve advantageously in this context. As the device <highlight><bold>110</bold></highlight> is self-contained, the housing <highlight><bold>226</bold></highlight> encloses a battery and any electronic circuitry necessary or desirable to provide the functionality described herein, as well as any other features. As will be described in further detail below, a telemetry coil may be provided outside of the housing <highlight><bold>226</bold></highlight> (and potentially integrated with the lead connector <highlight><bold>220</bold></highlight>) to facilitate communication between the device <highlight><bold>110</bold></highlight> and external devices. </paragraph>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> The neurostimulator configuration described herein and illustrated in <cross-reference target="DRAWINGS">FIG. 2</cross-reference> provides several advantages over alternative designs. First, the self-contained nature of the neurostimulator substantially decreases the need for access to the device <highlight><bold>110</bold></highlight>, allowing the patient to participate in normal life activities. Its small size and intracranial placement causes a minimum of cosmetic disfigurement. The device <highlight><bold>110</bold></highlight> will fit in an opening in the patient&apos;s cranium, under the patient&apos;s scalp, with little noticeable protrusion or bulge. The ferrule <highlight><bold>216</bold></highlight> used for implantation allows the craniotomy to be performed and fit verified without the possibility of breaking the device <highlight><bold>110</bold></highlight>, and also provides protection against the device <highlight><bold>110</bold></highlight> being pushed into the brain under external pressure or impact. A further advantage is that the ferrule <highlight><bold>216</bold></highlight> receives any cranial bone growth, so at explant, the device <highlight><bold>110</bold></highlight> can be replaced without removing any bone screws&mdash;only the fasteners retaining the device <highlight><bold>110</bold></highlight> in the ferrule <highlight><bold>216</bold></highlight> need be manipulated. </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> As stated above, and as illustrated in <cross-reference target="DRAWINGS">FIG. 3, a</cross-reference> neurostimulator according to the invention operates in conjunction with external equipment. The device <highlight><bold>110</bold></highlight> is mostly autonomous (particularly when performing its usual sensing, detection, and stimulation capabilities), but preferably includes a selectable part-time wireless link <highlight><bold>310</bold></highlight> to external equipment such as a programmer <highlight><bold>312</bold></highlight>. In the disclosed embodiment of the invention, the wireless link <highlight><bold>310</bold></highlight> is established by moving a wand (or other apparatus) having communication capabilities and coupled to the programmer <highlight><bold>312</bold></highlight> into range of the device <highlight><bold>110</bold></highlight>. The programmer <highlight><bold>312</bold></highlight> can then be used to manually control the operation of the device <highlight><bold>110</bold></highlight>, as well as to transmit information to or receive information from the device <highlight><bold>110</bold></highlight>. Several specific capabilities and operations performed by the programmer <highlight><bold>312</bold></highlight> in conjunction with the device <highlight><bold>110</bold></highlight> will be described in further detail below. </paragraph>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> The programmer <highlight><bold>312</bold></highlight> is capable of performing a number of advantageous operations in connection with the invention. In particular, the programmer <highlight><bold>312</bold></highlight> is able to specify and set variable parameters in the device <highlight><bold>110</bold></highlight> to adapt the function of the device <highlight><bold>110</bold></highlight> to meet the patient&apos;s needs, download or receive data (including but not limited to stored EEG waveforms, parameters, or logs of actions taken) from the device <highlight><bold>110</bold></highlight> to the programmer <highlight><bold>312</bold></highlight>, upload or transmit program code and other information from the programmer <highlight><bold>312</bold></highlight> to the device <highlight><bold>110</bold></highlight>, or command the device <highlight><bold>110</bold></highlight> to perform specific actions or change modes as desired by a physician operating the programmer <highlight><bold>312</bold></highlight>. To facilitate these functions, the programmer <highlight><bold>312</bold></highlight> is adapted to receive physician input <highlight><bold>314</bold></highlight> and provide physician output <highlight><bold>316</bold></highlight>; data is transmitted between the programmer <highlight><bold>312</bold></highlight> and the device <highlight><bold>110</bold></highlight> over the wireless link <highlight><bold>310</bold></highlight>. </paragraph>
<paragraph id="P-0085" lvl="0"><number>&lsqb;0085&rsqb;</number> The programmer <highlight><bold>312</bold></highlight> may be coupled via a communication link <highlight><bold>318</bold></highlight> to a network <highlight><bold>320</bold></highlight> such as the Internet. This allows any information downloaded from the device <highlight><bold>110</bold></highlight>, as well as any program code or other information to be uploaded to the device <highlight><bold>110</bold></highlight>, to be stored in a database at one or more data repository locations (which may include various servers and network-connected programmers like the programmer <highlight><bold>312</bold></highlight>). This would allow a patient (and the patient&apos;s physician) to have access to important data, including past treatment information and software updates, essentially anywhere in the world that there is a programmer (like the programmer <highlight><bold>312</bold></highlight>) and a network connection. </paragraph>
<paragraph id="P-0086" lvl="0"><number>&lsqb;0086&rsqb;</number> An overall block diagram of the device <highlight><bold>110</bold></highlight> used for measurement, detection, and treatment according to the invention is illustrated in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>. Inside the housing <highlight><bold>226</bold></highlight> of the device <highlight><bold>110</bold></highlight> are several subsystems making up a control module <highlight><bold>410</bold></highlight>. The control module <highlight><bold>410</bold></highlight> is capable of being coupled to a plurality of electrodes <highlight><bold>412</bold></highlight>, <highlight><bold>414</bold></highlight>, <highlight><bold>416</bold></highlight>, and <highlight><bold>418</bold></highlight> (each of which may be connected to the control module <highlight><bold>410</bold></highlight> via a lead that is analogous or identical to the lead <highlight><bold>222</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 2</cross-reference>) for sensing and stimulation. In the illustrated embodiment, the coupling is accomplished through the lead connector <highlight><bold>220</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 2</cross-reference>). Although four electrodes are shown in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>, it should be recognized that any number is possible, and in the embodiment described in detail below, eight electrodes are used. In fact, it is possible to employ an embodiment of the invention that uses a single lead with at least two electrodes, or two leads each with a single electrode (or with a second electrode provided by a conductive exterior portion of the housing <highlight><bold>226</bold></highlight> in one embodiment), although bipolar sensing between two closely spaced electrodes on a lead is preferred to minimize common mode signals including noise. </paragraph>
<paragraph id="P-0087" lvl="0"><number>&lsqb;0087&rsqb;</number> The electrodes <highlight><bold>412</bold></highlight>-<highlight><bold>418</bold></highlight> are connected to an electrode interface <highlight><bold>420</bold></highlight>. Preferably, the electrode interface is capable of selecting each electrode as required for sensing and stimulation; accordingly the electrode interface is coupled to a detection subsystem <highlight><bold>422</bold></highlight> and a stimulation subsystem <highlight><bold>424</bold></highlight>. The electrode interface also may provide any other features, capabilities, or aspects, including but not limited to amplification, isolation, and charge-balancing functions, that are required for a proper interface with neurological tissue and not provided by any other subsystem of the device <highlight><bold>110</bold></highlight>. </paragraph>
<paragraph id="P-0088" lvl="0"><number>&lsqb;0088&rsqb;</number> The detection subsystem <highlight><bold>422</bold></highlight> includes an EEG analyzer function. The EEG analyzer function is adapted to receive EEG signals from the electrodes <highlight><bold>412</bold></highlight>-<highlight><bold>418</bold></highlight>, through the electrode interface <highlight><bold>420</bold></highlight>, and to process those EEG signals to identify neurological activity indicative of a seizure, an onset of a seizure, or a precursor to a seizure. One way to implement such EEG analysis functionality is disclosed in detail in U.S. Pat. No. 6,016,449 to Fischell et al., incorporated by reference above; additional inventive methods are described in detail below. The detection subsystem may optionally also contain further sensing and detection capabilities, including but not limited to parameters derived from other physiological conditions (such as electrophysiological parameters, temperature, blood pressure, etc.). </paragraph>
<paragraph id="P-0089" lvl="0"><number>&lsqb;0089&rsqb;</number> The stimulation subsystem <highlight><bold>424</bold></highlight> is capable of applying electrical stimulation to neurological tissue through the electrodes <highlight><bold>412</bold></highlight>-<highlight><bold>418</bold></highlight>. This can be accomplished in any of a number of different manners. For example, it may be advantageous in some circumstances to provide stimulation in the form of a substantially continuous stream of pulses, or on a scheduled basis. Preferably, therapeutic stimulation is provided in response to abnormal events detected by the EEG analyzer function of the detection subsystem <highlight><bold>422</bold></highlight>. As illustrated in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>, the stimulation subsystem <highlight><bold>424</bold></highlight> and the EEG analyzer function of the detection subsystem <highlight><bold>422</bold></highlight> are in communication; this facilitates the ability of stimulation subsystem <highlight><bold>424</bold></highlight> to provide responsive stimulation as well as an ability of the detection subsystem <highlight><bold>422</bold></highlight> to blank the amplifiers while stimulation is being performed to minimize stimulation artifacts. It is contemplated that the parameters of the stimulation signal (e.g., frequency, duration, waveform) provided by the stimulation subsystem <highlight><bold>424</bold></highlight> would be specified by other subsystems in the control module <highlight><bold>410</bold></highlight>, as will be described in further detail below. </paragraph>
<paragraph id="P-0090" lvl="0"><number>&lsqb;0090&rsqb;</number> Also in the control module <highlight><bold>410</bold></highlight> is a memory subsystem <highlight><bold>426</bold></highlight> and a central processing unit (CPU) <highlight><bold>428</bold></highlight>, which can take the form of a microcontroller. The memory subsystem is coupled to the detection subsystem <highlight><bold>422</bold></highlight> (e.g., for receiving and storing data representative of sensed EEG signals and evoked responses), the stimulation subsystem <highlight><bold>424</bold></highlight> (e.g., for providing stimulation waveform parameters to the stimulation subsystem), and the CPU <highlight><bold>428</bold></highlight>, which can control the operation of the memory subsystem <highlight><bold>426</bold></highlight>. In addition to the memory subsystem <highlight><bold>426</bold></highlight>, the CPU <highlight><bold>428</bold></highlight> is also connected to the detection subsystem <highlight><bold>422</bold></highlight> and the stimulation subsystem <highlight><bold>424</bold></highlight> for direct control of those subsystems. </paragraph>
<paragraph id="P-0091" lvl="0"><number>&lsqb;0091&rsqb;</number> Also provided in the control module <highlight><bold>410</bold></highlight>, and coupled to the memory subsystem <highlight><bold>426</bold></highlight> and the CPU <highlight><bold>428</bold></highlight>, is a communication subsystem <highlight><bold>430</bold></highlight>. The communication subsystem <highlight><bold>430</bold></highlight> enables communication between the device <highlight><bold>110</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 1</cross-reference>) and the outside world, particularly the external programmer <highlight><bold>312</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 3</cross-reference>). As set forth above, the disclosed embodiment of the communication subsystem <highlight><bold>430</bold></highlight> includes a telemetry coil (which may be situated outside of the housing <highlight><bold>226</bold></highlight>) enabling transmission and reception of signals, to or from an external apparatus, via inductive coupling. Alternative embodiments of the communication subsystem <highlight><bold>430</bold></highlight> could use an antenna for an RF link or an audio transducer for an audio link. </paragraph>
<paragraph id="P-0092" lvl="0"><number>&lsqb;0092&rsqb;</number> Rounding out the subsystems in the control module <highlight><bold>410</bold></highlight> are a power supply <highlight><bold>432</bold></highlight> and a clock supply <highlight><bold>434</bold></highlight>. The power supply <highlight><bold>432</bold></highlight> supplies the voltages and currents necessary for each of the other subsystems. The clock supply <highlight><bold>434</bold></highlight> supplies substantially all of the other subsystems with any clock and timing signals necessary for their operation. </paragraph>
<paragraph id="P-0093" lvl="0"><number>&lsqb;0093&rsqb;</number> It should be observed that while the memory subsystem <highlight><bold>426</bold></highlight> is illustrated in <cross-reference target="DRAWINGS">FIG. 4</cross-reference> as a separate functional subsystem, the other subsystems may also require various amounts of memory to perform the functions described above and others. Furthermore, while the control module <highlight><bold>410</bold></highlight> is preferably a single physical unit contained within a single physical enclosure, namely the housing <highlight><bold>226</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 2</cross-reference>), it may comprise a plurality of spatially separate units each performing a subset of the capabilities described above. Also, it should be noted that the various functions and capabilities of the subsystems described above may be performed by electronic hardware, computer software (or firmware), or a combination thereof. The division of work between the CPU <highlight><bold>428</bold></highlight> and the other functional subsystems may also vary&mdash;the functional distinctions illustrated in <cross-reference target="DRAWINGS">FIG. 4</cross-reference> may not reflect the integration of functions in a real-world system or method according to the invention. </paragraph>
<paragraph id="P-0094" lvl="0"><number>&lsqb;0094&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> illustrates details of the detection subsystem <highlight><bold>422</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 4</cross-reference>). Inputs from the electrodes <highlight><bold>412</bold></highlight>-<highlight><bold>418</bold></highlight> are on the left, and connections to other subsystems are on the right. </paragraph>
<paragraph id="P-0095" lvl="0"><number>&lsqb;0095&rsqb;</number> Signals received from the electrodes <highlight><bold>412</bold></highlight>-<highlight><bold>418</bold></highlight> (as routed through the electrode interface <highlight><bold>420</bold></highlight>) are received in an electrode selector <highlight><bold>510</bold></highlight>. The electrode selector <highlight><bold>510</bold></highlight> allows the device to select which electrodes (of the electrodes <highlight><bold>412</bold></highlight>-<highlight><bold>418</bold></highlight>) should be routed to which individual sensing channels of the detection subsystem <highlight><bold>422</bold></highlight>, based on commands received through a control interface <highlight><bold>518</bold></highlight> from the memory subsystem <highlight><bold>426</bold></highlight> or the CPU <highlight><bold>428</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 4</cross-reference>). Preferably, each sensing channel of the detection subsystem <highlight><bold>422</bold></highlight> receives a bipolar signal representative of the difference in electrical potential between two selectable electrodes. Accordingly, the electrode selector <highlight><bold>510</bold></highlight> provides signals corresponding to each pair of selected electrodes (of the electrodes <highlight><bold>412</bold></highlight>-<highlight><bold>418</bold></highlight>) to a sensing front end <highlight><bold>512</bold></highlight>, which performs amplification, analog to digital conversion, and multiplexing functions on the signals in the sensing channels. The sensing front end will be described further below in connection with <cross-reference target="DRAWINGS">FIG. 6</cross-reference>. </paragraph>
<paragraph id="P-0096" lvl="0"><number>&lsqb;0096&rsqb;</number> A multiplexed input signal representative of all active sensing channels is then fed from the sensing front end <highlight><bold>512</bold></highlight> to a waveform analyzer <highlight><bold>514</bold></highlight>. The waveform analyzer <highlight><bold>514</bold></highlight> is preferably a special-purpose digital signal processor (DSP) adapted for use with the invention, or in an alternative embodiment, may comprise a programmable general-purpose DSP. In the disclosed embodiment, the waveform analyzer has its own scratchpad memory area <highlight><bold>516</bold></highlight> used for local storage of data and program variables when the signal processing is being performed. In either case, the signal processor performs suitable measurement and detection methods described generally above and in greater detail below. Any results from such methods, as well as any digitized signals intended for storage transmission to external equipment, are passed to various other subsystems of the control module <highlight><bold>410</bold></highlight>, including the memory subsystem <highlight><bold>426</bold></highlight> and the CPU <highlight><bold>428</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 4</cross-reference>) through a data interface <highlight><bold>520</bold></highlight>. Similarly, the control interface <highlight><bold>518</bold></highlight> allows the waveform analyzer <highlight><bold>514</bold></highlight> and the electrode selector <highlight><bold>510</bold></highlight> to be in communication with the CPU <highlight><bold>428</bold></highlight>. </paragraph>
<paragraph id="P-0097" lvl="0"><number>&lsqb;0097&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 6</cross-reference>, the sensing front end <highlight><bold>512</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 5</cross-reference>) is illustrated in further detail. As shown, the sensing front end includes a plurality of differential amplifier channels <highlight><bold>610</bold></highlight>, each of which receives a selected pair of inputs from the electrode selector <highlight><bold>510</bold></highlight>. In a preferred embodiment of the invention, each of differential amplifier channels <highlight><bold>610</bold></highlight> is adapted to receive or to share inputs with one or more other differential amplifier channels <highlight><bold>610</bold></highlight> without adversely affecting the sensing and detection capabilities of a system according to the invention. Specifically, in an embodiment of the invention, there are at least eight electrodes, which can be mapped separately to eight differential amplifier channels <highlight><bold>610</bold></highlight> representing eight different sensing channels and capable of individually processing eight bipolar signals, each of which represents an electrical potential difference between two monopolar input signals received from the electrodes and applied to the sensing channels via the electrode selector <highlight><bold>510</bold></highlight>. For clarity, only five channels are illustrated in <cross-reference target="DRAWINGS">FIG. 6</cross-reference>, but it should be noted that any practical number of sensing channels may be employed in a system according to the invention. </paragraph>
<paragraph id="P-0098" lvl="0"><number>&lsqb;0098&rsqb;</number> Each differential amplifier channel <highlight><bold>610</bold></highlight> feeds a corresponding analog to digital converter (ADC) <highlight><bold>612</bold></highlight>. Preferably, the analog to digital converters <highlight><bold>612</bold></highlight> are separately programmable with respect to sample rates&mdash;in the disclosed embodiment, the ADCs <highlight><bold>612</bold></highlight> convert analog signals into <highlight><bold>10-</bold></highlight>bit unsigned integer digital data streams at a sample rate selectable between 250 Hz and 500 Hz. In several of the illustrations described below where waveforms are shown, sample rates of 250 Hz are typically used for simplicity. However, the invention shall not be deemed to be so limited, and numerous sample rate and resolution options are possible, with tradeoffs known to individuals of ordinary skill in the art of electronic signal processing. The resulting digital signals are received by a multiplexer <highlight><bold>614</bold></highlight> that creates a single interleaved digital data stream representative of the data from all active sensing channels. As will be described in further detail below, not all of the sensing channels need to be used at one time, and it may in fact be advantageous in certain circumstances to deactivate certain sensing channels to reduce the power consumed by a system according to the invention. </paragraph>
<paragraph id="P-0099" lvl="0"><number>&lsqb;0099&rsqb;</number> It should be noted that as illustrated and described herein, a &ldquo;sensing channel&rdquo; is not necessarily a single physical or functional item that can be identified in any illustration. Rather, a sensing channel is formed from the functional sequence of operations described herein, and particularly represents a single electrical signal received from any pair or combination of electrodes, as preprocessed by a system according to the invention, in both analog and digital forms. See, e.g., U.S. patent application Ser. No. 09/517,797 to D. Fischell et al., filed on Mar. 2, 2000 and entitled &ldquo;Neurological Event Detection Using Processed Display Channel Based Algorithms and Devices Incorporating These Procedures,&rdquo; which is hereby incorporated by reference as though set forth in full herein. At times (particularly after the multiplexer <highlight><bold>614</bold></highlight>), multiple sensing channels are processed by the same physical and functional components of the system; notwithstanding that, it should be recognized that unless the description herein indicates to the contrary, a system according to the invention processes, handles, and treats each sensing channel independently. </paragraph>
<paragraph id="P-0100" lvl="0"><number>&lsqb;0100&rsqb;</number> The interleaved digital data stream is passed from the multiplexer <highlight><bold>614</bold></highlight>, out of the sensing front end <highlight><bold>512</bold></highlight>, and into the waveform analyzer <highlight><bold>514</bold></highlight>. The waveform analyzer <highlight><bold>514</bold></highlight> is illustrated in detail in <cross-reference target="DRAWINGS">FIG. 7</cross-reference>. </paragraph>
<paragraph id="P-0101" lvl="0"><number>&lsqb;0101&rsqb;</number> The interleaved digital data stream representing information from all of the active sensing channels is first received by a channel controller <highlight><bold>710</bold></highlight>. The channel controller applies information from the active sensing channels to a number of wave morphology analysis units <highlight><bold>712</bold></highlight> and window analysis units <highlight><bold>714</bold></highlight>. It is preferred to have as many wave morphology analysis units <highlight><bold>712</bold></highlight> and window analysis units <highlight><bold>714</bold></highlight> as possible, consistent with the goals of efficiency, size, and low power consumption necessary for an implantable device. In a presently preferred embodiment of the invention, there are sixteen wave morphology analysis units <highlight><bold>712</bold></highlight> and eight window analysis units <highlight><bold>714</bold></highlight>, each of which can receive data from any of the sensing channels of the sensing front end <highlight><bold>512</bold></highlight>, and each of which can be operated with different and independent parameters, including differing sample rates, as will be discussed in further detail below. </paragraph>
<paragraph id="P-0102" lvl="0"><number>&lsqb;0102&rsqb;</number> Each of the wave morphology analysis units <highlight><bold>712</bold></highlight> operates to extract certain feature information from an input waveform as described below in conjunction with FIGS. <highlight><bold>9</bold></highlight>-<highlight><bold>11</bold></highlight>. Similarly, each of the window analysis units <highlight><bold>714</bold></highlight> performs certain data reduction and signal analysis within time windows in the manner described in conjunction with FIGS. <highlight><bold>12</bold></highlight>-<highlight><bold>17</bold></highlight>. Output data from the various wave morphology analysis units <highlight><bold>712</bold></highlight> and window analysis units <highlight><bold>714</bold></highlight> are combined via event detector logic <highlight><bold>716</bold></highlight>. The event detector logic <highlight><bold>716</bold></highlight> and the channel controller <highlight><bold>710</bold></highlight> are controlled by control commands <highlight><bold>718</bold></highlight> received from the control interface <highlight><bold>518</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 5</cross-reference>). </paragraph>
<paragraph id="P-0103" lvl="0"><number>&lsqb;0103&rsqb;</number> A &ldquo;detection channel,&rdquo; as the term is used herein, refers to a data stream including the active sensing front end <highlight><bold>512</bold></highlight> and the analysis units of the waveform analyzer <highlight><bold>514</bold></highlight> processing that data stream, in both analog and digital forms. It should be noted that each detection channel can receive data from a single sensing channel; each sensing channel preferably can be applied to the input of any combination of detection channels. The latter selection is accomplished by the channel controller <highlight><bold>710</bold></highlight>. As with the sensing channels, not all detection channels need to be active; certain detection channels can be deactivated to save power or if additional detection processing is deemed unnecessary in certain applications. </paragraph>
<paragraph id="P-0104" lvl="0"><number>&lsqb;0104&rsqb;</number> In conjunction with the operation of the wave morphology analysis units <highlight><bold>712</bold></highlight> and the window analysis units <highlight><bold>714</bold></highlight>, a scratchpad memory area <highlight><bold>516</bold></highlight> is provided for temporary storage of processed data. The scratchpad memory area <highlight><bold>516</bold></highlight> may be physically part of the memory subsystem <highlight><bold>426</bold></highlight>, or alternatively may be provided for the exclusive use of the waveform analyzer <highlight><bold>514</bold></highlight>. Other subsystems and components of a system according to the invention may also be furnished with local scratchpad memory, if such a configuration is advantageous. </paragraph>
<paragraph id="P-0105" lvl="0"><number>&lsqb;0105&rsqb;</number> The operation of the event detector logic <highlight><bold>716</bold></highlight> is illustrated in detail in the functional block diagram of <cross-reference target="DRAWINGS">FIG. 8</cross-reference>, in which four exemplary sensing channels are analyzed by three illustrative event detectors. </paragraph>
<paragraph id="P-0106" lvl="0"><number>&lsqb;0106&rsqb;</number> A first sensing channel <highlight><bold>810</bold></highlight> provides input to a first event detector <highlight><bold>812</bold></highlight>. While the first event detector <highlight><bold>812</bold></highlight> is illustrated as a functional block in the block diagram of <cross-reference target="DRAWINGS">FIG. 8</cross-reference>, it should be recognized that it is a functional block only for purposes of illustration, and may not have any physical counterpart in a device according to the invention. Similarly, a second sensing channel <highlight><bold>814</bold></highlight> provides input to a second event detector <highlight><bold>816</bold></highlight>, and a third input channel <highlight><bold>818</bold></highlight> and a fourth input channel <highlight><bold>820</bold></highlight> both provide input to a third event detector <highlight><bold>822</bold></highlight>. </paragraph>
<paragraph id="P-0107" lvl="0"><number>&lsqb;0107&rsqb;</number> Considering the processing performed by the event detectors <highlight><bold>812</bold></highlight>, <highlight><bold>816</bold></highlight>, and <highlight><bold>822</bold></highlight>, the first input channel <highlight><bold>810</bold></highlight> feeds a signal to both a wave morphology analysis unit <highlight><bold>824</bold></highlight> (one of the wave morphology analysis units <highlight><bold>712</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 7</cross-reference>) and a window analysis unit <highlight><bold>826</bold></highlight> (one of the window analysis units <highlight><bold>714</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 7</cross-reference>). The window analysis unit <highlight><bold>826</bold></highlight>, in turn, includes a line length analysis tool <highlight><bold>828</bold></highlight> and an area analysis tool <highlight><bold>830</bold></highlight>. As will be discussed in detail below, the line length analysis tool <highlight><bold>828</bold></highlight> and the area analysis tool <highlight><bold>830</bold></highlight> analyze different aspects of the signal from the first input channel <highlight><bold>810</bold></highlight> </paragraph>
<paragraph id="P-0108" lvl="0"><number>&lsqb;0108&rsqb;</number> Outputs from the wave morphology analysis unit <highlight><bold>824</bold></highlight>, the line length analysis tool <highlight><bold>828</bold></highlight>, and the area analysis tool <highlight><bold>830</bold></highlight> are combined in a Boolean AND operation <highlight><bold>832</bold></highlight> and sent to an output <highlight><bold>834</bold></highlight> for further use by a system according to the invention. For example, if a combination of analysis tools in an event detector identifies several simultaneous (or near-simultaneous) types of activity in an input channel, a system according to the invention may be programmed to perform an action in response thereto. Details of the analysis tools and the combination processes used in event detectors according to the invention will be set forth in greater detail below. </paragraph>
<paragraph id="P-0109" lvl="0"><number>&lsqb;0109&rsqb;</number> In the second event detector <highlight><bold>816</bold></highlight>, only a wave morphology analysis unit <highlight><bold>836</bold></highlight> is active. Accordingly, no Boolean operation needs to be performed, and the wave morphology analysis unit <highlight><bold>836</bold></highlight> directly feeds an event detector output <highlight><bold>838</bold></highlight>. </paragraph>
<paragraph id="P-0110" lvl="0"><number>&lsqb;0110&rsqb;</number> The third event detector <highlight><bold>822</bold></highlight> operates on two input channels <highlight><bold>818</bold></highlight> and <highlight><bold>820</bold></highlight>, and includes two separate detection channels of analysis units: a first wave morphology analysis unit <highlight><bold>840</bold></highlight> and a first window analysis unit <highlight><bold>842</bold></highlight>, the latter including a first line length analysis tool <highlight><bold>844</bold></highlight> and a first area analysis tool <highlight><bold>846</bold></highlight>; and a second wave morphology analysis unit <highlight><bold>848</bold></highlight> and a second window analysis unit <highlight><bold>850</bold></highlight>, the latter including a second line length analysis tool <highlight><bold>852</bold></highlight> and a second area analysis tool <highlight><bold>854</bold></highlight>. The two detection channels of analysis units are combined to provide a single event detector output <highlight><bold>856</bold></highlight>. </paragraph>
<paragraph id="P-0111" lvl="0"><number>&lsqb;0111&rsqb;</number> In the first detection channel of analysis units <highlight><bold>840</bold></highlight> and <highlight><bold>842</bold></highlight>, outputs from the first wave morphology analysis unit <highlight><bold>840</bold></highlight>, the first line length analysis tool <highlight><bold>844</bold></highlight>, and the first area analysis tool <highlight><bold>846</bold></highlight> are combined via a Boolean AND operation <highlight><bold>858</bold></highlight> into a first detection channel output <highlight><bold>860</bold></highlight>. Similarly, in the second detection channel of analysis units <highlight><bold>848</bold></highlight> and <highlight><bold>850</bold></highlight>, outputs from the second wave morphology analysis unit <highlight><bold>848</bold></highlight>, the second line length analysis tool <highlight><bold>852</bold></highlight>, and the second area analysis tool <highlight><bold>854</bold></highlight> are combined via a Boolean AND operation <highlight><bold>862</bold></highlight> into a second detection channel output <highlight><bold>864</bold></highlight>. In the illustrated embodiment of the invention, the second detection channel output <highlight><bold>864</bold></highlight> is invertible with selectable Boolean logic inversion <highlight><bold>866</bold></highlight> before it is combined with the first detection channel output <highlight><bold>860</bold></highlight>. Subsequently, the first detection channel output <highlight><bold>860</bold></highlight> and the second detection channel output <highlight><bold>864</bold></highlight> are combined with a Boolean AND operation <highlight><bold>868</bold></highlight> to provide a signal to the output <highlight><bold>856</bold></highlight>. In an alternative embodiment, a Boolean OR operation is used to combine the first detection channel output <highlight><bold>860</bold></highlight> and the second detection channel output <highlight><bold>864</bold></highlight>. </paragraph>
<paragraph id="P-0112" lvl="0"><number>&lsqb;0112&rsqb;</number> In one embodiment of the invention, the second detection channel (analysis units <highlight><bold>848</bold></highlight> and <highlight><bold>850</bold></highlight>) represents a &ldquo;qualifying channel&rdquo; with respect to the first detection channel (analysis units <highlight><bold>840</bold></highlight> and <highlight><bold>842</bold></highlight>). In general, a qualifying channel allows a detection to be made only when both channels are in concurrence with regard to detection of an event. For example, a qualifying channel can be used to indicate when a seizure has &ldquo;generalized,&rdquo; i.e. spread through a significant portion of a patient&apos;s brain. To do this, the third input channel <highlight><bold>818</bold></highlight> and the fourth input channel <highlight><bold>820</bold></highlight> are configured to receive EEG waveforms from separate amplifier channels coupled to electrodes in separate parts of the patient&apos;s brain (e.g., in opposite hemispheres). Accordingly, then, the Boolean AND operation <highlight><bold>868</bold></highlight> will indicate a detection only when the first detection output <highlight><bold>860</bold></highlight> and the second detection output <highlight><bold>864</bold></highlight> both indicate the presence of an event (or, when Boolean logic inversion <highlight><bold>866</bold></highlight> is present, when the first detection output <highlight><bold>860</bold></highlight> indicates the presence of an event while the second detection output <highlight><bold>864</bold></highlight> does not). As will be described in further detail below, the detection outputs <highlight><bold>860</bold></highlight> and <highlight><bold>864</bold></highlight> can be provided with selectable persistence (i.e., the ability to remain triggered for some time after the event is detected), allowing the Boolean AND combination <highlight><bold>868</bold></highlight> to be satisfied even when there is not precise temporal synchronization between detections on the two channels. </paragraph>
<paragraph id="P-0113" lvl="0"><number>&lsqb;0113&rsqb;</number> It should be appreciated that the concept of a &ldquo;qualifying channel&rdquo; allows the flexible configuration of a device <highlight><bold>110</bold></highlight> according to the invention to achieve a number of advantageous results. In addition to the detection of generalization, as described above, a qualifying channel can be configured, for example, to detect noise so a detection output is valid only when noise is not present, to assist in device configuration in determining which of two sets of detection parameters is preferable (by setting up the different parameters in the first detection channel and the second detection channel, then replacing the Boolean AND combination with a Boolean OR combination), or to require a specific temporal sequence of detections (which would be achieved in software by the CPU <highlight><bold>428</bold></highlight> after a Boolean OR combination of detections). There are numerous other possibilities. </paragraph>
<paragraph id="P-0114" lvl="0"><number>&lsqb;0114&rsqb;</number> The outputs <highlight><bold>834</bold></highlight>, <highlight><bold>838</bold></highlight>, and <highlight><bold>856</bold></highlight> of the event detectors are preferably represented by Boolean flags, and as described below, provide information for the operation of a system according to the invention. </paragraph>
<paragraph id="P-0115" lvl="0"><number>&lsqb;0115&rsqb;</number> While <cross-reference target="DRAWINGS">FIG. 8</cross-reference> illustrates four different sensing channels providing input to four separate detection channels, it should be noted that a maximally flexible embodiment of the present invention would allow each sensing channel to be connected to one or more detection channels. It may be advantageous to program the different detection channels with different settings (e.g., thresholds) to facilitate alternate &ldquo;views&rdquo; of the same sensing channel data stream. </paragraph>
<paragraph id="P-0116" lvl="0"><number>&lsqb;0116&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> illustrates three representative waveforms of the type expected to be manipulated by a system according to the invention. It should be noted, however, that the waveforms illustrated in <cross-reference target="DRAWINGS">FIG. 9</cross-reference> are illustrative only, and are not intended to represent any actual data. The first waveform <highlight><bold>910</bold></highlight> is representative of an unprocessed electroencephalogram (EEG) or electrocorticogram (ECOG) waveform having a substantial amount of variability; the illustrated segment has a duration of approximately 160 ms and a dominant frequency (visible as the large-scale crests and valleys) of approximately 12.5 Hz. It will be recognized that the first waveform is rather rough and peaky; there is a substantial amount of high-frequency energy represented therein. </paragraph>
<paragraph id="P-0117" lvl="0"><number>&lsqb;0117&rsqb;</number> The second waveform <highlight><bold>912</bold></highlight> represents a filtered version of the original EEG waveform <highlight><bold>910</bold></highlight>. As shown, most of the high-frequency energy has been eliminated from the signal, and the waveform <highlight><bold>912</bold></highlight> is significantly smoother. In the disclosed embodiment of the invention, this filtering operation is performed in the sensing front end <highlight><bold>512</bold></highlight> before the analog to digital converters <highlight><bold>612</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 6</cross-reference>). </paragraph>
<paragraph id="P-0118" lvl="0"><number>&lsqb;0118&rsqb;</number> The filtered waveform <highlight><bold>912</bold></highlight> is then sampled by one of the analog to digital converters <highlight><bold>612</bold></highlight>; this operation is represented graphically in the third waveform <highlight><bold>914</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. As illustrated, a sample rate used in an embodiment of the invention is 250 Hz (4 ms sample duration), resulting in approximately 40 samples over the illustrated 160 ms segment. As is well known in the art of digital signal processing, the amplitude resolution of each sample is limited; in the disclosed embodiment, each sample is measured with a resolution of 10 bits (or 1024 possible values). As is apparent upon visual analysis of the third waveform, the dominant frequency component has a wavelength of approximately 20 samples, which corresponds to the dominant frequency of 12.5 Hz. </paragraph>
<paragraph id="P-0119" lvl="0"><number>&lsqb;0119&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 10</cross-reference>, the processing of the wave morphology analysis units <highlight><bold>712</bold></highlight> is described in conjunction with a filtered and sampled waveform <highlight><bold>1010</bold></highlight> of the type illustrated as the third waveform <highlight><bold>914</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. </paragraph>
<paragraph id="P-0120" lvl="0"><number>&lsqb;0120&rsqb;</number> In a first half wave <highlight><bold>1012</bold></highlight>, which is partially illustrated in <cross-reference target="DRAWINGS">FIG. 10</cross-reference> (the starting point occurs before the illustrated waveform segment <highlight><bold>1010</bold></highlight> begins), the waveform segment <highlight><bold>1010</bold></highlight> is essentially monotonically decreasing, except for a small first perturbation <highlight><bold>1014</bold></highlight>. Accordingly, the first half wave <highlight><bold>1012</bold></highlight> is represented by a vector from the starting point (not shown) to a first local extremum <highlight><bold>1016</bold></highlight>, where the waveform starts to move in the opposite direction. The first perturbation <highlight><bold>1014</bold></highlight> is of insufficient amplitude to be considered a local extremum, and is disregarded by a hysteresis mechanism (discussed in further detail below). A second half wave <highlight><bold>1018</bold></highlight> extends between the first local extremum <highlight><bold>1016</bold></highlight> and a second local extremum <highlight><bold>1020</bold></highlight>. Again, a second perturbation <highlight><bold>1022</bold></highlight> is of insufficient amplitude to be considered an extremum. Likewise, a third half wave <highlight><bold>1024</bold></highlight> extends between the second local extremum <highlight><bold>1020</bold></highlight> and a third local extremum <highlight><bold>1026</bold></highlight>; this may appear to be a small perturbation, but is greater in amplitude than a selected hysteresis threshold. The remaining half waves <highlight><bold>1028</bold></highlight>, <highlight><bold>1030</bold></highlight>, <highlight><bold>1032</bold></highlight>, <highlight><bold>1034</bold></highlight>, and <highlight><bold>1036</bold></highlight> are identified analogously. As will be discussed in further detail below, each of the identified half waves <highlight><bold>1012</bold></highlight>, <highlight><bold>1018</bold></highlight>, <highlight><bold>1024</bold></highlight>, <highlight><bold>1028</bold></highlight>, <highlight><bold>1030</bold></highlight>, <highlight><bold>1032</bold></highlight>, <highlight><bold>1034</bold></highlight>, and <highlight><bold>1036</bold></highlight> has a corresponding duration <highlight><bold>1038</bold></highlight>, <highlight><bold>1040</bold></highlight>, <highlight><bold>1042</bold></highlight>, <highlight><bold>1044</bold></highlight>, <highlight><bold>1046</bold></highlight>, <highlight><bold>1048</bold></highlight>, <highlight><bold>1050</bold></highlight>, and <highlight><bold>1052</bold></highlight>, respectively, and analogously, a corresponding amplitude determined from the relative positions of each half wave&apos;s starting point and ending point along the vertical axis, and a slope direction, increasing or decreasing. </paragraph>
<paragraph id="P-0121" lvl="0"><number>&lsqb;0121&rsqb;</number> In a method performed according to the invention, it is particularly advantageous to allow for a programmable hysteresis setting in identifying the ends of half waves. In other words, as explained above, the end of an increasing or decreasing half wave might be prematurely identified as a result of quantization (and other) noise, low-amplitude signal components, and other perturbing factors, unless a small hysteresis allowance is made before a reversal of waveform direction (and a corresponding half wave end) is identified. Hysteresis allows for insignificant variations in signal level inconsistent with the signal&apos;s overall movement to be ignored without the need for extensive further signal processing such as filtering. Without hysteresis, such small and insignificant variations might lead to substantial and gross changes in where half waves are identified, leading to unpredictable results. </paragraph>
<paragraph id="P-0122" lvl="0"><number>&lsqb;0122&rsqb;</number> The processing steps performed with regard to the waveform <highlight><bold>1010</bold></highlight> and half waves of <cross-reference target="DRAWINGS">FIG. 10</cross-reference> are set forth in <cross-reference target="DRAWINGS">FIG. 11</cross-reference>. The method begins by identifying an increasing half wave (with an ending amplitude higher than the starting amplitude, as in the second half wave <highlight><bold>1018</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 10</cross-reference>). To do this, a variable corresponding to half wave time is first initialized to zero (step <highlight><bold>1110</bold></highlight>); then half wave duration, ending threshold, peak amplitude, and first sample value are all initialized (step <highlight><bold>1112</bold></highlight>). Specifically, the half wave duration value is set to zero; the peak amplitude and first sample values are set to the amplitude value of the last observed sample, which as described above is a value having 10-bit precision; and the ending threshold is set to the last observed sample minus a small preset hysteresis value. After waiting for a measurement of the current EEG sample (step <highlight><bold>1114</bold></highlight>), the half wave time and half wave duration variables are incremented (step <highlight><bold>1116</bold></highlight>). If the current EEG sample has an amplitude greater than the peak amplitude (step <highlight><bold>1118</bold></highlight>), then the amplitude of the half wave is increasing (or continues to increase). Accordingly, the ending threshold is reset to be the current EEG sample&apos;s amplitude minus the hysteresis value, and the peak is reset to the current EEG sample&apos;s amplitude (step <highlight><bold>1120</bold></highlight>), and the next sample is awaited (step <highlight><bold>1114</bold></highlight>). </paragraph>
<paragraph id="P-0123" lvl="0"><number>&lsqb;0123&rsqb;</number> If the current EEG sample has an amplitude less than the ending threshold (step <highlight><bold>1122</bold></highlight>), then the hysteresis value has been exceeded, and a local extremum has been identified. Accordingly, the end of the increasing half wave has been reached, and the amplitude and duration of the half wave are calculated (step <highlight><bold>1124</bold></highlight>). The amplitude is equal to the peak amplitude minus the first sample value; the duration is equal to the current half wave duration. Otherwise, the next ample is awaited (step <highlight><bold>1114</bold></highlight>). </paragraph>
<paragraph id="P-0124" lvl="0"><number>&lsqb;0124&rsqb;</number> If both the amplitude and the duration qualify by exceeding corresponding preset thresholds (step <highlight><bold>1126</bold></highlight>), then the amplitude, duration, half wave time, half wave direction (increasing) are stored in a buffer (step <highlight><bold>1128</bold></highlight>), and the half wave time is reset to zero (step <highlight><bold>1130</bold></highlight>). </paragraph>
<paragraph id="P-0125" lvl="0"><number>&lsqb;0125&rsqb;</number> At the conclusion of the increasing half wave, the process continues by initializing wave duration, the ending threshold, the peak amplitude, and the first sample value (step <highlight><bold>1132</bold></highlight>). Wave duration is set to zero, the ending threshold is set to the last sample value plus the hysteresis value, the peak amplitude and the first sample value are set to the most recent sample value. </paragraph>
<paragraph id="P-0126" lvl="0"><number>&lsqb;0126&rsqb;</number> After waiting for a measurement of the current EEG sample (step <highlight><bold>1134</bold></highlight>), the half wave time and half wave duration variables are incremented (step <highlight><bold>1136</bold></highlight>). If the current EEG sample has an amplitude lower than the peak amplitude (step <highlight><bold>1138</bold></highlight>), then the amplitude of the half wave is decreasing (or continues to decrease). Accordingly, the ending threshold is reset to be the current EEG sample&apos;s amplitude plus the hysteresis value, the peak is reset to the current EEG sample&apos;s amplitude (step <highlight><bold>1140</bold></highlight>), and the next sample is awaited (step <highlight><bold>1134</bold></highlight>). </paragraph>
<paragraph id="P-0127" lvl="0"><number>&lsqb;0127&rsqb;</number> If the current EEG sample has an amplitude greater than the ending threshold (step <highlight><bold>1142</bold></highlight>), then the hysteresis value has been exceeded, and a local extremum has been identified. Accordingly, the end of the decreasing half wave has been reached, and the amplitude and duration of the half wave are calculated (step <highlight><bold>1144</bold></highlight>). The amplitude is equal to the first sample value minus the peak amplitude, and the duration is equal to the current half wave duration. Otherwise, the next EEG sample is awaited (step <highlight><bold>1134</bold></highlight>). </paragraph>
<paragraph id="P-0128" lvl="0"><number>&lsqb;0128&rsqb;</number> If both the amplitude and the duration qualify by exceeding corresponding preset thresholds (step <highlight><bold>1146</bold></highlight>), then the amplitude, duration, half wave time, half wave direction (decreasing) are stored in a buffer (step <highlight><bold>1148</bold></highlight>), and the half wave time is reset to zero (step <highlight><bold>1150</bold></highlight>). It should be noted that, in the context of this specification, the term &ldquo;exceed&rdquo; in regard to a threshold value means to meet a specified criterion. Generally, to exceed a threshold herein is to have a numeric value greater than or equal to the threshold, although other interpretations (such as greater than, or less than, or less than or equal to, depending on the context) may be applicable and are deemed to be within the scope of the invention. </paragraph>
<paragraph id="P-0129" lvl="0"><number>&lsqb;0129&rsqb;</number> At the conclusion of the decreasing half wave, further half waves are then identified by repeating the process from step <highlight><bold>1112</bold></highlight>. As half wave detection is an ongoing and continuous process, this procedure preferably does not exit, but may be suspended from time to time when conditions or device state call for it, e.g. when the device is inactive or when stimulation is being performed. Once suspended in accordance with the invention, the procedure should recommence with the first initialization step <highlight><bold>1110</bold></highlight>. </paragraph>
<paragraph id="P-0130" lvl="0"><number>&lsqb;0130&rsqb;</number> Accordingly, the process depicted in <cross-reference target="DRAWINGS">FIG. 11</cross-reference> stores parameters corresponding to qualified half waves, including their directions, durations, amplitudes, and the elapsed time between adjacent qualified half waves (i.e. the half wave time variable). In the disclosed embodiment of the invention, to reduce power consumption, this procedure is performed in custom electronic hardware; it should be clear that the operations of <cross-reference target="DRAWINGS">FIG. 11</cross-reference> are performed in parallel for each active instance of the wave morphology analysis units <highlight><bold>712</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 7</cross-reference>). It should also be noted, however, that certain software can also be used to advantageous effect in this context. </paragraph>
<paragraph id="P-0131" lvl="0"><number>&lsqb;0131&rsqb;</number> This stored information is used in the software process illustrated in <cross-reference target="DRAWINGS">FIG. 12</cross-reference>, which is performed on a periodic basis, preferably once every processing window (a recurring time interval that is either fixed or programmable) by a system according to the invention. Consistent with the other analysis tools described herein, the duration of an exemplary processing window is in one embodiment of the invention 128 ms, which corresponds to 32 samples at a 250 Hz sampling rate. </paragraph>
<paragraph id="P-0132" lvl="0"><number>&lsqb;0132&rsqb;</number> Each time the software process of <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is invoked, the half wave window flag is first cleared (step <highlight><bold>1210</bold></highlight>). Any qualified half waves identified by the process set forth in <cross-reference target="DRAWINGS">FIG. 11</cross-reference> that are newly identified since the last invocation of the procedure (i.e., all qualified half waves that ended within the preceding processing window) are identified (step <highlight><bold>1212</bold></highlight>). A &ldquo;current half wave&rdquo; pointer is set to point to the oldest qualified half wave identified in the most recent processing window (step <highlight><bold>1214</bold></highlight>). The time interval between the current half wave and the prior x half waves is then measured (step <highlight><bold>1216</bold></highlight>), where x is a specified minimum number of half waves (preferably a programmable value) to be identified within a selected half wave time window (the duration of which is another programmable value) to result in the possible detection of a neurological event. If the time interval is less than the duration of the half wave time window (step <highlight><bold>1218</bold></highlight>), then the half wave window flag is set (step <highlight><bold>1220</bold></highlight>), logic inversion is selectively applied (step <highlight><bold>1222</bold></highlight>), and the procedure ends (step <highlight><bold>1224</bold></highlight>). Logic inversion, a mechanism for determining whether an analysis unit is triggered by the presence or absence of a condition, is explained in greater detail below. Otherwise, the current half wave pointer is incremented to point to the next new half wave (step <highlight><bold>1228</bold></highlight>), and if there are no more new half waves (step <highlight><bold>1230</bold></highlight>), logic inversion is applied if desired (step <highlight><bold>1222</bold></highlight>), and the procedure ends (step <highlight><bold>1224</bold></highlight>). Otherwise, the next time interval is tested (step <highlight><bold>1216</bold></highlight>) and the process continues from there. </paragraph>
<paragraph id="P-0133" lvl="0"><number>&lsqb;0133&rsqb;</number> Logic inversion allows the output flag for the wave morphology analysis unit (or any other analyzer) to be selectively inverted. If logic inversion is configured to be applied to an output of a particular analysis unit, then the corresponding flag will be clear when the detection criterion (e.g., number of qualified half waves) is met, and set when the detection criterion is not met. This capability provides some additional flexibility in configuration, facilitating detection of the absence of certain signal characteristics when, for example, the presence of those characteristics is the norm. </paragraph>
<paragraph id="P-0134" lvl="0"><number>&lsqb;0134&rsqb;</number> In a preferred embodiment of the invention, the half wave window flag (set in step <highlight><bold>1220</bold></highlight>) indicates whether a sufficient number of qualified half waves occur over an interval ending in the most recent processing window. To reduce the occurrence of spurious detections, an X of Y criterion is applied, causing the wave morphology analysis unit to trigger only if a sufficient number of qualified half waves occur in X of the Y most recent processing windows, where X and Y are parameters individually adjustable for each analysis tool. This process is illustrated in <cross-reference target="DRAWINGS">FIG. 13</cross-reference>. </paragraph>
<paragraph id="P-0135" lvl="0"><number>&lsqb;0135&rsqb;</number> Initially, a sum (representing recent processing windows having the half wave window flag set) is cleared to zero and a current window pointer is initialized to point to the most recent processing window (step <highlight><bold>1310</bold></highlight>). If the half wave window flag corresponding to the current window pointer is set (step <highlight><bold>1312</bold></highlight>), then the sum is incremented (step <highlight><bold>1314</bold></highlight>). If there are more processing windows to examine (for an X of Y criterion, a total of Y processing windows, including the most recent, should be considered) (step <highlight><bold>1316</bold></highlight>), then the window pointer is decremented (step <highlight><bold>1318</bold></highlight>) and the flag testing and sum incrementing steps (steps <highlight><bold>1312</bold></highlight>-<highlight><bold>1314</bold></highlight>) are repeated. </paragraph>
<paragraph id="P-0136" lvl="0"><number>&lsqb;0136&rsqb;</number> After Y windows have been considered, if the sum of windows having set half wave window flags meets the threshold X (step <highlight><bold>1320</bold></highlight>), then the half wave analysis flag is set (step <highlight><bold>1322</bold></highlight>), persistence (described below) is applied (step <highlight><bold>1324</bold></highlight>), and the procedure is complete. Otherwise, the half wave analysis flag is cleared (step <highlight><bold>1326</bold></highlight>). </paragraph>
<paragraph id="P-0137" lvl="0"><number>&lsqb;0137&rsqb;</number> Persistence, another per-analysis-tool setting, allows the effect of an event detection (a flag set) to persist beyond the end of the detection window in which the event occurs. In the disclosed system according to the invention, persistence may be set anywhere from one second to fifteen seconds (though other settings are possible), so if detections with multiple analysis tools do not all occur simultaneously (though they should still occur within a fairly short time period), a Boolean combination of flags will still yield positive results. Persistence can also be used with a single analysis tool to smooth the results. </paragraph>
<paragraph id="P-0138" lvl="0"><number>&lsqb;0138&rsqb;</number> When the process of <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is completed, the half wave analysis flag (set or cleared in steps <highlight><bold>1322</bold></highlight> and <highlight><bold>1326</bold></highlight>, respectively) indicates whether an event has been detected in the corresponding channel of the wave morphology analysis units <highlight><bold>712</bold></highlight>, or stated another way, whether a sufficient number of qualified half waves have appeared in X of the Y most recent processing windows. Although in the disclosed embodiment, the steps of <cross-reference target="DRAWINGS">FIGS. 12 and 13</cross-reference> are performed in software, it should be recognized that some or all of those steps can be performed using custom electronics, if it proves advantageous in the desired application to use such a configuration. </paragraph>
<paragraph id="P-0139" lvl="0"><number>&lsqb;0139&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 14</cross-reference> illustrates the waveform of <cross-reference target="DRAWINGS">FIG. 9</cross-reference>, further depicting line lengths identified within a time window. The time window used with respect to FIGS. <highlight><bold>14</bold></highlight>-<highlight><bold>16</bold></highlight> may be different from the half wave processing window described above in connection with FIGS. <highlight><bold>12</bold></highlight>-<highlight><bold>13</bold></highlight>, but in a preferred embodiment, refers to the same time intervals. From an implementation standpoint, a single device interrupt upon the conclusion of each processing window allows all of the analysis tools to perform the necessary corresponding software processes; the line length analysis process of <cross-reference target="DRAWINGS">FIG. 16</cross-reference> (described below) is one such example. A waveform <highlight><bold>1410</bold></highlight> is a filtered and otherwise pre-processed EEG signal as received in one of the window analysis units <highlight><bold>714</bold></highlight> from the sensing front end <highlight><bold>512</bold></highlight>. As discussed above, line lengths are considered within time windows. As illustrated in <cross-reference target="DRAWINGS">FIG. 14</cross-reference>, the duration of an exemplary window <highlight><bold>1412</bold></highlight> is 32 samples, which is equivalent to 128 ms at a 250 Hz sampling rate. </paragraph>
<paragraph id="P-0140" lvl="0"><number>&lsqb;0140&rsqb;</number> The total line length for the window <highlight><bold>1412</bold></highlight> is the sum of the sample-to-sample amplitude differences within that window <highlight><bold>1412</bold></highlight>. For example, the first contribution to the line length within the window <highlight><bold>1412</bold></highlight> is a first amplitude difference <highlight><bold>1414</bold></highlight> between a previous sample <highlight><bold>1416</bold></highlight> occurring immediately before the window <highlight><bold>1412</bold></highlight> and a first sample <highlight><bold>1418</bold></highlight> occurring within the window <highlight><bold>1412</bold></highlight>. The next contribution comes from a second amplitude difference <highlight><bold>1420</bold></highlight> between the first sample <highlight><bold>1418</bold></highlight> and a second sample <highlight><bold>1422</bold></highlight>; a further contribution <highlight><bold>1424</bold></highlight> comes from a third amplitude difference between the second sample <highlight><bold>1422</bold></highlight> and a third sample <highlight><bold>1426</bold></highlight>; and so on. At the end of the window <highlight><bold>1412</bold></highlight>, the final contribution to the line length comes from a last amplitude difference <highlight><bold>1430</bold></highlight> between a second-last sample <highlight><bold>1432</bold></highlight> in the window <highlight><bold>1412</bold></highlight> and a last sample <highlight><bold>1434</bold></highlight> in the window <highlight><bold>1412</bold></highlight>. Note that all line lengths, whether increasing or decreasing in direction, are accumulated as positive values by the invention; accordingly, a decreasing amplitude difference <highlight><bold>1414</bold></highlight> and an increasing amplitude difference <highlight><bold>1428</bold></highlight> both contribute to a greater line length. </paragraph>
<paragraph id="P-0141" lvl="0"><number>&lsqb;0141&rsqb;</number> As illustrated herein, and as discussed in detail above, there are thirty-two samples within the window <highlight><bold>1412</bold></highlight>. The illustrated window <highlight><bold>1412</bold></highlight> has a duration of 128 ms, and accordingly, the illustrated sample rate is 250 Hz. It should be noted, however, that alternate window durations and sample rates are possible and considered to be within the scope of the present invention. </paragraph>
<paragraph id="P-0142" lvl="0"><number>&lsqb;0142&rsqb;</number> The line lengths illustrated in <cross-reference target="DRAWINGS">FIG. 14</cross-reference> are calculated as shown by the flow chart of <cross-reference target="DRAWINGS">FIG. 15</cross-reference>, which is invoked at the beginning of a time window. Initially, a line length total variable is initialized to zero (step <highlight><bold>1510</bold></highlight>). The current sample is awaited (step <highlight><bold>1512</bold></highlight>), and the absolute value of the amplitude difference between the current sample and the previous sample (which, when considering the first sample in a window, may come from the last sample in a previous window) is measured (step <highlight><bold>1514</bold></highlight>). </paragraph>
<paragraph id="P-0143" lvl="0"><number>&lsqb;0143&rsqb;</number> In various alternative embodiments of the invention, either the measured difference (as calculated in step <highlight><bold>1514</bold></highlight>, described above), or the sample values used to calculate the difference may be mathematically transformed in useful nonlinear ways. For example, it may be advantageous in certain circumstances to calculate the difference between adjacent samples using the squares of the sample values, or to calculate the square of the difference between sample values, or both. It is contemplated that other transformations (such as square root, exponentiation, logarithm, and other nonlinear functions) might also be advantageous in certain circumstances. Whether or not to perform such a transformation and the nature of any transformation to be performed are preferably programmable parameters of the device <highlight><bold>110</bold></highlight>. </paragraph>
<paragraph id="P-0144" lvl="0"><number>&lsqb;0144&rsqb;</number> For use in the next iteration, the previous sample is replaced with the value of the current sample (step <highlight><bold>1516</bold></highlight>), and the calculated absolute value is added to the total (step <highlight><bold>1518</bold></highlight>). If there are more samples remaining in the window <highlight><bold>1412</bold></highlight> (step <highlight><bold>1520</bold></highlight>), another current sample is awaited (step <highlight><bold>1512</bold></highlight>) and the process continues. Otherwise, the line length calculation for the window <highlight><bold>1412</bold></highlight> is complete, and the total is stored (step <highlight><bold>1522</bold></highlight>), the total is re-initialized to zero (step <highlight><bold>1510</bold></highlight>), and the process continues. </paragraph>
<paragraph id="P-0145" lvl="0"><number>&lsqb;0145&rsqb;</number> As with the half wave analysis method set forth above, the line length calculation does not need to terminate; it can be free-running yet interruptible. If the line length calculation is restarted after having been suspended, it should be re-initialized and restarted at the beginning of a window. This synchronization can be accomplished through hardware interrupts. </paragraph>
<paragraph id="P-0146" lvl="0"><number>&lsqb;0146&rsqb;</number> The line lengths calculated as shown in <cross-reference target="DRAWINGS">FIG. 15</cross-reference> are then processed as indicated in the flow chart of <cross-reference target="DRAWINGS">FIG. 16</cross-reference>, which is performed after each window <highlight><bold>1412</bold></highlight> is calculated and stored (step <highlight><bold>1522</bold></highlight>). </paragraph>
<paragraph id="P-0147" lvl="0"><number>&lsqb;0147&rsqb;</number> The process begins by calculating a running accumulated line length total over a period of n time windows. Where n&gt;1, the effect is that of a sliding window; in an alternative embodiment an actual sliding window processing methodology may be used. First, the accumulated total is initialized to zero (step <highlight><bold>1610</bold></highlight>). A current window pointer is set to indicate the n<highlight><superscript>th</superscript></highlight>-last window, i.e., the window (n&minus;1) windows before the most recent window (step <highlight><bold>1612</bold></highlight>). The line length of the current window is added to the total (step <highlight><bold>1614</bold></highlight>), the current window pointer is incremented (step <highlight><bold>1616</bold></highlight>), and if there are more windows between the current window pointer and the most recent (last) window (step <highlight><bold>1618</bold></highlight>), the adding and incrementing steps (<highlight><bold>1614</bold></highlight>-<highlight><bold>1616</bold></highlight>) are repeated. Accordingly, by this process, the resulting total includes the line lengths for each of the n most recent windows. </paragraph>
<paragraph id="P-0148" lvl="0"><number>&lsqb;0148&rsqb;</number> In the disclosed embodiment of the invention, the accumulated total line length is compared to a dynamic threshold, which is based on a trend of recently observed line lengths. The trend is recalculated regularly and periodically, after each recurring line length trend interval (which is preferably a fixed or programmed time interval). Each time the line length trend interval passes (step <highlight><bold>1620</bold></highlight>), the line length trend is calculated or updated (step <highlight><bold>1622</bold></highlight>). In a presently preferred embodiment of the invention, this is accomplished by calculating a normalized moving average of several trend samples, each of which represents several consecutive windows of line lengths. A new trend sample is taken and the moving average is recalculated upon every line length trend interval. The number of trend samples used in the normalized moving average and the number of consecutive windows of line length measurements per trend sample are preferably both fixed or programmable values. </paragraph>
<paragraph id="P-0149" lvl="0"><number>&lsqb;0149&rsqb;</number> After the line length trend has been calculated, the line length threshold is calculated (step <highlight><bold>1624</bold></highlight>) based on the new line length trend. In the disclosed embodiment of the invention, the threshold may be set as either a percentage of the line length trend (either below 100% for a threshold that is lower than the trend, or above 100% for a threshold that is higher than the trend) or alternatively a fixed numeric offset from the line length trend (either negative for a threshold that is lower than the trend, or positive for a threshold that is higher than the trend). It should be observed that other methods for deriving a numeric threshold from a numeric trend are possible and deemed to be within the scope of the invention. </paragraph>
<paragraph id="P-0150" lvl="0"><number>&lsqb;0150&rsqb;</number> The first time the process of <cross-reference target="DRAWINGS">FIG. 16</cross-reference> is performed, there is generally no line length trend against which to set a threshold. Accordingly, for the first several passes through the process (until a sufficient amount of EEG data has been processed to establish a trend), the threshold is essentially undefined and the line length detector should not return a positive detection. Some &ldquo;settling time&rdquo; is required to establish trends and thresholds before a detection can be made. </paragraph>
<paragraph id="P-0151" lvl="0"><number>&lsqb;0151&rsqb;</number> If the accumulated line length total exceeds the calculated threshold (step <highlight><bold>1626</bold></highlight>), then a flag is set (step <highlight><bold>1628</bold></highlight>) indicating a line-length-based event detection on the current window analysis unit channel <highlight><bold>714</bold></highlight>. As described above, in the disclosed embodiment of the invention, the threshold is dynamically calculated from a line length trend, but alternatively, the threshold may be static, either fixed or programmed into the device <highlight><bold>110</bold></highlight>. If the accumulated line length total does not exceed the threshold, the flag is cleared (step <highlight><bold>1630</bold></highlight>). Once the line length flag has been either set or cleared, logic inversion is applied (step <highlight><bold>1632</bold></highlight>), persistence is applied (step <highlight><bold>1634</bold></highlight>), and the procedure terminates. </paragraph>
<paragraph id="P-0152" lvl="0"><number>&lsqb;0152&rsqb;</number> The resulting persistent line length flag indicates whether the threshold has been exceeded within one or more windows over a time period corresponding to the line length flag persistence. As will be discussed in further detail below, line length event detections can be combined with the half wave event detections, as well as any other applicable detection criteria according to the invention. </paragraph>
<paragraph id="P-0153" lvl="0"><number>&lsqb;0153&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 17</cross-reference> illustrates the waveform of <cross-reference target="DRAWINGS">FIG. 9</cross-reference> with area under the curve identified within a window. Area under the curve, which in some circumstances is somewhat representative of a signal&apos;s energy (though energy of a waveform is more accurately represented by the area under the square of a waveform), is another detection criterion in accordance with the invention. </paragraph>
<paragraph id="P-0154" lvl="0"><number>&lsqb;0154&rsqb;</number> The total area under the curve represented by a waveform <highlight><bold>1710</bold></highlight> within the window <highlight><bold>1712</bold></highlight> is equal to the sum of the absolute values of the areas of each rectangular region of unit width vertically bounded by the horizontal axis and the sample. For example, the first contribution to the area under the curve within the window <highlight><bold>1712</bold></highlight> comes from a first region <highlight><bold>1714</bold></highlight> between a first sample <highlight><bold>1716</bold></highlight> and a baseline <highlight><bold>1717</bold></highlight>. A second contribution to the area under the curve within the window <highlight><bold>1712</bold></highlight> comes from a second region <highlight><bold>1718</bold></highlight>, including areas between a second sample <highlight><bold>1720</bold></highlight> and the baseline <highlight><bold>1717</bold></highlight>. There are similar regions and contributions for a third sample <highlight><bold>1722</bold></highlight> and the baseline <highlight><bold>1717</bold></highlight>, a fourth sample <highlight><bold>1724</bold></highlight> and the baseline <highlight><bold>1717</bold></highlight>, and so on. It should be observed that the region widths are not important&mdash;the area under each sample can be considered the product of the sample&apos;s amplitude and a unit width, which can be disregarded. In a similar manner, each region is accumulated and added to the total area under the curve within the window <highlight><bold>1712</bold></highlight>. Although the concept of separate rectangular regions is a useful construct for visualizing the idea of area under a curve, it should be noted that a process for calculating area need not partition areas into regions as shown in <cross-reference target="DRAWINGS">FIG. 17</cross-reference>&mdash;it is only necessary to accumulate the absolute value of the waveform&apos;s amplitude at each sample, as the unit width of each region can be disregarded. The process for doing this will be set forth in detail below in connection with <cross-reference target="DRAWINGS">FIG. 18</cross-reference>. </paragraph>
<paragraph id="P-0155" lvl="0"><number>&lsqb;0155&rsqb;</number> The areas under the curve illustrated in <cross-reference target="DRAWINGS">FIG. 17</cross-reference> are calculated as shown by the flow chart of <cross-reference target="DRAWINGS">FIG. 18</cross-reference>, which is invoked at the beginning of a time window. Initially, an area total variable is initialized to zero (step <highlight><bold>1810</bold></highlight>). The current sample is awaited (step <highlight><bold>1812</bold></highlight>), and the absolute value of the current sample is measured (step <highlight><bold>1814</bold></highlight>). </paragraph>
<paragraph id="P-0156" lvl="0"><number>&lsqb;0156&rsqb;</number> As with the line length calculation method described above (with reference to <cross-reference target="DRAWINGS">FIG. 15</cross-reference>), in various alternative embodiments of the invention, the current sample (as measured in step <highlight><bold>1814</bold></highlight>, described above) may be mathematically transformed in useful nonlinear ways. For example, it may be advantageous in certain circumstances to calculate the square of the current sample rather than its absolute value. The result of such a transformation by squaring each sample will generally be more representative of signal energy, though it is contemplated that other transformations (such as square root, exponentiation, logarithm, and other nonlinear functions) might also be advantageous in certain circumstances. Whether or not to perform such a transformation and the nature of any transformation to be performed are preferably programmable parameters of the device <highlight><bold>110</bold></highlight>. </paragraph>
<paragraph id="P-0157" lvl="0"><number>&lsqb;0157&rsqb;</number> The calculated absolute value is added to the total (step <highlight><bold>1816</bold></highlight>). If there are more samples remaining in the window <highlight><bold>1712</bold></highlight> (step <highlight><bold>1818</bold></highlight>), another current sample is awaited (step <highlight><bold>1812</bold></highlight>) and the process continues. Otherwise, the area calculation for the window <highlight><bold>1712</bold></highlight> is complete, and the total is stored (step <highlight><bold>1820</bold></highlight>), the total is reinitialized to zero (step <highlight><bold>1810</bold></highlight>), and the process continues. </paragraph>
<paragraph id="P-0158" lvl="0"><number>&lsqb;0158&rsqb;</number> As with the half wave and line length analysis methods set forth above, the area calculation does not need to terminate; it can be free-running yet interruptible. If the area calculation is restarted after having been suspended, it should be re-initialized and restarted at the beginning of a window. This synchronization can be accomplished through hardware interrupts. </paragraph>
<paragraph id="P-0159" lvl="0"><number>&lsqb;0159&rsqb;</number> The line lengths calculated as shown in <cross-reference target="DRAWINGS">FIG. 18</cross-reference> are then processed as indicated in the flow chart of <cross-reference target="DRAWINGS">FIG. 19</cross-reference>, which is performed after each window <highlight><bold>1712</bold></highlight> is calculated and stored (step <highlight><bold>1820</bold></highlight>). </paragraph>
<paragraph id="P-0160" lvl="0"><number>&lsqb;0160&rsqb;</number> The process begins by calculating a running accumulated area total over a period of n time windows. Where n&gt;1, the effect is that of a sliding window; in an alternative embodiment an actual sliding window processing methodology may be used. First, the accumulated total is initialized to zero (step <highlight><bold>1910</bold></highlight>). A current window pointer is set to indicate the n<highlight><superscript>th</superscript></highlight>-last window, i.e., the window (n&minus;1) windows before the most recent window (step <highlight><bold>1912</bold></highlight>). The area for the current window is added to the total (step <highlight><bold>1914</bold></highlight>), the current window pointer is incremented (step <highlight><bold>1916</bold></highlight>), and if there are more windows between the current window and the most recent (last) window (step <highlight><bold>1918</bold></highlight>), the adding and incrementing steps (<highlight><bold>1914</bold></highlight>-<highlight><bold>1916</bold></highlight>) are repeated. Accordingly, by this process, the resulting total includes the areas under the curve for each of the n most recent windows. </paragraph>
<paragraph id="P-0161" lvl="0"><number>&lsqb;0161&rsqb;</number> In the disclosed embodiment of the invention, the accumulated total area is compared to a dynamic threshold, which is based on a trend of recently observed areas. The trend is recalculated regularly and periodically, after each recurring area trend interval (which is preferably a fixed or programmed time interval). Each time the area trend interval passes (step <highlight><bold>1920</bold></highlight>), the area trend is calculated or updated (step <highlight><bold>1922</bold></highlight>). In a presently preferred embodiment of the invention, this is accomplished by calculating a normalized moving average of several trend samples, each of which represents several consecutive windows of areas. A new trend sample is taken and the moving average is recalculated upon every area trend interval. The number of trend samples used in the normalized moving average and the number of consecutive windows of area measurements per trend sample are preferably both fixed or programmable values. </paragraph>
<paragraph id="P-0162" lvl="0"><number>&lsqb;0162&rsqb;</number> After the area trend has been calculated, the area threshold is calculated (step <highlight><bold>1924</bold></highlight>) based on the new area trend. As with line length, discussed above, the threshold may be set as either a percentage of the area trend (either below 100% for a threshold that is lower than the trend, or above 100% for a threshold that is higher than the trend) or alternatively a fixed numeric offset from the area trend (either negative for a threshold that is lower than the trend, or positive for a threshold that is higher than the trend). </paragraph>
<paragraph id="P-0163" lvl="0"><number>&lsqb;0163&rsqb;</number> The first time the process of <cross-reference target="DRAWINGS">FIG. 19</cross-reference> is performed, there is generally no area trend against which to set a threshold. Accordingly, for the first several passes through the process (until a sufficient amount of EEG data has been processed to establish a trend), the threshold is essentially undefined and the area detector should not return a positive detection. Some &ldquo;settling time&rdquo; is required to establish trends and thresholds before a detection can be made. </paragraph>
<paragraph id="P-0164" lvl="0"><number>&lsqb;0164&rsqb;</number> If the accumulated total exceeds the calculated threshold (step <highlight><bold>1926</bold></highlight>), then a flag is set (step <highlight><bold>1928</bold></highlight>) indicating an area-based event detection on the current window analysis unit channel <highlight><bold>714</bold></highlight>. Otherwise, the flag is cleared (step <highlight><bold>1930</bold></highlight>). Once the area flag has been either set or cleared, logic inversion is applied (step <highlight><bold>1932</bold></highlight>), persistence is applied (step <highlight><bold>1934</bold></highlight>), and the procedure terminates. </paragraph>
<paragraph id="P-0165" lvl="0"><number>&lsqb;0165&rsqb;</number> The resulting persistent area flag indicates whether the threshold has been exceeded within one or more windows over a time period corresponding to the area flag persistence. As will be discussed in further detail below, area event detections can be combined with the half wave event detections, line length event detections, as well as any other applicable detection criteria according to the invention. </paragraph>
<paragraph id="P-0166" lvl="0"><number>&lsqb;0166&rsqb;</number> In a preferred embodiment of the invention, each threshold for each channel and each analysis tool can be programmed separately; accordingly, a large number of individual thresholds may be used in a system according to the invention. It should be noted thresholds can vary widely; they can be updated by a physician via the external programmer <highlight><bold>312</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 3</cross-reference>), and some analysis tool thresholds (e.g., line length and area) can also be automatically varied depending on observed trends in the data. This is preferably accomplished based on a moving average of a specified number of window observations of line length or area, adjusted as desired via a fixed offset or percentage offset, and may compensate to some extent for diurnal and other normal variations in brain electrophysiological parameters. </paragraph>
<paragraph id="P-0167" lvl="0"><number>&lsqb;0167&rsqb;</number> With regard to the flow charts of FIGS. <highlight><bold>11</bold></highlight>-<highlight><bold>13</bold></highlight>, <highlight><bold>15</bold></highlight>-<highlight><bold>16</bold></highlight>, and <highlight><bold>18</bold></highlight>-<highlight><bold>19</bold></highlight>, it should be noted that there can be a variety of ways these processes are implemented. For example, state machines, software, hardware (including ASICs, FPGAs, and other custom electronics), and various combinations of software and hardware, are all solutions that would be possible to practitioners of ordinary skill in the art of electronics and systems design. It should further be noted that the steps performed in software need not be, as some of them can be implemented in hardware, if desired, to further reduce computational load on the processor. In the context of the invention, it is not believed to be advantageous to have the software perform additional steps, as that would likely increase power consumption. </paragraph>
<paragraph id="P-0168" lvl="0"><number>&lsqb;0168&rsqb;</number> In an embodiment of the invention, one of the detection schemes set forth above (e.g., half wave detection) is adapted to use an X of Y criterion to weed out spurious detections. This can be implemented via a shift register, as usual, or by more efficient computational methods. As described above, half waves are analyzed on a window-by-window basis, and as described above (in connection with <cross-reference target="DRAWINGS">FIG. 13</cross-reference>), the window results are updated on a separate analysis window interval. If the detection criterion (i.e., a certain number of half waves in less than a specified time period) is met for any of the half waves occurring in the most recent window, then detection is satisfied within that window. If that occurs for at least X of the Y most recent windows, then the half wave analysis tool triggers a detection. If desired, other detection algorithms (such as line length and area) may operate in much the same way: if thresholds are exceeded in at least X of the Y most recent windows, then the corresponding analysis tool triggers a detection. </paragraph>
<paragraph id="P-0169" lvl="0"><number>&lsqb;0169&rsqb;</number> Also, in the disclosed embodiment, each detection flag, after being set, remains set for a selected amount of time, allowing them to be combined by Boolean logic (as described below) without necessarily being simultaneous. </paragraph>
<paragraph id="P-0170" lvl="0"><number>&lsqb;0170&rsqb;</number> As indicated above, each of the software processes set forth above (FIGS. <highlight><bold>12</bold></highlight>-<highlight><bold>13</bold></highlight>, <highlight><bold>16</bold></highlight>, and <highlight><bold>19</bold></highlight>) correspond to functions performed by the wave morphology analysis units <highlight><bold>712</bold></highlight> and window analysis units <highlight><bold>714</bold></highlight>. Each one is initiated periodically, typically once per detection window (<highlight><bold>1212</bold></highlight>, <highlight><bold>1512</bold></highlight>). The outputs from the half wave and window analysis units <highlight><bold>712</bold></highlight> and <highlight><bold>714</bold></highlight>, namely the flags generated in response to counted qualified half waves, accumulated line lengths, and accumulated areas are combined to identify event detections as functionally illustrated in <cross-reference target="DRAWINGS">FIG. 8</cross-reference> and as described via flow chart in <cross-reference target="DRAWINGS">FIG. 20</cross-reference>. </paragraph>
<paragraph id="P-0171" lvl="0"><number>&lsqb;0171&rsqb;</number> The process begins with the receipt of a timer interrupt (step <highlight><bold>2010</bold></highlight>), which is typically generated on a regular periodic basis to indicate the edges of successive time windows. Accordingly, in a system or method according to the disclosed embodiment of the invention, such a timer interrupt is received every 128 ms, or as otherwise programmed or designed. Then the half wave (step <highlight><bold>2012</bold></highlight>, FIGS. <highlight><bold>12</bold></highlight>-<highlight><bold>13</bold></highlight>), line length (step <highlight><bold>2014</bold></highlight>, <cross-reference target="DRAWINGS">FIG. 16</cross-reference>), and area (step <highlight><bold>2016</bold></highlight>, <cross-reference target="DRAWINGS">FIG. 19</cross-reference>) analysis tools are evaluated with respect to the latest data generated thereby, via the half wave analysis flag, the line length flag, and the area flag for each active channel. The steps of checking the analysis tools (steps <highlight><bold>2012</bold></highlight>, <highlight><bold>2014</bold></highlight>, and <highlight><bold>2016</bold></highlight>) can be performed in any desired order or in parallel, as they are generally not interdependent. It should be noted that the foregoing analysis tools should be checked for every active channel, and may be skipped for inactive detection channels. </paragraph>
<paragraph id="P-0172" lvl="0"><number>&lsqb;0172&rsqb;</number> Flags, indicating whether particular signal characteristics have been identified in each active channel, for each active analysis tools, are then combined into detection channels (step <highlight><bold>2018</bold></highlight>) as illustrated in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>. In the disclosed embodiment of the invention, this operation is performed as described in detail below with reference to <cross-reference target="DRAWINGS">FIG. 21</cross-reference>. Each detection channel is a Boolean AND combination of analysis tool flags for a single channel, and as disclosed above, there are preferably at least eight channels in a system according to the invention. </paragraph>
<paragraph id="P-0173" lvl="0"><number>&lsqb;0173&rsqb;</number> The flags for multiple detection channels are then combined into event detector flags (step <highlight><bold>2020</bold></highlight>), which are indicative of identified neurological events calling for action by the device. This process is described below, see <cross-reference target="DRAWINGS">FIG. 20</cross-reference>, and is in general a Boolean combination of detection channels, if there is more than one channel per event detector. </paragraph>
<paragraph id="P-0174" lvl="0"><number>&lsqb;0174&rsqb;</number> If an event detector flag is set (step <highlight><bold>2022</bold></highlight>), then a corresponding action is initiated (step <highlight><bold>2024</bold></highlight>) by the device. Actions according to the invention can include the presentation of a warning to the patient, an application of therapeutic electrical stimulation, a delivery of a dose of a drug, an initiation of a device mode change, or a recording of certain EEG signals; it will be appreciated that there are numerous other possibilities. It is preferred, but not necessary, for actions initiated by a device according to the invention to be performed in parallel with the sensing and detection operations described in detail herein. It should be recognized that the application of electrical stimulation to the brain may require suspension of certain of the sensing and detection operations, as electrical stimulation signals may otherwise feed back into the detection system <highlight><bold>422</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 4</cross-reference>), causing undesirable results and signal artifacts. </paragraph>
<paragraph id="P-0175" lvl="0"><number>&lsqb;0175&rsqb;</number> Multiple event detector flags are possible, each one representing a different combination of detection channel flags. If there are further event detector flags to consider (step <highlight><bold>2026</bold></highlight>), those event detector flags are also evaluated (step <highlight><bold>2022</bold></highlight>) and may cause further actions by the device (step <highlight><bold>2024</bold></highlight>). It should be noted that, in general, actions performed by the device (as in step <highlight><bold>2024</bold></highlight>) may be in part dependent on a device state&mdash;even if certain combinations of events do occur, no action may be taken if the device is in an inactive state, for example. </paragraph>
<paragraph id="P-0176" lvl="0"><number>&lsqb;0176&rsqb;</number> As described above, and as illustrated in <cross-reference target="DRAWINGS">FIG. 20</cross-reference> as step <highlight><bold>2018</bold></highlight>, a corresponding set of analysis tool flags is combined into a detection channel flag as shown in <cross-reference target="DRAWINGS">FIG. 21</cross-reference> (see also <cross-reference target="DRAWINGS">FIG. 8</cross-reference>). Initially the output detection channel flag is set (step <highlight><bold>2110</bold></highlight>). Beginning with the first analysis tool for a particular detection channel (step <highlight><bold>2112</bold></highlight>), if the corresponding analysis tool flag is not set (step <highlight><bold>2114</bold></highlight>), then the output detection channel flag is cleared (step <highlight><bold>2116</bold></highlight>). </paragraph>
<paragraph id="P-0177" lvl="0"><number>&lsqb;0177&rsqb;</number> If the corresponding analysis tool flag is set (step <highlight><bold>2114</bold></highlight>), the output detection channel flag remains set, and further analysis tools for the same channel, if any (step <highlight><bold>2118</bold></highlight>), are evaluated. Accordingly, this combination procedure operates as a Boolean AND operation&mdash;if any of the enabled and active analysis tools for a particular detection channel does not have a set output flag, then no detection channel flag is output by the procedure. </paragraph>
<paragraph id="P-0178" lvl="0"><number>&lsqb;0178&rsqb;</number> A clear analysis tool flag indicates that no detection has been made within the flag persistence period, and for those analysis tools that employ an X of Y criterion, that such criterion has not been met. In certain circumstances, it may be advantageous to also provide detection channel flags with logic inversion. Where a desired criterion (i.e., combination of analysis tools) is not met, the output flag is set (rather than cleared, which is the default action). This can be accomplished by providing selectable Boolean logic inversion (step <highlight><bold>2120</bold></highlight>) corresponding to each event detector. </paragraph>
<paragraph id="P-0179" lvl="0"><number>&lsqb;0179&rsqb;</number> Also as described above, and as illustrated in <cross-reference target="DRAWINGS">FIG. 20</cross-reference> as step <highlight><bold>2020</bold></highlight>, multiple detection channel flags are combined into a single event detector flag as shown in <cross-reference target="DRAWINGS">FIG. 22</cross-reference> (see also <cross-reference target="DRAWINGS">FIG. 8</cross-reference>). Initially the output event detector flag is set (step <highlight><bold>2210</bold></highlight>). Beginning with the first detection channel for a particular event detector (step <highlight><bold>2212</bold></highlight>), if the channel is not enabled (step <highlight><bold>2214</bold></highlight>), then no check is made. If the channel is enabled and the corresponding detection channel flag is not set (step <highlight><bold>2216</bold></highlight>), then the output event detector flag is cleared (step <highlight><bold>2218</bold></highlight>) and the combination procedure exits. If the corresponding detection channel flag is set (step <highlight><bold>2216</bold></highlight>), the output event detector flag remains set, and further detection channels, if any (step <highlight><bold>2220</bold></highlight>), are evaluated after incrementing the channel being considered (step <highlight><bold>2222</bold></highlight>). Accordingly, this combination procedure also operates as a Boolean AND operation&mdash;if any of the enabled and active detection channels does not have a set output flag, then no event detector flag is output by the procedure. It should also be observed that a Boolean OR combination of detection channels may provide useful information in certain circumstances; a software or hardware flow chart accomplishing such a combination is not illustrated, but could easily be created by an individual of ordinary skill in digital electronic design or computer programming. </paragraph>
<paragraph id="P-0180" lvl="0"><number>&lsqb;0180&rsqb;</number> An implantable version of a system according to the invention advantageously has a long-term average current consumption on the order of 10 microamps, allowing the implanted device to operate on power provided by a coin cell or similarly small battery for a period of years without need for replacement. It should be noted, however, that as battery and power supply configurations vary, the long-term average current consumption of a device according to the invention may also vary and still provide satisfactory performance. </paragraph>
<paragraph id="P-0181" lvl="0"><number>&lsqb;0181&rsqb;</number> It should be observed that while the foregoing detailed description of various embodiments of the present invention is set forth in some detail, the invention is not limited to those details and an implantable neurostimulator or neurological disorder detection device made according to the invention can differ from the disclosed embodiments in numerous ways. In particular, it will be appreciated that embodiments of the present invention may be employed in many different applications to detect anomalous neurological characteristics in at least one portion of a patient&apos;s brain. It will be appreciated that the functions disclosed herein as being performed by hardware and software, respectively, may be performed differently in an alternative embodiment. It should be further noted that functional distinctions are made above for purposes of explanation and clarity; structural distinctions in a system or method according to the invention may not be drawn along the same boundaries. Hence, the appropriate scope hereof is deemed to be in accordance with the claims as set forth below. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is claimed is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. An implantable device for detecting a neurological event by analyzing an electrical signal from a patient&apos;s brain, the device comprising: 
<claim-text>an implantable control module; </claim-text>
<claim-text>a central processing unit located within the control module; and </claim-text>
<claim-text>a detection subsystem located within the control module and comprising a waveform analyzer having a window-based analysis unit and a feature-based analysis unit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The implantable device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the detection subsystem performs a first portion of an event detection procedure, and the central processing unit performs a second portion of the event detection procedure. </claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The implantable device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the central processing unit and the detection subsystem are enclosed within a housing, and wherein the housing is implanted in the patient. </claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The implantable device of <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein the housing is implanted intracranially in the patient. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. The implantable device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the neurological event comprises an epileptic seizure, an onset of an epileptic seizure, a precursor to an epileptic seizure, an episode of a movement disorder, an onset of an episode of a movement disorder, a precursor to an episode of a movement disorder, a migraine headache, an onset of a migraine headache, a precursor to a migraine headache, an episode of pain, an onset of an episode of pain, a precursor to an episode of pain, an episode of depression, an onset of an episode of depression, or a precursor to an episode of depression. </claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The implantable device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the neurological event comprises an event predictive of an episode of clinical symptoms selected from the group consisting of an epileptic seizure, an episode of a movement disorder, a migraine headache, an episode of pain, and an episode of depression. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. The implantable device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the detection subsystem comprises at least one electronics module. </claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The implantable device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the feature-based analysis unit comprises a wave morphology analysis unit. </claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. The implantable device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the window-based analysis unit comprises a line length function analysis tool. </claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. The implantable device of <dependent-claim-reference depends_on="CLM-00009">claim 9</dependent-claim-reference>, wherein the window-based analysis unit further comprises an area function analysis tool. </claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. An implantable device for detecting a neurological event by analyzing an electrical signal from a patient&apos;s brain, the device comprising: 
<claim-text>an implantable control module; </claim-text>
<claim-text>a detection subsystem located within the control module and adapted to identify at least one feature in the electrical signal and calculate at least one window parameter in the electrical signal; and </claim-text>
<claim-text>a central processing unit located within the control module and adapted to analyze the at least one feature and the at least one window parameter, and to initiate an action in accordance therewith. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. An implantable device for detecting a neurological event by analyzing an electrical signal from a patient&apos;s brain, the device comprising: 
<claim-text>an implantable control module; </claim-text>
<claim-text>a central processing unit located within the control module; and </claim-text>
<claim-text>a detection subsystem located within the control module; </claim-text>
<claim-text>wherein the detection subsystem performs at least a portion of a detection task without the use of the central processing unit, thereby allowing the central processing unit to remain in a relatively inactive mode at least part of the time. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. An implantable device for detecting a neurological event by analyzing an electrical signal from a patient&apos;s brain, the device comprising: 
<claim-text>an implantable control module; </claim-text>
<claim-text>a plurality of electrodes including at least one brain electrode; and </claim-text>
<claim-text>a plurality of event detectors each adapted to analyze a signal from an electrode pair, wherein the electrode pair comprises two electrodes selected from the plurality of electrodes and including at least one brain electrode; </claim-text>
<claim-text>wherein each event detector of the plurality of event detectors is programmable with respect to at least one detection parameter; and </claim-text>
<claim-text>wherein each event detector of the plurality of event detectors is adapted to be selectively coupled to receive a signal from a corresponding electrode pair. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. An implantable device for detecting a neurological event by analyzing an electrical signal from a patient&apos;s brain, the device comprising: 
<claim-text>a central processing unit; </claim-text>
<claim-text>a detection subsystem comprising at least one electronics module and including a waveform analyzer having a window-based analysis unit adapted to analyze a line length function and an area function in the electrical signal, and a feature-based analysis unit adapted to analyze half waves in the electrical signal; and </claim-text>
<claim-text>a power supply; </claim-text>
<claim-text>wherein the detection subsystem includes a plurality of inputs and a plurality of detection channels; </claim-text>
<claim-text>wherein the window-based analysis unit includes a plurality of window analysis units and the feature-based analysis unit includes a plurality of wave morphology analysis units; </claim-text>
<claim-text>wherein the detection subsystem performs at least a portion of a detection task without the use of the central processing unit, thereby allowing the central processing unit to remain in a relatively inactive mode at least part of the time; </claim-text>
<claim-text>wherein the central processing unit, the detection subsystem, and the power supply are enclosed within a housing and implanted in the patient; and </claim-text>
<claim-text>wherein the neurological event comprises an epileptic seizure, an onset of an epileptic seizure, a precursor to an epileptic seizure, an episode of a movement disorder, an onset of an episode of a movement disorder, a precursor to an episode of a movement disorder, a migraine headache, an onset of a migraine headache, a precursor to a migraine headache, an episode of pain, an onset of an episode of pain, a precursor to an episode of pain, an episode of depression, an onset of an episode of depression, or a precursor to an episode of depression. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. A method for detecting a neurological event by analyzing an electrical signal from a patient&apos;s brain with an implantable device, the method comprising the steps of: 
<claim-text>receiving the electrical signal with an electrode pair; </claim-text>
<claim-text>processing the electrical signal with a detection subsystem, wherein the detection subsystem is adapted to identify at least one feature in the electrical signal and calculate at least one window parameter in the electrical signal; and </claim-text>
<claim-text>causing the implantable device to perform an action in accordance with an indication from the detection subsystem. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. The method for detecting a neurological event of <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference>, wherein the processing step comprises the steps of: 
<claim-text>sampling the electrical signal to create a sampled digital signal; </claim-text>
<claim-text>identifying a feature in the sampled digital signal with a wave morphology analysis unit; and </claim-text>
<claim-text>calculating a window parameter in the sampled digital signal with a window analysis unit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. The method for detecting a neurological event of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein the calculating step comprises the step of computing a line length function. </claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. The method for detecting a neurological event of <dependent-claim-reference depends_on="CLM-00011">claim 17</dependent-claim-reference>, further comprising the step of transforming the sampled digital signal prior to computing the line length function. </claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. The method for detecting a neurological event of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein the calculating step comprises the step of computing a line length function. </claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. The method for detecting a neurological event of <dependent-claim-reference depends_on="CLM-00011">claim 19</dependent-claim-reference>, further comprising the step of transforming the sampled digital signal prior to computing the area function. </claim-text>
</claim>
<claim id="CLM-00021">
<claim-text><highlight><bold>21</bold></highlight>. The method for detecting a neurological event of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein the identifying step comprises the steps of: 
<claim-text>locating a half wave in the sampled digital signal; </claim-text>
<claim-text>determining whether an amplitude of the half wave exceeds an amplitude threshold and whether a duration of the half wave exceeds a duration threshold, and if both thresholds are met, labeling the half wave as a qualified half wave. </claim-text>
<claim-text>if the half wave is a qualified half wave, storing a record representative of the qualified half wave. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00022">
<claim-text><highlight><bold>22</bold></highlight>. The method for detecting a neurological event of <dependent-claim-reference depends_on="CLM-00022">claim 21</dependent-claim-reference>, wherein the locating step comprises the steps of: 
<claim-text>finding a starting point for the half wave, wherein the starting point has a first sample value equal to an initial current EEG sample value; </claim-text>
<claim-text>calculating an ending threshold by combining the current EEG sample value and a hysteresis value; </claim-text>
<claim-text>measuring a current EEG sample value; </claim-text>
<claim-text>comparing the current EEG sample value to the ending threshold; </claim-text>
<claim-text>repeating the calculating, measuring, and comparing steps until the current EEG sample value exceeds the ending threshold; </claim-text>
<claim-text>establishing an ending point for the half wave, wherein the ending point has an ending sample value equal to the current EEG sample value; </claim-text>
<claim-text>calculating a half wave amplitude equal to a difference between the first sample value and the current EEG sample value; and </claim-text>
<claim-text>calculating a half wave duration equal to a difference between a time corresponding to the ending point and a time corresponding to the starting point. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00023">
<claim-text><highlight><bold>23</bold></highlight>. The method for detecting a neurological event of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein the causing step comprises the steps of: 
<claim-text>processing the feature and the window parameter to determine whether to set a detection flag; </claim-text>
<claim-text>if the detection flag is set, performing an action in accordance with the detection flag. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00024">
<claim-text><highlight><bold>24</bold></highlight>. A method for detecting a neurological event by analyzing an electrical signal from a patient&apos;s brain with an implantable device, the method comprising the steps of: 
<claim-text>receiving a first electrical signal and a second electrical signal from a plurality of electrodes; </claim-text>
<claim-text>processing the electrical signals with a detection subsystem to obtain a first detection channel output and a second detection channel output; </claim-text>
<claim-text>combining the first detection channel output and the second detection channel output to obtain an event detector output; and </claim-text>
<claim-text>causing the implantable device to perform an action in accordance with the event detector output. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00025">
<claim-text><highlight><bold>25</bold></highlight>. A method for detecting a neurological event of <dependent-claim-reference depends_on="CLM-00022">claim 24</dependent-claim-reference>, wherein the processing step comprises the steps of: 
<claim-text>employing the detection subsystem to identify at least a first feature in the first electrical signal and a second feature in the second electrical signal; </claim-text>
<claim-text>employing the detection subsystem to calculate at least a first window parameter in the first electrical signal and a second window parameter in the second electrical signal; </claim-text>
<claim-text>analyzing the first feature and the first window parameter to obtain a first detection channel output; and </claim-text>
<claim-text>analyzing the second feature and the second window parameter to obtain a second detection channel output. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00026">
<claim-text><highlight><bold>26</bold></highlight>. A method for detecting a neurological event by analyzing an electrical signal from a patient&apos;s brain with an implantable device, the method comprising the steps of: 
<claim-text>receiving the electrical signal with an electrode pair; </claim-text>
<claim-text>processing the electrical signal; </claim-text>
<claim-text>converting the electrical signal into a digital signal; </claim-text>
<claim-text>performing a feature extraction operation on the digital signal; </claim-text>
<claim-text>performing a window calculation operation on the digital signal; </claim-text>
<claim-text>analyzing a result from the feature extraction operation; </claim-text>
<claim-text>analyzing a result from the window calculation operation; and </claim-text>
<claim-text>performing an action in accordance with the result from the feature extraction operation and the result from the window calculation operation. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00027">
<claim-text><highlight><bold>27</bold></highlight>. A method for detecting a neurological event by analyzing an electrical signal from a patient&apos;s brain with an implantable device, the device having a processor and a detection subsystem, the method comprising the steps of: 
<claim-text>causing the processor to enter a low-power mode; </claim-text>
<claim-text>measuring a feature characteristic of the electrical signal with the detection subsystem; </claim-text>
<claim-text>measuring a window characteristic of the electrical signal with the detection subsystem; </claim-text>
<claim-text>causing the processor to exit the low-power mode; </claim-text>
<claim-text>analyzing the feature characteristic and the window characteristic with the processor; and </claim-text>
<claim-text>performing an action in accordance with the feature characteristic and the window characteristic. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00028">
<claim-text><highlight><bold>28</bold></highlight>. The method for detecting a neurological event of <dependent-claim-reference depends_on="CLM-00022">claim 27</dependent-claim-reference>, wherein the low-power mode is characterized by relative inactivity.</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>2</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030004428A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030004428A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030004428A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030004428A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030004428A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030004428A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030004428A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030004428A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030004428A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00009">
<image id="EMI-D00009" file="US20030004428A1-20030102-D00009.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00010">
<image id="EMI-D00010" file="US20030004428A1-20030102-D00010.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00011">
<image id="EMI-D00011" file="US20030004428A1-20030102-D00011.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00012">
<image id="EMI-D00012" file="US20030004428A1-20030102-D00012.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00013">
<image id="EMI-D00013" file="US20030004428A1-20030102-D00013.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00014">
<image id="EMI-D00014" file="US20030004428A1-20030102-D00014.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00015">
<image id="EMI-D00015" file="US20030004428A1-20030102-D00015.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00016">
<image id="EMI-D00016" file="US20030004428A1-20030102-D00016.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00017">
<image id="EMI-D00017" file="US20030004428A1-20030102-D00017.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00018">
<image id="EMI-D00018" file="US20030004428A1-20030102-D00018.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00019">
<image id="EMI-D00019" file="US20030004428A1-20030102-D00019.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00020">
<image id="EMI-D00020" file="US20030004428A1-20030102-D00020.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00021">
<image id="EMI-D00021" file="US20030004428A1-20030102-D00021.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00022">
<image id="EMI-D00022" file="US20030004428A1-20030102-D00022.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
