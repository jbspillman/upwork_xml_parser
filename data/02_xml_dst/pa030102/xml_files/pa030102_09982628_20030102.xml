<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030001672A1-20030102-D00000.TIF SYSTEM "US20030001672A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030001672A1-20030102-D00001.TIF SYSTEM "US20030001672A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030001672A1-20030102-D00002.TIF SYSTEM "US20030001672A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030001672A1-20030102-D00003.TIF SYSTEM "US20030001672A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030001672A1-20030102-D00004.TIF SYSTEM "US20030001672A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030001672A1-20030102-D00005.TIF SYSTEM "US20030001672A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030001672A1-20030102-D00006.TIF SYSTEM "US20030001672A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030001672A1-20030102-D00007.TIF SYSTEM "US20030001672A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030001672A1-20030102-D00008.TIF SYSTEM "US20030001672A1-20030102-D00008.TIF" NDATA TIF>
<!ENTITY US20030001672A1-20030102-D00009.TIF SYSTEM "US20030001672A1-20030102-D00009.TIF" NDATA TIF>
<!ENTITY US20030001672A1-20030102-D00010.TIF SYSTEM "US20030001672A1-20030102-D00010.TIF" NDATA TIF>
<!ENTITY US20030001672A1-20030102-D00011.TIF SYSTEM "US20030001672A1-20030102-D00011.TIF" NDATA TIF>
<!ENTITY US20030001672A1-20030102-D00012.TIF SYSTEM "US20030001672A1-20030102-D00012.TIF" NDATA TIF>
<!ENTITY US20030001672A1-20030102-D00013.TIF SYSTEM "US20030001672A1-20030102-D00013.TIF" NDATA TIF>
<!ENTITY US20030001672A1-20030102-D00014.TIF SYSTEM "US20030001672A1-20030102-D00014.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030001672</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>09982628</doc-number>
</application-number>
<application-number-series-code>09</application-number-series-code>
<filing-date>20011018</filing-date>
</domestic-filing-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>H03F001/26</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>330</class>
<subclass>149000</subclass>
</uspc>
</classification-us-primary>
</classification-us>
<title-of-invention>Self-calibrated power amplifier linearizers</title-of-invention>
</technical-information>
<continuity-data>
<non-provisional-of-provisional>
<document-id>
<doc-number>60301978</doc-number>
<document-date>20010628</document-date>
<country-code>US</country-code>
</document-id>
</non-provisional-of-provisional>
</continuity-data>
<inventors>
<first-named-inventor>
<name>
<given-name>James</given-name>
<middle-name>K.</middle-name>
<family-name>Cavers</family-name>
</name>
<residence>
<residence-non-us>
<city>Richmond</city>
<country-code>CA</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Thomas</given-name>
<family-name>Johnson</family-name>
</name>
<residence>
<residence-non-us>
<city>Delta</city>
<country-code>CA</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<correspondence-address>
<name-1>FITZPATRICK CELLA HARPER &amp; SCINTO</name-1>
<name-2></name-2>
<address>
<address-1>30 ROCKEFELLER PLAZA</address-1>
<city>NEW YORK</city>
<state>NY</state>
<postalcode>10112</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">An amplifier linearizer includes a signal adjuster having an internal signal, and an adaptation controller for monitoring the signal adjuster. The internal signal at an input to the adaptation controller is deemed a monitor signal. The adaptation controller generates a control signal for the signal adjuster by accounting for a difference between the internal and monitor signals. </paragraph>
</subdoc-abstract>
<subdoc-description>
<cross-reference-to-related-applications>
<heading lvl="1">CROSS-REFERENCE TO RELATED APPLICATIONS </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> This application claims priority to U.S. Patent Application No. 60/301,978, filed Jun. 28, 2001.</paragraph>
</cross-reference-to-related-applications>
<summary-of-invention>
<section>
<heading lvl="1">FIELD OF THE INVENTION </heading>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> This application generally pertains to, but is not limited to, linearizers used in power amplifiers, for example, RF power amplifiers used in wireless communication systems. </paragraph>
</section>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> RF power amplifiers, like most amplifiers, are substantially linear at small signal amplitudes. However, it is preferable to drive power amplifiers near saturation to deliver significant output power at a reasonable efficiency. As the operation of a power amplifier approaches saturation, it will become more nonlinear, and thus, exhibit more distortion in its output. Consequently, numerous &ldquo;linearizer&rdquo; circuits have been developed over the years in an attempt to remove the power amplifier&apos;s nonlinearity and thereby reduce the distortion in its output. Because the characteristics of the power amplifier may change over time and frequency, these linearizer circuits may be designed to adapt to present amplifier conditions. A generic power amplifier linearizer is shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, and uses either predistortion circuitry, feedforward circuitry, or a combination of both, to correct for the power amplifier&apos;s nonlinearity. (The inclusion of this generic linearizer in this Background Section is not intended to imply that the circuit configuration shown therein, and variations thereof, are in the prior art.) </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> For example, a linearizer may use only a predistortion adjuster circuit p. As will be appreciated by those skilled in the art, in this linearizer the signal adjuster circuit s is merely a delay line ideally matching the total delay of the adjuster circuit p and the power amplifier. In this case, the distortion cancellation circuit, comprising the distortion adjuster circuit d, the error amplifier and the delay circuit, is not used&mdash;the output of the linearizer is the output of the signal power amplifier. The goal of the adjuster circuit p is to predistort the power amplifier input signal so that the power amplifier output signal is proportional to the input signal of the linearizer. That is, the predistorter acts as a filter having a transfer characteristic which is the inverse of that of the power amplifier, except for a complex constant (i.e., a constant gain and phase). Because of their serial configuration, the resultant transfer characteristic of the predistorter and the power amplifier is, ideally, a constant gain and phase that depends on neither frequency nor signal level. Consequently, the output signal will be the input signal amplified by the constant gain and out of phase by a constant amount, that is, linear. Therefore, to implement such predistortion linearizers, the transfer characteristic of the power amplifier is computed and a predistortion filter having the inverse of that transfer characteristic is constructed. Preferably, the predistortion filter should also compensate for changes in the transfer function of the power amplifier, such as those caused by degraded power amplifier components. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> Other linearizers use feedforward circuitry to correct for the nonlinearity in the power amplifier. A feedforward linearizer usually uses a combination of signal adjuster circuit s <highlight><bold>110</bold></highlight> and distortion adjuster circuit d <highlight><bold>111</bold></highlight> as configured in <cross-reference target="DRAWINGS">FIG. 1</cross-reference> (in this linearizer, predistortion adjuster p <highlight><bold>109</bold></highlight> is not used). In an alternative configuration, the signal adjuster circuit may be placed before the power amplifier, i.e., as adjuster circuit p <highlight><bold>109</bold></highlight>, an example of which is shown in <cross-reference target="DRAWINGS">FIG. 7</cross-reference>. This latter configuration advantageously compensates for any additional signal distortion caused by the signal adjuster circuit, since it will be superimposed upon the distortion caused by the power amplifier and be removed by a distortion cancellation circuit. Further, adjusters p <highlight><bold>109</bold></highlight>, s <highlight><bold>110</bold></highlight>, and d <highlight><bold>111</bold></highlight> may be used simultaneously to linearize the power amplifier. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 1, a</cross-reference> feedforward linearizer comprises two main circuits: a signal cancellation circuit <highlight><bold>101</bold></highlight> and a distortion cancellation circuit <highlight><bold>102</bold></highlight>. The RF signal is input to the signal power amplifier <highlight><bold>103</bold></highlight>, which as discussed above, is assumed to be operating in a non-linear range and thus distorting the output signal. The signal cancellation circuit <highlight><bold>101</bold></highlight> ideally subtracts a linear estimate of the RF signal from the distorted power amplifier output signal so that only the nonlinear distortion signal (or &ldquo;error signal&rdquo;) (v<highlight><subscript>e</subscript></highlight>) remains. As will be appreciated to those skilled in the art, the signal pickoff points, the adder <highlight><bold>104</bold></highlight>, and the subtractors <highlight><bold>106</bold></highlight> and <highlight><bold>107</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference> and other figures may be implemented by directional couplers, splitters or combiners, as appropriate. In the distortion cancellation circuit <highlight><bold>102</bold></highlight>, the distortion signal is adjusted and amplified by error amplifier <highlight><bold>108</bold></highlight> to match the distortion signal component of the power amplifier output signal delayed by delay <highlight><bold>112</bold></highlight>. The amplified distortion signal is then subtracted from the output of delay <highlight><bold>112</bold></highlight> by subtractor <highlight><bold>107</bold></highlight> to provide the linearizer output signal v<highlight><subscript>o</subscript></highlight>. The linearizer output signal is a substantially distortion-free amplified RF signal, the output that would have been obtained if the power amplifier were truly linear. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> Generally, the adjuster circuits discussed above do not necessarily all have the same structure&mdash;adjuster circuits p <highlight><bold>109</bold></highlight>, s <highlight><bold>110</bold></highlight> and d <highlight><bold>111</bold></highlight> may all be implemented with different circuitry. For example, the adjuster circuit p <highlight><bold>109</bold></highlight> may be a nonlinear polynomial filter, while the adjuster circuits s <highlight><bold>110</bold></highlight> and d <highlight><bold>111</bold></highlight> may be finite impulse response (FIR) filters. In addition, some methods of controlling these adjuster circuits may employ pilot (tone) signals generated by an optional pilot signal generator <highlight><bold>113</bold></highlight>. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> The relationship of the input and output signals of an adjuster circuit depends on the settings of one or more parameters of that adjuster circuit, as will be discussed in further detail below. During adaptation, the values of one or more internal signals of an adjuster circuit are used to determine appropriate settings for its parameters. As shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, an &ldquo;adaptation controller&rdquo; <highlight><bold>114</bold></highlight> monitors the error and output signals v<highlight><subscript>e </subscript></highlight>and v<highlight><subscript>o</subscript></highlight>, and in some cases, the internal adjuster signals. (In <cross-reference target="DRAWINGS">FIG. 1</cross-reference> and other figures, a stroke on an arrow denotes a multiplicity of signals or a multiplicity of parameters, as the case may be.) On the basis of the monitored signal values, and in accordance with the adaptation algorithm, the adaptation controller sets the adjuster circuit parameters. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> For example, a three-branch adaptive polynomial predistortion adjuster circuit p <highlight><bold>109</bold></highlight> is shown in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>. The upper branch <highlight><bold>200</bold></highlight> is linear, while the middle branch has a nonlinear cubic polynomial filter <highlight><bold>201</bold></highlight> and the lower branch has a nonlinear quintic polynomial filter <highlight><bold>202</bold></highlight>, the implementation of which nonlinear filters is well known to those skilled in the art. Each branch also has a complex gain adjuster (&ldquo;CGA&rdquo;), respectively <highlight><bold>203</bold></highlight>, <highlight><bold>204</bold></highlight>, and <highlight><bold>205</bold></highlight>, to adjust the amplitude and phase of the signal as it passes therethrough. By setting the parameters (GA, GB) of each of the CGAs, a polynomial relationship between the input and output of the adjuster circuit can be established to compensate for a memoryless nonlinearity in the power amplifier. The adaptation controller, via a known adaptation algorithm, uses the input signal, the output of the nonlinear cubic polynomial filter, the output of the nonlinear quintic polynomial filter, and the error signal (the power amplifier output signal minus an appropriately delayed version of input signal) to generate the parameters (GA, GB) for the three CGAs. Generally, the adaptation algorithm is selected to minimize a certain parameter related to the error signal (for example, its power over a predetermined time interval). Examples of such adaptation algorithms are described in more detail below. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> Two possible CGA implementations are respectively shown in <cross-reference target="DRAWINGS">FIGS. 3A and 3B</cross-reference>. The implementation shown in <cross-reference target="DRAWINGS">FIG. 3A</cross-reference> uses polar control parameters GA and GB, where GA sets the amplitude of the attenuator <highlight><bold>301</bold></highlight>, while GB sets the phase of the phase shifter <highlight><bold>302</bold></highlight>. The implementation shown in <cross-reference target="DRAWINGS">FIG. 3B</cross-reference> uses Cartesian control parameters, also designated GA and GB, where GA sets the real part of the complex gain, while GB sets the imaginary part of the complex gain. In this implementation, the input signal I is split into two signals by splitter <highlight><bold>306</bold></highlight>, one of which is then phase-shifted by 90 degrees by phase shifter <highlight><bold>303</bold></highlight>, while the other is not. After GA and GB are applied by mixers or attenuators <highlight><bold>305</bold></highlight> and <highlight><bold>304</bold></highlight> respectively, the signals are summed by combiner <highlight><bold>307</bold></highlight> to produce the CGA output signal O. U.S. Pat. No. 6,208,207 describes, in part, the linearization of these mixers and attenuators, so that desired values of complex gain can be predictably obtained by appropriate setting of the control voltages GA and GB. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> For example, a three-branch adjuster circuit s <highlight><bold>110</bold></highlight> and a three-branch adjuster circuit d <highlight><bold>111</bold></highlight> in a feedforward linearizer are shown in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>. Feedforward linearizers having one or more branches in the adjuster circuits are described in U.S. Pat. Nos. 5,489,875 and 6,208,207, both of which are incorporated herein by reference. Each branch within the circuits <highlight><bold>110</bold></highlight> and <highlight><bold>111</bold></highlight>, labeled &ldquo;FIR adjuster&rdquo;, includes a delay element (i.e., delays <highlight><bold>401</bold></highlight>, <highlight><bold>403</bold></highlight> and <highlight><bold>405</bold></highlight> in the adjuster s <highlight><bold>110</bold></highlight>, and delays <highlight><bold>407</bold></highlight>, <highlight><bold>409</bold></highlight>, and <highlight><bold>411</bold></highlight> in adjuster d <highlight><bold>111</bold></highlight>) and a CGA (i.e., CGAs <highlight><bold>402</bold></highlight>, <highlight><bold>404</bold></highlight> and <highlight><bold>406</bold></highlight> in the adjuster s <highlight><bold>110</bold></highlight>, and CGAs <highlight><bold>408</bold></highlight>, <highlight><bold>410</bold></highlight>, and <highlight><bold>412</bold></highlight> in adjuster d <highlight><bold>111</bold></highlight>). The delays in each branch may be different, and the sum of the parallel branches act as an analog FIR filter (also known as an analog transversal filter). </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> Appropriate settings of the parameters (GA, GB) of the CGAs allow the first FIR adjuster circuit <highlight><bold>110</bold></highlight> to mimic the linear portion of the power amplifier response, including the effects of amplifier delay and other filtering, and for frequency dependence of its own components. Ideally, the amplifier nonlinear distortion is revealed at the output of the subtractor following the first FIR adjuster circuit (v<highlight><subscript>e</subscript></highlight>). Appropriate settings of the parameters (GA, GB) of the second FIR adjuster circuit <highlight><bold>111</bold></highlight> allow it to compensate for delay and other filtering effects in the amplifier output path and for frequency dependence in its own components, and to subtract a replica of the nonlinear distortion from the delayed amplifier output. The adaptation controller <highlight><bold>114</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 4</cross-reference>, via a known adaptation algorithm, uses the internal signals of the branches of the signal and distortion adjuster circuits s <highlight><bold>110</bold></highlight> and d <highlight><bold>111</bold></highlight> and their respective error signals v<highlight><subscript>e </subscript></highlight>and v<highlight><subscript>o</subscript></highlight>, to compute GA and GB for each of the CGAs in the signal and distortion adjuster circuits <highlight><bold>110</bold></highlight> and <highlight><bold>111</bold></highlight>. In this fashion, the linearization circuit compensates for an amplifier nonlinearity with memory. Examples of such adaptation controllers can be found in U.S. Pat. Nos. 5,489,875 and 6,208,207. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> The linearizer circuits of the prior art, however, ignore a phenomenon that often determines the success or failure of the adaptation controller&mdash;the monitored signals, as measured by the adaptation controller, are not necessarily equal to their counterpart internal signals within the adjuster circuits, or to the actual error and output signals v<highlight><subscript>e </subscript></highlight>and v<highlight><subscript>o</subscript></highlight>, as the case may be. The reason is that the cables, circuit board traces, and other components in the signal paths that convey the internal adjuster circuit signals, or the error and output signals v<highlight><subscript>e </subscript></highlight>and v<highlight><subscript>o</subscript></highlight>, to the adaptation controller introduce inadvertent phase and amplitude changes into those signals. The true situation is represented in <cross-reference target="DRAWINGS">FIGS. 6 and 8</cross-reference>, where these phase and amplitude changes are generically modeled as &ldquo;observation filters&rdquo; (<highlight><bold>601</bold></highlight>-<highlight><bold>603</bold></highlight>, <highlight><bold>804</bold></highlight>, <highlight><bold>805</bold></highlight>). In addition, H<highlight><subscript>p</subscript></highlight>(f) <highlight><bold>601</bold></highlight>, H<highlight><subscript>s</subscript></highlight>(f) <highlight><bold>602</bold></highlight> and H<highlight><subscript>d</subscript></highlight>(f) <highlight><bold>603</bold></highlight> may each be considered to comprise a bank of &ldquo;observation subfilters,&rdquo; such as h<highlight><subscript>p1</subscript></highlight>(f), h<highlight><subscript>p2</subscript></highlight>(f), etc., each observation subfilter modeling the transformation of a particular internal signal of an adjuster circuit into a corresponding monitor signal (for example, one observation subfilter per branch of a multibranch adjuster). The characteristics of these observation filters or subfilters are initially unknown. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> In the simplest case, the observation filters or subfilters may represent fixed amplitude and phase changes on each of the signal paths. In a more complex case, however, the amplitude and phase changes, and thus the observation filters, can be frequency-dependent. For example, a three-branch signal adjuster p <highlight><bold>109</bold></highlight> located in front of the power amplifier <highlight><bold>103</bold></highlight> is shown in <cross-reference target="DRAWINGS">FIG. 7</cross-reference>. This adjuster circuit is constructed so that each branch k (k&equals;0, 1, 2) contains a frequency-dependent filter g<highlight><subscript>k</subscript></highlight>(f) (<highlight><bold>701</bold></highlight>, <highlight><bold>703</bold></highlight> or <highlight><bold>705</bold></highlight>), which serves as a generalization of the delay elements of an FIR adjuster, and a CGA (<highlight><bold>702</bold></highlight>, <highlight><bold>704</bold></highlight> or <highlight><bold>706</bold></highlight>). (The mention of these general branch filters g<highlight><subscript>k</subscript></highlight>(f) in this Background Section is not intended to imply that their use in FIR adjuster circuits is known in the prior art; rather, such use is intended to be within the scope of the present invention.) Each observation subfilter h<highlight><subscript>k</subscript></highlight>(f) (<highlight><bold>707</bold></highlight>, <highlight><bold>708</bold></highlight> or <highlight><bold>709</bold></highlight>) of observation filter H<highlight><subscript>p</subscript></highlight>(f) <highlight><bold>601</bold></highlight> models the transformation of the internal signal on branch k into the corresponding monitor signal used by the adaptation controller. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> It should be understood that placement of filters (or filter banks) as shown in <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is just one of many ways to model the difference (inequality) between the internal signals and the monitor signals. Nevertheless, the observation filters shown in <cross-reference target="DRAWINGS">FIG. 6</cross-reference> are sufficient, because other ways of modeling the difference between internal signals and their corresponding monitor signals are equivalent to the representation thereto. For example, <cross-reference target="DRAWINGS">FIG. 8</cross-reference> shows a linearizer circuit that includes an observation filter h<highlight><subscript>em</subscript></highlight>(f) <highlight><bold>804</bold></highlight> in the path of the error signal v<highlight><subscript>e </subscript></highlight>output from the first subtractor <highlight><bold>106</bold></highlight>, and an observation filter h<highlight><subscript>om</subscript></highlight>(f) <highlight><bold>805</bold></highlight> in the path of the RF output signal v<highlight><subscript>o</subscript></highlight>, output from the second subtractor <highlight><bold>107</bold></highlight>, to the adaptation controller <highlight><bold>114</bold></highlight>. These observation filters can be transformed to the representation shown in <cross-reference target="DRAWINGS">FIG. 6</cross-reference> by including the effect of h<highlight><subscript>em</subscript></highlight>(f) <highlight><bold>804</bold></highlight> in the branch paths of adjuster circuits p <highlight><bold>109</bold></highlight> and s <highlight><bold>110</bold></highlight>, and of h<highlight><subscript>om</subscript></highlight>(f) <highlight><bold>805</bold></highlight> into the branch path of adjuster circuit d <highlight><bold>111</bold></highlight> and the distortion cancellation circuit reference branch. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> The severity of the problem caused by the differences between the internal adjuster signals and their corresponding monitor signals can be illustrated by a simple example. <cross-reference target="DRAWINGS">FIG. 9</cross-reference> illustrates the signal cancellation circuit <highlight><bold>101</bold></highlight> of a single-branch feedforward linearizer. Specifically, the signal adjuster circuit s <highlight><bold>110</bold></highlight> includes a single delay <highlight><bold>901</bold></highlight> followed by a CGA <highlight><bold>902</bold></highlight>. The adaptation controller <highlight><bold>114</bold></highlight> uses a known &ldquo;stochastic gradient&rdquo; algorithm (see, for example, the gradient adaptation controller disclosed in U.S. Pat. No. 5,489,875) to correlate using bandpass correlator <highlight><bold>903</bold></highlight> the error signal at the output of the subtractor with the monitored replica of the internal signal of the adjuster circuit, both of which are bandpass signals. The controller integrates the result using integrator <highlight><bold>905</bold></highlight>, via loop gain amplifier <highlight><bold>904</bold></highlight>, to provide CGA parameters GA and GB. The internal structure of a known bandpass correlator is depicted in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>, and includes a phase shifter <highlight><bold>1001</bold></highlight>, mixers <highlight><bold>1002</bold></highlight> and <highlight><bold>1003</bold></highlight>, and bandpass filters (or integrators) <highlight><bold>1004</bold></highlight> and <highlight><bold>1005</bold></highlight> (for a description of the operation of such a bandpass correlator, see <cross-reference target="DRAWINGS">FIG. 3</cross-reference> of U.S. Pat. No. 5,489,875 and the text corresponding thereto). In the idealized situation considered in the prior art, the monitor signal and the internal signal are equal, with H<highlight><subscript>s</subscript></highlight>(f)&equals;h&equals;1 (<highlight><bold>906</bold></highlight>) at all frequencies, and the correlation result is a stochastic estimate of the gradient of the error signal power with respect to the CGA parameters. That is, the correlation result is proportional to the change in CGA parameter settings that would result in the greatest increase in error signal power. Sign reversal and integration causes the CGA parameters to be corrected in the direction that most decreases the error signal power, and the adaptation loop converges correctly to the setting of GA and GB that minimizes error signal power, with a time constant determined by the value K of the loop gain amplifier <highlight><bold>904</bold></highlight>. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> To continue this example, when the linearizer is implemented, it will differ from the ideal case in that the monitor signal (bandpass signal <highlight><bold>1</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 10</cross-reference>) will likely have unknown phase and amplitude shifts with respect to the internal adjuster signal. These shifts are represented by the complex variable h (<highlight><bold>906</bold></highlight>) in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. If h has a phase shift of <highlight><bold>180</bold></highlight> degrees, then the correlation result will be negated, and the correction to the CGA parameters will be made in a direction that maximally increases, rather than decreases, the error signal power. This, in turn, will cause the circuit to diverge from its ideal setting. More generally, a phase shift in h of over 90 degrees will cause the circuit to diverge. A phase shift value of greater than zero degrees, but less than 90 degrees, will allow the circuit to converge to its ideal setting, but with decreasing rapidity as it approaches 90 degrees. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> The same problem may afflict adaptation controllers based on other algorithms that exploit the relationships among monitored signals in order to make corrections to CGA settings. For example, a least squares (&ldquo;LS&rdquo;) algorithm or a recursive LS algorithm may also diverge (or converge more slowly) under the same phase shift conditions as set forth above for the stochastic gradient algorithm. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> In a multibranch adjuster circuit, for example, the polynomial predistorter circuit of <cross-reference target="DRAWINGS">FIG. 2</cross-reference> or the feedforward circuit of <cross-reference target="DRAWINGS">FIGS. 4 and 6</cross-reference>, there are further consequences of the lack of equality between an internal adjuster signal and its corresponding monitor signal. Signals carried on the branches of an adjuster tend to be highly correlated, making stochastic gradient adaptation slow. The remedy is linear transformation of the multiple branch signals to produce a multiplicity of decorrelated signals. The decorrelated signals, or modes, are then adapted individually to provide a much faster convergence. However, the lack of equality between internal and corresponding monitor signals, as modeled by the filter banks in <cross-reference target="DRAWINGS">FIG. 6</cross-reference>, reduces the ability to decorrelate those signals completely. This results in branch signals with residual correlation, thus reducing the benefits of decorrelation. Furthermore, if the internal and monitor signals are not equal, unfavorable phase and amplitude relationships among the filters may cause one or more of the decorrelation mode adaptations to diverge, preventing adaptation altogether. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> In addition, in a stochastic gradient controller, if wide power disparities exist among the decorrelated signals, stronger signals may interfere or &ldquo;mask&rdquo; the weaker signals, degrading the latter and slowing adaptation. To reduce this masking problem, a &ldquo;partial gradient&rdquo; algorithm may be used by the adaptation controller (see, for example, the partial gradient adaptation controller disclosed in U.S. Pat. No. 5,489,875), in which the correlation between two bandpass signals is approximated as a sum of partial correlations taken over limited bandwidths at selected frequencies. By making the frequencies selectable, correlations may be calculated at frequencies that do not contain strong signals, so that the strong signals do not mask the weak signals. In addition, a digital signal processor (DSP) may be used to perform correlation, because the correlations are taken over limited bandwidths. This eliminates the DC offset that otherwise appears in the output of a correlator implemented by directly mixing two bandpass signals. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> illustrates a partial correlator, in which local oscillators <highlight><bold>1101</bold></highlight> and <highlight><bold>1102</bold></highlight> select the frequency of the partial correlation. Frequency shifting and bandpass filtering are performed by the mixer/bandpass filter combinations <highlight><bold>1103</bold></highlight>/<highlight><bold>1107</bold></highlight>, <highlight><bold>1104</bold></highlight>/<highlight><bold>1108</bold></highlight>, <highlight><bold>1105</bold></highlight>/<highlight><bold>1109</bold></highlight>, and <highlight><bold>1106</bold></highlight>/<highlight><bold>1110</bold></highlight>. The signals output by the bandpass filters <highlight><bold>1109</bold></highlight> and <highlight><bold>1110</bold></highlight> are digitally converted, respectively, by A/D converters <highlight><bold>1111</bold></highlight> and <highlight><bold>1112</bold></highlight>. Those digital signals are bandpass correlated by DSP <highlight><bold>1113</bold></highlight> to produce the real and imaginary components of the partial correlation. (See, for example, <cross-reference target="DRAWINGS">FIG. 9</cross-reference> of U.S. Pat. No. 5,489,875 for a description of the operation of a partial correlator similar to that shown in <cross-reference target="DRAWINGS">FIG. 11</cross-reference> herein.) However, as in the case of the stochastic gradient adaptation controller, a lack of equality between the internal signals and their corresponding monitor signals (for example, bandpass signal <highlight><bold>1</bold></highlight>) may cause either divergence or slowed convergence of the partial gradient adaptation controller of <cross-reference target="DRAWINGS">FIG. 11</cross-reference>. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> Accordingly, self-calibrated power amplifier linearizers are desired to compensate for the lack of equality between the internal adjuster signals and their corresponding monitor signals, and to overcome the resulting divergence, or slowed convergence, of the adaptation controllers used therein. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> In one aspect of the presented invention, an amplifier linearizer includes a signal adjuster having an internal signal, and an adaptation controller for monitoring the signal adjuster. The internal signal at an input to the adaptation controller is deemed a monitor signal. The adaptation controller generates a control signal for the signal adjuster by accounting for a difference between the internal and monitor signals. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> This and other aspects of the invention may be ascertained from the detailed description of the preferred embodiments set forth below, taken in conjunction with the one or more of the following drawings.</paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF DRAWINGS </heading>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a block diagram of a generic power amplifier linearizer circuit. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> shows an example of a polynomial predistortion linearizer circuit. </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> <cross-reference target="DRAWINGS">FIGS. 3A and 3B</cross-reference> respectively show two configurations of a complex gain adjuster. </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> shows an example of a multibranch feedforward linearizer circuit. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> shows a hybrid predistorter and feedforward linearizer circuit. </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a block diagram of a generic power amplifier linearizer circuit, in which observation filters are included to model the lack of equality between the internal adjuster signals and the corresponding monitor signals used by the adaptation controller. </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a generic FIR signal adjuster circuit showing a bank of observation subfilters to model the lack of equality between the internal signal adjuster circuit signals and the corresponding monitor signals used by the adaptation controller. </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a block diagram of a generic power amplifier linearizer circuit, in which observation filters are included to model the lack of equality between the internal adjuster signals, error output signal v<highlight><subscript>e </subscript></highlight>and RF output signal v<highlight><subscript>o</subscript></highlight>, and the corresponding monitor signals used by the adaptation controller. </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is an example of a one-branch feedforward signal adjuster circuit, and a stochastic gradient adaptation controller using a bandpass correlator, in which observation filter h is included to model the lack of equality between the internal signal adjuster signal and the corresponding monitor signal used by the adaptation controller. </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is an example of the bandpass correlator used by the adaptation controller shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is an example of a partial bandpass correlator used in a partial gradient adaptation controller. </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a two-branch feedforward circuit with observation filters included in the monitor signal paths of the FIR adjuster branches. </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is a two-branch feedforward signal cancellation circuit with observation filters for the adjuster branches. </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 14</cross-reference> is a multibranch predistorter containing general nonlinearities with frequency dependence.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS </heading>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> The embodiments of the present invention are directed to self-calibration techniques by which the adaptation controller (1) determines the frequency responses of the observation filters between the internal signals and the monitor signals (and hence, the frequency responses of the underlying circuit components modeled by those observation filters) and (2) corrects for these responses, so that the monitored signals are substantially representative of the internal signals of the adjuster circuits. The benefits of self-calibration are (1) reliable adaptation, without risk of divergence; (2) faster adaptation than without self-calibration; and (3) access to methods that decorrelate the internal signals, explicitly or implicitly, to allow fast adaptation of all the signal modes. This self-calibration can be performed upon the initialization of the linearizer (for example, at device turn-on), or from time-to-time as needed. Further, the self-calibration is performed by the linearizer itself without human intervention. </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> illustrates a feedforward linearizer in which an FIR adjuster s <highlight><bold>1210</bold></highlight> in the signal cancellation circuit is located parallel to the power amplifier <highlight><bold>103</bold></highlight> (the case where the FIR adjuster s is in series with the power amplifier is discussed further below). The FIR adjuster s has two branches, the upper including a delay <highlight><bold>1230</bold></highlight> and a CGA <highlight><bold>1231</bold></highlight>, and the lower including a delay <highlight><bold>1232</bold></highlight> and a CGA <highlight><bold>1233</bold></highlight>. The outputs of the CGAs <highlight><bold>1231</bold></highlight> and <highlight><bold>1233</bold></highlight> are summed by the combiner <highlight><bold>1238</bold></highlight>. The feedforward linearizer also has an FIR adjuster d <highlight><bold>1211</bold></highlight> in the distortion cancellation circuit. The FIR adjuster d also has two branches, the upper including a delay <highlight><bold>1234</bold></highlight> and a CGA <highlight><bold>1235</bold></highlight>, and the lower including a delay <highlight><bold>1236</bold></highlight> and a CGA <highlight><bold>1237</bold></highlight>. The outputs of the CGAs <highlight><bold>1235</bold></highlight> and <highlight><bold>1237</bold></highlight> are summed by the combiner <highlight><bold>1239</bold></highlight>. Although <cross-reference target="DRAWINGS">FIG. 12</cross-reference> illustrates FIR adjusters with two branches, the self-calibration techniques of the present invention apply to adjusters with one or more branches. In addition, these self-calibration techniques are described below with respect to FIR adjuster circuits for sake of clarity. However, those skilled in the art will recognize that these techniques apply to a wide range of adjuster circuits having structures as described above, including, but without limitation, FIR adjusters, polynomial adjusters, and adjusters with general filters on the branches. </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> In the circuit shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference>, the complex gains (amplitude and phase) of the observation filters h<highlight><subscript>s0</subscript></highlight>(f) <highlight><bold>1220</bold></highlight>, h<highlight><subscript>s1</subscript></highlight>(f) <highlight><bold>1221</bold></highlight>, h<highlight><subscript>e0</subscript></highlight>(f) <highlight><bold>1222</bold></highlight> and h<highlight><subscript>e1</subscript></highlight>(f) <highlight><bold>1223</bold></highlight> are first determined. Then those gains are used to adjust the respective monitor signals v<highlight><subscript>am0</subscript></highlight>, v<highlight><subscript>am1</subscript></highlight>, v<highlight><subscript>bm0 </subscript></highlight>and v<highlight><subscript>bm1 </subscript></highlight>so they are representative of the corresponding internal adjuster signals v<highlight><subscript>a0</subscript></highlight>, v<highlight><subscript>a1</subscript></highlight>, v<highlight><subscript>b0 </subscript></highlight>and v<highlight><subscript>b1</subscript></highlight>. </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> In one embodiment, it is assumed that the observation filters do not depend on frequency, so that they are each characterized by a single complex gain, i.e., h<highlight><subscript>s0</subscript></highlight>, h<highlight><subscript>s1</subscript></highlight>, h<highlight><subscript>e0</subscript></highlight>, and h<highlight><subscript>e1</subscript></highlight>. With reference to <cross-reference target="DRAWINGS">FIG. 12</cross-reference>, the adaptation controller <highlight><bold>1214</bold></highlight> determines the complex gain h<highlight><subscript>s0 </subscript></highlight>as follows: </paragraph>
<paragraph id="P-0043" lvl="2"><number>&lsqb;0043&rsqb;</number> (1) set the power amplifier <highlight><bold>103</bold></highlight> in standby mode, so that its output is zero; </paragraph>
<paragraph id="P-0044" lvl="2"><number>&lsqb;0044&rsqb;</number> (2) set the CGA <highlight><bold>1233</bold></highlight> complex gain a<highlight><subscript>1 </subscript></highlight>to zero through an appropriate choice of the control voltages, so that the corresponding CGA output is zero; </paragraph>
<paragraph id="P-0045" lvl="2"><number>&lsqb;0045&rsqb;</number> (3) set the CGA <highlight><bold>1231</bold></highlight> complex gain a<highlight><subscript>0 </subscript></highlight>to some nominal value a<highlight><subscript>0</subscript></highlight>&prime; through appropriate choice of control voltages; </paragraph>
<paragraph id="P-0046" lvl="2"><number>&lsqb;0046&rsqb;</number> (4) apply an input signal with components at frequency f<highlight><subscript>1 </subscript></highlight>to the amplifier, or use an internal pilot signal generator <highlight><bold>113</bold></highlight> to generate a tone for calibration; </paragraph>
<paragraph id="P-0047" lvl="2"><number>&lsqb;0047&rsqb;</number> (5) in the adaptation controller, use a bandpass correlator (for example, the bandpass correlator shown in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>) to produce the correlation of signal v<highlight><subscript>e </subscript></highlight>with monitor signal v<highlight><subscript>am0</subscript></highlight>; the result is: </paragraph>
<paragraph id="P-0048" lvl="3"><number>&lsqb;0048&rsqb;</number> C<highlight><subscript>eam0</subscript></highlight>&equals;a<highlight><subscript>0</subscript></highlight>&prime;&middot;h<highlight><subscript>s0</subscript></highlight><highlight><superscript>*</superscript></highlight>&middot;P<highlight><subscript>a0</subscript></highlight>, where the asterisk denotes complex conjugation and P<highlight><subscript>a0 </subscript></highlight>denotes the power of signal v<highlight><subscript>a0</subscript></highlight>; </paragraph>
<paragraph id="P-0049" lvl="2"><number>&lsqb;0049&rsqb;</number> (6) in the adaptation controller, use a bandpass correlator to produce the correlation of monitor signal v<highlight><subscript>am0 </subscript></highlight>with itself, the result is: </paragraph>
<paragraph id="P-0050" lvl="3"><number>&lsqb;0050&rsqb;</number> C<highlight><subscript>am0</subscript></highlight>&equals;&verbar;h<highlight><subscript>s0</subscript></highlight>&verbar;<highlight><superscript>2</superscript></highlight>&middot;P<highlight><subscript>a0</subscript></highlight>, where the bars denote the magnitude of a complex quantity; and </paragraph>
<paragraph id="P-0051" lvl="2"><number>&lsqb;0051&rsqb;</number> (7) determine the observation filter gain as: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>h</italic></highlight><highlight><subscript>s0</subscript></highlight><highlight><italic>&equals;a</italic></highlight><highlight><subscript>0</subscript></highlight><highlight><italic>&prime;&middot;C</italic></highlight><highlight><subscript>am0</subscript></highlight><highlight><italic>/C</italic></highlight><highlight><subscript>eam0</subscript></highlight>. </in-line-formula></paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> gain h<highlight><subscript>s1 </subscript></highlight>is determined in a similar fashion with branch &ldquo;0&rdquo; set to zero (a<highlight><subscript>0</subscript></highlight>&equals;0) and branch &ldquo;1&rdquo; enabled (a<highlight><subscript>1 </subscript></highlight>&equals;a<highlight><subscript>1</subscript></highlight>&prime;). </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> The adaptation controller <highlight><bold>1214</bold></highlight> determines the complex gain h<highlight><subscript>e0 </subscript></highlight>as follows: </paragraph>
<paragraph id="P-0054" lvl="2"><number>&lsqb;0054&rsqb;</number> (1) set the power amplifier in standby mode, so that its output is zero, and set at least one of the CGA gains (a<highlight><subscript>0 </subscript></highlight>or a<highlight><subscript>1</subscript></highlight>) in the signal FIR adjuster s to a non-zero value, so that the power of the error signal P<highlight><subscript>e </subscript></highlight>is non-zero; </paragraph>
<paragraph id="P-0055" lvl="2"><number>&lsqb;0055&rsqb;</number> (2) set the CGA <highlight><bold>1237</bold></highlight> complex gain b<highlight><subscript>1 </subscript></highlight>to zero through an appropriate choice of the control voltages, so that the corresponding CGA output is zero; </paragraph>
<paragraph id="P-0056" lvl="2"><number>&lsqb;0056&rsqb;</number> (3) set the CGA <highlight><bold>1235</bold></highlight> complex gain b<highlight><subscript>0 </subscript></highlight>to some nominal value b<highlight><subscript>0</subscript></highlight>&prime; through appropriate choice of control voltages; </paragraph>
<paragraph id="P-0057" lvl="2"><number>&lsqb;0057&rsqb;</number> (4) apply an input signal with components at frequency f<highlight><subscript>1 </subscript></highlight>to the amplifier, or use an internal pilot signal generator <highlight><bold>113</bold></highlight> to generate a tone for calibration; </paragraph>
<paragraph id="P-0058" lvl="2"><number>&lsqb;0058&rsqb;</number> (5) in the adaptation controller, use a bandpass correlator to produce the correlation of signal v<highlight><subscript>o </subscript></highlight>with monitor signal v<highlight><subscript>bm0</subscript></highlight>; the result is: </paragraph>
<paragraph id="P-0059" lvl="3"><number>&lsqb;0059&rsqb;</number> C<highlight><subscript>obm0</subscript></highlight>&equals;b<highlight><subscript>0</subscript></highlight>&prime;&middot;h<highlight><subscript>e0</subscript></highlight><highlight><superscript>*</superscript></highlight>&middot;P<highlight><subscript>b0</subscript></highlight>, where the asterisk denotes complex conjugation and P<highlight><subscript>b0 </subscript></highlight>denotes the power of signal v<highlight><subscript>b0</subscript></highlight>; </paragraph>
<paragraph id="P-0060" lvl="2"><number>&lsqb;0060&rsqb;</number> (6) in the adaptation controller, use a bandpass correlator to produce the correlation of monitor signal v<highlight><subscript>bm0 </subscript></highlight>with itself; the result is: </paragraph>
<paragraph id="P-0061" lvl="3"><number>&lsqb;0061&rsqb;</number> C<highlight><subscript>bm0</subscript></highlight>&equals;&verbar;h<highlight><subscript>e0</subscript></highlight>&verbar;<highlight><superscript>2</superscript></highlight>&middot;P<highlight><subscript>b0</subscript></highlight>, where the bars denote the magnitude of a complex quantity; and </paragraph>
<paragraph id="P-0062" lvl="2"><number>&lsqb;0062&rsqb;</number> (7) determine the observation filter gain as: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>h</italic></highlight><highlight><subscript>e0</subscript></highlight><highlight><italic>&equals;b</italic></highlight><highlight><subscript>0</subscript></highlight><highlight><italic>&prime;&middot;C</italic></highlight><highlight><subscript>bm0</subscript></highlight><highlight><italic>/C</italic></highlight><highlight><subscript>obm0</subscript></highlight>. </in-line-formula></paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> The gain h<highlight><subscript>e1 </subscript></highlight>is determined in a similar fashion with branch &ldquo;0&rdquo; set to zero (b<highlight><subscript>0</subscript></highlight>&equals;0) and branch &ldquo;1&rdquo; enabled (b<highlight><subscript>1</subscript></highlight>&equals;b<highlight><subscript>1</subscript></highlight>&prime;). </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> In another embodiment, it is assumed that the observation filters depend on frequency. Consequently, to approximate their frequency responses, the adaptation controller determines their gains at a selected set of N frequencies f<highlight><subscript>i</subscript></highlight>, i&equals;1, 2, . . . , N. The adaptation controller <highlight><bold>1214</bold></highlight> determines the gain h<highlight><subscript>s0</subscript></highlight>(f<highlight><subscript>1</subscript></highlight>) at frequency f<highlight><subscript>1 </subscript></highlight>as follows: </paragraph>
<paragraph id="P-0065" lvl="2"><number>&lsqb;0065&rsqb;</number> (1) set the power amplifier <highlight><bold>103</bold></highlight> to standby mode, so that its output is zero; </paragraph>
<paragraph id="P-0066" lvl="2"><number>&lsqb;0066&rsqb;</number> (2) set the CGA <highlight><bold>1233</bold></highlight> gain of a<highlight><subscript>1 </subscript></highlight>to zero through appropriate choice of the control voltages, so that the CGA output is zero; </paragraph>
<paragraph id="P-0067" lvl="2"><number>&lsqb;0067&rsqb;</number> (3) set the CGA <highlight><bold>1231</bold></highlight> gain a<highlight><subscript>0 </subscript></highlight>to some nominal value a<highlight><subscript>0</subscript></highlight>&prime; through appropriate choice of control voltages; </paragraph>
<paragraph id="P-0068" lvl="2"><number>&lsqb;0068&rsqb;</number> (4) apply an input signal with components at frequency f<highlight><subscript>1 </subscript></highlight>to the amplifier, or use an internal pilot signal generator <highlight><bold>113</bold></highlight> set to frequency f<highlight><subscript>1</subscript></highlight>; </paragraph>
<paragraph id="P-0069" lvl="2"><number>&lsqb;0069&rsqb;</number> (5) use a partial correlator (for example, the partial correlator shown in <cross-reference target="DRAWINGS">FIG. 11</cross-reference>), with local oscillators set to select frequency f<highlight><subscript>1</subscript></highlight>, to produce the correlation of signal v<highlight><subscript>e </subscript></highlight>with monitor signal v<highlight><subscript>am0</subscript></highlight>; the result is: </paragraph>
<paragraph id="P-0070" lvl="3"><number>&lsqb;0070&rsqb;</number> C<highlight><subscript>eam0</subscript></highlight>(f<highlight><subscript>1</subscript></highlight>)&equals;a<highlight><subscript>0</subscript></highlight>&middot;h<highlight><subscript>s0</subscript></highlight><highlight><superscript>*</superscript></highlight>(f<highlight><subscript>1</subscript></highlight>)&middot;P<highlight><subscript>a0</subscript></highlight>(f<highlight><subscript>1</subscript></highlight>), where P<highlight><subscript>a0</subscript></highlight>(f<highlight><subscript>1</subscript></highlight>) denotes the power of signal v<highlight><subscript>a0 </subscript></highlight>at frequency f<highlight><subscript>1</subscript></highlight>; </paragraph>
<paragraph id="P-0071" lvl="2"><number>&lsqb;0071&rsqb;</number> (6) use a partial correlator, with local oscillators set to select frequency f<highlight><subscript>1</subscript></highlight>, to produce the correlation of monitor signal v<highlight><subscript>am0 </subscript></highlight>with itself; the result is: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>am0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>)&equals;&verbar;<highlight><italic>h</italic></highlight><highlight><subscript>s0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>)&verbar;<highlight><superscript>2</superscript></highlight><highlight><italic>&middot;P</italic></highlight><highlight><subscript>a0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>); </in-line-formula></paragraph>
<paragraph id="P-0072" lvl="2"><number>&lsqb;0072&rsqb;</number> (7) determine the observation filter gain at frequency f<highlight><subscript>1 </subscript></highlight>as: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>h</italic></highlight><highlight><subscript>s0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>)&equals;<highlight><italic>a</italic></highlight><highlight><subscript>0</subscript></highlight><highlight><italic>&prime;C</italic></highlight><highlight><subscript>am0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>)/(<highlight><italic>C</italic></highlight><highlight><subscript>eam0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>)) </in-line-formula></paragraph>
<paragraph id="P-0073" lvl="0"><number>&lsqb;0073&rsqb;</number> Similarly, the adaptation controller <highlight><bold>1214</bold></highlight> determines the gain h<highlight><subscript>e0</subscript></highlight>(f<highlight><subscript>1</subscript></highlight>) at frequency f<highlight><subscript>1 </subscript></highlight>as follows: </paragraph>
<paragraph id="P-0074" lvl="2"><number>&lsqb;0074&rsqb;</number> (1) set the power amplifier <highlight><bold>103</bold></highlight> to standby mode, so that its output is zero, and set at least one of the CGA gains (a<highlight><subscript>o</subscript></highlight>, a<highlight><subscript>1</subscript></highlight>) in the signal cancellation circuit to a non-zero value, so that the power of the error signal P<highlight><subscript>e</subscript></highlight>(f<highlight><subscript>1</subscript></highlight>) is non-zero; </paragraph>
<paragraph id="P-0075" lvl="2"><number>&lsqb;0075&rsqb;</number> (2) set CGA <highlight><bold>1237</bold></highlight> gain b<highlight><subscript>1 </subscript></highlight>to zero through appropriate choice of the control voltages, so that the corresponding CGA output is zero; </paragraph>
<paragraph id="P-0076" lvl="2"><number>&lsqb;0076&rsqb;</number> (3) set the CGA <highlight><bold>1235</bold></highlight> gain b<highlight><subscript>0 </subscript></highlight>to some nominal value b<highlight><subscript>0</subscript></highlight>&prime; through appropriate choice of control voltages; </paragraph>
<paragraph id="P-0077" lvl="2"><number>&lsqb;0077&rsqb;</number> (4) apply an input signal with components at frequency f<highlight><subscript>1 </subscript></highlight>to the amplifier, or use an internal pilot signal generator <highlight><bold>113</bold></highlight> set to frequency f<highlight><subscript>1</subscript></highlight>; </paragraph>
<paragraph id="P-0078" lvl="2"><number>&lsqb;0078&rsqb;</number> (5) use a partial correlator, with local oscillators set to select frequency f<highlight><subscript>1</subscript></highlight>, to produce the correlation of signal v<highlight><subscript>o </subscript></highlight>with monitor signal v<highlight><subscript>bm0</subscript></highlight>; the result is: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>obm0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;b<highlight><subscript>0</subscript></highlight><highlight><italic>&prime;&middot;h</italic></highlight><highlight><subscript>e0</subscript></highlight><highlight><superscript>*</superscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>)&middot;<highlight><italic>P</italic></highlight><highlight><subscript>b0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>), where <highlight><italic>P</italic></highlight><highlight><subscript>b0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>), </in-line-formula></paragraph>
<paragraph id="P-0079" lvl="7"><number>&lsqb;0079&rsqb;</number> denotes the power of signal v<highlight><subscript>b0 </subscript></highlight>at frequency f<highlight><subscript>1</subscript></highlight>; </paragraph>
<paragraph id="P-0080" lvl="2"><number>&lsqb;0080&rsqb;</number> (6) use a partial correlator, with local oscillators set to select frequency f<highlight><subscript>1</subscript></highlight>, to produce the correlation of monitor signal v<highlight><subscript>bm0 </subscript></highlight>with itself; the result is: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>bm0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>j</subscript></highlight>)&equals;&verbar;<highlight><italic>h</italic></highlight><highlight><subscript>e0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>)<highlight><superscript>2</superscript></highlight><highlight><italic>&middot;P</italic></highlight><highlight><subscript>b0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>); </in-line-formula></paragraph>
<paragraph id="P-0081" lvl="2"><number>&lsqb;0081&rsqb;</number> (7) determine the observation filter gain at frequency f<highlight><subscript>1 </subscript></highlight>as: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>h</italic></highlight><highlight><subscript>e0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>)&equals;<highlight><italic>b</italic></highlight><highlight><subscript>0</subscript></highlight><highlight><italic>&prime;C</italic></highlight><highlight><subscript>bm0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>)/(<highlight><italic>C</italic></highlight><highlight><subscript>obm0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>)). </in-line-formula></paragraph>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> The complex gains h<highlight><subscript>s0</subscript></highlight>(f<highlight><subscript>1</subscript></highlight>) and h<highlight><subscript>e0</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>) at frequencies i&equals;2, 3, . . . , N are determined similarly. The frequency responses of the remaining observation filters h<highlight><subscript>s1</subscript></highlight>(f) and h<highlight><subscript>e1</subscript></highlight>(f) are determined by selecting them one at a time through choice of CGA gains, and then repeating the above-described methods for each frequency f<highlight><subscript>i</subscript></highlight>, i&equals;1, 2, . . . , N. </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> In the above procedures, the frequencies f<highlight><subscript>i </subscript></highlight>at which calibration is obtained are the same for the signal and distortion cancellation circuits. However, the frequencies f<highlight><subscript>i </subscript></highlight>at which calibration is obtained may differ between the signal and distortion cancellation circuits. </paragraph>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> To self-calibrate a single-branch adjuster circuit, step (2) of the above-described methods is eliminated. To self-calibrate an adjuster circuit having more than two branches, one branch at a time is enabled, while all others are set to zero, until all corresponding observation filter gains are determined. </paragraph>
<paragraph id="P-0085" lvl="0"><number>&lsqb;0085&rsqb;</number> Computing the complex gains of the observation filters for the signal cancellation circuit may be done without computing the same for the distortion cancellation circuit, and vice-versa. Also, computing the complex gains of one or more of the observation filters for the distortion cancellation circuit may be done prior to computing the same for the signal cancellation circuit, and vice-versa. </paragraph>
<paragraph id="P-0086" lvl="0"><number>&lsqb;0086&rsqb;</number> Moreover, although the adjusters in this embodiment had delay lines in the branches, as shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference>, the procedures for estimating the observation filter complex gains, whether they be frequency-independent or frequency-dependent, are equally applicable to adjusters constructed with filters of any type in place of one or more of the delay lines <highlight><bold>1230</bold></highlight>, <highlight><bold>1232</bold></highlight>, <highlight><bold>1234</bold></highlight> and <highlight><bold>1236</bold></highlight>. </paragraph>
<paragraph id="P-0087" lvl="0"><number>&lsqb;0087&rsqb;</number> Once the observation filter complex gains are computed, the corresponding monitor signals need to be appropriately adjusted. The adaptation controller divides the monitor signals by the respective observation filter complex gains (either frequency-independent or frequency-dependent, as the case may be) to approximate the true internal adjuster circuit signals. For example, for branch k and frequency f<highlight><subscript>i</subscript></highlight>, the controller calculates: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>v</italic></highlight><highlight><subscript>ak</subscript></highlight><highlight><italic>&equals;v</italic></highlight><highlight><subscript>amk</subscript></highlight><highlight><italic>/h</italic></highlight><highlight><subscript>sk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>); and </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>v</italic></highlight><highlight><subscript>bk</subscript></highlight><highlight><italic>&equals;v</italic></highlight><highlight><subscript>bmk</subscript></highlight><highlight><italic>/h</italic></highlight><highlight><subscript>ek</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>). </in-line-formula></paragraph>
<paragraph id="P-0088" lvl="0"><number>&lsqb;0088&rsqb;</number> Once these self-calibration procedures are performed, the effect on convergence is dramatic. This is particularly true when a partial correlator is implemented using a DSP. Convergence is reliable and robust in the face of amplitude and phase changes introduced by the cables, circuit board traces, and other components in the signal paths that convey the internal signals to the adaptation controller. More generally, any adaptation algorithm, such as stochastic gradient, with or without decorrelation of the branch signals, or least squares, can be made insensitive to these amplitude and phase changes, because the adaptation controller can always recover the internal signals from the monitor signals by dividing them by the corresponding determined observation filter complex gains. </paragraph>
<paragraph id="P-0089" lvl="0"><number>&lsqb;0089&rsqb;</number> Variations of the self-calibration procedures of the present invention will be evident to those skilled in the art. Two are listed here for illustrative purposes. </paragraph>
<paragraph id="P-0090" lvl="0"><number>&lsqb;0090&rsqb;</number> In one variation (described here only for a two-branch signal adjuster circuit, but equally applicable to a two-branch distortion adjuster circuit, as appropriately modified in accord with the method for computing h<highlight><subscript>e0</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>) and h<highlight><subscript>e1</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>) described above), the adaptation controller <highlight><bold>1214</bold></highlight> simultaneously determines the frequency responses of all observation filters at frequency f<highlight><subscript>i </subscript></highlight>as follows: </paragraph>
<paragraph id="P-0091" lvl="2"><number>&lsqb;0091&rsqb;</number> (1) set the power amplifier <highlight><bold>103</bold></highlight> to standby mode, so that its output is zero; </paragraph>
<paragraph id="P-0092" lvl="2"><number>&lsqb;0092&rsqb;</number> (2) set all the CGA gains to non-zero nominal values a<highlight><subscript>k</subscript></highlight>&prime;, k&equals;0 . . . K&minus;1, where k indexes the branch and there are K branches (in <cross-reference target="DRAWINGS">FIG. 12</cross-reference>, the circuit is illustrated for K&equals;2 branches); </paragraph>
<paragraph id="P-0093" lvl="2"><number>&lsqb;0093&rsqb;</number> (3) apply an input signal with components at frequency f<highlight><subscript>1 </subscript></highlight>to the amplifier, or use an internal pilot signal generator <highlight><bold>113</bold></highlight> set to frequency f<highlight><subscript>i</subscript></highlight>; </paragraph>
<paragraph id="P-0094" lvl="2"><number>&lsqb;0094&rsqb;</number> (4) use partial correlators to measure all the pairwise correlations among the monitor signals at frequency f<highlight><subscript>i</subscript></highlight>; for K&equals;2, this results in: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>am0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;<highlight><italic>P</italic></highlight><highlight><subscript>a0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;&verbar;<highlight><italic>h</italic></highlight><highlight><subscript>s0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&verbar;<highlight><superscript>2 </superscript></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>am1</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;<highlight><italic>P</italic></highlight><highlight><subscript>a1</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;&verbar;<highlight><italic>h</italic></highlight><highlight><subscript>s1</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&verbar;<highlight><superscript>2 </superscript></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>am01</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;<highlight><italic>P</italic></highlight><highlight><subscript>a01</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;<highlight><italic>h</italic></highlight><highlight><subscript>s0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;<highlight><italic>h</italic></highlight><highlight><subscript>s1</subscript></highlight><highlight><superscript>*</superscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>) </in-line-formula></paragraph>
<paragraph id="P-0095" lvl="2"><number>&lsqb;0095&rsqb;</number> &emsp;where P<highlight><subscript>a0</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>) denotes the power of v<highlight><subscript>a0 </subscript></highlight>at f<highlight><subscript>i</subscript></highlight>, P<highlight><subscript>a1</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>) denotes the power of v<highlight><subscript>al </subscript></highlight>at f<highlight><subscript>i</subscript></highlight>, and P<highlight><subscript>a01</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>) denotes the &ldquo;crosspower&rdquo; (the correlation) of v<highlight><subscript>a0 </subscript></highlight>and v<highlight><subscript>a1 </subscript></highlight>at f<highlight><subscript>i</subscript></highlight>; </paragraph>
<paragraph id="P-0096" lvl="2"><number>&lsqb;0096&rsqb;</number> (5) use partial correlators to measure the correlation between the error signal and each of the monitor signals; for K&equals;2, this results in </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>eam0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;<highlight><italic>a</italic></highlight><highlight><subscript>0</subscript></highlight><highlight><italic>&prime;&middot;P</italic></highlight><highlight><subscript>a0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;<highlight><italic>h</italic></highlight><highlight><subscript>s0</subscript></highlight><highlight><superscript>*</superscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&plus;<highlight><italic>a</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&prime;&middot;P</italic></highlight><highlight><subscript>a01</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;<highlight><italic>h</italic></highlight><highlight><subscript>s0</subscript></highlight><highlight><superscript>*</superscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>eam1</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;<highlight><italic>a</italic></highlight><highlight><subscript>0</subscript></highlight><highlight><italic>&prime;&middot;P</italic></highlight><highlight><subscript>a01</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;<highlight><italic>h</italic></highlight><highlight><subscript>s1</subscript></highlight><highlight><superscript>*</superscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&plus;<highlight><italic>a</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&prime;&middot;P</italic></highlight><highlight><subscript>a1</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;<highlight><italic>h</italic></highlight><highlight><subscript>s1</subscript></highlight><highlight><superscript>*</superscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>) </in-line-formula></paragraph>
<paragraph id="P-0097" lvl="2"><number>&lsqb;0097&rsqb;</number> &emsp;which becomes, after substitution for the powers, a set of equations in the observation filter gains: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>eam0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;<highlight><italic>a</italic></highlight><highlight><subscript>0</subscript></highlight><highlight><italic>&prime;&middot;C</italic></highlight><highlight><subscript>am0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;<highlight><italic>h</italic></highlight><highlight><subscript>s0</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)<highlight><superscript>&minus;1</superscript></highlight><highlight><italic>&plus;a</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&prime;&middot;C</italic></highlight><highlight><subscript>a01</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;<highlight><italic>h</italic></highlight><highlight><subscript>s1</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)<highlight><superscript>&minus;1 </superscript></highlight></in-line-formula></paragraph>
<paragraph id="P-0098" lvl="2"><number>&lsqb;0098&rsqb;</number> (6) solve the set of equations for h<highlight><subscript>s0</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>)<highlight><superscript>&minus;1 </superscript></highlight>and h<highlight><subscript>s1</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>)<highlight><superscript>&minus;1</superscript></highlight>; take their reciprocals to obtain the desired frequency responses h<highlight><subscript>s0</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>) and h<highlight><subscript>s1</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>). </paragraph>
<paragraph id="P-0099" lvl="0"><number>&lsqb;0099&rsqb;</number> The method extends in a straightforward way to signal or distortion adjuster circuits with more than two branches. </paragraph>
<paragraph id="P-0100" lvl="0"><number>&lsqb;0100&rsqb;</number> In a second variation, described here only for the signal adjuster circuit (but equally applicable to distortion adjuster, appropriately modified as described above), the adaptation controller <highlight><bold>1214</bold></highlight> determines the responses of the observation filters at frequency fi without putting the power amplifier <highlight><bold>103</bold></highlight> in standby mode. It will be described here only for one of the branches (branch k): </paragraph>
<paragraph id="P-0101" lvl="2"><number>&lsqb;0101&rsqb;</number> (1) set all of the CGA gains to zero; </paragraph>
<paragraph id="P-0102" lvl="2"><number>&lsqb;0102&rsqb;</number> (2) apply an input signal with components at frequency f<highlight><subscript>i </subscript></highlight>to the amplifier, or use an internal pilot signal generator <highlight><bold>113</bold></highlight> set to frequency f<highlight><subscript>i</subscript></highlight>; the power of the signal is set to operate the power amplifier at a nominal operating point; </paragraph>
<paragraph id="P-0103" lvl="2"><number>&lsqb;0103&rsqb;</number> (3) use a partial correlator, with local oscillators set to select frequency f<highlight><subscript>i</subscript></highlight>, to produce the correlation of signal v<highlight><subscript>e </subscript></highlight>with monitor signal v<highlight><subscript>amk</subscript></highlight>; the result is a bias term C&prime;<highlight><subscript>eamk</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>); </paragraph>
<paragraph id="P-0104" lvl="2"><number>&lsqb;0104&rsqb;</number> (4) set the CGA gain a<highlight><subscript>k </subscript></highlight>to some nominal value a<highlight><subscript>k</subscript></highlight>&prime; through appropriate choice of control voltages; </paragraph>
<paragraph id="P-0105" lvl="2"><number>&lsqb;0105&rsqb;</number> (5) use a partial correlator, with local oscillators set to select frequency f<highlight><subscript>i</subscript></highlight>, to produce the correlation of signal v<highlight><subscript>e </subscript></highlight>with monitor signal v<highlight><subscript>amk</subscript></highlight>; the result is </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>eamk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;<highlight><italic>a</italic></highlight><highlight><subscript>k</subscript></highlight><highlight><italic>&prime;h</italic></highlight><highlight><subscript>sk</subscript></highlight><highlight><superscript>*</superscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;<highlight><italic>P</italic></highlight><highlight><subscript>ak</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&plus;<highlight><italic>C&prime;</italic></highlight><highlight><subscript>eamk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>); </in-line-formula></paragraph>
<paragraph id="P-0106" lvl="2"><number>&lsqb;0106&rsqb;</number> (6) use a partial correlator, with local oscillators set to select frequency f<highlight><subscript>i</subscript></highlight>, to produce the correlation of monitor signal v<highlight><subscript>amk</subscript></highlight>; the result is </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>amk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>)&equals;&verbar;<highlight><italic>h</italic></highlight><highlight><subscript>sk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&verbar;<highlight><superscript>2</superscript></highlight><highlight><italic>&middot;P</italic></highlight><highlight><subscript>ak</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>); </in-line-formula></paragraph>
<paragraph id="P-0107" lvl="2"><number>&lsqb;0107&rsqb;</number> (7) determine the observation filter gain at frequency f<highlight><subscript>i </subscript></highlight>as </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>h</italic></highlight><highlight><subscript>sk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;<highlight><italic>a</italic></highlight><highlight><subscript>k</subscript></highlight><highlight><italic>&prime;&middot;C</italic></highlight><highlight><subscript>amk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)/(<highlight><italic>C</italic></highlight><highlight><subscript>eamk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&minus;<highlight><italic>C&prime;</italic></highlight><highlight><subscript>eamk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)). </in-line-formula></paragraph>
<paragraph id="P-0108" lvl="0"><number>&lsqb;0108&rsqb;</number> In another aspect of the present invention, the adjuster circuit <highlight><bold>1309</bold></highlight> precedes the power amplifier <highlight><bold>103</bold></highlight>, as shown in <cross-reference target="DRAWINGS">FIG. 13</cross-reference>, an expanded version of <cross-reference target="DRAWINGS">FIG. 7</cross-reference>. The branch filters h<highlight><subscript>c0</subscript></highlight>(f) <highlight><bold>1330</bold></highlight> and h<highlight><subscript>c1</subscript></highlight>(f) <highlight><bold>1332</bold></highlight> can be as simple as delays or as complex as general linear filters. These filters respectively precede CGAs <highlight><bold>1331</bold></highlight> and <highlight><bold>1332</bold></highlight>, the outputs of which are summed by combiner <highlight><bold>1334</bold></highlight>. In this model, the amplifier gain is included in the branch filter responses. The filter h<highlight><subscript>r</subscript></highlight>(f) <highlight><bold>1310</bold></highlight> in the reference branch may also be simple or complex; even if such a filter is not inserted explicitly, h<highlight><subscript>r</subscript></highlight>(f) <highlight><bold>1310</bold></highlight> represents the response of the branch. The RF switch <highlight><bold>1340</bold></highlight> is optional; as explained below, its presence or absence gives rise to two embodiments. The objective in both cases is to determine the responses of the observation filters h<highlight><subscript>p0</subscript></highlight>(f) <highlight><bold>1320</bold></highlight> and h<highlight><subscript>p1</subscript></highlight>(f) <highlight><bold>1321</bold></highlight> at selected frequencies. </paragraph>
<paragraph id="P-0109" lvl="0"><number>&lsqb;0109&rsqb;</number> In the first of such embodiments, the RF switch <highlight><bold>1340</bold></highlight> is absent and there is an unobstructed path from the output of filter h<highlight><subscript>r</subscript></highlight>(f) <highlight><bold>1310</bold></highlight> to the input of the subtractor <highlight><bold>106</bold></highlight>. To determine the response h<highlight><subscript>pk</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>) of the observation filter k at frequency f<highlight><subscript>i </subscript></highlight>the adaptation controller <highlight><bold>1314</bold></highlight> performs the following actions: </paragraph>
<paragraph id="P-0110" lvl="2"><number>&lsqb;0110&rsqb;</number> (1) set the power amplifier to standby mode, so that its output is zero; </paragraph>
<paragraph id="P-0111" lvl="2"><number>&lsqb;0111&rsqb;</number> (2) apply an input signal containing the frequency components at frequency f<highlight><subscript>i </subscript></highlight>or use an internal pilot signal generator set to frequency f<highlight><subscript>i</subscript></highlight>; the power of the signal is set to operate the power amplifier at a nominal operating point; </paragraph>
<paragraph id="P-0112" lvl="2"><number>&lsqb;0112&rsqb;</number> (3) use a partial correlator, with local oscillators set to select frequency f<highlight><subscript>i</subscript></highlight>, to produce the correlation of signal v<highlight><subscript>e </subscript></highlight>with monitor signal v<highlight><subscript>cmk</subscript></highlight>; the result is a bias term: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C&prime;</italic></highlight><highlight><subscript>ecmk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;&minus;h<highlight><subscript>r</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;<highlight><italic>h</italic></highlight><highlight><subscript>pk</subscript></highlight><highlight><superscript>*</superscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>)&middot;h<highlight><subscript>ck</subscript></highlight><highlight><superscript>*</superscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;<highlight><italic>P</italic></highlight><highlight><subscript>in</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>), where </in-line-formula></paragraph>
<paragraph id="P-0113" lvl="2"><number>&lsqb;0113&rsqb;</number> &emsp;P<highlight><subscript>in</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>) is the input power at frequency f<highlight><subscript>i</subscript></highlight>; </paragraph>
<paragraph id="P-0114" lvl="2"><number>&lsqb;0114&rsqb;</number> (4) restore the power amplifier to operational mode; </paragraph>
<paragraph id="P-0115" lvl="2"><number>&lsqb;0115&rsqb;</number> (5) set the branch-k CGA gain to some nominal value c&prime;<highlight><subscript>k</subscript></highlight>; set all other CGA gains to zero; </paragraph>
<paragraph id="P-0116" lvl="2"><number>&lsqb;0116&rsqb;</number> (6) use a partial correlator, with local oscillators set to select frequency f<highlight><subscript>i</subscript></highlight>, to produce the correlation of signal v<highlight><subscript>e </subscript></highlight>with monitor signal v<highlight><subscript>cmk</subscript></highlight>; the result is: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>ecmk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;(<highlight><italic>c&prime;</italic></highlight><highlight><subscript>k</subscript></highlight><highlight><italic>&middot;h</italic></highlight><highlight><subscript>ck</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&minus;<highlight><italic>h</italic></highlight><highlight><subscript>r</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>))&middot;<highlight><italic>h</italic></highlight><highlight><subscript>pk</subscript></highlight><highlight><superscript>*</superscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;<highlight><italic>h</italic></highlight><highlight><subscript>ck</subscript></highlight><highlight><superscript>*</superscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;<highlight><italic>P</italic></highlight><highlight><subscript>in</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>); </in-line-formula></paragraph>
<paragraph id="P-0117" lvl="2"><number>&lsqb;0117&rsqb;</number> (7) use a partial correlator, with local oscillators set to select frequency f<highlight><subscript>i</subscript></highlight>, to produce the correlation of monitor signal v<highlight><subscript>cmk </subscript></highlight>with itself; the result is: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>cmk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;&verbar;<highlight><italic>h</italic></highlight><highlight><subscript>pk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&verbar;<highlight><superscript>2</superscript></highlight><highlight><italic>&middot;&verbar;h</italic></highlight><highlight><subscript>ck</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&verbar;<highlight><superscript>2</superscript></highlight><highlight><italic>&middot;P</italic></highlight><highlight><subscript>in</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>); </in-line-formula></paragraph>
<paragraph id="P-0118" lvl="2"><number>&lsqb;0118&rsqb;</number> (8) determine the branch-k observation filter response at frequency f<highlight><subscript>i </subscript></highlight>as: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>h</italic></highlight><highlight><subscript>pk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)<highlight><italic>C&prime;</italic></highlight><highlight><subscript>k</subscript></highlight><highlight><italic>c</italic></highlight><highlight><subscript>cmk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)/(<highlight><italic>C</italic></highlight><highlight><subscript>ecmk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&minus;C&prime;<highlight><subscript>ecmk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)). </in-line-formula></paragraph>
<paragraph id="P-0119" lvl="0"><number>&lsqb;0119&rsqb;</number> The observation filter responses for the other filters are determined similarly. In the second embodiment of this aspect of the present invention, the RF switch <highlight><bold>1340</bold></highlight> is present. As will be seen, it simplifies the calibration procedure significantly. To determine the response h<highlight><subscript>pk</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>) of the observation filter k at frequency f<highlight><subscript>i</subscript></highlight>, the adaptation controller performs the following actions: </paragraph>
<paragraph id="P-0120" lvl="2"><number>&lsqb;0120&rsqb;</number> (1) open the RF switch <highlight><bold>1340</bold></highlight>, thereby disconnecting the filter h<highlight><subscript>r</subscript></highlight>(f) <highlight><bold>1310</bold></highlight> from the subtractor <highlight><bold>106</bold></highlight>; </paragraph>
<paragraph id="P-0121" lvl="2"><number>&lsqb;0121&rsqb;</number> (2) apply an input signal containing the frequency components at frequency f<highlight><subscript>i </subscript></highlight>or use an internal pilot signal generator set to frequency f<highlight><subscript>1</subscript></highlight>; the power of the signal is set to operate the power amplifier at a nominal operating point; </paragraph>
<paragraph id="P-0122" lvl="2"><number>&lsqb;0122&rsqb;</number> (3) set the branch-k CGA gain to some nominal value c&prime;<highlight><subscript>k</subscript></highlight>; set all other CGA gains to zero; </paragraph>
<paragraph id="P-0123" lvl="2"><number>&lsqb;0123&rsqb;</number> (4) use a partial correlator, with local oscillators set to select frequency f<highlight><subscript>i</subscript></highlight>, to produce the correlation of signal v<highlight><subscript>e </subscript></highlight>with monitor signal v<highlight><subscript>cmk</subscript></highlight>; the result is: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>ecmk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>)&equals;c&prime;<highlight><subscript>k</subscript></highlight><highlight><italic>&verbar;h</italic></highlight><highlight><subscript>ck</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&verbar;<highlight><superscript>2</superscript></highlight><highlight><italic>h</italic></highlight><highlight><subscript>pk</subscript></highlight><highlight><superscript>*</superscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;P<highlight><subscript>in</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>), where <highlight><italic>P</italic></highlight><highlight><subscript>in</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>) </in-line-formula></paragraph>
<paragraph id="P-0124" lvl="2"><number>&lsqb;0124&rsqb;</number> &emsp;is the input power at frequency f<highlight><subscript>i</subscript></highlight>; </paragraph>
<paragraph id="P-0125" lvl="2"><number>&lsqb;0125&rsqb;</number> (5) use a partial correlator, with local oscillators set to select frequency f<highlight><subscript>1</subscript></highlight>, to produce the correlation of signal monitor v<highlight><subscript>cmk </subscript></highlight>with itself; the result is: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>cmk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;&verbar;<highlight><italic>h</italic></highlight><highlight><subscript>pk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&verbar;<highlight><superscript>2</superscript></highlight><highlight><italic>&middot;&verbar;h</italic></highlight><highlight><subscript>ck</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&verbar;<highlight><superscript>2</superscript></highlight><highlight><italic>&middot;P</italic></highlight><highlight><subscript>in</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>); </in-line-formula></paragraph>
<paragraph id="P-0126" lvl="2"><number>&lsqb;0126&rsqb;</number> (6) determine the branch-k observation filter response at frequency f<highlight><subscript>i </subscript></highlight>as: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>h</italic></highlight><highlight><subscript>pk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)<highlight><italic>c&prime;</italic></highlight><highlight><subscript>k</subscript></highlight><highlight><italic>C</italic></highlight><highlight><subscript>cmk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>)/(<highlight><italic>C</italic></highlight><highlight><subscript>ecmk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>); </in-line-formula></paragraph>
<paragraph id="P-0127" lvl="2"><number>&lsqb;0127&rsqb;</number> (7) close the RF switch <highlight><bold>1340</bold></highlight>. </paragraph>
<paragraph id="P-0128" lvl="0"><number>&lsqb;0128&rsqb;</number> The observation filter responses for the other filters are determined similarly. </paragraph>
<paragraph id="P-0129" lvl="0"><number>&lsqb;0129&rsqb;</number> In still another aspect of the present invention, the adjuster circuit <highlight><bold>1409</bold></highlight> precedes the power amplifier <highlight><bold>103</bold></highlight>, as shown in <cross-reference target="DRAWINGS">FIG. 14</cross-reference>. Branch filters h<highlight><subscript>c0</subscript></highlight>(v, f) to h<highlight><subscript>c,K&minus;1</subscript></highlight>(v, f) (<highlight><bold>1430</bold></highlight>, <highlight><bold>1432</bold></highlight>, <highlight><bold>1434</bold></highlight>) are general nonlinearities with possible frequency dependence, as indicated by the two arguments v, the input signal, and f, the frequency. In implementation, they can take the form of monomial (cubic, quintic, etc.) memoryless nonlinearities. More general nonlinearities such as Bessel functions or step functions, or any other convenient nonlinearity, may also be employed. One or more of these branch filters may instead have linear characteristics and frequency dependence. For example, they may take the form of delays or general linear filters, as in the aspect of the invention described immediately above. In the most general form, the branch filters depend on both the input signal and frequency, where such dependencies may be intentional or inadvertent. In this model, the amplifier gain is included in the branch filter responses. The branch filters <highlight><bold>1430</bold></highlight>, <highlight><bold>1432</bold></highlight>, and <highlight><bold>1434</bold></highlight> respectively precede CGAs <highlight><bold>1431</bold></highlight>, <highlight><bold>1433</bold></highlight>, and <highlight><bold>1435</bold></highlight>, the outputs of which are summed by combiner <highlight><bold>1436</bold></highlight>. </paragraph>
<paragraph id="P-0130" lvl="0"><number>&lsqb;0130&rsqb;</number> The filter h<highlight><subscript>r</subscript></highlight>(f) <highlight><bold>1410</bold></highlight> in the reference branch may also be a simple delay or a more general filter; even if such a filter is not inserted explicitly, h<highlight><subscript>r</subscript></highlight>(f) <highlight><bold>1410</bold></highlight> represents the response of the branch. The objective is to determine the responses of the observation filters h<highlight><subscript>p0</subscript></highlight>(f) to h<highlight><subscript>p,K&minus;1</subscript></highlight>(f) (<highlight><bold>1420</bold></highlight>, <highlight><bold>1421</bold></highlight>, and <highlight><bold>1422</bold></highlight>) at selected frequencies. </paragraph>
<paragraph id="P-0131" lvl="0"><number>&lsqb;0131&rsqb;</number> To determine the response h<highlight><subscript>pk</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>) of the observation filter k at frequency f<highlight><subscript>i</subscript></highlight>, the adaptation controller performs the following actions: </paragraph>
<paragraph id="P-0132" lvl="2"><number>&lsqb;0132&rsqb;</number> (1) open the RF switch <highlight><bold>1440</bold></highlight>, thereby disconnecting the filter h<highlight><subscript>r</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>) <highlight><bold>1410</bold></highlight> from the subtractor <highlight><bold>106</bold></highlight>; </paragraph>
<paragraph id="P-0133" lvl="2"><number>&lsqb;0133&rsqb;</number> (2) apply an input signal containing the frequency components at frequency f<highlight><subscript>i </subscript></highlight>or use an internal pilot signal generator set to frequency f<highlight><subscript>i</subscript></highlight>; </paragraph>
<paragraph id="P-0134" lvl="2"><number>&lsqb;0134&rsqb;</number> (3) set all CGA gains other than that for branch k to zero; select the branch-k CGA gain to c&prime;<highlight><subscript>k </subscript></highlight>and the power of the input signal in some convenient combination to cause the power amplifier to operate at a preselected output power that is common to all branches k and frequencies f<highlight><subscript>i </subscript></highlight>in this calibration procedure; doing so makes the amplifier gain and phase shift the same for all branches and frequencies during calibration; </paragraph>
<paragraph id="P-0135" lvl="2"><number>&lsqb;0135&rsqb;</number> (4) use a partial correlator, with local oscillators set to select frequency f<highlight><subscript>i</subscript></highlight>, to produce the correlation of signal v<highlight><subscript>e </subscript></highlight>with monitor signal v<highlight><subscript>cmk</subscript></highlight>(f<highlight><subscript>1</subscript></highlight>); the result is: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>ecmk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;<highlight><italic>c&prime;</italic></highlight><highlight><subscript>k</subscript></highlight><highlight><italic>&middot;h</italic></highlight><highlight><subscript>pk</subscript></highlight><highlight><superscript>*</superscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&middot;<highlight><italic>P</italic></highlight><highlight><subscript>ck</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>), where <highlight><italic>P</italic></highlight><highlight><subscript>ck</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>) is the </in-line-formula></paragraph>
<paragraph id="P-0136" lvl="2"><number>&lsqb;0136&rsqb;</number> &emsp;power of signal v<highlight><subscript>ck </subscript></highlight>at frequency f<highlight><subscript>i</subscript></highlight>; </paragraph>
<paragraph id="P-0137" lvl="2"><number>&lsqb;0137&rsqb;</number> (5) use a partial correlator, with local oscillators set to select frequency f<highlight><subscript>i</subscript></highlight>, to produce the correlation of signal monitor v<highlight><subscript>cmk</subscript></highlight>(f<highlight><subscript>i</subscript></highlight>) with itself; the result is: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight><highlight><subscript>cmk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;&verbar;<highlight><italic>h</italic></highlight><highlight><subscript>pk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&verbar;<highlight><superscript>2</superscript></highlight><highlight><italic>&middot;P</italic></highlight><highlight><subscript>ck</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>); </in-line-formula></paragraph>
<paragraph id="P-0138" lvl="2"><number>&lsqb;0138&rsqb;</number> (6) determine the branch-k observation filter response at frequency f<highlight><subscript>i </subscript></highlight>as: </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>h</italic></highlight><highlight><subscript>pk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>i</subscript></highlight>)&equals;<highlight><italic>c&prime;</italic></highlight><highlight><subscript>k</subscript></highlight><highlight><italic>C</italic></highlight><highlight><subscript>cmk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>)/<highlight><italic>C</italic></highlight><highlight><subscript>ecmk</subscript></highlight>(<highlight><italic>f</italic></highlight><highlight><subscript>1</subscript></highlight>). </in-line-formula></paragraph>
<paragraph id="P-0139" lvl="2"><number>&lsqb;0139&rsqb;</number> (7) close the RF switch. </paragraph>
<paragraph id="P-0140" lvl="0"><number>&lsqb;0140&rsqb;</number> The observation filter responses for the other filters are determined similarly. </paragraph>
<paragraph id="P-0141" lvl="0"><number>&lsqb;0141&rsqb;</number> As will be apparent to those skilled in the art in light of the foregoing disclosure, many alterations and modifications are possible in the practice of this invention without departing from the spirit or scope thereof. For example, the adjuster circuits of an analog predistorter or a feedforward linearizer can employ both memory and nonlinearity in their branches. A cascade combination of a monomial and a filter within a branch is one way to accomplish this. </paragraph>
<paragraph id="P-0142" lvl="0"><number>&lsqb;0142&rsqb;</number> In addition, <cross-reference target="DRAWINGS">FIG. 5</cross-reference> illustrates a hybrid predistortion-feedforward circuit. The predistortion adjuster is implemented with a polynomial adjuster <highlight><bold>109</bold></highlight> as described above and shown in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, and the distortion adjuster is implemented using the FIR adjuster <highlight><bold>111</bold></highlight> described above and shown in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>. The signal adjuster circuit <highlight><bold>110</bold></highlight> is a delay line having a delay selected to match that of the polynomial adjuster <highlight><bold>109</bold></highlight> and the power amplifier <highlight><bold>103</bold></highlight>. The delay <highlight><bold>112</bold></highlight> of the delay line in the distortion cancellation circuit <highlight><bold>102</bold></highlight> is selected to match that of the FIR adjuster <highlight><bold>111</bold></highlight> and error amplifier <highlight><bold>108</bold></highlight>. The linearization of the power amplifier may be improved by combining the predistortion and the feedforward adjuster circuits. Further, rather than being a delay line, signal adjuster circuit <highlight><bold>110</bold></highlight> may be a FIR adjuster. </paragraph>
<paragraph id="P-0143" lvl="0"><number>&lsqb;0143&rsqb;</number> Other variations of the preceding linearizer circuits and self-calibration methods are deemed to be within the scope of the present invention, which is to be construed solely by the following claims. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is claimed is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. A linearizer for an amplifier, comprising: 
<claim-text>a signal adjuster having an internal signal; </claim-text>
<claim-text>an adaptation controller for monitoring said signal adjuster, the internal signal at an input to said adaptation controller being deemed a monitor signal, said adaptation controller generating a control signal for said signal adjuster by accounting for a difference between the internal and monitor signals. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. A linearizer according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said adaptation controller determines a response of an observation filter representing the difference between the internal and monitor signals. </claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. A linearizer according to <dependent-claim-reference depends_on="CLM-00002">claim 2</dependent-claim-reference>, wherein said adaptation controller accounts for the difference between the internal and monitor signals by dividing the monitor signal by the observation filter response. </claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. A linearizer according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said signal adjuster and amplifier forms part of a signal cancellation circuit of said linearizer. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. A linearizer according to <dependent-claim-reference depends_on="CLM-00004">claim 4</dependent-claim-reference>, wherein said signal adjuster is in series with the amplifier in the signal cancellation circuit. </claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. A linearizer according to <dependent-claim-reference depends_on="CLM-00005">claim 5</dependent-claim-reference>, wherein said signal adjuster is in parallel with the amplifier in the signal cancellation circuit. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. A linearizer according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said signal adjuster forms part of a distortion cancellation circuit of said linearizer. </claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. A linearizer according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said signal adjuster comprises an analog predistorter. </claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. A linearizer according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said signal adjuster comprises an FIR filter. </claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. A linearizer according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said signal adjuster comprises a filter having a linear combination of frequency-dependent nonlinearities. </claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. A method for generating a control signal for a signal adjuster of an amplifier linearizer, wherein the signal adjuster has an internal signal, comprising the steps of: 
<claim-text>monitoring a monitor signal using an adaptation controller, the internal signal at an input to the adaptation controller being deemed the monitor signal; </claim-text>
<claim-text>generating a control signal for the signal adjuster by accounting for a difference between the internal and monitor signals. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference>, further comprising the step of determining a response of an observation filter representing the difference between the internal and monitor signals. </claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00011">claim 12</dependent-claim-reference>, wherein said adaptation controller accounts for the difference between the internal and monitor signals by dividing the monitor signal by the observation filter response. </claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. A method for self-calibrating a linearizer for an amplifier, the linearizer having a signal adjuster circuit with a plurality of complex gain adjusters, and an adaptation controller, the signal input to each of the complex gain adjusters being output from the signal adjuster circuit to the adaptation controller, said method comprising the steps of: 
<claim-text>(1) setting the amplifier to standby so its output is zero; </claim-text>
<claim-text>(2) setting a complex gain of a first complex gain adjuster to a nominal value and the other complex adjuster gains to zero; </claim-text>
<claim-text>(3) applying an input signal to the adjuster circuit, the negative output of the adjuster circuit being an error signal; </claim-text>
<claim-text>(4) bandpass correlating the error signal with the input signal to the first complex gain adjuster to generate a first correlation value; </claim-text>
<claim-text>(5) bandpass correlating the input signal to the first complex gain adjuster with itself to generate a second correlation value; </claim-text>
<claim-text>(6) computing a first observation filter response, corresponding to the first complex gain adjuster, by multiplying the nominal complex gain value by the second correlation value and by dividing by the first correlation value; </claim-text>
<claim-text>(7) repeating steps (2) through (6) to compute observation filter responses corresponding to the remaining complex gain adjusters, wherein a complex gain is set to a nominal value for each remaining complex gain adjuster, and the other complex adjuster gains are set to zero. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00011">claim 14</dependent-claim-reference>, further comprising the step: 
<claim-text>(8) adjusting the signal adjuster signals at the input of the adaptation controller by dividing them by the corresponding computed observation filter responses. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. A method for self-calibrating a linearizer for an amplifier, the linearizer having a signal distortion adjuster circuit and a distortion adjuster circuit, the latter circuit having a plurality of complex gain adjusters, and an adaptation controller, the signal input to each of the complex gain adjusters being output from the distortion adjuster circuit to the adaptation controller, said method comprising the steps of: 
<claim-text>(1) setting the amplifier to standby so its output is zero and setting the signal adjuster circuit to produce a non-zero value; </claim-text>
<claim-text>(2) setting a complex gain of a first complex gain adjuster to a nominal value and the other complex adjuster gains to zero; </claim-text>
<claim-text>(3) applying an input signal to the adjuster circuit so as to produce an output signal from the linearizer; </claim-text>
<claim-text>(4) bandpass correlating the output signal with the input signal to the first complex gain adjuster to generate a first correlation value; </claim-text>
<claim-text>(5) bandpass correlating the input signal to the first complex gain adjuster with itself to generate a second correlation value; </claim-text>
<claim-text>(6) computing a first observation filter response, corresponding to the first complex gain adjuster, by multiplying the nominal complex gain value by the second correlation value and by dividing by the first correlation value; </claim-text>
<claim-text>(7) repeating steps (2) through (6) to compute observation filter responses corresponding to the remaining complex gain adjusters of the distortion adjuster circuit, wherein a complex gain is set to a nominal value for each remaining complex gain adjuster, and the other complex adjuster gains are set to zero. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, further comprising the step: 
<claim-text>(8) adjusting the distortion adjuster signals at the input of the adaptation controller by dividing them by the corresponding computed observation filter responses. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. A controller for controlling a signal adjuster of a linearizer for an amplifier, the signal adjuster having an internal signal, the controller comprising: 
<claim-text>means for computing a difference between the internal signal, and the internal signal as it exists at an input to said controller (&ldquo;the monitor signal&rdquo;); and </claim-text>
<claim-text>means for adjusting the monitor signal based on the computed difference. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. A controller according to <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference>, further comprising means to compute a control signal for the signal adjuster using the adjusted monitor signal.</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>1</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030001672A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030001672A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030001672A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030001672A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030001672A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030001672A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030001672A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030001672A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030001672A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00009">
<image id="EMI-D00009" file="US20030001672A1-20030102-D00009.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00010">
<image id="EMI-D00010" file="US20030001672A1-20030102-D00010.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00011">
<image id="EMI-D00011" file="US20030001672A1-20030102-D00011.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00012">
<image id="EMI-D00012" file="US20030001672A1-20030102-D00012.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00013">
<image id="EMI-D00013" file="US20030001672A1-20030102-D00013.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00014">
<image id="EMI-D00014" file="US20030001672A1-20030102-D00014.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
