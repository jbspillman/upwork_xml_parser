<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030001939A1-20030102-M00001.NB SYSTEM "US20030001939A1-20030102-M00001.NB" NDATA NB>
<!ENTITY US20030001939A1-20030102-M00001.TIF SYSTEM "US20030001939A1-20030102-M00001.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-M00002.NB SYSTEM "US20030001939A1-20030102-M00002.NB" NDATA NB>
<!ENTITY US20030001939A1-20030102-M00002.TIF SYSTEM "US20030001939A1-20030102-M00002.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00000.TIF SYSTEM "US20030001939A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00001.TIF SYSTEM "US20030001939A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00002.TIF SYSTEM "US20030001939A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00003.TIF SYSTEM "US20030001939A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00004.TIF SYSTEM "US20030001939A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00005.TIF SYSTEM "US20030001939A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00006.TIF SYSTEM "US20030001939A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00007.TIF SYSTEM "US20030001939A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00008.TIF SYSTEM "US20030001939A1-20030102-D00008.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00009.TIF SYSTEM "US20030001939A1-20030102-D00009.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00010.TIF SYSTEM "US20030001939A1-20030102-D00010.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00011.TIF SYSTEM "US20030001939A1-20030102-D00011.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00012.TIF SYSTEM "US20030001939A1-20030102-D00012.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00013.TIF SYSTEM "US20030001939A1-20030102-D00013.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00014.TIF SYSTEM "US20030001939A1-20030102-D00014.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00015.TIF SYSTEM "US20030001939A1-20030102-D00015.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00016.TIF SYSTEM "US20030001939A1-20030102-D00016.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00017.TIF SYSTEM "US20030001939A1-20030102-D00017.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00018.TIF SYSTEM "US20030001939A1-20030102-D00018.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00019.TIF SYSTEM "US20030001939A1-20030102-D00019.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00020.TIF SYSTEM "US20030001939A1-20030102-D00020.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00021.TIF SYSTEM "US20030001939A1-20030102-D00021.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00022.TIF SYSTEM "US20030001939A1-20030102-D00022.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00023.TIF SYSTEM "US20030001939A1-20030102-D00023.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00024.TIF SYSTEM "US20030001939A1-20030102-D00024.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00025.TIF SYSTEM "US20030001939A1-20030102-D00025.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00026.TIF SYSTEM "US20030001939A1-20030102-D00026.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00027.TIF SYSTEM "US20030001939A1-20030102-D00027.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00028.TIF SYSTEM "US20030001939A1-20030102-D00028.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00029.TIF SYSTEM "US20030001939A1-20030102-D00029.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00030.TIF SYSTEM "US20030001939A1-20030102-D00030.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00031.TIF SYSTEM "US20030001939A1-20030102-D00031.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00032.TIF SYSTEM "US20030001939A1-20030102-D00032.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00033.TIF SYSTEM "US20030001939A1-20030102-D00033.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00034.TIF SYSTEM "US20030001939A1-20030102-D00034.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00035.TIF SYSTEM "US20030001939A1-20030102-D00035.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00036.TIF SYSTEM "US20030001939A1-20030102-D00036.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00037.TIF SYSTEM "US20030001939A1-20030102-D00037.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00038.TIF SYSTEM "US20030001939A1-20030102-D00038.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00039.TIF SYSTEM "US20030001939A1-20030102-D00039.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00040.TIF SYSTEM "US20030001939A1-20030102-D00040.TIF" NDATA TIF>
<!ENTITY US20030001939A1-20030102-D00041.TIF SYSTEM "US20030001939A1-20030102-D00041.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030001939</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10000735</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20011031</filing-date>
</domestic-filing-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>G01V008/00</ipc>
</classification-ipc-primary>
<classification-ipc-secondary>
<ipc>G01N021/86</ipc>
</classification-ipc-secondary>
<classification-ipc-secondary>
<ipc>B41J002/01</ipc>
</classification-ipc-secondary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>347</class>
<subclass>105000</subclass>
</uspc>
</classification-us-primary>
</classification-us>
<title-of-invention>Early transparency detection routine for inkjet printing</title-of-invention>
</technical-information>
<continuity-data>
<continuations>
<continuation-in-part-of>
<parent-child>
<child>
<document-id>
<doc-number>10000735</doc-number>
<kind-code>A1</kind-code>
<document-date>20011031</document-date>
</document-id>
</child>
<parent>
<document-id>
<doc-number>09607206</doc-number>
<document-date>20000628</document-date>
<country-code>US</country-code>
</document-id>
</parent>
<parent-status>PENDING</parent-status>
</parent-child>
</continuation-in-part-of>
</continuations>
<continuations>
<continuation-in-part-of>
<parent-child>
<child>
<document-id>
<doc-number>09607206</doc-number>
<document-date>20000628</document-date>
<country-code>US</country-code>
</document-id>
</child>
<parent>
<document-id>
<doc-number>09430487</doc-number>
<document-date>19991029</document-date>
<country-code>US</country-code>
</document-id>
</parent>
<parent-status>GRANTED</parent-status>
<parent-patent>
<document-id>
<doc-number>6325505</doc-number>
<country-code>US</country-code>
</document-id>
</parent-patent>
</parent-child>
</continuation-in-part-of>
</continuations>
<continuations>
<continuation-in-part-of>
<parent-child>
<child>
<document-id>
<doc-number>09430487</doc-number>
<document-date>19991029</document-date>
<country-code>US</country-code>
</document-id>
</child>
<parent>
<document-id>
<doc-number>09183086</doc-number>
<document-date>19981029</document-date>
<country-code>US</country-code>
</document-id>
</parent>
<parent-status>GRANTED</parent-status>
<parent-patent>
<document-id>
<doc-number>6322192</doc-number>
<country-code>US</country-code>
</document-id>
</parent-patent>
</parent-child>
</continuation-in-part-of>
</continuations>
<continuations>
<continuation-in-part-of>
<parent-child>
<child>
<document-id>
<doc-number>09183086</doc-number>
<document-date>19981029</document-date>
<country-code>US</country-code>
</document-id>
</child>
<parent>
<document-id>
<doc-number>08885486</doc-number>
<document-date>19970630</document-date>
<country-code>US</country-code>
</document-id>
</parent>
<parent-status>GRANTED</parent-status>
<parent-patent>
<document-id>
<doc-number>6036298</doc-number>
<country-code>US</country-code>
</document-id>
</parent-patent>
</parent-child>
</continuation-in-part-of>
</continuations>
</continuity-data>
<inventors>
<first-named-inventor>
<name>
<given-name>Stuart</given-name>
<middle-name>A.</middle-name>
<family-name>Scofield</family-name>
</name>
<residence>
<residence-us>
<city>Battle Ground</city>
<state>WA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Steven</given-name>
<middle-name>H.</middle-name>
<family-name>Walker</family-name>
</name>
<residence>
<residence-us>
<city>Camas</city>
<state>WA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<correspondence-address>
<name-1>HEWLETT-PACKARD COMPANY</name-1>
<name-2>Intellectual Property Administration</name-2>
<address>
<address-1>P.O. Box 272400</address-1>
<city>Fort Collins</city>
<state>CO</state>
<postalcode>80527-2400</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">A system of classifying incoming media entering an inkjet printing mechanism identifies transparency media without requiring any special manufacturer markings. The media is first optically scanned using a blue-violet light at an initial intensity to obtain both diffuse and specular reflectance data. If useable, the data is compared with known values to classify the media so an optimum print mode tailored for the particular media is used. The early transparency detection system avoids time-consuming further steps trying to classify the media as photo media, plain paper, and the like, and facilitates fast printing of transparencies, which can be critical in the business environment when making last minute changes for a presentation. A printing mechanism constructed to implement this method is also provided. </paragraph>
</subdoc-abstract>
<subdoc-description>
<cross-reference-to-related-applications>
<heading lvl="1">RELATED APPLICATIONS </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> This is a continuation-in-part application of pending U.S. patent application Ser. No. 09/607,206, filed on Jun. 28, 2000, which is a continuation-in-part application of U.S. patent application Ser. No. 09/430,487, filed on Oct. 29, 1999, which is a continuation-in-part application of U.S. patent application Ser. No. 09/183,086, filed on Oct. 29, 1998, which is a continuation-in-part application of U.S. Pat. No. 6,036,298, issued on Mar. 14, 2000, all having one inventor in common.</paragraph>
</cross-reference-to-related-applications>
<summary-of-invention>
<section>
<heading lvl="1">INTRODUCTION </heading>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> The present invention relates generally to inkjet printing mechanisms, and more particularly to an optical sensing system for determining information about the type of print media entering the printzone (e.g. transparencies, plain paper, premium paper, photographic paper, etc.), so the printing mechanism can automatically tailor the print mode to generate optimal images on the specific type of incoming media without requiring bothersome user intervention. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> Inkjet printing mechanisms use cartridges, often called &ldquo;pens,&rdquo; which shoot drops of liquid colorant, referred to generally herein as &ldquo;ink,&rdquo; onto a page. Each pen has a printhead formed with very small nozzles through which the ink drops are fired. To print an image, the printhead is propelled back and forth across the page, shooting drops of ink in a desired pattern as it moves. The particular ink ejection mechanism within the printhead may take on a variety of different forms known to those skilled in the art, such as those using piezo-electric or thermal printhead technology. For instance, two earlier thermal ink ejection mechanisms are shown in U.S. Pat. Nos. 5,278,584 and 4,683,481, both assigned to the present assignee, Hewlett-Packard Company. In a thermal system, a barrier layer containing ink channels and vaporization chambers is located between a nozzle orifice plate and a substrate layer. This substrate layer typically contains linear arrays of heater elements, such as resistors, which are energized to heat ink within the vaporization chambers. Upon heating, an ink droplet is ejected from a nozzle associated with the energized resistor. By selectively energizing the resistors as the printhead moves across the page, the ink is expelled in a pattern on the print media to form a desired image (e.g., picture, chart or text). </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> In closed loop inkjet printing, sensors are used to determine a particular attribute of interest, with the printer then using the sensor signal as an input to adjust the particular attribute. For pen alignment, a sensor may be used to measure the position of ink drops produced from each printhead. The printer then uses this information to adjust the timing of energizing the firing resistors to bring the resulting droplets into alignment. In such a closed loop system, user intervention is no longer required, so ease of use is maximized. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> In the past, closed loop inkjet printing systems have been too costly for the home printer market, although they have proved feasible on higher end products. For example, in the DesignJet&reg; 755 inkjet plotter, and the HP Color Copier 210 machine, both produced by the Hewlett-Packard Company of Palo Alto, Calif., the pens have been aligned using an optical sensor. The DesignJet&reg; 755 plotter used an optical sensor which may be purchased from the Hewlett-Packard Company of Palo Alto, Calif., as part no. C3195-60002, referred to herein as the &ldquo;HP &apos;002&rdquo; sensor. The HP Color Copier 210 machine uses an optical sensor which may be purchased from the Hewlett-Packard Company as part no. C5302-60014, referred to herein as the &ldquo;HP &apos;014&rdquo; sensor. The HP &apos;014 sensor is similar in function to the HP &apos;002 sensor, but the HP &apos;014 sensor uses an additional green light emitting diode (LED) and a more product-specific packaging to better fit the design of the HP Color Copier 210 machine. Both of these higher end machines have relatively low production volumes, but their higher market costs justify the addition of these relatively expensive sensors. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> In the home printer market, the media may range from a special photo quality glossy paper, down to a brown lunch sack, fabric, or anything in between. To address this media identification problem, a media detect sensor was placed adjacent to the media path through the printer, such as on the media pick pivoting mechanism or on the media input tray. The media detect sensor read an invisible-ink code pre-printed on the printing side of the media. This code enables the printer to compensate for the orientation, size and type of media by adjusting print modes for optimum print quality to compensate for these variances in the media supply, without requiring any customer intervention. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> However, media type detection is not present in the majority of inkjet printers on the commercial market today. Most printers use an open-loop process, relying on an operator to select the type of media through the software driver of their computer. Thus there is no assurance that the media actually in the input tray corresponds to the type selected for a particular print request, and unfortunately, printing with an incorrectly selected media often produces poor quality images. Compounding this problem is the fact that most users never change the media type settings at all, and most are not even aware that these settings even exist. Therefore, the typical user always prints with a default setting of the plain paper-normal mode. This is unfortunate because if a user inserts expensive photo media into the printer, the resulting images are substandard when the normal mode rather than a photo mode is selected, leaving the user effectively wasting the expensive photo media. Besides photo media, transparencies also yield particularly poor image quality when they are printed on in the plain paper-normal mode. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> The problem of distinguishing transparencies from paper was addressed in the Hewlett-Packard Company&apos;s DeskJet&reg; 2000C Professional Series Color Inkjet Printer, which uses an infrared reflective sensor to determine the presence of transparencies. This system uses the fact the light passes through the transparencies to distinguish them from photo media and plain paper. While this identification system is simple and relatively low cost, it offers limited identification of the varying types of media available to users. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> Another sensor system for media type determination used a combination transmissive/reflective sensor. The reflective portion of the sensor had two receptors at differing angles with respect to the surface of the media. By looking at the transmissive detector, a transparency could be detected due to the passage of light through the transparency. The two reflective sensors were used to measure the specular reflectance of the media and the diffuse reflectance of the media, respectively. By analyzing the ratio of these two reflectance values, specific media types were identified. To implement this system, a database was required comprising a look-up table of the reflective ratios which were correlated with the various types of media. Unfortunately, new, non-characterized media was often misidentified, leading to print quality degradation. Finally, one of the worst shortcomings of this system was that several different types of media could generate the same reflectance ratio, yet have totally different print mode classifications. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> One proposed system offered what was thought to be an ultimate solution to media type identification. In this system an invisible ink code was printed on the front side of each sheet of the media in a location where it was read by a sensor onboard the printer. This code supplied the printer driver with a wealth of information concerning the media type, manufacturer, orientation and properties. The sensor was low in cost, and the system was very reliable in that it totally unburdened the user from media selection through the driver, and insured that the loaded media was correctly identified. Unfortunately, these pre-printed invisible ink codes became visible when they were printed over. The code was then placed in the media margins to avoid this problem, for instance as discussed in U.S. Pat. No. 5,984,193, assigned to the present assignee, the Hewlett-Packard Company; however market demand is pushing inkjet printers into becoming photo generators. Thus, the margins became undesirable artifacts for photographs with a &ldquo;full-bleed&rdquo; printing scheme where the printed image extends all the way to the edge of the paper. Thus, even placing the code in what used to have been a margin when printed over in full-bleed printing mode created severe print defects. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> Still another media identification system marked the edge of the media by deforming the leading edge of the media. These edge deformations took the form of edge cuts, punched holes, scallops, etc. to make the leading edge no longer straight, with a straight edge being the plain paper default indicator. Unfortunately these edge deformation schemes required additional media processing steps to make the media. Moreover, a deformed edge lacks consumer appeal, appearing to most consumers as media which was damaged in shipping or handling. </paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a fragmented perspective view of one form of an inkjet printing mechanism, here an inkjet printer, including one form of an optical sensing system of the present invention for gathering information about an incoming sheet of media entering a printzone portion of the printing mechanism. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a schematic side elevational view of one form of an advanced media type determination optical sensor of the printer of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a graph of the specular light output of the media type determination of sensor <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, which uses a blue-violet colored LED. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a bottom plan view of the media type optical sensor of <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, taken along lines <highlight><bold>4</bold></highlight>-<highlight><bold>4</bold></highlight> thereof. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is a side elevational view of the lens assembly of <cross-reference target="DRAWINGS">FIG. 2</cross-reference>. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a top plan view of one form of a lens assembly of the media optical sensor of <cross-reference target="DRAWINGS">FIG. 2</cross-reference>. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a bottom plan view of the lens assembly of <cross-reference target="DRAWINGS">FIG. 2</cross-reference>. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a flowchart illustrating the manner in which the optical sensor of <cross-reference target="DRAWINGS">FIG. 2</cross-reference> may be used to distinguish transparency media without tape, GOSSIMER photo media, transparency media with a tape header, and plain paper from each other. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a graph of the direct current (DC) level diffuse reflectance versus media type for all plain papers, including an entry for transparencies (&ldquo;TRAN&rdquo;) and one without the tape header, labeled &ldquo;TAPE,&rdquo; as well as GOSSIMER photo papers, labeled &ldquo;GOSSIMER&num;<highlight><bold>1</bold></highlight> and GOSSIMER &num;<highlight><bold>2</bold></highlight>. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a graph of the Fourier spectrum components, up to component <highlight><bold>30</bold></highlight> for the GOSSIMER photo media. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is a graph of the Fourier spectrum components, up to component <highlight><bold>30</bold></highlight> for the representative plain paper provided by MoDo Datacopy, labeled &ldquo;MODO&rdquo; in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a graph of the sum of the Fourier spectrum components for all of the media shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is a graph of the Fourier spectrum components, up to component <highlight><bold>30</bold></highlight> for a transparency with a tape header, indicated as &ldquo;TAPE&rdquo; in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 14</cross-reference> is a graph of the summed third, sixteenth, seventeenth and eighteenth Fourier spectrum components for the plain paper media shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>, in addition to that of the TAPE header across a transparency indicated as &ldquo;TRAN.&rdquo;</paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 15</cross-reference> is a flowchart of one form of a method for determining which major category of media, e.g., plain paper, premium paper, photo paper or transparency, is entering the printzone of the printer of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, as well as determining specific types of media within major media categories, such as distinguishing between generic premium paper, matte photo premium paper, and prescored heavy greeting card stock. </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 16</cross-reference> is a flowchart of the &ldquo;collect raw data&rdquo; portion of the method of <cross-reference target="DRAWINGS">FIG. 15</cross-reference>. </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 17</cross-reference> is a flowchart of the &ldquo;massage data&rdquo; portion of the method of <cross-reference target="DRAWINGS">FIG. 15</cross-reference>. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 18</cross-reference> is a flowchart of the &ldquo;verification&rdquo; and &ldquo;select print mode&rdquo; portions of the method of <cross-reference target="DRAWINGS">FIG. 15</cross-reference>. </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 19</cross-reference> is a flowchart of a data weighting and ranking routine used in both the &ldquo;verification&rdquo; and &ldquo;select print mode&rdquo; portions of the method of <cross-reference target="DRAWINGS">FIG. 15</cross-reference>. </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> FIGS. <highlight><bold>20</bold></highlight>-<highlight><bold>23</bold></highlight> together form a flowchart which illustrates the &ldquo;major category determination&rdquo; and &ldquo;specific type determination&rdquo; portions of the method of <cross-reference target="DRAWINGS">FIG. 15</cross-reference>, specifically with: </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 20</cross-reference> showing transparency determination; </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 21</cross-reference> showing glossy photo determination; </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 22</cross-reference> showing matte photo determination; and </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 23</cross-reference> showing plain paper and premium paper determination. </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 24</cross-reference> is an enlarged schematic side elevational view of the media type optical sensor of <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, shown monitoring a sheet of plain paper or transparency media entering the printzone of the printer of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 25</cross-reference> is an enlarged schematic side-elevational view of the media type sensor of <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, shown monitoring a sheet of photo media with a uniform coating entering the printzone of the printer of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 26</cross-reference> is an enlarged schematic side-elevational view of the media type sensor of <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, shown monitoring a sheet of photo media with an irregular coating entering the printzone of the printer of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> FIGS. <highlight><bold>27</bold></highlight>-<highlight><bold>33</bold></highlight> are graphs of the raw data accumulated during the &ldquo;collect raw data&rdquo; portion of the method of <cross-reference target="DRAWINGS">FIG. 15</cross-reference>, specifically with: </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 27</cross-reference> showing data for a very glossy photo media; </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 28</cross-reference> showing data for a glossy photo media; </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 29</cross-reference> showing data for a matte photo media; </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 30</cross-reference> showing data for a plain paper media, specifically, a Gilbert&reg; Bond; </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 31</cross-reference> showing data for a premium media; </paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 32</cross-reference> showing data for HP transparency media with a tape header; and </paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 33</cross-reference> showing data for transparency media without a tape header. </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> FIGS. <highlight><bold>34</bold></highlight>-<highlight><bold>39</bold></highlight> are graphs of the Fourier spectrum components, up to component <highlight><bold>100</bold></highlight>, specifically with: </paragraph>
<paragraph id="P-0048" lvl="0"><number>&lsqb;0048&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 34</cross-reference> showing the matte photo media diffuse reflection; </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 35</cross-reference> showing the matte photo media specular reflection; </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 36</cross-reference> showing the very glossy photo media diffuse reflection; </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 37</cross-reference> showing the very glossy photo media specular reflection; </paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 38</cross-reference> showing the plain paper media diffuse reflection; and </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 39</cross-reference> showing the plain paper media specular reflection. </paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 40</cross-reference> is a graph of the diffuse spatial frequencies of several generic media, including plain paper media, premium paper media, matte photo media, glossy photo media, and transparency media. </paragraph>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 41</cross-reference> is a graph of the specular spatial frequencies of several generic media, including plain paper media, premium paper media, matte photo media, glossy photo media, and transparency media. </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 42</cross-reference> is a graph of the diffuse spatial frequencies of several specific photo media, including photo media with swellable and porous ink retention layers. </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 43</cross-reference> is a graph of the specular spatial frequencies of several specific photo media, including photo media with swellable and porous ink retention layers. </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 44</cross-reference> is a flowchart of one form of an early transparency detection system of the present invention, which may be used in conjunction with the optical sensing system of <cross-reference target="DRAWINGS">FIG. 1</cross-reference> and the advanced media determination system of <cross-reference target="DRAWINGS">FIG. 15</cross-reference>. </paragraph>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 45</cross-reference> is a flowchart illustrating the operation of one portion of the flowchart of <cross-reference target="DRAWINGS">FIG. 44</cross-reference>. </paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 46</cross-reference> is a graph of the raw data accumulated during the &ldquo;collect raw data&rdquo; portion of the method of <cross-reference target="DRAWINGS">FIG. 15</cross-reference>, showing data for transparency media either with or without a tape header. </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 47</cross-reference> is a flowchart of an alternate embodiment of an advanced media determination system using the early transparency detection system of <cross-reference target="DRAWINGS">FIG. 44</cross-reference>. </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 48</cross-reference> is a flowchart illustrating an alternate embodiment of the massage data portion of the method of <cross-reference target="DRAWINGS">FIG. 47</cross-reference>.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF A PREFERRED EMBODIMENT </heading>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> illustrates an embodiment of an inkjet printing mechanism, here shown as an inkjet printer <highlight><bold>20</bold></highlight>, constructed in accordance with the present invention, which may be used for printing for business reports, correspondence, desktop publishing, artwork, and the like, in an industrial, office, home or other environment. A variety of inkjet printing mechanisms are commercially available. For instance, some of the printing mechanisms that may embody the present invention include plotters, portable printing units, copiers, cameras, video printers, and facsimile machines, to name a few. For convenience the concepts of the present invention are illustrated in the environment of an inkjet printer <highlight><bold>20</bold></highlight> which may find particular usefulness in the home environment. </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> While it is apparent that the printer components may vary from model to model, the typical inkjet printer <highlight><bold>20</bold></highlight> includes a chassis <highlight><bold>22</bold></highlight> surrounded by a housing or casing enclosure <highlight><bold>23</bold></highlight>, the majority of which has been omitted for clarity in viewing the internal components. A print media handling system <highlight><bold>24</bold></highlight> feeds sheets of print media through a printzone <highlight><bold>25</bold></highlight>. The print media may be any type of suitable sheet material, such as paper, card-stock, envelopes, fabric, transparencies, mylar, and the like, with plain paper typically being the most commonly used print medium. The print media handling system <highlight><bold>24</bold></highlight> has a media input, such as a supply or feed tray <highlight><bold>26</bold></highlight> into which a supply of media is loaded and stored before printing. A series of conventional media advance or drive rollers (not shown) powered by a motor and gear assembly <highlight><bold>27</bold></highlight> may be used to move the print media from the supply tray <highlight><bold>26</bold></highlight> into the printzone <highlight><bold>25</bold></highlight> for printing. After printing, the media sheet then lands on a pair of retractable output drying wing members <highlight><bold>28</bold></highlight>, shown extended to receive the printed sheet. The wings <highlight><bold>28</bold></highlight> momentarily hold the newly printed sheet above any previously printed sheets still drying in an output tray portion <highlight><bold>30</bold></highlight> before retracting to the sides to drop the newly printed sheet into the output tray <highlight><bold>30</bold></highlight>. The media handling system <highlight><bold>24</bold></highlight> may include a series of adjustment mechanisms for accommodating different sizes of print media, including letter, legal, A-4, envelopes, etc. To secure the generally rectangular media sheet in a lengthwise direction along the media length, the handling system <highlight><bold>24</bold></highlight> may include a sliding length adjustment lever <highlight><bold>32</bold></highlight>, and a sliding width adjustment lever <highlight><bold>34</bold></highlight> to secure the media sheet in a width direction across the media width. </paragraph>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> The printer <highlight><bold>20</bold></highlight> also has a printer controller, illustrated schematically as a microprocessor <highlight><bold>35</bold></highlight>, that receives instructions from a host device, typically a computer, such as a personal computer (not shown). Indeed, many of the printer controller functions may be performed by the host computer, by the electronics on board the printer, or by interactions therebetween. As used herein, the term &ldquo;printer controller <highlight><bold>35</bold></highlight>&rdquo; encompasses these functions, whether performed by the host computer, the printer, an intermediary device therebetween, or by a combined interaction of such elements. A monitor coupled to the computer host may be used to display visual information to an operator, such as the printer status or a particular program being run on the host computer. Personal computers, their input devices, such as a keyboard and/or a mouse device, and monitors are all well known to those skilled in the art. </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> The chassis <highlight><bold>22</bold></highlight> supports a guide rod <highlight><bold>36</bold></highlight> that defines a scan axis <highlight><bold>38</bold></highlight> and slideably supports an inkjet printhead carriage <highlight><bold>40</bold></highlight> for reciprocal movement along the scan axis <highlight><bold>38</bold></highlight>, back and forth across the printzone <highlight><bold>25</bold></highlight>. The carriage <highlight><bold>40</bold></highlight> is driven by a carriage propulsion system, here shown as including an endless belt <highlight><bold>42</bold></highlight> coupled to a carriage drive DC motor <highlight><bold>44</bold></highlight>. The carriage propulsion system also has a position feedback system, such as a conventional optical encoder system, which communicates carriage position signals to the controller <highlight><bold>35</bold></highlight>. An optical encoder reader may be mounted to carriage <highlight><bold>40</bold></highlight> to read an encoder strip <highlight><bold>45</bold></highlight> extending along the path of carriage travel. The carriage drive motor <highlight><bold>44</bold></highlight> then operates in response to control signals received from the printer controller <highlight><bold>35</bold></highlight>. A conventional flexible, multi-conductor strip <highlight><bold>46</bold></highlight> may be used to deliver enabling or firing command control signals from the controller <highlight><bold>35</bold></highlight> to the printhead carriage <highlight><bold>40</bold></highlight> for printing, as described further below. </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> The carriage <highlight><bold>40</bold></highlight> is propelled along guide rod <highlight><bold>36</bold></highlight> into a servicing region <highlight><bold>48</bold></highlight>, which may house a service station unit (not shown) that provides various conventional printhead servicing functions. To clean and protect the printhead, typically a &ldquo;service station&rdquo; mechanism is mounted within the printer chassis so the printhead can be moved over the station for maintenance. For storage, or during non-printing periods, the service stations usually include a capping system which hermetically seals the printhead nozzles from contaminants and drying. Some caps are also designed to facilitate priming by being connected to a pumping unit that draws a vacuum on the printhead. During operation, clogs in the printhead are periodically cleared by firing a number of drops of ink through each of the nozzles in a process known as &ldquo;spitting,&rdquo; with the waste ink being collected in a &ldquo;spittoon&rdquo; reservoir portion of the service station. After spitting, uncapping, or occasionally during printing, most service stations have an elastomeric wiper that wipes the printhead surface to remove ink residue, as well as any paper dust or other debris that has collected on the printhead. </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> In the printzone <highlight><bold>25</bold></highlight>, the media receives ink from an inkjet cartridge, such as a black ink cartridge <highlight><bold>50</bold></highlight> and three monochrome color ink cartridges <highlight><bold>52</bold></highlight>, <highlight><bold>54</bold></highlight> and <highlight><bold>56</bold></highlight>, secured in the carriage <highlight><bold>40</bold></highlight> by a latching mechanism <highlight><bold>58</bold></highlight>, shown open in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. The cartridges <highlight><bold>50</bold></highlight>-<highlight><bold>56</bold></highlight> are also commonly called &ldquo;pens&rdquo; by those in the industry. The inks dispensed by the pens <highlight><bold>50</bold></highlight>-<highlight><bold>56</bold></highlight> may be pigment-based inks, dye-based inks, or combinations thereof, as well as paraffin-based inks, hybrid or composite inks having both dye and pigment characteristics. </paragraph>
<paragraph id="P-0069" lvl="0"><number>&lsqb;0069&rsqb;</number> The illustrated pens <highlight><bold>50</bold></highlight>-<highlight><bold>56</bold></highlight> each include reservoirs for storing a supply of ink therein. The reservoirs for each pen <highlight><bold>50</bold></highlight>-<highlight><bold>56</bold></highlight> may contain the entire ink supply on board the printer for each color, which is typical of a replaceable cartridge, or they may store only a small supply of ink in what is known as an &ldquo;off-axis&rdquo; ink delivery system. The replaceable cartridge systems carry the entire ink supply as the pen reciprocates over the printzone <highlight><bold>25</bold></highlight> along the scanning axis <highlight><bold>38</bold></highlight>. Hence, the replaceable cartridge system may be considered as an &ldquo;on-axis&rdquo; system, whereas systems which store the main ink supply at a stationary location remote from the printzone scanning axis are called &ldquo;off-axis&rdquo; systems. In an off-axis system, the main ink supply for each color is stored at a stationary location in the printer, such as four refillable or replaceable main reservoirs <highlight><bold>60</bold></highlight>, <highlight><bold>62</bold></highlight>, <highlight><bold>64</bold></highlight> and <highlight><bold>66</bold></highlight>, which are received in a stationary ink supply receptacle <highlight><bold>68</bold></highlight> supported by the chassis <highlight><bold>22</bold></highlight>. The pens <highlight><bold>50</bold></highlight>, <highlight><bold>52</bold></highlight>, <highlight><bold>54</bold></highlight> and <highlight><bold>56</bold></highlight> have printheads <highlight><bold>70</bold></highlight>, <highlight><bold>72</bold></highlight>, <highlight><bold>74</bold></highlight> and <highlight><bold>76</bold></highlight>, respectively, which eject ink delivered via a conduit or tubing system <highlight><bold>78</bold></highlight> from the stationary reservoirs <highlight><bold>60</bold></highlight>-<highlight><bold>66</bold></highlight> to the on-board reservoirs adjacent the printheads <highlight><bold>70</bold></highlight>-<highlight><bold>76</bold></highlight>. </paragraph>
<paragraph id="P-0070" lvl="0"><number>&lsqb;0070&rsqb;</number> The printheads <highlight><bold>70</bold></highlight>-<highlight><bold>76</bold></highlight> each have an orifice plate with a plurality of nozzles formed therethrough in a manner well known to those skilled in the art. The nozzles of each printhead <highlight><bold>70</bold></highlight>-<highlight><bold>76</bold></highlight> are typically formed in at least one, but typically two linear arrays along the orifice plate, aligned in a longitudinal direction perpendicular to the scanning axis <highlight><bold>38</bold></highlight>. The illustrated printheads <highlight><bold>70</bold></highlight>-<highlight><bold>76</bold></highlight> are thermal inkjet printheads, although other types of printheads may be used, such as piezoelectric printheads. The thermal printheads <highlight><bold>70</bold></highlight>-<highlight><bold>76</bold></highlight> typically include a plurality of resistors which are associated with the nozzles. Upon energizing a selected resistor, a bubble of gas is formed which ejects a droplet of ink from the nozzle and onto a sheet of paper in the printzone <highlight><bold>25</bold></highlight> under the nozzle. The printhead resistors are selectively energized in response to firing command control signals received via the multi-conductor strip <highlight><bold>46</bold></highlight> from the controller <highlight><bold>35</bold></highlight>. </paragraph>
<paragraph id="P-0071" lvl="7"><number>&lsqb;0071&rsqb;</number> Optical Media Type </paragraph>
<paragraph id="P-0072" lvl="7"><number>&lsqb;0072&rsqb;</number> Determination Sensor </paragraph>
<paragraph id="P-0073" lvl="0"><number>&lsqb;0073&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> illustrates one form of an optical media type determination sensor or &ldquo;media sensor&rdquo; <highlight><bold>100</bold></highlight> constructed in accordance with the present invention. The sensor <highlight><bold>100</bold></highlight> includes a casing or base unit <highlight><bold>102</bold></highlight> may be supported by the printhead carriage <highlight><bold>40</bold></highlight> in a variety different ways known to those skilled in the art. The sensor <highlight><bold>100</bold></highlight> has an illuminating element, here, a blue-violet light emitting diode (LED) <highlight><bold>105</bold></highlight> which has an output lens <highlight><bold>106</bold></highlight>. Extending from the LED <highlight><bold>105</bold></highlight> are two input leads <highlight><bold>108</bold></highlight> and <highlight><bold>109</bold></highlight> which may be electrically coupled to conductors in a printed circuit board (not shown) secured to an exterior portion of the body <highlight><bold>102</bold></highlight> to deliver sensor signals back to the printer controller <highlight><bold>35</bold></highlight>. The printed circuit board and flexible conductors may be used to couple the sensor <highlight><bold>100</bold></highlight> to an electronics portion (not shown) of the carriage <highlight><bold>40</bold></highlight>. The sensor signals then pass from the carriage <highlight><bold>40</bold></highlight> through the multi-conductor strip <highlight><bold>46</bold></highlight>, which carries power and communication signals between the controller <highlight><bold>35</bold></highlight> and the carriage <highlight><bold>40</bold></highlight>. A lens assembly <highlight><bold>110</bold></highlight> is supported by the casing <highlight><bold>102</bold></highlight>, with the lens assembly <highlight><bold>110</bold></highlight> being described in greater detail below with respect to FIGS. <highlight><bold>5</bold></highlight>-<highlight><bold>7</bold></highlight>. </paragraph>
<paragraph id="P-0074" lvl="0"><number>&lsqb;0074&rsqb;</number> The media sensor <highlight><bold>100</bold></highlight> preferably uses a blue-violet LED <highlight><bold>105</bold></highlight> which emits an output spectrum shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference> as graph <highlight><bold>112</bold></highlight>. The blue-violet LED <highlight><bold>105</bold></highlight> has a peak wavelength of around <highlight><bold>428</bold></highlight> nanometers, and a dominant wavelength of <highlight><bold>464</bold></highlight> nanometers, yielding a more violet output than the blue LED described in U.S. Pat. No. 6,036,298, recited in the Related Applications section above, which had a peak wavelength of around 470 nanometers. Several reasons for this change in the illumination component of the media sensor <highlight><bold>100</bold></highlight> will be described near the end of the Detailed Description section. The LED <highlight><bold>105</bold></highlight> includes a negative lead frame <highlight><bold>114</bold></highlight> which is electrically coupled to the conductor <highlight><bold>108</bold></highlight>. The LED <highlight><bold>105</bold></highlight> also has a die <highlight><bold>115</bold></highlight> mounted within a reflector cup <highlight><bold>116</bold></highlight>, which is supported by the negative lead frame <highlight><bold>114</bold></highlight>. The die <highlight><bold>115</bold></highlight> is used to produce the blue-violet wavelength light of graph <highlight><bold>112</bold></highlight> emitted by the LED <highlight><bold>105</bold></highlight> when energized. A positive lead frame <highlight><bold>118</bold></highlight> is electrically coupled to conductor <highlight><bold>109</bold></highlight>, and serves to carry current therethrough when the LED <highlight><bold>105</bold></highlight> is turned on. Preferably, the negative lead frame <highlight><bold>114</bold></highlight>, the die <highlight><bold>115</bold></highlight>, the cup <highlight><bold>116</bold></highlight>, and the positive lead frame <highlight><bold>118</bold></highlight> are all encapsulated in a transparent epoxy resin body which is conformed to define the output lens <highlight><bold>106</bold></highlight> as an integral dome lens that directs light from the die <highlight><bold>115</bold></highlight> into rays which form an illuminating beam <highlight><bold>120</bold></highlight>. One preferred manner of operating the LED <highlight><bold>105</bold></highlight>, including illumination routines, is described in detail in U.S. Pat. No. 6,036,298, recited in the Related Applications section above </paragraph>
<paragraph id="P-0075" lvl="0"><number>&lsqb;0075&rsqb;</number> The media sensor <highlight><bold>100</bold></highlight> also has two filter elements <highlight><bold>122</bold></highlight> and <highlight><bold>124</bold></highlight>, which lay over portions of the lens assembly <highlight><bold>110</bold></highlight>. These filters <highlight><bold>122</bold></highlight> and <highlight><bold>124</bold></highlight> may be constructed as a singular piece, although in the illustrated embodiment two separate filters are shown. The filters <highlight><bold>122</bold></highlight> and <highlight><bold>124</bold></highlight> have a blue pass region where the low wavelength blue-violet LED light, with a wavelength of 360-510 nm, passes freely through the filters <highlight><bold>122</bold></highlight> and <highlight><bold>124</bold></highlight>, but light of other wavelengths from other sources are blocked out. Preferably, the filter elements <highlight><bold>122</bold></highlight> and <highlight><bold>124</bold></highlight> are constructed of a 1 mm (one millimeter) thick sheet of silicon dioxide (glass) using conventional thin film deposition techniques, as known to those skilled in the art. </paragraph>
<paragraph id="P-0076" lvl="0"><number>&lsqb;0076&rsqb;</number> The optical sensor <highlight><bold>100</bold></highlight> also includes a diffuse photodiode <highlight><bold>130</bold></highlight> that includes a light sensitive photocell <highlight><bold>132</bold></highlight> which is electrically coupled to an amplifier portion (not shown) of the photodiode <highlight><bold>130</bold></highlight>. The photodiode <highlight><bold>130</bold></highlight> has input lens <highlight><bold>135</bold></highlight>, which emits light to the light sensitive photocell <highlight><bold>132</bold></highlight>. The photocell <highlight><bold>132</bold></highlight> is preferably encapsulated as a package fabricated to include the curved lens <highlight><bold>135</bold></highlight> which concentrates incoming light onto the photocell <highlight><bold>132</bold></highlight>. The photodiode <highlight><bold>130</bold></highlight> also has three output leads <highlight><bold>136</bold></highlight>, <highlight><bold>137</bold></highlight> and <highlight><bold>138</bold></highlight> which couple the output from amplifier <highlight><bold>134</bold></highlight> to electrical conductors on the printed circuit board (not shown) to supply photodiode sensor signals to the controller <highlight><bold>35</bold></highlight>, via electronics on the carriage <highlight><bold>40</bold></highlight> and the multi-conductor flex strip <highlight><bold>46</bold></highlight>. While a variety of different photodiodes may be used, one preferred photodiode is a light-to-voltage converter, which may be obtained as part no. TSL 257 from Texas Analog Optical Systems (TAOS) of Dallas, Tex. </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> The optical sensor <highlight><bold>100</bold></highlight> also includes a second specular photodiode <highlight><bold>130</bold></highlight>&prime; that may be constructed as described for the diffuse photodiode <highlight><bold>130</bold></highlight>, with like components on the specular photodiode having the same item numbers as the diffuse photodiode, by carrying a &ldquo;prime&rdquo; designator (&prime;) similar to an apostrophe. Preferably, the casing <highlight><bold>102</bold></highlight> is constructed so that the LED <highlight><bold>120</bold></highlight> is optically isolated from the photodiodes <highlight><bold>130</bold></highlight>, <highlight><bold>130</bold></highlight>&prime; to prevent light emitted directly from the LED <highlight><bold>120</bold></highlight> from being perceived by the photocells <highlight><bold>132</bold></highlight>, <highlight><bold>132</bold></highlight>&prime;. Thus, the outbound light path of the LED <highlight><bold>120</bold></highlight> is optically isolated from the inbound light path of the photodiode <highlight><bold>130</bold></highlight>. </paragraph>
<paragraph id="P-0078" lvl="0"><number>&lsqb;0078&rsqb;</number> The media sensor <highlight><bold>100</bold></highlight> also has two field of view controlling elements, such as field stops <highlight><bold>140</bold></highlight> and <highlight><bold>142</bold></highlight>. The field stops <highlight><bold>140</bold></highlight> and <highlight><bold>142</bold></highlight>, as well as the filters <highlight><bold>122</bold></highlight> and <highlight><bold>124</bold></highlight>, are held in place by various portions of the casing <highlight><bold>102</bold></highlight>, and preferably, the field stops <highlight><bold>140</bold></highlight> and <highlight><bold>142</bold></highlight> are molded integrally with a portion of the casing <highlight><bold>102</bold></highlight>. The field stops <highlight><bold>140</bold></highlight> and <highlight><bold>142</bold></highlight> are preferably located approximately tangent to the apex of the input lenses <highlight><bold>135</bold></highlight>, <highlight><bold>135</bold></highlight>&prime; of the photodiodes <highlight><bold>130</bold></highlight>, <highlight><bold>130</bold></highlight>&prime;, respectively. In the illustrated embodiment, the field stops <highlight><bold>140</bold></highlight>, <highlight><bold>142</bold></highlight> define field of view openings or windows <highlight><bold>144</bold></highlight> and <highlight><bold>145</bold></highlight>, respectively. </paragraph>
<paragraph id="P-0079" lvl="0"><number>&lsqb;0079&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> shows the orientation of the field stop windows <highlight><bold>144</bold></highlight> and <highlight><bold>145</bold></highlight> with respect to the scanning axis <highlight><bold>38</bold></highlight>. In the illustrated embodiment, the field stop windows <highlight><bold>144</bold></highlight> and <highlight><bold>145</bold></highlight> are rectangular in shape, with the specular window <highlight><bold>144</bold></highlight> having a major axis <highlight><bold>146</bold></highlight> which is approximately parallel to the scanning axis <highlight><bold>38</bold></highlight>, and the diffuse field stop window <highlight><bold>145</bold></highlight> having a major axis <highlight><bold>148</bold></highlight> which is substantially perpendicular to the scanning axis <highlight><bold>38</bold></highlight>. The specular field stop <highlight><bold>144</bold></highlight> has window <highlight><bold>144</bold></highlight> oriented with a minor axis <highlight><bold>149</bold></highlight> which in the illustrated embodiment is colinear with the major axis <highlight><bold>148</bold></highlight> of the diffuse field stop window <highlight><bold>145</bold></highlight>. This orientation of the field stop windows <highlight><bold>144</bold></highlight>, <highlight><bold>145</bold></highlight> allows the diffuse photodiode <highlight><bold>130</bold></highlight> to collect data which may be distinguished from that collected by the specular photodiode <highlight><bold>130</bold></highlight>&prime;. </paragraph>
<paragraph id="P-0080" lvl="0"><number>&lsqb;0080&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> illustrates the light paths through the lens assembly <highlight><bold>110</bold></highlight> as a sheet of media <highlight><bold>150</bold></highlight>, here illustrated as paper, is scanned by sensor <highlight><bold>100</bold></highlight>. The LED <highlight><bold>105</bold></highlight> generates the output beam <highlight><bold>120</bold></highlight>, which is aimed toward an illuminated area <highlight><bold>152</bold></highlight> of the media <highlight><bold>150</bold></highlight> by first passing through the lens assembly <highlight><bold>110</bold></highlight> as an illuminating beam <highlight><bold>154</bold></highlight>. The media <highlight><bold>150</bold></highlight> produces two reflected beams, one, a diffuse reflected beam <highlight><bold>155</bold></highlight> and a specular reflected beam <highlight><bold>155</bold></highlight>&prime;. The diffuse and specular reflected beams <highlight><bold>155</bold></highlight>, <highlight><bold>155</bold></highlight>&prime; pass through the filter elements <highlight><bold>122</bold></highlight>, <highlight><bold>124</bold></highlight>, respectively to form the respective diffuse and specular filtered beams <highlight><bold>156</bold></highlight> and <highlight><bold>156</bold></highlight>&prime;. The diffuse reflected light beam <highlight><bold>155</bold></highlight> has a flame-like scattering of rays arranged in a Lambertian distribution. The specular beam <highlight><bold>155</bold></highlight>&prime; is reflected off the media <highlight><bold>150</bold></highlight> at the same angle that the incoming light beam <highlight><bold>154</bold></highlight> impacts the media, according to the well known principle of optics: &ldquo;angle of incidence equals angle of reflection.&rdquo; In the illustrated embodiment, the angle of incidence and the angle reflection are selected to be around 55&deg;. </paragraph>
<paragraph id="P-0081" lvl="0"><number>&lsqb;0081&rsqb;</number> FIGS. <highlight><bold>5</bold></highlight>-<highlight><bold>7</bold></highlight> illustrate the construction of the lens assembly <highlight><bold>110</bold></highlight>, which may be made of an optical plastic material molded with lens elements formed therein. <cross-reference target="DRAWINGS">FIG. 5</cross-reference> shows an LED output lens as having a diffractive lens element <highlight><bold>160</bold></highlight> formed along a top surface <highlight><bold>162</bold></highlight> of the lens <highlight><bold>110</bold></highlight>. The diffractive lens <highlight><bold>160</bold></highlight> is located directly beneath the LED output beam <highlight><bold>120</bold></highlight>. <cross-reference target="DRAWINGS">FIG. 6</cross-reference> illustrates a bottom view of the lens assembly <highlight><bold>110</bold></highlight> which has a bottom surface <highlight><bold>164</bold></highlight> facing down toward the media <highlight><bold>150</bold></highlight>. Opposite the diffractive lens element <highlight><bold>160</bold></highlight>, the LED output lens has a Fresnel lens element <highlight><bold>165</bold></highlight> formed along the lower surface <highlight><bold>164</bold></highlight>. <cross-reference target="DRAWINGS">FIG. 5</cross-reference> best shows a diffuse lens as having a photodiode input lens element <highlight><bold>166</bold></highlight> projecting outwardly from the lower surface <highlight><bold>164</bold></highlight>. Preferably, the lens <highlight><bold>166</bold></highlight> is a convex aspheric condenser lens. <cross-reference target="DRAWINGS">FIG. 6</cross-reference> illustrates another portion of the diffuse lens as having an upper or output lens element <highlight><bold>168</bold></highlight> which is directly opposite the input element <highlight><bold>166</bold></highlight>. While the output element <highlight><bold>168</bold></highlight> may be a flat extension of the upper surface <highlight><bold>162</bold></highlight> of the lens <highlight><bold>110</bold></highlight>, in some embodiments, contouring of the upper surface <highlight><bold>168</bold></highlight> may be desired to improve the optical input to the photodiode lens <highlight><bold>135</bold></highlight>. Preferably, the photodiode output element <highlight><bold>168</bold></highlight> is also a diffractive lens, which may be constructed as described above for the upper diode lens element <highlight><bold>160</bold></highlight> to provide correction of chromatic aberrations of the primary input lens element <highlight><bold>166</bold></highlight>. </paragraph>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> The specular photodiode <highlight><bold>130</bold></highlight>&prime; receives the filtered specular beam <highlight><bold>156</bold></highlight>&prime;. To accommodate this incoming specular reflectance beam <highlight><bold>155</bold></highlight>&prime; the lens assembly has a specular lens with an incoming Fresnel lens element <highlight><bold>165</bold></highlight>&prime;, and an outgoing diffractive lens element <highlight><bold>160</bold></highlight>&prime;, which may be constructed as described above for lens elements <highlight><bold>165</bold></highlight> and <highlight><bold>160</bold></highlight>, respectively. It is apparent to those skilled in the art that other types of lens assemblies may be used to provide the same operation as lens assembly <highlight><bold>110</bold></highlight>. For instance, the specular lens element <highlight><bold>165</bold></highlight>&prime; may be constructed with an aspheric refractive incoming lens element, and an outgoing aspheric refractive lens element or an outgoing micro-Fresnel lens. A detailed discussion of the operation of these lens elements is described in U.S. Pat. No. 6,036,298, recited in the Related Applications section above, or may be found in most basic optics textbooks. </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> A few definitions may be helpful at this point: </paragraph>
<paragraph id="P-0084" lvl="1"><number>&lsqb;0084&rsqb;</number> &ldquo;Radiance&rdquo; is the measure of the power emitted by a light source of finite size expressed in W/sr-cm2 (watts per steradian&mdash;centimeters squared). </paragraph>
<paragraph id="P-0085" lvl="1"><number>&lsqb;0085&rsqb;</number> &ldquo;Transmission&rdquo; is measure of the power that passes through a lens in terms of the ratio of the radiance of the lens image to the radiance of the original object, expressed in percent. </paragraph>
<paragraph id="P-0086" lvl="1"><number>&lsqb;0086&rsqb;</number> &ldquo;Transmittance&rdquo; is a spectrally weighted transmission, here, the ratio of the transmitted spectral reflectance going through the lens, e.g. beam <highlight><bold>154</bold></highlight>, to the incident spectral reflectance, e.g. beam <highlight><bold>155</bold></highlight>&prime;. </paragraph>
<paragraph id="P-0087" lvl="1"><number>&lsqb;0087&rsqb;</number> &ldquo;Specular reflection&rdquo; is that portion of the incident light that reflects off the media at an angle equal to the angle at which the light struck the media, the angle of incidence. </paragraph>
<paragraph id="P-0088" lvl="1"><number>&lsqb;0088&rsqb;</number> &ldquo;Reflectance&rdquo; is the ratio of the specular reflection to the incident light, expressed in percent. </paragraph>
<paragraph id="P-0089" lvl="1"><number>&lsqb;0089&rsqb;</number> &ldquo;Absorbance&rdquo; is the converse of reflectance, that is, the amount of light which is not reflected but instead absorbed by the object, expressed in percent as a ratio of the difference of the incident light minus the specular reflection, with respect to the incident light. </paragraph>
<paragraph id="P-0090" lvl="1"><number>&lsqb;0090&rsqb;</number> &ldquo;Diffuse reflection&rdquo; is that portion of the incident light that is scattered off the surface of the media <highlight><bold>150</bold></highlight> at a more or less equal intensity with respect to the viewing angle, as opposed to the specular reflectance which has the greatest intensity only at the angle of reflectance. </paragraph>
<paragraph id="P-0091" lvl="1"><number>&lsqb;0091&rsqb;</number> &ldquo;Refraction&rdquo; is the deflection of a propagating wave accomplished by modulating the speed of portions of the wave by passing them through different materials. </paragraph>
<paragraph id="P-0092" lvl="1"><number>&lsqb;0092&rsqb;</number> &ldquo;Index of refraction&rdquo; is the ratio of the speed of light in air versus the speed of light in a particular media, such as glass, quartz, water, etc. </paragraph>
<paragraph id="P-0093" lvl="1"><number>&lsqb;0093&rsqb;</number> &ldquo;Dispersion&rdquo; is the change in the index of refraction with changes in the wavelength of light. </paragraph>
<paragraph id="P-0094" lvl="7"><number>&lsqb;0094&rsqb;</number> Basic Media Type Determination System </paragraph>
<paragraph id="P-0095" lvl="0"><number>&lsqb;0095&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> illustrates one form of a preferred basic media type determination system <highlight><bold>400</bold></highlight> as a flowchart, constructed in accordance with the present invention, which may be used in conjunction with the optical sensor <highlight><bold>100</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 2</cross-reference>. The first step of this media-type determination method <highlight><bold>400</bold></highlight> consists of starting the media pick routine <highlight><bold>402</bold></highlight> where a fresh sheet of media is picked by the media handling system <highlight><bold>24</bold></highlight> from the input tray <highlight><bold>26</bold></highlight>. This fresh sheet of media is then moved into the printzone in step <highlight><bold>404</bold></highlight>. After the media pick routine is completed, the LED <highlight><bold>105</bold></highlight> of the optical sensor <highlight><bold>100</bold></highlight> is illuminated, and in step <highlight><bold>405</bold></highlight> this illumination is adjusted to bring the signal received from an unprinted portion of the media up to a near-saturation level of the analog to digital (A/D) converter, which is on the order of 5 volts. This A/D converter is within the controller <highlight><bold>35</bold></highlight>, and during data acquisition this A/D converter is enabled and allowed to acquire the output signal of the photodiode <highlight><bold>130</bold></highlight>. </paragraph>
<paragraph id="P-0096" lvl="0"><number>&lsqb;0096&rsqb;</number> Once the illumination of the LED <highlight><bold>105</bold></highlight> has been adjusted in a scanning step <highlight><bold>406</bold></highlight>, the optical sensor <highlight><bold>100</bold></highlight> is scanned across the media by carriage <highlight><bold>40</bold></highlight> to collect reflectance data points and preferably, to record these data points at every positional encoder transition along the way, with this positional information being obtained through use of the optical encoder strip <highlight><bold>45</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 1</cross-reference>). Thus, the data generated in the scanning and collecting step <highlight><bold>406</bold></highlight> consists of both positional data and the corresponding reflectance data, with the reflectance and position being in counts. For instance, for the reflectance, twelve bits, or 212 which equals 4096 counts, are equally distributed over a 0-5 Volt range of the A/D converter. Thus, each count is equal to {fraction (5/4096)}, or 1.2 mV (millivolts). The light (reflectance from the media is captured by the LVC (light-to-voltage converter) and provides as an output an analog voltage signal which is translated by the analog-to-digital converter into a digital signal expressed in counts. The position on the media (e.g., paper) is also expressed in counts derived from the 600 quadrature transitions per inch of the encoder in the illustrated embodiment, although it is apparent to those skilled in the art that other transitions per inch, or per some other linear measurement, such as centimeters, may also be used. Thus, a position count of 1200 in the illustrated embodiment translates to a location on the paper or other media of {fraction (1200/600)} position counts, or 2.0 inches (5.08 centimeters) from the start of the scan. Preferably, the media is scanned a single time and then the data is averaged in step <highlight><bold>408</bold></highlight>. During the scanning and collecting step <highlight><bold>406</bold></highlight>, the field of view of the optical sensor <highlight><bold>100</bold></highlight> is placed over the media with the media resting at the top of form position. In this top of form position, for a transparency supplied by the Hewlett-Packard Company, which has a tape header across the top of the transparency, this implies that the tape header is being scanned by the sensor <highlight><bold>100</bold></highlight>. </paragraph>
<paragraph id="P-0097" lvl="0"><number>&lsqb;0097&rsqb;</number> Since the A-D conversions used during the scanning and collecting step <highlight><bold>406</bold></highlight> is triggered at each state transition of the encoder strip <highlight><bold>45</bold></highlight>, the sampling rate has spatial characteristics, and occurs typically at 600 samples per inch in the illustrated printer <highlight><bold>20</bold></highlight>. During the scan, the carriage speed is preferably between 2 and 30 inches per second. The data collected during step <highlight><bold>406</bold></highlight> is then stored in the printer controller <highlight><bold>35</bold></highlight>, and is typically in the range of a 0-5 volt input, with 9-bit resolution. At the conclusion of the scanning, the data acquisition hardware signals the controller <highlight><bold>35</bold></highlight> that the data collection is complete and that the step of averaging the data points <highlight><bold>408</bold></highlight> may then be performed. </paragraph>
<paragraph id="P-0098" lvl="0"><number>&lsqb;0098&rsqb;</number> The media type determination system <highlight><bold>400</bold></highlight> then performs a spatial frequency media identification routine <highlight><bold>410</bold></highlight> to distinguish whether the media sheet that has been scanned is either a transparency without a header tape, photo quality media, a transparency with a header tape, or plain paper. The first step in the spatial frequency media identification routine <highlight><bold>410</bold></highlight> is step <highlight><bold>412</bold></highlight>, where a Fourier transform is performed on all of the data to determine both the magnitude and phase of each of the discrete spatial frequency components of the data recorded in step <highlight><bold>406</bold></highlight>. In the illustrated embodiment for printer <highlight><bold>20</bold></highlight>, the data record consists of 4000 samples, so the Fourier components range from 0-4000. The magnitude of the first sorted component is the direct current (DC) level of the data. </paragraph>
<paragraph id="P-0099" lvl="0"><number>&lsqb;0099&rsqb;</number> If a transparency without a tape header is being examined, this DC level of the data will be low. <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a graph <highlight><bold>414</bold></highlight> of the DC level of reflectance for a group of plain papers which were studied, with the abbreviation key being shown in Table 1 below. Also shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference> are the DC levels of reflectance for transparencies with a header tape, labeled &ldquo;TAPE,&rdquo; as shown by bar <highlight><bold>416</bold></highlight> and for that without the tape header, labeled as &ldquo;TRAN&rdquo;, as shown by bar <highlight><bold>418</bold></highlight> in graph <highlight><bold>414</bold></highlight>.  
<table-cwu id="TABLE-US-00001">
<number>1</number>
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217PT" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center">TABLE 1</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry></entry>
</row>
<row><entry namest="1" nameend="1" align="center" rowsep="1"></entry>
</row>
<row>
<entry>Graph Abbreviations</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="OFFSET" colwidth="14PT" align="left"/>
<colspec colname="1" colwidth="56PT" align="left"/>
<colspec colname="2" colwidth="147PT" align="left"/>
<tbody valign="top">
<row>
<entry></entry>
<entry>Label</entry>
<entry>Media Type Archive</entry>
</row>
<row>
<entry></entry>
<entry namest="OFFSET" nameend="2" align="center" rowsep="1"></entry>
</row>
<row>
<entry></entry>
<entry>GOSSIMER</entry>
<entry>Gossimer (HP Photo Glossy)</entry>
</row>
<row>
<entry></entry>
<entry>GBND</entry>
<entry>Gilbert Bond</entry>
</row>
<row>
<entry></entry>
<entry>GPMS</entry>
<entry>Georgia-Pacific Multi-System</entry>
</row>
<row>
<entry></entry>
<entry>ARRM</entry>
<entry>Aussedat-Rey-Reymat</entry>
</row>
<row>
<entry></entry>
<entry>CDCY</entry>
<entry>Champion DataCopy</entry>
</row>
<row>
<entry></entry>
<entry>EGKL</entry>
<entry>Enso-Gutzeit Berga Laser</entry>
</row>
<row>
<entry></entry>
<entry>HFDP</entry>
<entry>Hammermill Fore DP</entry>
</row>
<row>
<entry></entry>
<entry>HNYR</entry>
<entry>Honshu New Yamayuri</entry>
</row>
<row>
<entry></entry>
<entry>HOKM</entry>
<entry>Hokuestsu kin-Mari</entry>
</row>
<row>
<entry></entry>
<entry>KCLX</entry>
<entry>KymCopy Lux</entry>
</row>
<row>
<entry></entry>
<entry>MODO</entry>
<entry>MoDo DataCopy</entry>
</row>
<row>
<entry></entry>
<entry>NCLD</entry>
<entry>Neenah Classic Laid</entry>
</row>
<row>
<entry></entry>
<entry>OJIS</entry>
<entry>Oji Sunace PPC</entry>
</row>
<row>
<entry></entry>
<entry>PMCY</entry>
<entry>Stora Papyrus MultiCopy</entry>
</row>
<row>
<entry></entry>
<entry>SFIP</entry>
<entry>SFI-PPC</entry>
</row>
<row>
<entry></entry>
<entry>STZW</entry>
<entry>Steinbeis/Zweckform</entry>
</row>
<row>
<entry></entry>
<entry>TAPE</entry>
<entry>HP transparency (Scotty) WITH paper tape</entry>
</row>
<row>
<entry></entry>
<entry>TRAN</entry>
<entry>HP transparency (Scotty) NO Tape</entry>
</row>
<row>
<entry></entry>
<entry>UCGW</entry>
<entry>Union Camp Great White</entry>
</row>
<row>
<entry></entry>
<entry>WFCH</entry>
<entry>Weyerhauser First Choice</entry>
</row>
<row>
<entry></entry>
<entry>WTCQ</entry>
<entry>Wiggens Teape Conqueror</entry>
</row>
<row>
<entry></entry>
<entry namest="OFFSET" nameend="2" align="center" rowsep="1"></entry>
</row>
</tbody>
</tgroup>
</table>
</table-cwu>
</paragraph>
<paragraph id="P-0100" lvl="0"><number>&lsqb;0100&rsqb;</number> Also included in the DC level reflectance graph of <cross-reference target="DRAWINGS">FIG. 9</cross-reference> are two types of Gossimer photo paper, labeled GOSSIMER&num;<highlight><bold>1</bold></highlight> and GOSSIMER&num;<highlight><bold>2</bold></highlight>, as shown by bars <highlight><bold>420</bold></highlight> and <highlight><bold>422</bold></highlight>, respectively in graph <highlight><bold>414</bold></highlight>. The remainder of the bars in graph <highlight><bold>414</bold></highlight> indicate varying types of plain paper, as shown in Table 1 below, of which bar <highlight><bold>424</bold></highlight> is used for MoDo DataCopy plain paper media, labeled as &ldquo;MODO&rdquo;. From a review of graph <highlight><bold>414</bold></highlight>, it is seen that the low level of light passing through the transparency without a tape header at bar <highlight><bold>414</bold></highlight> is readily distinguishable from the remainder of the reflectance values for the other types of media, which is because rather than the light being reflected back to the photo sensor <highlight><bold>130</bold></highlight>, it passes through the transparency. Thus, in step <highlight><bold>426</bold></highlight>, a determination is made based on the DC level of the reflectance data which, if it is under a reflectance of 200 counts then a YES signal <highlight><bold>428</bold></highlight> is generated to provide a transparency without tape signal <highlight><bold>430</bold></highlight> to the controller <highlight><bold>35</bold></highlight>, which then adjusts the printing routine accordingly for a transparency. If instead, the DC level of the data collected is greater than 200 counts, then a NO signal <highlight><bold>432</bold></highlight> is generated and further investigation takes place to determine which of the other types of media may be present in the printzone. Note that step <highlight><bold>426</bold></highlight> of comparing the reflectance data may also be performed before the Fourier transform step <highlight><bold>412</bold></highlight>, since the Fourier spectrum values are not needed to determine whether or not the media is a regular transparency without tape. </paragraph>
<paragraph id="P-0101" lvl="0"><number>&lsqb;0101&rsqb;</number> So if the media is not a transparency without a tape header, a determination is then made whether the media is a photo quality media. To do this, a Fourier spectrum component graph <highlight><bold>434</bold></highlight> is used, as shown in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>, along with a Fourier spectrum component graph <highlight><bold>436</bold></highlight> for plain paper, here the MoDo Datacopy brand of plain paper shown in <cross-reference target="DRAWINGS">FIG. 11</cross-reference>. Before delving into an explanation of this analysis, an explanation of the units for the spatial frequency label along the horizontal axis of these graphs (as well as for the graph in <cross-reference target="DRAWINGS">FIG. 13</cross-reference>) is in order. The spatial frequency components are the number of cycles that occur within the scan data collected in the scan media step <highlight><bold>406</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 8</cross-reference>. For the examples illustrated herein, the length of the data sample was selected to be 4000 samples. As discussed above, in the illustrated embodiment, the data is sampled at 600 samples per inch of movement of the sensor <highlight><bold>100</bold></highlight>. A spatial frequency that completes 30 cycles within the length of the scan data would therefore have an equivalent spatial frequency found according to the equation:  
<math-cwu id="MATH-US-00001">
<number>1</number>
<math>
<mrow>
  <mfrac>
    <mrow>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>30</mn>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mi>cycles</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
      <mo>&times;</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>600</mn>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mrow>
            <mi>samples</mi>
            <mo>/</mo>
            <mi>inch</mi>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mn>4000</mn>
        <mo>&it;</mo>
        <mstyle>
          <mtext>&emsp;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mi>samples</mi>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mfrac>
  <mo>=</mo>
  <mrow>
    <mn>4.5</mn>
    <mo>&it;</mo>
    <mstyle>
      <mtext>&emsp;</mtext>
    </mstyle>
    <mo>&it;</mo>
    <mi>c</mi>
    <mo>&it;</mo>
    <mstyle>
      <mtext>&emsp;</mtext>
    </mstyle>
    <mo>&it;</mo>
    <mrow>
      <mi>ycles</mi>
      <mo>/</mo>
      <mi>inch</mi>
    </mrow>
  </mrow>
</mrow>
</math>
<mathematica-file id="MATHEMATICA-00001" file="US20030001939A1-20030102-M00001.NB"/>
<image id="EMI-M00001" wi="216.027" he="24.01245" file="US20030001939A1-20030102-M00001.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0102" lvl="0"><number>&lsqb;0102&rsqb;</number> In the illustrated embodiment, a data scan of 4000 samples is equivalent to a traverse of 6.6 inches across the media which is the scan distance used herein, from the equation:  
<math-cwu id="MATH-US-00002">
<number>2</number>
<math>
<mrow>
  <mfrac>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mn>4000</mn>
        <mo>&it;</mo>
        <mstyle>
          <mtext>&emsp;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mi>samples</mi>
      </mrow>
      <mo>)</mo>
    </mrow>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mn>600</mn>
        <mo>&it;</mo>
        <mstyle>
          <mtext>&emsp;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <mi>samples</mi>
          <mo>/</mo>
          <mi>inch</mi>
        </mrow>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mfrac>
  <mo>=</mo>
  <mrow>
    <mn>6.6</mn>
    <mo>&it;</mo>
    <mstyle>
      <mtext>&emsp;</mtext>
    </mstyle>
    <mo>&it;</mo>
    <mi>inches</mi>
  </mrow>
</mrow>
</math>
<mathematica-file id="MATHEMATICA-00002" file="US20030001939A1-20030102-M00002.NB"/>
<image id="EMI-M00002" wi="216.027" he="24.01245" file="US20030001939A1-20030102-M00002.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0103" lvl="0"><number>&lsqb;0103&rsqb;</number> From the comparison of graphs <highlight><bold>434</bold></highlight> and <highlight><bold>436</bold></highlight>, it is seen that the magnitudes of the spectrum components above the count n equals eight (n&equals;8) are much greater in the plain paper spectrum of graph <highlight><bold>436</bold></highlight> then for the photo media in graph <highlight><bold>434</bold></highlight>. Thus, in step <highlight><bold>438</bold></highlight> the spectral components from <highlight><bold>8</bold></highlight>-<highlight><bold>30</bold></highlight> are summed and in a comparison step <highlight><bold>448</bold></highlight>, it is determined that if the sum of the components <highlight><bold>8</bold></highlight>-<highlight><bold>30</bold></highlight> is less than a value, here a value of 25, a YES signal <highlight><bold>450</bold></highlight> is generated. In response to the YES signal, step <highlight><bold>452</bold></highlight> generates a signal which is provided to the controller <highlight><bold>35</bold></highlight> so the printing routines may be adjusted to accommodate for the photo media. Note that in <cross-reference target="DRAWINGS">FIGS. 10 and 11</cross-reference>, several of the components having a count of less than eight (n&lt;8) have frequency magnitudes which are greater than the maximum value shown on graphs <highlight><bold>434</bold></highlight> and <highlight><bold>436</bold></highlight>, but they are not of interest in this particular study, so their exact values are immaterial to our discussion here. </paragraph>
<paragraph id="P-0104" lvl="0"><number>&lsqb;0104&rsqb;</number> Fourier spectrum component graphs such as <highlight><bold>434</bold></highlight> and <highlight><bold>436</bold></highlight> may be constructed for all of the different types of media under study. <cross-reference target="DRAWINGS">FIG. 12</cross-reference> shows a graph <highlight><bold>440</bold></highlight> of the sum of the magnitude of components <highlight><bold>8</bold></highlight>-<highlight><bold>30</bold></highlight> for each of the different types of plain paper and photo media. Here we see the GOSSIMER&num;<highlight><bold>1</bold></highlight> and GOSSIMER&num;<highlight><bold>2</bold></highlight> photo medias having their summed components shown by bars <highlight><bold>442</bold></highlight> and <highlight><bold>444</bold></highlight>. It is apparent that the magnitude of the photo media summed components <highlight><bold>442</bold></highlight> and <highlight><bold>444</bold></highlight> is much less than that for any of the remaining plain paper medias, including the bar <highlight><bold>446</bold></highlight> for the MoDo Datacopy media. Thus, returning to the flowchart of <cross-reference target="DRAWINGS">FIG. 8</cross-reference>, in response to the sum components step <highlight><bold>438</bold></highlight> in a comparison step <highlight><bold>448</bold></highlight> the magnitude of the sum of components <highlight><bold>8</bold></highlight>-<highlight><bold>30</bold></highlight> is compared, and if less than the value of 25 a YES signal <highlight><bold>450</bold></highlight> is generated. </paragraph>
<paragraph id="P-0105" lvl="0"><number>&lsqb;0105&rsqb;</number> However, if the media in printzone <highlight><bold>25</bold></highlight> is not photo media, the decision step <highlight><bold>448</bold></highlight> generates a NO signal <highlight><bold>454</bold></highlight> having determined that the media is not a transparency without a header tape and not photo media it then remains to be determined whether the media is either a transparency with a header tape or plain paper. <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is a graph <highlight><bold>455</bold></highlight> of the Fourier spectrum components for a transparency with a tape header, with a tape header <highlight><bold>456</bold></highlight> being shown below the graph and having starting and ending points <highlight><bold>464</bold></highlight> and <highlight><bold>466</bold></highlight> also being indicated. Over the duration of the scan, there are three HP logos <highlight><bold>458</bold></highlight> encountered and roughly seventeen directional arrows <highlight><bold>460</bold></highlight>, indicating which way a user should insert the media into the printer. These logos and arrows create a media signature in the spectrum as can be seen from an analysis of graph <highlight><bold>455</bold></highlight>. As can be seen from a review of the graph <highlight><bold>455</bold></highlight>, the third component <highlight><bold>468</bold></highlight> and seventeenth component <highlight><bold>470</bold></highlight> are much larger than those in the plain paper spectrum of the respective third and seventeenth components <highlight><bold>472</bold></highlight> and <highlight><bold>474</bold></highlight> in graph <highlight><bold>436</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 11</cross-reference> (note that the vertical scale on graph <highlight><bold>455</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is fragmented, and the magnitude of the third component <highlight><bold>468</bold></highlight> is at a value above 800.). Due to positioning errors at the beginning of the scan, which are compensated in step <highlight><bold>408</bold></highlight> where the data points are averaged, the sixteenth and eighteenth components <highlight><bold>476</bold></highlight> and <highlight><bold>478</bold></highlight>, respectively, of graph <highlight><bold>455</bold></highlight> are much larger than the sixteenth and eighteenth components <highlight><bold>480</bold></highlight> and <highlight><bold>482</bold></highlight>, for the plain paper in graph <highlight><bold>436</bold></highlight>. Consequently, the sixteenth and eighteenth components are also contained within this unique frequency signature. </paragraph>
<paragraph id="P-0106" lvl="0"><number>&lsqb;0106&rsqb;</number> Returning to flowchart <highlight><bold>400</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 8</cross-reference>, in step <highlight><bold>484</bold></highlight> the magnitude of the components of the third, sixteenth, seventeenth and eighteenth spectrums are summed, with these resulting sums being shown in graph <highlight><bold>485</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 14</cross-reference>. The sum for the tape is shown as bar <highlight><bold>486</bold></highlight>, which is clearly of a much greater magnitude than the various plain papers, such as bar <highlight><bold>488</bold></highlight> for the MoDo Datacopy plain paper. Thus, a decision may then be made in step <highlight><bold>490</bold></highlight>, to determine whether the sum of the frequency sub-components <highlight><bold>3</bold></highlight>, <highlight><bold>16</bold></highlight>, <highlight><bold>17</bold></highlight> and <highlight><bold>18</bold></highlight> performed by step <highlight><bold>484</bold></highlight> is greater than 1300 if so, a YES signal <highlight><bold>492</bold></highlight> is delivered to indicate that the media is a transparency with a tape header, and this information is then transferred by step <highlight><bold>494</bold></highlight> to the printer controller <highlight><bold>35</bold></highlight> for subsequent processing and adjustment of the printing routines. However, if the decision by step <highlight><bold>490</bold></highlight> is that the sum is less than 1300, then a NO signal <highlight><bold>496</bold></highlight> is generated which is then sent to a decision block <highlight><bold>498</bold></highlight> indicating plain paper is in the printer, and the default plain paper print mode may be used by the controller <highlight><bold>35</bold></highlight>. </paragraph>
<paragraph id="P-0107" lvl="7"><number>&lsqb;0107&rsqb;</number> Advanced Media Determination System </paragraph>
<paragraph id="P-0108" lvl="0"><number>&lsqb;0108&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 15</cross-reference> illustrates one form of a preferred advanced media type determination system <highlight><bold>500</bold></highlight> as a flowchart, constructed in accordance with the present invention. In describing this advanced media determination system <highlight><bold>500</bold></highlight>, first an overview of the system operation will begin with respect to <cross-reference target="DRAWINGS">FIG. 15</cross-reference>. Next will be a description of several more general portions of the determination system <highlight><bold>500</bold></highlight> with respect to FIGS. <highlight><bold>16</bold></highlight>-<highlight><bold>19</bold></highlight>, followed by a detailed description of the heart of the determination method with respect to FIGS. <highlight><bold>20</bold></highlight>-<highlight><bold>23</bold></highlight>. Following a description of the method, FIGS. <highlight><bold>24</bold></highlight>-<highlight><bold>26</bold></highlight> will be used to explain how the media sensor of <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is used in the determination routines of FIGS. <highlight><bold>20</bold></highlight>-<highlight><bold>23</bold></highlight>, followed by graphical examples of several different types of media studied, with respect to FIGS. <highlight><bold>27</bold></highlight>-<highlight><bold>39</bold></highlight>. In <cross-reference target="DRAWINGS">FIGS. 40 through 43</cross-reference>, the spatial frequencies of light collected by the media type determination sensor are studied to show how system <highlight><bold>500</bold></highlight> determines which type of media is entering the printzone <highlight><bold>25</bold></highlight> of printer <highlight><bold>20</bold></highlight>. Finally, FIGS. <highlight><bold>44</bold></highlight>-<highlight><bold>48</bold></highlight> will be used to describe a early transparent media determination system which speeds printer throughput (pages per minute) when printing on transparencies and avoids using heavy ink transparency printing routines on non-transparency media. </paragraph>
<paragraph id="P-0109" lvl="7"><number>&lsqb;0109&rsqb;</number> 1. System Overview </paragraph>
<paragraph id="P-0110" lvl="0"><number>&lsqb;0110&rsqb;</number> Returning to <cross-reference target="DRAWINGS">FIG. 15</cross-reference>, the advanced media determination system <highlight><bold>500</bold></highlight> is shown in overview as having a first collect raw data step <highlight><bold>502</bold></highlight>. Following collection of the raw data, a massage data routine <highlight><bold>504</bold></highlight> is performed to place the data collected in step <highlight><bold>502</bold></highlight> into a suitable format for further analysis. Following the massaging data step, comes a major category determination step <highlight><bold>506</bold></highlight> and a specific type determination step <highlight><bold>508</bold></highlight>. The major and specific determination steps <highlight><bold>506</bold></highlight> and <highlight><bold>508</bold></highlight> are interlaced, as will be seen with respect to FIGS. <highlight><bold>20</bold></highlight>-<highlight><bold>23</bold></highlight>. For instance, once a major category determination is made, such as for premium paper media, then a further determination may be made as to which specific type of premium media is used. However, to arrive at the major determination step for premium media, the routine must first have discarded the possibilities that the media might be a transparency, a glossy photo, a matte photo, or a plain paper media. After the method has made a specific type determination in step <highlight><bold>508</bold></highlight>, a verification step <highlight><bold>510</bold></highlight> is performed to assure that the correct specific determination has been made. Following the verification step <highlight><bold>510</bold></highlight>, the determination system <highlight><bold>500</bold></highlight> then has a select print mode step <highlight><bold>512</bold></highlight>, which correlates the print mode to the specific type of media which is entering the printzone <highlight><bold>25</bold></highlight>. In response to the selection of print mode step <highlight><bold>512</bold></highlight>, the system then concludes with a print step <highlight><bold>514</bold></highlight>, where printing instructions are sent to the printheads <highlight><bold>70</bold></highlight>-<highlight><bold>76</bold></highlight> to print an image in accordance with the print modes selected instep <highlight><bold>512</bold></highlight>. </paragraph>
<paragraph id="P-0111" lvl="7"><number>&lsqb;0111&rsqb;</number> 2. Collect Raw Data Routine </paragraph>
<paragraph id="P-0112" lvl="0"><number>&lsqb;0112&rsqb;</number> Now that the construction of the media sensor <highlight><bold>100</bold></highlight> is understood, its use will be described with respect to the collection of raw data routine <highlight><bold>502</bold></highlight>, which is illustrated in detail in <cross-reference target="DRAWINGS">FIG. 16</cross-reference>. In a first step <highlight><bold>530</bold></highlight> of routine <highlight><bold>502</bold></highlight>, the blue-violet LED <highlight><bold>105</bold></highlight> is turned on, and the brightness of the LED <highlight><bold>105</bold></highlight> is adjusted. Following step <highlight><bold>530</bold></highlight>, in a scanning step <highlight><bold>532</bold></highlight>, the printhead carriage <highlight><bold>40</bold></highlight> transports the media sensor <highlight><bold>100</bold></highlight> across the printzone <highlight><bold>25</bold></highlight>, parallel to the scanning axis <highlight><bold>38</bold></highlight>. During the scanning step <highlight><bold>532</bold></highlight>, the media surface is spatially sampled and both the diffuse reflected light components <highlight><bold>200</bold></highlight>, and the specular reflected light components <highlight><bold>200</bold></highlight>&prime; are collected at every state transition as the carriage optical encoder reads markings along the encoder strip <highlight><bold>45</bold></highlight>. These diffuse and specular reflectance values are stored as analog-to-digital (AID) counts to generate a set of values for the reflectances at each encoder position along the media. In some implementations, it may be desirable to scan the media several time to produce an averaged data set, although typically only one scan of the media is required to produce good results. </paragraph>
<paragraph id="P-0113" lvl="0"><number>&lsqb;0113&rsqb;</number> During this scanning step <highlight><bold>532</bold></highlight>, the sheet of media <highlight><bold>150</bold></highlight> is placed under the media sensor <highlight><bold>100</bold></highlight> at the &ldquo;top of form&rdquo; position. For an HP transparency media with a tape header <highlight><bold>456</bold></highlight>, as shown in <cross-reference target="DRAWINGS">FIG. 13</cross-reference>, the tape <highlight><bold>456</bold></highlight> is within the field of view, even though at this point the tape is located along the undersurface of the media. Indeed, even though the tape header <highlight><bold>456</bold></highlight> is facing away from the sensor <highlight><bold>100</bold></highlight>, as well as away from sensor <highlight><bold>100</bold></highlight> in the basic media type determination method <highlight><bold>400</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 8</cross-reference>), the markings <highlight><bold>458</bold></highlight>, <highlight><bold>460</bold></highlight> on the tape header <highlight><bold>456</bold></highlight> are viewable by sensor <highlight><bold>100</bold></highlight>, and may be used to identify this media as described above in method <highlight><bold>400</bold></highlight>. </paragraph>
<paragraph id="P-0114" lvl="0"><number>&lsqb;0114&rsqb;</number> In a final checking step <highlight><bold>534</bold></highlight> of the raw data collection routine <highlight><bold>502</bold></highlight>, a high level look or check is performed to determine whether all of the data collected during step <highlight><bold>532</bold></highlight> is actually data which lies on the media surface. For instance, if a narrower sheet of media is used (e.g. A-4 sized media or custom-sized greeting card media) than the standard letter-size media for which printer <highlight><bold>20</bold></highlight> is designed, some of the data points collected during the scanning step <highlight><bold>532</bold></highlight> will be of light reflected from the media support member, also known as a platen or &ldquo;pivot,&rdquo; which forms a portion of the media handling system <highlight><bold>24</bold></highlight>. Thus, any data corresponding to the pivot is separated in step <highlight><bold>534</bold></highlight> from the data corresponding to the sheet of media, which is then sent on as a collected raw data signal <highlight><bold>536</bold></highlight> to the massage data routine <highlight><bold>504</bold></highlight>. </paragraph>
<paragraph id="P-0115" lvl="0"><number>&lsqb;0115&rsqb;</number> During the analog to digital conversion portion of the scanning step <highlight><bold>532</bold></highlight>, the A-to-D conversion is triggered at each state transition of the carriage positional encoder which monitors the optical encoder strip <highlight><bold>45</bold></highlight>. In this manner, the data is collected with a spatial reference, that is, spatial as in &ldquo;space,&rdquo; so the data corresponds to a particular location in space as the carriage <highlight><bold>40</bold></highlight> moves sensor <highlight><bold>100</bold></highlight> across the printzone <highlight><bold>25</bold></highlight>. For the illustrated printer <highlight><bold>20</bold></highlight> the sampling rate typically occurs at the rate of 600 samples per inch (1524 samples per centimeter). During this scanning step <highlight><bold>532</bold></highlight>, preferably the speed of the carriage <highlight><bold>40</bold></highlight> is between two and thirty inches per second (5.08 to 76.2 centimeters per second). One preferred analog-to-digital conversion is over a 0-5 volt range, with a 9-bit resolution. </paragraph>
<paragraph id="P-0116" lvl="7"><number>&lsqb;0116&rsqb;</number> 3. Massage Data Routine </paragraph>
<paragraph id="P-0117" lvl="0"><number>&lsqb;0117&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 17</cross-reference> illustrates the details of the massage data routine <highlight><bold>504</bold></highlight>, which generates a set of four signals as outputs which are sent to the major category determination routine <highlight><bold>506</bold></highlight>. In two steps, averages of the incoming data are found. Specifically, in a &ldquo;find specular average&rdquo; step <highlight><bold>540</bold></highlight>, and a &ldquo;find diffuse average&rdquo; step <highlight><bold>544</bold></highlight>, the averages for all of the incoming specular raw data and diffuse raw data, respectively, are found. The specular average step <highlight><bold>540</bold></highlight> produces a specular average signal <highlight><bold>542</bold></highlight>, also indicated by the letter &ldquo;A&rdquo; in <cross-reference target="DRAWINGS">FIG. 17</cross-reference>, which is provided as an input to the major category determination routine <highlight><bold>506</bold></highlight>. The diffuse average step <highlight><bold>544</bold></highlight> produces a specular average signal <highlight><bold>545</bold></highlight>, also indicated by the letter &ldquo;B&rdquo; in <cross-reference target="DRAWINGS">FIG. 17</cross-reference>, which is provided as an input to the major category determination routine <highlight><bold>506</bold></highlight>. </paragraph>
<paragraph id="P-0118" lvl="0"><number>&lsqb;0118&rsqb;</number> The other major operations performed by the massage data routine <highlight><bold>504</bold></highlight> are preformed in a &ldquo;generate specular reflectance graph&rdquo; step <highlight><bold>546</bold></highlight>, and in a &ldquo;generate diffuse reflectance graph&rdquo; step <highlight><bold>548</bold></highlight>. In step <highlight><bold>548</bold></highlight>, the collected raw data is arranged with the diffuse and specular reflectance values referenced to the same spatial position with respect to the pivot or platen. </paragraph>
<paragraph id="P-0119" lvl="0"><number>&lsqb;0119&rsqb;</number> The steps of generating the specular and diffuse reflectance graphs <highlight><bold>546</bold></highlight>, <highlight><bold>548</bold></highlight> each produce an output signal, <highlight><bold>550</bold></highlight> and <highlight><bold>551</bold></highlight>, which are received by two conversion steps <highlight><bold>552</bold></highlight> and <highlight><bold>554</bold></highlight>, respectively. In step <highlight><bold>552</bold></highlight>, the aligned data <highlight><bold>550</bold></highlight> is passed through a Hanning or Welch&apos;s fourth power windowing function. Following this manipulation, a discrete fast Fourier transform may be performed on the windowed data to produce the frequency components for the sheet of media entering the printzone <highlight><bold>25</bold></highlight>. In each of steps <highlight><bold>546</bold></highlight> and <highlight><bold>548</bold></highlight>, the graphs are produced in terms of magnitude versus (&ldquo;vs.&rdquo;) position, such as the graphs illustrated in FIGS. <highlight><bold>27</bold></highlight>-<highlight><bold>33</bold></highlight>, discussed further below. The specular spatial frequency, shown as a bar chart of frequency versus the magnitude<highlight><superscript>2 </superscript></highlight>(magnitude squared), which is an output signal <highlight><bold>556</bold></highlight>, also labeled as letter &ldquo;S,&rdquo; which is supplied to the major category determination routine <highlight><bold>506</bold></highlight>. In step <highlight><bold>554</bold></highlight>, the incoming data <highlight><bold>551</bold></highlight> is converted to a diffuse spatial frequency, shown as a bar chart of frequency versus the magnitudes, to produce an output signal <highlight><bold>558</bold></highlight>, also labeled as letter &ldquo;D,&rdquo; which is supplied to the major category determination routine <highlight><bold>506</bold></highlight>. Examples of the graphical data provided by the conversion steps <highlight><bold>552</bold></highlight> and <highlight><bold>554</bold></highlight> are shown in FIGS. <highlight><bold>34</bold></highlight>-<highlight><bold>39</bold></highlight>, discussed further below. </paragraph>
<paragraph id="P-0120" lvl="0"><number>&lsqb;0120&rsqb;</number> Thus, during the massage data routine <highlight><bold>504</bold></highlight>, a Fourier transform is performed on the collected raw data to determine the magnitude and phase of each of the discrete spatial frequency components of the recorded data for each channel, that is, channels for the specular and diffuse photodiodes <highlight><bold>130</bold></highlight>&prime;, <highlight><bold>130</bold></highlight>. Typically this data consists of a record of 1000-4000 samples. The Fourier components of interest are limited by the response of the photodiodes <highlight><bold>130</bold></highlight>, <highlight><bold>130</bold></highlight>&prime; to typically less than 100 cycles per inch. The magnitude of the first order component is the DC (direct current) level of the data. This DC level is then used to normalize the data to a predetermined value that was used in characterizing signatures of known media which has been studied. A known media signature is a pre-stored Fourier spectrum, typically in magnitude values, for both the specular and diffuse channels for each of the media types which are supported by a given inkjet printing mechanism, such as printer <highlight><bold>20</bold></highlight>. </paragraph>
<paragraph id="P-0121" lvl="7"><number>&lsqb;0121&rsqb;</number> 4. Verification and Selection of Print Mode Routines </paragraph>
<paragraph id="P-0122" lvl="0"><number>&lsqb;0122&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 18</cross-reference> illustrates the details of the verification and select print mode steps <highlight><bold>510</bold></highlight>, <highlight><bold>512</bold></highlight> of the media determination system <highlight><bold>500</bold></highlight>. Here we see the verification step <highlight><bold>510</bold></highlight> receiving incoming data from the specific type determination step <highlight><bold>508</bold></highlight>. This incoming data is first received by a &ldquo;make assumption&rdquo; step <highlight><bold>560</bold></highlight>, with this assumption regarding the specific media type. Step <highlight><bold>560</bold></highlight> yields an assumed specific type signal <highlight><bold>562</bold></highlight>, which is received by a &ldquo;determine the quality fit&rdquo; step <highlight><bold>564</bold></highlight>. The determine the quality fit step <highlight><bold>564</bold></highlight> is used to test the correctness of the assumption made in step <highlight><bold>560</bold></highlight>. In a look-up step <highlight><bold>565</bold></highlight>, a table of the various type characteristics for each specific type of media is consulted, and data corresponding to the assumed media type of signal <highlight><bold>562</bold></highlight> is provided to the quality fit step <highlight><bold>564</bold></highlight> as a reference data signal <highlight><bold>566</bold></highlight>. The quality fit step <highlight><bold>564</bold></highlight> processes the reference values <highlight><bold>566</bold></highlight> and the assumed media type signal <highlight><bold>562</bold></highlight> and provides an output signal <highlight><bold>568</bold></highlight> to the select print mode routine <highlight><bold>512</bold></highlight>. </paragraph>
<paragraph id="P-0123" lvl="0"><number>&lsqb;0123&rsqb;</number> The output signal <highlight><bold>568</bold></highlight> from the verification step <highlight><bold>510</bold></highlight> is received by a comparison step <highlight><bold>570</bold></highlight>, where it is determined whether the assumption data <highlight><bold>562</bold></highlight> matches the reference data <highlight><bold>566</bold></highlight>. If this data does indeed match, a YES signal <highlight><bold>571</bold></highlight> is issued by the comparison step <highlight><bold>570</bold></highlight> to a &ldquo;select print mode&rdquo; step <highlight><bold>572</bold></highlight>. Step <highlight><bold>572</bold></highlight> then selects the correct print mode for the specific type of media and issues a specific print mode signal <highlight><bold>574</bold></highlight> to the print step <highlight><bold>514</bold></highlight>. However, if the comparison step <highlight><bold>570</bold></highlight> determines that the media type assumed step <highlight><bold>560</bold></highlight> does not have characteristics which match the reference data <highlight><bold>566</bold></highlight>, then a NO signal <highlight><bold>575</bold></highlight> is issued. The NO signal <highlight><bold>575</bold></highlight> is then sent to a &ldquo;select default print mode&rdquo; step <highlight><bold>576</bold></highlight>. The default print mode selection step <highlight><bold>576</bold></highlight> then issues a default print mode signal <highlight><bold>578</bold></highlight>, corresponding to the major type of media initially determined, and then the incoming sheet is printed in step <highlight><bold>514</bold></highlight> according to this default determination. </paragraph>
<paragraph id="P-0124" lvl="7"><number>&lsqb;0124&rsqb;</number> 5. Types of Media </paragraph>
<paragraph id="P-0125" lvl="0"><number>&lsqb;0125&rsqb;</number> At this point, it may be helpful to describe the various major types of media which may be determined using system <highlight><bold>500</bold></highlight>, along with giving specific examples of media which falls into the major type categories. It must be noted that only a few of the more popular medias have been studied, and their identification incorporated into the specifics of the illustrated determination system <highlight><bold>500</bold></highlight>. Indeed, this is a new frontier for printing, and research is continuing to determine new ways to optically distinguish one type of media from another. The progress of this development routine is evidenced by the current patent application, which has progressed from a basic media determination routine <highlight><bold>400</bold></highlight> described in the parent application, to this more advanced routine <highlight><bold>500</bold></highlight> which we are now describing. Indeed, other medias remain yet to be studied, and further continuing patent applications are expected to cover these determination methods which are so far undeveloped. </paragraph>
<paragraph id="P-0126" lvl="0"><number>&lsqb;0126&rsqb;</number> Table 2 shows the print modes assigned by media type:  
<table-cwu id="TABLE-US-00002">
<number>2</number>
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217PT" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center">TABLE 2</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry></entry>
</row>
<row><entry namest="1" nameend="1" align="center" rowsep="1"></entry>
</row>
<row>
<entry>Print Modes By Media Type</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="1" colwidth="42PT" align="left"/>
<colspec colname="2" colwidth="35PT" align="left"/>
<colspec colname="3" colwidth="56PT" align="left"/>
<colspec colname="4" colwidth="49PT" align="left"/>
<colspec colname="5" colwidth="35PT" align="left"/>
<tbody valign="top">
<row>
<entry></entry>
<entry>PM &equals; 0</entry>
<entry>PM &equals; 2</entry>
<entry>PM &equals; 3</entry>
<entry>PM &equals; 4</entry>
</row>
<row>
<entry>Print Mode</entry>
<entry>Plain</entry>
<entry>Premium</entry>
<entry>Photo</entry>
<entry>Transp.</entry>
</row>
<row>
<entry>Default</entry>
<entry>Default</entry>
<entry>Default</entry>
<entry>Default</entry>
<entry>Default</entry>
</row>
<row>
<entry></entry>
<entry>(0, 0)</entry>
<entry>(2, 0)</entry>
<entry>(3, 0)</entry>
<entry>(4, 0)</entry>
</row>
<row><entry namest="1" nameend="5" align="center" rowsep="1"></entry>
</row>
<row>
<entry>Specific A</entry>
<entry>Plain A</entry>
<entry>Matte Photo</entry>
<entry>Gossimer</entry>
<entry>HP (Tape)</entry>
</row>
<row>
<entry></entry>
<entry>(0, 1)</entry>
<entry>(2, 1)</entry>
<entry>(3, 0)</entry>
<entry>(4, 1)</entry>
</row>
<row>
<entry>Specific B</entry>
<entry></entry>
<entry>Clay Coated</entry>
<entry>Combined</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry>(2, 2)</entry>
<entry>(3, 1)</entry>
</row>
<row>
<entry>Specific C</entry>
<entry></entry>
<entry>Slight Gloss</entry>
<entry>Very Glossy</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry>(2, 3)</entry>
<entry>(3, 2)</entry>
</row>
<row>
<entry>Specific D</entry>
<entry></entry>
<entry>Greeting Card</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry>(2, 4)</entry>
</row>
<row><entry namest="1" nameend="5" align="center" rowsep="1"></entry>
</row>
</tbody>
</tgroup>
</table>
</table-cwu>
</paragraph>
<paragraph id="P-0127" lvl="0"><number>&lsqb;0127&rsqb;</number> In the first major type category of plain paper, a variety of different plain papers have been listed previously with respect to Table 1, with the specific type of plain paper shown in graphs <highlight><bold>42</bold></highlight>, <highlight><bold>49</bold></highlight> and <highlight><bold>50</bold></highlight> being a Gilbert&reg; Bond media, as a representative of these various types of plain paper. </paragraph>
<paragraph id="P-0128" lvl="0"><number>&lsqb;0128&rsqb;</number> Several different types of media fall within the premium category, and several of these premium papers have coatings placed over an underlying substrate layer. The coatings applied over premium medias, as well as transparency medias and glossy photo medias, whether they are of a swellable variety or a porous variety, are known in the art as an ink retention layer (&ldquo;IRL&rdquo;). The premium coatings typically have porosities which allow the liquid ink to pool inside these porosities until the water or other volatile components within the ink evaporate, leaving the pigment or dye remaining clinging to the inside of each cavity. One group of premium papers having such porosities are formed by coating a heavy plain paper with a fine layer of clay. Premium papers with these clay coatings are printed using the &ldquo;2,2&rdquo; print mode. </paragraph>
<paragraph id="P-0129" lvl="0"><number>&lsqb;0129&rsqb;</number> Another type of premium paper has a slightly glossy appearance and is formed by coating a plain paper with a swellable polymer layer. Upon receiving ink, the coating layer swells. After the water or other volatile components in the ink composition have evaporated, the coating layer then retracts to its original conformation, retaining the ink dyes and pigments which are the colorant portions of the ink composition. This swellable type of media is printed with a &ldquo;2,3&rdquo; print mode. Another type of media which falls into the premium category is pre-scored greeting card stock, which is a heavy smooth paper without a coating. However, the heavy nature of the greeting card media allows it to hold more ink than plain paper before the greeting card stock begins to cockle (referring to the phenomenon where media buckles as the paper fibers become saturated, which can lead to printhead damage if the media buckles high enough to contact the printhead). Thus, greeting card stock may be printed with a heavier saturation of ink for more rich colors in the resulting image, than possible with plain paper. The print mode selected for greeting card stock is designated as &ldquo;2,4&rdquo;. </paragraph>
<paragraph id="P-0130" lvl="0"><number>&lsqb;0130&rsqb;</number> The third major category used by the determination system <highlight><bold>500</bold></highlight> is photographic media. The various photo medias studied this far typically have a polymer coating which is hydroscopic, that is, the coating has an affinity for water. These hydroscopic coatings absorb water in the ink, and as these coating absorb the ink they swell and hold the water until it evaporates, as described above with respect to the slightly glossy premium media. The Gossimer paper which has a print mode selection of &ldquo;3,0&rdquo; is a glossy media, having a swellable polymer coating which is applied over a polymer photobase substrate, which feels like a thick plastic base. Another common type of photo media is a combination media, which has a print mode of &ldquo;3,1&rdquo;. This combination media has the same swellable polymer coating as the Gossimer media, but instead, the combination media has this coating applied over a photo paper, rather than the polymer substrate used for Gossimer. Thus, this combination photo media has a shiny polymer side which should be printed as a photo type media, and a plain or dull side, which should be printed under a premium print mode to achieve the best image. </paragraph>
<paragraph id="P-0131" lvl="0"><number>&lsqb;0131&rsqb;</number> The very glossy photo media which is printed according to print mode &ldquo;3,2&rdquo; is similar to the Gossimer media. The very shiny media uses a plastic backing layer or substrate like the Gossimer, but instead applies two layers of the swellable polymer over the substrate, yielding a surface finish which is much more glossy than that of the Gossimer media. </paragraph>
<paragraph id="P-0132" lvl="0"><number>&lsqb;0132&rsqb;</number> The final major media type studied were transparencies, which have not been studied beyond the two major categories described with respect to the basic media determination system <highlight><bold>400</bold></highlight>, specifically, HP transparencies or non-HP transparencies. Further research may study additional transparencies to determine their characteristics and methods of distinguishing such transparencies from one another but this study has yet to be undertaken. </paragraph>
<paragraph id="P-0133" lvl="0"><number>&lsqb;0133&rsqb;</number> Before returning to discussion of the determination method <highlight><bold>500</bold></highlight>, it should be noted that the various print modes selected by this system do not affect the normal quality settings, e.g., Best, Normal, Draft, which a user may select. These Best/Normal/Draft quality choices affect the speed with which the printer operates, not the print mode or color map which is used to place the dots on the media. The Best/Normal/Draft selections are a balance between print quality versus speed, with lower quality and higher speed being obtained for draft mode, and higher quality at a lower speed being obtained for the Best mode. Indeed, one of the inventors herein prefers to leave his prototype printer set in draft mode for speed, and allow the media determination system <highlight><bold>500</bold></highlight> to operate to select the best print mode for the type of media being used. </paragraph>
<paragraph id="P-0134" lvl="0"><number>&lsqb;0134&rsqb;</number> For example, when preparing for a presentation and making last minute changes to a combination of transparencies for overhead projection, premium or photo media for handouts, and plain paper for notes which the presenter is using during a speech, all of these images on their varying media may be quickly generated at a high quality, without requiring the user to interrupt the printing sequence and adjust for each different type of media used. Indeed, the last statement assumes that the user may have the sophistication to go into the software driver program screen and manually select which type of media has been placed in the printer&apos;s supply tray <highlight><bold>26</bold></highlight>. Unfortunately, the vast majority of users do not have this sophistication, and typically print with the default plain paper print mode on all types of media, yielding images of acceptable, but certainly not optimum print quality which the printer is fully capable of achieving if the printer has information input as to which type of media is to be printed upon. Thus, to allow all users to obtain optimum print quality matched to the specific type of media being used, the advanced media determination system <highlight><bold>500</bold></highlight> is the solution, at least with respect to the major types of media and the most popular specific types which have thus far been studied. </paragraph>
<paragraph id="P-0135" lvl="7"><number>&lsqb;0135&rsqb;</number> 6. Weighting and Ranking Routine </paragraph>
<paragraph id="P-0136" lvl="0"><number>&lsqb;0136&rsqb;</number> Before delving into the depths of the major and specific media type determination routines <highlight><bold>506</bold></highlight>, <highlight><bold>508</bold></highlight> a weighting and ranking routine <highlight><bold>580</bold></highlight> will be described with respect to <cross-reference target="DRAWINGS">FIG. 19</cross-reference>. This weighting and ranking routine <highlight><bold>580</bold></highlight> is performed during the quality fit step <highlight><bold>564</bold></highlight> of the verification routine <highlight><bold>510</bold></highlight>. The specific type of assumption signal <highlight><bold>562</bold></highlight> is first received by a find error step <highlight><bold>582</bold></highlight>. The find error step <highlight><bold>582</bold></highlight> refers to a subtable <highlight><bold>584</bold></highlight> of the type characteristics table <highlight><bold>565</bold></highlight>. The subtable <highlight><bold>584</bold></highlight> contains the average or reference values for each spatial frequency, for each specific media type that has been studied. The find error step <highlight><bold>582</bold></highlight> then compares the value of the spatial frequency measured with the reference value of that spatial frequency with each of the values for a corresponding frequency stored in table <highlight><bold>584</bold></highlight> for each media type, and during this comparison generates an error value, that is, the difference between the frequency value measured versus the value of the corresponding frequency for each media type. The resulting error signals are sent to a weight assigning step <highlight><bold>585</bold></highlight>. </paragraph>
<paragraph id="P-0137" lvl="0"><number>&lsqb;0137&rsqb;</number> The weight assigning step <highlight><bold>585</bold></highlight> then refers to another subtable <highlight><bold>586</bold></highlight> of the look-up table <highlight><bold>565</bold></highlight>. The subtable <highlight><bold>586</bold></highlight> stores the standard deviation which has been found during study at each spatial frequency for each type of media. The assigning step <highlight><bold>585</bold></highlight> then uses the corresponding standard deviation stored in table <highlight><bold>586</bold></highlight> to each of the errors produced by step <highlight><bold>582</bold></highlight>. Then all of the weighted errors produced by step <highlight><bold>585</bold></highlight> are ranked in a ranking step <highlight><bold>588</bold></highlight>. After the ranking has been assigned by step <highlight><bold>588</bold></highlight>, the ranking for each media type are summed in the summing step <highlight><bold>590</bold></highlight>. Of course, on this first pass through the routine, no previous values have been accumulated by step <highlight><bold>590</bold></highlight>. </paragraph>
<paragraph id="P-0138" lvl="0"><number>&lsqb;0138&rsqb;</number> Following the summing step <highlight><bold>590</bold></highlight>, comes a counting step <highlight><bold>592</bold></highlight>, or the particular frequency X under study is compared to the final frequency value n. If the particular frequency X under study has not yet reached the final frequency value n, the counting step <highlight><bold>592</bold></highlight> issues a NO signal <highlight><bold>594</bold></highlight>. The NO signal <highlight><bold>594</bold></highlight> has been received by an incrementing step <highlight><bold>595</bold></highlight>, where the frequency under study X is incremented by one (&ldquo;X&equals;X&plus;1&rdquo;). Following step <highlight><bold>595</bold></highlight>, steps <highlight><bold>582</bold></highlight> through <highlight><bold>592</bold></highlight> are repeated until each of the frequencies for both the spatial reflectance and the diffuse reflectance have been compared with each media type by step <highlight><bold>582</bold></highlight>, then assigned a weighting factor according to the standard deviation for each frequency and media type by step <highlight><bold>585</bold></highlight>, ranked by step <highlight><bold>588</bold></highlight>, and then having the ranking summed in step <highlight><bold>590</bold></highlight>. </paragraph>
<paragraph id="P-0139" lvl="0"><number>&lsqb;0139&rsqb;</number> Upon reaching the final spatial frequency N, the counting step <highlight><bold>592</bold></highlight> finds that the last frequency N has been reached (X&equals;N) and a YES signal <highlight><bold>596</bold></highlight> is issued. Upon receiving this YES signal <highlight><bold>596</bold></highlight>, a selection step <highlight><bold>598</bold></highlight> then selects the specific type of media by selecting the highest number from the summed ranking step <highlight><bold>590</bold></highlight>. This specific type is then output as signal <highlight><bold>568</bold></highlight> from the verification block <highlight><bold>510</bold></highlight>. It is apparent that this weighting and ranking routine <highlight><bold>580</bold></highlight> may be used in conjunction with various portions of the determination method <highlight><bold>500</bold></highlight> to provide a more accurate guess as to the type of media entering the printzone <highlight><bold>25</bold></highlight>. </paragraph>
<paragraph id="P-0140" lvl="0"><number>&lsqb;0140&rsqb;</number> During the weighting and ranking routine <highlight><bold>580</bold></highlight>, for a standard letter-size sheet of media analyzing both the specular and diffuse readings for a given sheet of media, a total of 84 events are compared for both the specular and diffuse waveforms for each media type. It is apparent that, while the subject media entering the printzone has been compared to each media type by incrementing the frequency, other ways could be used to generate this data, for instance by looking at each media type separately, and then comparing the resulting ranking for each type of media rather than incrementing by frequency through each type of media. However, the illustrated method is preferred because it more readily lends itself to the addition of new classifications of media as their characteristics are studied and compiled. </paragraph>
<paragraph id="P-0141" lvl="0"><number>&lsqb;0141&rsqb;</number> Each component of the pre-stored Fourier spectrum for each media type has an associated deviation which was determined during the media study. The standard deviations stored in the look-up table <highlight><bold>586</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 19</cross-reference> are preferably arrived at by analyzing the spectra over many hundreds of data scans for many hundreds of pages of each specific type of media studied. The difference between each component of the fresh sheet of media entering the printzone <highlight><bold>25</bold></highlight> and each component of the stored signatures is computed in the find error step <highlight><bold>582</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 19</cross-reference>. The ratio (&ldquo;x&rdquo;) of the error to the standard deviation is then determined. If this ratio is found to be less than two (x&lt;2), the error is then weighted by a factor of one (1). If this ratio is found to be between two and three (2&lt;x&lt;3), then the error is weighted by a factor of two (2). If this ratio is found to be greater then three (x&gt;3), then the error is weighted by a factor of four (4). This &ldquo;weighting&rdquo; of step <highlight><bold>585</bold></highlight> then takes into account the statistical set for each of the characterized media types which have been studied. In the illustrated embodiment, the media type with the lowest weighted error is assigned a ranking of three (3) points. The media type with the second lowest error is assigned a ranking of two (2) points, and the media type with the third lowest error is given a ranking of one (1) point, as shown in <cross-reference target="DRAWINGS">FIG. 19</cross-reference>. </paragraph>
<paragraph id="P-0142" lvl="0"><number>&lsqb;0142&rsqb;</number> The media type having the highest sum of the ranking points across all of the specular and diffuse frequency components is then selected as the best fit for characterizing the fresh sheet of media entering the printzone <highlight><bold>25</bold></highlight>. The select print mode routine <highlight><bold>512</bold></highlight> then selects the best print mode, which is delivered to the printing routine <highlight><bold>514</bold></highlight> where the corresponding rendering and color mapping is performed to generate an optimum quality image on the particular type of media being used. </paragraph>
<paragraph id="P-0143" lvl="7"><number>&lsqb;0143&rsqb;</number> 7. Major Category &amp; Specific Type </paragraph>
<paragraph id="P-0144" lvl="7"><number>&lsqb;0144&rsqb;</number> Media Type Determination Routines </paragraph>
<paragraph id="P-0145" lvl="0"><number>&lsqb;0145&rsqb;</number> Having dispensed with preliminary matters, our discussion will now turn to the major category determination and the specific type determination routines <highlight><bold>506</bold></highlight> and <highlight><bold>508</bold></highlight>. This discussion will cover how the routines <highlight><bold>506</bold></highlight> and <highlight><bold>508</bold></highlight> are interwoven to provide information to multiple verification and select print mode steps, ultimately resulting in printing an image on the incoming sheet of media according to a print mode selected by routine <highlight><bold>500</bold></highlight> to produce an optimum image on the sheet, in light of the available information known. FIGS. <highlight><bold>20</bold></highlight>-<highlight><bold>23</bold></highlight> together describe the major category and specific type determination routines <highlight><bold>506</bold></highlight> and <highlight><bold>508</bold></highlight>. </paragraph>
<paragraph id="P-0146" lvl="0"><number>&lsqb;0146&rsqb;</number> Referring first to <cross-reference target="DRAWINGS">FIG. 20</cross-reference>, the massage data routine <highlight><bold>504</bold></highlight> is shown as first supplying the specular and diffuse spatial frequency data <highlight><bold>556</bold></highlight> and <highlight><bold>558</bold></highlight> to a match signature step <highlight><bold>600</bold></highlight>. Step <highlight><bold>600</bold></highlight> receives an input signal <highlight><bold>602</bold></highlight> from a major category look-up table <highlight><bold>604</bold></highlight>. Table <highlight><bold>604</bold></highlight> contains both specular and diffuse spatial frequency information for a generic glossy finish media and a generic dull finish media. The term &ldquo;generic&rdquo; here means an average or a general category of information, basically corresponding to a gross sorting routine. The match signature routine <highlight><bold>600</bold></highlight> then compares the incoming massaged data for both the specular and diffuse reflectances <highlight><bold>556</bold></highlight> and <highlight><bold>558</bold></highlight> with the reference values <highlight><bold>602</bold></highlight> from table <highlight><bold>604</bold></highlight>, and then produces a match signal <highlight><bold>605</bold></highlight>. In a comparison step <highlight><bold>606</bold></highlight>, the question is asked whether the incoming matched data <highlight><bold>605</bold></highlight> corresponds to media having a dull finish. If it does, a YES signal <highlight><bold>608</bold></highlight> is issued to a plain paper, premium paper, or a matte photo branch routine <highlight><bold>610</bold></highlight>. The photo branch routine <highlight><bold>610</bold></highlight> issues an output signal <highlight><bold>612</bold></highlight>, which is further processed as described with respect to <cross-reference target="DRAWINGS">FIG. 22</cross-reference> below. However, if the dulled determination step <highlight><bold>606</bold></highlight> determines that the match signature output signal <highlight><bold>605</bold></highlight> is not dull, a NO signal <highlight><bold>614</bold></highlight> is issued to a photo or transparency decision branch <highlight><bold>615</bold></highlight>. </paragraph>
<paragraph id="P-0147" lvl="0"><number>&lsqb;0147&rsqb;</number> The photo or transparency branch <highlight><bold>615</bold></highlight> sends a data signal <highlight><bold>616</bold></highlight> carrying the massaged specular and diffuse spatial frequency data <highlight><bold>556</bold></highlight> and <highlight><bold>558</bold></highlight> to another match signature step <highlight><bold>618</bold></highlight>. A second major category look-up table <highlight><bold>620</bold></highlight> supplies an input <highlight><bold>622</bold></highlight> to the second match signature step <highlight><bold>618</bold></highlight>. The data supplied by table <highlight><bold>620</bold></highlight> is specular and diffuse spatial frequency information for two types of media, specifically a generic photo finish media, and a generic transparency media. The match signature step <highlight><bold>618</bold></highlight> then determines whether the incoming data <highlight><bold>616</bold></highlight> corresponds more closely to a generic photo finish data, or a generic transparency data according to a gross sorting routine. An output <highlight><bold>624</bold></highlight> of the match signature step <highlight><bold>618</bold></highlight> is supplied to a comparison step <highlight><bold>626</bold></highlight>, which asks whether the match signature output signal <highlight><bold>624</bold></highlight> corresponds to a transparency. If not, a NO signal <highlight><bold>628</bold></highlight> is issued to a glossy photo or a matte photo branch <highlight><bold>630</bold></highlight>. </paragraph>
<paragraph id="P-0148" lvl="0"><number>&lsqb;0148&rsqb;</number> However, if the match signature output <highlight><bold>624</bold></highlight> corresponds to a transparency, then the comparison step <highlight><bold>626</bold></highlight> issues a YES signal <highlight><bold>632</bold></highlight>. For the yes transparency signal <highlight><bold>632</bold></highlight> is received by a ratio generation step <highlight><bold>634</bold></highlight>. In response to receiving the YES signal <highlight><bold>632</bold></highlight>, the ratio generation step <highlight><bold>634</bold></highlight> receives the average specular (A) signal <highlight><bold>542</bold></highlight>, and the average diffuse (B) signal <highlight><bold>545</bold></highlight> from the massage data routine <highlight><bold>504</bold></highlight>. From these incoming signals <highlight><bold>542</bold></highlight> and <highlight><bold>545</bold></highlight>, the ratio generation step <highlight><bold>634</bold></highlight> then generates a ratio of the diffuse average to the specular average (B/A) multiplied by 100 to convert the ratio to a percentage, which is supplied as a ratio output signal <highlight><bold>635</bold></highlight>. In a comparison step <highlight><bold>636</bold></highlight>, the value of the ratio signal <highlight><bold>635</bold></highlight> is compared to determine if the ratio B/A as a percentage is less than a value of 80 per cent (with the &ldquo;%&rdquo; sign being omitted in <cross-reference target="DRAWINGS">FIG. 20</cross-reference> for brevity). If not, the comparison step <highlight><bold>636</bold></highlight> issues a NO signal <highlight><bold>638</bold></highlight> to the glossy photo or matte photo branch <highlight><bold>630</bold></highlight>. </paragraph>
<paragraph id="P-0149" lvl="0"><number>&lsqb;0149&rsqb;</number> Thus, the average specular and diffuse data are used as a check to determine whether the transparency determination was correct or not. If the ratio that the diffuse averaged to the specular average is determined by step <highlight><bold>636</bold></highlight> to be less than 80, a YES signal <highlight><bold>640</bold></highlight> is then supplied to a verification step <highlight><bold>642</bold></highlight>. The verified step <highlight><bold>642</bold></highlight> may be performed as described above with respect to <cross-reference target="DRAWINGS">FIG. 18</cross-reference>. During this verification routine, an assumption is made according to step <highlight><bold>560</bold></highlight> that the media in the printzone is a transparency, and if the verification routine <highlight><bold>642</bold></highlight> determines that it indeed is, a YES signal <highlight><bold>644</bold></highlight> is issued. The YES signal <highlight><bold>644</bold></highlight> is received by a select transparency mode step <highlight><bold>646</bold></highlight>, which issues a transparency print signal <highlight><bold>648</bold></highlight> to initiate a transparency step <highlight><bold>650</bold></highlight>. The print mode selected by step <highlight><bold>646</bold></highlight> corresponds to a &ldquo;4,0&rdquo; print mode, here selecting the default value for a transparency. </paragraph>
<paragraph id="P-0150" lvl="0"><number>&lsqb;0150&rsqb;</number> If a Hewlett-Packard transparency is identified, as described above with respect to <cross-reference target="DRAWINGS">FIG. 13</cross-reference>, then a custom print mode may be employed for the specific HP transparency media, as described above with respect to the basic media determination system <highlight><bold>400</bold></highlight>, resulting in a &ldquo;4,1&rdquo; print mode. If the verification step <highlight><bold>642</bold></highlight> determines that the media in the printzone is not a transparency, then a NO signal <highlight><bold>652</bold></highlight> is issued. Upon receiving the NO signal <highlight><bold>652</bold></highlight>, a select default step <highlight><bold>654</bold></highlight> chooses the default premium print mode, and issues a print signal <highlight><bold>656</bold></highlight>. Upon receiving signal <highlight><bold>656</bold></highlight>, a print step <highlight><bold>658</bold></highlight> then prints upon the media according to the generic premium media print mode &ldquo;2,0&rdquo;. </paragraph>
<paragraph id="P-0151" lvl="0"><number>&lsqb;0151&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 21</cross-reference> begins with the glossy photo or matte photo branch <highlight><bold>630</bold></highlight> from <cross-reference target="DRAWINGS">FIG. 20</cross-reference>, which issued an output signal <highlight><bold>660</bold></highlight>, carrying through the massaged specular and diffuse spatial frequency data (S and D) signals <highlight><bold>556</bold></highlight> and <highlight><bold>558</bold></highlight>. This input signal <highlight><bold>660</bold></highlight> is received by a determination step <highlight><bold>662</bold></highlight> which determines whether the incoming data <highlight><bold>660</bold></highlight> corresponds to a specific type of glossy media or a specific type of matte photo media. To accomplish this, a specific media look-up table <highlight><bold>664</bold></highlight> provides an input signal <highlight><bold>665</bold></highlight> to the determination step <highlight><bold>662</bold></highlight>. Table <highlight><bold>664</bold></highlight> contains reference data corresponding to the specular and diffuse spatial frequencies corresponding to various types of glossy photo media and matte photo media, illustrated in table <highlight><bold>664</bold></highlight> as &ldquo;glossy A&rdquo;, &ldquo;glossy B&rdquo;, and so on through &ldquo;matte A&rdquo;, &ldquo;matte B&rdquo;, and so on. Several types of glossy photo media and matte photo media were described above with respect to Table 2. </paragraph>
<paragraph id="P-0152" lvl="0"><number>&lsqb;0152&rsqb;</number> Once the determination step <highlight><bold>662</bold></highlight> finds a suitable match from the values stored in table <highlight><bold>664</bold></highlight>, an output signal <highlight><bold>667</bold></highlight> is issued to a comparison step <highlight><bold>668</bold></highlight>. The comparison step <highlight><bold>668</bold></highlight> asks whether the incoming signal <highlight><bold>667</bold></highlight> is for a matte photo media. If so, a YES signal <highlight><bold>670</bold></highlight> is issued. The YES signal <highlight><bold>670</bold></highlight> is then delivered to the plain paper/premium paper/matte photo branch <highlight><bold>610</bold></highlight>, as shown in <cross-reference target="DRAWINGS">FIGS. 20 and 22</cross-reference>. If the comparison step <highlight><bold>668</bold></highlight> finds that the output of determination step <highlight><bold>662</bold></highlight> does not correspond to a matte photo, then a NO signal <highlight><bold>672</bold></highlight> is issued. The NO signal <highlight><bold>672</bold></highlight> delivers the specular and diffuse spatial frequency data to another determination step <highlight><bold>674</bold></highlight>. Step <highlight><bold>674</bold></highlight> determines which specific type of glossy photo media is entering the printzone <highlight><bold>25</bold></highlight> using data received via signal <highlight><bold>675</bold></highlight> from a glossy photo look-up table <highlight><bold>676</bold></highlight>. While tables <highlight><bold>664</bold></highlight> and <highlight><bold>676</bold></highlight> are illustrated in the drawings as two separate tables, it is apparent that the determination step <highlight><bold>674</bold></highlight> could also query table <highlight><bold>664</bold></highlight> to obtain glossy photo data for each specific type. </paragraph>
<paragraph id="P-0153" lvl="0"><number>&lsqb;0153&rsqb;</number> After step <highlight><bold>674</bold></highlight> determines which specific type of glossy photo media is in the printzone <highlight><bold>25</bold></highlight>, a signal <highlight><bold>678</bold></highlight> is issued to a verification routine <highlight><bold>680</bold></highlight> which proceeds to verify the assumption as described above with respect to <cross-reference target="DRAWINGS">FIGS. 18 and 19</cross-reference>. If the verification routine <highlight><bold>680</bold></highlight> finds that the determination step <highlight><bold>674</bold></highlight> is correct, a YES signal <highlight><bold>682</bold></highlight> is issued to a select specific glossy photo print mode step <highlight><bold>684</bold></highlight>. The selection step <highlight><bold>684</bold></highlight> generates a print mode signal <highlight><bold>686</bold></highlight> which initiates a print step <highlight><bold>688</bold></highlight>. The printing step <highlight><bold>688</bold></highlight> then prints upon the sheet of glossy photo media using the print mode corresponding to the selected media, here according to &ldquo;3,0&rdquo; print mode for Gossimer media, a &ldquo;3,1&rdquo; print mode for the combination media, and a &ldquo;3,2&rdquo; print mode for the very glossy photo media. </paragraph>
<paragraph id="P-0154" lvl="0"><number>&lsqb;0154&rsqb;</number> If the verification routine <highlight><bold>680</bold></highlight> finds that the determination step <highlight><bold>674</bold></highlight> was wrong regarding the specific type of glossy photo selected, a NO signal <highlight><bold>690</bold></highlight> is issued. In response to receiving the NO signal <highlight><bold>690</bold></highlight>, a select default step <highlight><bold>692</bold></highlight> selects a generic glossy photo print mode and issues signal <highlight><bold>694</bold></highlight> to a print step <highlight><bold>696</bold></highlight>. The print step <highlight><bold>696</bold></highlight> then prints upon the media according to a generic print mode, here selected as &ldquo;3,0&rdquo; print mode. </paragraph>
<paragraph id="P-0155" lvl="0"><number>&lsqb;0155&rsqb;</number> Traveling now to <cross-reference target="DRAWINGS">FIG. 22</cross-reference>, we see the plain paper/premium paper/matte photo branch <highlight><bold>610</bold></highlight> receiving an input signal <highlight><bold>608</bold></highlight> from <cross-reference target="DRAWINGS">FIG. 20</cross-reference>, and another input signal <highlight><bold>670</bold></highlight> from <cross-reference target="DRAWINGS">FIG. 21</cross-reference>. Both signals <highlight><bold>608</bold></highlight> and <highlight><bold>670</bold></highlight> carry the specular and diffuse spatial frequency data for the media entering printzone <highlight><bold>25</bold></highlight>. In response to receiving either signal <highlight><bold>608</bold></highlight> or <highlight><bold>670</bold></highlight>, the branch <highlight><bold>610</bold></highlight> issues an output signal <highlight><bold>612</bold></highlight> carrying the spatial frequency data to a match signature routine <highlight><bold>700</bold></highlight>. The match signature routine <highlight><bold>700</bold></highlight> reviews reference data <highlight><bold>702</bold></highlight> received from a look-up table <highlight><bold>704</bold></highlight> where data is stored for a generic dull finish media and a generic matte photo finish media. When the matching step <highlight><bold>700</bold></highlight> has completed analyzing the incoming data <highlight><bold>612</bold></highlight> with respect to the data <highlight><bold>702</bold></highlight> stored in table <highlight><bold>704</bold></highlight>, an output signal <highlight><bold>705</bold></highlight> is issued. </paragraph>
<paragraph id="P-0156" lvl="0"><number>&lsqb;0156&rsqb;</number> A comparison step <highlight><bold>706</bold></highlight> reviews the output signal <highlight><bold>705</bold></highlight> to determine whether the matching step <highlight><bold>700</bold></highlight> found the incoming media to have a matte finish. If not, the comparison step <highlight><bold>706</bold></highlight> issues a NO signal <highlight><bold>708</bold></highlight> which is delivered to a plain paper/premium paper branch <highlight><bold>710</bold></highlight>. In response to receiving the NO signal <highlight><bold>708</bold></highlight>, branch <highlight><bold>710</bold></highlight> issues an output signal <highlight><bold>712</bold></highlight> which transitions to the last portion of the major and specific type determination routines <highlight><bold>506</bold></highlight>, <highlight><bold>508</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 23</cross-reference>. Before leaving <cross-reference target="DRAWINGS">FIG. 22</cross-reference> we will discuss the remainder of the steps shown there. </paragraph>
<paragraph id="P-0157" lvl="0"><number>&lsqb;0157&rsqb;</number> If the comparison step <highlight><bold>706</bold></highlight> determines that the matching step <highlight><bold>700</bold></highlight> found the incoming media to have a matte finish, a YES signal <highlight><bold>714</bold></highlight> is issued. A determination step <highlight><bold>715</bold></highlight> receives the YES signal <highlight><bold>714</bold></highlight>, and then determines which specific type of matte photo media is entering the printzone <highlight><bold>25</bold></highlight>. The determining step <highlight><bold>715</bold></highlight> receives a reference data signal <highlight><bold>716</bold></highlight> from a matte photo look-up table <highlight><bold>718</bold></highlight>, which may store data for a variety of different matte photo medias. Note that while table <highlight><bold>718</bold></highlight> is shown as a separate table, the determination step <highlight><bold>715</bold></highlight> could also consult the specific media look-up table <highlight><bold>664</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 21</cross-reference> to obtain this data. Note that for the purposes of illustration, data is shown in both tables <highlight><bold>664</bold></highlight> and <highlight><bold>718</bold></highlight> for a &ldquo;Matte A&rdquo; and &ldquo;Matte B&rdquo; media, to date the characteristics for only a single matte photo media has been identified, and further research is required to generate reference data to allow identification of other types of matte photo media. </paragraph>
<paragraph id="P-0158" lvl="0"><number>&lsqb;0158&rsqb;</number> Following the completion of the determination step <highlight><bold>715</bold></highlight>, an output signal <highlight><bold>720</bold></highlight> is issued to a verification routine <highlight><bold>722</bold></highlight>. If the verification routine <highlight><bold>722</bold></highlight> determines that the correct type of matte photo media has been identified, a YES signal <highlight><bold>724</bold></highlight> is issued. In response to the YES signal <highlight><bold>724</bold></highlight>, a selecting step <highlight><bold>726</bold></highlight> chooses which specific matte photo print mode to use, and then issues a signal <highlight><bold>728</bold></highlight> to a printing step <highlight><bold>730</bold></highlight>. The printing step <highlight><bold>730</bold></highlight> then uses a &ldquo;2,1&rdquo; print mode when printing on the incoming sheet. If the verification routine <highlight><bold>722</bold></highlight> finds that the determination step <highlight><bold>715</bold></highlight> was in error, a NO signal <highlight><bold>732</bold></highlight> is issued. A selecting step <highlight><bold>734</bold></highlight> responds to the incoming NO signal <highlight><bold>732</bold></highlight> by selecting a default matte photo print mode. After the selection is made, step <highlight><bold>734</bold></highlight> issues an output signal <highlight><bold>736</bold></highlight> to a printing step <highlight><bold>738</bold></highlight>. In the printing step <highlight><bold>738</bold></highlight>, the media is then printed upon using the default print mode, here a &ldquo;2,0&rdquo; print mode which corresponds to the default print mode for premium paper in the illustrated embodiment. </paragraph>
<paragraph id="P-0159" lvl="0"><number>&lsqb;0159&rsqb;</number> Turning now to <cross-reference target="DRAWINGS">FIG. 23</cross-reference>, the plain paper/premium paper branch <highlight><bold>710</bold></highlight> is shown issuing an output signal <highlight><bold>712</bold></highlight> which includes data for both the specular and diffuse spatial frequency of the media entering the printzone <highlight><bold>25</bold></highlight>. In response to receiving signal <highlight><bold>712</bold></highlight>, a matching step <highlight><bold>740</bold></highlight> compares the incoming data with reference data received via a signal <highlight><bold>742</bold></highlight> from a look-up table <highlight><bold>744</bold></highlight>. The look-up table <highlight><bold>744</bold></highlight> stores data corresponding to a generic plain finish media, and a generic premium finish media. The matching step <highlight><bold>740</bold></highlight> then decides whether the incoming data <highlight><bold>712</bold></highlight> more closely corresponds to a plain paper media, or a premium paper and issues an output signal <highlight><bold>745</bold></highlight>. In a comparison step <highlight><bold>746</bold></highlight>, the question is asked whether the output of the matching step <highlight><bold>740</bold></highlight> corresponds to a premium paper. If not, then a NO signal <highlight><bold>748</bold></highlight> is issued to a determination step <highlight><bold>750</bold></highlight>. </paragraph>
<paragraph id="P-0160" lvl="0"><number>&lsqb;0160&rsqb;</number> The determination step <highlight><bold>750</bold></highlight> uses reference data received via a signal <highlight><bold>752</bold></highlight> from a plain paper look-up table <highlight><bold>754</bold></highlight>. The look-up table <highlight><bold>754</bold></highlight> may store data corresponding to different types of plain paper media which have been previously studied. Once the determination step <highlight><bold>750</bold></highlight> decides which type of plain paper is entering the printzone, an output signal <highlight><bold>755</bold></highlight> is issued. A verification routine <highlight><bold>756</bold></highlight> receives the output signal <highlight><bold>755</bold></highlight> and then verifies whether or not the sheet of media entering the printzone <highlight><bold>25</bold></highlight> actually corresponds to the type of plain paper selected in the determination step <highlight><bold>750</bold></highlight>. If the verification step <highlight><bold>756</bold></highlight> finds that a correct selection was made, a YES signal <highlight><bold>758</bold></highlight> is issued to a selecting step <highlight><bold>760</bold></highlight>. In the selecting step <highlight><bold>760</bold></highlight>, a print mode corresponding to the specific type of plain paper media identified is chosen, and an output signal <highlight><bold>762</bold></highlight> is issued to a printing step <highlight><bold>764</bold></highlight>. The printing step <highlight><bold>764</bold></highlight> then prints on the incoming media sheet according to a &ldquo;0,1&rdquo; print mode. </paragraph>
<paragraph id="P-0161" lvl="0"><number>&lsqb;0161&rsqb;</number> If the verification step <highlight><bold>756</bold></highlight> finds that the determination step <highlight><bold>750</bold></highlight> was in error, a NO signal <highlight><bold>765</bold></highlight> is issued to a selecting step <highlight><bold>766</bold></highlight>. In the selecting step <highlight><bold>766</bold></highlight>, a default plain paper print mode is selected, and an output signal <highlight><bold>768</bold></highlight> is issued to a printing step <highlight><bold>770</bold></highlight>. In the printing step <highlight><bold>770</bold></highlight>, the incoming sheet of media is printed upon according to a &ldquo;0,&rdquo; default print mode for plain paper. </paragraph>
<paragraph id="P-0162" lvl="0"><number>&lsqb;0162&rsqb;</number> Returning to the premium comparison step <highlight><bold>746</bold></highlight>, if the media identified in the match signature step <highlight><bold>740</bold></highlight> is found to be a premium paper, a YES signal <highlight><bold>772</bold></highlight> is issued. In response to receiving the YES signal <highlight><bold>772</bold></highlight>, a determination step <highlight><bold>774</bold></highlight> then determines which specific type of premium media is in the printzone <highlight><bold>25</bold></highlight>. To do this, the determination step <highlight><bold>774</bold></highlight> consults reference data received via signal <highlight><bold>775</bold></highlight> from a premium look-up table <highlight><bold>776</bold></highlight>. Upon determining which type of specific premium media is entering the printzone <highlight><bold>25</bold></highlight>, the determination step <highlight><bold>774</bold></highlight> issues an output signal <highlight><bold>778</bold></highlight>. Upon receiving signal <highlight><bold>778</bold></highlight>, a verification step <highlight><bold>780</bold></highlight> is initiated to determine the correctness of the selection made by step <highlight><bold>774</bold></highlight>. If the verification step <highlight><bold>780</bold></highlight> determines that yes indeed a correct determination was made by <highlight><bold>774</bold></highlight>, a YES signal <highlight><bold>782</bold></highlight> is issued to a selecting step <highlight><bold>784</bold></highlight>. The selecting step <highlight><bold>784</bold></highlight> then selects the specific premium print mode corresponding to the specific type of premium media identified in step <highlight><bold>774</bold></highlight>. After the selection is made, an output signal <highlight><bold>785</bold></highlight> is issued to a printing step <highlight><bold>788</bold></highlight>. The printing step <highlight><bold>788</bold></highlight> then prints upon the incoming sheet of media according to the specific premium print mode established by step <highlight><bold>784</bold></highlight>, which may be a &ldquo;2,2&rdquo; print mode corresponding to premium media having a clay coating, a &ldquo;2,3&rdquo; print mode corresponding to a plain paper having a swellable polymer layer, or &ldquo;2,4&rdquo; print mode corresponding to a heavy greeting card stock, in the illustrated embodiments. </paragraph>
<paragraph id="P-0163" lvl="0"><number>&lsqb;0163&rsqb;</number> If the verification step <highlight><bold>780</bold></highlight> finds that the determination step <highlight><bold>774</bold></highlight> was in error, a NO signal <highlight><bold>790</bold></highlight> is issued to a selecting step <highlight><bold>792</bold></highlight>. In the selecting step <highlight><bold>792</bold></highlight>, a default premium print mode is selected and an output signal <highlight><bold>794</bold></highlight> is issued to another printing step <highlight><bold>796</bold></highlight>. In the printing step <highlight><bold>796</bold></highlight>, the incoming sheet of media is printed upon according to a default print mode of &ldquo;2,0&rdquo;. </paragraph>
<paragraph id="P-0164" lvl="7"><number>&lsqb;0164&rsqb;</number> 8. Operation of the Media Sensor </paragraph>
<paragraph id="P-0165" lvl="0"><number>&lsqb;0165&rsqb;</number> The next portion of our discussion delves into one preferred construction of the media sensor <highlight><bold>100</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 2</cross-reference>) and the differences between the advanced media type detection system <highlight><bold>500</bold></highlight> and the earlier basic media type determination system <highlight><bold>400</bold></highlight>. </paragraph>
<paragraph id="P-0166" lvl="0"><number>&lsqb;0166&rsqb;</number> The basic media determination system <highlight><bold>400</bold></highlight> only uses the diffuse reflectance information. The basic system <highlight><bold>400</bold></highlight> extracted more information regarding the unique reflectance properties of media by performing a Fourier transform on the diffuse data. The spatial frequency components generated by the basic method <highlight><bold>400</bold></highlight> characterized the media adequately enough to group media into generic categories of (1) transparency media, (2) photo media, and (3) plain paper. One of the main advantages of the basic method <highlight><bold>400</bold></highlight> was that it used an existing sensor which was already supplied in a commercially available printer for ink droplet sensing. A more advanced media type determination was desired, using the spatial frequencies of only the diffuse reflectance with sensor <highlight><bold>100</bold></highlight> was not adequate to uniquely identify the specific types of media within the larger categories of transparency, photo media and plain paper. The basic determination system <highlight><bold>400</bold></highlight> simply could not distinguish between specialty media, such as matte photo media, and some premium media. To make these specific type distinctions, more properties needed to be measured, and in particular properties which related to the coatings on the media surface. The manner chosen to gather information about these additional properties was to collect the specular reflectance light <highlight><bold>200</bold></highlight>&prime;, as well as the diffuse reflectance light <highlight><bold>200</bold></highlight>. </paragraph>
<paragraph id="P-0167" lvl="0"><number>&lsqb;0167&rsqb;</number> In the advanced media sensor <highlight><bold>100</bold></highlight> uses a blue-violet LED <highlight><bold>105</bold></highlight> which has an output shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference> as graph <highlight><bold>112</bold></highlight>. In graph <highlight><bold>112</bold></highlight>, we see the blue-violet LED <highlight><bold>105</bold></highlight> has a peak amplitude output at about <highlight><bold>428</bold></highlight> nanometers. The output also extends down to approximately 340 nanometers, into the ultraviolet range past the end of the visible range, which is around 400 nanometers, with a dominant wavelength of 464 nanometers. While the illustrated peak wavelength of 428 nanometers is shown, it is believed that suitable results may be obtained with an LED having a peak wavelength of 400-430 nanometers. </paragraph>
<paragraph id="P-0168" lvl="0"><number>&lsqb;0168&rsqb;</number> The short wavelength of the blue-violet LED <highlight><bold>105</bold></highlight> serves two important purposes in the collecting raw data routine <highlight><bold>502</bold></highlight>. First, the blue-violet LED <highlight><bold>105</bold></highlight> produces an adequate signal from all colors of ink including cyan ink, so sensor <highlight><bold>100</bold></highlight> may be used for ink detection, as described in U.S. Pat. No. 6,036,298, recited in the Related Applications section above. Thus, the diffuse reflection measured by photodiode <highlight><bold>130</bold></highlight> of sensor <highlight><bold>100</bold></highlight> may still be used for performing pen alignment. The second purpose served by the blue-violet LED <highlight><bold>105</bold></highlight> is that the shorter wavelengths, as opposed to a 700-1100 nanometer infrared LED, is superior for detecting subtleties in the media coding, as described above with respect to Table 2. </paragraph>
<paragraph id="P-0169" lvl="0"><number>&lsqb;0169&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 24</cross-reference> shows the media sensor <highlight><bold>100</bold></highlight> scanning over the top two millimeters of a sheet of media <highlight><bold>150</bold></highlight> entering the printzone <highlight><bold>25</bold></highlight>. Here we see an incoming beam <highlight><bold>800</bold></highlight> generating a specular reflectance beam <highlight><bold>802</bold></highlight> which passes through the field stop window <highlight><bold>144</bold></highlight> to be received by the specular photodiode <highlight><bold>130</bold></highlight>&prime;. A second illuminating beam of light <highlight><bold>804</bold></highlight> is also shown in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>, along with its specular reflectance beam <highlight><bold>806</bold></highlight>. As mentioned above, recall that the specular beam has an angle of reflection which is equal to the angle of incidence of the illuminating beam, with respect to a tangential surface of the media at the point of illumination. The sheet of media <highlight><bold>150</bold></highlight> is shown in <cross-reference target="DRAWINGS">FIG. 24</cross-reference> as being supported by a pair of cockle ribs <highlight><bold>810</bold></highlight> and <highlight><bold>812</bold></highlight>, which project upwardly from a table-like portion of the platen or pivot <highlight><bold>814</bold></highlight>. The cockle ribs <highlight><bold>810</bold></highlight>, <highlight><bold>812</bold></highlight> support the media in the printzone <highlight><bold>25</bold></highlight>, and provide a space for printed media which is saturated with ink to expand downwardly between the ribs, instead of upwardly where the saturated media might inadvertently contact and damage the printhead. </paragraph>
<paragraph id="P-0170" lvl="0"><number>&lsqb;0170&rsqb;</number> Some artistic license has been taken in configuring the views of FIGS. <highlight><bold>24</bold></highlight>-<highlight><bold>26</bold></highlight>, <highlight><bold>37</bold></highlight> and <highlight><bold>38</bold></highlight> with respect to the orientation of the media sensor <highlight><bold>100</bold></highlight>. The cockle ribs <highlight><bold>810</bold></highlight> and <highlight><bold>812</bold></highlight> are orientated correctly to be perpendicular to the scan axis <highlight><bold>38</bold></highlight>; however, the LED <highlight><bold>105</bold></highlight> and sensors <highlight><bold>130</bold></highlight>, <highlight><bold>130</bold></highlight>&prime; are oriented perpendicular to their orientation in the illustrated embodiment of printer <highlight><bold>20</bold></highlight>. <cross-reference target="DRAWINGS">FIG. 4</cross-reference> shows the desired orientation of the media sensor <highlight><bold>100</bold></highlight> in printer <highlight><bold>20</bold></highlight> with respect to the XYZ coordinate axis system. </paragraph>
<paragraph id="P-0171" lvl="0"><number>&lsqb;0171&rsqb;</number> As the incoming sheet of media <highlight><bold>150</bold></highlight> rests on the ribs <highlight><bold>810</bold></highlight>, <highlight><bold>812</bold></highlight> peaks are formed in the media over the ribs, such as peak <highlight><bold>815</bold></highlight>, and valleys are also formed between the ribs, such as valley <highlight><bold>816</bold></highlight>. The incoming beam <highlight><bold>800</bold></highlight> impacting along the valley <highlight><bold>816</bold></highlight> has an angle of incidence <highlight><bold>818</bold></highlight>, and the specular reflected beam <highlight><bold>802</bold></highlight> has an angle of reflection <highlight><bold>820</bold></highlight>, with angles <highlight><bold>818</bold></highlight> and <highlight><bold>820</bold></highlight> being equal. Similarly, the incoming beam <highlight><bold>804</bold></highlight> has an angle of incidence <highlight><bold>822</bold></highlight>, and its specular reflected beam <highlight><bold>806</bold></highlight> has an angle of reflection <highlight><bold>824</bold></highlight>, with angles <highlight><bold>822</bold></highlight> and <highlight><bold>824</bold></highlight> being equal. Thus, as the incoming light beams <highlight><bold>800</bold></highlight>, <highlight><bold>804</bold></highlight> are moved across the media as the carriage <highlight><bold>40</bold></highlight> moves the media sensor <highlight><bold>100</bold></highlight> across the media in the direction of the scanning axis <highlight><bold>38</bold></highlight>, the light beams <highlight><bold>800</bold></highlight>, <highlight><bold>804</bold></highlight> traverse over the peaks <highlight><bold>815</bold></highlight>, and through the valleys <highlight><bold>816</bold></highlight> which causes the specular reflectance beams <highlight><bold>802</bold></highlight> and <highlight><bold>806</bold></highlight> to modulate with respect to the specular photodiode <highlight><bold>130</bold></highlight>&prime;. Thus, this interaction of the media <highlight><bold>150</bold></highlight> with the cockle ribs <highlight><bold>810</bold></highlight>, <highlight><bold>812</bold></highlight> on the media support platen <highlight><bold>814</bold></highlight> generates a modulating set of information which may be used by the advanced determination method <highlight><bold>500</bold></highlight> to learn more about the sheet of media <highlight><bold>150</bold></highlight> entering the printzone <highlight><bold>25</bold></highlight>. </paragraph>
<paragraph id="P-0172" lvl="7"><number>&lsqb;0172&rsqb;</number> 9. Energy Information </paragraph>
<paragraph id="P-0173" lvl="0"><number>&lsqb;0173&rsqb;</number> Information to identify an incoming sheet of media may be gleaned by knowing the amount of energy supplied by the LED <highlight><bold>105</bold></highlight> and the amount of energy which is received by the specular and diffuse photodiodes <highlight><bold>130</bold></highlight>&prime;, <highlight><bold>130</bold></highlight>. For example, assume that the media <highlight><bold>150</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 24</cross-reference> is a transparency. In this case, some of the incoming light from beam <highlight><bold>800</bold></highlight> passes through the transparency <highlight><bold>150</bold></highlight> as a transmissive beam <highlight><bold>825</bold></highlight>. Thus, the amount of energy left to be received by the diodes <highlight><bold>130</bold></highlight> and <highlight><bold>130</bold></highlight>&prime; is less than for the case of plain paper for instance. In between the plain paper and the transparency paper is the reflectance of the glossy photo media, which has a shinier surface that yields more specular energy to be received by diode <highlight><bold>130</bold></highlight>&prime;, than diffuse energy to be received by photodiode <highlight><bold>130</bold></highlight>. </paragraph>
<paragraph id="P-0174" lvl="0"><number>&lsqb;0174&rsqb;</number> These differences in energy are shown in Table 3 below and provide one way to do a gross sorting of the media into three major categories.  
<table-cwu id="TABLE-US-00003">
<number>3</number>
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217PT" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center">TABLE 3</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry></entry>
</row>
<row><entry namest="1" nameend="1" align="center" rowsep="1"></entry>
</row>
<row>
<entry>Energy Received by Sensors 130 and 130&prime;</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="77PT" align="left"/>
<colspec colname="2" colwidth="63PT" align="center"/>
<colspec colname="3" colwidth="77PT" align="center"/>
<tbody valign="top">
<row>
<entry>Media Category</entry>
<entry>Diffuse Sensor 130</entry>
<entry>Specular Sensor 130&prime;</entry>
</row>
<row><entry namest="1" nameend="3" align="center" rowsep="1"></entry>
</row>
<row>
<entry>Plain &amp; Premium Papers</entry>
<entry>1/2</entry>
<entry>1/2</entry>
</row>
<row>
<entry>Glossy Photo</entry>
<entry>1/3</entry>
<entry>2/3</entry>
</row>
<row>
<entry>Transparency (w/o Tape)</entry>
<entry>1/5</entry>
<entry>4/5</entry>
</row>
<row><entry namest="1" nameend="3" align="center" rowsep="1"></entry>
</row>
</tbody>
</tgroup>
</table>
</table-cwu>
</paragraph>
<paragraph id="P-0175" lvl="0"><number>&lsqb;0175&rsqb;</number> Furthermore, by knowing the input energy supplied by the blue-violet LED <highlight><bold>105</bold></highlight>, and the output energy received by the specular and diffuse sensors <highlight><bold>130</bold></highlight> and <highlight><bold>130</bold></highlight>&prime;, the value of the transmittance property of the media may be determined, that is the amount of energy within light beam <highlight><bold>825</bold></highlight> which passes through media sheet <highlight><bold>150</bold></highlight> (see <cross-reference target="DRAWINGS">FIG. 24</cross-reference>). The magnitude of the transmittance is equal to the input energy of the incoming beam <highlight><bold>800</bold></highlight>, minus the energy of the specular reflected beam <highlight><bold>802</bold></highlight> and the diffuse reflected beam, such as light <highlight><bold>200</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>. After assembly of the printer <highlight><bold>20</bold></highlight>, during initial factory calibration, a sheet of plain paper is fed into the printzone <highlight><bold>25</bold></highlight>, and the amount of input light energy from the LED <highlight><bold>105</bold></highlight> is measured, along with the levels of energy received by the specular and diffuse sensors <highlight><bold>130</bold></highlight>&prime; and <highlight><bold>130</bold></highlight>. Given these known values for plain paper, the transmittance for photo paper and transparency media may then be determined as needed. However, rather than calculating the transmissivity of photo papers and transparency media, the preferred method of distinction between plain or premium paper, photo paper and transparency media is accomplished using the information shown in Table 3. </paragraph>
<paragraph id="P-0176" lvl="0"><number>&lsqb;0176&rsqb;</number> Thus in the case of a transparency, the majority of the diffuse energy travels directly through the transparency, with any ink retention layer coating over the transparency serving to reflect a small amount of diffuse light toward the photodiode <highlight><bold>130</bold></highlight>. The shiny surface of the transparency is a good reflector of light, and thus the specular energy received by photodiode <highlight><bold>130</bold></highlight>&prime; is far greater than the energy received by the diffuse photodiode <highlight><bold>130</bold></highlight>. This energy signature left by these broad categories of media shown in Table 3 may be used in steps <highlight><bold>552</bold></highlight> and <highlight><bold>554</bold></highlight> of the determination system <highlight><bold>500</bold></highlight>. The energy ratios effectively dictate the magnitude of the frequency components. For a given diffuse and specular frequency, the energy balance may be seen by comparing their relative magnitudes. </paragraph>
<paragraph id="P-0177" lvl="7"><number>&lsqb;0177&rsqb;</number> 10. Media Support Interaction Information </paragraph>
<paragraph id="P-0178" lvl="0"><number>&lsqb;0178&rsqb;</number> As mentioned above with respect to <cross-reference target="DRAWINGS">FIG. 24</cross-reference>, interaction of the media with the printer&apos;s media support structure, here the pivot, may be used to gather information about the incoming sheet of media. In other implementations, this information may be gathered in other locations by supporting the media sensor <highlight><bold>100</bold></highlight> with another printing mechanism component, and backing the media opposite the sensor with a component having a known surface irregularity which imparts a degree of bending to the media, as well as changing the apparent transmissivity of the media. For instance, in plotters using media supplied in a continuous roll, a cutter traverses across the media following a print job to sever the printed sheet from the remainder of the supply roll. The sensor <highlight><bold>100</bold></highlight> may be mounted on the cutter carriage to traverse the media, although such a system may require the leading edge of the incoming sheet to be moved rearwardly into a top-of-form position under the printheads following scanning. Indeed, in other implementations, it may be desirable to locate the media scanner <highlight><bold>100</bold></highlight> remote from the printzone <highlight><bold>25</bold></highlight>, such as adjacent the media supply tray, or along the media path between the supply tray and the printzone <highlight><bold>25</bold></highlight>, provided that the media was located between the sensor and a backing or support member having a known surface irregularity opposite the media sensor <highlight><bold>100</bold></highlight>. </paragraph>
<paragraph id="P-0179" lvl="0"><number>&lsqb;0179&rsqb;</number> In the illustrated printer <highlight><bold>20</bold></highlight>, the cockle ribs <highlight><bold>810</bold></highlight> and <highlight><bold>812</bold></highlight> generate a modulating signature as the sensor <highlight><bold>100</bold></highlight> passes over peaks <highlight><bold>815</bold></highlight> and valleys <highlight><bold>816</bold></highlight> on the media sheet <highlight><bold>150</bold></highlight>. The degree of bending of the media sheet <highlight><bold>150</bold></highlight> over the ribs <highlight><bold>810</bold></highlight> and <highlight><bold>812</bold></highlight> is a function of the media&apos;s modulus of elasticity (Young&apos;s Modulus). Thus, the degree of bowing in the media sheet <highlight><bold>150</bold></highlight> may be used to gather additional information about a sheet entering the printzone <highlight><bold>25</bold></highlight>. </paragraph>
<paragraph id="P-0180" lvl="0"><number>&lsqb;0180&rsqb;</number> For example, some premium media have the same surface properties as plain paper media, such as the greeting card media and adhesive-backed sticker media. However, both the sticker media and the greeting card media are thicker than convention plain paper media so the bending signatures of these premium medias are different than the bending signature of plain paper. In particular, the spatial frequency signatures are different at the lower end of the spatial frequency spectrum, particularly in the range of 1.4 to 2.1 cycles per inch. In this lower portion of the spatial frequency spectrum, lower amplitudes are seen for the thicker premium media as well as for glossy photo and matte photo medias. Thus, the signature imparted by the effect of the cockle ribs <highlight><bold>810</bold></highlight>, <highlight><bold>812</bold></highlight> may be used to distinguish premium media and plain paper, such as in steps <highlight><bold>710</bold></highlight> of the determination system <highlight><bold>500</bold></highlight>. It is apparent that other printing mechanisms using different media support strategies in the printzone <highlight><bold>25</bold></highlight>, other than ribs <highlight><bold>810</bold></highlight> and <highlight><bold>812</bold></highlight> or other configurations of media support members may generate their own unique set of properties which may be analyzed to impart a curvature to the media at a known location (S) and this known information then used to study the degree of bending imparted to the different media types. </paragraph>
<paragraph id="P-0181" lvl="7"><number>&lsqb;0181&rsqb;</number> 11. Surface Coating Information </paragraph>
<paragraph id="P-0182" lvl="0"><number>&lsqb;0182&rsqb;</number> While the effect of the cockle ribs <highlight><bold>810</bold></highlight>, <highlight><bold>812</bold></highlight> is manifested in the lower spatial frequencies, such as those lower than approximately 10 cycles per inch, the effect of the surface coatings is seen by analyzing the higher spatial frequencies, such as those in the range of 10-40 cycles per inch. <cross-reference target="DRAWINGS">FIG. 25</cross-reference> illustrates a coated sheet of media <highlight><bold>830</bold></highlight>, having a backing sheet or substrate <highlight><bold>832</bold></highlight> and a coating <highlight><bold>834</bold></highlight>, such as an ink retention layer of a swellable material, or of a porous material, several examples of which are discussed above with respect to Table 2. In <cross-reference target="DRAWINGS">FIG. 25</cross-reference>, we see one incoming light beam <highlight><bold>835</bold></highlight> which travels through the coating layer <highlight><bold>834</bold></highlight> and the substrate <highlight><bold>832</bold></highlight>, and is reflected off of the rib <highlight><bold>810</bold></highlight> as a specular reflected beam <highlight><bold>836</bold></highlight>. Another incoming beam <highlight><bold>838</bold></highlight> from the blue-violet LED <highlight><bold>105</bold></highlight> is shown generating three different types of reflected beams: (1) a group of diffuse beams <highlight><bold>840</bold></highlight> which are received by the diffuse sensor <highlight><bold>130</bold></highlight>, (2) an upper surface reflected specular beam <highlight><bold>842</bold></highlight> which is received by the specular sensor <highlight><bold>130</bold></highlight>&prime;, and (3) a boundary layer specular reflected beam <highlight><bold>844</bold></highlight> which is formed when a portion of the incoming beam <highlight><bold>838</bold></highlight> goes through the coating layer <highlight><bold>834</bold></highlight> and reflects off a boundary <highlight><bold>845</bold></highlight> defined between the substrate <highlight><bold>832</bold></highlight> and the coating layer <highlight><bold>834</bold></highlight>. This boundary <highlight><bold>845</bold></highlight> may also be considered to be the upper surface of the substrate layer <highlight><bold>832</bold></highlight>. </paragraph>
<paragraph id="P-0183" lvl="0"><number>&lsqb;0183&rsqb;</number> The characteristics provided by the boundary reflected beam <highlight><bold>844</bold></highlight> may be used to find information about the type of coating <highlight><bold>834</bold></highlight> which has been applied over the substrate layer <highlight><bold>832</bold></highlight>. For example, the swellable coatings used on the glossy photo media and the slightly glossy premium media described above with respect to Table 2 are typically plastic polymer layers which are clear, to allow one to see the ink droplets trapped inside the ink retention layer <highlight><bold>834</bold></highlight>. Different types of light transmissive solids and liquids have different indices of refraction, which is a basic principle in the study of optics. The index of refraction for a particular material, such as glass, water, quartz, and so forth is determined by the ratio of the speed of light in air versus the speed of light in the particular media. That is, light passing through glass moves at a slower rate than when moving through air. The slowing of the light beam entering a solid or liquid is manifested as a bending of the light beam at the boundary where the beam enters the media, and again at the boundary where the light beam exits the optic media. This change can be seen for a portion <highlight><bold>846</bold></highlight> of the incoming light beam <highlight><bold>838</bold></highlight>. Rather than continuing on the same trajectory as the incoming beam <highlight><bold>838</bold></highlight>, beam <highlight><bold>846</bold></highlight> is slowed by travel through the coating layer <highlight><bold>834</bold></highlight> and thus progresses at a more steep angle toward the boundary layer <highlight><bold>845</bold></highlight> than the angle at which the incoming beam <highlight><bold>838</bold></highlight> encountered the exterior surface of coating layer <highlight><bold>834</bold></highlight>. The angle of incidence of the incoming beam <highlight><bold>846</bold></highlight> is then equal to the angle of reflection of the reflected beam <highlight><bold>848</bold></highlight> with respect to the boundary layer <highlight><bold>845</bold></highlight>. As the reflected beam <highlight><bold>848</bold></highlight> exits the coating layer <highlight><bold>834</bold></highlight>, it progresses at a faster rate in the surrounding air, as indicated by the angle of the remainder of reflected beam <highlight><bold>844</bold></highlight>. </paragraph>
<paragraph id="P-0184" lvl="0"><number>&lsqb;0184&rsqb;</number> Now that the index of refraction is better understood, as the ratio of the speed of light in air versus the speed of light in a particular medium, this information can be used to discover properties of the coating layer <highlight><bold>834</bold></highlight>. As mentioned above, &ldquo;dispersion&rdquo; is the change in the index of refraction with changes in the wavelength of light. In plastics, such as the polymer coatings used in the glossy photo media and some premium medias, this dispersion increases in the ultra-violet light range. Thus, the use of the blue-violet LED <highlight><bold>105</bold></highlight> instead of the blue LED <highlight><bold>120</bold></highlight> advantageously accentuates this dispersion effect. Thus, this dispersion effect introduces another level of modulation which may be used to distinguish between the various types of glossy photo media as the short wavelength ultra-violet light (<cross-reference target="DRAWINGS">FIG. 3</cross-reference>) accentuates the change in the angle of the exiting beam <highlight><bold>844</bold></highlight>, and this information is then used to distinguish specific photo glossy medias. This modulation of the dispersion may be used in step <highlight><bold>574</bold></highlight> of the media determination system <highlight><bold>500</bold></highlight>. </paragraph>
<paragraph id="P-0185" lvl="0"><number>&lsqb;0185&rsqb;</number> Note in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>, that the transmissive beam <highlight><bold>825</bold></highlight> has been drawn with a bit of artistic license, in the fact that the angle of incidence has been ignored as the transmissive beam <highlight><bold>825</bold></highlight> is shown going straight through the sheet <highlight><bold>150</bold></highlight>, although it is now better understood that a more correct illustration which show a steeper path through the sheet of media than through the surrounding air. Before moving on, one further point should be noted concerning the effect of the ribs <highlight><bold>810</bold></highlight>, <highlight><bold>812</bold></highlight> on the information collected by the media sensor <highlight><bold>100</bold></highlight>. <cross-reference target="DRAWINGS">FIG. 24</cross-reference> shows the transmissive beam <highlight><bold>825</bold></highlight> traveling through the sheet of media <highlight><bold>150</bold></highlight> between ribs <highlight><bold>810</bold></highlight> and <highlight><bold>812</bold></highlight>, whereas <cross-reference target="DRAWINGS">FIG. 25</cross-reference> shows an incoming beam <highlight><bold>835</bold></highlight> being reflected off of rib <highlight><bold>810</bold></highlight> as the specular reflected beam <highlight><bold>836</bold></highlight>. While the media shown in <cross-reference target="DRAWINGS">FIG. 25</cross-reference> is a coated substrate, even plain paper will reflect light off of the ribs <highlight><bold>810</bold></highlight> as shown for beam <highlight><bold>836</bold></highlight>. Thus, more light is seen by the specular sensor <highlight><bold>130</bold></highlight>&prime; when the sensor <highlight><bold>100</bold></highlight> passes over a rib <highlight><bold>810</bold></highlight>, <highlight><bold>812</bold></highlight> then the amount of light received when the sensor <highlight><bold>100</bold></highlight> passes through a valley <highlight><bold>816</bold></highlight> between the ribs. The lower energy received when traversing a valley <highlight><bold>816</bold></highlight> is due to the fact that not all of the energy supplied by the incoming beam <highlight><bold>800</bold></highlight> is reflected to sensor <highlight><bold>130</bold></highlight>&prime; at <highlight><bold>802</bold></highlight>, because some of the incoming energy passes through the media <highlight><bold>150</bold></highlight> in the form of the transmissive beam <highlight><bold>825</bold></highlight>. Thus, the variations in energy levels received by the specular sensor <highlight><bold>130</bold></highlight>&prime; varies with respect to the presence or absence of ribs <highlight><bold>810</bold></highlight>, <highlight><bold>812</bold></highlight>. </paragraph>
<paragraph id="P-0186" lvl="0"><number>&lsqb;0186&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 26</cross-reference> illustrates two other methods by which the various types of media may be classified using the determination system <highlight><bold>500</bold></highlight>. In <cross-reference target="DRAWINGS">FIG. 26</cross-reference> we see a multi-layered sheet of media <highlight><bold>850</bold></highlight>, which has a backing or substrate layer <highlight><bold>852</bold></highlight> and a clear swellable coating layer <highlight><bold>854</bold></highlight>. Here we see a substrate layer <highlight><bold>852</bold></highlight> which has a rough surface, forming a rough boundary <highlight><bold>855</bold></highlight> between the coating layer <highlight><bold>854</bold></highlight> and the substrate <highlight><bold>852</bold></highlight>. Depending upon at which point an incoming beam of light <highlight><bold>856</bold></highlight> impacts the boundary layer <highlight><bold>855</bold></highlight>, the resulting reflected specular beam <highlight><bold>858</bold></highlight> has a high modulation as the beam traverses over the rough boundary layer <highlight><bold>855</bold></highlight> as moved by carriage <highlight><bold>40</bold></highlight> parallel to the scanning axis <highlight><bold>38</bold></highlight>. The media <highlight><bold>850</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 26</cross-reference> has a rough backing layer, whereas the illustrated media <highlight><bold>830</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 25</cross-reference> has a backing layer which performs a smooth internal boundary <highlight><bold>845</bold></highlight>. As described above with respect to Table 2, Gossimer media has a swellable polymer coating which is applied over a polymer photo substrate, with the substrate having a smooth surface more resembling media <highlight><bold>830</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 25</cross-reference>. The very glossy media which has two layers of a polymer coating over a plastic backing substrate also has a smooth boundary layer <highlight><bold>845</bold></highlight> as shown in <cross-reference target="DRAWINGS">FIG. 25</cross-reference>. However, the combination photo media has the same polymer coating as the Gossimer media, but this coating is applied over a photo paper, which may have rougher boundary more closely resembling boundary layer <highlight><bold>855</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>. Thus, this information about the boundary layer <highlight><bold>855</bold></highlight> may be used to distinguish between specific types of photo media, such as in step <highlight><bold>674</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 21</cross-reference>) of the determination system <highlight><bold>500</bold></highlight>. </paragraph>
<paragraph id="P-0187" lvl="0"><number>&lsqb;0187&rsqb;</number> The other phenomenon that may be studied with respect to <cross-reference target="DRAWINGS">FIG. 26</cross-reference> is the characteristics of the specular beam reflecting off of the upper surface of the coating layer <highlight><bold>854</bold></highlight>. In <cross-reference target="DRAWINGS">FIG. 26</cross-reference>, an incoming light beam <highlight><bold>860</bold></highlight> is shown reflecting off of an upper surface <highlight><bold>862</bold></highlight> of the coating layer <highlight><bold>854</bold></highlight>, to produce a specular reflected beam <highlight><bold>864</bold></highlight>. As mentioned above, the ink retention layers formed by coatings, such as coating <highlight><bold>854</bold></highlight> are clear layers, which are typically applied using rollers to spread the coating <highlight><bold>854</bold></highlight> over the substrate <highlight><bold>852</bold></highlight>. In the medias under study thus far, it has been found that different manufacturers use different types of rollers to apply these coating layers <highlight><bold>854</bold></highlight>. The uniqueness of each manufacturer&apos;s rollers imparts a unique signature to the upper surface <highlight><bold>862</bold></highlight> of the coating layer <highlight><bold>854</bold></highlight>. That is, during this coating application process, the rollers create waves or ripples on the surface <highlight><bold>862</bold></highlight>, as shown in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>. These ripples along the coating upper surface <highlight><bold>862</bold></highlight> have low magnitude, high frequency signatures which may be used to distinguish the various glossy photo media types. </paragraph>
<paragraph id="P-0188" lvl="0"><number>&lsqb;0188&rsqb;</number> Alternatively, rather than looking for specific modulation signatures in the specular spatial frequency graph, the ripples formed in the upper surface <highlight><bold>862</bold></highlight> also impart a varying thickness to the ink retention layer <highlight><bold>854</bold></highlight>. This varying thickness in the coating layer <highlight><bold>854</bold></highlight> produces changes in the boundary reflected beam <highlight><bold>858</bold></highlight>, as the incoming beam <highlight><bold>856</bold></highlight> and the reflected beam <highlight><bold>858</bold></highlight> traverse through varying thicknesses of the ink retention layer <highlight><bold>854</bold></highlight>. It should be noted here, that the swellable coatings on the photo medias, such as the Gossimer media, the combination media, and the very glossy photo media experience this rippling effect along the coating upper surface <highlight><bold>862</bold></highlight>. In contrast, the porous coatings used on the premium medias, such as the matte photo media, or the clay coated media are very uniform coatings, having substantially no ripple along their upper surfaces, as shown for the media sheet <highlight><bold>830</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 25</cross-reference>. Thus, the surface properties of the coatings may be used to distinguish the swellable coatings which have a rippled or rough upper surface from the porous premium coatings which have very smooth surface characteristics. The one exception in the premium category of Table 2 is the slightly glossy media which has a swellable ink retention layer like coating <highlight><bold>854</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 26</cross-reference>, but which is applied over a plain paper. This slightly glossy media having a swellable ink retention layer (IRL) applied over plain paper may be distinguished from media having a swellable IRL over photo paper by comparing the rough nature of the plain paper and with the smoother surface of the photo paper at the boundary layer <highlight><bold>855</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>. Alternatively, the peaks <highlight><bold>815</bold></highlight> and valleys <highlight><bold>816</bold></highlight> formed by ribs <highlight><bold>810</bold></highlight> and <highlight><bold>812</bold></highlight> may be used to make this distinction, knowing that the photo paper substrate is stiffer and bends less than the plain paper substrate when traveling through the printzone <highlight><bold>25</bold></highlight>, yielding different reflectance signatures. </paragraph>
<paragraph id="P-0189" lvl="0"><number>&lsqb;0189&rsqb;</number> Another advantage of using the ultra-violet LED <highlight><bold>105</bold></highlight>, is that refraction through the polymer coating layers <highlight><bold>834</bold></highlight>, <highlight><bold>854</bold></highlight> increases as the wavelength of the incoming light beams decreases. Thus, by using the shorter wavelength ultra-violet LED <highlight><bold>105</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 3</cross-reference>), the refraction is increased. As the thickness of the coating <highlight><bold>854</bold></highlight> thickens, or the index of the refraction varies, for instance due to composition imperfections in the coating, the short wavelength ultra-violet light refracts through a sufficient angle to move in and out of the field of view of the specular sensor <highlight><bold>130</bold></highlight>&prime;. As shown in <cross-reference target="DRAWINGS">FIGS. 4, 24</cross-reference> and <highlight><bold>25</bold></highlight>-<highlight><bold>26</bold></highlight>, the specular field stop <highlight><bold>140</bold></highlight> has the window <highlight><bold>144</bold></highlight> oriented with the minor axis <highlight><bold>149</bold></highlight> aligned along a central axis of the sensor <highlight><bold>100</bold></highlight>. Thus, the specular field stop <highlight><bold>140</bold></highlight> provides a very small field of view in the axis of illumination, which is shown parallel to the page in FIGS. <highlight><bold>24</bold></highlight>-<highlight><bold>26</bold></highlight>. Thus, this modulation of the specular reflected beams <highlight><bold>802</bold></highlight>, <highlight><bold>858</bold></highlight> and <highlight><bold>864</bold></highlight> is more acutely sensed by the specular photodiode <highlight><bold>130</bold></highlight>&prime; as these beams move in and out of the field stop window <highlight><bold>144</bold></highlight>. </paragraph>
<paragraph id="P-0190" lvl="7"><number>&lsqb;0190&rsqb;</number> 12. Raw Data Analysis </paragraph>
<paragraph id="P-0191" lvl="0"><number>&lsqb;0191&rsqb;</number> Now it is better understood how the advanced media determination system <highlight><bold>500</bold></highlight> uses the data collected by the media sensor <highlight><bold>100</bold></highlight>, several examples of raw data collected for various media types will be discussed with respect to FIGS. <highlight><bold>27</bold></highlight>-<highlight><bold>33</bold></highlight>. The next section will discuss the resulting Fourier spectrum components which are generated from this raw data in the massaging data routine <highlight><bold>504</bold></highlight>. </paragraph>
<paragraph id="P-0192" lvl="0"><number>&lsqb;0192&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 27</cross-reference> shows the raw data collected during routine <highlight><bold>502</bold></highlight> for the very glossy photo media. Here we see the specular data curve <highlight><bold>870</bold></highlight>. <cross-reference target="DRAWINGS">FIG. 27</cross-reference> also shows a diffuse curve <highlight><bold>872</bold></highlight>. <cross-reference target="DRAWINGS">FIG. 28</cross-reference> shows the raw data for a glossy photo media, and in particular Gossimer, with a specular data being shown by curve <highlight><bold>874</bold></highlight>, and the diffuse data being shown by curve <highlight><bold>876</bold></highlight>. <cross-reference target="DRAWINGS">FIG. 29</cross-reference> shows the raw data for a matte photo media, with the specular data being shown as curve <highlight><bold>878</bold></highlight>, and the diffuse data shown as curve <highlight><bold>880</bold></highlight>. <cross-reference target="DRAWINGS">FIG. 30</cross-reference> shows the raw data for a plain paper media, specifically Gilbert&reg; bond media, with the specular data being shown as curve <highlight><bold>882</bold></highlight>, and the diffuse data being shown as curve <highlight><bold>884</bold></highlight>. <cross-reference target="DRAWINGS">FIG. 31</cross-reference> shows the raw data for a premium media, with the specular data being shown as curve <highlight><bold>886</bold></highlight>, and the diffuse data being shown as curve <highlight><bold>887</bold></highlight>. <cross-reference target="DRAWINGS">FIG. 32</cross-reference> shows the raw data for HP transparency media, with the specular data being shown as curve <highlight><bold>888</bold></highlight>, and the diffuse data being shown as curve <highlight><bold>889</bold></highlight>. <cross-reference target="DRAWINGS">FIG. 33</cross-reference> shows the raw data for a generic transparency media, with the specular data being shown as curve <highlight><bold>890</bold></highlight>, and the diffuse data being shown as curve <highlight><bold>892</bold></highlight>. </paragraph>
<paragraph id="P-0193" lvl="0"><number>&lsqb;0193&rsqb;</number> As described above with respect to Table 2, the very glossy photo media has two layers of a swellable polymer applied over a plastic backing substrate layer, resembling the media <highlight><bold>850</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>. The specular curve <highlight><bold>870</bold></highlight> of the very glossy photo media (<cross-reference target="DRAWINGS">FIG. 27</cross-reference>) has much greater swings in amplitude than the specular curve <highlight><bold>874</bold></highlight> for the glossy (Gossimer) photo media of <cross-reference target="DRAWINGS">FIG. 28</cross-reference> due to the double polymer coating layer on the very glossy media. Thus, the specular curves <highlight><bold>870</bold></highlight> and <highlight><bold>874</bold></highlight> may be used to distinguish the very glossy photo media from glossy photo media, while the diffuse <highlight><bold>872</bold></highlight> and <highlight><bold>876</bold></highlight> are roughly the same magnitude and shape, although the very glossy photo media curve <highlight><bold>872</bold></highlight> has a slightly greater amplitude than the glossy photo media diffuse curve <highlight><bold>876</bold></highlight>. </paragraph>
<paragraph id="P-0194" lvl="0"><number>&lsqb;0194&rsqb;</number> In comparing the curves of <cross-reference target="DRAWINGS">FIGS. 27 and 28</cross-reference> with the matte photo curves of <cross-reference target="DRAWINGS">FIG. 29</cross-reference>, it can be seen that the specular reflectance curve <highlight><bold>878</bold></highlight> for the photo media resides at a much lower amplitude than either of the photo media specular curves <highlight><bold>870</bold></highlight> and <highlight><bold>874</bold></highlight>. Moreover, there is less variation or amplitude change within the matte photo specular curve <highlight><bold>878</bold></highlight>, which is to be expected because the porous coating over the matte photo substrate, which is a paper substrate, has a much smoother surface than the swellable coatings applied over the glossy and very glossy photo media, as discussed above with respect to <cross-reference target="DRAWINGS">FIGS. 25 and 26</cross-reference>. The diffuse curve <highlight><bold>880</bold></highlight> for the matte photo media is of similar shape to the diffuse curves <highlight><bold>872</bold></highlight> and <highlight><bold>876</bold></highlight> for the very glossy and glossy photo medias, although the amplitude of the matte photo diffuse curve <highlight><bold>880</bold></highlight> is closer to the amplitude of the very glossy diffuse curve <highlight><bold>872</bold></highlight>. </paragraph>
<paragraph id="P-0195" lvl="0"><number>&lsqb;0195&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 30</cross-reference> has curves <highlight><bold>882</bold></highlight> and <highlight><bold>884</bold></highlight> which are very different from the curves shown in FIGS. <highlight><bold>27</bold></highlight>-<highlight><bold>29</bold></highlight>. One of the major differences in the curves of <cross-reference target="DRAWINGS">FIG. 42</cross-reference> versus the curves of FIGS. <highlight><bold>27</bold></highlight>-<highlight><bold>29</bold></highlight> is that the specular curve <highlight><bold>882</bold></highlight> is lower in magnitude than the diffuse curve <highlight><bold>884</bold></highlight>, which is the opposite of the orientations shown in FIGS. <highlight><bold>27</bold></highlight>-<highlight><bold>29</bold></highlight> where the specular curves <highlight><bold>870</bold></highlight>, <highlight><bold>874</bold></highlight> and <highlight><bold>878</bold></highlight> are of greater amplitude than the diffuse curves <highlight><bold>872</bold></highlight>, <highlight><bold>876</bold></highlight> and <highlight><bold>880</bold></highlight>, respectively. Indeed, use of the relative magnitudes of the specular and diffuse curves of FIGS. <highlight><bold>27</bold></highlight>-<highlight><bold>30</bold></highlight> has been described above with respect to Table 3. Another significant difference in the plain paper curves <highlight><bold>882</bold></highlight>-<highlight><bold>884</bold></highlight> is the similarity in wave form shapes of the specular and diffuse curves <highlight><bold>882</bold></highlight>, <highlight><bold>884</bold></highlight>. In FIGS. <highlight><bold>27</bold></highlight>-<highlight><bold>29</bold></highlight>, there is a vast difference in the shapes of the specular curves <highlight><bold>870</bold></highlight>, <highlight><bold>874</bold></highlight> and <highlight><bold>878</bold></highlight> versus the diffuse curves <highlight><bold>872</bold></highlight>, <highlight><bold>876</bold></highlight> and <highlight><bold>880</bold></highlight>. </paragraph>
<paragraph id="P-0196" lvl="0"><number>&lsqb;0196&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 31</cross-reference> shows the reflectances for a premium media. While the premium specular and diffuse curves <highlight><bold>886</bold></highlight> and <highlight><bold>887</bold></highlight> most closely resemble the plain paper curves <highlight><bold>882</bold></highlight> and <highlight><bold>884</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 30</cross-reference>, they can be distinguished from one another, and indeed they are in the match signature step <highlight><bold>740</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 23</cross-reference>. A close examination of the specular curves <highlight><bold>882</bold></highlight> and <highlight><bold>886</bold></highlight> shows that the premium specular curve <highlight><bold>886</bold></highlight> is much smoother than the plain paper specular curve <highlight><bold>882</bold></highlight>. This smoother curve <highlight><bold>886</bold></highlight> is to be expected due to the smoother IRL surface coating on the premium media versus the rougher non-coated plain paper. </paragraph>
<paragraph id="P-0197" lvl="0"><number>&lsqb;0197&rsqb;</number> At this point it should be noted that the relative magnitudes of the specular and diffuse curves may be adjusted to desired ranges by modifying the media sensor <highlight><bold>100</bold></highlight>. For instance, by changing the size of the field stop windows <highlight><bold>526</bold></highlight> and <highlight><bold>528</bold></highlight>, more or less light will reach the photodiode sensors <highlight><bold>130</bold></highlight>&prime; and <highlight><bold>130</bold></highlight>, so the magnitude of the resulting reflectance curves will shift up or down on the reflectance graphs <highlight><bold>39</bold></highlight>-<highlight><bold>45</bold></highlight>. This magnitude shift may also be accomplished through other means, such as by adjusting the gain of the amplifier circuitry. Indeed, the magnitude of the curves may be adjusted to the point where the specular and diffuse curves actually switch places on the graphs. For instance in <cross-reference target="DRAWINGS">FIG. 31</cross-reference>, by downsizing the specular field stop window <highlight><bold>526</bold></highlight>, the magnitude of the specular curve <highlight><bold>886</bold></highlight> may be dropped from the illustrated 475-count range to a position closer to the 225-count range. Such a change in the field stop size or the amplifier gain would of course also affect the other reflectance curves in FIGS. <highlight><bold>27</bold></highlight>-<highlight><bold>30</bold></highlight> and <highlight><bold>32</bold></highlight>-<highlight><bold>33</bold></highlight>. </paragraph>
<paragraph id="P-0198" lvl="0"><number>&lsqb;0198&rsqb;</number> <cross-reference target="DRAWINGS">FIGS. 32 and 33</cross-reference> show the reflectances of an HP transparency media with a tape header <highlight><bold>456</bold></highlight>, and a transparency media without a tape header, respectively. <cross-reference target="DRAWINGS">FIG. 32</cross-reference> shows a specular curve <highlight><bold>888</bold></highlight> and a diffuse curve <highlight><bold>889</bold></highlight>. <cross-reference target="DRAWINGS">FIG. 33</cross-reference> shows a specular curve <highlight><bold>890</bold></highlight>, and a diffuse curve <highlight><bold>892</bold></highlight>. In both <cross-reference target="DRAWINGS">FIGS. 32 and 33</cross-reference>, the specular curves <highlight><bold>888</bold></highlight> and <highlight><bold>890</bold></highlight> lie above the diffuse curves <highlight><bold>889</bold></highlight> and <highlight><bold>892</bold></highlight>. However, the magnitude of the signals received by the transparency with reflective tape in <cross-reference target="DRAWINGS">FIG. 32</cross-reference> are much greater than the magnitudes of the transparency without the reflective tape in <cross-reference target="DRAWINGS">FIG. 33</cross-reference>, which is to be expected due to the transmissive loss through the transparency without tape, leaving less light to be received by sensors <highlight><bold>130</bold></highlight> and <highlight><bold>130</bold></highlight>&prime; when viewing a plain transparency. </paragraph>
<paragraph id="P-0199" lvl="0"><number>&lsqb;0199&rsqb;</number> Besides the relative magnitudes between the graphs of <cross-reference target="DRAWINGS">FIGS. 32 and 33</cross-reference> there is a vast difference in the diffuse waveform <highlight><bold>889</bold></highlight> and <highlight><bold>892</bold></highlight>, although the specular waveforms have roughly the same shape, with the location of ribs <highlight><bold>810</bold></highlight>, <highlight><bold>812</bold></highlight> being shown at wave crest <highlight><bold>894</bold></highlight> in <cross-reference target="DRAWINGS">FIGS. 32 and 33</cross-reference>. Regarding the diffuse waveforms <highlight><bold>889</bold></highlight> and <highlight><bold>892</bold></highlight>, the HP transparency media with the tape header has a relatively level curve <highlight><bold>889</bold></highlight> because the undersurface of the tape is reflecting the incoming beams back up toward the diffuse sensor <highlight><bold>130</bold></highlight>. The diffuse waveform of <cross-reference target="DRAWINGS">FIG. 33</cross-reference> is more interesting due to the transmissive loss experienced by the incoming beam, such as beam <highlight><bold>800</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>, losing energy in the form of the transmissive beam <highlight><bold>825</bold></highlight> leaving less energy available to reflect off the media surface upwardly into the diffuse sensor <highlight><bold>130</bold></highlight>. Indeed, the locations of the valleys <highlight><bold>816</bold></highlight> between ribs <highlight><bold>810</bold></highlight> and <highlight><bold>812</bold></highlight> are shown at point <highlight><bold>895</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 33</cross-reference>, and the ribs are shown at point <highlight><bold>896</bold></highlight>. Another interesting feature of the media support structure of printer <highlight><bold>20</bold></highlight> is the inclusion of one or more kicker or pusher members in the paper handling system <highlight><bold>24</bold></highlight>. These kickers are used to push an exiting sheet of media onto the media drying wings <highlight><bold>28</bold></highlight>. To allow these kicker members to engage the media and push an exiting sheet out of the printzone, the platen <highlight><bold>814</bold></highlight> is constructed with a kicker slot or gap, such as slot <highlight><bold>897</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>. As the optical sensor <highlight><bold>100</bold></highlight> transitions over the slot <highlight><bold>897</bold></highlight>, the transmissive loss caused by beam <highlight><bold>825</bold></highlight> increases, leaving even less light available to be received by the diffuse sensor <highlight><bold>130</bold></highlight>, resulting in a very large valley or canyon appearing in the diffuse waveform <highlight><bold>892</bold></highlight> at location <highlight><bold>898</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 33</cross-reference>. </paragraph>
<paragraph id="P-0200" lvl="0"><number>&lsqb;0200&rsqb;</number> Thus, from a comparison of the graphs of FIGS. <highlight><bold>27</bold></highlight>-<highlight><bold>33</bold></highlight>, a variety of distinctions may be easily made to separate the various major categories of media by merely analyzing the raw data collected by sensor <highlight><bold>100</bold></highlight>. </paragraph>
<paragraph id="P-0201" lvl="7"><number>&lsqb;0201&rsqb;</number> 13. Spatial Frequency Analysis </paragraph>
<paragraph id="P-0202" lvl="0"><number>&lsqb;0202&rsqb;</number> To find out more information about the media, the massage data routine <highlight><bold>504</bold></highlight> uses the raw data of FIGS. <highlight><bold>27</bold></highlight>-<highlight><bold>33</bold></highlight> in steps <highlight><bold>552</bold></highlight> and <highlight><bold>554</bold></highlight> to generate the Fourier spectrum components, such as those illustrated in FIGS. <highlight><bold>34</bold></highlight>-<highlight><bold>39</bold></highlight>. In steps <highlight><bold>546</bold></highlight> and <highlight><bold>548</bold></highlight>, the massage data routine <highlight><bold>504</bold></highlight> generated the curves shown in FIGS. <highlight><bold>27</bold></highlight>-<highlight><bold>33</bold></highlight>. <cross-reference target="DRAWINGS">FIGS. 34 and 35</cross-reference> show the Fourier spectrum components for the diffuse reflection and the specular reflection, respectively, of a premium media, here the matte photo media. <cross-reference target="DRAWINGS">FIGS. 36 and 37</cross-reference> show the Fourier spectrum components for the diffuse reflection and the specular reflection, respectively, of a premium media, here the very glossy photo media. <cross-reference target="DRAWINGS">FIGS. 38 and 39</cross-reference> show the Fourier spectrum components for the diffuse reflection and the specular reflection, respectively, of a premium media, here the plain paper media, specifically, Gilbert&reg; bond. </paragraph>
<paragraph id="P-0203" lvl="0"><number>&lsqb;0203&rsqb;</number> In comparing the graphs of FIGS. <highlight><bold>34</bold></highlight>-<highlight><bold>39</bold></highlight>, remember to compare the values for the diffuse reflection with the other diffuse reflection curves (<cross-reference target="DRAWINGS">FIGS. 34, 36</cross-reference> and <highlight><bold>38</bold></highlight>) and to compare the specular reflection curves with other specular reflection curves (<cross-reference target="DRAWINGS">FIGS. 35, 37</cross-reference> and <highlight><bold>39</bold></highlight>). For instance, to distinguish between the matte photo media and the very glossy photo media, the frequency of 10 cycles per inch for the specular curves of <cross-reference target="DRAWINGS">FIGS. 35 and 37</cross-reference> may be compared. In <cross-reference target="DRAWINGS">FIG. 35</cross-reference>, the matte photo has a frequency magnitude of around 10 counts as shown at item number <highlight><bold>888</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 35</cross-reference>. In comparison, in <cross-reference target="DRAWINGS">FIG. 37</cross-reference> for the very glossy photo media, the frequency magnitude at a spatial frequency of 10 cycles per inch is nearly a magnitude of 42 counts, as indicated by item number <highlight><bold>889</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 37</cross-reference>. </paragraph>
<paragraph id="P-0204" lvl="0"><number>&lsqb;0204&rsqb;</number> A better representation of the Fourier spectrum components for five basic media types is shown by the graphs of <cross-reference target="DRAWINGS">FIGS. 40 and 41</cross-reference>. In the graphs of <cross-reference target="DRAWINGS">FIGS. 40 and 41</cross-reference>, the various data points shown correspond to selected frequency magnitude peaks taken from generic bar graphs like those shown in FIGS. <highlight><bold>34</bold></highlight>-<highlight><bold>39</bold></highlight> for the Fourier spectrum components. Thus, the points shown in the graphs of <cross-reference target="DRAWINGS">FIGS. 40 and 41</cross-reference> represent maximum frequency magnitudes corresponding to selected spatial frequencies up to 40 cycles per inch, which comprises the useful data employed by the advanced determination system <highlight><bold>500</bold></highlight>. In <cross-reference target="DRAWINGS">FIGS. 40 and 41</cross-reference>, selected spectrum components are shown for five generic types of media: plain paper media, premium media, matte photo media, glossy photo media, transparency media, each of the graphs in <cross-reference target="DRAWINGS">FIGS. 40 and 41</cross-reference> has a left half corresponding to low spatial frequency values, toward the left, and high frequency spatial values toward the right, with the border between the low frequency and high frequency portions of each graph occurring around 10 or 20 cycles per inch </paragraph>
<paragraph id="P-0205" lvl="0"><number>&lsqb;0205&rsqb;</number> Now that the roadmap of the media determination method <highlight><bold>500</bold></highlight> has been laid out with respect to FIGS. <highlight><bold>15</bold></highlight>-<highlight><bold>23</bold></highlight>, as well as the intricacies of the manner in which information is extracted from the media with respect to FIGS. <highlight><bold>24</bold></highlight>-<highlight><bold>39</bold></highlight>, the interrelation between the roadmap and these intricacies will be described. Indeed, to draw on the roadmap analogy, the various branches in the major category determinations and specific type determinations of FIGS. <highlight><bold>20</bold></highlight>-<highlight><bold>23</bold></highlight> may be considered as branches or forks in the road, with the various schemes used to make these determinations considered to be points of interest along our journey. </paragraph>
<paragraph id="P-0206" lvl="0"><number>&lsqb;0206&rsqb;</number> Table 4 below lists some of our various points of interest and destinations where our journey may end, that is ending by selecting a specific type of media.  
<table-cwu id="TABLE-US-00004">
<number>4</number>
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217PT" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center">TABLE 4</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry></entry>
</row>
<row><entry namest="1" nameend="1" align="center" rowsep="1"></entry>
</row>
<row>
<entry>Media Determinations</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="1" colwidth="14PT" align="left"/>
<colspec colname="2" colwidth="91PT" align="left"/>
<colspec colname="3" colwidth="42PT" align="left"/>
<colspec colname="4" colwidth="70PT" align="left"/>
<tbody valign="top">
<row>
<entry></entry>
<entry></entry>
<entry>FIG. No.</entry>
<entry></entry>
</row>
<row>
<entry>&num;</entry>
<entry>Medias Compared</entry>
<entry>- Step No.</entry>
<entry>Result</entry>
</row>
<row><entry namest="1" nameend="4" align="center" rowsep="1"></entry>
</row>
<row>
<entry>&ensp;1</entry>
<entry>Transparency (Tape or Not)</entry>
<entry>&ensp;8-426, 430</entry>
<entry>No Tape Transp.</entry>
</row>
<row>
<entry>&ensp;2</entry>
<entry>Photo vs. Transparency</entry>
<entry>20-626, 636</entry>
<entry>Tape Transparency</entry>
</row>
<row>
<entry>&ensp;3</entry>
<entry>Glossy Photo vs. Matte Photo</entry>
<entry>21-668</entry>
<entry>Glossy Photo</entry>
</row>
<row>
<entry>&ensp;4</entry>
<entry>Plain vs. Premium vs. Matte</entry>
<entry>22-706</entry>
<entry>Matte Photo</entry>
</row>
<row>
<entry>&ensp;5</entry>
<entry>Plain vs. Premium</entry>
<entry>23-746, 772</entry>
<entry>Premium Paper</entry>
</row>
<row>
<entry>&ensp;6</entry>
<entry>Plain vs. Premium</entry>
<entry>23-746, 748</entry>
<entry>Plain Paper</entry>
</row>
<row>
<entry>&ensp;7</entry>
<entry>Matte Swellable vs.</entry>
<entry>22-715</entry>
<entry>Swellable IRL Matte</entry>
</row>
<row>
<entry></entry>
<entry>Matte Porous</entry>
</row>
<row>
<entry>&ensp;8</entry>
<entry>Matte Swellable vs.</entry>
<entry>22-715</entry>
<entry>Porous IRL Matte</entry>
</row>
<row>
<entry></entry>
<entry>Matte Porous</entry>
</row>
<row>
<entry>&ensp;9</entry>
<entry>Very Glossy vs. Glossy Photo</entry>
<entry>21-674</entry>
<entry>Very Glossy Photo</entry>
</row>
<row>
<entry>10</entry>
<entry>Very Glossy vs. Glossy Photo</entry>
<entry>21-674</entry>
<entry>Glossy Photo</entry>
</row>
<row><entry namest="1" nameend="4" align="center" rowsep="1"></entry>
</row>
</tbody>
</tgroup>
</table>
</table-cwu>
</paragraph>
<paragraph id="P-0207" lvl="0"><number>&lsqb;0207&rsqb;</number> The graphs of FIGS. <highlight><bold>40</bold></highlight>-<highlight><bold>43</bold></highlight> have been broken down into four quadrants, with the generic diffuse spatial frequency graphs of <cross-reference target="DRAWINGS">FIGS. 40 and 42</cross-reference> having: (1) a first quadrant <highlight><bold>900</bold></highlight> which has a low frequency and high magnitude, (2) a second quadrant <highlight><bold>902</bold></highlight> which has a high frequency and high magnitude, (3) a third quadrant <highlight><bold>904</bold></highlight> which has a low frequency and low magnitude, and a fourth quadrant <highlight><bold>906</bold></highlight> which has a high frequency and low magnitude. The generic specular spatial frequency graphs of <cross-reference target="DRAWINGS">FIGS. 41 and 43</cross-reference> have four quadrants: (1) a first quadrant <highlight><bold>910</bold></highlight> which has a low frequency and a low magnitude, (2) a second quadrant <highlight><bold>912</bold></highlight> which has a high frequency and high magnitude, (3) a third quadrant <highlight><bold>914</bold></highlight> which has a low frequency and high magnitude, and a fourth quadrant <highlight><bold>916</bold></highlight> which has a high frequency and low magnitude. </paragraph>
<paragraph id="P-0208" lvl="0"><number>&lsqb;0208&rsqb;</number> By comparing the data for the various types of media shown in the graphs of FIGS. <highlight><bold>40</bold></highlight>-<highlight><bold>43</bold></highlight>, the determinations made in operations &num;<highlight><bold>3</bold></highlight>-<highlight><bold>10</bold></highlight> of Table 4 may be determined. Other more basic data as described earlier may be used to determine whether an incoming sheet of media is a transparency (&Dgr;), with or without a tape header as described earlier, according to operations &num;<highlight><bold>1</bold></highlight> and &num;<highlight><bold>2</bold></highlight> of Table 4. Table 5 below shows which quadrant of which graph is used to determine the media types of operations &num;<highlight><bold>3</bold></highlight>-<highlight><bold>10</bold></highlight> of Table 4.  
<table-cwu id="TABLE-US-00005">
<number>5</number>
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217PT" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center">TABLE 5</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry></entry>
</row>
<row><entry namest="1" nameend="1" align="center" rowsep="1"></entry>
</row>
<row>
<entry>Media Categorization Steps by Region</entry>
</row>
<row>
<entry>of Spatial Frequency Graphs (FIGS. 40-43)</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="OFFSET" colwidth="21PT" align="left"/>
<colspec colname="1" colwidth="49PT" align="left"/>
<colspec colname="2" colwidth="70PT" align="left"/>
<colspec colname="3" colwidth="77PT" align="left"/>
<tbody valign="top">
<row>
<entry></entry>
<entry>Graph</entry>
<entry>Low Frequency</entry>
<entry>High Frequency</entry>
</row>
<row>
<entry></entry>
<entry namest="OFFSET" nameend="3" align="center" rowsep="1"></entry>
</row>
<row>
<entry></entry>
<entry>Diffuse</entry>
<entry><highlight><uline>High Magnitude</uline></highlight></entry>
<entry><highlight><uline>High Magnitude</uline></highlight></entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry>(Region &num;900)</entry>
<entry>(Region &num;902)</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry>5</entry>
<entry>&mdash;</entry>
</row>
<row>
<entry></entry>
<entry>Diffuse</entry>
<entry><highlight><uline>Low Magnitude</uline></highlight></entry>
<entry><highlight><uline>Low Magnitude</uline></highlight></entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry>(Region &num;904)</entry>
<entry>(Region &num;906)</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry>6 (maybe 3)</entry>
<entry>7 and 8</entry>
</row>
<row>
<entry></entry>
<entry>Specular</entry>
<entry><highlight><uline>High Magnitude</uline></highlight></entry>
<entry><highlight><uline>High Magnitude</uline></highlight></entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry>(Region &num;910)</entry>
<entry>(Region &num;912)</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry>3, 9 and 10</entry>
<entry>&mdash;</entry>
</row>
<row>
<entry></entry>
<entry>Specular</entry>
<entry><highlight><uline>Low Magnitude</uline></highlight></entry>
<entry><highlight><uline>Low Magnitude</uline></highlight></entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry>(Region &num;914)</entry>
<entry>(Region &num;916)</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry>4</entry>
<entry>&mdash;</entry>
</row>
<row>
<entry></entry>
<entry namest="OFFSET" nameend="3" align="center" rowsep="1"></entry>
</row>
</tbody>
</tgroup>
</table>
</table-cwu>
</paragraph>
<paragraph id="P-0209" lvl="0"><number>&lsqb;0209&rsqb;</number> In the third operation (&num;<highlight><bold>3</bold></highlight>) of Table 4, the distinction between glossy photo media and matte photo media may be made by examining the data in quadrant <highlight><bold>904</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 40</cross-reference>, or in quadrants <highlight><bold>910</bold></highlight> and <highlight><bold>914</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 41</cross-reference>. In <cross-reference target="DRAWINGS">FIG. 40</cross-reference>, the magnitude of the matte photo spatial frequencies (X) are greater than the magnitude of the glossy photo spatial frequencies (&diam;). Perhaps even better than <cross-reference target="DRAWINGS">FIG. 40</cross-reference>, the difference is shown in <cross-reference target="DRAWINGS">FIG. 41</cross-reference> for the specular spatial frequencies, where we find the matte photo spatial frequencies (X) falling within quadrant <highlight><bold>914</bold></highlight>, and the glossy photo (&diam;) spatial frequencies falling in quadrant <highlight><bold>910</bold></highlight>. Thus, while the information supplied by the diffuse sensor <highlight><bold>130</bold></highlight> may be used to make a determination between glossy and matte photos, as shown in <cross-reference target="DRAWINGS">FIG. 41, a</cross-reference> much clearer distinction is made using the data collected by the specular sensor <highlight><bold>130</bold></highlight>&prime;, as shown with respect to <cross-reference target="DRAWINGS">FIG. 41</cross-reference>. </paragraph>
<paragraph id="P-0210" lvl="0"><number>&lsqb;0210&rsqb;</number> In operation &num;<highlight><bold>4</bold></highlight> of Table 4, the method distinguishes between plain paper versus premium paper versus matte photo. This distinction may be accomplished again using the data in quadrant <highlight><bold>914</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 41</cross-reference>. In quadrant <highlight><bold>914</bold></highlight>, we see the matte photo (X) spatial frequencies are far greater in magnitude than the plain paper (&square;) spatial frequencies, and the premium paper (&xcirc;) spatial frequencies. Thus, the selection of matte media in operation &num;<highlight><bold>4</bold></highlight> is quite simple. </paragraph>
<paragraph id="P-0211" lvl="0"><number>&lsqb;0211&rsqb;</number> In operations &num;<highlight><bold>5</bold></highlight> and &num;<highlight><bold>6</bold></highlight> of Table 4, the characteristics of plain paper and premium paper are compared. Referring to the diffuse spatial frequency graph of <cross-reference target="DRAWINGS">FIG. 40</cross-reference>, the premium paper (&xcirc;) spatial frequencies appear in quadrant <highlight><bold>904</bold></highlight>, whereas the plain paper (&square;) spatial frequencies appear in quadrant <highlight><bold>900</bold></highlight>. </paragraph>
<paragraph id="P-0212" lvl="0"><number>&lsqb;0212&rsqb;</number> Following operation &num;<highlight><bold>6</bold></highlight> of Table 4, a sheet of media entering printzone <highlight><bold>25</bold></highlight> has been classified according to its major category type: transparency (with or without a header tape), glossy photo media, matte photo media, premium paper, or plain paper. Note that in the original Table 2 above, matte photo was discussed as a sub-category of premium medias, but to the various characteristics of matte photo media more readily lend themselves to a separate analysis when working through the major category and specific type determination routines <highlight><bold>506</bold></highlight> and <highlight><bold>508</bold></highlight>, as illustrated in detail with respect to FIGS. <highlight><bold>20</bold></highlight>-<highlight><bold>23</bold></highlight>. </paragraph>
<paragraph id="P-0213" lvl="0"><number>&lsqb;0213&rsqb;</number> Following determination of these major categories, to provide even better results in terms of the image ultimately printed on a sheet of media, it would be desirable to make at least two specific type determinations. While other distinctions may be made between specific types of media, such as between specific types of plain paper (<cross-reference target="DRAWINGS">FIG. 23</cross-reference>, table <highlight><bold>754</bold></highlight>) in practice so far, no particular advantage has been found which would encourage different printing routines for the different types of plain paper media because basically, of the plain paper medias studied thus far, they all provide comparable results when printed upon according to a plain paper default print mode (&ldquo;0,0&rdquo;), as shown in step <highlight><bold>770</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 23</cross-reference>. However, if in the future it becomes desirable to tailor print routines for different types of plain paper, the method <highlight><bold>500</bold></highlight> has been designed to allow for this option, by including steps <highlight><bold>760</bold></highlight> and <highlight><bold>764</bold></highlight> to allow for tailored plain paper print modes (<cross-reference target="DRAWINGS">FIG. 23</cross-reference>). Two of the major categories, specifically matte photo and glossy photo lend themselves better to specific type media determinations, allowing for different print modes. </paragraph>
<paragraph id="P-0214" lvl="0"><number>&lsqb;0214&rsqb;</number> The specific type determinations will be made according to the data shown in <cross-reference target="DRAWINGS">FIGS. 42 and 43</cross-reference>. Thus, operations &num;<highlight><bold>7</bold></highlight> and &num;<highlight><bold>8</bold></highlight> of Table 4 are used to distinguish matte photo medias having swellable coatings from those having porous coatings. The matte photo (X) data from <cross-reference target="DRAWINGS">FIGS. 40 and 41</cross-reference> has been carried over into <cross-reference target="DRAWINGS">FIGS. 42 and 43</cross-reference>. The matte photo data depicted with the X&apos;s in FIGS. <highlight><bold>40</bold></highlight>-<highlight><bold>43</bold></highlight> is for a swellable coating, or ink retention layer (&ldquo;IRL&rdquo;). The specular frequencies for a matte photo media with a porous coating or IRL is shown in <cross-reference target="DRAWINGS">FIGS. 42 and 43</cross-reference> as &ldquo;&diams;&rdquo;. While the specular data of <cross-reference target="DRAWINGS">FIG. 43</cross-reference> could be used to distinguish the matte photo swellable coatings (X) from the porous coatings (&diams;), the diffuse data shown in quadrant <highlight><bold>906</bold></highlight> lends itself to an easier distinction. In quadrant <highlight><bold>906</bold></highlight>, we see the swellable coating matte photo (X) spatial frequencies as having a magnitude greater than the matte photo porous coated media (&diams;). Thus, the information in quadrant <highlight><bold>906</bold></highlight> best lends itself for making the determination of operations &num;<highlight><bold>7</bold></highlight> and &num;<highlight><bold>8</bold></highlight> in Table 4. </paragraph>
<paragraph id="P-0215" lvl="0"><number>&lsqb;0215&rsqb;</number> The other desired specific type media distinction is between glossy photo media (Gossimer) and very glossy photo media (double polymer IRL coatings). While the diffuse data of <cross-reference target="DRAWINGS">FIG. 42</cross-reference> could be used to determine the distinction between the very glossy media (&Circlesolid;) and the glossy Gossimer media (*), an easier distinction is made with respect to the specular data shown in <cross-reference target="DRAWINGS">FIG. 43</cross-reference>. As shown in quadrant <highlight><bold>910</bold></highlight>, the very glossy (&Circlesolid;) specular frequencies have a greater magnitude than the glossy Gossimer (*) spatial frequencies. Thus, the data shown in quadrant <highlight><bold>910</bold></highlight> allows for the distinctions made in the ninth and tenth operations &num;<highlight><bold>9</bold></highlight> and &num;<highlight><bold>10</bold></highlight> of Table 4. </paragraph>
<paragraph id="P-0216" lvl="7"><number>&lsqb;0216&rsqb;</number> 14. Early Transparency Detection System </paragraph>
<paragraph id="P-0217" lvl="0"><number>&lsqb;0217&rsqb;</number> While the advanced media determination system <highlight><bold>500</bold></highlight> described above with respect to FIGS. <highlight><bold>15</bold></highlight>-<highlight><bold>23</bold></highlight> works well in general, a refinement concerning transparency detection speeds may be implemented by performing a quick initial scan of the media to determine whether it may be a transparency, either with or without a tape header <highlight><bold>456</bold></highlight>. In using the advanced media determination system <highlight><bold>500</bold></highlight> as described thus far, in practice it was found that occasionally non-transparency media was misidentified as a transparency. In these cases, because transparency print modes typically print with one of the heavier applications of ink than other print modes, the non-transparency media was over saturated, degrading the quality of the resulting hardcopy print. For instance, some media, especially various types of photo media, were often misidentified as transparencies having a tape header <highlight><bold>456</bold></highlight>. </paragraph>
<paragraph id="P-0218" lvl="0"><number>&lsqb;0218&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 44</cross-reference> illustrates one form of an early transparency detection system <highlight><bold>920</bold></highlight>, constructed in accordance with the present invention. Here, a collect raw data step <highlight><bold>502</bold></highlight>&prime; is conducted as described above with respect to step <highlight><bold>502</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 16</cross-reference>, except the media is advanced under the optical sensor <highlight><bold>100</bold></highlight> until any tape header <highlight><bold>546</bold></highlight> clears and moves beyond the LED <highlight><bold>105</bold></highlight> and sensors <highlight><bold>130</bold></highlight>, <highlight><bold>130</bold></highlight>&prime;. Otherwise, the raw data is collected as described above, and the raw data signal <highlight><bold>536</bold></highlight> is sent to the &ldquo;find specular and diffuse average&rdquo; steps <highlight><bold>540</bold></highlight> and <highlight><bold>544</bold></highlight> as described above with respect to <cross-reference target="DRAWINGS">FIG. 17</cross-reference>. The specular average signal &ldquo;A&rdquo; <highlight><bold>542</bold></highlight> is generated as described above, but for purposes which will become apparent later, it is preferable to label this signal as <highlight><bold>542</bold></highlight>&prime; to better distinguish signal flows. Similarly, step <highlight><bold>544</bold></highlight> generates a diffuse average signal <highlight><bold>545</bold></highlight>&prime; which contains the same information as signal <highlight><bold>545</bold></highlight> described above with respect to <cross-reference target="DRAWINGS">FIG. 17</cross-reference>. Both of the specular and diffuse average signals <highlight><bold>542</bold></highlight>&prime; and <highlight><bold>545</bold></highlight>&prime; are received by the early transparency detection routine <highlight><bold>920</bold></highlight>, and in particular, by a comparing step <highlight><bold>922</bold></highlight>. In the comparing step <highlight><bold>922</bold></highlight>, the specular average &ldquo;A&rdquo; is compared with the magnitude of the diffuse average &ldquo;B&rdquo;, to determine whether the specular average is greater than the diffuse average. If the specular average is not greater than the diffuse average, a NO signal <highlight><bold>924</bold></highlight> is issued to a &ldquo;proceed with Fourier transforms&rdquo; step <highlight><bold>925</bold></highlight>, which upon receiving this signal issues a proceed signal <highlight><bold>926</bold></highlight>. </paragraph>
<paragraph id="P-0219" lvl="0"><number>&lsqb;0219&rsqb;</number> If the comparator step <highlight><bold>922</bold></highlight> finds the specular average to be greater than the diffuse average (A&gt;B), then a YES signal <highlight><bold>928</bold></highlight> is issued to a &ldquo;find media edges&rdquo; step <highlight><bold>930</bold></highlight>. As mentioned above, one unique property of transparent media is that the specular scan data detects the media <highlight><bold>170</bold></highlight>, while the diffuse scan data looks through the media to see the pivot or platen <highlight><bold>814</bold></highlight> below which is supporting the media, as shown in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>. Thus, the find the media edges step <highlight><bold>930</bold></highlight> uses the specular scan data to look for the characteristic low-to-high edge transition to find both the left and right edges of the media. Once the media width is known by locating the edges in step <highlight><bold>930</bold></highlight>, an edge location signal <highlight><bold>932</bold></highlight> is sent to a &ldquo;locate pivot gaps&rdquo; step <highlight><bold>934</bold></highlight>. As mentioned above, the media support surface opposite the optical detector <highlight><bold>100</bold></highlight> may be constructed in a variety of different fashions, having different types of known surface irregularities which may be monitored by the sensor <highlight><bold>100</bold></highlight>. For the illustrated inkjet printer <highlight><bold>20</bold></highlight>, the media pusher gaps <highlight><bold>897</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 24</cross-reference>) are used as an example which creates variations in the diffuse data, such as shown by graph <highlight><bold>892</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 33</cross-reference>, where the gap <highlight><bold>897</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 24</cross-reference>) creates data shown as a wide valley <highlight><bold>898</bold></highlight> in curve <highlight><bold>892</bold></highlight>. Thus, in a more broadly stated fashion, step <highlight><bold>934</bold></highlight> may be known as &ldquo;locate a surface irregularity in a media support surface&rdquo; step. Indeed, the surface irregularity may not be a particular slot or ridge, but in some implementations it might be a reflective surface or a surface having other distinguishable reflective properties, such as a smooth surface versus a rough surface. Details of the &ldquo;locate pivot gaps&rdquo; step <highlight><bold>934</bold></highlight> will be discussed further below, but upon locating all of the pivot gaps, a gap location signal <highlight><bold>934</bold></highlight>&prime; is issued. </paragraph>
<paragraph id="P-0220" lvl="0"><number>&lsqb;0220&rsqb;</number> The gap location signal <highlight><bold>934</bold></highlight>&prime; is received by a checking step <highlight><bold>935</bold></highlight> which determines whether all gaps have been detected. If step <highlight><bold>935</bold></highlight> determines all the gaps have been found, a YES signal <highlight><bold>936</bold></highlight> is issued to a transparency confirmed step <highlight><bold>938</bold></highlight>. The transparency confirmed step <highlight><bold>938</bold></highlight> then issues a select transparency print mode signal <highlight><bold>648</bold></highlight>&prime; to the print transparency step <highlight><bold>650</bold></highlight> (see <cross-reference target="DRAWINGS">FIG. 20</cross-reference>). The transparency confirmed step <highlight><bold>938</bold></highlight> selects a transparency print mode, for instance as described above for step <highlight><bold>646</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 20</cross-reference>. If the &ldquo;all gaps found&rdquo; checking step <highlight><bold>935</bold></highlight> finds that all the gaps have not been found, a NO signal <highlight><bold>940</bold></highlight> is issued to the proceed with Fourier transform step <highlight><bold>925</bold></highlight>. </paragraph>
<paragraph id="P-0221" lvl="0"><number>&lsqb;0221&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 45</cross-reference> shows the &ldquo;locate pivot gaps&rdquo; step <highlight><bold>934</bold></highlight> in greater detail. Again as stated above, this is merely an illustrated embodiment of identifying and locating known features &ldquo;seen&rdquo; through the transparency by the diffuse data, such as various surface irregularities which are identifiable features under the path of the optical sensor <highlight><bold>100</bold></highlight>, here illustrated as the pivot gaps which are useful for facilitating other printing mechanism operations like print media handling features. <cross-reference target="DRAWINGS">FIG. 45</cross-reference> shows the edge location signal <highlight><bold>932</bold></highlight> being received by a comparison step <highlight><bold>942</bold></highlight> portion of the locating step <highlight><bold>934</bold></highlight>. The comparison step <highlight><bold>942</bold></highlight> compares the magnitude of the gap signal at the beginning with the scanned diffuse data average value, to determine whether the gap signal is less than this average. As mentioned above, the locating pivot gap step <highlight><bold>934</bold></highlight> uses the diffuse data, such as that shown for curve <highlight><bold>944</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 46</cross-reference>. </paragraph>
<paragraph id="P-0222" lvl="0"><number>&lsqb;0222&rsqb;</number> In the graph of <cross-reference target="DRAWINGS">FIG. 46</cross-reference>, the diffuse scan data average is shown at dashed line <highlight><bold>945</bold></highlight>, the maximum scan data is shown at dashed line <highlight><bold>946</bold></highlight>, and 40% of the maximum value is shown at dashed line <highlight><bold>948</bold></highlight>. Thus, at the beginning of the gap at point <highlight><bold>950</bold></highlight>, the magnitude of curve <highlight><bold>944</bold></highlight> falls below the scan data average line <highlight><bold>945</bold></highlight>. Thus, at point <highlight><bold>950</bold></highlight> which is the beginning of the gap signal, a YES signal <highlight><bold>955</bold></highlight> is issued by the comparison step <highlight><bold>942</bold></highlight>. If the gap signal never falls below the diffuse scan data average <highlight><bold>945</bold></highlight>, then a NO signal <highlight><bold>956</bold></highlight> is issued to the proceed Fourier transform step <highlight><bold>925</bold></highlight>. The YES signal <highlight><bold>955</bold></highlight> is received by a second comparator step <highlight><bold>958</bold></highlight>, which determines when the gap signal at the beginning is lower than 40% of the maximum, shown as dashed line <highlight><bold>948</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 46</cross-reference>. As mentioned above, this 40% value is shown for curve <highlight><bold>944</bold></highlight> at point <highlight><bold>954</bold></highlight> for the first gap. With reference to <cross-reference target="DRAWINGS">FIGS. 24 and 33</cross-reference>, one reason for selecting the 40% value in step <highlight><bold>958</bold></highlight> is to distinguish the presence of valleys <highlight><bold>816</bold></highlight> in the media between peaks <highlight><bold>815</bold></highlight> formed by the anti-cockle ribs <highlight><bold>810</bold></highlight>, <highlight><bold>812</bold></highlight> which in turn form peaks <highlight><bold>895</bold></highlight> and valleys <highlight><bold>896</bold></highlight> in curve <highlight><bold>892</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 33</cross-reference>. As shown in <cross-reference target="DRAWINGS">FIG. 33</cross-reference>, the gap valley <highlight><bold>898</bold></highlight> has a much greater magnitude than the trace for the rib valleys <highlight><bold>896</bold></highlight>, so this 40% value helps distinguish a rib-induced valley from a pusher gap or slot <highlight><bold>897</bold></highlight>. Of course, it is apparent that other media support surfaces beyond the illustrated support surface having three pusher gaps <highlight><bold>897</bold></highlight> and multiple anti-cockle ribs <highlight><bold>810</bold></highlight>, <highlight><bold>812</bold></highlight> may require other types of checking routines to distinguish the desired surface irregularities or transparency identification indicia on the media support from other types of media induced bending or bowing features. If the curve <highlight><bold>944</bold></highlight> never drops below the 40% of maximum value <highlight><bold>948</bold></highlight>, then it is assumed that a ribbed valley <highlight><bold>896</bold></highlight> has been encountered, and a NO signal <highlight><bold>960</bold></highlight> is issued to the &ldquo;proceed with Fourier transform&rdquo; step <highlight><bold>925</bold></highlight>. When point <highlight><bold>954</bold></highlight> is reached in the graph <highlight><bold>944</bold></highlight>, then the comparator step <highlight><bold>958</bold></highlight> issues a YES signal <highlight><bold>962</bold></highlight> to a third comparator step <highlight><bold>964</bold></highlight>. </paragraph>
<paragraph id="P-0223" lvl="0"><number>&lsqb;0223&rsqb;</number> The third comparator step <highlight><bold>964</bold></highlight> determines whether the end of the gap has been reached, such as at point <highlight><bold>965</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 46</cross-reference> where curve <highlight><bold>944</bold></highlight> rises above the scan data average line <highlight><bold>945</bold></highlight>. If the data never rises above point <highlight><bold>965</bold></highlight>, then a NO signal <highlight><bold>966</bold></highlight> is issued to the &ldquo;proceed with Fourier transforms&rdquo; step <highlight><bold>925</bold></highlight>. However, when the point <highlight><bold>965</bold></highlight> is reached, the comparator step <highlight><bold>964</bold></highlight> issues a YES signal <highlight><bold>968</bold></highlight> to a &ldquo;find gap width&rdquo; routine <highlight><bold>970</bold></highlight>. In the find gap width step <highlight><bold>970</bold></highlight>, in the particular example the distance D<highlight><bold>1</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 46</cross-reference>, which corresponds to the width of the illustrated gap, must be between maximum and minimum values, here for the illustrated printer, to be at least {fraction (15/600)} of an inch, and not more than {fraction (250/600)} of an inch. This determination is made by a &ldquo;gap width within limits (&quest;)&rdquo; comparator <highlight><bold>972</bold></highlight>, which receives a gap width signal <highlight><bold>974</bold></highlight> from step <highlight><bold>970</bold></highlight>. If the gap width is found to be within limits by step <highlight><bold>972</bold></highlight>, a YES signal <highlight><bold>975</bold></highlight> is issued to the all gaps detected comparator step <highlight><bold>935</bold></highlight>. </paragraph>
<paragraph id="P-0224" lvl="0"><number>&lsqb;0224&rsqb;</number> If no gap is found within the size of the illustrated width limit of 15{fraction (250/600)}<highlight><superscript>th </superscript></highlight>of an inch, then a NO signal <highlight><bold>976</bold></highlight> is issued by comparator <highlight><bold>972</bold></highlight> to &ldquo;the proceed with Fourier transforms&rdquo; step <highlight><bold>925</bold></highlight>. The &ldquo;all gaps detected (&quest;)&rdquo; comparator step <highlight><bold>935</bold></highlight> not only looks for all three gaps <highlight><bold>897</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 24</cross-reference>) in the illustrated embodiment, but it also determines whether the gaps are located at least {fraction (700/600)}<highlight><superscript>th </superscript></highlight>of an inch away from one another. Thus, in <cross-reference target="DRAWINGS">FIG. 46 a</cross-reference> distance D<highlight><bold>2</bold></highlight> between the gaps must meet or exceed this minimum criteria. If any gaps have not been detected, or if the required distance between gaps has not been found, a NO signal <highlight><bold>978</bold></highlight> is issued to the first comparator step <highlight><bold>942</bold></highlight> of the &ldquo;locate pivot gap&rdquo; step <highlight><bold>934</bold></highlight>. If all three gaps have been detected at the expected separation, then the YES signal <highlight><bold>936</bold></highlight> is issued to the transparency confirmed step <highlight><bold>938</bold></highlight>, as described above with respect to <cross-reference target="DRAWINGS">FIG. 44</cross-reference>. </paragraph>
<paragraph id="P-0225" lvl="0"><number>&lsqb;0225&rsqb;</number> To better understand how the early transparency detection system <highlight><bold>920</bold></highlight> fits into the modified advanced media detection system <highlight><bold>500</bold></highlight>&prime;, <cross-reference target="DRAWINGS">FIGS. 47 and 48</cross-reference> show the early detour which the early transparency detection system <highlight><bold>920</bold></highlight> may provide to reach the print transparency step <highlight><bold>950</bold></highlight> and bypass the Fourier transform steps <highlight><bold>946</bold></highlight>, <highlight><bold>948</bold></highlight>, <highlight><bold>952</bold></highlight> and <highlight><bold>954</bold></highlight> of the massage data routine <highlight><bold>504</bold></highlight>&prime;. Moreover, beyond avoiding the normal massage data routine <highlight><bold>504</bold></highlight>, the remaining major and specific category determination steps <highlight><bold>506</bold></highlight> and <highlight><bold>508</bold></highlight> are avoided, along with the verification step <highlight><bold>510</bold></highlight>. This early routing speeds the throughput of the printing mechanism <highlight><bold>20</bold></highlight>, which is a printer rating measured in pages per minute, so a consumer obtains a faster transparency printout. For people in business giving presentations, quickly getting transparencies for display on an overhead projector can often be critical when last minute changes are needed before a meeting. Moreover, by using the early transparency detection routine <highlight><bold>920</bold></highlight>, photo medias are no longer inadvertently interpreted as being transparency media, thus avoiding poor print quality from over saturating such photo media with the heavier inks used on transparencies. This feature helps all consumers printing on the usually more expensive photo medias from needlessly wasting the photo paper, or from accepting less than optimal quality prints. Finally, the illustrated embodiment of FIGS. <highlight><bold>44</bold></highlight>-<highlight><bold>48</bold></highlight> is shown to illustrate the principles and concepts of the invention as set forth in the claims below, and a variety of modifications and variations may be employed in various implementations while still falling within the scope of the claims below. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">We claim: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. A method of classifying incoming media entering a printing mechanism, comprising the steps of: 
<claim-text>advancing the incoming media to a selected location; </claim-text>
<claim-text>optically scanning said media at the selected location; </claim-text>
<claim-text>collecting raw specular data and raw diffuse data while scanning; </claim-text>
<claim-text>averaging said raw specular data and raw diffuse data; </claim-text>
<claim-text>determining whether the averaged specular data is greater than the averaged diffuse data; and </claim-text>
<claim-text>when the averaged specular data is greater than the averaged diffuse data, identifying the media as a transparency. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein when the averaged specular data is not greater than the averaged diffuse data, performing Fourier transforms on the raw specular data and raw diffuse data and analyzing the results thereof to determine the type of incoming media. </claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein: 
<claim-text>the incoming media may or may not have an opaque header along a leading edge thereof; and </claim-text>
<claim-text>the advancing comprises advancing the leading edge until any header is not involved in said optically scanning. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> further including locating side edges of the media through further optical scanning of the media. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00004">claim 4</dependent-claim-reference> further including using specular data to locate the media edges. </claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00005">claim 5</dependent-claim-reference> further including finding a low-to-high transition in the specular data to locate the media edges. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> further including locating a surface irregularity in a media support which supports the media during said optically scanning. </claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference> further including locating another surface irregularity in the media support, and determining whether said surface irregularity and said another surface irregularity are spaced an expected spacing apart. </claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference> wherein said surface irregularity comprises a recess defined by the media support. </claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference> wherein said surface irregularity comprises a ridge projecting from the media support. </claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference> wherein said surface irregularity comprises a reflective portion of the media support. </claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference> wherein said surface irregularity comprises a portion having a color different than the the majority of the media support. </claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference> wherein said surface irregularity comprises a textured portion of the media support. </claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference> further including locating plural other surface irregularities in the media support, and determining whether all expected surface irregularities have been located. </claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. A method of classifying incoming media entering a printing mechanism, comprising the steps of: 
<claim-text>advancing the incoming media to a selected location; </claim-text>
<claim-text>optically scanning said media at the selected location; </claim-text>
<claim-text>locating plural surface irregularities in a media support which supports the media during said optically scanning; </claim-text>
<claim-text>determining whether all expected surface irregularities have been located; and </claim-text>
<claim-text>when all expected surface irregularities have been located, identifying the media as a transparency. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference> further including: 
<claim-text>gathering raw specular data and raw diffuse data during said optically scanning; and </claim-text>
<claim-text>when all expected surface irregularities have not been located, performing Fourier transforms on the raw specular data and raw diffuse data and analyzing the results thereof to determine the type of incoming media. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference> further including: 
<claim-text>averaging said raw diffuse data; </claim-text>
<claim-text>wherein said surface irregularity comprises a recess defined by the media support; and </claim-text>
<claim-text>determining whether a magnitude of raw diffuse data gathered upon encountering said surface irregularity is less than the averaged diffuse data. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00011">claim 17</dependent-claim-reference> further including: 
<claim-text>finding a maximum value of said raw diffuse data; and </claim-text>
<claim-text>determining whether a magnitude of raw diffuse data gathered while scanning said surface irregularity is less than a selected percentage of the maximum value. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference> wherein the selected percentage of the maximum value comprises a value below 50%. </claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00011">claim 19</dependent-claim-reference> further including determining whether the magnitude of raw diffuse data gathered upon leaving said surface irregularity is greater than the averaged diffuse data. </claim-text>
</claim>
<claim id="CLM-00021">
<claim-text><highlight><bold>21</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00022">claim 20</dependent-claim-reference> further including: 
<claim-text>comparing the location where the surface irregularity was encountered with the location where the surface irregularity was left; and </claim-text>
<claim-text>from said comparing, determining the size of said surface irregularity. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00022">
<claim-text><highlight><bold>22</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00022">claim 21</dependent-claim-reference> further including determining whether the size of said surface irregularity is of an expected size. </claim-text>
</claim>
<claim id="CLM-00023">
<claim-text><highlight><bold>23</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference> further including determining whether adjacent surface irregularities are spaced apart at an expected spacing. </claim-text>
</claim>
<claim id="CLM-00024">
<claim-text><highlight><bold>24</bold></highlight>. A method according to <dependent-claim-reference depends_on="CLM-00022">claim 23</dependent-claim-reference> further including determining whether the sizes of the plural surface irregularities are of expected sizes.</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>2</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030001939A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030001939A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030001939A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030001939A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030001939A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030001939A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030001939A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030001939A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030001939A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00009">
<image id="EMI-D00009" file="US20030001939A1-20030102-D00009.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00010">
<image id="EMI-D00010" file="US20030001939A1-20030102-D00010.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00011">
<image id="EMI-D00011" file="US20030001939A1-20030102-D00011.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00012">
<image id="EMI-D00012" file="US20030001939A1-20030102-D00012.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00013">
<image id="EMI-D00013" file="US20030001939A1-20030102-D00013.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00014">
<image id="EMI-D00014" file="US20030001939A1-20030102-D00014.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00015">
<image id="EMI-D00015" file="US20030001939A1-20030102-D00015.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00016">
<image id="EMI-D00016" file="US20030001939A1-20030102-D00016.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00017">
<image id="EMI-D00017" file="US20030001939A1-20030102-D00017.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00018">
<image id="EMI-D00018" file="US20030001939A1-20030102-D00018.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00019">
<image id="EMI-D00019" file="US20030001939A1-20030102-D00019.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00020">
<image id="EMI-D00020" file="US20030001939A1-20030102-D00020.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00021">
<image id="EMI-D00021" file="US20030001939A1-20030102-D00021.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00022">
<image id="EMI-D00022" file="US20030001939A1-20030102-D00022.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00023">
<image id="EMI-D00023" file="US20030001939A1-20030102-D00023.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00024">
<image id="EMI-D00024" file="US20030001939A1-20030102-D00024.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00025">
<image id="EMI-D00025" file="US20030001939A1-20030102-D00025.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00026">
<image id="EMI-D00026" file="US20030001939A1-20030102-D00026.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00027">
<image id="EMI-D00027" file="US20030001939A1-20030102-D00027.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00028">
<image id="EMI-D00028" file="US20030001939A1-20030102-D00028.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00029">
<image id="EMI-D00029" file="US20030001939A1-20030102-D00029.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00030">
<image id="EMI-D00030" file="US20030001939A1-20030102-D00030.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00031">
<image id="EMI-D00031" file="US20030001939A1-20030102-D00031.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00032">
<image id="EMI-D00032" file="US20030001939A1-20030102-D00032.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00033">
<image id="EMI-D00033" file="US20030001939A1-20030102-D00033.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00034">
<image id="EMI-D00034" file="US20030001939A1-20030102-D00034.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00035">
<image id="EMI-D00035" file="US20030001939A1-20030102-D00035.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00036">
<image id="EMI-D00036" file="US20030001939A1-20030102-D00036.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00037">
<image id="EMI-D00037" file="US20030001939A1-20030102-D00037.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00038">
<image id="EMI-D00038" file="US20030001939A1-20030102-D00038.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00039">
<image id="EMI-D00039" file="US20030001939A1-20030102-D00039.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00040">
<image id="EMI-D00040" file="US20030001939A1-20030102-D00040.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00041">
<image id="EMI-D00041" file="US20030001939A1-20030102-D00041.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
