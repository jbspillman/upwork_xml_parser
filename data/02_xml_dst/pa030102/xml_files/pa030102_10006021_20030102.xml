<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030001522A1-20030102-M00001.NB SYSTEM "US20030001522A1-20030102-M00001.NB" NDATA NB>
<!ENTITY US20030001522A1-20030102-M00001.TIF SYSTEM "US20030001522A1-20030102-M00001.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00000.TIF SYSTEM "US20030001522A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00001.TIF SYSTEM "US20030001522A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00002.TIF SYSTEM "US20030001522A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00003.TIF SYSTEM "US20030001522A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00004.TIF SYSTEM "US20030001522A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00005.TIF SYSTEM "US20030001522A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00006.TIF SYSTEM "US20030001522A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00007.TIF SYSTEM "US20030001522A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00008.TIF SYSTEM "US20030001522A1-20030102-D00008.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00009.TIF SYSTEM "US20030001522A1-20030102-D00009.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00010.TIF SYSTEM "US20030001522A1-20030102-D00010.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00011.TIF SYSTEM "US20030001522A1-20030102-D00011.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00012.TIF SYSTEM "US20030001522A1-20030102-D00012.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00013.TIF SYSTEM "US20030001522A1-20030102-D00013.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00014.TIF SYSTEM "US20030001522A1-20030102-D00014.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00015.TIF SYSTEM "US20030001522A1-20030102-D00015.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00016.TIF SYSTEM "US20030001522A1-20030102-D00016.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00017.TIF SYSTEM "US20030001522A1-20030102-D00017.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00018.TIF SYSTEM "US20030001522A1-20030102-D00018.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00019.TIF SYSTEM "US20030001522A1-20030102-D00019.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00020.TIF SYSTEM "US20030001522A1-20030102-D00020.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00021.TIF SYSTEM "US20030001522A1-20030102-D00021.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00022.TIF SYSTEM "US20030001522A1-20030102-D00022.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00023.TIF SYSTEM "US20030001522A1-20030102-D00023.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00024.TIF SYSTEM "US20030001522A1-20030102-D00024.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00025.TIF SYSTEM "US20030001522A1-20030102-D00025.TIF" NDATA TIF>
<!ENTITY US20030001522A1-20030102-D00026.TIF SYSTEM "US20030001522A1-20030102-D00026.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030001522</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10006021</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20011205</filing-date>
</domestic-filing-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>H05B037/02</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>315</class>
<subclass>291000</subclass>
</uspc>
</classification-us-primary>
<classification-us-secondary>
<uspc>
<class>315</class>
<subclass>308000</subclass>
</uspc>
</classification-us-secondary>
</classification-us>
<title-of-invention>Electronic ballast</title-of-invention>
</technical-information>
<continuity-data>
<continuations>
<continuation-in-part-of>
<parent-child>
<child>
<document-id>
<doc-number>10006021</doc-number>
<kind-code>A1</kind-code>
<document-date>20011205</document-date>
</document-id>
</child>
<parent>
<document-id>
<doc-number>09887848</doc-number>
<document-date>20010622</document-date>
<country-code>US</country-code>
</document-id>
</parent>
<parent-status>PENDING</parent-status>
</parent-child>
</continuation-in-part-of>
</continuations>
</continuity-data>
<inventors>
<first-named-inventor>
<name>
<given-name>Robert</given-name>
<middle-name>C.</middle-name>
<family-name>Newman</family-name>
<name-suffix>JR.</name-suffix>
</name>
<residence>
<residence-us>
<city>Emmaus</city>
<state>PA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Stuart</given-name>
<family-name>DeJonge</family-name>
</name>
<residence>
<residence-us>
<city>Riegelsville</city>
<state>PA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Mark</given-name>
<family-name>Taipale</family-name>
</name>
<residence>
<residence-us>
<city>Harleysville</city>
<state>PA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Dominick</given-name>
<family-name>Travaglini</family-name>
</name>
<residence>
<residence-us>
<city>Doylestown</city>
<state>PA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Joel</given-name>
<middle-name>S.</middle-name>
<family-name>Spira</family-name>
</name>
<residence>
<residence-us>
<city>Coopersburg</city>
<state>PA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<assignee>
<organization-name>Lutron Electronics Co., Inc.</organization-name>
<assignee-type>02</assignee-type>
</assignee>
<correspondence-address>
<name-1>OSTROLENK FABER GERB &amp; SOFFEN</name-1>
<name-2></name-2>
<address>
<address-1>1180 AVENUE OF THE AMERICAS</address-1>
<city>NEW YORK</city>
<state>NY</state>
<postalcode>100368403</postalcode>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">An electronic ballast for driving a gas discharge lamp includes a rectifier, a valley-fill circuit, an inverter having first and second series-connected controllably conductive device having complementary duty cycles, a control circuit for controlling the controllably conductive device, and an independent cat ear power supply to provide power to the ballast control circuits. The result is a ballast having substantially improved THD, and current crest factor. In a preferred embodiment, the valley-fill circuit includes an energy storage device that stores energy in response to a controllably conductive device. In an especially preferred embodiment, the controllably conductive device of the valley-fill circuit is also one of the controllably conductive devices of the inverter. </paragraph>
</subdoc-abstract>
<subdoc-description>
<cross-reference-to-related-applications>
<heading lvl="1">RELATED APPLICATIONS </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> This application is related to and is a continuation-in-part of copending application Ser. No. 09/887,848, filed Jun. 22, 2001, entitled Electronic Ballast and is related to copending application Ser. No. ________, filed _______, entitled Single Switch Electronic Ballast (P/10-584), the entire disclosure of which is incorporated by reference herein.</paragraph>
</cross-reference-to-related-applications>
<summary-of-invention>
<section>
<heading lvl="1">FIELD OF THE INVENTION </heading>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> The present invention relates to electronic ballasts for gas discharge lamps, such as fluorescent lamps. </paragraph>
</section>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> Electronic ballasts for fluorescent lamps typically can be analyzed as comprising a &ldquo;front end&rdquo; and a &ldquo;back end&rdquo;. The front end typically includes a rectifier for changing alternating current (AC) line voltage to a direct current (DC) bus voltage and a filter circuit for filtering the DC bus voltage. The filter circuit typically comprises an energy storage capacitor. Electronic ballasts also often use a boost circuit for boosting the magnitude of the DC bus voltage. Additionally, an electronic ballast is known that uses passive power factor correction means to reduce ballast input current total harmonic distortion. These means include line frequency filter circuits having a high impedance at line frequency and about the first 30 harmonics of the line frequency. The high impedance of line frequency filter circuits have a significant reducing effect on ballast input current total harmonic distortion. These filters are in contrast to EMI filters which have low impedance at line frequency and the related harmonics and therefore have no significant effect on ballast input current total harmonic distortion. </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> The ballast back end typically includes a switching inverter for converting the DC bus voltage to a high-frequency AC voltage, and a resonant tank circuit having a relatively high impedance for coupling the high-frequency AC voltage to the lamp electrodes. The ballast back end also typically includes a feedback circuit that monitors the lamp current and generates control signals to control the switching of the inverter so as to maintain a desired lamp current magnitude. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> In order to maintain stable lamp operation, typical prior art electronic ballasts filter the DC bus voltage to minimize the amount of bus voltage ripple. This is usually accomplished by providing a bus capacitor having a relatively large capacitance and hence, a relatively large energy storage capacity. By providing a relatively large bus capacitor, the amount of decay from the rectified peak voltage is minimized from one half-cycle to the next half-cycle. Minimizing the amount of ripple on the DC bus also tends to minimize the current crest factor (CCF) of the lamp current. The CCF of the lamp current is defined as the ratio of the magnitude of the peak lamp current to the magnitude of the root-mean-square (RMS) value of the lamp current.  
<math-cwu id="MATH-US-00001">
<number>1</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>CCF</mi>
        <mo>&Congruent;</mo>
        <mfrac>
          <msub>
            <mi>I</mi>
            <mi>pk</mi>
          </msub>
          <msub>
            <mi>I</mi>
            <mi>RMS</mi>
          </msub>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>Equation</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mn>1</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00001" file="US20030001522A1-20030102-M00001.NB"/>
<image id="EMI-M00001" wi="216.027" he="18.96615" file="US20030001522A1-20030102-M00001.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> An important indicator of lamp current quality for a gas discharge lamp such as a fluorescent lamp is the current crest factor (CCF) of the lamp current. A low CCF is preferred because a high CCF can cause the deterioration of the lamp filaments which would subsequently reduce the life of the lamp. A CCF of 2.1 or less is recommended by Japanese Industrial Standard (JIS) JIS C 8117-1992, and a CCF of 1.7 or less is recommended by the International Electrotechnical Commission (IEC) Standard 921-1988-07. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> However, using a relatively large bus capacitor to minimize ripple on the DC bus voltage comes with its disadvantages. The larger the bus capacitor, the more expensive it is, and the more area it consumes on a printed circuit board, or the like, and the more volume it uses within the ballast. Also, the bus capacitor is discharging whenever the bus voltage level is above the instantaneous absolute value of the AC line voltage, and hence the bus capacitor recharges only during a relatively short time within each line half-cycle, around the absolute value peak voltage of the AC line voltage. Thus, typical prior art ballasts draw a relatively large amount of current during the short time that the bus capacitor is charging, as shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. This results in a distorted ballast input current waveform giving rise to unwanted harmonics and undesirable levels of total harmonic distortion (THD). </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> In an AC power system, the voltage or current wave shapes may be expressed as a fundamental and a series of harmonics. These harmonics have some multiple frequency of the fundamental frequency of the line voltage or current. Specifically, the distortion in the AC wave shape has components which are integer multiples of the fundamental frequency. Of particular concern are the harmonics that are multiples of the 3<highlight><superscript>rd </superscript></highlight>harmonic. These harmonics add numerically in the neutral conductor of a three phase power system. Typically, total harmonic distortion is calculated using the first 30 harmonics of the fundamental frequency. Total harmonic distortion (THD) of the ballast input current is preferred to be below 33.3% to prevent overheating of the neutral wire in a three phase power system. Further, many users of lighting systems require ballasts to have a ballast input current total harmonic distortion of less than 20%. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> One approach to lowering the ballast input current total harmonic distortion and improving the ballast power factor has been to employ well known active power factor correction (APFC) circuits. This approach has certain tradeoffs including added ballast complexity, more components, greater cost, potentially lower reliability and, possibly, increased power consumption. Moreover, the ballast with APFC typically uses a relatively large bus capacitor with its attendant disadvantages as noted above. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> Another approach to lowering ballast input current total harmonic distortion has been to employ a valley fill circuit between a rectifier and an inverter. One disadvantage of typical prior art valley fill circuits is that they can have greater bus ripple, which results in even higher lamp current crest factor, which can in turn shorten lamp life. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> Prior art approaches to providing electronic ballasts having improved power factor and THD are discussed in T.-F. Wu, Y.-J. Wu, C.-H. Chang and Z. R. Liu, &ldquo;Ripple-Free, Single-Stage Electronic Ballasts with Dither-Booster Power Factor Corrector&rdquo;, IEEE Industry Applications Society Annual Meeting, pp.2372-77, 1997; Y.-S. Youn, G. Chae, and G.-H. Cho, &ldquo;A Unity Power Factor Electronic Ballast for Fluorescent Lamp having Improved Valley Fill and Valley Boost Converter&rdquo;, IEEE PESC97 Record, pp. 53-59, 1997; and G. Chae, Y.-S. Youn, and G.-H. Cho, &ldquo;High Power Factor Correction Circuit using Valley Charge-Pumping for Low Cost Electronic Ballasts&rdquo;, IEEE 0-7803-4489-8/98, pp. 2003-8, 1998. </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> Prior art patents representative of attempts to provide electronic ballasts having improved power factor and total harmonic distortion include U.S. Pat. No. 5,387,847, &ldquo;Passive Power Factor Ballast Circuit for the Gas Discharge Lamps&rdquo;, issued Feb. 7, 1995 to Wood; U.S. Pat. No. 5,399,944, &ldquo;Ballast Circuit for Driving Gas Discharge&rdquo;, issued Mar. 21, 1995 to Konopka et al.; U.S. Pat. No. 5,517,086, &ldquo;Modified Valley Fill High Power Factor Correction Ballast&rdquo;, issued May 14, 1996 to El-Hamamsy et al.; and U.S. Pat. No. 5,994,847, &ldquo;Electronic Ballast with Lamp Current Valley-fill Power Factor Correction&rdquo;, issued Nov. 30, 1999. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> Another reference is &ldquo;Fluorescent Ballast Design Using Passive P.F.C. and Crest Factor Control&rdquo; by Peter M. Wood, 1998. This reference shows a ballast of the type employing a line frequency filter having a substantial impedance at the line frequency and about the first 30 harmonics of the line frequency. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> In accordance with a first feature of the invention, a novel electronic ballast for driving a gas discharge lamp includes a rectifying circuit to convert an AC line input voltage to a rectified voltage, a valley fill circuit including an energy storage device which is charged through a switched impedance, the energy in this device being used to fill the valleys between successive rectified voltage peaks to produce a valley filled voltage, and an inverter circuit having series connected controllably conductive devices to convert the valley filled voltage to a high frequency AC voltage. The energy storage device can be a capacitor or an inductor or any other energy storage component or combination of components. Charging the energy storage device refers to increasing the energy stored in the energy storage device. A controllably conductive device is a device whose conduction can be controlled by an external signal. These controllably conductive devices include devices such as metal oxide semi-conductor field effect transistors (MOSFETs), insulated gate bi-polar transistors (IGBTs), bi-polar junction transistors (BJTs), Triacs, SCRs, relays, switches, vacuum tubes and other switching devices. The high frequency AC voltage is applied to a resonant tank circuit for driving a current through a gas discharge lamp, and a control circuit is provided for controlling the conduction of the controllably conductive devices in a novel way to deliver a desired lamp current to the gas discharge lamp and a reduced total harmonic distortion of the ballast input current. The electronic ballast of the invention described can drive more than one gas discharge lamp. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> In a preferred embodiment of the ballast, the energy storage device of the valley fill circuit includes a capacitor, commonly referred to as the valley fill capacitor, that stores energy during a first charging portion of each half-cycle of the AC line voltage, and delivers energy to the inverter circuit which in turn drives lamp current through a gas discharge lamp during a second discharge portion of each half-cycle of the AC line voltage. The switched impedance of the valley fill circuit includes a resistor in series with a controllably conductive device, through which the valley fill capacitor is charged. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> In an alternative embodiment, the energy storage device of the valley fill circuit includes a valley fill capacitor, and the switched impedance includes an inductor in series with a controllably conductive device, connected together in a buck converter circuit configuration. The valley fill capacitor stores energy during a first charging portion of each half-cycle of the AC line voltage, and delivers energy to the inverter circuit during a second discharge portion of each half-cycle of the AC line voltage. The buck circuit inductor stores energy in response to conduction of the controllably conductive device during the charging period of the valley fill capacitor, and transfers the stored energy to the valley fill capacitor in response to non-conduction of the controllably conductive device during the charging period of the valley fill capacitor. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> In an alternative embodiment, the buck circuit inductor is provided with a tap connected to the bus voltage through a commutation diode to provide different charge and discharge times for the valley fill capacitor. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> In accordance with a second feature of the invention, a novel electronic ballast for driving a gas discharge lamp includes a rectifying circuit to convert an AC line input voltage to a full wave rectified voltage, a valley fill circuit to fill the valleys between successive rectified voltage peaks to produce a valley filled voltage, an inverter circuit having series-connected switching devices (controllably conductive devices) to convert the valley filled voltage to a high-frequency AC voltage, a resonant tank for coupling the high-frequency AC voltage to a gas discharge lamp, a control circuit for controlling the conduction of the controllably conductive devices to deliver a desired current to the gas discharge lamp, and means for drawing input current near the zero crossing of the AC line input voltage so that the ballast input current total harmonic distortion is reduced. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> In a preferred embodiment of the ballast, the means for drawing current near the zero crossing is a cat ear circuit. Preferably the cat ear circuit is a cat ear power supply that may also supply the power necessary to operate the control circuit or other housekeeping and auxiliary circuits. The cat ear circuit draws current from the AC line around the zero crossing of the AC line voltage at either the leading edge of each half-cycle, or the trailing edge of each half-cycle, or both. The cat ear circuit derives its name from the characteristic shape of its input current waveform. This current &ldquo;fills in&rdquo; or supplements the current waveform drawn by the ballast from the AC line around the zero voltage crossings. The cat ear circuit may be provided with circuitry that &ldquo;cuts in&rdquo; and &ldquo;cuts out&rdquo; the cat ear circuit in response to fixed input voltage levels. Alternatively, the cat ear circuit may be provided with circuitry to monitor the current drawn by the ballast back end and cause the cat ear circuit to draw input current only when the back end is not drawing significant current.</paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a representation of voltage and current waveforms in a prior art electronic ballast with no APFC or valley fill circuits with some idealized waveforms shown as dashed lines. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a simplified block diagram of one of embodiment of the electronic ballast of the invention. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a simplified schematic circuit diagram of a first embodiment of a valley fill circuit using a buck converter circuit which can be used in the electronic ballast of the invention. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a simplified representation of the valley filled voltage in the buck converter circuit of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> illustrating the method of operation. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is a simplified schematic circuit of the buck converter circuit of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> illustrating a first mode of operation. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a simplified schematic circuit diagram of the buck converter circuit of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> illustrating a second mode of operation. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a simplified representation of various voltage and current waveforms in an electronic ballast including the buck converter circuit of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> at full light output. </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a simplified representation of various voltage and current waveforms in an electronic ballast including the buck converter circuit of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> at ten percent light output. </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a simplified schematic circuit diagram of a second embodiment of a valley fill circuit having a buck converter circuit integrated with an inverter circuit in accordance with the present invention. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a simplified schematic circuit diagram of a third embodiment of a valley fill circuit having an integrated buck converter circuit with a tapped inductor in the buck converter circuit in accordance with the invention. </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is a simplified schematic circuit diagram of another alternative embodiment of a valley fill circuit having a flyback transformer for recharging the valley fill capacitor. </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a simplified schematic circuit diagram of a fourth embodiment of a valley fill circuit in accordance with the present invention. </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is a simplified schematic circuit diagram of a fifth embodiment of a valley fill circuit in accordance with the present invention. </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 14</cross-reference> is a simplified schematic circuit diagram of a sixth embodiment of a valley fill circuit integrated with an inverter circuit in accordance with the present invention. </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 15</cross-reference> is a simplified schematic circuit diagram of a seventh embodiment of a valley fill circuit in accordance with the present invention. </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 16</cross-reference> is a simplified schematic circuit diagram of an eighth embodiment of a valley fill circuit in accordance with the present invention. </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> <cross-reference target="DRAWINGS">FIGS. 17 and 18</cross-reference> are simplified schematic circuit diagrams of a ballast constructed in accordance with the invention. </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 19</cross-reference> is a set of diagrams on a common time base showing inverter circuit switch conduction times of <cross-reference target="DRAWINGS">FIG. 17</cross-reference> changing over a half-cycle of the line voltage, and the resultant line current drawn by the ballast. </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> <cross-reference target="DRAWINGS">FIGS. 20 and 21</cross-reference> are simplified schematic circuit diagrams of a second embodiment of an electronic ballast constructed in accordance with the invention. </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 22</cross-reference> is a simplified partial schematic circuit diagram of the ballast of <cross-reference target="DRAWINGS">FIGS. 20 and 21</cross-reference> which includes details of the control, wave shaping, and feedback circuits. </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 23</cross-reference> is a simplified schematic circuit diagram of an automatic gain control circuit for the wave shaping circuit of <cross-reference target="DRAWINGS">FIG. 22</cross-reference>. </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 24</cross-reference> is a simplified block diagram of a second embodiment of the feedback circuit of <cross-reference target="DRAWINGS">FIG. 20</cross-reference>. </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 25</cross-reference> is a simplified block diagram of a third embodiment of the feedback circuit of <cross-reference target="DRAWINGS">FIG. 20</cross-reference>. </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 26</cross-reference> is a simplified flowchart illustrating the operation of the feedback circuits of <cross-reference target="DRAWINGS">FIGS. 24 and 25</cross-reference>. </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 27</cross-reference> is a simplified schematic circuit diagram of a prior art cat ear power supply. </paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 28</cross-reference> shows a simplified waveform of the line current drawn by the cat ear power supply of <cross-reference target="DRAWINGS">FIGS. 20 and 22</cross-reference>. </paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 29</cross-reference> is a simplified schematic circuit diagram of a first embodiment of a cat ear circuit having fixed cut-in and cut-out points in accordance with the invention. </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 30</cross-reference> is a simplified schematic circuit diagram of a second embodiment of a cat ear circuit including active monitoring of back end current. </paragraph>
<paragraph id="P-0048" lvl="0"><number>&lsqb;0048&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 31</cross-reference> shows a simplified waveform of the line current drawn by the electronic ballast of <cross-reference target="DRAWINGS">FIGS. 20 and 21</cross-reference>.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF EMBODIMENTS OF THE INVENTION </heading>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> The foregoing summary, as well as the following detailed description of the preferred embodiments, is better understood when read in conjunction with the appended drawings. For the purposes of illustrating the invention, there is shown in the drawings an embodiment that is presently preferred, in which like numerals represent similar parts throughout the several views of the drawings, it being understood, however, that the invention is not limited to the specific methods and instrumentalities disclosed. </paragraph>
</section>
<section>
<heading lvl="1">Ballast Overview </heading>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> Referring first to <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, there is shown a simplified block diagram of an electronic ballast <highlight><bold>810</bold></highlight> constructed in accordance with the invention. The ballast <highlight><bold>810</bold></highlight> includes a rectifying circuit <highlight><bold>820</bold></highlight> capable of being connected to an AC power supply with a given line frequency. Typically, the given line frequency of the AC power supply is 50 Hz or 60 Hz. However, the invention is not limited to these particular frequencies. Whenever a device is said to be connected, coupled, coupled in current relation, or connectable to another device, it means that the device may be directly connected by a wire or alternately, connected through another device such as (but not limited to) a resistor, diode, controllable conductive device, and this connection may be in a series or parallel arrangement. The rectifying circuit <highlight><bold>820</bold></highlight> converts the AC input voltage to a full wave rectified voltage. In one embodiment of the invention rectifying circuit <highlight><bold>820</bold></highlight> is connected to a novel valley fill circuit <highlight><bold>830</bold></highlight>, to be described, through a diode <highlight><bold>840</bold></highlight>. A high frequency bypass filter capacitor <highlight><bold>850</bold></highlight> is connected across the input terminals of the valley fill circuit <highlight><bold>830</bold></highlight>. The valley fill circuit <highlight><bold>830</bold></highlight> selectively charges and discharges an energy storage device to be described, so as to create a valley filled voltage. The output terminals of the valley fill circuit <highlight><bold>830</bold></highlight> are in turn connected to the input terminals of an inverter circuit <highlight><bold>860</bold></highlight>. The inverter circuit <highlight><bold>860</bold></highlight> converts the rectified DC voltage to a high-frequency AC voltage. The output terminals of the inverter circuit <highlight><bold>860</bold></highlight> are connected to an output circuit <highlight><bold>870</bold></highlight>, which typically includes a resonant tank, and may also include a coupling transformer. The output circuit <highlight><bold>870</bold></highlight> filters the inverter circuit <highlight><bold>860</bold></highlight> output to supply essentially a sinusoidal high frequency voltage, as well as provides voltage gain and increased output impedance. The output circuit <highlight><bold>870</bold></highlight> is capable of being connected to drive a load <highlight><bold>880</bold></highlight> such as a gas discharge lamp; for example, a fluorescent lamp. An output current sense circuit <highlight><bold>890</bold></highlight> coupled to the load <highlight><bold>880</bold></highlight> provides load current feedback to a control circuit <highlight><bold>882</bold></highlight>. The control circuit <highlight><bold>882</bold></highlight> generates control signals to control the operation of the valley fill circuit <highlight><bold>830</bold></highlight> and the inverter circuit <highlight><bold>860</bold></highlight> so as to provide a desired load current to the load <highlight><bold>880</bold></highlight>. A cat ear circuit <highlight><bold>884</bold></highlight> is connected across the output terminals of the rectifying circuit <highlight><bold>820</bold></highlight> and provides the necessary power for proper operation of the control circuit <highlight><bold>882</bold></highlight>. </paragraph>
</section>
<section>
<heading lvl="1">The Valley Fill Circuit </heading>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> Turning now to <cross-reference target="DRAWINGS">FIG. 3</cross-reference>, there is shown a schematic circuit diagram of a first embodiment <highlight><bold>910</bold></highlight> of the valley fill circuit <highlight><bold>830</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 2</cross-reference> in the form of a buck converter circuit. Connected across first and second input terminals <highlight><bold>912</bold></highlight> and <highlight><bold>914</bold></highlight> is an energy-storage device <highlight><bold>916</bold></highlight>, in the form of a capacitor, in series with a first diode <highlight><bold>918</bold></highlight>. The function of the buck converter circuit <highlight><bold>910</bold></highlight> is to provide a controlled charging current for the capacitor <highlight><bold>916</bold></highlight>. This capacitor <highlight><bold>916</bold></highlight> is also referred to as the valley fill capacitor. Connected to the junction of the capacitor <highlight><bold>916</bold></highlight> and the cathode of the first diode <highlight><bold>918</bold></highlight> is an inductor <highlight><bold>920</bold></highlight> which is connected in series with a second (optional) diode <highlight><bold>922</bold></highlight> and a controllably conductive device, switch <highlight><bold>924</bold></highlight>, to a circuit common. Controllably conductive device <highlight><bold>924</bold></highlight> is shown as a metal-oxide semiconductor field-effect transistor (MOSFET), but may be a bipolar junction transistor (BJT), insulated gate bipolar transistor (IGBT), or other controllably conductive device. The buck converter circuit <highlight><bold>910</bold></highlight> also includes a third commutating diode <highlight><bold>926</bold></highlight>, which may also be a suitably controlled synchronous rectifier or MOSFET, connected between the junction of the buck inductor <highlight><bold>920</bold></highlight> and the second diode <highlight><bold>922</bold></highlight>, and one terminal of the capacitor <highlight><bold>916</bold></highlight> connected to the input <highlight><bold>912</bold></highlight>. A first output terminal <highlight><bold>928</bold></highlight> is connected to input terminal <highlight><bold>912</bold></highlight>, capacitor <highlight><bold>916</bold></highlight>, and the cathode of commutating diode <highlight><bold>926</bold></highlight>. A second output terminal <highlight><bold>930</bold></highlight> is connected to the second input terminal <highlight><bold>914</bold></highlight>, circuit common, the anode of diode <highlight><bold>918</bold></highlight>, and the switch <highlight><bold>924</bold></highlight>. </paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> The operation of the buck converter circuit <highlight><bold>910</bold></highlight> will be described in connection with <cross-reference target="DRAWINGS">FIGS. 3, 4</cross-reference>, <highlight><bold>5</bold></highlight>, and <highlight><bold>6</bold></highlight>. The buck converter circuit <highlight><bold>910</bold></highlight> operates under two different conditions. In condition I (interval I in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>), the instantaneous rectified line voltage <highlight><bold>1010</bold></highlight> applied to the input terminals <highlight><bold>912</bold></highlight>, <highlight><bold>914</bold></highlight> of the buck converter circuit <highlight><bold>910</bold></highlight> is equal to or less than the voltage <highlight><bold>1012</bold></highlight> across the capacitor <highlight><bold>916</bold></highlight>, and the capacitor <highlight><bold>916</bold></highlight> is therefore discharging some of its stored energy into the inverter circuit. In this condition, the diode <highlight><bold>840</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 2</cross-reference>) is reverse biased, and the diode <highlight><bold>918</bold></highlight> is forward biased into conduction. This establishes a discharge path for the capacitor <highlight><bold>916</bold></highlight> from circuit common terminal <highlight><bold>930</bold></highlight>, through the diode <highlight><bold>918</bold></highlight> and the capacitor <highlight><bold>916</bold></highlight>, to the buck converter output terminal <highlight><bold>928</bold></highlight>. Switch <highlight><bold>924</bold></highlight> alternately opens and closes at a frequency typically about <highlight><bold>30</bold></highlight> kHz or greater, which is substantially greater than the frequency of the rectified line voltage. When the switch <highlight><bold>924</bold></highlight> is conducting, residual energy remaining in the buck inductor <highlight><bold>920</bold></highlight> from the previous charging cycle is discharged through the diode <highlight><bold>922</bold></highlight> and the switch <highlight><bold>924</bold></highlight> to circuit common. Thereafter, the diodes <highlight><bold>922</bold></highlight> and <highlight><bold>926</bold></highlight> are reverse biased so that no further current flows through the buck inductor <highlight><bold>920</bold></highlight>. </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> In condition II (interval II in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>), the instantaneous rectified line voltage is greater than the voltage across the capacitor <highlight><bold>916</bold></highlight>, and the capacitor <highlight><bold>916</bold></highlight> is increasing its stored energy. During interval II, the operation of the buck converter depends on the conduction state of the switch <highlight><bold>924</bold></highlight>. </paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> When the switch <highlight><bold>924</bold></highlight> is conducting, the buck converter circuit <highlight><bold>910</bold></highlight> reduces to the simplified form shown in <cross-reference target="DRAWINGS">FIG. 5</cross-reference> and the voltage across the buck inductor <highlight><bold>920</bold></highlight> is equal to the instantaneous rectified line voltage minus the voltage across the capacitor <highlight><bold>916</bold></highlight>. Thus, the capacitor <highlight><bold>916</bold></highlight> is charged by a current flowing from the input <highlight><bold>912</bold></highlight>, through the capacitor <highlight><bold>916</bold></highlight>, the buck inductor <highlight><bold>920</bold></highlight>, and the switch <highlight><bold>924</bold></highlight>, to circuit common. In addition, the energy is stored in buck inductor <highlight><bold>920</bold></highlight> by the voltage applied to the buck inductor <highlight><bold>920</bold></highlight> when switch <highlight><bold>924</bold></highlight> is conducting. When the switch <highlight><bold>924</bold></highlight> is not conducting (as depicted in <cross-reference target="DRAWINGS">FIG. 6</cross-reference>), then the current <highlight><bold>1210</bold></highlight> flowing through the buck inductor <highlight><bold>920</bold></highlight> commutates through the diode <highlight><bold>926</bold></highlight> and flows into the capacitor <highlight><bold>916</bold></highlight>, thus transferring some or all of the energy stored in buck inductor <highlight><bold>920</bold></highlight> to the capacitor <highlight><bold>916</bold></highlight>. Note that in condition II, the capacitor <highlight><bold>916</bold></highlight> is charging both when switch <highlight><bold>924</bold></highlight> is conducting, and when switch <highlight><bold>924</bold></highlight> is not conducting. </paragraph>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> The result of the operation of the buck converter circuit <highlight><bold>910</bold></highlight> is that the capacitor <highlight><bold>916</bold></highlight> charges over a period of time <highlight><bold>1310</bold></highlight>, as shown in <cross-reference target="DRAWINGS">FIG. 7</cross-reference> wherein the ballast is operating at full light output. The charging of the valley fill capacitor <highlight><bold>916</bold></highlight> preferably takes place over more than 90 degrees of each line half cycle. </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> When the charging of the valley fill capacitor takes place for greater than 90 degrees of each 180 degree line frequency half cycle, the resulting ballast input current total harmonic distortion has been found to be reduced. </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> Another advantage of the buck converter circuit <highlight><bold>910</bold></highlight> is that the inrush current to the capacitor <highlight><bold>916</bold></highlight> at the beginning of each charge cycle is limited by the buck inductor <highlight><bold>920</bold></highlight>. This can also be seen in <cross-reference target="DRAWINGS">FIG. 7</cross-reference> in that the peak line current <highlight><bold>1312</bold></highlight> is greatly reduced as compared to the peak line current <highlight><bold>1314</bold></highlight> of typical prior art ballasts having no active power factor correction (APFC) or valley fill circuitry. Current inrush limiting is even more significant at initial ballast turn-on. Thus, when power is first applied to a typical active power factor corrected ballast, the energy storage capacitor is charged until the capacitor voltage rises to the peak value of the AC line voltage. During this charging period the input current is essentially limited only by wire resistance and the impedance of the AC power source supplying the ballast. The buck converter circuit <highlight><bold>910</bold></highlight> of the ballast of the invention is inherently current limited, thereby overcoming another significant drawback to APFC type ballasts. </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> Another advantage of the buck converter circuit <highlight><bold>910</bold></highlight> is that it provides over-voltage protection for the capacitor <highlight><bold>916</bold></highlight>. That is, in an unloaded condition, such as when no lamp is connected, the capacitor <highlight><bold>916</bold></highlight> will charge to no more than the peak rectified line voltage. This is in contrast to traditional boost and buck-boost converters wherein extra circuitry must be added to prevent charging of the energy storage capacitor to potentially catastrophically high voltages in an unloaded condition. </paragraph>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>, as the lamp is dimmed down to about 10 percent light output, the charging time of the capacitor <highlight><bold>916</bold></highlight> decreases. Simultaneously, the bus ripple voltage is also reduced, leading to a lower current crest factor of the lamp current. </paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> Turning now to <cross-reference target="DRAWINGS">FIG. 9</cross-reference>, there is shown a second embodiment of the buck converter circuit <highlight><bold>1410</bold></highlight> with inverter circuit <highlight><bold>860</bold></highlight>. The inverter circuit <highlight><bold>860</bold></highlight>, which is described later in more detail, has a high side switch <highlight><bold>2112</bold></highlight> and a low side switch <highlight><bold>924</bold></highlight>. The high side switch <highlight><bold>2112</bold></highlight> and the low side switch <highlight><bold>924</bold></highlight> are both controllably conductive devices, such as MOSFETs or IGBTs. In this embodiment, the buck converter circuit <highlight><bold>1410</bold></highlight> and the inverter circuit <highlight><bold>860</bold></highlight> share the controllably conductive device <highlight><bold>924</bold></highlight>. The second embodiment of buck converter circuit <highlight><bold>1410</bold></highlight> otherwise operates essentially in the same way as the first embodiment of buck converter circuit <highlight><bold>910</bold></highlight>. </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> Turning now to <cross-reference target="DRAWINGS">FIG. 10</cross-reference>, there is shown a third embodiment of the buck converter circuit <highlight><bold>1510</bold></highlight> in which the buck inductor <highlight><bold>920</bold></highlight> is replaced with a tapped inductor <highlight><bold>1520</bold></highlight>. The anode of the commutation diode <highlight><bold>926</bold></highlight> is coupled to an interior coil of the tapped inductor <highlight><bold>1520</bold></highlight> at the tap, rather than the junction of the tapped inductor <highlight><bold>1520</bold></highlight> and the diode <highlight><bold>922</bold></highlight>. The inductor tap placement provides the capability to vary the discharge time of the inductor <highlight><bold>1520</bold></highlight>. The continuous mode operation of the buck converter may be reduced, or eliminated altogether. However, this extra flexibility comes with the tradeoff of extra voltage stress on the switch <highlight><bold>924</bold></highlight>. Thus, when the tapped inductor <highlight><bold>1520</bold></highlight> is transferring energy to the capacitor <highlight><bold>916</bold></highlight>, the tapped inductor <highlight><bold>1520</bold></highlight> acts so that the voltage applied across the switch <highlight><bold>924</bold></highlight> is equal to the voltage across the capacitor <highlight><bold>916</bold></highlight> multiplied by the turns ratio of the tapped inductor <highlight><bold>1520</bold></highlight>. A snubber circuit including a snubber diode <highlight><bold>1552</bold></highlight>, in series with the parallel combination of a snubber resistor <highlight><bold>1554</bold></highlight> and a snubber capacitor <highlight><bold>1556</bold></highlight>, is coupled between the junction of the tapped buck inductor <highlight><bold>1520</bold></highlight> and the diode <highlight><bold>922</bold></highlight>, and circuit common, to dissipate uncoupled residual energy in the tapped buck inductor. </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> In one embodiment of the tapped buck inductor circuit of <cross-reference target="DRAWINGS">FIG. 10</cross-reference>, capacitor <highlight><bold>916</bold></highlight> is a parallel combination of two 47 microfarad, 250 volt capacitors, diodes <highlight><bold>918</bold></highlight> and <highlight><bold>926</bold></highlight> are MUR160 diodes, diodes <highlight><bold>922</bold></highlight> and <highlight><bold>1552</bold></highlight> are 1000 volt, 1 ampere diodes, resistor <highlight><bold>1554</bold></highlight> is a series combination of two 91 kilohm, 1 watt resistors, capacitor <highlight><bold>1556</bold></highlight> is a 0.0047 microfarad, 630 volt capacitor, and switch <highlight><bold>924</bold></highlight> is a 250 volt IRFI634G MOSFET. The tapped buck inductor <highlight><bold>1520</bold></highlight> has a total number of about 180 turns from the cathode of diode <highlight><bold>918</bold></highlight> to the anode of diode <highlight><bold>922</bold></highlight>, and has an inductance of about 1.427 milliHenries, with the number of turns from the cathode of diode <highlight><bold>918</bold></highlight> to the tap being about 75, with an inductance of about 244 microHenries, and the number of turns from the tap to the anode of diode <highlight><bold>922</bold></highlight> being about 105, with an inductance of about 492 microHenries. </paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> In each of the previously described embodiments of the valley fill circuit <highlight><bold>830</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 2</cross-reference>), charging current of capacitor <highlight><bold>916</bold></highlight> increases with longer conduction times of the controllably conductive switch <highlight><bold>924</bold></highlight>. When the lamp is being dimmed to low light levels, the switch <highlight><bold>924</bold></highlight> conducts for a longer time, and the accumulation of charge on capacitor <highlight><bold>916</bold></highlight> increases, which tends to raise the bus voltage. It is advantageous to have higher bus voltage at low light levels since the lamp voltage increases at low light levels and a higher bus voltage allows the lamp to be driven through a higher impedance. Higher output impedance improves lamp stability, as is discussed in U.S. Pat. No. 5,041,763, issued Aug. 20, 1991 to Sullivan et al., and assigned to Lutron Electronics Co., Inc. </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> The charging current also increases as the voltage differential between the rectified line voltage and the voltage across the capacitor <highlight><bold>916</bold></highlight> increases. This results in the instantaneous charging current in the tapped buck inductor being highest in the middle of the line half cycle, and lower towards the tails of the line half cycle, which in turn results in reduced total harmonic distortion of the ballast input current. </paragraph>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> Turning now to <cross-reference target="DRAWINGS">FIG. 11</cross-reference>, there is shown another embodiment <highlight><bold>1570</bold></highlight> of a valley fill circuit. In this embodiment, the valley fill circuit <highlight><bold>1570</bold></highlight> includes, in addition to the capacitor <highlight><bold>916</bold></highlight>, the diode <highlight><bold>922</bold></highlight>, and the switch <highlight><bold>924</bold></highlight>, a diode <highlight><bold>1572</bold></highlight> connected between the capacitor <highlight><bold>916</bold></highlight> and the terminal <highlight><bold>912</bold></highlight>, a diode <highlight><bold>1574</bold></highlight> and a &ldquo;flyback&rdquo; transformer <highlight><bold>1576</bold></highlight>. The &ldquo;primary&rdquo; winding of the transformer <highlight><bold>1576</bold></highlight> is connected between the anode of the diode <highlight><bold>922</bold></highlight> and the terminal <highlight><bold>928</bold></highlight> of the valley fill circuit <highlight><bold>1570</bold></highlight>. The &ldquo;secondary&rdquo; winding of the transformer <highlight><bold>1576</bold></highlight> is connected between circuit common and to the anode of the diode <highlight><bold>1574</bold></highlight>, the cathode of which is in turn connected to the junction of the capacitor <highlight><bold>916</bold></highlight> and the anode of the diode <highlight><bold>1572</bold></highlight>. </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> When a rectified line voltage applied to terminals <highlight><bold>912</bold></highlight>, <highlight><bold>914</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 11</cross-reference> exceeds the voltage across the capacitor <highlight><bold>916</bold></highlight>, then the voltage developed across the &ldquo;secondary&rdquo; winding of the flyback transformer <highlight><bold>1576</bold></highlight> recharges the capacitor <highlight><bold>916</bold></highlight> through the diode <highlight><bold>1574</bold></highlight>. When the rectified line voltage falls below the voltage across the capacitor, then the capacitor <highlight><bold>916</bold></highlight> discharges through output terminals <highlight><bold>928</bold></highlight> and <highlight><bold>930</bold></highlight>. </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> Turning now to <cross-reference target="DRAWINGS">FIG. 12</cross-reference>, there is shown a fourth embodiment <highlight><bold>1610</bold></highlight> of a valley fill circuit which uses only capacitive energy storage. In this embodiment, the valley fill circuit <highlight><bold>1610</bold></highlight> includes a first energy storage capacitor <highlight><bold>1632</bold></highlight> connected in series with a first diode <highlight><bold>1634</bold></highlight> across first and second input terminals <highlight><bold>912</bold></highlight>, <highlight><bold>914</bold></highlight> to the circuit <highlight><bold>1610</bold></highlight>. A second energy storage capacitor <highlight><bold>1616</bold></highlight> is connected in series with a second diode <highlight><bold>1636</bold></highlight>, the cathode of which is tied to the input <highlight><bold>912</bold></highlight>. A third diode <highlight><bold>1638</bold></highlight> is connected between the junction of capacitor <highlight><bold>1632</bold></highlight> and diode <highlight><bold>1634</bold></highlight>, and the junction of capacitor <highlight><bold>1616</bold></highlight> and diode <highlight><bold>1636</bold></highlight>. The other terminal of energy storage capacitor <highlight><bold>1616</bold></highlight> is connected to the second input terminal <highlight><bold>914</bold></highlight> by means of a fourth diode <highlight><bold>1618</bold></highlight> in parallel with a resistor <highlight><bold>1620</bold></highlight>. </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> When a rectified line voltage applied to terminals <highlight><bold>912</bold></highlight>, <highlight><bold>914</bold></highlight> exceeds the sum of the voltages across the capacitors <highlight><bold>1632</bold></highlight> and <highlight><bold>1616</bold></highlight> by the forward voltage drop across the diode <highlight><bold>1638</bold></highlight>, then the diodes <highlight><bold>1634</bold></highlight>, <highlight><bold>1636</bold></highlight>, and <highlight><bold>1618</bold></highlight> are reverse biased, the diode <highlight><bold>1638</bold></highlight> is forward biased, and the energy storage capacitors <highlight><bold>1632</bold></highlight>, <highlight><bold>1616</bold></highlight> charge through the series path of capacitor <highlight><bold>1632</bold></highlight>, diode <highlight><bold>1638</bold></highlight>, capacitor <highlight><bold>1616</bold></highlight>, and resistor <highlight><bold>1620</bold></highlight>. Resistor <highlight><bold>1620</bold></highlight> limits the charging current into the energy storage capacitors <highlight><bold>1632</bold></highlight>, <highlight><bold>1616</bold></highlight> to reduce current spikes in the current drawn by the ballast from the line, thereby reducing the ballast input current total harmonic distortion. The capacitors <highlight><bold>1632</bold></highlight>, <highlight><bold>1616</bold></highlight> typically each have the same value and charge to approximately one-half the peak input voltage. </paragraph>
<paragraph id="P-0069" lvl="0"><number>&lsqb;0069&rsqb;</number> When a rectified line voltage applied to terminals <highlight><bold>912</bold></highlight>, <highlight><bold>914</bold></highlight> falls below the sum of the voltage across capacitors <highlight><bold>1632</bold></highlight>, <highlight><bold>1616</bold></highlight>, then diode <highlight><bold>1638</bold></highlight> is reverse biased. Once the voltage across the input terminals <highlight><bold>912</bold></highlight>, <highlight><bold>914</bold></highlight> falls below the voltage across the capacitor <highlight><bold>1632</bold></highlight> by more than the turn-on voltage of the diode <highlight><bold>1634</bold></highlight>, then capacitor <highlight><bold>1632</bold></highlight> discharges through diode <highlight><bold>1634</bold></highlight> and output terminals <highlight><bold>928</bold></highlight> and <highlight><bold>930</bold></highlight>. Once the voltage across the input terminals <highlight><bold>912</bold></highlight>, <highlight><bold>914</bold></highlight> falls below the voltage across the capacitor <highlight><bold>1616</bold></highlight> by more than the turn-on voltage of the diode <highlight><bold>1636</bold></highlight>, then capacitor <highlight><bold>1616</bold></highlight> discharges through the diode <highlight><bold>1636</bold></highlight>, the resistor <highlight><bold>1620</bold></highlight>, and the output terminals <highlight><bold>928</bold></highlight>, <highlight><bold>930</bold></highlight>. When the voltage drop across the resistor <highlight><bold>1620</bold></highlight> exceeds the turn-on voltage of the diode <highlight><bold>1618</bold></highlight>, then capacitor <highlight><bold>1616</bold></highlight> discharges through diodes <highlight><bold>1636</bold></highlight>, <highlight><bold>1618</bold></highlight> and the output terminals <highlight><bold>928</bold></highlight>, <highlight><bold>930</bold></highlight>. </paragraph>
<paragraph id="P-0070" lvl="0"><number>&lsqb;0070&rsqb;</number> In summary, the capacitors <highlight><bold>1632</bold></highlight>, <highlight><bold>1616</bold></highlight> charge in series, and discharge in parallel, delivering their stored energy to an inverter circuit which drives the gas discharge lamp. The amount of ripple in the bus voltage is thereby reduced, which in turn leads to improved current crest factor of the lamp current delivered by the ballast. </paragraph>
<paragraph id="P-0071" lvl="0"><number>&lsqb;0071&rsqb;</number> The valley fill circuit <highlight><bold>1610</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 12</cross-reference> differs significantly from the valley fill circuit of Wood in U.S. Pat. No. 5,387,847. Most notably, Wood, in <cross-reference target="DRAWINGS">FIG. 2</cross-reference> of his patent, shows a resistor in series with a diode connected between two capacitors. In contrast, the valley fill circuit of <cross-reference target="DRAWINGS">FIG. 12</cross-reference> provides the resistor <highlight><bold>1620</bold></highlight> in parallel with the diode <highlight><bold>1618</bold></highlight>, the pair connected between the capacitor <highlight><bold>1616</bold></highlight> and circuit common. This novel arrangement provides the desired improvement in ballast input current total harmonic distortion, but does so in a manner that more readily lends itself to additional improvements. </paragraph>
<paragraph id="P-0072" lvl="0"><number>&lsqb;0072&rsqb;</number> To further improve the ballast input current total harmonic distortion, the valley fill circuit <highlight><bold>1610</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 12</cross-reference> may be modified by placing a controllably conductive device <highlight><bold>924</bold></highlight> in series with the resistor <highlight><bold>1620</bold></highlight> as shown in <cross-reference target="DRAWINGS">FIG. 13</cross-reference>. This creates a switched resistor circuit. The controllably conductive device <highlight><bold>924</bold></highlight> will typically be operated at a high frequency, that is, many times greater than the fundamental frequency of the AC line voltage. The ballast input current total harmonic distortion may be improved by controlling the conduction of switch <highlight><bold>924</bold></highlight> so that the conduction time of the switch <highlight><bold>924</bold></highlight> is increased near the center or peak of each line half cycle. This results in a ballast input current waveform that more nearly matches the AC line voltage waveform. </paragraph>
<paragraph id="P-0073" lvl="0"><number>&lsqb;0073&rsqb;</number> The valley fill circuit <highlight><bold>1710</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 13</cross-reference> may be integrated with the ballast inverter circuit as shown in <cross-reference target="DRAWINGS">FIG. 14</cross-reference> wherein the controllably conductive device <highlight><bold>924</bold></highlight> is shared by the valley-fill circuit <highlight><bold>1810</bold></highlight> and the inverter circuit <highlight><bold>2110</bold></highlight>. Alternately, the switch <highlight><bold>924</bold></highlight> of the valley fill circuit <highlight><bold>1710</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 13</cross-reference> may be an independently controlled controllably conductive device separate from each of the switches in the inverter circuit <highlight><bold>860</bold></highlight>. </paragraph>
<paragraph id="P-0074" lvl="0"><number>&lsqb;0074&rsqb;</number> Resistive losses in the valley fill circuit <highlight><bold>1710</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 13</cross-reference> may be reduced as shown in <cross-reference target="DRAWINGS">FIG. 15</cross-reference> by replacing resistor <highlight><bold>1620</bold></highlight> with an inductor <highlight><bold>1920</bold></highlight> in series with switch <highlight><bold>924</bold></highlight>. In an alternative arrangement, the combination of the inductor <highlight><bold>1920</bold></highlight> and the switch <highlight><bold>924</bold></highlight> may be replaced by a single inductor. However, the high-frequency switching action of switch <highlight><bold>924</bold></highlight> permits a relatively small, and inexpensive, inductor <highlight><bold>1920</bold></highlight> to be used. </paragraph>
<paragraph id="P-0075" lvl="0"><number>&lsqb;0075&rsqb;</number> As an alternative to switch <highlight><bold>924</bold></highlight>, a secondary winding <highlight><bold>2024</bold></highlight> from a high-frequency transformer may be substituted as shown in <cross-reference target="DRAWINGS">FIG. 16</cross-reference>. High-frequency transformers are typically present in ballasts. By the addition of the proper number of turns of a secondary winding (preferably to an already existing transformer), a voltage of alternating polarity may be introduced in series with inductor <highlight><bold>1920</bold></highlight>, alternately opposing and aiding the flow of current through the inductor <highlight><bold>1920</bold></highlight>. The winding <highlight><bold>2024</bold></highlight> thereby effectively functions as a switch. </paragraph>
</section>
<section>
<heading lvl="1">The Inverter Circuit </heading>
<paragraph id="P-0076" lvl="0"><number>&lsqb;0076&rsqb;</number> As can be seen in <cross-reference target="DRAWINGS">FIGS. 17 and 18</cross-reference>, connected to the output of the capacitor <highlight><bold>916</bold></highlight> and the buck converter <highlight><bold>1510</bold></highlight> is a high-frequency inverter circuit <highlight><bold>2110</bold></highlight> for providing a high-frequency voltage to a resonant tank circuit <highlight><bold>2220</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 18</cross-reference>, for driving a lamp current through a gas discharge lamp. The inverter circuit <highlight><bold>2110</bold></highlight> includes series-connected first and second controllably conductive devices <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight>. The bus voltage is the greater of either the rectified line voltage, or the voltage across the capacitor <highlight><bold>916</bold></highlight>. When the rectified line voltage is greater than the voltage on the capacitor <highlight><bold>916</bold></highlight>, then the inverter circuit <highlight><bold>2110</bold></highlight> draws current directly from the AC line. When the rectified line voltage is less than the voltage on capacitor <highlight><bold>916</bold></highlight>, then the inverter circuit <highlight><bold>2110</bold></highlight> draws current from the capacitor <highlight><bold>916</bold></highlight>. </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> When the inverter circuit draws current directly from the AC line for greater than 90&deg; of each 180&deg; line frequency half cycle around the time of the peak of the AC line, the resulting THD of the ballast input current has been found to be less than 33.3%. </paragraph>
<paragraph id="P-0078" lvl="0"><number>&lsqb;0078&rsqb;</number> The operation of the inverter circuit <highlight><bold>2110</bold></highlight> will now be described in connection with <cross-reference target="DRAWINGS">FIG. 19</cross-reference>. The inverter circuit <highlight><bold>2110</bold></highlight> uses a fixed frequency, D(<highlight><bold>1</bold></highlight>-D) complementary duty cycle switching mode of operation. This means that one, and only one, of the switching devices <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight> is conducting at all times. In this discussion, the duty cycle D refers to the conduction time of the first switch <highlight><bold>2112</bold></highlight>, and the complementary duty cycle (<highlight><bold>1</bold></highlight>-D) refers to the conduction time of the second switch <highlight><bold>924</bold></highlight>. Considering that one of the devices <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight> is conducting at all times, the sum of the conduction times referred to as D and (<highlight><bold>1</bold></highlight>-D) of each respective device is the period of the switching frequency. In practical electronic circuits there is usually a time when neither device <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight> is conducting, commonly referred to as dead time. This dead time is normally very short with respect to the conduction times of device <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight>. The purpose of this dead time is to ensure that both devices <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight> do not conduct simultaneously. However, this dead time may be increased and used as an additional control parameter of the inverter circuit. When switch <highlight><bold>2112</bold></highlight> (referred to as SW <highlight><bold>1</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 19</cross-reference>) is conducting, then the output of the inverter circuit <highlight><bold>2110</bold></highlight> is connected to the buck converter circuit output terminal <highlight><bold>928</bold></highlight> which is the valley filled voltage. When the switching device <highlight><bold>924</bold></highlight> (referred to as SW<highlight><bold>2</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 19</cross-reference>) is conducting, then the output of the inverter circuit <highlight><bold>2110</bold></highlight> is connected to the buck converter circuit output terminal <highlight><bold>930</bold></highlight>, which is circuit common. For a given instantaneous valley filled voltage, the maximum lamp current that could be delivered to the gas discharge lamp for that instantaneous valley filled voltage is achieved when the conduction times of the two switching devices <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight> are equal. In this electronic ballast the lamp current depends on both the instantaneous valley filled voltage and the conduction times of the switching devices <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight>. The conduction times of the switching devices <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight> are controlled by a control circuit <highlight><bold>882</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 17</cross-reference> in response to the current flowing through the gas discharge lamps <highlight><bold>2210</bold></highlight>, <highlight><bold>2212</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 18</cross-reference>. The operation of the control circuit is described in detail below. </paragraph>
<paragraph id="P-0079" lvl="0"><number>&lsqb;0079&rsqb;</number> Conventional control algorithms used for controlling electronic ballast inverters typically adjust the conduction time of the controllably conductive devices so as to maintain rms lamp current at a constant value. Conventional control loops are slow in response so as to keep the conduction times of the controllably conductive devices nearly constant over the course of a line frequency half cycle. This algorithm, when applied to a valley fill type ballast, would result in a high current crest factor of the lamp current due to the modulation of the valley filled voltage. </paragraph>
<paragraph id="P-0080" lvl="0"><number>&lsqb;0080&rsqb;</number> The control circuit of the presently preferred embodiment adjusts the conduction times of the controllably conductive devices. The conduction time of switch <highlight><bold>2112</bold></highlight> is reduced so as to produce relatively narrow pulses and the conduction time of switch <highlight><bold>924</bold></highlight> is increased so as to produce relatively wide pulses. This reduces the peak of the envelope of the high frequency lamp current near the peak of the line frequency half cycle. This is subsequently referred to as &ldquo;hump down&rdquo; of the lamp current (<cross-reference target="DRAWINGS">FIG. 19</cross-reference>). </paragraph>
<paragraph id="P-0081" lvl="0"><number>&lsqb;0081&rsqb;</number> Reducing the lamp current near the peak of the line frequency half cycle reduces the current drawn by the inverter circuit. This effect, on its own, would thereby lower the ballast input current and raise the ballast input current total harmonic distortion. However, in the ballast of this invention, the decrease in lamp current is associated with the increase in conduction time of switch <highlight><bold>924</bold></highlight>. This increase in conduction time causes an increase in the charging current of the valley fill capacitor. This increase in valley fill current increases the total current drawn by the ballast near the peak of the line frequency half cycle. The increase in ballast current near the peak of the line frequency half cycle has the advantageous effect of reducing the ballast input current total harmonic distortion. This improvement counters the effect of increased THD caused by lowering the peak lamp current. The increase in ballast input current near the peak of the line frequency half cycle due to the increase in current drawn by the valley fill circuit is subsequently referred to as &ldquo;hump up&rdquo; of the ballast input current. See <cross-reference target="DRAWINGS">FIG. 19</cross-reference>. </paragraph>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> Although it has been described that the conduction time of switch <highlight><bold>2112</bold></highlight> is reduced so as to produce relatively narrow pulses and the conduction time of switch <highlight><bold>924</bold></highlight> is increased so as to produce relatively wide pulses, one skilled in the art could reverse the conduction times of switch <highlight><bold>2112</bold></highlight> and switch <highlight><bold>924</bold></highlight> with appropriate circuit rearrangement of the valley fill circuit so as to achieve the same hump up of ballast input current and hump down of the lamp current. </paragraph>
</section>
<section>
<heading lvl="1">The Resonant Tank Circuit </heading>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> Referring again to <cross-reference target="DRAWINGS">FIGS. 17, 18</cross-reference>, the output of the inverter circuit <highlight><bold>2110</bold></highlight> is connected to a resonant tank circuit <highlight><bold>2220</bold></highlight> comprising an inductor <highlight><bold>2222</bold></highlight> and a capacitor <highlight><bold>2224</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 18</cross-reference>). The resonant tank circuit <highlight><bold>2220</bold></highlight> filters the inverter circuit <highlight><bold>2110</bold></highlight> output voltage to supply essentially sinusoidal current to the gas discharge lamps <highlight><bold>2210</bold></highlight>, <highlight><bold>2212</bold></highlight>. In addition, the resonant tank circuit <highlight><bold>2220</bold></highlight> provides voltage gain and increased output impedance. The output of the resonant tank circuit <highlight><bold>2220</bold></highlight> is coupled to the electrodes of the gas discharge lamps <highlight><bold>2210</bold></highlight>, <highlight><bold>2212</bold></highlight> by means of a transformer <highlight><bold>2230</bold></highlight>. A DC blocking capacitor <highlight><bold>2232</bold></highlight> prevents DC current from flowing through the primary windings of the transformer <highlight><bold>2230</bold></highlight>. </paragraph>
</section>
<section>
<heading lvl="1">The Current Sense Circuit </heading>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 18</cross-reference>, the ballast also includes a current sense circuit <highlight><bold>2240</bold></highlight> comprising first and second diodes <highlight><bold>2242</bold></highlight> and <highlight><bold>2244</bold></highlight>, and resistor <highlight><bold>2246</bold></highlight>, coupled in series with the lamps <highlight><bold>2210</bold></highlight>, <highlight><bold>2212</bold></highlight>. The current sense circuit <highlight><bold>2240</bold></highlight> generates a half-wave rectified voltage across resistor <highlight><bold>2246</bold></highlight> that is proportional to lamp current and represents a measure of actual light output of the gas discharge lamp. The half-wave rectified voltage is supplied as an input to the control circuit <highlight><bold>882</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 17</cross-reference>. In an alternative embodiment, the current sensing may be performed in a well-known manner by using a current transformer, or alternatively, full-wave connected diodes. For non-dimming ballasts, and dimming ballasts where only modest performance is required, the current sense circuit may be omitted. </paragraph>
</section>
<section>
<heading lvl="1">The Control Circuit </heading>
<paragraph id="P-0085" lvl="0"><number>&lsqb;0085&rsqb;</number> The control circuit of <highlight><bold>882</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 17</cross-reference> will be described in more detail with reference to <cross-reference target="DRAWINGS">FIGS. 20, 21</cross-reference>, and <highlight><bold>22</bold></highlight>. A first embodiment of the control circuit <highlight><bold>882</bold></highlight> generates signals to control the conduction of the switching devices <highlight><bold>2112</bold></highlight> and <highlight><bold>924</bold></highlight> (<cross-reference target="DRAWINGS">FIGS. 20 and 22</cross-reference>). The control circuit <highlight><bold>882</bold></highlight> receives as an input the half-wave rectified voltage from the current sense circuit <highlight><bold>2240</bold></highlight> and generates a DC voltage that represents actual light output from the lamps. This DC voltage, representative of light output, is compared to a reference voltage, indicative of a desired light level, to adjust the duty cycles of the switching devices <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight> so as to minimize the difference between the voltage that represents the light output voltage and the reference voltage. In a dimming electronic ballast, the reference voltage may be provided by an external input such as a 0-to-10 Volt control signal. Alternatively, the reference voltage may be generated by detecting a phase angle control signal applied to the ballast by means of the AC line voltage when the ballast is supplied through a 2 wire dimming control. In the preferred embodiment of the ballast, the reference voltage is generated from a phase angle control signal applied to the ballast via an additional input to the ballast, such as is depicted in <cross-reference target="DRAWINGS">FIGS. 17, 20</cross-reference>, <highlight><bold>22</bold></highlight> by the &ldquo;Dimmed Hot&rdquo; input. </paragraph>
<paragraph id="P-0086" lvl="0"><number>&lsqb;0086&rsqb;</number> The control circuit includes a feedback circuit <highlight><bold>2440</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 20</cross-reference>) connected to receive inputs from the current sense circuit <highlight><bold>2240</bold></highlight> and a control input circuit <highlight><bold>2460</bold></highlight>, and supplies conduction signals to the control terminals of the controllably conductive devices <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight>. The control circuit may optionally include a wave shaping circuit <highlight><bold>2480</bold></highlight> to provide an additional input to the feedback circuit <highlight><bold>2440</bold></highlight>, as will be described in detail below. </paragraph>
<paragraph id="P-0087" lvl="0"><number>&lsqb;0087&rsqb;</number> As can be seen in <cross-reference target="DRAWINGS">FIG. 22</cross-reference>, the feedback circuit <highlight><bold>2440</bold></highlight> includes a differential amplifier <highlight><bold>2442</bold></highlight> connected to receive at its inverting terminal <highlight><bold>2444</bold></highlight> the input signal representative of lamp light output from the current sense circuit <highlight><bold>2240</bold></highlight>, and to receive at its non-inverting terminal <highlight><bold>2446</bold></highlight> the desired light level reference signal. The differential amplifier <highlight><bold>2442</bold></highlight> produces an error signal representative of the difference between the actual light output the desired light output. The error signal is in turn provided to a pulse-width modulation (PWM) circuit <highlight><bold>2448</bold></highlight> that generates the drive signals that are applied to the gates of the inverter circuit switches <highlight><bold>2112</bold></highlight>, <highlight><bold>924</bold></highlight>. The PWM circuit <highlight><bold>2448</bold></highlight> is well-known in the art and hence will not be described in detail here. </paragraph>
<paragraph id="P-0088" lvl="0"><number>&lsqb;0088&rsqb;</number> The wave shaping circuit <highlight><bold>2480</bold></highlight> provides an AC reference voltage signal that is summed with the essentially DC reference voltage signal from the control input circuit <highlight><bold>2460</bold></highlight>. While the shape of the AC reference voltage signal can be made to take on a variety of waveshapes, a particularly effective, yet simple, circuit can be designed that takes advantage of the waveforms already present in the ballast. The wave shaping circuit <highlight><bold>2480</bold></highlight>, shown in detail in <cross-reference target="DRAWINGS">FIG. 22</cross-reference>, includes a voltage divider including a resistor <highlight><bold>2482</bold></highlight> connected in series with an automatic gain control (AGC) circuit <highlight><bold>2690</bold></highlight> that provides a scaled version of the valley filled voltage from the buck converter circuit <highlight><bold>1510</bold></highlight>. Details of the AGC <highlight><bold>2690</bold></highlight> are shown in <cross-reference target="DRAWINGS">FIG. 23</cross-reference> and discussed below. If it is not necessary to adjust the gain of the wave shaping circuit <highlight><bold>2480</bold></highlight>, such as in non-dimming ballasts, then the AGC <highlight><bold>2690</bold></highlight> may optionally be replaced by a passive impedance such as a resistor. </paragraph>
<paragraph id="P-0089" lvl="0"><number>&lsqb;0089&rsqb;</number> The scaled voltage signal from the divider is clipped by means of a diode <highlight><bold>2486</bold></highlight> having its anode connected to the output of the divider and its cathode connected to a DC reference voltage VREF. The clipped signal is then passed through a DC blocking capacitor <highlight><bold>2488</bold></highlight> to be summed with the DC reference voltage from the control input circuit <highlight><bold>2460</bold></highlight>. </paragraph>
<paragraph id="P-0090" lvl="0"><number>&lsqb;0090&rsqb;</number> The control circuit also includes a low end clamp <highlight><bold>2680</bold></highlight> connected between the common tie point for the control input, wave shaping, and feedback circuitry, and circuit common. The low end clamp <highlight><bold>2680</bold></highlight> prevents the reference voltage from going so low that the current through the lamp cannot be sustained. </paragraph>
<paragraph id="P-0091" lvl="0"><number>&lsqb;0091&rsqb;</number> The addition of the AC reference signal has the effect of reducing the combined reference voltage when the valley filled voltage is lower, such as near the zero crossings of the input line voltage, and increasing the combined reference voltage as the valley filled voltage is increasing, such as when the input line voltage is approaching an instantaneous peak value. The lamp current supplied to the lamp by the inverter circuit <highlight><bold>2110</bold></highlight> will likewise be less when the valley filled voltage is lower, and increasing when the valley filled voltage is increasing. Thus, the addition of the AC reference signal, which tracks or follows the valley filled voltage, has the effect of shaping the current drawn by the lamp to be similar in shape to that of the valley filled voltage. Consequently the ballast input current has a shape which is lower near the valleys and higher near the peaks of the AC line voltage, thereby improving the ballast input current total harmonic distortion. However, this improvement in ballast input current total harmonic distortion comes at the expense of greater crest factor of the lamp current. </paragraph>
<paragraph id="P-0092" lvl="0"><number>&lsqb;0092&rsqb;</number> An additional feature of the wave shaping circuit <highlight><bold>2480</bold></highlight> is the diode <highlight><bold>2486</bold></highlight> for clipping the peaks of the AC reference signal. During the time when the AC reference voltage signal is clipped, the combined reference voltage remains constant while the valley filled voltage is peaking. The overall response of the control circuit is designed to be &ldquo;fast&rdquo;, so the control circuit responds quickly during the peaks in the bus voltage so as to reduce the conduction time of switch <highlight><bold>2112</bold></highlight> and increase the conduction time of switch <highlight><bold>924</bold></highlight>, so as to deliver a more constant high frequency voltage to the resonant tank, and thus, a constant lamp current, to the lamp. The net effect is to reduce the peaks of the lamp current envelope, and thus reduce current crest factor of the lamp current. This is shown in <cross-reference target="DRAWINGS">FIG. 19</cross-reference>, as a hump down of the lamp current. At the same time, the increase in conduction time of switch <highlight><bold>924</bold></highlight> increases the charging current drawn by the capacitor <highlight><bold>916</bold></highlight>, as shown in <cross-reference target="DRAWINGS">FIG. 19</cross-reference>. This causes the ballast input current to increase over that which would have occurred without the increase in charging current of capacitor <highlight><bold>916</bold></highlight>, and thus hump up the ballast input current. This effect reduces the ballast input current total harmonic distortion. Electronic dimming ballasts constructed with the wave shaping circuit as described have achieved stable operation with ballast input current total harmonic distortion below 20% and current crest factor of the lamp current below 1.7. </paragraph>
<paragraph id="P-0093" lvl="0"><number>&lsqb;0093&rsqb;</number> The AGC circuit <highlight><bold>2690</bold></highlight>, shown in <cross-reference target="DRAWINGS">FIG. 22</cross-reference>, changes the output of wave shaping circuit <highlight><bold>2480</bold></highlight> when the ballast is required to reduce the lamp current and thereby dim the lamp. The AGC circuit <highlight><bold>2690</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 23</cross-reference> includes first and second transistors <highlight><bold>2691</bold></highlight> and <highlight><bold>2692</bold></highlight>, resistors <highlight><bold>2693</bold></highlight>, <highlight><bold>2694</bold></highlight>, and <highlight><bold>2695</bold></highlight>, and diode <highlight><bold>2696</bold></highlight>. The conduction of the first transistor <highlight><bold>2691</bold></highlight> is controlled by the output of the control input <highlight><bold>2460</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 22</cross-reference>). When the input voltage goes low, indicating a dimming condition, conduction of the first transistor <highlight><bold>2691</bold></highlight> increases, lowering the voltage at the base of the second transistor <highlight><bold>2692</bold></highlight>, thereby causing the second transistor <highlight><bold>2692</bold></highlight> to become less conductive, effectively increasing the impedance of the AGC circuit <highlight><bold>2690</bold></highlight> presented to the wave shaping circuit <highlight><bold>2480</bold></highlight>. The increase of impedance of the AGC circuit <highlight><bold>2690</bold></highlight> increases the voltage at the junction of the AGC circuit <highlight><bold>2690</bold></highlight> and resistor <highlight><bold>2482</bold></highlight> resulting in more of the signal being clipped by diode <highlight><bold>2486</bold></highlight>. As this voltage rises and gets increasingly clipped, the AC portion of this voltage is reduced, thereby reducing the effect of the wave shaping circuit. </paragraph>
<paragraph id="P-0094" lvl="0"><number>&lsqb;0094&rsqb;</number> A second embodiment of the feedback circuit <highlight><bold>2440</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 20</cross-reference> is shown in <cross-reference target="DRAWINGS">FIG. 24</cross-reference> and includes a microprocessor <highlight><bold>26102</bold></highlight> coupled to receive inputs representative of the desired light level and the lamp current, and produce output signals for driving the control terminals of the controllably conductive devices of the inverter circuit. One such microprocessor suitable for this use is manufactured by Motorola Corporation under the model number MC68HC08. For simplicity, analog-to-digital and digital-to-analog circuits necessary for interfacing the microprocessor <highlight><bold>26102</bold></highlight> with the analog circuitry of the ballast are considered to be within the ordinary skill of the art and are not shown here. </paragraph>
<paragraph id="P-0095" lvl="0"><number>&lsqb;0095&rsqb;</number> A third embodiment of the feedback circuit <highlight><bold>2440</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 20</cross-reference> is shown in <cross-reference target="DRAWINGS">FIG. 25</cross-reference> and includes, in addition to the microprocessor <highlight><bold>26102</bold></highlight>, a gate driver circuit <highlight><bold>26104</bold></highlight> that receives a single gate drive signal from the microprocessor <highlight><bold>26102</bold></highlight> and produces signals capable of controlling the operation of the inverter circuit switches. One such gate driver circuit suitable for this use is manufactured by International Rectifier under the part number IR2111. Of course, other suitable microprocessors (such as a PIC 16C54A from Microchip Technology Inc. of Chandler, Ariz.) and gate drivers may be substituted for the specific embodiments mentioned here. In addition, an application specific integrated circuit (ASIC) (not shown) or a digital signal processor (DSP) (not shown) may be substituted to provide the same functionality as the microprocessor disclosed herein. </paragraph>
<paragraph id="P-0096" lvl="0"><number>&lsqb;0096&rsqb;</number> A high-level flowchart illustrating the operation of the feedback control circuit embodiment of <cross-reference target="DRAWINGS">FIGS. 24 and 25</cross-reference>, shown in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>, includes the steps of measuring the lamp current IL (step <highlight><bold>26110</bold></highlight>), and measuring the dimming signal VDIM representative of the desired light level (step <highlight><bold>26120</bold></highlight>). The measured lamp current IL is compared to the measured dimming signal VDIM (step <highlight><bold>26130</bold></highlight>) and, if IL is less than VDIM, then the conduction times of the controllably conductive devices of the inverter circuit are driven to be more equal (step <highlight><bold>26140</bold></highlight>). If IL is greater than VDIM as determined in step <highlight><bold>26150</bold></highlight>, then the conduction times of the controllably conductive devices of the inverter circuit are driven to be more unequal (step <highlight><bold>26160</bold></highlight>). If IL is equal to VDIM, then the conduction times of the controllably conductive devices of the inverter circuit remain unchanged and the process repeats. </paragraph>
</section>
<section>
<heading lvl="1">The Cat Ear Circuit </heading>
<paragraph id="P-0097" lvl="0"><number>&lsqb;0097&rsqb;</number> Cat ear circuits have been used for years to provide power for control circuits in two-wire, triac based dimmers for incandescent lamps and fan motors. A typical prior art cat ear circuit is shown in <cross-reference target="DRAWINGS">FIG. 27</cross-reference>. Standard electronic dimmers for lighting loads are well known and circuits using the cat ear power supply circuit are also well known. In such applications, the dimmer is located between the AC line and the load, receiving as an input sinusoidal voltage from the AC line and providing as an output a &ldquo;truncated&rdquo; form of the sinusoidal input voltage in which the leading edge of the input voltage waveform is blocked by the non-conducting triac, and only the trailing portion of the input voltage waveform is passed on to the load by the triac, when the triac is conducting. The triac is turned on at a predetermined time and conducts until the next zero crossing of the input voltage waveform. By varying the time until conduction of the triac, with respect to the zero crossing of the AC line voltage, the amount of power delivered to the load may be controlled. </paragraph>
<paragraph id="P-0098" lvl="0"><number>&lsqb;0098&rsqb;</number> The prior art cat ear circuit of a 2 wire dimmer draws power from the AC line during a portion of the input voltage waveform when the triac is not conducting. In other words, the prior art cat ear circuit draws current from the line, through the load, during the time that no significant load current would normally flow. However, until now, cat ear circuits have only been used to derive an auxiliary power supply to operate control circuits within an electronic device. They have not been used for the purpose of deliberately shaping the input current drawn from the line by an electronic device. Specifically, cat ear circuits, until now, have not been used in electronic ballasts to assist in the shaping of input current nor have they been used as an auxiliary power supply in an electronic ballast. In the ballast of the invention the input current shaping benefits of the cat ear circuit contribute to the reduction of ballast input current total harmonic distortion. </paragraph>
<paragraph id="P-0099" lvl="0"><number>&lsqb;0099&rsqb;</number> The ballast of the invention includes a cat ear circuit <highlight><bold>884</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 20</cross-reference>) connected across the outputs of the rectifying circuit <highlight><bold>820</bold></highlight>. The cat ear circuit may be generally defined as a circuit that is designed to draw current from the line during selected portions of the line cycle. The cat ear circuit may thus be used in a novel and unique manner for shaping the ballast input current waveform so as to improve ballast input current total harmonic distortion. Indeed, the cat ear circuit may be used for shaping the input current waveform of a variety of electronic devices, such as switch-mode power supplies and AC line-to-DC converters and for reducing input current total harmonic distortion. </paragraph>
<paragraph id="P-0100" lvl="0"><number>&lsqb;0100&rsqb;</number> The cat ear circuit <highlight><bold>884</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 20</cross-reference>) draws current from the rectifier <highlight><bold>820</bold></highlight> only at the &ldquo;tails&rdquo; of the input line cycle, that is, the regions of the input line cycle near the line voltage zero crossings, as shown in <cross-reference target="DRAWINGS">FIG. 28</cross-reference>. The cat ear circuit <highlight><bold>884</bold></highlight> draws current near line voltage zero cross and thereby &ldquo;fills in&rdquo; the tails of the input line current drawn from the AC line when the back end of the ballast is not drawing current from the AC line (<cross-reference target="DRAWINGS">FIG. 19</cross-reference>). By filling in the tails, the line current drawn by the ballast is made more continuous, thereby reducing ballast input current total harmonic distortion, as will be described in connection with <cross-reference target="DRAWINGS">FIG. 31</cross-reference>. </paragraph>
<paragraph id="P-0101" lvl="0"><number>&lsqb;0101&rsqb;</number> The cat ear circuit draws ballast input current for a relatively short time at the tails of each 180 degree line frequency half cycle as shown in <cross-reference target="DRAWINGS">FIG. 31</cross-reference>. In one embodiment, the cat ear circuit draws ballast input current for about 45 degrees of each 180 degree line frequency half cycle following a zero crossing (interval I in <cross-reference target="DRAWINGS">FIG. 31</cross-reference>). Then, the inverter circuit draws ballast input current for about 90 degrees of each 180 degree line frequency half cycle (interval II in <cross-reference target="DRAWINGS">FIG. 31</cross-reference>). Finally, the cat ear circuit draws ballast input current for about 45 degrees of each 180 degree line frequency half cycle before a subsequent zero crossing (interval III in <cross-reference target="DRAWINGS">FIG. 31</cross-reference>). </paragraph>
<paragraph id="P-0102" lvl="0"><number>&lsqb;0102&rsqb;</number> This embodiment shows the cat ear circuit drawing ballast input current for about 45 degrees after the zero crossing and about 45 degrees before the subsequent zero crossing. However, one skilled in the art can see that the time may be varied where the cat ear circuit draws ballast input current. For example: the cat ear circuit draws ballast input current for about 35 degrees of each 180 degree line frequency half cycle following the zero crossing, then the inverter circuit draws ballast input current for about 90 degrees of each 180 degree line frequency half cycle, and finally the cat ear circuit draws ballast input current for about 55 degrees of each 180 degree line frequency half cycle before the subsequent zero crossing, without exceeding the desired maximum THD and without departing from the scope or spirit of the invention. Also, one skilled in the art can see that some dead time where no ballast input current is drawn by either the cat ear circuit or the inverter circuit may occur without exceeding the desired maximum THD and without departing from the scope or spirit of the invention. </paragraph>
<paragraph id="P-0103" lvl="0"><number>&lsqb;0103&rsqb;</number> In a first embodiment <highlight><bold>2810</bold></highlight> of the cat ear circuit <highlight><bold>884</bold></highlight>, shown in <cross-reference target="DRAWINGS">FIG. 29</cross-reference>, the cat ear circuit <highlight><bold>2810</bold></highlight> is designed with fixed voltage cut-in and cut-out points. That is, the first embodiment <highlight><bold>2810</bold></highlight> of the cat ear circuit will only draw current from the AC line when the rectified line voltage is below a fixed value. This condition will occur for a period of time near the line voltage zero crossing. The cut-out and cut-in voltage points can be adjusted so that the cat ear circuit <highlight><bold>2810</bold></highlight> draws current during a first interval from a time just after the line voltage zero crossing to a time when the inverter circuit <highlight><bold>2110</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 22</cross-reference> is drawing current from the AC line, and during a second interval from a time when the inverter circuit <highlight><bold>2110</bold></highlight> stops drawing current from the AC line until the next line voltage zero crossing. </paragraph>
<paragraph id="P-0104" lvl="0"><number>&lsqb;0104&rsqb;</number> When the rectified line voltage is lower than a selected voltage, a charging transistor <highlight><bold>2812</bold></highlight> (<cross-reference target="DRAWINGS">FIG. 29</cross-reference>)conducts to allow charging of an energy storage capacitor <highlight><bold>2814</bold></highlight>, which charges toward a voltage VCC. The rate of charge of the capacitor <highlight><bold>2814</bold></highlight> is determined by a resistor <highlight><bold>2816</bold></highlight> in series with the drain of the MOSFET transistor <highlight><bold>2812</bold></highlight>. This current drawn by the cat ear circuit when combined with the current drawn by the back end circuit of the ballast combines to form substantially piece-wise continuous ballast input current. Although the transistor <highlight><bold>2812</bold></highlight> is shown as a MOSFET, it may be any suitable controllably conductive device, such as, without limitation, a BJT or an IGBT. </paragraph>
<paragraph id="P-0105" lvl="0"><number>&lsqb;0105&rsqb;</number> When the rectified line voltage is equal to or greater than the predetermined voltage, then cut-out transistor <highlight><bold>2818</bold></highlight> begins conducting. The collector of the cut-out transistor <highlight><bold>2818</bold></highlight> pulls the cathode of a Zener diode <highlight><bold>2820</bold></highlight> toward VCC, which effectively turns off the charging transistor <highlight><bold>2812</bold></highlight>. The predetermined cut-in and cut-out voltages are determined by the resistive voltage divider network including resistors <highlight><bold>2822</bold></highlight> and <highlight><bold>2824</bold></highlight>, to which the base of the cut-out transistor <highlight><bold>2818</bold></highlight> is connected. </paragraph>
<paragraph id="P-0106" lvl="0"><number>&lsqb;0106&rsqb;</number> It should be noted that the cat ear circuit of the invention also provides a power supply for the control circuit of the ballast. This enables the ballast to draw current during a predetermined portion of each half cycle of the AC line. This portion can include periods before and after line voltage zero crossings, or only one such period, or any other useful period during the line cycle. </paragraph>
<paragraph id="P-0107" lvl="0"><number>&lsqb;0107&rsqb;</number> In a second embodiment <highlight><bold>2910</bold></highlight> of the cat ear circuit <highlight><bold>884</bold></highlight>, shown in <cross-reference target="DRAWINGS">FIG. 30</cross-reference>, the cat ear circuit <highlight><bold>2910</bold></highlight> includes a circuit that actively monitors current drawn from the back end of the ballast and causes the cat ear circuit to only draw current from the line when the back end is not drawing current above a predetermined value. The current monitor circuit includes transistor <highlight><bold>2930</bold></highlight>, capacitor <highlight><bold>2932</bold></highlight>, resistors <highlight><bold>2934</bold></highlight>, <highlight><bold>2936</bold></highlight>, and diodes <highlight><bold>2938</bold></highlight>, <highlight><bold>2940</bold></highlight>. The ballast back end current flows through diodes <highlight><bold>2938</bold></highlight>,<highlight><bold>2940</bold></highlight> and resistor <highlight><bold>2936</bold></highlight> as it returns to the input rectifying circuit <highlight><bold>820</bold></highlight>. When the ballast back end is drawing current above the predetermined value, the voltage at the emitter of transistor <highlight><bold>2930</bold></highlight> goes negative by a voltage equivalent to the combined forward voltage drops of diodes <highlight><bold>2938</bold></highlight>, <highlight><bold>2940</bold></highlight>. Through resistor <highlight><bold>2934</bold></highlight>, the transistor <highlight><bold>2930</bold></highlight> base-emitter junction becomes forward biased, thereby turning transistor <highlight><bold>2930</bold></highlight> on. Turning transistor <highlight><bold>2930</bold></highlight> on pulls the gate of transistor <highlight><bold>2812</bold></highlight> low, thereby turning off transistor <highlight><bold>2812</bold></highlight>. When back end current falls below the predetermined value set by the voltage divider of resistors <highlight><bold>2936</bold></highlight>,<highlight><bold>2934</bold></highlight> the, transistor <highlight><bold>2930</bold></highlight> turns off allowing transistor <highlight><bold>2812</bold></highlight> to turn on and provides a charging path for capacitor <highlight><bold>2814</bold></highlight>. This second embodiment yields a slight improvement in ballast input current total harmonic distortion over the first embodiment. </paragraph>
<paragraph id="P-0108" lvl="0"><number>&lsqb;0108&rsqb;</number> The particular embodiments of the cat ear circuit that have been described show the cat ear circuit connected to the source of AC power through the rectifying circuit. Of course, it would be possible to build a cat ear circuit that connects directly to the source of AC power rather than through the rectifying circuit. For example, the particular embodiments of the cat ear circuit that have been described could alternately include a separate rectifier for connection to the source of AC power. </paragraph>
<paragraph id="P-0109" lvl="0"><number>&lsqb;0109&rsqb;</number> In addition to providing a means for shaping the input current drawn by the ballast so as to improve ballast input current total harmonic distortion, the cat ear circuit provides the following additional feature. The cat ear circuit also advantageously provides a faster start-up of the ballast and is not affected by the operating mode of the ballast in the same way that typical prior art trickle-charge and bootstrap systems are affected. Effectively the cat ear circuit and the inverter circuit are decoupled from each other allowing the fine tuning of each without affecting the other. </paragraph>
<paragraph id="P-0110" lvl="0"><number>&lsqb;0110&rsqb;</number> The result of combining the improved valley fill circuit, control circuits, and cat ear circuit of the present invention may be seen in <cross-reference target="DRAWINGS">FIG. 31</cross-reference>. The cat ear circuit comprises means for drawing input current near the zero crossing of the input AC line voltage waveform so that the ballast input current total harmonic distortion is substantially reduced. In other words, the cat ear circuit fills in the current waveform near the zero crossings. </paragraph>
<paragraph id="P-0111" lvl="0"><number>&lsqb;0111&rsqb;</number> The improved valley fill circuit of the invention comprise means for charging an energy storage device over a substantial portion of each half-cycle of the AC input voltage so that the ballast input current total harmonic distortion is reduced. This is depicted in the idealized waveform in <cross-reference target="DRAWINGS">FIG. 31</cross-reference> wherein it may be seen that in the middle portion of each line half-cycle, the ideal waveform conforms substantially to a sinusoidal current waveform. </paragraph>
<paragraph id="P-0112" lvl="0"><number>&lsqb;0112&rsqb;</number> The combination of the cat ear circuit and the improved valley fill circuit comprises means for selectively drawing current from the AC power source </paragraph>
<paragraph id="P-0113" lvl="0"><number>&lsqb;0113&rsqb;</number> The operation of the ballast is further enhanced by the control circuit disclosed herein which comprises means for selectively varying the conduction times of the inverter circuit switches in response to the bus voltage so as to cause an energy storage device to draw more current from the AC power source around the time of the peak of each line half-cycle of the AC line voltage, and draw less current near the valleys of each line half-cycle of the AC line voltage as described in <cross-reference target="DRAWINGS">FIG. 19</cross-reference>. </paragraph>
<paragraph id="P-0114" lvl="0"><number>&lsqb;0114&rsqb;</number> The provision of an independent power supply, that is, one that derives its power directly from the line at the front end of the ballast, either through the ballast&apos;s own rectifier stage, or through its own dedicated rectifier, rather than from the secondary of a transformer associated with the ballast back end or APFC, greatly simplifies the handling of transient conditions upon start up, shut down, and during abnormal or fault conditions. In the present case, the preferred form of such an independent power supply is the previously described cat ear circuit configured as a power supply. Thus, the independent power supply of the preferred embodiment allows for the decoupling of the power supply from the back end, thereby simplifying control of the ballast, while simultaneously providing a means to more precisely control the manner in which current is drawn from the line so as to reduce ballast input current total harmonic distortion. </paragraph>
<paragraph id="P-0115" lvl="0"><number>&lsqb;0115&rsqb;</number> Although the present invention has been described in relation to particular embodiments thereof many other variations and modifications and other uses will become apparent to those skilled in the art. It is preferred, therefore, that the present invention be limited not by the specific disclosure herein, but only by the appended claims. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is claimed is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. An electronic ballast for driving at least one gas discharge lamp from a source of AC power which has a substantially sinusoidal line voltage at a given line frequency, comprising: 
<claim-text>a rectifying circuit having AC input terminals and DC output terminals; said AC input terminals connectable to the source of AC power; said rectifying circuit producing a rectified output voltage at its said DC output terminals when said AC input terminals are energized by said source of AC power; </claim-text>
<claim-text>a valley fill circuit having input and output terminals; said input terminals of said valley fill circuit connected to said DC output terminals of said rectifying circuit; said valley fill circuit including an energy storage device directly chargeable from said DC output terminals through an impedance and a first controllably conductive device, said impedance carrying only charging current for said energy storage device; </claim-text>
<claim-text>an inverter circuit having input terminals connected to said output terminals of said valley fill circuit and producing a high frequency drive voltage for driving a lamp current through said at least one gas discharge lamp when said AC input terminals are energized by said source of AC power; </claim-text>
<claim-text>said inverter circuit being adapted to draw current from substantially only said source of AC power and through said rectifying circuit for a time which is greater than 90&deg; of each 180&deg; line frequency half cycle, whereby the current drawn from said source of AC power has a total harmonic distortion below 33.3%, and whereby said lamp current has a lamp current crest factor below 2.1. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the lamp current crest factor is less than about 1.7. </claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, which further includes a cat ear circuit connected to said source of AC power, said cat ear circuit being adapted to conduct current for a first relatively short time following a first zero crossing of said line voltage and for a second relatively short time prior to the next zero crossing of said line voltage thereby to reduce the total harmonic distortion of the current drawn from said source of AC power below that which would occur in the absence of said cat ear circuit. </claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein the current drawn from said source of AC power has a total harmonic distortion below about 20%. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein said cat ear circuit draws current from said source of AC power when the instantaneous value of said line voltage is less than a predetermined absolute value. </claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein said cat ear circuit draws current from said source of AC power only when said current drawn by said inverter circuit is substantially zero. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein said cat ear circuit draws current from said source of AC power at least when said current drawn by said inverter circuit is substantially zero. </claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. An electronic ballast for driving at least one gas discharge lamp from a source of AC power which has a substantially sinusoidal line voltage at a given line frequency, comprising: 
<claim-text>a rectifying circuit having AC input terminals and DC output terminals; said AC input terminals connectable to the source of AC power; said rectifying circuit producing a rectified output voltage at its said DC output terminals when said AC input terminals are energized by said source of AC power; </claim-text>
<claim-text>an inverter circuit having input terminals connected to said output terminals of said rectifying circuit and producing a high frequency drive voltage for driving a lamp current through said at least one gas discharge lamp when said AC input terminals are energized by said source of AC power; </claim-text>
<claim-text>and a cat ear circuit connected to said source of AC power, said cat ear circuit being adapted to conduct current for a first relatively short time following a first zero crossing of said line voltage and for a second relatively short time prior to the next zero crossing of said line voltage thereby to reduce the total harmonic distortion of the current drawn from said source of AC power below that which would occur in the absence of said cat ear circuit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00008">claim 8</dependent-claim-reference>, wherein said cat ear circuit further comprises a cat ear power supply. </claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00008">claim 8</dependent-claim-reference>, wherein said cat ear circuit draws current from said source of AC power only when the instantaneous value of said line voltage is less than a predetermined absolute value. </claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00008">claim 8</dependent-claim-reference>, wherein said cat ear circuit draws current from said source of AC power only when the current drawn by said inverter circuit from said source of AC power is substantially zero. </claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00008">claim 8</dependent-claim-reference>, wherein said cat ear circuit draws current from said source of AC power at least when the current drawn by said inverter circuit from said source of AC power is substantially zero. </claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00009">claim 9</dependent-claim-reference>, wherein said electronic ballast includes an auxiliary circuit coupled thereto which has an auxiliary circuit power supply input terminal; said cat ear circuit coupled to and driving said auxiliary circuit power supply input terminal. </claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. An electronic ballast for driving at least one gas discharge lamp from a source of AC power which has a substantially sinusoidal line voltage at a given line frequency, comprising: 
<claim-text>a rectifying circuit having AC input terminals and DC output terminals; said AC input terminals connectable to the source of AC power; said rectifying circuit producing a rectified output voltage at its said DC output terminals when said AC input terminals are energized by said source of AC power; </claim-text>
<claim-text>a valley fill circuit having input and output terminals; said input terminals of said valley fill circuit connected to said DC output terminals of said rectifying circuit; </claim-text>
<claim-text>an inverter circuit having input terminals connected to said output terminals of said valley fill circuit and producing a high frequency drive voltage for driving a lamp current through said at least one gas discharge lamp when said AC input terminals are energized by said source of AC power; </claim-text>
<claim-text>said inverter circuit being adapted to draw current substantially only from said source of AC power and through said rectifying circuit for a time which is greater than 90&deg; of each 180&deg; line frequency half cycle; </claim-text>
<claim-text>and a cat ear circuit connected to said source of AC power, said cat ear circuit being adapted to conduct current for a first relatively short time following a first zero crossing of said line voltage and for a second relatively short time prior to the next zero crossing of said line voltage, thereby to reduce the total harmonic distortion of the current drawn from said source of AC power below 33.3%. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00011">claim 14</dependent-claim-reference>, wherein the total harmonic distortion of the current drawn from the source of AC power is below about 20%. </claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00011">claim 14</dependent-claim-reference>, wherein said cat ear circuit comprises a cat ear power supply. </claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00011">claim 14</dependent-claim-reference>, wherein said cat ear circuit draws current from said source of AC power only when said line voltage is less than a predetermined absolute value. </claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00011">claim 14</dependent-claim-reference>, wherein said cat ear circuit draws current from said source of AC power only when said current drawn by said inverter circuit from said source of AC power is substantially zero. </claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00011">claim 14</dependent-claim-reference>, wherein said cat ear circuit draws current from said source of AC power at least when said current drawn by said inverter circuit is substantially zero. </claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. An electronic ballast for driving at least one gas discharge lamp from a source of AC power which has a substantially sinusoidal line voltage at a given line frequency, comprising: 
<claim-text>a rectifying circuit having AC input terminals and DC output terminals; said AC input terminals connectable to the source of AC power; said rectifying circuit producing a rectified output voltage at its said DC output terminals when said AC input terminals are energized by said source of AC power; </claim-text>
<claim-text>a valley fill circuit having input and output terminals; said input terminals of said valley fill circuit connected to said DC output terminals of said rectifying circuit; said valley fill circuit including an energy storage device directly chargeable from said DC output terminals through an impedance and a first controllably conductive device, said impedance carrying only charging current for said energy storage device; </claim-text>
<claim-text>an inverter circuit having input terminals connected to said output terminals of said valley fill circuit and producing a high frequency drive voltage for driving a lamp current through said at least one gas discharge lamp when said AC input terminals are energized by said source of AC power; </claim-text>
<claim-text>and a valley fill control circuit coupled to said energy storage device and operable to enable said energy storage device to draw charging current from said rectifying circuit for a time greater than 90&deg; of each 180&deg; line frequency half cycle, whereby the current drawn from the source of AC power has a total harmonic distortion below 33.3%. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00021">
<claim-text><highlight><bold>21</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 20</dependent-claim-reference>, wherein said valley fill control circuit includes an inductor. </claim-text>
</claim>
<claim id="CLM-00022">
<claim-text><highlight><bold>22</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 20</dependent-claim-reference>, wherein said valley fill control circuit includes a tapped inductor. </claim-text>
</claim>
<claim id="CLM-00023">
<claim-text><highlight><bold>23</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 20</dependent-claim-reference>, wherein said first controllably conductive device is a MOSFET. </claim-text>
</claim>
<claim id="CLM-00024">
<claim-text><highlight><bold>24</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 20</dependent-claim-reference>, wherein said inverter circuit includes said first controllably conductive device; whereby said first controllably conductive device serves a dual purpose. </claim-text>
</claim>
<claim id="CLM-00025">
<claim-text><highlight><bold>25</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 20</dependent-claim-reference>, wherein said inverter circuit includes series connected second and third controllably conductive devices connected across said input terminals of said inverter circuit, whereby each of the three controllably conductive devices are independent devices. </claim-text>
</claim>
<claim id="CLM-00026">
<claim-text><highlight><bold>26</bold></highlight>. An electronic ballast for driving at least one gas discharge lamp which draws ballast input current from a source of AC power which has a substantially sinusoidal line voltage at a given line frequency, comprising: 
<claim-text>a rectifying circuit having AC input terminals and DC output terminals; said AC input terminals connectable to the source of AC power; said rectifying circuit producing a rectified output voltage at its said DC output terminals when said AC input terminals are energized by said source of AC power; </claim-text>
<claim-text>a valley fill circuit having input and output terminals; said input terminals of said valley fill circuit connected to said DC output terminals of said rectifying circuit; </claim-text>
<claim-text>an inverter circuit coupled between said output terminals of said valley fill circuit and said at least one gas discharge lamp and including series connected first and second controllably conductive devices; said inverter circuit producing a high frequency drive voltage for driving a lamp current through said at least one gas discharge lamp; </claim-text>
<claim-text>an inverter control circuit coupled to and independently controlling the conduction times of said series connected first and second controllably conductive devices; </claim-text>
<claim-text>said inverter control circuit being operable to reduce the conduction time of said first controllably conductive device to produce a relatively narrow pulse and, simultaneously, increase the conduction time of said second controllably conductive device to produce a relatively wide pulse during the period around the instantaneous peak absolute voltage of each line frequency half cycle, whereby the magnitude of the envelope of said lamp current humps down below the magnitude that would occur in the absence of said changes in said conduction times, causing a reduction in the current crest factor of said lamp current, and whereby said increase in the conduction time of said second controllably conductive device causes said ballast input current to hump up above the magnitude that would occur in the absence of said increase in conduction time, causing a reduction in the total harmonic distortion of said ballast input current. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00027">
<claim-text><highlight><bold>27</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 26</dependent-claim-reference>, wherein the lamp current has a current crest factor below 2.1. </claim-text>
</claim>
<claim id="CLM-00028">
<claim-text><highlight><bold>28</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 26</dependent-claim-reference>, wherein the lamp current has a current crest factor below about 1.7. </claim-text>
</claim>
<claim id="CLM-00029">
<claim-text><highlight><bold>29</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 26</dependent-claim-reference>, wherein a current only flows through said first controllably conductive device when no current flows through said second controllably conductive device and vice versa. </claim-text>
</claim>
<claim id="CLM-00030">
<claim-text><highlight><bold>30</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 26</dependent-claim-reference>, wherein current flows alternately through said first and second controllably conductive devices. </claim-text>
</claim>
<claim id="CLM-00031">
<claim-text><highlight><bold>31</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 26</dependent-claim-reference>, wherein a sum of said conduction times of said series connected first and second controllably conductive devices is the period of said high frequency drive voltage. </claim-text>
</claim>
<claim id="CLM-00032">
<claim-text><highlight><bold>32</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 26</dependent-claim-reference>, wherein said valley fill circuit comprises a buck converter circuit. </claim-text>
</claim>
<claim id="CLM-00033">
<claim-text><highlight><bold>33</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 26</dependent-claim-reference>, wherein said valley fill circuit comprises a switched resistor circuit. </claim-text>
</claim>
<claim id="CLM-00034">
<claim-text><highlight><bold>34</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 26</dependent-claim-reference>, wherein said inverter control circuit includes a micro-controller. </claim-text>
</claim>
<claim id="CLM-00035">
<claim-text><highlight><bold>35</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 26</dependent-claim-reference>, wherein said inverter control circuit includes a digital signal processing circuit. </claim-text>
</claim>
<claim id="CLM-00036">
<claim-text><highlight><bold>36</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00022">claim 26</dependent-claim-reference>, wherein said inverter control circuit includes an ASIC. </claim-text>
</claim>
<claim id="CLM-00037">
<claim-text><highlight><bold>37</bold></highlight>. An electronic ballast for driving at least one lamp comprising: 
<claim-text>a rectifying circuit operatively connectable to an AC line; </claim-text>
<claim-text>a current drawing circuit connected across said rectifying circuit; and </claim-text>
<claim-text>an inverter circuit connected to said rectifying circuit that supplies a lamp current to said at least one lamp; </claim-text>
<claim-text>wherein said current drawing circuit draws current from said AC line when the instantaneous voltage of said AC line nears zero to reduce the total harmonic distortion of the input current drawn by said ballast. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00038">
<claim-text><highlight><bold>38</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00033">claim 37</dependent-claim-reference>, wherein said current drawing circuit is a cat ear circuit. </claim-text>
</claim>
<claim id="CLM-00039">
<claim-text><highlight><bold>39</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00033">claim 38</dependent-claim-reference>, wherein said cat ear circuit draws current from said AC line between predetermined cut-in and cut-out points. </claim-text>
</claim>
<claim id="CLM-00040">
<claim-text><highlight><bold>40</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00033">claim 38</dependent-claim-reference>, wherein said cat ear circuit includes a monitoring circuit that actively monitors the current drawn by said inverter circuit and only draws current when said inverter circuit is not drawing current above a predetermined value. </claim-text>
</claim>
<claim id="CLM-00041">
<claim-text><highlight><bold>41</bold></highlight>. An electronic ballast for driving at least one lamp comprising: 
<claim-text>a rectifying circuit operatively connectable to an AC line; </claim-text>
<claim-text>a valley fill circuit including a capacitor; </claim-text>
<claim-text>said valley fill circuit operable to selectively charge said capacitor from said rectifying circuit through an impedance and a first electronic switching device; and </claim-text>
<claim-text>an inverter circuit including at least one electronic switching device for supplying lamp current to said at least one lamp; </claim-text>
<claim-text>wherein said capacitor is charged during at least 90&deg; of each half-cycle of said AC line. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00042">
<claim-text><highlight><bold>42</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00044">claim 41</dependent-claim-reference>, wherein said valley fill circuit includes a buck converter circuit. </claim-text>
</claim>
<claim id="CLM-00043">
<claim-text><highlight><bold>43</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00044">claim 41</dependent-claim-reference>, wherein said valley fill circuit includes an inductor. </claim-text>
</claim>
<claim id="CLM-00044">
<claim-text><highlight><bold>44</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00044">claim 41</dependent-claim-reference>, wherein said first electronic switching device is a MOSFET. </claim-text>
</claim>
<claim id="CLM-00045">
<claim-text><highlight><bold>45</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00044">claim 41</dependent-claim-reference>, wherein said valley fill circuit includes at least one of said at least one switching device of said inverter circuit. </claim-text>
</claim>
<claim id="CLM-00046">
<claim-text><highlight><bold>46</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00044">claim 41</dependent-claim-reference>, which further includes a flyback transformer coupled to said capacitor, to control the delivery of energy to said capacitor. </claim-text>
</claim>
<claim id="CLM-00047">
<claim-text><highlight><bold>47</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00044">claim 46</dependent-claim-reference>, wherein said flyback transformer is connected to said capacitor by a controllably conductive device. </claim-text>
</claim>
<claim id="CLM-00048">
<claim-text><highlight><bold>48</bold></highlight>. An electronic ballast for driving at least one lamp comprising: 
<claim-text>a rectifying circuit operatively connectable to an AC line; </claim-text>
<claim-text>a valley fill circuit including an energy storage device; </claim-text>
<claim-text>said valley fill circuit operable to selectively charge said energy storage device; </claim-text>
<claim-text>an inverter for providing a lamp current to said at least one lamp, said inverter including a first electronic switch series connected with a second electronic switch; and </claim-text>
<claim-text>a control circuit for controlling the conduction time of said first and said second electronic switches; </claim-text>
<claim-text>wherein said first electronic switch is controlled to conduct for a relatively shorter time and said second electronic switch is controlled to conduct for a relatively longer time during the time around the time of the absolute peak voltage of said AC line whereby the total harmonic distortion of a ballast input current and the current crest factor of said lamp current is decreased. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00049">
<claim-text><highlight><bold>49</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00044">claim 48</dependent-claim-reference>, wherein said valley fill circuit comprises a buck converter circuit. </claim-text>
</claim>
<claim id="CLM-00050">
<claim-text><highlight><bold>50</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00044">claim 48</dependent-claim-reference>, wherein said valley fill circuit comprises a switched resistor circuit. </claim-text>
</claim>
<claim id="CLM-00051">
<claim-text><highlight><bold>51</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00044">claim 48</dependent-claim-reference>, wherein said control circuit includes a microprocessor. </claim-text>
</claim>
<claim id="CLM-00052">
<claim-text><highlight><bold>52</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00044">claim 48</dependent-claim-reference>, wherein said control circuit includes a digital signal processor. </claim-text>
</claim>
<claim id="CLM-00053">
<claim-text><highlight><bold>53</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00044">claim 48</dependent-claim-reference>, wherein said control circuit includes an ASIC </claim-text>
</claim>
<claim id="CLM-00054">
<claim-text><highlight><bold>54</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00044">claim 49</dependent-claim-reference>, wherein said buck converter circuit includes a tapped inductor. </claim-text>
</claim>
<claim id="CLM-00055">
<claim-text><highlight><bold>55</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00044">claim 48</dependent-claim-reference>, which further includes a flyback transformer and wherein said energy storage device is charged through said flyback transformer. </claim-text>
</claim>
<claim id="CLM-00056">
<claim-text><highlight><bold>56</bold></highlight>. An electronic ballast for driving at least one lamp comprising: 
<claim-text>a rectifying circuit operatively connectable to an AC line; </claim-text>
<claim-text>a valley fill circuit including an energy storage device; </claim-text>
<claim-text>said valley fill circuit operable to selectively charge said energy storage device; </claim-text>
<claim-text>a back end which includes an inverter circuit that supplies a lamp current to a lamp; </claim-text>
<claim-text>a control circuit for controlling the operation of said inverter circuit; and </claim-text>
<claim-text>a cat ear circuit that supplies power to said control circuit and wherein said inverter circuit draws a first current from said AC line during a predetermined portion of each half cycle which is greater than 90&deg; of each half cycle of said AC line. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00057">
<claim-text><highlight><bold>57</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00055">claim 56</dependent-claim-reference>, wherein said inverter circuit draws said first current during a first portion of each said half cycle, and said cat ear circuit draws a second current from said AC line during a second substantially non-overlapping portion of each said half cycle. </claim-text>
</claim>
<claim id="CLM-00058">
<claim-text><highlight><bold>58</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00055">claim 57</dependent-claim-reference>, wherein said cat ear circuit starts drawing said second current at a predetermined fixed cut in point in each half cycle. </claim-text>
</claim>
<claim id="CLM-00059">
<claim-text><highlight><bold>59</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00055">claim 57</dependent-claim-reference>, wherein said cat ear circuit stops drawing said second current at a predetermined fixed cut out point in each half cycle. </claim-text>
</claim>
<claim id="CLM-00060">
<claim-text><highlight><bold>60</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00055">claim 57</dependent-claim-reference>, wherein said cat ear circuit includes an active back end current monitoring circuit to monitor the current drawn by said back end. </claim-text>
</claim>
<claim id="CLM-00061">
<claim-text><highlight><bold>61</bold></highlight>. An electronic ballast for driving at least one lamp comprising: 
<claim-text>a rectifying circuit operatively connectable to an AC line; </claim-text>
<claim-text>a valley fill circuit including an energy storage device; and </claim-text>
<claim-text>said valley fill circuit operable to selectively charge said energy storage device from said rectifying circuit through an impedance and a first electronic switch. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00062">
<claim-text><highlight><bold>62</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00066">claim 61</dependent-claim-reference>, wherein said energy storage device is a capacitor. </claim-text>
</claim>
<claim id="CLM-00063">
<claim-text><highlight><bold>63</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00066">claim 61</dependent-claim-reference>, wherein said impedance is an inductor. </claim-text>
</claim>
<claim id="CLM-00064">
<claim-text><highlight><bold>64</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00066">claim 61</dependent-claim-reference>, wherein said impedance is a resistor. </claim-text>
</claim>
<claim id="CLM-00065">
<claim-text><highlight><bold>65</bold></highlight>. The electronic ballast of <dependent-claim-reference depends_on="CLM-00066">claim 61</dependent-claim-reference>, wherein said first electronic switch is a MOSFET. </claim-text>
</claim>
<claim id="CLM-00066">
<claim-text><highlight><bold>66</bold></highlight>. A method for reducing the ballast input current total harmonic distortion below 33.3% and reducing the current crest factor below 2.1 of the lamp current provided by an electronic ballast for driving at least one gas discharge lamp from a source of AC power which has a substantially sinusoidal line voltage at a given line frequency, comprising the steps of: 
<claim-text>a) receiving the substantially sinusoidal line voltage from said source of AC power; </claim-text>
<claim-text>b) rectifying the substantially sinusoidal line voltage from said source of AC power to provide a full wave rectified voltage; </claim-text>
<claim-text>c) charging an energy storage device from said full wave rectified voltage through an impedance and a controllably conductive device to provide a DC voltage; </claim-text>
<claim-text>d) modifying the full wave rectified voltage by supplying said DC voltage between the peaks of the full wave rectified voltage to provide a valley filled voltage; </claim-text>
<claim-text>e) applying the valley filled voltage to an inverter to provide a high frequency AC voltage; </claim-text>
<claim-text>f) using said high frequency AC voltage to drive a lamp current through said at least one gas discharge lamp; and </claim-text>
<claim-text>g) causing said inverter to draw current from said source of AC power for a time greater than 90&deg; of each 180&deg; line frequency half cycle. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00067">
<claim-text><highlight><bold>67</bold></highlight>. A method of reducing the ballast input current total harmonic distortion below 33.3% in an electronic ballast for driving at least one gas discharge lamp, connectable to a source of AC power which has substantially sinusoidal line voltage at a given line frequency, comprising the steps of: 
<claim-text>a) rectifying the sinusoidal line voltage from said source of AC power to provide full wave rectified voltage; </claim-text>
<claim-text>b) modifying the full wave rectified voltage by supplying a DC voltage between the peaks of the full wave rectified voltage to provide a valley filled voltage; </claim-text>
<claim-text>c) applying the valley filled voltage to an inverter to provide a high frequency AC voltage; </claim-text>
<claim-text>d) using said high frequency AC voltage to drive a lamp current through said at least one gas discharge lamp; </claim-text>
<claim-text>e) causing said inverter to draw current from said source of AC power through an impedance and a controllably conductive device for a time greater than 90&deg; of each 180&deg; line frequency half cycle; and </claim-text>
<claim-text>f) drawing additional current thru a cat ear circuit from said source of AC power during a first time interval following a line voltage zero crossing and a second time interval just prior to the next line voltage zero crossing. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00068">
<claim-text><highlight><bold>68</bold></highlight>. A method for reducing the ballast input current total harmonic distortion below 33.3% in an electronic ballast for driving at least one gas discharge lamp from a source of AC power which has a substantially sinusoidal line voltage at a given line frequency, comprising the steps of: 
<claim-text>a) rectifying the substantially sinusoidal line voltage from said source of AC power to provide a full wave rectified voltage; </claim-text>
<claim-text>b) providing an energy storage device to modify the full wave rectified voltage by supplying a DC voltage between the peaks of the full wave rectified voltage to provide a valley filled voltage; </claim-text>
<claim-text>c) applying the valley filled voltage to an inverter to provide a high frequency AC voltage; </claim-text>
<claim-text>d) using said high frequency AC voltage to drive a lamp current through said at least one gas discharge lamp; and </claim-text>
<claim-text>e) causing said energy storage device to draw current from said source of AC power through an impedance and a controllably conductive device for a time greater than 90&deg; of each 180&deg; line frequency half cycle. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00069">
<claim-text><highlight><bold>69</bold></highlight>. A method for reducing the ballast input current total harmonic distortion and for reducing the current crest factor in an electronic ballast which drives at least one gas discharge lamp from a source of AC power which has a substantially sinusoidal line voltage at a given line frequency, comprising the steps of: 
<claim-text>a) rectifying the substantially sinusoidal line voltage from said source of AC power to provide a full wave rectified voltage; </claim-text>
<claim-text>b) modifying the full wave rectified voltage by supplying a DC voltage between the peaks of the full wave rectified voltage to provide a valley filled voltage; </claim-text>
<claim-text>c) applying the valley filled voltage to an inverter having at least first and second controllably conductive devices to provide a high frequency AC voltage; </claim-text>
<claim-text>d) using said high frequency AC voltage to drive a lamp current through said at least one gas discharge lamp; and </claim-text>
<claim-text>e) controlling the conduction time of said first and second controllably conductive devices to hump up said ballast input current and hump down said lamp current during the time around the time of the absolute peak voltage of said source of AC power.</claim-text>
</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>2</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030001522A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030001522A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030001522A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030001522A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030001522A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030001522A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030001522A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030001522A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030001522A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00009">
<image id="EMI-D00009" file="US20030001522A1-20030102-D00009.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00010">
<image id="EMI-D00010" file="US20030001522A1-20030102-D00010.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00011">
<image id="EMI-D00011" file="US20030001522A1-20030102-D00011.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00012">
<image id="EMI-D00012" file="US20030001522A1-20030102-D00012.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00013">
<image id="EMI-D00013" file="US20030001522A1-20030102-D00013.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00014">
<image id="EMI-D00014" file="US20030001522A1-20030102-D00014.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00015">
<image id="EMI-D00015" file="US20030001522A1-20030102-D00015.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00016">
<image id="EMI-D00016" file="US20030001522A1-20030102-D00016.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00017">
<image id="EMI-D00017" file="US20030001522A1-20030102-D00017.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00018">
<image id="EMI-D00018" file="US20030001522A1-20030102-D00018.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00019">
<image id="EMI-D00019" file="US20030001522A1-20030102-D00019.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00020">
<image id="EMI-D00020" file="US20030001522A1-20030102-D00020.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00021">
<image id="EMI-D00021" file="US20030001522A1-20030102-D00021.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00022">
<image id="EMI-D00022" file="US20030001522A1-20030102-D00022.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00023">
<image id="EMI-D00023" file="US20030001522A1-20030102-D00023.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00024">
<image id="EMI-D00024" file="US20030001522A1-20030102-D00024.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00025">
<image id="EMI-D00025" file="US20030001522A1-20030102-D00025.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00026">
<image id="EMI-D00026" file="US20030001522A1-20030102-D00026.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
