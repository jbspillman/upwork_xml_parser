<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030002468A1-20030102-D00000.TIF SYSTEM "US20030002468A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030002468A1-20030102-D00001.TIF SYSTEM "US20030002468A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030002468A1-20030102-D00002.TIF SYSTEM "US20030002468A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030002468A1-20030102-D00003.TIF SYSTEM "US20030002468A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030002468A1-20030102-D00004.TIF SYSTEM "US20030002468A1-20030102-D00004.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030002468</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10011602</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20011204</filing-date>
</domestic-filing-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>H04Q007/24</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>370</class>
<subclass>338000</subclass>
</uspc>
</classification-us-primary>
<classification-us-secondary>
<uspc>
<class>370</class>
<subclass>349000</subclass>
</uspc>
</classification-us-secondary>
</classification-us>
<title-of-invention>Virtual private network identification extension</title-of-invention>
</technical-information>
<continuity-data>
<non-provisional-of-provisional>
<document-id>
<doc-number>60301699</doc-number>
<document-date>20010628</document-date>
<country-code>US</country-code>
</document-id>
</non-provisional-of-provisional>
</continuity-data>
<inventors>
<first-named-inventor>
<name>
<given-name>Mohamed</given-name>
<family-name>Khalil</family-name>
</name>
<residence>
<residence-us>
<city>Murphy</city>
<state>TX</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Emad</given-name>
<middle-name>A.</middle-name>
<family-name>Qaddoura</family-name>
</name>
<residence>
<residence-us>
<city>Plano</city>
<state>TX</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Haseeb</given-name>
<family-name>Akhtar</family-name>
</name>
<residence>
<residence-us>
<city>Garland</city>
<state>TX</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<correspondence-address>
<name-1>D. Scott Hemingway</name-1>
<name-2>Law Offices of D. Scott Hemingway</name-2>
<address>
<address-1>Preston Commons West, Suite 800</address-1>
<address-2>8117 Preston Rd.</address-2>
<city>Dallas</city>
<state>TX</state>
<postalcode>75225</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">The present invention supports a virtual private network identifier for an information packet transmission on an IP mobility system. By identifying a virtual private network in this manner, the Foreign Agent will be able to properly route data packets even if two or more Mobile Nodes are associated with virtual private networks on the same home network. </paragraph>
</subdoc-abstract>
<subdoc-description>
<cross-reference-to-related-applications>
<heading lvl="1">RELATED APPLICATION DATA </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> This application is the utility patent application related to provisional application No. 60/301,699 filed Jun. 28, 2001.</paragraph>
</cross-reference-to-related-applications>
<summary-of-invention>
<section>
<heading lvl="1">TECHNICAL FIELD OF THE INVENTION </heading>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> A modified extension format and method for use in an IP-based mobile communication system having a home network, foreign network and a mobile node. </paragraph>
</section>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> Present-day Internet communications represent the synthesis of technical developments begun in the 1960s&mdash;the development of a system to support communications between different United States military computer networks, and the subsequent development of a system to support the communication between research computer networks at United States universities. These technological developments would subsequently revolutionize the world of computing. </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> The Internet, like so many other high tech developments, grew from research originally performed by the United States Department of Defense. In the 1960s, Defense Department officials began to notice that the military was accumulating a large collection of computers&mdash;some of which were connected to large open computer networks and others that were connected to smaller closed computer networks. A network is a collection of computers or computer-like devices communicating across a common transmission medium. Computers on the Defense Department&apos;s open computer networks, however, could not communicate with the other military computers on the closed systems. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> Defense Department officials requested that a system be built to permit communication between these different computer networks. The Defense Department recognized, however, that a single centralized system would be vulnerable to missile attacks or sabotage. Accordingly, the Defense Department required that the system to be used for communication between these military computer networks be decentralized and that no critical services be concentrated in vulnerable failure points. In order to achieve these goals, the Defense Department established a decentralized standard protocol for communication between network computers. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> A few years later, the National Science Foundation (NSF) wanted to connect network computers at various research institutions across the country. The NSF adopted the Defense Department&apos;s protocol for communication, and this combination of research computer networks would eventually evolve into the Internet. </paragraph>
<paragraph id="P-0007" lvl="7"><number>&lsqb;0007&rsqb;</number> Internet Protocols </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> The Defense Department&apos;s communication protocol governing data transmission between computers on different networks was called the Internet Protocol (IP) standard. The IP standard now supports communications between computers and networks on the Internet. The IP standard identifies the types of services to be provided to users, and specifies the mechanisms needed to support these services. The IP standard also specifies the upper and lower system interfaces, defines the services to be provided on these interfaces, and outlines the execution environment for services needed in the system. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> A transmission protocol, called the Transmission Control Protocol (TCP), was also developed to provide connection-oriented, end-to-end data transmission between packet-switched computer networks. The combination of TCP with IP (TCP/IP) forms a system or suite of protocols for data transfer and communication between computers on the Internet. The TCP/IP standard has become mandatory for use in all packet switching networks that connect or have the potential for utilizing connectivity across network or sub-network boundaries. </paragraph>
<paragraph id="P-0010" lvl="7"><number>&lsqb;0010&rsqb;</number> The TCP/IP Protocol </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> In a typical Internet-based communication scenario, data is transmitted from an applications program in a first computer, through the first computer&apos;s network hardware, and across the transmission medium to the intended destination on the Internet. After receipt at a destination computer network, the data is transmitted through the destination network to a second computer. The second computer then interprets the communication using the same protocols on a similar application program&mdash;only in reverse order. Because standard protocols are used in Internet communications, the TCP/IP protocol on the second computer decodes the transmitted information into the original information transmitted by the first computer. </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> One of the rules in TCP/IP communications is that a computer user does not need to get involved with details of data communication. In order to accomplish this goal, the TCP/IP standard imposes a layered communications system structure. All the layers are located on each computer in the network, and each module or layer is a separate component that theoretically functions independent of the other layers. As an alternative, User Datagram Protocol (&ldquo;UDP&rdquo;) supports the same type of layered protocol communication system, but with less accuracy checking on message content than the TCP/IP protocol. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> TCP/IP and its related protocols form a standardized system for defining how data should be processed, transmitted and received on the Internet. TCP/IP defines the network communication process, and more importantly, defines how a unit of data should look and what information the message should contain so that the receiving computer can interpret the message correctly. Because of the standardized layer design of TCP/IP, a consistent conversion of base data is ensured regardless of the version or vendor of the TCP/IP conversion software. </paragraph>
<paragraph id="P-0014" lvl="7"><number>&lsqb;0014&rsqb;</number> TCP/IP Addressing and Routing </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> A computer operating on a network is assigned a unique physical address. On a Local Area Network (&ldquo;LAN&rdquo;), the physical address of the computer is a number given to computer&apos;s network adapter card. Hardware LAN protocols use this physical address to deliver packets of data, sometimes called information packets, to computers on the LAN. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> On the Internet, the TCP/IP protocol routes information packets using logical addressing. The network software in the Network Layer generates logical addresses. Specifically, a logical address in the TCP/IP network is translated into a corresponding physical address using the ARP (Address Resolution Protocol) and RARP (Reverse Address Resolution Protocol) protocols in the Network Layer. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> The TCP/IP&apos;s logical address is also called an IP address. The IP address can include: (1) a network ID number identifying a network, (2) a sub-network ID number identifying a sub-network on the network, and, (3) a host ID number identifying a particular computer on the sub-network. The header data in the information packet will include source and destination addresses. The IP addressing scheme imposes a sensible addressing scheme that reflects the internal organization of the network or sub-network. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> A computer network is often subdivided into smaller sub-networks. The computer network is divided in this manner to increase data transmission efficiency and reduce overall network traffic. Routers are used to regulate the flow of data into and out of designated sub-networks of the computer network. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> A router interprets the logical address of an information packet, such as an IP address, and directs the information packet across the network to its intended destination. Information packets addressed between computers on the sub-network do not pass through the router to the greater network, and therefore does not clutter the transmission lines of the greater network. If data is addressed to a computer outside the sub-network, however, the router forwards the data onto the larger network. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> The TCP/IP network includes protocols that define how routers will determine the path for data through the network. Routing decisions are based upon information in the IP packet header and entries in each router&apos;s routing table. A routing table possesses sufficient information for a router to make a determination on whether to accept the communicated information on behalf of a destination computer, or pass the information onto another router in the network. The routing table also permits the router to determine where the information should be forwarded within the network or sub-network. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> The routing table can be configured manually with routing table entries or a dynamic routing protocol that can accommodate changing network topologies&mdash;network architecture, network structure, layout of routers, and interconnections between hosts and routers. In a dynamic routing protocol, a router advertises reachability when it sends updated routing information to a second router claiming that the first router is capable of reaching one or more destination addresses. Advertising accessibility is important to the process of receiving, directing and redirecting information packets on the Internet. </paragraph>
<paragraph id="P-0022" lvl="7"><number>&lsqb;0022&rsqb;</number> The IP-Based Mobility System </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> Internet protocols were originally developed with an assumption that Internet users, which are assigned a unique IP address, would be connected to a single, fixed network&mdash;that is, one physical fixed location. With the advent of portable computers and cellular wireless communication systems, however, the movement of Internet users within a network and across network boundaries has become quite common. Because of this highly mobile Internet usage, the implicit design assumptions for the Internet protocols have been violated. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> The IP-based mobile system includes at least one Mobile Node in a wireless communication system. The term &ldquo;Mobile Node&rdquo; includes a mobile communication unit, and, in addition to the Mobile Node, the communication system has a home network and a foreign network. The Mobile Node may change its point of attachment to the Internet through these other networks, but the Mobile Node will always be associated with a single Mobile Node home network for IP addressing purposes. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> The home network has a Home Agent and the foreign network has a Foreign Agent&mdash;both of which control the routing of information packets into and out of their network. </paragraph>
<paragraph id="P-0026" lvl="7"><number>&lsqb;0026&rsqb;</number> Registration of a Mobile Node </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> The Mobile Node keeps the Home Agent informed of its current location by registering a care-of address with the Home Agent. Essentially, the care-of address represents the current foreign network where the Mobile Node is located. If the Home Agent receives an information packet addressed to the Mobile Node while the Mobile Node is located on a foreign network, the Home Agent will &ldquo;tunnel&rdquo; the information packet to the Mobile Node&apos;s current location on the foreign network via the applicable care-of address. </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> The Foreign Agent participates in informing the Home Agent of the Mobile Node&apos;s current care-of address. The Foreign Agent also de-tunnels information packets for the mobile node after the information packets have been forwarded to the Foreign Agent by the Home Agent. Further, the Foreign Agent serves as a default router for out-going information packets generated by the mobile node while connected to the foreign network. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> Foreign Agents and Home Agents periodically broadcast an agent advertisement to all nodes on the local network associated with that agent. An agent advertisement is a message from the agent on a network that may be issued under the Mobile IP protocol (RFC 2002) or any other type of communications protocol. This advertisement should include information that is required to uniquely identify a mobility agent (e.g. a Home Agent, a Foreign Agent, etc.) to a mobile node. Mobile Nodes examine the agent advertisement and determine whether they are connected to the home network or a foreign network. </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> If the Mobile Node is located on its home network, no additional actions need to be taken because information packets will be routed to the Mobile Node according to the standard addressing and routing scheme. If the Mobile Node is visiting a foreign network, however, the Mobile Node obtains appropriate information from the agent advertisement, and transmits a registration request message to its Home Agent. The registration request message will include a care-of address for the Mobile Node. </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> The registered care-of address identifies the foreign network where the mobile node is located, and the Home Agent uses this registered care-of address to tunnel information packets to the foreign network for subsequent transfer to the mobile node. A registration reply message may be sent to the Mobile Node by the Home Agent to confirm that the registration process has been successfully completed. </paragraph>
<paragraph id="P-0032" lvl="7"><number>&lsqb;0032&rsqb;</number> Authenticate, Authorize and Accounting (&ldquo;AAA&rdquo;) </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> In an IP-based mobile communications system, the Mobile Node changes its point of attachment to the network while maintaining network connectivity. The Mobile IP Protocol (RFC 2002) assumes that mobile IP communications with a Mobile Node will be performed on a single administrative domain or a single network controlled by one administrator. </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> When a Mobile Node travels outside its home administrative domain, however, the Mobile Node must communicate through multiple domains in order to maintain network connectivity with its home network. While connected to a foreign network controlled by another administrative domain, network servers must authenticate, authorize and collect accounting information for services rendered to the Mobile Node. This authentication, authorization, and accounting activity is called &ldquo;AAA&rdquo;, and AAA servers on the home and foreign network perform the AAA activities for each network. </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> Authentication is the process of proving someone&apos;s claimed identity, and security systems on a mobile IP network will often require authentication of the system user&apos;s identity before authorizing a requested activity. The AAA server authenticates the identity of an authorized user, and authorizes the Mobile Node&apos;s requested activity. Additionally, the AAA server will also provide the accounting function including tracking usage and charges for use of transmissions links between administrative domains. </paragraph>
<paragraph id="P-0036" lvl="7"><number>&lsqb;0036&rsqb;</number> Mobile IP Extensions </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> Extensions, as defined in different IP protocols, support the transmission of variable amounts of information in an information packet, the registration of a Mobile Node, or the AAA functions performed by AAA network servers. The general extension mechanism allows appropriate information to be carried by a control message or similar types of discovery messages, agent advertisements, registration requests, or registration replies. </paragraph>
<paragraph id="P-0038" lvl="7"><number>&lsqb;0038&rsqb;</number> Virtual Private Networks </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> A Virtual Private Network (VPN) emulates a private internet network over a shared physical infrastructure. By way of example a VPN can reside within a LAN system, or on one of several different servers on one or more service providers. A VPN can thus span multiple computer servers or systems and multiple VPNs can co-exist within this host infrastructure, but the VPN does not exist on non-host infrastructures. </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> A VPN can be used to extend the IP capability of a corporate network to remote offices or users possessing internet, extranet, or dial-up services. In this way, connectivity in the same manner as a dedicated private network can be achieved without the necessity of funding for equipment and support infrastructure. </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> A service provider, or other network structure, provides the physical system and computer infrastructure within which the &ldquo;virtual&rdquo; network resides. In this manner, the VPN can function much the same as a single, physical network despite the intervening host infrastructure. A number of different types of VPNs are suggested in RFC 2764, but this is by no means an exhaustive list of possible VPN constructs. The distinguishing hallmark of a VPN is that it is a single, logical network found on a public or private computer infrastructure and the VPN may reside upon one or more autonomous systems. </paragraph>
<paragraph id="P-0042" lvl="7"><number>&lsqb;0042&rsqb;</number> Tunneling </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> The general IP communication protocol with Home Agents, Mobile Nodes, and Foreign Agents occurs thusly: </paragraph>
<paragraph id="P-0044" lvl="2"><number>&lsqb;0044&rsqb;</number> 1. Home Agents and Foreign Agents advertise their presence on any attached links by periodically broadcasting agent advertisements. </paragraph>
<paragraph id="P-0045" lvl="2"><number>&lsqb;0045&rsqb;</number> 2. Mobile Nodes receive the agent advertisement and compares the advertisement with their stored communication protocols to determine if they are connected to a Foreign Agent. </paragraph>
<paragraph id="P-0046" lvl="2"><number>&lsqb;0046&rsqb;</number> 3. If connected to a Foreign Agent, the Mobile Node acquires a care-of address, which is read from the data fields within the Foreign Agent&apos;s agent advertisement. </paragraph>
<paragraph id="P-0047" lvl="2"><number>&lsqb;0047&rsqb;</number> 4. The Mobile Node registers the care-of address with its Home Agent by forwarding a Registration Request Message (IPV4 standard) or Binding Update Message (IPV6 standard) to the Home Agent. </paragraph>
<paragraph id="P-0048" lvl="2"><number>&lsqb;0048&rsqb;</number> 5. The Home Agent takes any data packets addressed to the Mobile Node and tunnels them to the Mobile Node by encapsulating the data packet with the care-of address. </paragraph>
<paragraph id="P-0049" lvl="2"><number>&lsqb;0049&rsqb;</number> 6. The data packet is &ldquo;tunneled&rdquo; to the care-of address, where the Foreign Agent decapsulates the original data packet from the tunnel and delivers the data packet to the Mobile Node. The Foreign Agent serves as the router for all the data packets generated by the Mobile Node. </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> Tunneling is the basic methodology in IP communication by which a data packet is routed to the appropriate internet node through an intermediate internet address. Typically, a data packet with network routing is &ldquo;encapsulated&rdquo; by IP address information. </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> Encapsulation involves adding an outer IP header to the original IP header fields. In this manner, a &ldquo;tunnel&rdquo; can be constructed. The outer IP header contains a source and destination IP address&mdash;the &ldquo;endpoints&rdquo; of the tunnel. The inner IP header source and destination addresses identify the original sender and destination addresses. </paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> The original sender and recipient addresses remain unchanged, while the new &ldquo;tunnel&rdquo; endpoint addresses are grafted upon the original data packet. This alters the original IP routing by delivering the data packet to an intermediate destination node (in this case the Foreign Agent), where it is &ldquo;decapsulated&rdquo; or &ldquo;de-tunneled&rdquo; yielding the original data packet and routing. The packet is then delivered according to the destination found in the original IP address. </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> The important concept to keep in mind is that the &ldquo;tunnel&rdquo; is established by encapsulating a data packet containing the original IP address of the Mobile Node and an IP source address with the intermediate routing IP address (i.e. care-of address) of the foreign network. After the Foreign Agent decapsulates the data packet, the Foreign Agent in turn routes the data packet using the assigned Home Address of the Mobile Node found in the original data packet. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> There are problems with the routing of information packets to Mobile Nodes associated with one or more VPNs. Because several VPNs may reside inside the same or multiple providers or autonomous systems, a possibility exists that two or more Mobile Nodes that are part of two separate VPNs may nevertheless share the same or very similar IP addresses. If two Mobile Nodes share the same IP address and are using the same foreign network, data packets will invariably be routed to the wrong Mobile Node by the Foreign Agent. The invention ensures that a Foreign Agent will properly identify a Mobile Node belonging to any one VPN, so that even if two Mobile Nodes sharing the same IP Address are located on the foreign network, the Foreign Agent will properly route information packets to the appropriate destination Mobile Node. </paragraph>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> Under the current communication protocols, Foreign Agents and Home Agents periodically broadcast an agent advertisement to all nodes on that local network. The Mobile Node examines the agent advertisements. If the Mobile Node is on a foreign network, the Mobile Node obtains appropriate information from the agent advertisement and transmits a care-of address to the Home Agent in a registration request message. The Home Agent then routes information packets intended for the Mobile Node using the care-of address to the Foreign Agent, which in turn routes the information to the Mobile Node. </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> Under the invention, the registration request message is modified to contain a special VPN Identifier. A new flag bit is added to signify the presence of a two-part VPN Identifier that uniquely identifies a VPN. This VPN Identifier (VPNI) extension consists of the VPN Organizational Unique Identifier (VPN-OUI) and VPN Index. The first part is a 24-bit VPN-OUI that uniquely designates the VPN authority, which serves as the primary administrator. This authority may be a company, organization, service provider, or some other entity responsible for administering and managing the VPN as well as arranging for the underlying host computer infrastructure. The second part of the identifier is a 32-bit VPN Index that identifies the particular VPN serviced by the VPN authority. </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> The VPN Identifier can be used by the Home Agent and the Foreign Agent to encapsulate information packets for &ldquo;tunneling.&rdquo; This tunneling protocol must be used by both the Home Agent and Foreign Agent to transmit information between them. Once received by the Home or Foreign Agent, the tunneled packet is routed accordingly using the original IP address header and VPNI header as appropriate. With this routing protocol, the Foreign Agent will correctly route information packets, even if two Mobile Nodes belonging to different VPNs on the same home network share the same or very similar IP address. </paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> The objects and features of the invention will become more readily understood from the following detailed description and appended claims when read in conjunction with the accompanying drawings in which like numerals represent like elements and in which: </paragraph>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a prior art schematic diagram of a mobile IP wireless communications network; </paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a general extension format; </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a prior art general representation of encapsulation used in the IP tunneling protocol; </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4 a</cross-reference> general representation of the encapsulation used in the invention for VPN tunneling; </paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is the general format for the VPN Identifier Extension of the invention; </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is the general representation of the VPN Identifier Extension as incorporated into an encapsulated data packet under the invention; </paragraph>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a generalized prior art Registration Request Message format in the IPV4 standard; </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a generalized Registration Request Message format in the IPV4 standard using the invention; </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a generalized prior art Binding Update Message format in the IPV6 standard; and </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a generalized Binding Update Message format in the IPV6 standard using the invention. </paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS </heading>
<paragraph id="P-0069" lvl="0"><number>&lsqb;0069&rsqb;</number> Mobile IP protocols support the routing of data communications to mobile nodes through the Internet. As shown in <cross-reference target="DRAWINGS">FIG. 1, a</cross-reference> mobile IP communications system can be represented by two networks coupled to the Internet <highlight><bold>35</bold></highlight>, as represented by the cloud <highlight><bold>35</bold></highlight> of constituent networks. </paragraph>
<paragraph id="P-0070" lvl="0"><number>&lsqb;0070&rsqb;</number> In <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, the overall architecture of the IP-based mobile system is shown with a Mobile Node <highlight><bold>64</bold></highlight>, a home network <highlight><bold>10</bold></highlight> and a foreign network <highlight><bold>40</bold></highlight>. The home network <highlight><bold>10</bold></highlight> has a central buss line <highlight><bold>20</bold></highlight> coupled to the Home Agent <highlight><bold>28</bold></highlight> via communication link <highlight><bold>24</bold></highlight>, and the buss line <highlight><bold>20</bold></highlight> is coupled to the AAA server <highlight><bold>17</bold></highlight> via communication link <highlight><bold>22</bold></highlight>. The home network <highlight><bold>10</bold></highlight> is coupled to the public Internet <highlight><bold>35</bold></highlight> via communication link <highlight><bold>30</bold></highlight>. A communications link is any connection between two or more nodes on a network or users on networks or administrative domains. </paragraph>
<paragraph id="P-0071" lvl="0"><number>&lsqb;0071&rsqb;</number> The foreign network <highlight><bold>40</bold></highlight> has a central buss line <highlight><bold>50</bold></highlight> coupled to the foreign agent <highlight><bold>58</bold></highlight> via communication link <highlight><bold>54</bold></highlight>, and the buss line <highlight><bold>50</bold></highlight> is coupled to the AAA foreign network server <highlight><bold>47</bold></highlight> via communication link <highlight><bold>52</bold></highlight>. The foreign network <highlight><bold>40</bold></highlight> is coupled to the public Internet <highlight><bold>35</bold></highlight> via communication link <highlight><bold>37</bold></highlight>. </paragraph>
<paragraph id="P-0072" lvl="0"><number>&lsqb;0072&rsqb;</number> Mobile Node <highlight><bold>64</bold></highlight> is shown electronically coupled to the foreign network <highlight><bold>40</bold></highlight> via the wireless communication link <highlight><bold>66</bold></highlight> of transceiver <highlight><bold>60</bold></highlight>. Transceiver <highlight><bold>60</bold></highlight> is coupled to the foreign network <highlight><bold>40</bold></highlight> via communication link <highlight><bold>62</bold></highlight>. The Mobile Node <highlight><bold>64</bold></highlight> can communicate with any transceiver or Access Network coupled to the foreign network <highlight><bold>40</bold></highlight>. </paragraph>
<paragraph id="P-0073" lvl="0"><number>&lsqb;0073&rsqb;</number> The terms Home Agent and Foreign Agent may be defined in the Mobile IP Protocol (RFC 2002), but these agents are not restricted to a single protocol or system. In fact, the term Home Agent, as used in this application, can refer to a Home Mobility Manager, Home Location Register, Home Serving Entity, or any other agent at a home network having the responsibility to manage mobility-related functionality for a Mobile Node on a home network. Likewise, the term Foreign Agent, as used in this application, can refer to a Serving Mobility Manager, Visited Location Register, Visiting Serving Entity, or any other agent on a foreign network having the responsibility to manage mobility-related functionality for a Mobile Node on a foreign network. </paragraph>
<paragraph id="P-0074" lvl="0"><number>&lsqb;0074&rsqb;</number> In the mobile IP communications system, the Mobile Node <highlight><bold>64</bold></highlight> may be identified by a permanent IP address. While the Mobile Node <highlight><bold>64</bold></highlight> is coupled to its home network <highlight><bold>10</bold></highlight>, the Mobile Node <highlight><bold>64</bold></highlight> functions as any other fixed node on that network. When the Mobile Node <highlight><bold>64</bold></highlight> moves from its home network <highlight><bold>10</bold></highlight> to a foreign network <highlight><bold>40</bold></highlight>, however, the home network <highlight><bold>10</bold></highlight> sends data communications to the Mobile Node <highlight><bold>64</bold></highlight> by &ldquo;tunneling&rdquo; the communications to the foreign network <highlight><bold>40</bold></highlight> where the Mobile Node <highlight><bold>64</bold></highlight> is located. </paragraph>
<paragraph id="P-0075" lvl="0"><number>&lsqb;0075&rsqb;</number> The Mobile Node <highlight><bold>64</bold></highlight> keeps the Home Agent <highlight><bold>28</bold></highlight> informed of its current location by registering a care-of address with the Home Agent <highlight><bold>28</bold></highlight>. Essentially, the care-of address represents the current foreign network <highlight><bold>40</bold></highlight> where the Mobile Node is located. If the Home Agent <highlight><bold>28</bold></highlight> receives an information packet addressed to the Mobile Node <highlight><bold>64</bold></highlight> while the Mobile Node <highlight><bold>64</bold></highlight> is located on a foreign network <highlight><bold>40</bold></highlight>, the Home Agent <highlight><bold>28</bold></highlight> will &ldquo;tunnel&rdquo; the information packet to the Mobile Node&apos;s <highlight><bold>64</bold></highlight> current location on the foreign network <highlight><bold>40</bold></highlight> via the applicable care-of address. </paragraph>
<paragraph id="P-0076" lvl="0"><number>&lsqb;0076&rsqb;</number> The Foreign Agent <highlight><bold>58</bold></highlight> participates in informing the Home Agent <highlight><bold>28</bold></highlight> of the Mobile Node&apos;s <highlight><bold>64</bold></highlight> current care-of address. The Foreign Agent <highlight><bold>58</bold></highlight> also decapsulates or de-tunnels information packets for the Mobile Node <highlight><bold>64</bold></highlight> after the information packets have been forwarded to the Foreign Agent <highlight><bold>58</bold></highlight> by the Home Agent <highlight><bold>28</bold></highlight>. Further, the Foreign Agent <highlight><bold>58</bold></highlight> serves as a default router for out-going information packets generated by the Mobile Node <highlight><bold>64</bold></highlight> while connected to the foreign network <highlight><bold>40</bold></highlight>. </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> If the Mobile Node <highlight><bold>64</bold></highlight> is located on its home network <highlight><bold>10</bold></highlight>, no additional action needs to be taken because information packets will be routed to the Mobile Node <highlight><bold>64</bold></highlight> according to the standard addressing and routing scheme. If the Mobile Node <highlight><bold>64</bold></highlight> is visiting a foreign network <highlight><bold>40</bold></highlight>, however, the Mobile Node <highlight><bold>64</bold></highlight> obtains appropriate information from the agent advertisement, and transmits a registration request message to its Home Agent <highlight><bold>28</bold></highlight>. The registration request message will include a care-of address for the Mobile Node <highlight><bold>64</bold></highlight>. </paragraph>
<paragraph id="P-0078" lvl="0"><number>&lsqb;0078&rsqb;</number> The registered care-of address identifies the foreign network <highlight><bold>40</bold></highlight> where the Mobile Node <highlight><bold>64</bold></highlight> is located, and the Home Agent <highlight><bold>28</bold></highlight> uses this registered care-of address to tunnel information packets to the foreign network <highlight><bold>40</bold></highlight> for subsequent transfer to the Mobile Node <highlight><bold>64</bold></highlight>. A registration reply message may be sent to the Mobile Node <highlight><bold>64</bold></highlight> by the Home Agent <highlight><bold>28</bold></highlight> to confirm that the registration process has been successfully completed. </paragraph>
<paragraph id="P-0079" lvl="7"><number>&lsqb;0079&rsqb;</number> Registration of Mobile Nodes </paragraph>
<paragraph id="P-0080" lvl="0"><number>&lsqb;0080&rsqb;</number> A care-of address identifies the foreign network <highlight><bold>40</bold></highlight> where the Mobile Node <highlight><bold>64</bold></highlight> is located. Mobile IP protocols require that the mobile node register the care-of address with the Home Agent <highlight><bold>28</bold></highlight> and/or the AAA server <highlight><bold>17</bold></highlight> on the home network <highlight><bold>10</bold></highlight> after movement to a new network. As part of the registration process, a registration request is issued by the Mobile Node <highlight><bold>64</bold></highlight> in response to power-up on the foreign network <highlight><bold>40</bold></highlight> or receipt of an agent advertisement. The registration request is sent to the Home Agent <highlight><bold>28</bold></highlight> and/or the AAA server <highlight><bold>17</bold></highlight> on the home network, and a registration reply is issued by the Home Agent <highlight><bold>28</bold></highlight> to the Mobile Node <highlight><bold>64</bold></highlight> to confirm registration of the care-of address with the Home Agent <highlight><bold>28</bold></highlight>. The registration is transmitted from Mobile Node <highlight><bold>64</bold></highlight> or the Foreign Agent <highlight><bold>58</bold></highlight> to the Home Agent <highlight><bold>28</bold></highlight> via Internet <highlight><bold>35</bold></highlight>. The AAA server <highlight><bold>17</bold></highlight> also allows the Mobile Node <highlight><bold>64</bold></highlight> to access the home network <highlight><bold>10</bold></highlight>. </paragraph>
<paragraph id="P-0081" lvl="7"><number>&lsqb;0081&rsqb;</number> &ldquo;Tunneling&rdquo; of Information Packets </paragraph>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> After registration, all communications addressed to the Mobile Node <highlight><bold>64</bold></highlight> are still routed according to normal IP protocols to the mobile node&apos;s home network <highlight><bold>10</bold></highlight>. After the Home Agent <highlight><bold>28</bold></highlight> receives this communication, however, the Home Agent <highlight><bold>28</bold></highlight> sends, or &ldquo;tunnels&rdquo;, the message to the Mobile Node <highlight><bold>64</bold></highlight> at the foreign network <highlight><bold>40</bold></highlight> via the care-of address. The Foreign Agent <highlight><bold>58</bold></highlight> accepts the re-directed communication and delivers this communication to the mobile node located on its network. </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> In the system shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, the Mobile Node <highlight><bold>64</bold></highlight> would have a care-of address of the foreign network <highlight><bold>40</bold></highlight>, and the Mobile Node <highlight><bold>64</bold></highlight> would have registered its care-of address with the Home Agent <highlight><bold>28</bold></highlight>. When an information packet is sent to the Mobile Node <highlight><bold>64</bold></highlight>, these information packets would be sent to the Home Agent <highlight><bold>28</bold></highlight> as the agent advertising accessibility to the Mobile Node <highlight><bold>64</bold></highlight> on the networks. </paragraph>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> The Home Agent <highlight><bold>28</bold></highlight> would transfer, or tunnel, the information packets to the Foreign Agent <highlight><bold>58</bold></highlight> at the care-of address for the Mobile Node <highlight><bold>64</bold></highlight>. The Foreign Agent <highlight><bold>58</bold></highlight> would, in turn, transfer the information packets to the Mobile Node <highlight><bold>64</bold></highlight> through the transceiver <highlight><bold>60</bold></highlight>. In this manner, the information packets addressed to the Mobile Node <highlight><bold>64</bold></highlight> at its usual address on the home network <highlight><bold>10</bold></highlight> are re-directed to the Mobile Node <highlight><bold>64</bold></highlight> on the foreign network <highlight><bold>40</bold></highlight>. </paragraph>
<paragraph id="P-0085" lvl="0"><number>&lsqb;0085&rsqb;</number> The general information extension format used in an information packet is shown in <cross-reference target="DRAWINGS">FIG. 2</cross-reference> as a Type-Length-Data (TLD) format. As shown in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, the Type <highlight><bold>110</bold></highlight> variable (designated by &ldquo;T&rdquo;) occupies the first 8 bits of the general extension, the Length <highlight><bold>120</bold></highlight> variable (designated by &ldquo;L&rdquo;) occupies the next 8 bits of the general extension, and the Data <highlight><bold>130</bold></highlight> variable (designated by &ldquo;D&rdquo;) occupies the remaining bits in the general extension based upon the data content (type and length). The Type <highlight><bold>110</bold></highlight> variable indicates the particular type of extension found therein, and the Length <highlight><bold>120</bold></highlight> indicates the length in bytes of the data field within the extension. The Data <highlight><bold>130</bold></highlight> field may be zero or more bytes in length, and sets forth the applicable data that is being transmitted. </paragraph>
<paragraph id="P-0086" lvl="0"><number>&lsqb;0086&rsqb;</number> The basic tunneling protocol which is used to route data to the correct destination node is shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>. The Home Agent &ldquo;encapsulates&rdquo; or &ldquo;tunnels&rdquo; the original data packet <highlight><bold>200</bold></highlight>, which contains original IP address routing in an IP Header <highlight><bold>210</bold></highlight> and data <highlight><bold>220</bold></highlight> that is being transmitted to the Home Agent, with a new Outer IP Header <highlight><bold>260</bold></highlight> (i.e. the foreign network IP address) for routing to an intermediate destination (i.e. the foreign network). The Foreign Agent &ldquo;decapsulates&rdquo; or &ldquo;de-tunnels&rdquo; the encapsulated data packet <highlight><bold>280</bold></highlight> from the encapsulated information packet <highlight><bold>250</bold></highlight> and routes the data payload <highlight><bold>280</bold></highlight> to the Mobile Node <highlight><bold>64</bold></highlight> based on the original IP address (IP Header <highlight><bold>270</bold></highlight>). </paragraph>
<paragraph id="P-0087" lvl="7"><number>&lsqb;0087&rsqb;</number> Routing Packets With Virtual Private Networks </paragraph>
<paragraph id="P-0088" lvl="0"><number>&lsqb;0088&rsqb;</number> A Virtual Private Network (VPN) exists on a host infrastructure, and is a single, logical network residing on one or more autonomous computer systems on the host system. The present invention is not limited to a particular type of VPN, but is applicable in any network which emulates a private network over a public or shared infrastructure. </paragraph>
<paragraph id="P-0089" lvl="0"><number>&lsqb;0089&rsqb;</number> In the model of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, the VPN resides within the home network <highlight><bold>10</bold></highlight>. This home network may be one or more autonomous systems. The home network <highlight><bold>10</bold></highlight> is coupled to the public Internet <highlight><bold>35</bold></highlight> via communication link <highlight><bold>30</bold></highlight>, which may be two or more nodes on a network or users on networks or administrative domains. Moreover, this communication interface over the public Internet may connect portions of the VPN, which can reside on one or more network systems. </paragraph>
<paragraph id="P-0090" lvl="0"><number>&lsqb;0090&rsqb;</number> The Mobile Node <highlight><bold>64</bold></highlight> is shown coupled to the foreign network <highlight><bold>40</bold></highlight> via the wireless communication link <highlight><bold>66</bold></highlight> of transceiver <highlight><bold>60</bold></highlight>. As already noted, in a mobile IP communication system, the Mobile Node <highlight><bold>64</bold></highlight> may be identified by a permanent IP address. However, if two Mobile Nodes belong to two separate VPNs residing on home network <highlight><bold>10</bold></highlight>, then the Mobile Nodes may share the same IP address. Any communications to the Mobile Nodes located on a foreign network <highlight><bold>40</bold></highlight> may be &ldquo;scrambled&rdquo; by the Foreign Agent <highlight><bold>58</bold></highlight>, because it cannot properly route the data due to the identical or nearly identical IP addresses of the two Mobile Nodes. </paragraph>
<paragraph id="P-0091" lvl="0"><number>&lsqb;0091&rsqb;</number> In the present invention, a VPN Identifier (VPNI) Extension is used to route the information packets. A VPNI Extension is incorporated into a data packet to properly tunnel the information packet, and <cross-reference target="DRAWINGS">FIG. 4</cross-reference> shows how the VPNI is incorporated into an information packet. The original information packet <highlight><bold>300</bold></highlight> is &ldquo;encapsulated&rdquo; adding an Outer IP Header <highlight><bold>360</bold></highlight> with intermediate routing (e.g. care-of address) and the VPNI extension <highlight><bold>370</bold></highlight>. The modified information packet <highlight><bold>350</bold></highlight>, contains an Outer IP Header <highlight><bold>360</bold></highlight>, a VPNI extension <highlight><bold>370</bold></highlight>, an Inner IP Header <highlight><bold>380</bold></highlight>, and the transmitted data <highlight><bold>390</bold></highlight>. The transmitted data <highlight><bold>390</bold></highlight> is identical to the original data <highlight><bold>320</bold></highlight>. The original IP Header <highlight><bold>310</bold></highlight> is the Inner IP Header <highlight><bold>380</bold></highlight>. The VPNI Extension <highlight><bold>370</bold></highlight> identifies the VPN to which the Mobile Node <highlight><bold>64</bold></highlight> belongs, and further specifies the destination mobile node. When the Foreign Agent <highlight><bold>58</bold></highlight> decapsulates the modified packet <highlight><bold>350</bold></highlight>, the data <highlight><bold>390</bold></highlight> can be correctly routed to the correct mobile node using the VPNI <highlight><bold>370</bold></highlight>. Essentially, the Foreign Agent <highlight><bold>58</bold></highlight> uses the identifying information in the VPNI <highlight><bold>370</bold></highlight>, together with the other identifying address information in the information packet, to properly direct the data payload <highlight><bold>390</bold></highlight>. </paragraph>
<paragraph id="P-0092" lvl="7"><number>&lsqb;0092&rsqb;</number> The VPNI Extension and Tunneling </paragraph>
<paragraph id="P-0093" lvl="0"><number>&lsqb;0093&rsqb;</number> Extensions have been defined to support the transmission of information packets on the Internet, the registration of a Mobile Node <highlight><bold>64</bold></highlight>, or the AAA functions performed by the AAA server <highlight><bold>17</bold></highlight>. The general extension mechanism allows appropriate information to be carried by a control message or similar types of discovery messages, agent advertisements, registration requests, or registration replies. </paragraph>
<paragraph id="P-0094" lvl="0"><number>&lsqb;0094&rsqb;</number> The VPNI Extension follows the general TLD format as shown in <cross-reference target="DRAWINGS">FIG. 5</cross-reference>. The Type field <highlight><bold>401</bold></highlight>, Length field <highlight><bold>402</bold></highlight>, and Subtype field <highlight><bold>403</bold></highlight> all correspond to prior extension formats. The VPNI Extension has two parts. The first part is the 24-bit VPN Organizational Unique Identifier (VPN-OUI) <highlight><bold>400</bold></highlight>. This identifies the primary network authority, which serves as the administrator for the VPN. This may be a company, organization, service provider, or some other entity, and it is responsible for administering and managing the VPN. The network authority is also responsible for providing the underlying physical infrastructure that the VPN resides upon. The remainder of the 32-bit data field is an 8-bit reserved field <highlight><bold>405</bold></highlight> in the extension. </paragraph>
<paragraph id="P-0095" lvl="0"><number>&lsqb;0095&rsqb;</number> The second part of the VPNI is the 32-bit VPN Index <highlight><bold>410</bold></highlight>. This identifies the particular VPN serviced by the VPN authority and provides a unique identifier for each VPN that a VPN authority is responsible for. This two-part VPNI provides a mechanism whereby a VPN can be uniquely designated and permit proper routing of information to the VPN or an associated Mobile Node using the VPNI as part of a TCP/IP header in an information packet. </paragraph>
<paragraph id="P-0096" lvl="0"><number>&lsqb;0096&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> shows how the VPNI is incorporated into an encapsulated information packet for routing using the VPN Identifiers. The Outer IP Header <highlight><bold>500</bold></highlight> contains the IP routing information for the data packet to its intermediate destination&mdash;either the home network or the foreign network. Once at the intermediate destination, the packet is decapsulated and routed according to the VPNI extension headers (the VPNI-OUI <highlight><bold>520</bold></highlight> and VPN Index <highlight><bold>530</bold></highlight>) by the Foreign Agent <highlight><bold>58</bold></highlight> or the Home Agent <highlight><bold>28</bold></highlight>. The Inner IP Header <highlight><bold>540</bold></highlight> contains the original IP routing information with reference to Mobile Node <highlight><bold>64</bold></highlight>. The IP Payload <highlight><bold>550</bold></highlight> is the data that is being sent to or from the Mobile Node <highlight><bold>64</bold></highlight>. </paragraph>
<paragraph id="P-0097" lvl="0"><number>&lsqb;0097&rsqb;</number> The prior art Registration Request Message shown in <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a generalized representation of the message format. The IP Header <highlight><bold>600</bold></highlight> contains a number of data fields setting out the IP source address and IP destination address. The UDP Header <highlight><bold>610</bold></highlight> contains a number of fields and is an application interface with the IP address protocol. The Type field <highlight><bold>620</bold></highlight> identifies the type of message, and a value of &lsquo;1&rsquo; signifies that the message is a registration request. The flag bit fields <highlight><bold>630</bold></highlight> are an 8-bit long set of one-bit flags that control routing of the message. The first 6-bits are designated &lsquo;S&rsquo;, &lsquo;B&rsquo;, &lsquo;D&rsquo;, &lsquo;M&rsquo;, &lsquo;G&rsquo;, and &lsquo;V&rsquo;. The remaining 2-bits <highlight><bold>635</bold></highlight> of this 8-bit field are reserved and are presently not utilized. The Lifetime field <highlight><bold>640</bold></highlight> is set by the Mobile Node <highlight><bold>64</bold></highlight> and is the number of seconds that it wants the registration to last before expiring. </paragraph>
<paragraph id="P-0098" lvl="0"><number>&lsqb;0098&rsqb;</number> The Mobile Node&apos;s Home Address field <highlight><bold>650</bold></highlight> is a 32-bit field containing the IP address of the Mobile Node&apos;s home network <highlight><bold>10</bold></highlight>. The Home Agent Address field <highlight><bold>660</bold></highlight> is a 32-bit field containing the IP address of the Home Agent <highlight><bold>28</bold></highlight>. The Care-of Address field <highlight><bold>670</bold></highlight> is a 32-bit field containing the care-of address of the foreign network <highlight><bold>40</bold></highlight> that the Mobile Node <highlight><bold>64</bold></highlight> is located upon. The Identification field <highlight><bold>680</bold></highlight> is a 64-bit field containing a value chosen by the Mobile Node <highlight><bold>64</bold></highlight> and is unique for each registration attempt. This serves as a security check and allows the Mobile Node <highlight><bold>64</bold></highlight> to know which of several possible Registration Requests match the corresponding Registration Reply. The Optional Extension field <highlight><bold>690</bold></highlight> exists where any optional extension can be placed, and it has no set length. </paragraph>
<paragraph id="P-0099" lvl="0"><number>&lsqb;0099&rsqb;</number> The modified Registration Request Message using the VPN Identifier is shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>. The IP Header <highlight><bold>700</bold></highlight> contains a number of data fields setting out the IP source address and IP destination address. The UDP Header <highlight><bold>710</bold></highlight> contains a number of data fields and is an application interface with the IP address protocol. The Type field <highlight><bold>720</bold></highlight> identifies the type of message, and a value of &lsquo;1&rsquo; signifies that the message is a registration request. The flag bit fields <highlight><bold>730</bold></highlight> are an 8-bit long set of one-bit flags that control routing of the message. The first 6-bits are designated &lsquo;S&rsquo;, &lsquo;B&rsquo;, &lsquo;D&rsquo;, &lsquo;M&rsquo;, &lsquo;G&rsquo;, and &lsquo;V&rsquo;. A one-bit &lsquo;N&rsquo; bit field <highlight><bold>732</bold></highlight> is added to the message. The N bit is a flag bit that indicates whether the VPN Identifier is being used. The final bit <highlight><bold>735</bold></highlight> in the 8-bit field remains unused. The Lifetime field <highlight><bold>740</bold></highlight> is set by the Mobile Node <highlight><bold>64</bold></highlight> and is the number of seconds that it wants the registration to last before expiring. </paragraph>
<paragraph id="P-0100" lvl="0"><number>&lsqb;0100&rsqb;</number> The Mobile Node&apos;s Home Address field <highlight><bold>750</bold></highlight> is a 32-bit field containing the IP address of the Mobile Node&apos;s home network <highlight><bold>10</bold></highlight>. The Home Agent Address field <highlight><bold>760</bold></highlight> is a 32-bit field containing the IP address of the Home Agent <highlight><bold>28</bold></highlight>. The Care-of Address field <highlight><bold>770</bold></highlight> is a 32-bit field containing the care-of address of the foreign network <highlight><bold>40</bold></highlight> that the Mobile Node <highlight><bold>64</bold></highlight> is located upon. The Identification field <highlight><bold>780</bold></highlight> is a 64-bit field with a value chosen by the Mobile Node <highlight><bold>64</bold></highlight> and is unique for each registration attempt. This serves as a security check and allows the Mobile Node to know which of several possible Registration Requests match the corresponding Registration Reply. The VPN-OUI field <highlight><bold>790</bold></highlight> is a 32-bit field which includes the 24-bit VPN-OUI. The 8-bits after the VPN-OUI are reserved. The VPN Index <highlight><bold>795</bold></highlight> is a 32-bit field and contains the VPN Index. The Optional Extension field <highlight><bold>799</bold></highlight> is an optional extension that can be placed in the information packet, but it has no set length. </paragraph>
<paragraph id="P-0101" lvl="0"><number>&lsqb;0101&rsqb;</number> The Binding Update Message format for IVP6 is shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. The IP Header fields <highlight><bold>800</bold></highlight> contain data fields setting out the IP source address and destination address. The Authentication Header field <highlight><bold>810</bold></highlight> &times;contains several fields containing data used in the IPV6 standard to authenticate the transmission. The data fields in <highlight><bold>820</bold></highlight> are not presently designated to carry information, but the Option Type field <highlight><bold>830</bold></highlight> is a 8-bit field that specifies the type of message (i.e. option; e.g. binding update, binding acknowledgment, etc.). The Option Length field <highlight><bold>840</bold></highlight> specifies the length of any option/message. The flag bit field <highlight><bold>850</bold></highlight> is a 16-bit long set of one-bit flags that control routing of the message. Only the first 3-bits have been designated, and these are designated &lsquo;A&rsquo;, &lsquo;H&rsquo;, and &lsquo;L&rsquo;. The remaining 13-bits <highlight><bold>855</bold></highlight> of this 16-bit field are reserved. The Lifetime field <highlight><bold>860</bold></highlight> is a 16-bit field set by Mobile Node <highlight><bold>64</bold></highlight> and is the number of seconds the Mobile Node wants the registration to last before expiring. </paragraph>
<paragraph id="P-0102" lvl="0"><number>&lsqb;0102&rsqb;</number> The Identification field <highlight><bold>870</bold></highlight> is a 64-bit field with a value chosen by the Mobile Node <highlight><bold>64</bold></highlight> and is unique for each registration request attempt. This serves as a security check and allows the Mobile Node <highlight><bold>64</bold></highlight> to determine which of several possible Binding Update Requests match the corresponding Binding Update Messages. The Mobile Node&apos;s Home Address field <highlight><bold>880</bold></highlight> is a 128-bit field containing the IP address of the Mobile Node&apos;s home network <highlight><bold>10</bold></highlight>. The Care-of Address field <highlight><bold>890</bold></highlight> is a 128-bit field containing the care-of address of the foreign network <highlight><bold>40</bold></highlight> that the Mobile Node <highlight><bold>64</bold></highlight> is located upon. Optional Extensions <highlight><bold>899</bold></highlight> can be added after the Care-of Address field <highlight><bold>890</bold></highlight>. </paragraph>
<paragraph id="P-0103" lvl="0"><number>&lsqb;0103&rsqb;</number> The Binding Update Message format modified using the VPN Identifier is shown in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>. The IP Header fields <highlight><bold>900</bold></highlight> contain data fields setting out the IP source address and destination address. The Authentication Header fields <highlight><bold>910</bold></highlight> contain several fields of data used in the IPV6 standard to authenticate the transmission. The data fields in <highlight><bold>920</bold></highlight> do not presently carry data or identifiers. The Option Type field <highlight><bold>930</bold></highlight> is a 8-bit field that specifies the type of message (i.e. option; e.g. binding update, binding acknowledgment, etc.). The Option Length field <highlight><bold>940</bold></highlight> specifies the length of any option/message. The flag bit field <highlight><bold>950</bold></highlight> is a 16-bit long set of one-bit flags that control routing of the message. The first 3-bits retain the same &lsquo;A&rsquo;, &lsquo;H&rsquo;, and &lsquo;L&rsquo; designations. </paragraph>
<paragraph id="P-0104" lvl="0"><number>&lsqb;0104&rsqb;</number> A one-bit &lsquo;N&rsquo; field <highlight><bold>953</bold></highlight> is added as a flag bit to designate whether VPN Identifier information exists in the information packet. The remaining 12-bits <highlight><bold>955</bold></highlight> of this 16-bit field remain reserved. The Lifetime field <highlight><bold>960</bold></highlight> is a 16-bit field set by Mobile Node <highlight><bold>64</bold></highlight> and is the number of seconds the Mobile Node wants the registration to last before expiring. The Identification field <highlight><bold>970</bold></highlight> is a 64-bit field is a value chosen by the Mobile Node and is unique for each registration attempt. This serves as a security check and allows the Mobile Node to know which of several possible Binding Update Requests match the corresponding Replies. The Mobile Node&apos;s Home Address field <highlight><bold>980</bold></highlight> is a 128-bit field containing the IP address of the Mobile Node&apos;s home network <highlight><bold>10</bold></highlight>. The Care-of Address field <highlight><bold>990</bold></highlight> is a 128-bit field containing the care-of address of the foreign network <highlight><bold>40</bold></highlight> that the Mobile Node <highlight><bold>64</bold></highlight> is located upon. The VPN-OUI field <highlight><bold>992</bold></highlight> is a 32-bit field in which the 24-bit VPN-OUI under the invention is found. The final 8-bits are reserved. The VPN Index <highlight><bold>994</bold></highlight> is a 32-bit field and contains the VPN Index under the invention. Optional Extensions <highlight><bold>899</bold></highlight> can be added as well. </paragraph>
<paragraph id="P-0105" lvl="0"><number>&lsqb;0105&rsqb;</number> In each modified message, a new &lsquo;N&rsquo; field (<highlight><bold>732</bold></highlight> and <highlight><bold>953</bold></highlight>) has been added to the flag bit field. When set to &lsquo;1&rsquo;, this &lsquo;N&rsquo; field signifies that Mobile Node <highlight><bold>64</bold></highlight> is part of a VPN residing on home network <highlight><bold>10</bold></highlight> and that the message contains a VPNI Extension. This VPNI extension, as shown in <cross-reference target="DRAWINGS">FIG. 5, 400</cross-reference> and <highlight><bold>410</bold></highlight>, is grafted upon the registration request message as shown in FIGS. <highlight><bold>8</bold></highlight> at <highlight><bold>790</bold></highlight> and <highlight><bold>795</bold></highlight>, or binding update messages as shown in <cross-reference target="DRAWINGS">FIG. 10</cross-reference> at <highlight><bold>992</bold></highlight> and <highlight><bold>994</bold></highlight>. </paragraph>
<paragraph id="P-0106" lvl="0"><number>&lsqb;0106&rsqb;</number> The generalized tunnel protocol using the VPN Identifiers is shown in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>. The original data packet <highlight><bold>300</bold></highlight> is encapsulated into a data packet <highlight><bold>350</bold></highlight> used for &ldquo;tunneling&rdquo; between the Home Agent <highlight><bold>28</bold></highlight> and the Foreign Agent <highlight><bold>58</bold></highlight>. The VPNI extension <highlight><bold>370</bold></highlight> and Outer IP Header <highlight><bold>360</bold></highlight> (the intermediate routing through a care-of address) is added by either the Home Agent <highlight><bold>28</bold></highlight> or Foreign Agent <highlight><bold>58</bold></highlight>. The Home Agent <highlight><bold>28</bold></highlight> and Foreign Agent <highlight><bold>58</bold></highlight> thus encapsulate the data packet for transmission and decapsulate the data packet for further routing upon receipt according to the VPNI extension <highlight><bold>370</bold></highlight> and Outer IP Header <highlight><bold>360</bold></highlight>. </paragraph>
<paragraph id="P-0107" lvl="0"><number>&lsqb;0107&rsqb;</number> Using the VPN Identifiers, when connected with the Foreign Agent <highlight><bold>58</bold></highlight>, the Mobile Node <highlight><bold>64</bold></highlight> receives an agent advertisement from the Foreign Agent informing it that it is on a foreign network. Included in the agent advertisement is the care-of address, which the Mobile Node <highlight><bold>64</bold></highlight> sends to the Home Agent <highlight><bold>28</bold></highlight> via either a Registration Request Message (IPV4 standard) in <cross-reference target="DRAWINGS">FIG. 8</cross-reference> or Binding Update Message (IPV6 standard) in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>. When the &lsquo;N&rsquo; bit (<highlight><bold>735</bold></highlight> and <highlight><bold>953</bold></highlight>) is set to &lsquo;1&rsquo; in the flag bit fields (<highlight><bold>730</bold></highlight> and <highlight><bold>950</bold></highlight>), both the Home Agent <highlight><bold>28</bold></highlight> and the Foreign Agent <highlight><bold>58</bold></highlight> must use the tunneling protocol shown in <cross-reference target="DRAWINGS">FIGS. 4 and 6</cross-reference> to tunnel the information packets between those agents. The &lsquo;N&rsquo; bit also signifies the presence of a VPNI Extension field (<highlight><bold>790</bold></highlight>, <highlight><bold>795</bold></highlight>, <highlight><bold>992</bold></highlight> and <highlight><bold>994</bold></highlight>) in addition to a care-of address (<highlight><bold>770</bold></highlight> and <highlight><bold>990</bold></highlight>) to incorporate into the tunneling protocol. </paragraph>
<paragraph id="P-0108" lvl="0"><number>&lsqb;0108&rsqb;</number> The care-of address is the IP address of the current foreign network <highlight><bold>40</bold></highlight> where the Mobile Node <highlight><bold>64</bold></highlight> is located. After registering a care-of address and VPNI with the Home Agent <highlight><bold>28</bold></highlight> using either a Registration Request Message (<cross-reference target="DRAWINGS">FIG. 8</cross-reference>) or Binding Update Message (<cross-reference target="DRAWINGS">FIG. 10</cross-reference>), the Home Agent <highlight><bold>28</bold></highlight> will encapsulate any received information packet addressed to the Mobile Node <highlight><bold>64</bold></highlight> with the care-of IP address of the foreign network <highlight><bold>40</bold></highlight> and the VPNI extension. The encapsulated data packet <highlight><bold>350</bold></highlight> will thus include the VPNI as shown in FIGS. <highlight><bold>4</bold></highlight> (<highlight><bold>370</bold></highlight>) and <highlight><bold>6</bold></highlight> (<highlight><bold>520</bold></highlight> and <highlight><bold>530</bold></highlight>). The Home Agent <highlight><bold>28</bold></highlight> will &ldquo;tunnel&rdquo; the information packet <highlight><bold>350</bold></highlight> to the Mobile Node&apos;s <highlight><bold>64</bold></highlight> current location on the foreign network <highlight><bold>40</bold></highlight> via the applicable care-of address, routing the information through the Foreign Agent <highlight><bold>58</bold></highlight>. </paragraph>
<paragraph id="P-0109" lvl="0"><number>&lsqb;0109&rsqb;</number> The Foreign Agent <highlight><bold>58</bold></highlight> receives the information packet <highlight><bold>350</bold></highlight> destined for Mobile Node <highlight><bold>64</bold></highlight> and decapsulates or de-tunnels the data packet. The Foreign Agent <highlight><bold>58</bold></highlight> then routes the packet to the Mobile Node <highlight><bold>64</bold></highlight> according to the VPNI Extension, which provides a unique identity for the VPN associated with Mobile Node <highlight><bold>64</bold></highlight>. For any data sent from the Mobile Node <highlight><bold>64</bold></highlight>, the Foreign Agent <highlight><bold>58</bold></highlight> will also encapsulate the data with the IP address for the home network as well as the VPNI. The VPNI address will then permit the Home Agent <highlight><bold>28</bold></highlight> to route the data packet to the VPN. The information packet sent to the Home Agent <highlight><bold>28</bold></highlight> is de-tunneled and routed according to the VPNI and/or any IP address attached to the data packet under the standard TCP/IP communication protocol. All data communication between the Home Agent <highlight><bold>28</bold></highlight> and Foreign Agent <highlight><bold>58</bold></highlight> is encapsulated using the VPNI and tunneled accordingly by the Home Agent <highlight><bold>28</bold></highlight> or Foreign Agent <highlight><bold>58</bold></highlight> as shown in <cross-reference target="DRAWINGS">FIGS. 4 and 6</cross-reference>. </paragraph>
<paragraph id="P-0110" lvl="0"><number>&lsqb;0110&rsqb;</number> In the typical situation under the prior art, when the Mobile Node <highlight><bold>64</bold></highlight> transmits a registration request or binding update message, the Home Agent <highlight><bold>28</bold></highlight> will issue an acknowledgement. However, under the invention, when the &lsquo;N&rsquo; field is set to &lsquo;1&rsquo;, the Home Agent <highlight><bold>28</bold></highlight> will not transmit an acknowledgement to the messages. </paragraph>
<paragraph id="P-0111" lvl="0"><number>&lsqb;0111&rsqb;</number> While the invention has been particularly shown and described with respect to preferred embodiments, it will be readily understood that minor changes in the details of the invention may be made without departing from the spirit of the invention.</paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">Having described the invention, we claim: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. A communications system, comprising: 
<claim-text>a home network having a home agent coupled to a home network computer system; </claim-text>
<claim-text>a virtual private network residing on the home network; </claim-text>
<claim-text>a foreign network having a foreign agent coupled to a foreign network computer system; </claim-text>
<claim-text>a mobile node associated with the virtual private network and located on the foreign network; </claim-text>
<claim-text>wherein information packets are transmitted to the mobile node using a virtual private network identifier that designates the virtual private network associated with the mobile node. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The communications system in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein the virtual private network identifier is used by the home agent to identify the virtual private network. </claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The communications system in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein the virtual private network identifier is identified using a registration request message. </claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The communications system in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein the virtual private network identifier is identified using a binding update message. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. The communications system in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein the virtual private network identifier has two parts. </claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The communication system in <dependent-claim-reference depends_on="CLM-00005">claim 5</dependent-claim-reference> wherein the virtual private network identifier contains a virtual private network organizational identifier and a virtual private network index. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. The communications system in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein the information packet contains a flag bit field that can be set to indicate the presence of a virtual private network identifier. </claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The communications system in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein more than one virtual private networks can reside on the physical infrastructure of the home network and each network is designated by a virtual private network identifier. </claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. The method of transmitting an information packet to a mobile node associated with a virtual private network comprising the steps of: 
<claim-text>providing a home network with the virtual private network, </claim-text>
<claim-text>providing a foreign network where the mobile node is located, </claim-text>
<claim-text>encapsulating the information packet for delivery to the mobile node with a virtual private network identifier and a foreign network address; </claim-text>
<claim-text>transmitting the information packet to the foreign network, </claim-text>
<claim-text>decapsulating the information packet at the foreign network, and, </claim-text>
<claim-text>transmitting the information packet to the appropriate mobile node on the foreign network using the virtual private network identifier. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. The method of transmission of <dependent-claim-reference depends_on="CLM-00009">claim 9</dependent-claim-reference> further comprising the steps of: 
<claim-text>issuing a registration request for the foreign agent on the foreign network using the virtual private network identifier. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. The method of transmission of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> further comprising the steps of: 
<claim-text>registering the mobile node with the home agent on the home network using the virtual private network identifier. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. The method of transmission of <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference> further comprising the steps of: 
<claim-text>registering the mobile node with the foreign agent on the foreign network using the virtual private network identifier. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. The method of transmission of <dependent-claim-reference depends_on="CLM-00009">claim 9</dependent-claim-reference> wherein the virtual private network identifier has an organization identifier and an index value. </claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. The method of transmission in <dependent-claim-reference depends_on="CLM-00009">claim 9</dependent-claim-reference> wherein the information packet contains a flag bit field that signifies the presence of a virtual private network identifier. </claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. A method of transmitting information packets to a mobile node on a foreign network from the mobile node&apos;s home network comprising the steps of: 
<claim-text>providing a virtual private network association with the mobile node, wherein the virtual private network resides on the home network, </claim-text>
<claim-text>encapsulating an information packet with a virtual private network identifier and a care-of address identifier for the foreign network, </claim-text>
<claim-text>transmitting the information packet from the home network to the foreign network, </claim-text>
<claim-text>receiving the information packet from the home agent at the foreign agent; </claim-text>
<claim-text>decapsulating the information packet at the foreign network, and routing the information packet to the mobile node using the virtual private network identifier. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. The method of transmitting information packets in <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference> further comprising: 
<claim-text>encapsulating information packets at the foreign network using the virtual private network identifier; </claim-text>
<claim-text>transmitting the information packet to the home network; </claim-text>
<claim-text>decapsulating the information packet at the home network; </claim-text>
<claim-text>using the virtual private network identifier to transmit the information packet to the virtual private network. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. The method of transmitting information packets in <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference> wherein the virtual private network identifier has an organizational identifier and an index value. </claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. The method of transmitting information packets in <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference> wherein the home network has a home agent that routes the information packet to the virtual private network using the virtual private network identifier. </claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. The method of transmitting information packet in <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference> wherein the foreign network has a foreign agent that identifies the mobile node using the virtual private network identifier. </claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. The method of transmitting information packet in <dependent-claim-reference depends_on="CLM-00011">claim 19</dependent-claim-reference> wherein the home network has a home agent that routes information packet to the virtual private network using the virtual private network identifier.</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>4</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030002468A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030002468A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030002468A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030002468A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030002468A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
