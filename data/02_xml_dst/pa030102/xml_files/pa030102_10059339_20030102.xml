<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030002662A1-20030102-M00001.NB SYSTEM "US20030002662A1-20030102-M00001.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00001.TIF SYSTEM "US20030002662A1-20030102-M00001.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00002.NB SYSTEM "US20030002662A1-20030102-M00002.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00002.TIF SYSTEM "US20030002662A1-20030102-M00002.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00003.NB SYSTEM "US20030002662A1-20030102-M00003.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00003.TIF SYSTEM "US20030002662A1-20030102-M00003.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00004.NB SYSTEM "US20030002662A1-20030102-M00004.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00004.TIF SYSTEM "US20030002662A1-20030102-M00004.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00005.NB SYSTEM "US20030002662A1-20030102-M00005.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00005.TIF SYSTEM "US20030002662A1-20030102-M00005.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00006.NB SYSTEM "US20030002662A1-20030102-M00006.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00006.TIF SYSTEM "US20030002662A1-20030102-M00006.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00007.NB SYSTEM "US20030002662A1-20030102-M00007.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00007.TIF SYSTEM "US20030002662A1-20030102-M00007.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00008.NB SYSTEM "US20030002662A1-20030102-M00008.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00008.TIF SYSTEM "US20030002662A1-20030102-M00008.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00009.NB SYSTEM "US20030002662A1-20030102-M00009.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00009.TIF SYSTEM "US20030002662A1-20030102-M00009.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00010.NB SYSTEM "US20030002662A1-20030102-M00010.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00010.TIF SYSTEM "US20030002662A1-20030102-M00010.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00011.NB SYSTEM "US20030002662A1-20030102-M00011.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00011.TIF SYSTEM "US20030002662A1-20030102-M00011.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00012.NB SYSTEM "US20030002662A1-20030102-M00012.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00012.TIF SYSTEM "US20030002662A1-20030102-M00012.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00013.NB SYSTEM "US20030002662A1-20030102-M00013.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00013.TIF SYSTEM "US20030002662A1-20030102-M00013.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00014.NB SYSTEM "US20030002662A1-20030102-M00014.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00014.TIF SYSTEM "US20030002662A1-20030102-M00014.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00015.NB SYSTEM "US20030002662A1-20030102-M00015.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00015.TIF SYSTEM "US20030002662A1-20030102-M00015.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00016.NB SYSTEM "US20030002662A1-20030102-M00016.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00016.TIF SYSTEM "US20030002662A1-20030102-M00016.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00017.NB SYSTEM "US20030002662A1-20030102-M00017.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00017.TIF SYSTEM "US20030002662A1-20030102-M00017.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00018.NB SYSTEM "US20030002662A1-20030102-M00018.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00018.TIF SYSTEM "US20030002662A1-20030102-M00018.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00019.NB SYSTEM "US20030002662A1-20030102-M00019.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00019.TIF SYSTEM "US20030002662A1-20030102-M00019.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00020.NB SYSTEM "US20030002662A1-20030102-M00020.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00020.TIF SYSTEM "US20030002662A1-20030102-M00020.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00021.NB SYSTEM "US20030002662A1-20030102-M00021.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00021.TIF SYSTEM "US20030002662A1-20030102-M00021.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00022.NB SYSTEM "US20030002662A1-20030102-M00022.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00022.TIF SYSTEM "US20030002662A1-20030102-M00022.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00023.NB SYSTEM "US20030002662A1-20030102-M00023.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00023.TIF SYSTEM "US20030002662A1-20030102-M00023.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00024.NB SYSTEM "US20030002662A1-20030102-M00024.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00024.TIF SYSTEM "US20030002662A1-20030102-M00024.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00025.NB SYSTEM "US20030002662A1-20030102-M00025.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00025.TIF SYSTEM "US20030002662A1-20030102-M00025.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00026.NB SYSTEM "US20030002662A1-20030102-M00026.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00026.TIF SYSTEM "US20030002662A1-20030102-M00026.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00027.NB SYSTEM "US20030002662A1-20030102-M00027.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00027.TIF SYSTEM "US20030002662A1-20030102-M00027.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00028.NB SYSTEM "US20030002662A1-20030102-M00028.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00028.TIF SYSTEM "US20030002662A1-20030102-M00028.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00029.NB SYSTEM "US20030002662A1-20030102-M00029.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00029.TIF SYSTEM "US20030002662A1-20030102-M00029.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00030.NB SYSTEM "US20030002662A1-20030102-M00030.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00030.TIF SYSTEM "US20030002662A1-20030102-M00030.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00031.NB SYSTEM "US20030002662A1-20030102-M00031.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00031.TIF SYSTEM "US20030002662A1-20030102-M00031.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00032.NB SYSTEM "US20030002662A1-20030102-M00032.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00032.TIF SYSTEM "US20030002662A1-20030102-M00032.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00033.NB SYSTEM "US20030002662A1-20030102-M00033.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00033.TIF SYSTEM "US20030002662A1-20030102-M00033.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00034.NB SYSTEM "US20030002662A1-20030102-M00034.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00034.TIF SYSTEM "US20030002662A1-20030102-M00034.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00035.NB SYSTEM "US20030002662A1-20030102-M00035.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00035.TIF SYSTEM "US20030002662A1-20030102-M00035.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00036.NB SYSTEM "US20030002662A1-20030102-M00036.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00036.TIF SYSTEM "US20030002662A1-20030102-M00036.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00037.NB SYSTEM "US20030002662A1-20030102-M00037.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00037.TIF SYSTEM "US20030002662A1-20030102-M00037.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00038.NB SYSTEM "US20030002662A1-20030102-M00038.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00038.TIF SYSTEM "US20030002662A1-20030102-M00038.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00039.NB SYSTEM "US20030002662A1-20030102-M00039.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00039.TIF SYSTEM "US20030002662A1-20030102-M00039.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00040.NB SYSTEM "US20030002662A1-20030102-M00040.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00040.TIF SYSTEM "US20030002662A1-20030102-M00040.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00041.NB SYSTEM "US20030002662A1-20030102-M00041.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00041.TIF SYSTEM "US20030002662A1-20030102-M00041.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00042.NB SYSTEM "US20030002662A1-20030102-M00042.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00042.TIF SYSTEM "US20030002662A1-20030102-M00042.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00043.NB SYSTEM "US20030002662A1-20030102-M00043.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00043.TIF SYSTEM "US20030002662A1-20030102-M00043.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00044.NB SYSTEM "US20030002662A1-20030102-M00044.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00044.TIF SYSTEM "US20030002662A1-20030102-M00044.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00045.NB SYSTEM "US20030002662A1-20030102-M00045.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00045.TIF SYSTEM "US20030002662A1-20030102-M00045.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00046.NB SYSTEM "US20030002662A1-20030102-M00046.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00046.TIF SYSTEM "US20030002662A1-20030102-M00046.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00047.NB SYSTEM "US20030002662A1-20030102-M00047.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00047.TIF SYSTEM "US20030002662A1-20030102-M00047.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00048.NB SYSTEM "US20030002662A1-20030102-M00048.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00048.TIF SYSTEM "US20030002662A1-20030102-M00048.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00049.NB SYSTEM "US20030002662A1-20030102-M00049.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00049.TIF SYSTEM "US20030002662A1-20030102-M00049.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00050.NB SYSTEM "US20030002662A1-20030102-M00050.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00050.TIF SYSTEM "US20030002662A1-20030102-M00050.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00051.NB SYSTEM "US20030002662A1-20030102-M00051.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00051.TIF SYSTEM "US20030002662A1-20030102-M00051.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00052.NB SYSTEM "US20030002662A1-20030102-M00052.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00052.TIF SYSTEM "US20030002662A1-20030102-M00052.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00053.NB SYSTEM "US20030002662A1-20030102-M00053.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00053.TIF SYSTEM "US20030002662A1-20030102-M00053.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00054.NB SYSTEM "US20030002662A1-20030102-M00054.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00054.TIF SYSTEM "US20030002662A1-20030102-M00054.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00055.NB SYSTEM "US20030002662A1-20030102-M00055.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00055.TIF SYSTEM "US20030002662A1-20030102-M00055.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00056.NB SYSTEM "US20030002662A1-20030102-M00056.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00056.TIF SYSTEM "US20030002662A1-20030102-M00056.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00057.NB SYSTEM "US20030002662A1-20030102-M00057.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00057.TIF SYSTEM "US20030002662A1-20030102-M00057.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00058.NB SYSTEM "US20030002662A1-20030102-M00058.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00058.TIF SYSTEM "US20030002662A1-20030102-M00058.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00059.NB SYSTEM "US20030002662A1-20030102-M00059.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00059.TIF SYSTEM "US20030002662A1-20030102-M00059.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00060.NB SYSTEM "US20030002662A1-20030102-M00060.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00060.TIF SYSTEM "US20030002662A1-20030102-M00060.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00061.NB SYSTEM "US20030002662A1-20030102-M00061.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00061.TIF SYSTEM "US20030002662A1-20030102-M00061.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00062.NB SYSTEM "US20030002662A1-20030102-M00062.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00062.TIF SYSTEM "US20030002662A1-20030102-M00062.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00063.NB SYSTEM "US20030002662A1-20030102-M00063.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00063.TIF SYSTEM "US20030002662A1-20030102-M00063.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00064.NB SYSTEM "US20030002662A1-20030102-M00064.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00064.TIF SYSTEM "US20030002662A1-20030102-M00064.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00065.NB SYSTEM "US20030002662A1-20030102-M00065.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00065.TIF SYSTEM "US20030002662A1-20030102-M00065.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00066.NB SYSTEM "US20030002662A1-20030102-M00066.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00066.TIF SYSTEM "US20030002662A1-20030102-M00066.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00067.NB SYSTEM "US20030002662A1-20030102-M00067.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00067.TIF SYSTEM "US20030002662A1-20030102-M00067.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00068.NB SYSTEM "US20030002662A1-20030102-M00068.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00068.TIF SYSTEM "US20030002662A1-20030102-M00068.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00069.NB SYSTEM "US20030002662A1-20030102-M00069.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00069.TIF SYSTEM "US20030002662A1-20030102-M00069.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00070.NB SYSTEM "US20030002662A1-20030102-M00070.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00070.TIF SYSTEM "US20030002662A1-20030102-M00070.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00071.NB SYSTEM "US20030002662A1-20030102-M00071.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00071.TIF SYSTEM "US20030002662A1-20030102-M00071.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00072.NB SYSTEM "US20030002662A1-20030102-M00072.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00072.TIF SYSTEM "US20030002662A1-20030102-M00072.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00073.NB SYSTEM "US20030002662A1-20030102-M00073.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00073.TIF SYSTEM "US20030002662A1-20030102-M00073.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00074.NB SYSTEM "US20030002662A1-20030102-M00074.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00074.TIF SYSTEM "US20030002662A1-20030102-M00074.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00075.NB SYSTEM "US20030002662A1-20030102-M00075.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00075.TIF SYSTEM "US20030002662A1-20030102-M00075.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00076.NB SYSTEM "US20030002662A1-20030102-M00076.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00076.TIF SYSTEM "US20030002662A1-20030102-M00076.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00077.NB SYSTEM "US20030002662A1-20030102-M00077.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00077.TIF SYSTEM "US20030002662A1-20030102-M00077.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00078.NB SYSTEM "US20030002662A1-20030102-M00078.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00078.TIF SYSTEM "US20030002662A1-20030102-M00078.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00079.NB SYSTEM "US20030002662A1-20030102-M00079.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00079.TIF SYSTEM "US20030002662A1-20030102-M00079.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00080.NB SYSTEM "US20030002662A1-20030102-M00080.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00080.TIF SYSTEM "US20030002662A1-20030102-M00080.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00081.NB SYSTEM "US20030002662A1-20030102-M00081.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00081.TIF SYSTEM "US20030002662A1-20030102-M00081.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00082.NB SYSTEM "US20030002662A1-20030102-M00082.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00082.TIF SYSTEM "US20030002662A1-20030102-M00082.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00083.NB SYSTEM "US20030002662A1-20030102-M00083.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00083.TIF SYSTEM "US20030002662A1-20030102-M00083.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00084.NB SYSTEM "US20030002662A1-20030102-M00084.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00084.TIF SYSTEM "US20030002662A1-20030102-M00084.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00085.NB SYSTEM "US20030002662A1-20030102-M00085.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00085.TIF SYSTEM "US20030002662A1-20030102-M00085.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00086.NB SYSTEM "US20030002662A1-20030102-M00086.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00086.TIF SYSTEM "US20030002662A1-20030102-M00086.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00087.NB SYSTEM "US20030002662A1-20030102-M00087.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00087.TIF SYSTEM "US20030002662A1-20030102-M00087.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00088.NB SYSTEM "US20030002662A1-20030102-M00088.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00088.TIF SYSTEM "US20030002662A1-20030102-M00088.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00089.NB SYSTEM "US20030002662A1-20030102-M00089.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00089.TIF SYSTEM "US20030002662A1-20030102-M00089.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00090.NB SYSTEM "US20030002662A1-20030102-M00090.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00090.TIF SYSTEM "US20030002662A1-20030102-M00090.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00091.NB SYSTEM "US20030002662A1-20030102-M00091.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00091.TIF SYSTEM "US20030002662A1-20030102-M00091.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00092.NB SYSTEM "US20030002662A1-20030102-M00092.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00092.TIF SYSTEM "US20030002662A1-20030102-M00092.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00093.NB SYSTEM "US20030002662A1-20030102-M00093.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00093.TIF SYSTEM "US20030002662A1-20030102-M00093.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00094.NB SYSTEM "US20030002662A1-20030102-M00094.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00094.TIF SYSTEM "US20030002662A1-20030102-M00094.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00095.NB SYSTEM "US20030002662A1-20030102-M00095.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00095.TIF SYSTEM "US20030002662A1-20030102-M00095.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00096.NB SYSTEM "US20030002662A1-20030102-M00096.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00096.TIF SYSTEM "US20030002662A1-20030102-M00096.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00097.NB SYSTEM "US20030002662A1-20030102-M00097.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00097.TIF SYSTEM "US20030002662A1-20030102-M00097.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00098.NB SYSTEM "US20030002662A1-20030102-M00098.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00098.TIF SYSTEM "US20030002662A1-20030102-M00098.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00099.NB SYSTEM "US20030002662A1-20030102-M00099.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00099.TIF SYSTEM "US20030002662A1-20030102-M00099.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00100.NB SYSTEM "US20030002662A1-20030102-M00100.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00100.TIF SYSTEM "US20030002662A1-20030102-M00100.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00101.NB SYSTEM "US20030002662A1-20030102-M00101.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00101.TIF SYSTEM "US20030002662A1-20030102-M00101.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00102.NB SYSTEM "US20030002662A1-20030102-M00102.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00102.TIF SYSTEM "US20030002662A1-20030102-M00102.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00103.NB SYSTEM "US20030002662A1-20030102-M00103.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00103.TIF SYSTEM "US20030002662A1-20030102-M00103.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00104.NB SYSTEM "US20030002662A1-20030102-M00104.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00104.TIF SYSTEM "US20030002662A1-20030102-M00104.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00105.NB SYSTEM "US20030002662A1-20030102-M00105.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00105.TIF SYSTEM "US20030002662A1-20030102-M00105.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00106.NB SYSTEM "US20030002662A1-20030102-M00106.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00106.TIF SYSTEM "US20030002662A1-20030102-M00106.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00107.NB SYSTEM "US20030002662A1-20030102-M00107.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00107.TIF SYSTEM "US20030002662A1-20030102-M00107.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00108.NB SYSTEM "US20030002662A1-20030102-M00108.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00108.TIF SYSTEM "US20030002662A1-20030102-M00108.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00109.NB SYSTEM "US20030002662A1-20030102-M00109.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00109.TIF SYSTEM "US20030002662A1-20030102-M00109.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-M00110.NB SYSTEM "US20030002662A1-20030102-M00110.NB" NDATA NB>
<!ENTITY US20030002662A1-20030102-M00110.TIF SYSTEM "US20030002662A1-20030102-M00110.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00000.TIF SYSTEM "US20030002662A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00001.TIF SYSTEM "US20030002662A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00002.TIF SYSTEM "US20030002662A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00003.TIF SYSTEM "US20030002662A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00004.TIF SYSTEM "US20030002662A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00005.TIF SYSTEM "US20030002662A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00006.TIF SYSTEM "US20030002662A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00007.TIF SYSTEM "US20030002662A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00008.TIF SYSTEM "US20030002662A1-20030102-D00008.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00009.TIF SYSTEM "US20030002662A1-20030102-D00009.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00010.TIF SYSTEM "US20030002662A1-20030102-D00010.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00011.TIF SYSTEM "US20030002662A1-20030102-D00011.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00012.TIF SYSTEM "US20030002662A1-20030102-D00012.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00013.TIF SYSTEM "US20030002662A1-20030102-D00013.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00014.TIF SYSTEM "US20030002662A1-20030102-D00014.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00015.TIF SYSTEM "US20030002662A1-20030102-D00015.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00016.TIF SYSTEM "US20030002662A1-20030102-D00016.TIF" NDATA TIF>
<!ENTITY US20030002662A1-20030102-D00017.TIF SYSTEM "US20030002662A1-20030102-D00017.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030002662</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10059339</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20020131</filing-date>
</domestic-filing-data>
<foreign-priority-data>
<priority-application-number>
<doc-number>2001-112161</doc-number>
</priority-application-number>
<filing-date>20010411</filing-date>
<country-code>JP</country-code>
</foreign-priority-data>
<foreign-priority-data>
<priority-application-number>
<doc-number>2001-121969</doc-number>
</priority-application-number>
<filing-date>20010420</filing-date>
<country-code>JP</country-code>
</foreign-priority-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>H04K001/00</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>380</class>
<subclass>030000</subclass>
</uspc>
</classification-us-primary>
</classification-us>
<title-of-invention>Method of a public key encryption and a cypher communication both secure against a chosen-ciphertext attack</title-of-invention>
</technical-information>
<inventors>
<first-named-inventor>
<name>
<given-name>Mototsugu</given-name>
<family-name>Nishioka</family-name>
</name>
<residence>
<residence-non-us>
<city>Yokohoama</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Yoichi</given-name>
<family-name>Seto</family-name>
</name>
<residence>
<residence-non-us>
<city>Sagamihara</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Hisayoshi</given-name>
<family-name>Satoh</family-name>
</name>
<residence>
<residence-non-us>
<city>Yokohama</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<correspondence-address>
<name-1>ANTONELLI TERRY STOUT AND KRAUS</name-1>
<name-2></name-2>
<address>
<address-1>SUITE 1800</address-1>
<address-2>1300 NORTH SEVENTEENTH STREET</address-2>
<city>ARLINGTON</city>
<state>VA</state>
<postalcode>22209</postalcode>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">The public-key encryption method uses the sender-side apparatus by the creator of a ciphertest and creates the ciphertext of a plaintext x (&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>) in y<highlight><subscript>1</subscript></highlight>&equals;f(x0<highlight><superscript>kl</superscript></highlight>G(r)), Y<highlight><subscript>2</subscript></highlight>&equals;H(x0<highlight><superscript>kl</superscript></highlight>G(r))r with respect to the published trapdoor-equipped unidirectional function f and the random functions G, H. Meanwhile, the receiver of the ciphertext, who has received the ciphertext by the receiver-side apparatus via the communications line, performs the decryption processing with the use of f<highlight><superscript>&minus;1</superscript></highlight>, i.e., the secret key, in accordance with the steps inverse to those of the encryption processing. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> The present invention relates to a cipher communication method using a public-key encryption scheme and being provable to be semantically-secure against an adaptive chosen-ciphertext attack. </paragraph>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> Up to the present, a variety of public-key encryption methods have been proposed. Among them, an encryption method published in a literature 1: &ldquo;R. L. Rivest, A. Shamir, L. Adleman: A Method for Obtaining Digital Signatures and Public-Key Cryptosystems, Commun. of the ACM, Vol. 21, No. 2, pp. 120-126, (1978)&rdquo; is the most famous and the most put-into-practical-use public-key encryption scheme. As another encryption method, a method using elliptic curves described in the following literatures has been known as an efficient public key encryption scheme: A literature 2: &ldquo;V. S. Miller: Use of Elliptic Curves in Cryptography, Proc. of Crypto&apos; 85, LNCS218, Springer-Verlag, pp. 417-426, (1985)&rdquo;, a literature 3: &ldquo;N. Koblitz: Elliptic Curve Cryptosystems, Math. Comp., 48, 177, pp. 203-209, (1987)&rdquo;, and so on. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> As encryption methods that are provable about the security, at first, as the methods with a chosen-plaintext attack set as their object, the following have been known: A method described in a literature 4: &ldquo;M. O. Rabin: Digital Signatures and Public-Key Encryptions as Intractable as Factorization, MIT, Technical Report, MIT/LCS/TR-212 (1979)&rdquo;, a method described in a literature 5: &ldquo;T. E L Gamel: A Public Key Cryptosystem and a Signature Scheme Based on Discrete Logarithms, IEEE, Trans. On Information Theory, IT-31, 4, pp. 469-472, (1985)&rdquo;, a method described in a literature 6: &ldquo;S. Goldwasser and S. Micali: Probabilistic Encryption, JCSS, 28, 2, pp. 270-299, (1984)&rdquo;, a method described in a literature 7: &ldquo;M. Blum and S. Goldwasser: An Efficient Probabilistic Public-Key Encryption Scheme which Hides All Partial Information, Proc. of Crypto&apos; 84, LNCS196, Springer-Verlag, pp. 289-299, (1985)&rdquo;, a method described in a literature 8: &ldquo;S. Goldwasser and M. Bellare: Lecture Notes on Cryptography, http:/www-cse.ucsd.edu/users/mihir/ (1997)&rdquo;, a method described in a literature 9: &ldquo;T. Okamoto and S. Uchiyama: A New Public-Key Cryptosystem as Secure as Factoring, Proc. of Eurocrypto&apos; 98, LNCS1403, Springer-Verlag, pp. 308-318, (1998)&rdquo;, and so on. </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> Also, as encryption methods that are provable about the security against the chosen-ciphertext attack, the following have been known: A method described in a literature 10: &ldquo;D. Dolve, C. Dwork, and M. Naor: Non-Malleable Cryptography, In 23rd Annual ACM Symposium on Theory of Computing, pp. 542-552, (1991)&rdquo;, a method described in a literature 11: &ldquo;M. Naor and M. Yung: Public-Key Cryptosystems Non-malleable against Chosen Ciphertext Attacks, Proc. of STOC, ACM Press, pp. 427-437, (1990)&rdquo;, a method described in a literature 12: &ldquo;R. Cramer and V. Shoup: A Practical Public-Key Cryptosystem Non-malleable against Adaptive Chosen Ciphertext Attack, Proc. of Crypto&apos; 98, LNCS1462, Springer-Verlag, pp. 13-25, (1998)&rdquo;, and so on. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> Also, in a literature 13: &ldquo;M. Bellare, A. Desai, D. Pointcheval, and P. Rogaway: Relations Among Notions of Security for Public-Key Encryption Schemes, Proc. of Crypto&apos; 98, LNCS1462, Springer-Verlag, pp. 26-45, (1998)&rdquo;, the equivalence between IND-CCA2 (i.e., being semantically-secure against the adaptive chosen-ciphertext attack) and NM-CCA2 (i.e., being non-malleable against the adaptive chosen-ciphertext attack) has been demonstrated. Accordingly, at present, the public key encryption scheme satisfying this condition is considered as the most secure cypher. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> An encryption method described in a literature 14: &ldquo;M. Bellare and P. Rogaway: Optimal Asymmetric Encryption How to Encrypt with RSA, Proc. of Eurocrypto&apos; 94, LNCS950, Springer-Verlag, pp. 92-111, (1994)&rdquo; has been considered as semantically-secure against the adaptive chosen-ciphertext attack on the premise of the difficulty in calculating the inverse function of a one-way trapdoor permutation. In recent years, however, in a literature 15: &ldquo;V. Shoup: OAEP Reconsidered. Available on the e-print library (2000/060), November 2000&rdquo;, a problem and the fact that the proof of the security is insufficient from a general viewpoint have been pointed out, and the solving methods therefor have been also proposed. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> Meanwhile, in a cipher communication, in many cases, transmission data is encrypted using a common-key cypher, and the secret key to the common-key cypher used for the data encryption at that time is encrypted using a public key encryption scheme. One reason for this is that the length of a plaintext that can be encryption-processed at one time using the public-key encryption methods described in the above-described respective literatures is short, and is limited in proportion to the key length. For example, in the encryption method described in the literature 1, if the key length is 1024 bits, the plaintext is, at the most, 1024 bits. Moreover, in the encryption method described in the literature 3, if the base p is 160 bits, the information that can be transmitted at the one-time encryption is 160 bits. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> In the practical systems, however, there are many cases where, in addition to the common key, the identification information (i.e., the ID information) of the user is also sent together therewith. Also, in accompaniment with the advancement of the computers&apos; capabilities, the key length to be transmitted is now getting longer and longer. On account of this, there occurs a necessity for performing the encryption in a manner of being divided into a plurality of times. In the case of dividing the encryption into the plurality of times, there occurs a necessity for guaranteeing the validity of the correspondences among the respective ciphertexts. This necessitates much extra time and labor. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> From the situation like this, expectations are concentrated on an encryption method which allows a longer plaintext to be encrypted at one time and whose security against the attack is provable. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> Also, the literature 4 has proved that the encryption method described in the literature 4 is unidirectional against the chosen-plaintext attack. This, however, means that the encryption method is weak against the chosen-ciphertext attack. Also, although the encryption method in the literature 4 is superior in the high-speed performance in the encryption processing, the method could not be expected to implement a high-speed decryption processing. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> It is an object of the present invention to provide an encryption method and a decryption method imposing only a small load on a calculation in encrypting transmission data and a calculation in decrypting encrypted data, allowing a high-speed processing to be implemented even in a limited calculation-capability information processing apparatus such as a portable-type information processing appliance, and using a public key, a key distribution method and a key sharing method using the public key, and further a program, an apparatus, or a system for executing these methods. </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> It is another object of the present invention to provide a method of constructing a public-key encryption method that is provable to be IND-CCA2 (i.e., semantically-secure against the adaptive chosen-ciphertext attack) on the premise of the difficulty in calculating the inverse function of a general one-way trapdoor permutation. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> Furthermore, it is still another object of the present invention to provide, in the above-described public-key encryption method, a concrete public-key encryption method that is provable to be IND-CCA2 on the premise of the difficulty in the unique factorization problem into prime factors. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> It is an even further object of the present invention to provide, on the basis of the encryption method described in the literature 4, an encryption method that is secure against the chosen-ciphertext attack and that permits the high-speed decryption processing to be implemented. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> According to a 1st feature of the present invention, the present invention is carried out as follows, for example: </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>f:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>one-way trapdoor permutation, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(1) </in-line-formula></paragraph>
<paragraph id="P-0016" lvl="7"><number>&lsqb;0016&rsqb;</number> are defined as a public key, and </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>:&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>Trapdoor function&emsp;&emsp;(2) </in-line-formula></paragraph>
<paragraph id="P-0017" lvl="7"><number>&lsqb;0017&rsqb;</number> is defined as a secret key (where, k&equals;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&plus;n). A ciphertext sender-side apparatus, following the operation by the sender, selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), and calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;x</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(3) </in-line-formula></paragraph>
<paragraph id="P-0018" lvl="7"><number>&lsqb;0018&rsqb;</number> and further, defines </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;f</italic></highlight>(<highlight><italic>s</italic></highlight>), <highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(4) </in-line-formula></paragraph>
<paragraph id="P-0019" lvl="7"><number>&lsqb;0019&rsqb;</number> as the ciphertext, then transmitting the ciphertext to a receiver-side apparatus. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> In accordance with the operation by the receiver, the ciphertext receiver-side apparatus, using the secret key of the receiver, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&prime;&equals;f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>(<highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight>), <highlight><italic>t&prime;&equals;y</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(5) </in-line-formula></paragraph>
<paragraph id="P-0021" lvl="7"><number>&lsqb;0021&rsqb;</number> and further, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(6) </in-line-formula></paragraph>
<paragraph id="P-0022" lvl="7"><number>&lsqb;0022&rsqb;</number> and, based on  
<math-cwu id="MATH-US-00001">
<number>1</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>x</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>[</mo>
                    <mrow>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&CirclePlus;</mo>
                      <mrow>
                        <mi>G</mi>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>]</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <mrow>
                    <msub>
                      <mrow>
                        <mi>if</mi>
                        <mo>&it;</mo>
                        <mstyle>
                          <mtext>&emsp;</mtext>
                        </mstyle>
                        <mo>[</mo>
                        <mrow>
                          <msup>
                            <mi>s</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>&CirclePlus;</mo>
                          <mrow>
                            <mi>G</mi>
                            <mo>&af;</mo>
                            <mrow>
                              <mo>(</mo>
                              <msup>
                                <mi>r</mi>
                                <mi>&prime;</mi>
                              </msup>
                              <mo>)</mo>
                            </mrow>
                          </mrow>
                        </mrow>
                        <mo>]</mo>
                      </mrow>
                      <msub>
                        <mi>k</mi>
                        <mn>1</mn>
                      </msub>
                    </msub>
                    <mo>=</mo>
                    <msup>
                      <mn>0</mn>
                      <msub>
                        <mi>k</mi>
                        <mn>1</mn>
                      </msub>
                    </msup>
                  </mrow>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>7</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00001" file="US20030002662A1-20030102-M00001.NB"/>
<image id="EMI-M00001" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00001.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0023" lvl="7"><number>&lsqb;0023&rsqb;</number> decrypts the ciphertext, thereby obtaining the plaintext (Here, it is stipulated that, in the case where the decryption result x&prime;&equals;*, the receiver-side apparatus denies the decryption of the ciphertext. Also, &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate the more-significant and the less-significant n bits of a, respectively). </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> The decryption result x&prime;&equals;* for a ciphertext means that the correct decryption of the ciphertext has been unsuccessful. In this case, there exists a possibility that the ciphertext is a one intended for the attack. Accordingly, the receiver-side apparatus denies the decryption of the ciphertext in order to make the chosen-ciphertext attack impossible, thus never outputting the plaintext, i.e., the decryption result. At this time, the receiver-side apparatus may be formed into a configuration of outputting none of the decryption results, or may be formed into a configuration where the indication or a sound informs the receiver of the result that the decryption has been unsuccessful. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> As one of the concrete methods, </paragraph>
<paragraph id="P-0026" lvl="7"><number>&lsqb;0026&rsqb;</number> &lsqb;Key Generation&rsqb;</paragraph>
<paragraph id="P-0027" lvl="7"><number>&lsqb;0027&rsqb;</number> a secret key (p, q) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(8) </in-line-formula></paragraph>
<paragraph id="P-0028" lvl="7"><number>&lsqb;0028&rsqb;</number> is created, and further, </paragraph>
<paragraph id="P-0029" lvl="7"><number>&lsqb;0029&rsqb;</number> a public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(9) </in-line-formula></paragraph>
<paragraph id="P-0030" lvl="7"><number>&lsqb;0030&rsqb;</number> is created, and </paragraph>
<paragraph id="P-0031" lvl="7"><number>&lsqb;0031&rsqb;</number> &lsqb;Encryption&rsqb;</paragraph>
<paragraph id="P-0032" lvl="7"><number>&lsqb;0032&rsqb;</number> the ciphertext sender-side apparatus, following the operation by the sender, selects the random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for the plaintext x (x&isin;&lcub;<highlight><bold>0</bold></highlight>, <highlight><bold>1</bold></highlight>&rcub;<highlight><superscript>n</superscript></highlight>), and calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;x</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(10) </in-line-formula></paragraph>
<paragraph id="P-0033" lvl="7"><number>&lsqb;0033&rsqb;</number> (where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&amp;1t; k&minus;2). Moreover, the sender-side apparatus defines  
<math-cwu id="MATH-US-00002">
<number>2</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>1</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>s</mi>
              <mrow>
                <mn>2</mn>
                <mo>&it;</mo>
                <mi>N</mi>
              </mrow>
            </msup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>N</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>2</mn>
          </msub>
          <mo>=</mo>
          <mi>t</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>3</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mo>(</mo>
              <mfrac>
                <mi>s</mi>
                <mi>N</mi>
              </mfrac>
              <mo>)</mo>
            </mrow>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>11</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00002" file="US20030002662A1-20030102-M00002.NB"/>
<image id="EMI-M00002" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00002.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0034" lvl="7"><number>&lsqb;0034&rsqb;</number> as the ciphertext, then transmitting the ciphertext to the receiver (where, a&equals;(m/N) designates a Jacobi symbol). </paragraph>
<paragraph id="P-0035" lvl="7"><number>&lsqb;0035&rsqb;</number> &lsqb;Decryption&rsqb;</paragraph>
<paragraph id="P-0036" lvl="7"><number>&lsqb;0036&rsqb;</number> Using the secret key (p, q) of the receiver, the receiver-side apparatus calculates, from the ciphertext,  
<math-cwu id="MATH-US-00003">
<number>3</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>12</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00003" file="US20030002662A1-20030102-M00003.NB"/>
<image id="EMI-M00003" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00003.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0037" lvl="7"><number>&lsqb;0037&rsqb;</number> and, of expressions, </paragraph>
<paragraph id="P-0038" lvl="7"><number>&lsqb;0038&rsqb;</number> &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p, &minus;x</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), the apparatus sets an expression satisfying (x/N)&equals;y<highlight><subscript>3 </subscript></highlight>and 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; (where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by the Chinese remainder theorem). </paragraph>
<paragraph id="P-0039" lvl="7"><number>&lsqb;0039&rsqb;</number> Moreover, the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(13) </in-line-formula></paragraph>
<paragraph id="P-0040" lvl="7"><number>&lsqb;0040&rsqb;</number> and, based on  
<math-cwu id="MATH-US-00004">
<number>4</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>x</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>[</mo>
                    <mrow>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&CirclePlus;</mo>
                      <mrow>
                        <mi>G</mi>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>]</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <mrow>
                    <msub>
                      <mrow>
                        <mi>if</mi>
                        <mo>&it;</mo>
                        <mstyle>
                          <mtext>&emsp;</mtext>
                        </mstyle>
                        <mo>[</mo>
                        <mrow>
                          <msup>
                            <mi>s</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>&CirclePlus;</mo>
                          <mrow>
                            <mi>G</mi>
                            <mo>&af;</mo>
                            <mrow>
                              <mo>(</mo>
                              <msup>
                                <mi>r</mi>
                                <mi>&prime;</mi>
                              </msup>
                              <mo>)</mo>
                            </mrow>
                          </mrow>
                        </mrow>
                        <mo>]</mo>
                      </mrow>
                      <msub>
                        <mi>k</mi>
                        <mn>1</mn>
                      </msub>
                    </msub>
                    <mo>=</mo>
                    <msup>
                      <mn>0</mn>
                      <msub>
                        <mi>k</mi>
                        <mn>1</mn>
                      </msub>
                    </msup>
                  </mrow>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>14</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00004" file="US20030002662A1-20030102-M00004.NB"/>
<image id="EMI-M00004" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00004.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0041" lvl="7"><number>&lsqb;0041&rsqb;</number> decryption-processes the ciphertext, thereby obtaining the plaintext (i.e., the message) (Here, it is stipulated that, in the case where x&prime;&equals;*, the receiver-side apparatus denies the decryption of the ciphertext, and informs the operator of a notice to the effect. Also, &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate the more-significant and the less-significant n bits of a, respectively). </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> Also, the present invention, in its one aspect, provides a public-key encryption method whose security against the attack is provable and which permits a plaintext space to be extended in size with a higher-efficiency as compared with the conventional public-key encryption methods (whose securities are provable). The method according to the present invention makes it possible to process even a long plaintext at the one-time encryption, thereby allowing the efficient processing to be implemented. </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> Also, the above-described plaintext becoming the target to be encrypted means all the digitized data including not only character strings but also images, sounds, and the like. </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> In the respective expressions in the present specification and the drawings, a symbol of a point &ldquo;&bull;&rdquo; or &ldquo;&plus;&rdquo; surrounded by a circle designates an exclusive OR. </paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> A 2nd feature of the present invention is as follows: In the encryption method described in the literature 4, the composite number N, i.e., the public key, has been selected as N&equals;pq. In contrast to this, in the present invention, the composite number N is defined as N&equals;p<highlight><superscript>d</superscript></highlight>q (d&gt;1). This condition permits the high-speed decryption processing to be implemented. </paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> Also, the encryption method described in the literature 14: &ldquo;M. Bellare and P. Rogaway : Optimal Asymmetric Encryption How to Encrypt with RSA, Proc. of Eurocrypto&apos; 94, LNCS950, Springer-Verlag, pp. 92-111, (1994)&rdquo; and the literature 15: &ldquo;V. Shoup : OAEP Reconsidered. Available on the e-print library (2000/060), November 2000&rdquo; is a method that has been proposed on the premise that the method is utilized for the trapdoor-equipped one-way trapdoor permutation. </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> However, in the case where, just like the present invention, x<highlight><superscript>2 </superscript></highlight>mod N (N is the composite number) is used as the encryption function, no one-way trapdoor permutation is implemented. </paragraph>
<paragraph id="P-0048" lvl="0"><number>&lsqb;0048&rsqb;</number> In the present invention, the combination with the encryption method in the literature 14 is employed while utilizing the hash functions for the encryption&apos;s uniqueness, thereby strengthening the security against the chosen-ciphertext attack. </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> Also, the present invention provides the encryption method and the decryption method imposing only a small load on the calculation in encrypting transmission data and the calculation in decrypting encrypted data, allowing the high-speed processing to be implemented even in the limited calculation-capability information processing apparatus such as a portable-type information processing appliance, and using the public key, the key distribution method and the key sharing method using the public key, and further the program, the apparatus, or the system for executing these methods. </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> According to one aspect of the present invention, the present invention is carried out as follows, for example: </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> As the steps of the key generation, </paragraph>
<paragraph id="P-0052" lvl="2"><number>&lsqb;0052&rsqb;</number> (a) a secret key (p, q) given by an expression (146): </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(146) </in-line-formula></paragraph>
<paragraph id="P-0053" lvl="2"><number>&lsqb;0053&rsqb;</number> &emsp;is created, and further, </paragraph>
<paragraph id="P-0054" lvl="2"><number>&lsqb;0054&rsqb;</number> (b) a public key (N, k, G, H) given by an expression (147): </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight><highlight><superscript>(</superscript></highlight><highlight><italic>d </italic></highlight>is odd number) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(147) </in-line-formula></paragraph>
<paragraph id="P-0055" lvl="2"><number>&lsqb;0055&rsqb;</number> &emsp;is created, and </paragraph>
<paragraph id="P-0056" lvl="3"><number>&lsqb;0056&rsqb;</number> (I) the sender-side apparatus selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), and </paragraph>
<paragraph id="P-0057" lvl="2"><number>&lsqb;0057&rsqb;</number> (c) calculates an expression (148): </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;x</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(148) </in-line-formula></paragraph>
<paragraph id="P-0058" lvl="2"><number>&lsqb;0058&rsqb;</number> &emsp;(where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&equals;k), and further, </paragraph>
<paragraph id="P-0059" lvl="2"><number>&lsqb;0059&rsqb;</number> (d) calculates an expression (149): </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>w&equals;s&par;t,</italic></highlight>&emsp;&emsp;(149) </in-line-formula></paragraph>
<paragraph id="P-0060" lvl="2"><number>&lsqb;0060&rsqb;</number> &emsp;and </paragraph>
<paragraph id="P-0061" lvl="2"><number>&lsqb;0061&rsqb;</number> (e) calculates an expression (150): </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y&equals;w</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN</italic></highlight>&emsp;&emsp;(150) </in-line-formula></paragraph>
<paragraph id="P-0062" lvl="2"><number>&lsqb;0062&rsqb;</number> &emsp;and defines this result y as the ciphertext so as to transmit the ciphertext to the receiver-side apparatus, and </paragraph>
<paragraph id="P-0063" lvl="3"><number>&lsqb;0063&rsqb;</number> (II) the receiver-side apparatus, using the secret key (p, q) of itself, (f) calculates, from the ciphertext y, an expression (151):  
<math-cwu id="MATH-US-00005">
<number>5</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <msub>
              <mi>&alpha;</mi>
              <mn>0</mn>
            </msub>
            <mo>=</mo>
            <mrow>
              <msup>
                <mi>y</mi>
                <mfrac>
                  <mrow>
                    <mi>p</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                  <mn>4</mn>
                </mfrac>
              </msup>
              <mo>&it;</mo>
              <mi>mod</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>p</mi>
            </mrow>
          </mrow>
          <mo>,</mo>
          <mstyle>
            <mtext>&NewLine;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mrow>
            <msub>
              <mi>&beta;</mi>
              <mn>0</mn>
            </msub>
            <mo>=</mo>
            <msub>
              <mi>&alpha;</mi>
              <mn>0</mn>
            </msub>
          </mrow>
          <mo>,</mo>
          <mstyle>
            <mtext>&NewLine;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mrow>
            <msub>
              <mi>&alpha;</mi>
              <mi>k</mi>
            </msub>
            <mo>=</mo>
            <mrow>
              <mfrac>
                <mn>1</mn>
                <mrow>
                  <mn>2</mn>
                  <mo>&it;</mo>
                  <msub>
                    <mi>&beta;</mi>
                    <mrow>
                      <mi>k</mi>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msub>
                </mrow>
              </mfrac>
              <mo>&it;</mo>
              <mrow>
                <mo>(</mo>
                <mfrac>
                  <mrow>
                    <mrow>
                      <mi>y</mi>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>&it;</mo>
                      <mi>mod</mi>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>&it;</mo>
                      <msup>
                        <mi>p</mi>
                        <mrow>
                          <mi>k</mi>
                          <mo>+</mo>
                          <mn>1</mn>
                        </mrow>
                      </msup>
                    </mrow>
                    <mo>-</mo>
                    <msubsup>
                      <mi>&beta;</mi>
                      <mrow>
                        <mi>k</mi>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mn>2</mn>
                    </msubsup>
                  </mrow>
                  <msup>
                    <mi>p</mi>
                    <mi>k</mi>
                  </msup>
                </mfrac>
                <mo>)</mo>
              </mrow>
              <mo>&it;</mo>
              <mi>mod</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>p</mi>
            </mrow>
          </mrow>
          <mo>,</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>k</mi>
              <mo>&GreaterEqual;</mo>
              <mn>1</mn>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>&it;</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mtable>
          <mtr>
            <mtd>
              <mrow>
                <msub>
                  <mi>&beta;</mi>
                  <mi>k</mi>
                </msub>
                <mo>=</mo>
                <mrow>
                  <munderover>
                    <mo>&Sum;</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>=</mo>
                      <mn>0</mn>
                    </mrow>
                    <mi>k</mi>
                  </munderover>
                  <mo>&it;</mo>
                  <mrow>
                    <msub>
                      <mi>&alpha;</mi>
                      <mi>i</mi>
                    </msub>
                    <mo>&it;</mo>
                    <msup>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msup>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>k</mi>
                    <mo>&GreaterEqual;</mo>
                    <mn>1</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>,</mo>
              </mrow>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>151</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00005" file="US20030002662A1-20030102-M00005.NB"/>
<image id="EMI-M00005" wi="216.027" he="77.0553" file="US20030002662A1-20030102-M00005.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0064" lvl="2"><number>&lsqb;0064&rsqb;</number> &emsp;and, using this result, </paragraph>
<paragraph id="P-0065" lvl="2"><number>&lsqb;0065&rsqb;</number> (g) calculates an expression (152):  
<math-cwu id="MATH-US-00006">
<number>6</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mi>p</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <munderover>
            <mo>&Sum;</mo>
            <mrow>
              <mi>i</mi>
              <mo>=</mo>
              <mn>0</mn>
            </mrow>
            <mrow>
              <mi>d</mi>
              <mo>-</mo>
              <mn>1</mn>
            </mrow>
          </munderover>
          <mo>&it;</mo>
          <mrow>
            <msub>
              <mi>&alpha;</mi>
              <mi>i</mi>
            </msub>
            <mo>&it;</mo>
            <msup>
              <mi>p</mi>
              <mi>i</mi>
            </msup>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>152</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00006" file="US20030002662A1-20030102-M00006.NB"/>
<image id="EMI-M00006" wi="216.027" he="25.9119" file="US20030002662A1-20030102-M00006.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0066" lvl="2"><number>&lsqb;0066&rsqb;</number> &emsp;and further, </paragraph>
<paragraph id="P-0067" lvl="2"><number>&lsqb;0067&rsqb;</number> (h) calculates an expression (153):  
<math-cwu id="MATH-US-00007">
<number>7</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mi>q</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <msup>
            <mi>y</mi>
            <mfrac>
              <mrow>
                <mi>q</mi>
                <mo>+</mo>
                <mn>1</mn>
              </mrow>
              <mn>4</mn>
            </mfrac>
          </msup>
          <mo>&it;</mo>
          <mi>mod</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mi>q</mi>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>153</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00007" file="US20030002662A1-20030102-M00007.NB"/>
<image id="EMI-M00007" wi="216.027" he="15.11055" file="US20030002662A1-20030102-M00007.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0068" lvl="2"><number>&lsqb;0068&rsqb;</number> &emsp;and, concerning each of expressions, &phgr;(x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>), and &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>) (where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by the Chinese remainder theorem), </paragraph>
<paragraph id="P-0069" lvl="2"><number>&lsqb;0069&rsqb;</number> (i) sets each of the expressions to be as given by an expression (154): </paragraph>
<paragraph lvl="0"><in-line-formula>s&prime;&par;t&prime;(<highlight><italic>s&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>,t&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>)&emsp;&emsp;(154) </in-line-formula></paragraph>
<paragraph id="P-0070" lvl="2"><number>&lsqb;0070&rsqb;</number> &emsp;and </paragraph>
<paragraph id="P-0071" lvl="2"><number>&lsqb;0071&rsqb;</number> (j) calculates an expression (155): </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;, </italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>x&prime;&par;z&prime;&equals;s&prime;&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>&prime;) (<highlight><italic>x&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n</superscript></highlight><highlight><italic>,z&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>)&emsp;&emsp;(155) </in-line-formula></paragraph>
<paragraph id="P-0072" lvl="2"><number>&lsqb;0072&rsqb;</number> &emsp;and </paragraph>
<paragraph id="P-0073" lvl="2"><number>&lsqb;0073&rsqb;</number> (k) obtains the decryption result given by an expression (156):  
<math-cwu id="MATH-US-00008">
<number>8</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>x</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>if</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <msup>
                    <mi>z</mi>
                    <mi>&prime;</mi>
                  </msup>
                </mrow>
                <mo>=</mo>
                <msup>
                  <mn>0</mn>
                  <msub>
                    <mi>k</mi>
                    <mn>1</mn>
                  </msub>
                </msup>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>156</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00008" file="US20030002662A1-20030102-M00008.NB"/>
<image id="EMI-M00008" wi="216.027" he="23.04855" file="US20030002662A1-20030102-M00008.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0074" lvl="7"><number>&lsqb;0074&rsqb;</number> (Here, it is stipulated that, in the case where the decryption result is *, the receiver-side apparatus denies the above-described ciphertext). </paragraph>
<paragraph id="P-0075" lvl="0"><number>&lsqb;0075&rsqb;</number> The decryption result is * for a ciphertext means that the correct decryption of the ciphertext has been unsuccessful. In this case, there exists a possibility that the ciphertext is a one intended for the attack. Accordingly, the receiver-side apparatus denies the decryption of the ciphertext in order to make the chosen-ciphertext attack impossible, thus never outputting the plaintext, i.e., the decryption result. At this time, the receiver-side apparatus may be formed into the configuration of outputting none of the decryption results, or may be formed into the configuration where the indication or a sound informs if the receiver of the result that the decryption has been unsuccessful. </paragraph>
<paragraph id="P-0076" lvl="0"><number>&lsqb;0076&rsqb;</number> Also, the above-described plaintext becoming the target to be encrypted means all the digitized data including not only character strings but also images, sounds, and the like. </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> In the respective expressions in the present specification and the drawings, the symbol of a point &ldquo;&bull;&rdquo; or &ldquo;&plus;&rdquo; surrounded by a circle designates an exclusive OR.</paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0078" lvl="0"><number>&lsqb;0078&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a diagram for illustrating the system configuration for executing a public-key encryption method and a cipher communication method according to the present invention; </paragraph>
<paragraph id="P-0079" lvl="0"><number>&lsqb;0079&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a diagram for illustrating the inner configuration of a sender-side apparatus; </paragraph>
<paragraph id="P-0080" lvl="0"><number>&lsqb;0080&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a diagram for illustrating the inner configuration of a receiver-side apparatus; </paragraph>
<paragraph id="P-0081" lvl="0"><number>&lsqb;0081&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a diagram for illustrating the processing steps in a 1st embodiment; </paragraph>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is a diagram for illustrating the processing steps in a 2nd embodiment; </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a diagram for illustrating the processing steps in a 3rd embodiment; </paragraph>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a diagram for illustrating the processing steps in a 4th embodiment; </paragraph>
<paragraph id="P-0085" lvl="0"><number>&lsqb;0085&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a diagram for illustrating the comparison in the plaintext-space size and the security between the processing steps in the 2nd embodiment and the conventional methods (i.e., the elliptic curve cypher, RSA, and OAEP&plus;RSA); </paragraph>
<paragraph id="P-0086" lvl="0"><number>&lsqb;0086&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a diagram for illustrating the processing steps in a 9th embodiment; </paragraph>
<paragraph id="P-0087" lvl="0"><number>&lsqb;0087&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a diagram for illustrating the processing steps in a 10th embodiment; </paragraph>
<paragraph id="P-0088" lvl="0"><number>&lsqb;0088&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is a diagram for illustrating the processing steps in an 11th embodiment; </paragraph>
<paragraph id="P-0089" lvl="0"><number>&lsqb;0089&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a diagram for illustrating the processing steps in a 12th embodiment; </paragraph>
<paragraph id="P-0090" lvl="0"><number>&lsqb;0090&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is a diagram for illustrating the processing steps in a 17th embodiment; </paragraph>
<paragraph id="P-0091" lvl="0"><number>&lsqb;0091&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 14</cross-reference> is a diagram for illustrating the processing steps in an 18th embodiment; </paragraph>
<paragraph id="P-0092" lvl="0"><number>&lsqb;0092&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 15</cross-reference> is a diagram for illustrating the processing steps in a 19th embodiment; </paragraph>
<paragraph id="P-0093" lvl="0"><number>&lsqb;0093&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 16</cross-reference> is a diagram for illustrating the processing steps in a 21st embodiment; and </paragraph>
<paragraph id="P-0094" lvl="0"><number>&lsqb;0094&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 17</cross-reference> is a diagram for illustrating the processing steps in a 22nd embodiment.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF THE EMBODIMENTS </heading>
<paragraph id="P-0095" lvl="0"><number>&lsqb;0095&rsqb;</number> Hereinafter, referring to the drawings, the explanation will be given below concerning the embodiments. <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a diagram for illustrating the system configuration in each embodiment. This system includes a sender-side apparatus <highlight><bold>100</bold></highlight> and a receiver-side apparatus <highlight><bold>200</bold></highlight>. Moreover, the sender-side apparatus <highlight><bold>100</bold></highlight> and the receiver-side apparatus <highlight><bold>200</bold></highlight> are connected to each other via a communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0096" lvl="0"><number>&lsqb;0096&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a diagram for illustrating the inner configuration of the sender-side apparatus <highlight><bold>100</bold></highlight> in each embodiment. The sender-side apparatus <highlight><bold>100</bold></highlight> includes a random-number generation unit <highlight><bold>101</bold></highlight>, a power multiplication unit <highlight><bold>102</bold></highlight>, an arithmetic-operation unit <highlight><bold>103</bold></highlight>, a remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, a memory <highlight><bold>105</bold></highlight>, a communications apparatus <highlight><bold>106</bold></highlight>, an input apparatus <highlight><bold>107</bold></highlight>, and an encryption unit <highlight><bold>108</bold></highlight>. </paragraph>
<paragraph id="P-0097" lvl="0"><number>&lsqb;0097&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a diagram for illustrating the inner configuration of the receiver-side apparatus <highlight><bold>200</bold></highlight> in each embodiment. The receiver-side apparatus <highlight><bold>200</bold></highlight> includes a key generation unit <highlight><bold>201</bold></highlight>, a power multiplication unit <highlight><bold>202</bold></highlight>, a remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, an arithmetic-operation unit <highlight><bold>204</bold></highlight>, a memory <highlight><bold>205</bold></highlight>, a communications apparatus <highlight><bold>206</bold></highlight>, and a decryption unit <highlight><bold>207</bold></highlight>. </paragraph>
<paragraph id="P-0098" lvl="0"><number>&lsqb;0098&rsqb;</number> The above-described sender-side apparatus or receiver-side apparatus can be embodied using a common computer including a CPU and a memory. Furthermore, the CPU executes, on the memory, programs stored in a fixed storage apparatus included in the above-described computer, thereby making it possible to embody the random-number generation unit <highlight><bold>101</bold></highlight>, the power multiplication units <highlight><bold>102</bold></highlight>, <highlight><bold>202</bold></highlight>, the arithmetic-operation units <highlight><bold>103</bold></highlight>, <highlight><bold>204</bold></highlight>, the remainder arithmetic-operation units <highlight><bold>104</bold></highlight>, <highlight><bold>203</bold></highlight>, the encryption unit <highlight><bold>108</bold></highlight>, the key generation unit <highlight><bold>201</bold></highlight>, and the decryption unit <highlight><bold>207</bold></highlight>. The respective programs may be stored into the fixed storage apparatus in advance, or may be installed into the fixed storage apparatus or the memory when required from an external storage apparatus such as a FD or a CD-ROM or from a network such as the Internet via an external interface. </paragraph>
<paragraph id="P-0099" lvl="7"><number>&lsqb;0099&rsqb;</number> (1st Embodiment) </paragraph>
<paragraph id="P-0100" lvl="0"><number>&lsqb;0100&rsqb;</number> In the present embodiment, the explanation will be given below concerning the case where, via a cipher communication, the sender of a plaintext (which is also referred to as &ldquo;message&rdquo;) transmits, to the receiver, the message becoming the transmission data. </paragraph>
<paragraph id="P-0101" lvl="0"><number>&lsqb;0101&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> illustrates the system configuration in the present embodiment. Also, <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a diagram for illustrating the outline of the processing steps in the 1st embodiment. </paragraph>
<paragraph id="P-0102" lvl="7"><number>&lsqb;0102&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0103" lvl="0"><number>&lsqb;0103&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0104" lvl="7"><number>&lsqb;0104&rsqb;</number> a public key given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>f:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>one-way trapdoor permutation, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(1) </in-line-formula></paragraph>
<paragraph id="P-0105" lvl="7"><number>&lsqb;0105&rsqb;</number> are defined as a public key, and </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>:&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>Trapdoor function&emsp;&emsp;(2) </in-line-formula></paragraph>
<paragraph id="P-0106" lvl="7"><number>&lsqb;0106&rsqb;</number> (where, k&equals;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&plus;n). Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, a well-known method, e.g., the registration into a third party (i.e., a publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. </paragraph>
<paragraph id="P-0107" lvl="7"><number>&lsqb;0107&rsqb;</number> 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0108" lvl="0"><number>&lsqb;0108&rsqb;</number> (1) Following the operation by the sender and using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus <highlight><bold>100</bold></highlight> selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x&isin;&lcub;0, 1&rcub;<highlight><superscript>n </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the sender-side apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;x</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(3) </in-line-formula></paragraph>
<paragraph id="P-0109" lvl="7"><number>&lsqb;0109&rsqb;</number> and further, calculates </paragraph>
<paragraph lvl="0"><in-line-formula>y<highlight><subscript>1</subscript></highlight><highlight><italic>&equals;f</italic></highlight>(<highlight><italic>s</italic></highlight>), <highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(4) </in-line-formula></paragraph>
<paragraph id="P-0110" lvl="7"><number>&lsqb;0110&rsqb;</number> Moreover, the sender-side apparatus defines (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) as the ciphertext and, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits the ciphertext to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0111" lvl="0"><number>&lsqb;0111&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>), </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&prime;&equals;f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>(<highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight>), <highlight><italic>t&prime;&equals;y</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(5) </in-line-formula></paragraph>
<paragraph id="P-0112" lvl="7"><number>&lsqb;0112&rsqb;</number> and further, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(6) </in-line-formula></paragraph>
<paragraph id="P-0113" lvl="7"><number>&lsqb;0113&rsqb;</number> and, based on  
<math-cwu id="MATH-US-00009">
<number>9</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>x</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>[</mo>
                    <mrow>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&CirclePlus;</mo>
                      <mrow>
                        <mi>G</mi>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>]</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <mrow>
                    <msub>
                      <mrow>
                        <mi>if</mi>
                        <mo>&it;</mo>
                        <mstyle>
                          <mtext>&emsp;</mtext>
                        </mstyle>
                        <mo>[</mo>
                        <mrow>
                          <msup>
                            <mi>s</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>&CirclePlus;</mo>
                          <mrow>
                            <mi>G</mi>
                            <mo>&af;</mo>
                            <mrow>
                              <mo>(</mo>
                              <msup>
                                <mi>r</mi>
                                <mi>&prime;</mi>
                              </msup>
                              <mo>)</mo>
                            </mrow>
                          </mrow>
                        </mrow>
                        <mo>]</mo>
                      </mrow>
                      <msub>
                        <mi>k</mi>
                        <mn>1</mn>
                      </msub>
                    </msub>
                    <mo>=</mo>
                    <msup>
                      <mn>0</mn>
                      <msub>
                        <mi>k</mi>
                        <mn>1</mn>
                      </msub>
                    </msup>
                  </mrow>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>7</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00009" file="US20030002662A1-20030102-M00009.NB"/>
<image id="EMI-M00009" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00009.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0114" lvl="7"><number>&lsqb;0114&rsqb;</number> decryption-processes the ciphertext, thereby obtaining the plaintext (i.e., the message) (Here, it is stipulated that, in the case where x&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect. Also, &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate the more-significant and the less-significant n bits of a, respectively). </paragraph>
<paragraph id="P-0115" lvl="0"><number>&lsqb;0115&rsqb;</number> The public-key encryption method according to the present embodiment can be proved to be semantically-secure against the chosen-ciphertext attack on the premise of the difficulty in determining the inverse function of the one-way trapdoor permutation f. The outline of the proof is as follows: If an enemy that is going to break the public-key encryption method according to the present embodiment (in the meaning of the semantical-security in the adaptive chosen-ciphertext attack, and the definition thereof has been described in, e.g., the literature 15) has an intentional purpose of obtaining information from a decryption oracle, the enemy is required to know the original plaintext in the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) which is the question. Namely, it is impossible for the enemy to obtain the new information from the decryption oracle. Also, the use of a method similar to the one described in the literature 14 easily indicates that the method in the present embodiment is IND-CPA. This makes it possible to prove that the public-key encryption method in the present embodiment is IND-CCA2. </paragraph>
<paragraph id="P-0116" lvl="0"><number>&lsqb;0116&rsqb;</number> The method according to the present embodiment has succeeded in solving the problem in the literature 14 (i.e., the proof of the security is insufficient on the premise of the difficulty in calculating the inverse function of f) which has been pointed out in the literature 15. </paragraph>
<paragraph id="P-0117" lvl="0"><number>&lsqb;0117&rsqb;</number> Also, the method in the present embodiment permits the plaintext space to be extended in size with the security being maintained. </paragraph>
<paragraph id="P-0118" lvl="7"><number>&lsqb;0118&rsqb;</number> (2nd Embodiment) </paragraph>
<paragraph id="P-0119" lvl="0"><number>&lsqb;0119&rsqb;</number> In the present embodiment, the more concrete explanation will be given below concerning the method according to the 1st embodiment. <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is a diagram for illustrating the outline of the steps in the 2nd embodiment. </paragraph>
<paragraph id="P-0120" lvl="7"><number>&lsqb;0120&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0121" lvl="0"><number>&lsqb;0121&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0122" lvl="7"><number>&lsqb;0122&rsqb;</number> a secret key (p, q) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), q&equiv;3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(8) </in-line-formula></paragraph>
<paragraph id="P-0123" lvl="7"><number>&lsqb;0123&rsqb;</number> and a public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>&bull;N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><subscript>1 </subscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(9) </in-line-formula></paragraph>
<paragraph id="P-0124" lvl="7"><number>&lsqb;0124&rsqb;</number> Here, it is stipulated that the manager or the receiver of the present system has determined the value of d in advance or as required, and that the above-described key generation unit fetches the value. </paragraph>
<paragraph id="P-0125" lvl="0"><number>&lsqb;0125&rsqb;</number> Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. </paragraph>
<paragraph id="P-0126" lvl="7"><number>&lsqb;0126&rsqb;</number> 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0127" lvl="0"><number>&lsqb;0127&rsqb;</number> (1) Following the operation by the sender and using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus <highlight><bold>100</bold></highlight> selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x&isin;&lcub;0, 1&rcub;<highlight><superscript>n </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;x</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(10) </in-line-formula></paragraph>
<paragraph id="P-0128" lvl="7"><number>&lsqb;0128&rsqb;</number> (where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&amp;1t; k&minus;2), and further, calculates  
<math-cwu id="MATH-US-00010">
<number>10</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>1</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>s</mi>
              <mrow>
                <mn>2</mn>
                <mo>&it;</mo>
                <mi>N</mi>
              </mrow>
            </msup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>N</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>2</mn>
          </msub>
          <mo>=</mo>
          <mi>t</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>3</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mo>(</mo>
              <mfrac>
                <mi>s</mi>
                <mi>N</mi>
              </mfrac>
              <mo>)</mo>
            </mrow>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>11</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00010" file="US20030002662A1-20030102-M00010.NB"/>
<image id="EMI-M00010" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00010.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0129" lvl="7"><number>&lsqb;0129&rsqb;</number> (where, a&equals;(m/N) designates a Jacobi symbol). </paragraph>
<paragraph id="P-0130" lvl="0"><number>&lsqb;0130&rsqb;</number> The definition and the calculating method of the Jacobi symbol have been described in, e.g., a literature 16: &ldquo;A. J. Menezes, P. C. van Oorschot, S. A. Vanstone: Jacobi Symbol: Definition &amp;amp; Algorithm, Handbook of Applied Cryptography, CRC Press, pp. 73, (1996)&rdquo;, or a literature 17: &ldquo;H. Cohen: Jacobi Symbol: Definition &amp;amp; Algorithm, A Course in Computational Algebraic Number Theory, Graduate Texts in Math. 138, Springer-Verlag, New York, pp. 27-31, (1993)&rdquo;. Moreover, the sender-side apparatus defines (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>, y<highlight><subscript>3</subscript></highlight>) as the ciphertext and, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits the ciphertext to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0131" lvl="0"><number>&lsqb;0131&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information (p, q) and the power multiplication unit <highlight><bold>202</bold></highlight>, the remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>, y<highlight><subscript>3</subscript></highlight>),  
<math-cwu id="MATH-US-00011">
<number>11</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>12</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00011" file="US20030002662A1-20030102-M00011.NB"/>
<image id="EMI-M00011" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00011.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0132" lvl="7"><number>&lsqb;0132&rsqb;</number> and, of expressions, </paragraph>
<paragraph id="P-0133" lvl="7"><number>&lsqb;0133&rsqb;</number> &phgr;(X<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), the apparatus sets an expression satisfying (x/N)&equals;y<highlight><subscript>3 </subscript></highlight>and 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; (where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by the Chinese remainder theorem). </paragraph>
<paragraph id="P-0134" lvl="7"><number>&lsqb;0134&rsqb;</number> Moreover, the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(13) </in-line-formula></paragraph>
<paragraph id="P-0135" lvl="7"><number>&lsqb;0135&rsqb;</number> and, based on  
<math-cwu id="MATH-US-00012">
<number>12</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>x</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>[</mo>
                    <mrow>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&CirclePlus;</mo>
                      <mrow>
                        <mi>G</mi>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>]</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <mrow>
                    <mi>i</mi>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <msub>
                      <mrow>
                        <mi>f</mi>
                        <mo>&it;</mo>
                        <mstyle>
                          <mtext>&emsp;</mtext>
                        </mstyle>
                        <mo>[</mo>
                        <mrow>
                          <msup>
                            <mi>s</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>&CirclePlus;</mo>
                          <mrow>
                            <mi>G</mi>
                            <mo>&af;</mo>
                            <mrow>
                              <mo>(</mo>
                              <msup>
                                <mi>r</mi>
                                <mi>&prime;</mi>
                              </msup>
                              <mo>)</mo>
                            </mrow>
                          </mrow>
                        </mrow>
                        <mo>]</mo>
                      </mrow>
                      <msub>
                        <mi>k</mi>
                        <mn>1</mn>
                      </msub>
                    </msub>
                  </mrow>
                  <mo>=</mo>
                  <msup>
                    <mn>0</mn>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mrow>
                  <mi>o</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>t</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>h</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>e</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>r</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>w</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>i</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>s</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>e</mi>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>14</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00012" file="US20030002662A1-20030102-M00012.NB"/>
<image id="EMI-M00012" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00012.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0136" lvl="7"><number>&lsqb;0136&rsqb;</number> decrypts the ciphertext, thereby obtaining the plaintext (Here, it is stipulated that, in the case where x&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect. Also, &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate the more-significant and the less-significant n bits of a, respectively). </paragraph>
<paragraph id="P-0137" lvl="0"><number>&lsqb;0137&rsqb;</number> Also, the secret key (p, q) can also be created from prime numbers p&prime;, q&prime;, using p&equals;2p&prime;&plus;1, q&equals;2q&prime;&plus;1. </paragraph>
<paragraph id="P-0138" lvl="0"><number>&lsqb;0138&rsqb;</number> In the public-key encryption method in the present embodiment, the value of d (d&gE;1) can be modified. For example, in the case where the bit length of the plaintext always remains short, the value of d is increased in a range where the unique factorization of n into its prime factors is difficult. This increase allows the decryption processing to be executed at a high-speed. </paragraph>
<paragraph id="P-0139" lvl="0"><number>&lsqb;0139&rsqb;</number> It can be demonstrated that, in the case of, e.g., d&equals;3, the complete cryptanalysis of the method according to the present embodiment is impossible on the premise of the difficulty in the unique factorization problem of n. Namely, if there exists an algorithm for solving the unique factorization problem of n, the utilization of the algorithm makes it possible to configure an algorithm for executing the complete cryptanalysis of the method according to the present embodiment. Also, if there exists the algorithm for executing the complete cryptanalysis of the method according to the present embodiment, the utilization of the algorithm makes it possible to configure the algorithm for solving the unique factorization problem of n. </paragraph>
<paragraph id="P-0140" lvl="0"><number>&lsqb;0140&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a diagram for illustrating the comparison in the plaintext-space size and the security between the method according to the 2nd embodiment and the conventional technologies (i.e., the elliptic curve cypher, RSA, and OAEP&plus;RSA) (where, k<highlight><subscript>1</subscript></highlight>&equals;k<highlight><subscript>0</subscript></highlight>&equals;128). Making comparison between the method in the present embodiment and the conventional technologies indicates that the method permits the plaintext space to be further extended in size with the security being maintained. </paragraph>
<paragraph id="P-0141" lvl="7"><number>&lsqb;0141&rsqb;</number> (3rd Embodiment) </paragraph>
<paragraph id="P-0142" lvl="0"><number>&lsqb;0142&rsqb;</number> In the present embodiment, the explanation will be given below regarding a modified example of the 2nd embodiment. <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a diagram for illustrating the outline of the steps in the 3rd embodiment. </paragraph>
<paragraph id="P-0143" lvl="7"><number>&lsqb;0143&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0144" lvl="0"><number>&lsqb;0144&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0145" lvl="7"><number>&lsqb;0145&rsqb;</number> a secret key (p, q) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(15) </in-line-formula></paragraph>
<paragraph id="P-0146" lvl="7"><number>&lsqb;0146&rsqb;</number> and a public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d</italic></highlight>&gE;1) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(16) </in-line-formula></paragraph>
<paragraph id="P-0147" lvl="7"><number>&lsqb;0147&rsqb;</number> Here, it is stipulated that the manager or the receiver of the present system has determined the value of d in advance, and that the above-described key generation unit can use the value. Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. </paragraph>
<paragraph id="P-0148" lvl="7"><number>&lsqb;0148&rsqb;</number> 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0149" lvl="0"><number>&lsqb;0149&rsqb;</number> (1) Following the operation by the sender and using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus <highlight><bold>100</bold></highlight> selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x&isin;&lcub;, 1&rcub;<highlight><superscript>n </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;x</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(17) </in-line-formula></paragraph>
<paragraph id="P-0150" lvl="7"><number>&lsqb;0150&rsqb;</number> (where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&amp;1t; k&minus;2), and further, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(18) </in-line-formula></paragraph>
<paragraph id="P-0151" lvl="7"><number>&lsqb;0151&rsqb;</number> Moreover, the sender-side apparatus defines (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) as the ciphertext and, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits the ciphertext to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0152" lvl="0"><number>&lsqb;0152&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information (p, q) and the power multiplication unit <highlight><bold>202</bold></highlight>, the remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>),  
<math-cwu id="MATH-US-00013">
<number>13</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>19</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00013" file="US20030002662A1-20030102-M00013.NB"/>
<image id="EMI-M00013" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00013.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0153" lvl="7"><number>&lsqb;0153&rsqb;</number> and, of expressions, </paragraph>
<paragraph id="P-0154" lvl="7"><number>&lsqb;0154&rsqb;</number> &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), the apparatus sets an expression satisfying 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; (Here, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by the Chinese remainder theorem, and more than one s&prime; may exist). Moreover, the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(20) </in-line-formula></paragraph>
<paragraph id="P-0155" lvl="7"><number>&lsqb;0155&rsqb;</number> and, based on  
<math-cwu id="MATH-US-00014">
<number>14</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>x</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>[</mo>
                    <mrow>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&CirclePlus;</mo>
                      <mrow>
                        <mi>G</mi>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>]</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <mrow>
                    <mi>i</mi>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <msub>
                      <mrow>
                        <mi>f</mi>
                        <mo>&it;</mo>
                        <mstyle>
                          <mtext>&emsp;</mtext>
                        </mstyle>
                        <mo>[</mo>
                        <mrow>
                          <msup>
                            <mi>s</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>&CirclePlus;</mo>
                          <mrow>
                            <mi>G</mi>
                            <mo>&af;</mo>
                            <mrow>
                              <mo>(</mo>
                              <msup>
                                <mi>r</mi>
                                <mi>&prime;</mi>
                              </msup>
                              <mo>)</mo>
                            </mrow>
                          </mrow>
                        </mrow>
                        <mo>]</mo>
                      </mrow>
                      <msub>
                        <mi>k</mi>
                        <mn>1</mn>
                      </msub>
                    </msub>
                  </mrow>
                  <mo>=</mo>
                  <msup>
                    <mn>0</mn>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mrow>
                  <mi>o</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>t</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>h</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>e</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>r</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>w</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>i</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>s</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>e</mi>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>21</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00014" file="US20030002662A1-20030102-M00014.NB"/>
<image id="EMI-M00014" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00014.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0156" lvl="7"><number>&lsqb;0156&rsqb;</number> decrypts the ciphertext, thereby obtaining the plaintext (Here, it is stipulated that, in the case where x&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect. Also, &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate the more-significant and the less-significant n bits of a, respectively). </paragraph>
<paragraph id="P-0157" lvl="0"><number>&lsqb;0157&rsqb;</number> Also, the secret key (p, q) can also be created from prime numbers p&prime;, q&prime;, using p&equals;2p&prime;&plus;1, q&equals;2q&prime;&plus;1. </paragraph>
<paragraph id="P-0158" lvl="0"><number>&lsqb;0158&rsqb;</number> In the public-key encryption method in the present embodiment, the value of d (d&gE;1) can be modified. For example, in the case where the bit length of the plaintext always remains short, the value of d is increased in a range where the unique factorization of n into its prime factors is difficult. This increase allows the decryption processing to be executed at a high-speed. </paragraph>
<paragraph id="P-0159" lvl="0"><number>&lsqb;0159&rsqb;</number> It can be demonstrated that, in the case of, e.g., d&equals;3, the complete cryptanalysis of the method according to the present embodiment is impossible on the premise of the difficulty in the unique factorization problem of n. Namely, if there exists an algorithm for solving the unique factorization problem of n, the utilization of the algorithm makes it possible to configure an algorithm for executing the complete cryptanalysis of the method according to the present embodiment. Also, if there exists the algorithm for executing the complete cryptanalysis of the method according to the present embodiment, the utilization of the algorithm makes it possible to configure the algorithm for solving the unique factorization problem of n. </paragraph>
<paragraph id="P-0160" lvl="7"><number>&lsqb;0160&rsqb;</number> (4th Embodiment) </paragraph>
<paragraph id="P-0161" lvl="0"><number>&lsqb;0161&rsqb;</number> In the present embodiment, the explanation will be given below regarding another modified example of the 2nd embodiment. <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a diagram for illustrating the outline of the steps in the 4th embodiment. </paragraph>
<paragraph id="P-0162" lvl="7"><number>&lsqb;0162&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0163" lvl="0"><number>&lsqb;0163&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0164" lvl="7"><number>&lsqb;0164&rsqb;</number> a secret key p<highlight><subscript>i </subscript></highlight>(1&lE;i&lE;d) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>: prime numbers </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>&equiv;3(<highlight><italic>mod</italic></highlight>4) (1<highlight><italic>&lE;i&lE;d, d&gt;</italic></highlight>1)&emsp;&emsp;(22) </in-line-formula></paragraph>
<paragraph id="P-0165" lvl="7"><number>&lsqb;0165&rsqb;</number> and a public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;&Pi;</italic></highlight><highlight><subscript>i&equals;1</subscript></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>p</italic></highlight><highlight><subscript>i </subscript></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(23) </in-line-formula></paragraph>
<paragraph id="P-0166" lvl="7"><number>&lsqb;0166&rsqb;</number> Here, it is stipulated that the manager or the receiver of the present system has determined the value of d in advance, and that the above-described key generation unit can use the value. Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. </paragraph>
<paragraph id="P-0167" lvl="7"><number>&lsqb;0167&rsqb;</number> 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0168" lvl="0"><number>&lsqb;0168&rsqb;</number> (1) Following the operation by the sender and using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus <highlight><bold>100</bold></highlight> selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x&isin;&lcub;0, 1&rcub;<highlight><superscript>n </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;x</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(24) </in-line-formula></paragraph>
<paragraph id="P-0169" lvl="7"><number>&lsqb;0169&rsqb;</number> (where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&lE;log<highlight><subscript>2</subscript></highlight>(N&plus;1)), and further, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(25) </in-line-formula></paragraph>
<paragraph id="P-0170" lvl="7"><number>&lsqb;0170&rsqb;</number> Moreover, the sender-side apparatus defines (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) as the ciphertext and, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits the ciphertext to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0171" lvl="0"><number>&lsqb;0171&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information (p, q) and the power multiplication unit <highlight><bold>202</bold></highlight>, the remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>),  
<math-cwu id="MATH-US-00015">
<number>15</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>1</mn>
                  <mo>,</mo>
                  <msub>
                    <mi>p</mi>
                    <mi>i</mi>
                  </msub>
                </mrow>
              </msub>
              <mo>=</mo>
              <mrow>
                <msubsup>
                  <mi>y</mi>
                  <mn>1</mn>
                  <mfrac>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mn>4</mn>
                  </mfrac>
                </msubsup>
                <mo>&it;</mo>
                <mi>m</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>o</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>d</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <msub>
                  <mi>p</mi>
                  <mi>i</mi>
                </msub>
              </mrow>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mn>1</mn>
                <mo>&leq;</mo>
                <mi>i</mi>
                <mo>&leq;</mo>
                <mi>d</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>26</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00015" file="US20030002662A1-20030102-M00015.NB"/>
<image id="EMI-M00015" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00015.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0172" lvl="7"><number>&lsqb;0172&rsqb;</number> and, of 2<highlight><superscript>d </superscript></highlight>expressions, </paragraph>
<paragraph id="P-0173" lvl="7"><number>&lsqb;0173&rsqb;</number> &phgr;(&plusmn;x<highlight><subscript>1,p1</subscript></highlight>, &plusmn;x<highlight><subscript>1,p2</subscript></highlight>, . . . , &plusmn;x<highlight><subscript>1,pd</subscript></highlight>), the apparatus sets an expression satisfying 0&amp;1t; s&prime;&amp;1t; N/2 to be s&prime; (Here, &phgr; designates a ring isomorphism mapping from Z/(p<highlight><subscript>1</subscript></highlight>)&times;Z/(p<highlight><subscript>2</subscript></highlight>)&times; . . . &times;Z/(p<highlight><subscript>d</subscript></highlight>) to Z/(N) by the Chinese remainder theorem, and more than one s&prime; may exist). Moreover, the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(27) </in-line-formula></paragraph>
<paragraph id="P-0174" lvl="7"><number>&lsqb;0174&rsqb;</number> and, based on  
<math-cwu id="MATH-US-00016">
<number>16</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>x</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>[</mo>
                    <mrow>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&CirclePlus;</mo>
                      <mrow>
                        <mi>G</mi>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>]</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <mrow>
                    <mi>i</mi>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <msub>
                      <mrow>
                        <mi>f</mi>
                        <mo>&it;</mo>
                        <mstyle>
                          <mtext>&emsp;</mtext>
                        </mstyle>
                        <mo>[</mo>
                        <mrow>
                          <msup>
                            <mi>s</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>&CirclePlus;</mo>
                          <mrow>
                            <mi>G</mi>
                            <mo>&af;</mo>
                            <mrow>
                              <mo>(</mo>
                              <msup>
                                <mi>r</mi>
                                <mi>&prime;</mi>
                              </msup>
                              <mo>)</mo>
                            </mrow>
                          </mrow>
                        </mrow>
                        <mo>]</mo>
                      </mrow>
                      <msub>
                        <mi>k</mi>
                        <mn>1</mn>
                      </msub>
                    </msub>
                  </mrow>
                  <mo>=</mo>
                  <msup>
                    <mn>0</mn>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mrow>
                  <mi>o</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>t</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>h</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>e</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>r</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>w</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>i</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>s</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>e</mi>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>28</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00016" file="US20030002662A1-20030102-M00016.NB"/>
<image id="EMI-M00016" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00016.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0175" lvl="7"><number>&lsqb;0175&rsqb;</number> decrypts the ciphertext, thereby obtaining the plaintext (Here, it is stipulated that, in the case where x&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect. Also, &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate the more-significant and the less-significant n bits of a, respectively). </paragraph>
<paragraph id="P-0176" lvl="0"><number>&lsqb;0176&rsqb;</number> Also, the secret key p, q can also be created from prime numbers p&prime;, q&prime;, using p&equals;2p&prime;&plus;1, q&equals;2q&prime;&plus;1. </paragraph>
<paragraph id="P-0177" lvl="0"><number>&lsqb;0177&rsqb;</number> In the public-key encryption method in the present embodiment, the value of d (d &amp;gt; 1) can be modified. </paragraph>
<paragraph id="P-0178" lvl="0"><number>&lsqb;0178&rsqb;</number> It can be demonstrated that the complete cryptanalysis of the method according to the present embodiment is impossible on the premise of the difficulty in the unique factorization problem of n. Namely, if there exists an algorithm for solving the unique factorization problem of n, the utilization of the algorithm makes it possible to configure an algorithm for executing the complete cryptanalysis of the method according to the present embodiment. Also, if there exists the algorithm for executing the complete cryptanalysis of the method according to the present embodiment, the utilization of the algorithm makes it possible to configure the algorithm for solving the unique factorization problem of n. </paragraph>
<paragraph id="P-0179" lvl="7"><number>&lsqb;0179&rsqb;</number> (5th Embodiment) </paragraph>
<paragraph id="P-0180" lvl="0"><number>&lsqb;0180&rsqb;</number> In the present embodiment, the explanation will be given below concerning a cipher communication method where the public-key encryption method according to the 1st embodiment is used for the key distribution. </paragraph>
<paragraph id="P-0181" lvl="0"><number>&lsqb;0181&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> illustrates the system configuration in the present embodiment. </paragraph>
<paragraph id="P-0182" lvl="7"><number>&lsqb;0182&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0183" lvl="0"><number>&lsqb;0183&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0184" lvl="7"><number>&lsqb;0184&rsqb;</number> the public key given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>f:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>one-way trapdoor permutation, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(29) </in-line-formula></paragraph>
<paragraph id="P-0185" lvl="7"><number>&lsqb;0185&rsqb;</number> and the secret key given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>:&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>trapdoor function&emsp;&emsp;(30) </in-line-formula></paragraph>
<paragraph id="P-0186" lvl="7"><number>&lsqb;0186&rsqb;</number> (where, k&equals;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&plus;n). Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. </paragraph>
<paragraph id="P-0187" lvl="7"><number>&lsqb;0187&rsqb;</number> <highlight><bold>2</bold></highlight>. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0188" lvl="0"><number>&lsqb;0188&rsqb;</number> (1) Following the operation by the sender and using a data encryption key K&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, the encryption unit <highlight><bold>108</bold></highlight> in the sender-side apparatus <highlight><bold>100</bold></highlight> encrypts, by an existing encryption method, a message m becoming the transmission data, thereby creating a ciphertext C. In addition, using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus selects the random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;K</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(31) </in-line-formula></paragraph>
<paragraph id="P-0189" lvl="7"><number>&lsqb;0189&rsqb;</number> and further, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;f</italic></highlight>(<highlight><italic>s</italic></highlight>), <highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(32) </in-line-formula></paragraph>
<paragraph id="P-0190" lvl="7"><number>&lsqb;0190&rsqb;</number> Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) together with the ciphertext C to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0191" lvl="0"><number>&lsqb;0191&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information and the arithmetic-operation unit <highlight><bold>204</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>), </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&prime;&equals;f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>(<highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight>), <highlight><italic>t&prime;&equals;y</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(33) </in-line-formula></paragraph>
<paragraph id="P-0192" lvl="7"><number>&lsqb;0192&rsqb;</number> and further, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(34) </in-line-formula></paragraph>
<paragraph id="P-0193" lvl="7"><number>&lsqb;0193&rsqb;</number> and, based on  
<math-cwu id="MATH-US-00017">
<number>17</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>K</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>[</mo>
                    <mrow>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&CirclePlus;</mo>
                      <mrow>
                        <mi>G</mi>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>]</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <mrow>
                    <mi>i</mi>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <msub>
                      <mrow>
                        <mi>f</mi>
                        <mo>&it;</mo>
                        <mstyle>
                          <mtext>&emsp;</mtext>
                        </mstyle>
                        <mo>[</mo>
                        <mrow>
                          <msup>
                            <mi>s</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>&CirclePlus;</mo>
                          <mrow>
                            <mi>G</mi>
                            <mo>&af;</mo>
                            <mrow>
                              <mo>(</mo>
                              <msup>
                                <mi>r</mi>
                                <mi>&prime;</mi>
                              </msup>
                              <mo>)</mo>
                            </mrow>
                          </mrow>
                        </mrow>
                        <mo>]</mo>
                      </mrow>
                      <msub>
                        <mi>k</mi>
                        <mn>1</mn>
                      </msub>
                    </msub>
                  </mrow>
                  <mo>=</mo>
                  <msup>
                    <mn>0</mn>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mrow>
                  <mi>o</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>t</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>h</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>e</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>r</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>w</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>i</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>s</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>e</mi>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>35</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00017" file="US20030002662A1-20030102-M00017.NB"/>
<image id="EMI-M00017" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00017.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0194" lvl="7"><number>&lsqb;0194&rsqb;</number> calculates K&prime; (Here, it is stipulated that, in the case where K&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect. Also, &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate the more-significant and the less-significant n bits of a, respectively). </paragraph>
<paragraph id="P-0195" lvl="0"><number>&lsqb;0195&rsqb;</number> Furthermore, the decryption unit <highlight><bold>207</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, using K&prime;, performs the decryption of the ciphertext C, thereby obtaining the plaintext m. </paragraph>
<paragraph id="P-0196" lvl="7"><number>&lsqb;0196&rsqb;</number> (6th Embodiment) </paragraph>
<paragraph id="P-0197" lvl="0"><number>&lsqb;0197&rsqb;</number> In the present embodiment, the explanation will be given below concerning a cipher communication method where the public-key encryption method according to the 2nd embodiment is used for the key distribution. </paragraph>
<paragraph id="P-0198" lvl="7"><number>&lsqb;0198&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0199" lvl="0"><number>&lsqb;0199&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0200" lvl="7"><number>&lsqb;0200&rsqb;</number> the secret key (p, q) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(36) </in-line-formula></paragraph>
<paragraph id="P-0201" lvl="7"><number>&lsqb;0201&rsqb;</number> and the public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(37) </in-line-formula></paragraph>
<paragraph id="P-0202" lvl="7"><number>&lsqb;0202&rsqb;</number> Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. </paragraph>
<paragraph id="P-0203" lvl="7"><number>&lsqb;0203&rsqb;</number> 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0204" lvl="0"><number>&lsqb;0204&rsqb;</number> (1) Following the operation by the sender and using a data encryption key K&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, the encryption unit <highlight><bold>108</bold></highlight> in the sender-side apparatus <highlight><bold>100</bold></highlight> encrypts, by an existing encryption method, a message m becoming the transmission data, thereby creating a ciphertext C. In addition, using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus selects the random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;K</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(38) </in-line-formula></paragraph>
<paragraph id="P-0205" lvl="7"><number>&lsqb;0205&rsqb;</number> (where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&amp;1t; k&minus;2), and further, calculates  
<math-cwu id="MATH-US-00018">
<number>18</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>1</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>s</mi>
              <mrow>
                <mn>2</mn>
                <mo>&it;</mo>
                <mi>N</mi>
              </mrow>
            </msup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>N</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>2</mn>
          </msub>
          <mo>=</mo>
          <mi>t</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>3</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mi>s</mi>
              <mi>N</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>39</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00018" file="US20030002662A1-20030102-M00018.NB"/>
<image id="EMI-M00018" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00018.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0206" lvl="7"><number>&lsqb;0206&rsqb;</number> (where, a&equals;(m/N) designates the Jacobi symbol). </paragraph>
<paragraph id="P-0207" lvl="7"><number>&lsqb;0207&rsqb;</number> Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>, y<highlight><subscript>3</subscript></highlight>) together with the ciphertext C to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0208" lvl="0"><number>&lsqb;0208&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information (p, q) and the power multiplication unit <highlight><bold>202</bold></highlight>, the remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>, y<highlight><subscript>3</subscript></highlight>),  
<math-cwu id="MATH-US-00019">
<number>19</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>40</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00019" file="US20030002662A1-20030102-M00019.NB"/>
<image id="EMI-M00019" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00019.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0209" lvl="7"><number>&lsqb;0209&rsqb;</number> and, of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), the apparatus sets an expression satisfying (x/N)&equals;y<highlight><subscript>3 </subscript></highlight>and 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; (where, &phgr; designates the ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by the Chinese remainder theorem). Moreover, the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(41) </in-line-formula></paragraph>
<paragraph id="P-0210" lvl="7"><number>&lsqb;0210&rsqb;</number> and, based on  
<math-cwu id="MATH-US-00020">
<number>20</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>K</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>[</mo>
                    <mrow>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&CirclePlus;</mo>
                      <mrow>
                        <mi>G</mi>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>]</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <mrow>
                    <mi>i</mi>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <msub>
                      <mrow>
                        <mi>f</mi>
                        <mo>&it;</mo>
                        <mstyle>
                          <mtext>&emsp;</mtext>
                        </mstyle>
                        <mo>[</mo>
                        <mrow>
                          <msup>
                            <mi>s</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>&CirclePlus;</mo>
                          <mrow>
                            <mi>G</mi>
                            <mo>&af;</mo>
                            <mrow>
                              <mo>(</mo>
                              <msup>
                                <mi>r</mi>
                                <mi>&prime;</mi>
                              </msup>
                              <mo>)</mo>
                            </mrow>
                          </mrow>
                        </mrow>
                        <mo>]</mo>
                      </mrow>
                      <msub>
                        <mi>k</mi>
                        <mn>1</mn>
                      </msub>
                    </msub>
                  </mrow>
                  <mo>=</mo>
                  <msup>
                    <mn>0</mn>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mrow>
                  <mi>o</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>t</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>h</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>e</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>r</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>w</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>i</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>s</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>e</mi>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>42</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00020" file="US20030002662A1-20030102-M00020.NB"/>
<image id="EMI-M00020" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00020.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0211" lvl="7"><number>&lsqb;0211&rsqb;</number> calculates K&prime; (Here, it is stipulated that, in the case where K&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect. Also, &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate the more-significant and the less-significant n bits of a, respectively). </paragraph>
<paragraph id="P-0212" lvl="0"><number>&lsqb;0212&rsqb;</number> Furthermore, the decryption unit <highlight><bold>207</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, using K&prime;, performs the decryption of the ciphertext C, thereby obtaining the plaintext m. </paragraph>
<paragraph id="P-0213" lvl="7"><number>&lsqb;0213&rsqb;</number> (7th Embodiment) </paragraph>
<paragraph id="P-0214" lvl="0"><number>&lsqb;0214&rsqb;</number> In the present embodiment, the explanation will be given below regarding a cipher communication method where the public-key encryption method according to the 3rd embodiment is used for the key distribution. </paragraph>
<paragraph id="P-0215" lvl="7"><number>&lsqb;0215&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0216" lvl="0"><number>&lsqb;0216&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0217" lvl="7"><number>&lsqb;0217&rsqb;</number> the secret key (p, q) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(43) </in-line-formula></paragraph>
<paragraph id="P-0218" lvl="7"><number>&lsqb;0218&rsqb;</number> and the public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d&gE;</italic></highlight>1) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(44) </in-line-formula></paragraph>
<paragraph id="P-0219" lvl="7"><number>&lsqb;0219&rsqb;</number> Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. </paragraph>
<paragraph id="P-0220" lvl="7"><number>&lsqb;0220&rsqb;</number> 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0221" lvl="0"><number>&lsqb;0221&rsqb;</number> (1) Following the operation by the sender and using a data encryption key K&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, the encryption unit <highlight><bold>108</bold></highlight> in the sender-side apparatus <highlight><bold>100</bold></highlight> encrypts, by an existing encryption method, a message m becoming the transmission data, thereby creating a ciphertext C. In addition, using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus selects the random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;K</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(45) </in-line-formula></paragraph>
<paragraph id="P-0222" lvl="7"><number>&lsqb;0222&rsqb;</number> (where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&amp;1t; k&minus;2), and further, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2N</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(46) </in-line-formula></paragraph>
<paragraph id="P-0223" lvl="7"><number>&lsqb;0223&rsqb;</number> Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) together with the ciphertext C to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0224" lvl="0"><number>&lsqb;0224&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information (p, q) and the power multiplication unit <highlight><bold>202</bold></highlight>, the remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>),  
<math-cwu id="MATH-US-00021">
<number>21</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msub>
              <mi>y</mi>
              <mn>1</mn>
            </msub>
            <mo>&it;</mo>
            <mfrac>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>p</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>&it;</mo>
                <msup>
                  <mi>q</mi>
                  <mrow>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                </msup>
              </mrow>
              <mn>4</mn>
            </mfrac>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msub>
              <mi>y</mi>
              <mn>1</mn>
            </msub>
            <mo>&it;</mo>
            <mfrac>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>q</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>&it;</mo>
                <msup>
                  <mi>p</mi>
                  <mrow>
                    <mo>-</mo>
                    <mi>d</mi>
                  </mrow>
                </msup>
              </mrow>
              <mn>4</mn>
            </mfrac>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>47</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00021" file="US20030002662A1-20030102-M00021.NB"/>
<image id="EMI-M00021" wi="216.027" he="40.0869" file="US20030002662A1-20030102-M00021.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0225" lvl="7"><number>&lsqb;0225&rsqb;</number> and, of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), the apparatus sets an expression satisfying 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; (where, &phgr; designates the ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by the Chinese remainder theorem, and more than one s&prime; may exist). Moreover, the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(48) </in-line-formula></paragraph>
<paragraph id="P-0226" lvl="7"><number>&lsqb;0226&rsqb;</number> and, based on  
<math-cwu id="MATH-US-00022">
<number>22</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>K</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>[</mo>
                    <mrow>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&CirclePlus;</mo>
                      <mrow>
                        <mi>G</mi>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>]</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mrow>
                      <mi>if</mi>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>[</mo>
                      <mrow>
                        <msup>
                          <mi>s</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&CirclePlus;</mo>
                        <mrow>
                          <mi>G</mi>
                          <mo>&af;</mo>
                          <mrow>
                            <mo>(</mo>
                            <msup>
                              <mi>r</mi>
                              <mi>&prime;</mi>
                            </msup>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo>]</mo>
                    </mrow>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msub>
                  <mo>=</mo>
                  <msup>
                    <mn>0</mn>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>49</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00022" file="US20030002662A1-20030102-M00022.NB"/>
<image id="EMI-M00022" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00022.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0227" lvl="7"><number>&lsqb;0227&rsqb;</number> calculates K&prime; (Here, it is stipulated that, in the case where K&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect. Also, &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate the more-significant and the less-significant n bits of a, respectively). </paragraph>
<paragraph id="P-0228" lvl="0"><number>&lsqb;0228&rsqb;</number> Furthermore, the decryption unit <highlight><bold>207</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, using K&prime;, performs the decryption of the ciphertext C, thereby obtaining the plaintext m. </paragraph>
<paragraph id="P-0229" lvl="7"><number>&lsqb;0229&rsqb;</number> (8th Embodiment) </paragraph>
<paragraph id="P-0230" lvl="0"><number>&lsqb;0230&rsqb;</number> In the present embodiment, the explanation will be given below regarding a cipher communication method where the public-key encryption method according to another modified example of the 2nd embodiment is used for the key distribution. </paragraph>
<paragraph id="P-0231" lvl="7"><number>&lsqb;0231&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0232" lvl="0"><number>&lsqb;0232&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0233" lvl="7"><number>&lsqb;0233&rsqb;</number> the secret key p<highlight><subscript>i </subscript></highlight>(1&lE;i&lE;d) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>: prime numbers </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>&equiv;3(<highlight><italic>mod</italic></highlight>4) (1<highlight><italic>&lE;i&lE;d, d&gt;</italic></highlight>1)&emsp;&emsp;(50) </in-line-formula></paragraph>
<paragraph id="P-0234" lvl="7"><number>&lsqb;0234&rsqb;</number> and the public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;&Pi;</italic></highlight><highlight><subscript>i&equals;1</subscript></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>p</italic></highlight><highlight><subscript>i </subscript></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&minus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(51) </in-line-formula></paragraph>
<paragraph id="P-0235" lvl="7"><number>&lsqb;0235&rsqb;</number> Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. </paragraph>
<paragraph id="P-0236" lvl="7"><number>&lsqb;0236&rsqb;</number> 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0237" lvl="0"><number>&lsqb;0237&rsqb;</number> (1) Following the operation by the sender and using a data encryption key K&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, the encryption unit <highlight><bold>108</bold></highlight> in the sender-side apparatus <highlight><bold>100</bold></highlight> encrypts, by an existing encryption method, a message m becoming the transmission data, thereby creating a ciphertext C. In addition, using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus selects the random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;K</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(52) </in-line-formula></paragraph>
<paragraph id="P-0238" lvl="7"><number>&lsqb;0238&rsqb;</number> (where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&lE;log<highlight><subscript>2</subscript></highlight>(N&plus;1)), and further, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(53) </in-line-formula></paragraph>
<paragraph id="P-0239" lvl="7"><number>&lsqb;0239&rsqb;</number> Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) together with the ciphertext C to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0240" lvl="0"><number>&lsqb;0240&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information (p, q) and the power multiplication unit <highlight><bold>202</bold></highlight>, the remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>),  
<math-cwu id="MATH-US-00023">
<number>23</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mrow>
            <mn>1</mn>
            <mo>,</mo>
            <msub>
              <mi>p</mi>
              <mi>i</mi>
            </msub>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>1</mn>
          </msub>
          <mo>&it;</mo>
          <mfrac>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msub>
                  <mi>p</mi>
                  <mi>i</mi>
                </msub>
                <mo>+</mo>
                <mn>1</mn>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mn>4</mn>
          </mfrac>
          <mo>&it;</mo>
          <mi>mod</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <msub>
            <mi>p</mi>
            <mi>i</mi>
          </msub>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mn>1</mn>
              <mo>&leq;</mo>
              <mi>i</mi>
              <mo>&leq;</mo>
              <mi>d</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>54</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00023" file="US20030002662A1-20030102-M00023.NB"/>
<image id="EMI-M00023" wi="216.027" he="18.00225" file="US20030002662A1-20030102-M00023.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0241" lvl="7"><number>&lsqb;0241&rsqb;</number> and, of 2d expressions &phgr;(&plusmn;x<highlight><subscript>1,p1</subscript></highlight>, &plusmn;x<highlight><subscript>1,p2</subscript></highlight>, . . . , &plusmn;x<highlight><subscript>1,pd</subscript></highlight>), the apparatus sets an expression satisfying 0&amp;1t; s&prime;&amp;1t; N/2 to be s&prime; (Here, &phgr; designates the ring isomorphism mapping from Z/(p<highlight><subscript>1</subscript></highlight>)&times;Z/(p<highlight><subscript>2</subscript></highlight>)&times; . . . &times;Z/(p<highlight><subscript>d</subscript></highlight>) to Z/(N) by the Chinese remainder theorem. Also, more than one s&prime; may exist). Moreover, the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(55) </in-line-formula></paragraph>
<paragraph id="P-0242" lvl="7"><number>&lsqb;0242&rsqb;</number> and, based on  
<math-cwu id="MATH-US-00024">
<number>24</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>K</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>[</mo>
                    <mrow>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&CirclePlus;</mo>
                      <mrow>
                        <mi>G</mi>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>]</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mrow>
                      <mi>if</mi>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>[</mo>
                      <mrow>
                        <msup>
                          <mi>s</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&CirclePlus;</mo>
                        <mrow>
                          <mi>G</mi>
                          <mo>&af;</mo>
                          <mrow>
                            <mo>(</mo>
                            <msup>
                              <mi>r</mi>
                              <mi>&prime;</mi>
                            </msup>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo>]</mo>
                    </mrow>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msub>
                  <mo>=</mo>
                  <msup>
                    <mn>0</mn>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>56</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00024" file="US20030002662A1-20030102-M00024.NB"/>
<image id="EMI-M00024" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00024.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0243" lvl="7"><number>&lsqb;0243&rsqb;</number> calculates K&prime; (Here, it is stipulated that, in the case where K&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect. Also, &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate the more-significant and the less-significant n bits of a, respectively). </paragraph>
<paragraph id="P-0244" lvl="0"><number>&lsqb;0244&rsqb;</number> Furthermore, the receiver-side apparatus <highlight><bold>200</bold></highlight>, using the decryption unit <highlight><bold>207</bold></highlight> and K&prime;, performs the decryption of the ciphertext C, thereby obtaining the plaintext m. </paragraph>
<paragraph id="P-0245" lvl="7"><number>&lsqb;0245&rsqb;</number> (9th Embodiment) </paragraph>
<paragraph id="P-0246" lvl="0"><number>&lsqb;0246&rsqb;</number> In the present embodiment, the explanation will be given below concerning the case where, via a cipher communication, the sender of a message m transmits, to the receiver, the message m that becomes the transmission data. </paragraph>
<paragraph id="P-0247" lvl="0"><number>&lsqb;0247&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> illustrates the system configuration in the present embodiment. Also, <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a diagram for illustrating the outline of the processing steps in the 9th embodiment. </paragraph>
<paragraph id="P-0248" lvl="7"><number>&lsqb;0248&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0249" lvl="0"><number>&lsqb;0249&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0250" lvl="7"><number>&lsqb;0250&rsqb;</number> a public key given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>f:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>one-way trapdoor permutation, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k </superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(57) </in-line-formula></paragraph>
<paragraph id="P-0251" lvl="7"><number>&lsqb;0251&rsqb;</number> and a secret key given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>:&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>trapdoor function&emsp;&emsp;(58) </in-line-formula></paragraph>
<paragraph id="P-0252" lvl="7"><number>&lsqb;0252&rsqb;</number> Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. </paragraph>
<paragraph id="P-0253" lvl="7"><number>&lsqb;0253&rsqb;</number> 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0254" lvl="0"><number>&lsqb;0254&rsqb;</number> (1) Following the operation by the sender and using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus <highlight><bold>100</bold></highlight> selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x&isin;&lcub;0, 1&rcub;<highlight><superscript>n </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the sender-side apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>x&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>x&par;r</italic></highlight>),&emsp;&emsp;(59) </in-line-formula></paragraph>
<paragraph id="P-0255" lvl="7"><number>&lsqb;0255&rsqb;</number> and further, defines </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;f</italic></highlight>(<highlight><italic>s</italic></highlight>), <highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(60) </in-line-formula></paragraph>
<paragraph id="P-0256" lvl="7"><number>&lsqb;0256&rsqb;</number> as the ciphertext. Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0257" lvl="0"><number>&lsqb;0257&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information and the arithmetic-operation unit <highlight><bold>204</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>), </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&prime;&equals;f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>(<highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight>), <highlight><italic>t&prime;&equals;y</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(61) </in-line-formula></paragraph>
<paragraph id="P-0258" lvl="7"><number>&lsqb;0258&rsqb;</number> and further, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>x&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s&prime;</italic></highlight>)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(62) </in-line-formula></paragraph>
<paragraph id="P-0259" lvl="7"><number>&lsqb;0259&rsqb;</number> (where, x&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>) and, based on  
<math-cwu id="MATH-US-00025">
<number>25</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>x</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mi>if</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mrow>
                  <mi>G</mi>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <msup>
                        <mi>x</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&it;</mo>
                      <mrow>
                        <mo>&LeftDoubleBracketingBar;</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                    <mo>=</mo>
                    <msup>
                      <mi>s</mi>
                      <mi>&prime;</mi>
                    </msup>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>63</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00025" file="US20030002662A1-20030102-M00025.NB"/>
<image id="EMI-M00025" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00025.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0260" lvl="7"><number>&lsqb;0260&rsqb;</number> decrypts the ciphertext, thereby obtaining the plaintext (Here, it is stipulated that, in the case where x&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect). </paragraph>
<paragraph id="P-0261" lvl="0"><number>&lsqb;0261&rsqb;</number> As is the case with the public-key encryption method in the 1st embodiment, the public-key encryption method according to the present embodiment can be proved to be semantically-secure against the chosen-ciphertext attack on the premise of the difficulty in determining the inverse function of the one-way trapdoor permutation f. </paragraph>
<paragraph id="P-0262" lvl="0"><number>&lsqb;0262&rsqb;</number> As compared with the method in the 1st embodiment, the method according to the present embodiment has a feature that the length n of a plaintext can be set regardless of the function f. Namely, it is possible for the user to arbitrarily set the value of n in correspondence with the length of the message that the user wishes to transmit. </paragraph>
<paragraph id="P-0263" lvl="7"><number>&lsqb;0263&rsqb;</number> (10th Embodiment) </paragraph>
<paragraph id="P-0264" lvl="0"><number>&lsqb;0264&rsqb;</number> In the present embodiment, the more concrete explanation will be given below concerning the method according to the 9th embodiment. <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a diagram for illustrating the outline of the steps in the 10th embodiment. </paragraph>
<paragraph id="P-0265" lvl="7"><number>&lsqb;0265&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0266" lvl="0"><number>&lsqb;0266&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0267" lvl="7"><number>&lsqb;0267&rsqb;</number> a secret key (p, q) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(64) </in-line-formula></paragraph>
<paragraph id="P-0268" lvl="7"><number>&lsqb;0268&rsqb;</number> and a public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k&minus;2 </superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(65) </in-line-formula></paragraph>
<paragraph id="P-0269" lvl="7"><number>&lsqb;0269&rsqb;</number> Here, it is stipulated that the manager or the receiver of the present system has determined the value of d in advance, and that the above-described key generation unit can use the value. Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. </paragraph>
<paragraph id="P-0270" lvl="7"><number>&lsqb;0270&rsqb;</number> 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0271" lvl="0"><number>&lsqb;0271&rsqb;</number> (1) Following the operation by the sender and using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus <highlight><bold>100</bold></highlight> selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x&isin;&lcub;0, 1&rcub;<highlight><superscript>n </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>x&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>x&par;r</italic></highlight>),&emsp;&emsp;(66) </in-line-formula></paragraph>
<paragraph id="P-0272" lvl="7"><number>&lsqb;0272&rsqb;</number> and further, defines  
<math-cwu id="MATH-US-00026">
<number>26</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>1</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>s</mi>
              <mrow>
                <mn>2</mn>
                <mo>&it;</mo>
                <mi>N</mi>
              </mrow>
            </msup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>N</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>2</mn>
          </msub>
          <mo>=</mo>
          <mi>t</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>3</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mi>s</mi>
              <mi>N</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>67</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00026" file="US20030002662A1-20030102-M00026.NB"/>
<image id="EMI-M00026" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00026.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0273" lvl="7"><number>&lsqb;0273&rsqb;</number> as the ciphertext (where, a&equals;(m/N) designates the Jacobi symbol). Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>, y<highlight><subscript>3</subscript></highlight>) to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0274" lvl="0"><number>&lsqb;0274&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information (p, q) and the power multiplication unit <highlight><bold>202</bold></highlight>, the remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>, y<highlight><subscript>3</subscript></highlight>),  
<math-cwu id="MATH-US-00027">
<number>27</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msub>
              <mi>y</mi>
              <mn>1</mn>
            </msub>
            <mo>&it;</mo>
            <mfrac>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>p</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>&it;</mo>
                <msup>
                  <mi>q</mi>
                  <mrow>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                </msup>
              </mrow>
              <mn>4</mn>
            </mfrac>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msub>
              <mi>y</mi>
              <mn>1</mn>
            </msub>
            <mo>&it;</mo>
            <mfrac>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>q</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>&it;</mo>
                <msup>
                  <mi>p</mi>
                  <mrow>
                    <mo>-</mo>
                    <mi>d</mi>
                  </mrow>
                </msup>
              </mrow>
              <mn>4</mn>
            </mfrac>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>68</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00027" file="US20030002662A1-20030102-M00027.NB"/>
<image id="EMI-M00027" wi="216.027" he="40.0869" file="US20030002662A1-20030102-M00027.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0275" lvl="7"><number>&lsqb;0275&rsqb;</number> and, of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), (x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>) the apparatus sets an expression satisfying (x/N)&equals;y<highlight><subscript>3 </subscript></highlight>and 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; (where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by the Chinese remainder theorem). Moreover, the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>x&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(69) </in-line-formula></paragraph>
<paragraph id="P-0276" lvl="7"><number>&lsqb;0276&rsqb;</number> (where, x&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>) and, based on  
<math-cwu id="MATH-US-00028">
<number>28</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>x</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mi>if</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mrow>
                  <mi>G</mi>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <msup>
                        <mi>x</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&it;</mo>
                      <mrow>
                        <mo>&LeftDoubleBracketingBar;</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                    <mo>=</mo>
                    <msup>
                      <mi>s</mi>
                      <mi>&prime;</mi>
                    </msup>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>70</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00028" file="US20030002662A1-20030102-M00028.NB"/>
<image id="EMI-M00028" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00028.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0277" lvl="7"><number>&lsqb;0277&rsqb;</number> decrypts the ciphertext, thereby obtaining the plaintext (Here, it is stipulated that, in the case where x&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect). </paragraph>
<paragraph id="P-0278" lvl="0"><number>&lsqb;0278&rsqb;</number> Also, the secret key (p, q) can also be created from prime numbers p&prime;, q&prime;, using p&equals;2p&prime;&plus;1, q&equals;2q&prime;&plus;1. </paragraph>
<paragraph id="P-0279" lvl="0"><number>&lsqb;0279&rsqb;</number> In the public-key encryption method in the present embodiment, the value of d (d&gE;1) is set to be variable. Based on this condition, in the case where the bit length of the plaintext always remains short, the value of d is increased in a range where the unique factorization of n into its prime factors is difficult. This increase allows the decryption processing to be executed at a high-speed. </paragraph>
<paragraph id="P-0280" lvl="0"><number>&lsqb;0280&rsqb;</number> It can be demonstrated that, in the case of, e.g., d&equals;3, the complete cryptanalysis of the method according to the present embodiment is impossible on the premise of the difficulty in the unique factorization problem of n. Namely, if there exists an algorithm for solving the unique factorization problem of n, the utilization of the algorithm makes it possible to configure an algorithm for executing the complete cryptanalysis of the method according to the present embodiment. Also, if there exists the algorithm for executing the complete cryptanalysis of the method according to the present embodiment, the utilization of the algorithm makes it possible to configure the algorithm for solving the unique factorization problem of n. </paragraph>
<paragraph id="P-0281" lvl="7"><number>&lsqb;0281&rsqb;</number> (11th Embodiment) </paragraph>
<paragraph id="P-0282" lvl="0"><number>&lsqb;0282&rsqb;</number> In the present embodiment, the explanation will be given below regarding a modified example of the 10th embodiment. <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is a diagram for illustrating the outline of the steps in the 11th embodiment. </paragraph>
<paragraph id="P-0283" lvl="7"><number>&lsqb;0283&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0284" lvl="0"><number>&lsqb;0284&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0285" lvl="7"><number>&lsqb;0285&rsqb;</number> a secret key (p, q) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(71) </in-line-formula></paragraph>
<paragraph id="P-0286" lvl="7"><number>&lsqb;0286&rsqb;</number> and a public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d&gE;</italic></highlight>1) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k&minus;2 </superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(72) </in-line-formula></paragraph>
<paragraph id="P-0287" lvl="7"><number>&lsqb;0287&rsqb;</number> Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. </paragraph>
<paragraph id="P-0288" lvl="7"><number>&lsqb;0288&rsqb;</number> 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0289" lvl="0"><number>&lsqb;0289&rsqb;</number> (1) Following the operation by the sender and using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus <highlight><bold>100</bold></highlight> selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x&isin;&lcub;0, 1&rcub;<highlight><superscript>n </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>x&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>x&par;r</italic></highlight>),&emsp;&emsp;(73) </in-line-formula></paragraph>
<paragraph id="P-0290" lvl="7"><number>&lsqb;0290&rsqb;</number> and further, defines </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2N</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(74) </in-line-formula></paragraph>
<paragraph id="P-0291" lvl="7"><number>&lsqb;0291&rsqb;</number> as the ciphertext. Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0292" lvl="0"><number>&lsqb;0292&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information (p, q) and the power multiplication unit <highlight><bold>202</bold></highlight>, the remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>),  
<math-cwu id="MATH-US-00029">
<number>29</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msub>
              <mi>y</mi>
              <mn>1</mn>
            </msub>
            <mo>&it;</mo>
            <mfrac>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>p</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>&it;</mo>
                <msup>
                  <mi>q</mi>
                  <mrow>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                </msup>
              </mrow>
              <mn>4</mn>
            </mfrac>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msub>
              <mi>y</mi>
              <mn>1</mn>
            </msub>
            <mo>&it;</mo>
            <mfrac>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>q</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>&it;</mo>
                <msup>
                  <mi>p</mi>
                  <mrow>
                    <mo>-</mo>
                    <mi>d</mi>
                  </mrow>
                </msup>
              </mrow>
              <mn>4</mn>
            </mfrac>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>75</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00029" file="US20030002662A1-20030102-M00029.NB"/>
<image id="EMI-M00029" wi="216.027" he="40.0869" file="US20030002662A1-20030102-M00029.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0293" lvl="7"><number>&lsqb;0293&rsqb;</number> and, of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), the apparatus sets an expression satisfying 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; (Here, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by the Chinese remainder theorem, and more than one s&prime; may exist). Moreover, the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>x&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(76) </in-line-formula></paragraph>
<paragraph id="P-0294" lvl="7"><number>&lsqb;0294&rsqb;</number> (where, x&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>) and, based on  
<math-cwu id="MATH-US-00030">
<number>30</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>x</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mi>x</mi>
                  <mi>&prime;</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <mi>if</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mrow>
                    <mi>G</mi>
                    <mo>(</mo>
                    <mrow>
                      <mrow>
                        <msup>
                          <mi>x</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&it;</mo>
                        <mrow>
                          <mo>&LeftDoubleBracketingBar;</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                      <mo>=</mo>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                    </mrow>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>77</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00030" file="US20030002662A1-20030102-M00030.NB"/>
<image id="EMI-M00030" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00030.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0295" lvl="7"><number>&lsqb;0295&rsqb;</number> decrypts the ciphertext, thereby obtaining the plaintext (Here, it is stipulated that, in the case where x&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect). </paragraph>
<paragraph id="P-0296" lvl="0"><number>&lsqb;0296&rsqb;</number> Also, the secret key (p, q) can also be created from prime numbers p&prime;, q&prime;, using p&equals;2p&prime;&plus;1, q&equals;2q&prime;&plus;1. </paragraph>
<paragraph id="P-0297" lvl="0"><number>&lsqb;0297&rsqb;</number> In the public-key encryption method in the present embodiment, the value of d (d&gE;1) is set to be variable. Based on this condition, in the case where the bit length of the plaintext always remains short, the value of d is increased in a range where the unique factorization of n into its prime factors is difficult. This increase allows the decryption processing to be executed at a high-speed. </paragraph>
<paragraph id="P-0298" lvl="0"><number>&lsqb;0298&rsqb;</number> It can be demonstrated that, in the case of, e.g., d&equals;3, the complete cryptanalysis of the method according to the present embodiment is impossible on the premise of the difficulty in the unique factorization problem of n. Namely, if there exists an algorithm for solving the unique factorization problem of n, the utilization of the algorithm makes it possible to configure an algorithm for executing the complete cryptanalysis of the method according to the present embodiment. Also, if there exists the algorithm for executing the complete cryptanalysis of the method according to the present embodiment, the utilization of the algorithm makes it possible to configure the algorithm for solving the unique factorization problem of n. </paragraph>
<paragraph id="P-0299" lvl="7"><number>&lsqb;0299&rsqb;</number> (12th Embodiment) </paragraph>
<paragraph id="P-0300" lvl="0"><number>&lsqb;0300&rsqb;</number> In the present embodiment, the explanation will be given below regarding another modified example of the 10th embodiment. <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a diagram for illustrating the outline of the steps in the 12th embodiment. </paragraph>
<paragraph id="P-0301" lvl="7"><number>&lsqb;0301&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0302" lvl="0"><number>&lsqb;0302&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0303" lvl="7"><number>&lsqb;0303&rsqb;</number> a secret key p<highlight><subscript>i </subscript></highlight>(1&lE;i&lE;d) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>: prime numbers </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>&equiv;3(<highlight><italic>mod</italic></highlight>4) (1<highlight><italic>&lE;i&lE;d, d&gt;</italic></highlight>1)&emsp;&emsp;(78) </in-line-formula></paragraph>
<paragraph id="P-0304" lvl="7"><number>&lsqb;0304&rsqb;</number> and a public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;&Pi;</italic></highlight><highlight><subscript>i&equals;1</subscript></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>p</italic></highlight><highlight><subscript>i </subscript></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(79) </in-line-formula></paragraph>
<paragraph id="P-0305" lvl="7"><number>&lsqb;0305&rsqb;</number> Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. </paragraph>
<paragraph id="P-0306" lvl="7"><number>&lsqb;0306&rsqb;</number> 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0307" lvl="0"><number>&lsqb;0307&rsqb;</number> (1) Following the operation by the sender and using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus <highlight><bold>100</bold></highlight> selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x&isin;&lcub;0, 1&rcub;<highlight><superscript>n </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>x&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>x&par;r</italic></highlight>),&emsp;&emsp;(80) </in-line-formula></paragraph>
<paragraph id="P-0308" lvl="7"><number>&lsqb;0308&rsqb;</number> (where, k&minus;1&lE;log<highlight><subscript>2</subscript></highlight>(N&plus;1)), and further, defines </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(81) </in-line-formula></paragraph>
<paragraph id="P-0309" lvl="7"><number>&lsqb;0309&rsqb;</number> as the ciphertext. Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0310" lvl="0"><number>&lsqb;0310&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information (p, q) and the power multiplication unit <highlight><bold>202</bold></highlight>, the remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>),  
<math-cwu id="MATH-US-00031">
<number>31</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>1</mn>
                  <mo>,</mo>
                  <msub>
                    <mi>p</mi>
                    <mi>i</mi>
                  </msub>
                </mrow>
              </msub>
              <mo>=</mo>
              <mrow>
                <msubsup>
                  <mi>y</mi>
                  <mn>1</mn>
                  <mfrac>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mn>4</mn>
                  </mfrac>
                </msubsup>
                <mo>&it;</mo>
                <mi>m</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>o</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>d</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <msub>
                  <mi>p</mi>
                  <mi>i</mi>
                </msub>
              </mrow>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mn>1</mn>
                <mo>&leq;</mo>
                <mi>i</mi>
                <mo>&leq;</mo>
                <mi>d</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>82</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00031" file="US20030002662A1-20030102-M00031.NB"/>
<image id="EMI-M00031" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00031.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0311" lvl="7"><number>&lsqb;0311&rsqb;</number> and, of 2<highlight><superscript>d </superscript></highlight>expressions &phgr;(&plusmn;x<highlight><subscript>1,p1</subscript></highlight>, &plusmn;x<highlight><subscript>1,p2</subscript></highlight>, . . . , &plusmn;x<highlight><subscript>1,pd</subscript></highlight>) the apparatus sets an expression satisfying 0&amp;1t; s&prime;&amp;1t; N/2 to be s&prime; (Here, &phgr; designates a ring isomorphism mapping from Z/(p<highlight><subscript>1</subscript></highlight>)&times;Z/(p<highlight><subscript>2</subscript></highlight>)&times; . . . &times;Z/(p<highlight><subscript>d</subscript></highlight>) to Z/(N) by the Chinese remainder theorem. Also, more than one s&prime; may exist). Moreover, the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>x&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(83) </in-line-formula></paragraph>
<paragraph id="P-0312" lvl="7"><number>&lsqb;0312&rsqb;</number> (where, x&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>) and, based on  
<math-cwu id="MATH-US-00032">
<number>32</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>x</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>i</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>f</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mrow>
                    <mi>G</mi>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msup>
                          <mi>x</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>||</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <msup>
                  <mi>s</mi>
                  <mi>&prime;</mi>
                </msup>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>84</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00032" file="US20030002662A1-20030102-M00032.NB"/>
<image id="EMI-M00032" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00032.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0313" lvl="7"><number>&lsqb;0313&rsqb;</number> decrypts the ciphertext, thereby obtaining the plaintext (Here, it is stipulated that, in the case where x&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect). </paragraph>
<paragraph id="P-0314" lvl="0"><number>&lsqb;0314&rsqb;</number> Also, the secret key p, q can also be created from prime numbers p&prime;, q&prime;, using p&equals;2p&prime;&plus;1, q&equals;2q&prime;&plus;1. </paragraph>
<paragraph id="P-0315" lvl="0"><number>&lsqb;0315&rsqb;</number> In the public-key encryption method in the present embodiment, the value of d (d &amp;gt; 1) is set to be variable. </paragraph>
<paragraph id="P-0316" lvl="0"><number>&lsqb;0316&rsqb;</number> It can be demonstrated that the complete cryptanalysis of the method according to the present embodiment is impossible on the premise of the difficulty in the unique factorization problem of n. Namely, if there exists an algorithm for solving the unique factorization problem of n, the utilization of the algorithm makes it possible to configure an algorithm for executing the complete cryptanalysis of the method according to the present embodiment. Also, if there exists the algorithm for executing the complete cryptanalysis of the method according to the present embodiment, the utilization of the algorithm makes it possible to configure the algorithm for solving the unique factorization problem of n. </paragraph>
<paragraph id="P-0317" lvl="7"><number>&lsqb;0317&rsqb;</number> (13th Embodiment) </paragraph>
<paragraph id="P-0318" lvl="0"><number>&lsqb;0318&rsqb;</number> In the present embodiment, the explanation will be given below concerning a cipher communication method where the public-key encryption method according to the 9th embodiment is used for the key distribution. </paragraph>
<paragraph id="P-0319" lvl="0"><number>&lsqb;0319&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> illustrates the system configuration in the present embodiment. </paragraph>
<paragraph id="P-0320" lvl="7"><number>&lsqb;0320&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0321" lvl="0"><number>&lsqb;0321&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0322" lvl="7"><number>&lsqb;0322&rsqb;</number> a public key given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>f:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>one-way trapdoor permutation, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(85) </in-line-formula></paragraph>
<paragraph id="P-0323" lvl="7"><number>&lsqb;0323&rsqb;</number> and a secret key given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>:&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>trapdoor function&emsp;&emsp;(86) </in-line-formula></paragraph>
<paragraph id="P-0324" lvl="7"><number>&lsqb;0324&rsqb;</number> Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. </paragraph>
<paragraph id="P-0325" lvl="7"><number>&lsqb;0325&rsqb;</number> 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0326" lvl="0"><number>&lsqb;0326&rsqb;</number> (1) Following the operation by the sender and using a data encryption key K&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, the encryption unit <highlight><bold>108</bold></highlight> in the sender-side apparatus <highlight><bold>100</bold></highlight> encrypts, by an existing encryption method, a message m becoming the transmission data, thereby creating a ciphertext C. In addition, using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>K&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>K&par;r</italic></highlight>),&emsp;&emsp;(87) </in-line-formula></paragraph>
<paragraph id="P-0327" lvl="7"><number>&lsqb;0327&rsqb;</number> and further, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;f</italic></highlight>(<highlight><italic>s</italic></highlight>), <highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(88) </in-line-formula></paragraph>
<paragraph id="P-0328" lvl="7"><number>&lsqb;0328&rsqb;</number> Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) together with the ciphertext C to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0329" lvl="0"><number>&lsqb;0329&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information and the arithmetic-operation unit <highlight><bold>204</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>), </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&prime;&equals;f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>(<highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight>), <highlight><italic>t&prime;&equals;y</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(89) </in-line-formula></paragraph>
<paragraph id="P-0330" lvl="7"><number>&lsqb;0330&rsqb;</number> and further, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>K&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(90) </in-line-formula></paragraph>
<paragraph id="P-0331" lvl="7"><number>&lsqb;0331&rsqb;</number> (where, K&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>) and, based on  
<math-cwu id="MATH-US-00033">
<number>33</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>K</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>i</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>f</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mrow>
                    <mi>G</mi>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msup>
                          <mi>K</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>||</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <msup>
                  <mi>s</mi>
                  <mi>&prime;</mi>
                </msup>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>91</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00033" file="US20030002662A1-20030102-M00033.NB"/>
<image id="EMI-M00033" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00033.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0332" lvl="7"><number>&lsqb;0332&rsqb;</number> calculates K&prime; (Here, it is stipulated that, in the case where K&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect). </paragraph>
<paragraph id="P-0333" lvl="0"><number>&lsqb;0333&rsqb;</number> Furthermore, the decryption unit <highlight><bold>207</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, using K&prime;, performs the decryption of the ciphertext C, thereby obtaining the plaintext m. </paragraph>
<paragraph id="P-0334" lvl="7"><number>&lsqb;0334&rsqb;</number> (14th Embodiment) </paragraph>
<paragraph id="P-0335" lvl="0"><number>&lsqb;0335&rsqb;</number> In the present embodiment, the explanation will be given below concerning a cipher communication method where the public-key encryption method according to the 10th embodiment is used for the key distribution. </paragraph>
<paragraph id="P-0336" lvl="7"><number>&lsqb;0336&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0337" lvl="0"><number>&lsqb;0337&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0338" lvl="7"><number>&lsqb;0338&rsqb;</number> a secret key (p, q) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(92) </in-line-formula></paragraph>
<paragraph id="P-0339" lvl="7"><number>&lsqb;0339&rsqb;</number> and a public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&minus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k&minus;2 </superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(93) </in-line-formula></paragraph>
<paragraph id="P-0340" lvl="7"><number>&lsqb;0340&rsqb;</number> Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. </paragraph>
<paragraph id="P-0341" lvl="7"><number>&lsqb;0341&rsqb;</number> 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0342" lvl="0"><number>&lsqb;0342&rsqb;</number> (1) Following the operation by the sender and using a data encryption key K&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, the encryption unit <highlight><bold>108</bold></highlight> in the sender-side apparatus <highlight><bold>100</bold></highlight> encrypts, by an existing encryption method, a message m becoming the transmission data, thereby creating a ciphertext C. In addition, using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>K&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>K&par;r</italic></highlight>),&emsp;&emsp;(94) </in-line-formula></paragraph>
<paragraph id="P-0343" lvl="7"><number>&lsqb;0343&rsqb;</number> and further, calculates  
<math-cwu id="MATH-US-00034">
<number>34</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <msub>
                  <mi>y</mi>
                  <mn>1</mn>
                </msub>
                <mo>=</mo>
                <mrow>
                  <msup>
                    <mi>s</mi>
                    <mrow>
                      <mn>2</mn>
                      <mo>&it;</mo>
                      <mi>N</mi>
                    </mrow>
                  </msup>
                  <mo>&it;</mo>
                  <mi>m</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>o</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>d</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>N</mi>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mrow>
                <msub>
                  <mi>y</mi>
                  <mn>2</mn>
                </msub>
                <mo>=</mo>
                <mi>t</mi>
              </mrow>
              <mo>,</mo>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <msub>
                <mi>y</mi>
                <mn>3</mn>
              </msub>
              <mo>=</mo>
              <mrow>
                <mo>(</mo>
                <mfrac>
                  <mi>s</mi>
                  <mi>N</mi>
                </mfrac>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>95</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00034" file="US20030002662A1-20030102-M00034.NB"/>
<image id="EMI-M00034" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00034.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0344" lvl="7"><number>&lsqb;0344&rsqb;</number> (where, a&equals;(m/N) designates the Jacobi symbol). Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>, y<highlight><subscript>3</subscript></highlight>) together with the ciphertext C to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0345" lvl="0"><number>&lsqb;0345&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information (p, q) and the power multiplication unit <highlight><bold>202</bold></highlight>, the remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>, y<highlight><subscript>3</subscript></highlight>),  
<math-cwu id="MATH-US-00035">
<number>35</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mrow>
              <mi>d</mi>
              <mo>&it;</mo>
              <mi>q</mi>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>96</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00035" file="US20030002662A1-20030102-M00035.NB"/>
<image id="EMI-M00035" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00035.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0346" lvl="7"><number>&lsqb;0346&rsqb;</number> and, of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p, &minus;x</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), the apparatus sets an expression satisfying (x/N)&equals;y<highlight><subscript>3 </subscript></highlight>and 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; (where, <highlight><bold>100</bold></highlight> designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by the Chinese remainder theorem). Moreover, the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>K&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(97) </in-line-formula></paragraph>
<paragraph id="P-0347" lvl="7"><number>&lsqb;0347&rsqb;</number> (where, K&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>) and, based on  
<math-cwu id="MATH-US-00036">
<number>36</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>K</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>i</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>f</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mrow>
                    <mi>G</mi>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msup>
                          <mi>K</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>||</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <msup>
                  <mi>s</mi>
                  <mi>&prime;</mi>
                </msup>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>98</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00036" file="US20030002662A1-20030102-M00036.NB"/>
<image id="EMI-M00036" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00036.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0348" lvl="7"><number>&lsqb;0348&rsqb;</number> calculates K&prime; (Here, it is stipulated that, in the case where K&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect). </paragraph>
<paragraph id="P-0349" lvl="0"><number>&lsqb;0349&rsqb;</number> Furthermore, the decryption unit <highlight><bold>207</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, using K&prime;, performs the decryption of the ciphertext C, thereby obtaining the plaintext m. </paragraph>
<paragraph id="P-0350" lvl="7"><number>&lsqb;0350&rsqb;</number> (15th Embodiment) </paragraph>
<paragraph id="P-0351" lvl="0"><number>&lsqb;0351&rsqb;</number> In the present embodiment, the explanation will be given below regarding a cipher communication method where the public-key encryption method according to the 11th embodiment is used for the key distribution. </paragraph>
<paragraph id="P-0352" lvl="7"><number>&lsqb;0352&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0353" lvl="0"><number>&lsqb;0353&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0354" lvl="7"><number>&lsqb;0354&rsqb;</number> a secret key (p, q) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(99) </in-line-formula></paragraph>
<paragraph id="P-0355" lvl="7"><number>&lsqb;0355&rsqb;</number> and a public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d&gE;</italic></highlight>1) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&minus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k&minus;2 </superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&minus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(100) </in-line-formula></paragraph>
<paragraph id="P-0356" lvl="7"><number>&lsqb;0356&rsqb;</number> Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0357" lvl="0"><number>&lsqb;0357&rsqb;</number> (1) Following the operation by the sender and using a data encryption key K&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, the encryption unit <highlight><bold>108</bold></highlight> in the sender-side apparatus <highlight><bold>100</bold></highlight> encrypts, by an existing encryption method, a message m becoming the transmission data, thereby creating a ciphertext C. In addition, using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>K&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>K&par;r</italic></highlight>),&emsp;&emsp;(101) </in-line-formula></paragraph>
<paragraph id="P-0358" lvl="7"><number>&lsqb;0358&rsqb;</number> and further, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2N</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(102) </in-line-formula></paragraph>
<paragraph id="P-0359" lvl="7"><number>&lsqb;0359&rsqb;</number> Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) together with the ciphertext C to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0360" lvl="0"><number>&lsqb;0360&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information (p, q) and the power multiplication unit <highlight><bold>202</bold></highlight>, the remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>),  
<math-cwu id="MATH-US-00037">
<number>37</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mrow>
              <mi>d</mi>
              <mo>&it;</mo>
              <mi>q</mi>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>103</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00037" file="US20030002662A1-20030102-M00037.NB"/>
<image id="EMI-M00037" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00037.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0361" lvl="7"><number>&lsqb;0361&rsqb;</number> and, of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p, &minus;x</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), the apparatus sets an expression satisfying 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; (where, <highlight><bold>100</bold></highlight> designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by the Chinese remainder theorem, and more than one s&prime; may exist). Moreover, the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>K&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(104) </in-line-formula></paragraph>
<paragraph id="P-0362" lvl="7"><number>&lsqb;0362&rsqb;</number> (where, K&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>) and, based on  
<math-cwu id="MATH-US-00038">
<number>38</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>K</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>i</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>f</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mrow>
                    <mi>G</mi>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msup>
                          <mi>K</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>||</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <msup>
                  <mi>s</mi>
                  <mi>&prime;</mi>
                </msup>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>105</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00038" file="US20030002662A1-20030102-M00038.NB"/>
<image id="EMI-M00038" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00038.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0363" lvl="7"><number>&lsqb;0363&rsqb;</number> calculates K&prime; (Here, it is stipulated that, in the case where K&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect). </paragraph>
<paragraph id="P-0364" lvl="0"><number>&lsqb;0364&rsqb;</number> Furthermore, the decryption unit <highlight><bold>207</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, using K&prime;, performs the decryption of the ciphertext C, thereby obtaining the plaintext m. </paragraph>
<paragraph id="P-0365" lvl="7"><number>&lsqb;0365&rsqb;</number> (16th Embodiment) </paragraph>
<paragraph id="P-0366" lvl="0"><number>&lsqb;0366&rsqb;</number> In the present embodiment, the explanation will be given below regarding a cipher communication method where the public-key encryption method according to another modified example of the 10th embodiment is used for the key distribution. </paragraph>
<paragraph id="P-0367" lvl="7"><number>&lsqb;0367&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0368" lvl="0"><number>&lsqb;0368&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0369" lvl="7"><number>&lsqb;0369&rsqb;</number> a secret key p<highlight><subscript>i </subscript></highlight>(1&lE;i&lE;d) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>: prime numbers </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>&equiv;3(<highlight><italic>mod</italic></highlight>4) (1<highlight><italic>&lE;i&lE;d, d&gt;</italic></highlight>1)&emsp;&emsp;(106) </in-line-formula></paragraph>
<paragraph id="P-0370" lvl="7"><number>&lsqb;0370&rsqb;</number> and a public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;&Pi;</italic></highlight><highlight><subscript>i&equals;1</subscript></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>p</italic></highlight><highlight><subscript>i </subscript></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(107) </in-line-formula></paragraph>
<paragraph id="P-0371" lvl="7"><number>&lsqb;0371&rsqb;</number> Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0372" lvl="0"><number>&lsqb;0372&rsqb;</number> (1) Following the operation by the sender and using a data encryption key K&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, the encryption unit <highlight><bold>108</bold></highlight> in the sender-side apparatus <highlight><bold>100</bold></highlight> encrypts, by an existing encryption method, a message m becoming the transmission data, thereby creating a ciphertext C. In addition, using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>K&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>K&par;r</italic></highlight>),&emsp;&emsp;(108) </in-line-formula></paragraph>
<paragraph id="P-0373" lvl="7"><number>&lsqb;0373&rsqb;</number> (where, k&minus;1&lE;log<highlight><subscript>2</subscript></highlight>(N&plus;1)), and further, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(109) </in-line-formula></paragraph>
<paragraph id="P-0374" lvl="7"><number>&lsqb;0374&rsqb;</number> Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) together with the ciphertext C to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0375" lvl="0"><number>&lsqb;0375&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information (p, q) and the power multiplication unit <highlight><bold>202</bold></highlight>, the remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>),  
<math-cwu id="MATH-US-00039">
<number>39</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>1</mn>
                  <mo>,</mo>
                  <msub>
                    <mi>p</mi>
                    <mi>i</mi>
                  </msub>
                </mrow>
              </msub>
              <mo>=</mo>
              <mrow>
                <msubsup>
                  <mi>y</mi>
                  <mn>1</mn>
                  <mfrac>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mn>4</mn>
                  </mfrac>
                </msubsup>
                <mo>&it;</mo>
                <mi>m</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>o</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>d</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <msub>
                  <mi>p</mi>
                  <mi>i</mi>
                </msub>
              </mrow>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mn>1</mn>
                <mo>&leq;</mo>
                <mi>i</mi>
                <mo>&leq;</mo>
                <mi>d</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>110</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00039" file="US20030002662A1-20030102-M00039.NB"/>
<image id="EMI-M00039" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00039.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0376" lvl="7"><number>&lsqb;0376&rsqb;</number> and, of 2<highlight><superscript>d </superscript></highlight>expressions &phgr;(&plusmn;x<highlight><subscript>1,p1</subscript></highlight>, &plusmn;x<highlight><subscript>1,p2</subscript></highlight>, . . . , &plusmn;x<highlight><subscript>1,pd</subscript></highlight>), the apparatus sets an expression satisfying 0&amp;1t; s&prime;&amp;1t; N/2 to be s&prime; (Here, &phgr; designates a ring isomorphism mapping from Z/(p<highlight><subscript>1</subscript></highlight>)&times;Z/(p<highlight><subscript>2</subscript></highlight>)&times; . . . &times;Z/(p<highlight><subscript>d</subscript></highlight>) to Z/(N) by the Chinese remainder theorem. Also, more than one s&prime; may exist). Moreover, the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>K&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(111) </in-line-formula></paragraph>
<paragraph id="P-0377" lvl="7"><number>&lsqb;0377&rsqb;</number> (where, K&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>) and, based on  
<math-cwu id="MATH-US-00040">
<number>40</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>K</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>i</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>f</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mrow>
                    <mi>G</mi>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msup>
                          <mi>K</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>||</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <msup>
                  <mi>s</mi>
                  <mi>&prime;</mi>
                </msup>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>112</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00040" file="US20030002662A1-20030102-M00040.NB"/>
<image id="EMI-M00040" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00040.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0378" lvl="7"><number>&lsqb;0378&rsqb;</number> calculates K&prime; (Here, it is stipulated that, in the case where K&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect). </paragraph>
<paragraph id="P-0379" lvl="0"><number>&lsqb;0379&rsqb;</number> Furthermore, the decryption unit <highlight><bold>207</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, using K&prime;, performs the decryption of the ciphertext C, thereby obtaining the plaintext m. </paragraph>
<paragraph id="P-0380" lvl="7"><number>&lsqb;0380&rsqb;</number> (17th Embodiment) </paragraph>
<paragraph id="P-0381" lvl="0"><number>&lsqb;0381&rsqb;</number> In the present embodiment, the explanation will be given below concerning the case where, via a cipher communication, the sender of a message m transmits, to the receiver, the message m that becomes the transmission data. </paragraph>
<paragraph id="P-0382" lvl="0"><number>&lsqb;0382&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> illustrates the system configuration in the present embodiment. <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is a diagram for illustrating the outline of the processing steps in the 17th embodiment. </paragraph>
<paragraph id="P-0383" lvl="7"><number>&lsqb;0383&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0384" lvl="0"><number>&lsqb;0384&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0385" lvl="7"><number>&lsqb;0385&rsqb;</number> a public key given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>f:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>one-way trapdoor permutation, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&minus;k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(113) </in-line-formula></paragraph>
<paragraph id="P-0386" lvl="7"><number>&lsqb;0386&rsqb;</number> and a secret key given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>:&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>trapdoor function&emsp;&emsp;(114) </in-line-formula></paragraph>
<paragraph id="P-0387" lvl="7"><number>&lsqb;0387&rsqb;</number> Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0388" lvl="0"><number>&lsqb;0388&rsqb;</number> (1) Following the operation by the sender and using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus <highlight><bold>100</bold></highlight> selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k </superscript></highlight>for a plaintext x&isin;&lcub;0, 1&rcub;<highlight><superscript>n </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the sender-side apparatus calculates and defines, as the ciphertext, </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;f</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight>&equals;(<highlight><italic>x&par;H</italic></highlight>(<highlight><italic>x&par;r</italic></highlight>))&oplus;<highlight><italic>G</italic></highlight>(<highlight><italic>r</italic></highlight>),&emsp;&emsp;(115) </in-line-formula></paragraph>
<paragraph id="P-0389" lvl="7"><number>&lsqb;0389&rsqb;</number> Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0390" lvl="0"><number>&lsqb;0390&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information and the arithmetic-operation unit <highlight><bold>204</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>), </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>r&prime;&equals;f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>(<highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight>)&emsp;&emsp;(116) </in-line-formula></paragraph>
<paragraph id="P-0391" lvl="7"><number>&lsqb;0391&rsqb;</number> and further, calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>x&prime;&par;w&prime;&equals;G</italic></highlight>(<highlight><italic>r</italic></highlight>&prime;)&oplus;<highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(117) </in-line-formula></paragraph>
<paragraph id="P-0392" lvl="7"><number>&lsqb;0392&rsqb;</number> (where, x&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, w&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>) and, based on  
<math-cwu id="MATH-US-00041">
<number>41</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mrow>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mi>x</mi>
                  <mi>&prime;</mi>
                </msup>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
            </mtr>
          </mtable>
          <mo>&it;</mo>
          <mtable>
            <mtr>
              <mtd>
                <mrow>
                  <mrow>
                    <mi>if</mi>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <msup>
                      <mi>&omega;</mi>
                      <mi>&prime;</mi>
                    </msup>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <mi>H</mi>
                    <mo>(</mo>
                    <mrow>
                      <mrow>
                        <msup>
                          <mi>x</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&it;</mo>
                        <mrow>
                          <mo>&LeftDoubleBracketingBar;</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                        </mrow>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>118</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00041" file="US20030002662A1-20030102-M00041.NB"/>
<image id="EMI-M00041" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00041.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0393" lvl="7"><number>&lsqb;0393&rsqb;</number> decrypts the ciphertext, thereby obtaining the plaintext (Here, it is stipulated that, in the case where x&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect). </paragraph>
<paragraph id="P-0394" lvl="0"><number>&lsqb;0394&rsqb;</number> As is the case with the public-key encryption method in the 1st embodiment, the public-key encryption method according to the present embodiment can be proved to be semantically-secure against the chosen-ciphertext attack on the premise of the difficulty in determining the inverse function of the one-way trapdoor permutation f. </paragraph>
<paragraph id="P-0395" lvl="0"><number>&lsqb;0395&rsqb;</number> As compared with the methods in the 1st and the 9th embodiments, the method according to the present embodiment has a feature of making it possible to perform a preprocessing calculation of y<highlight><subscript>1</subscript></highlight>, i.e., a part of the ciphertext. Namely, since it is possible to calculate y<highlight><subscript>1 </subscript></highlight>independently of the plaintext, performing the calculation in advance allows the high-speed encryption processing to be implemented. </paragraph>
<paragraph id="P-0396" lvl="0"><number>&lsqb;0396&rsqb;</number> Also, as is the case with the public-key encryption method in the 9th embodiment, the method according to the present embodiment has the feature that the length n of a plaintext can be set regardless of the function f. Namely, it is possible for the user to arbitrarily set the value of n in correspondence with the length of the message that the user wishes to transmit. </paragraph>
<paragraph id="P-0397" lvl="7"><number>&lsqb;0397&rsqb;</number> (18th Embodiment) </paragraph>
<paragraph id="P-0398" lvl="0"><number>&lsqb;0398&rsqb;</number> In the present embodiment, the more concrete explanation will be given below concerning the method according to the 17th embodiment. <cross-reference target="DRAWINGS">FIG. 14</cross-reference> is a diagram for illustrating the outline of the steps in the 18th embodiment. </paragraph>
<paragraph id="P-0399" lvl="7"><number>&lsqb;0399&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0400" lvl="0"><number>&lsqb;0400&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0401" lvl="7"><number>&lsqb;0401&rsqb;</number> a secret key (p, q) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(119) </in-line-formula></paragraph>
<paragraph id="P-0402" lvl="7"><number>&lsqb;0402&rsqb;</number> and a public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&minus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(120) </in-line-formula></paragraph>
<paragraph id="P-0403" lvl="7"><number>&lsqb;0403&rsqb;</number> Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0404" lvl="0"><number>&lsqb;0404&rsqb;</number> (1) Following the operation by the sender and using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus <highlight><bold>100</bold></highlight> selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k&minus;</superscript></highlight>2 for a plaintext x&isin;&lcub;0, 1&rcub;<highlight><superscript>n </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus calculates and defines, as the ciphertext,  
<math-cwu id="MATH-US-00042">
<number>42</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>1</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>r</mi>
              <mrow>
                <mn>2</mn>
                <mo>&it;</mo>
                <mi>N</mi>
              </mrow>
            </msup>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>N</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>2</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>x</mi>
                    <mo>&it;</mo>
                    <mrow>
                      <mo>&LeftDoubleBracketingBar;</mo>
                      <mrow>
                        <mrow>
                          <mrow>
                            <mi>H</mi>
                            <mo>(</mo>
                            <mi>x</mi>
                          </mrow>
                          <mo>&RightDoubleBracketingBar;</mo>
                        </mrow>
                        <mo>&it;</mo>
                        <mi>r</mi>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mo>&CirclePlus;</mo>
            <mrow>
              <mi>G</mi>
              <mo>&af;</mo>
              <mrow>
                <mo>(</mo>
                <mi>r</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>3</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mi>r</mi>
              <mi>N</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>121</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00042" file="US20030002662A1-20030102-M00042.NB"/>
<image id="EMI-M00042" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00042.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0405" lvl="7"><number>&lsqb;0405&rsqb;</number> (where, a&equals;(m/N) designates the Jacobi symbol). Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>, y<highlight><subscript>3</subscript></highlight>) to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0406" lvl="0"><number>&lsqb;0406&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information (p, q) and the power multiplication unit <highlight><bold>202</bold></highlight>, the remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>, y<highlight><subscript>3</subscript></highlight>),  
<math-cwu id="MATH-US-00043">
<number>43</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>r</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>r</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>122</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00043" file="US20030002662A1-20030102-M00043.NB"/>
<image id="EMI-M00043" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00043.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0407" lvl="7"><number>&lsqb;0407&rsqb;</number> and, of expressions &phgr;(r<highlight><subscript>1,p</subscript></highlight>, r<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;r<highlight><subscript>1,p</subscript></highlight>, r<highlight><subscript>1,q</subscript></highlight>), &phgr;(r<highlight><subscript>1,p, &minus;r</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;r<highlight><subscript>1,p</subscript></highlight>, &minus;r<highlight><subscript>1,q</subscript></highlight>), the apparatus sets an expression satisfying (r/N)&equals;y<highlight><subscript>3 </subscript></highlight>and 0&amp;1t; r&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be r&prime; (where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by the Chinese remainder theorem). Moreover, the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>x&prime;&par;w&prime;&equals;G</italic></highlight>(<highlight><italic>r</italic></highlight>&prime;)&oplus;<highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(123) </in-line-formula></paragraph>
<paragraph id="P-0408" lvl="7"><number>&lsqb;0408&rsqb;</number> (where, x&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, w&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>) and, based on  
<math-cwu id="MATH-US-00044">
<number>44</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mrow>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mi>x</mi>
                  <mi>&prime;</mi>
                </msup>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
            </mtr>
          </mtable>
          <mo>&it;</mo>
          <mtable>
            <mtr>
              <mtd>
                <mrow>
                  <mrow>
                    <mi>if</mi>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <msup>
                      <mi>&omega;</mi>
                      <mi>&prime;</mi>
                    </msup>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <mi>H</mi>
                    <mo>(</mo>
                    <mrow>
                      <mrow>
                        <msup>
                          <mi>x</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&it;</mo>
                        <mrow>
                          <mo>&LeftDoubleBracketingBar;</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                        </mrow>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>124</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00044" file="US20030002662A1-20030102-M00044.NB"/>
<image id="EMI-M00044" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00044.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0409" lvl="7"><number>&lsqb;0409&rsqb;</number> decrypts the ciphertext, thereby obtaining the plaintext (Here, it is stipulated that, in the case where x&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect). </paragraph>
<paragraph id="P-0410" lvl="0"><number>&lsqb;0410&rsqb;</number> Also, the secret key (p, q) can also be created from prime numbers p&prime;, q&prime;, using p&equals;2p&prime;&plus;1, q&equals;2q&prime;&plus;1. </paragraph>
<paragraph id="P-0411" lvl="0"><number>&lsqb;0411&rsqb;</number> In the public-key encryption method in the present embodiment, the value of d (d&gE;1) is set to be variable. Based on this condition, in the case where the bit length of the plaintext always remains short, the value of d is increased in a range where the unique factorization of n into its prime factors is difficult. This increase allows the decryption processing to be executed at a high-speed. </paragraph>
<paragraph id="P-0412" lvl="0"><number>&lsqb;0412&rsqb;</number> It can be demonstrated that, in the case of, e.g., d&equals;3, the complete cryptanalysis of the method according to the present embodiment is impossible on the premise of the difficulty in the unique factorization problem of n. Namely, if there exists an algorithm for solving the unique factorization problem of n, the utilization of the algorithm makes it possible to configure an algorithm for executing the complete cryptanalysis of the method according to the present embodiment. Also, if there exists the algorithm for executing the complete cryptanalysis of the method according to the present embodiment, the utilization of the algorithm makes it possible to configure the algorithm for solving the unique factorization problem of n. </paragraph>
<paragraph id="P-0413" lvl="7"><number>&lsqb;0413&rsqb;</number> (19th Embodiment) </paragraph>
<paragraph id="P-0414" lvl="0"><number>&lsqb;0414&rsqb;</number> In the present embodiment, the explanation will be given below regarding a modified example of the 17th embodiment. <cross-reference target="DRAWINGS">FIG. 15</cross-reference> is a diagram for illustrating the outline of the steps in the 19th embodiment. </paragraph>
<paragraph id="P-0415" lvl="7"><number>&lsqb;0415&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0416" lvl="0"><number>&lsqb;0416&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0417" lvl="7"><number>&lsqb;0417&rsqb;</number> a secret key (p, q) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(125) </in-line-formula></paragraph>
<paragraph id="P-0418" lvl="7"><number>&lsqb;0418&rsqb;</number> and a public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&minus;k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(126) </in-line-formula></paragraph>
<paragraph id="P-0419" lvl="7"><number>&lsqb;0419&rsqb;</number> Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0420" lvl="0"><number>&lsqb;0420&rsqb;</number> (1) Following the operation by the sender and using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus <highlight><bold>100</bold></highlight> selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k&minus;</superscript></highlight>2 for a plaintext x&isin;&lcub;0, 1&rcub;<highlight><superscript>n </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus calculates and defines, as the ciphertext, </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;r</italic></highlight><highlight><superscript>2N</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight>&equals;(<highlight><italic>x&par;H</italic></highlight>(<highlight><italic>x&par;r</italic></highlight>))&oplus;<highlight><italic>G</italic></highlight>(<highlight><italic>r</italic></highlight>),&emsp;&emsp;(127) </in-line-formula></paragraph>
<paragraph id="P-0421" lvl="7"><number>&lsqb;0421&rsqb;</number> Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0422" lvl="0"><number>&lsqb;0422&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information (p, q) and the power multiplication unit <highlight><bold>202</bold></highlight>, the remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>),  
<math-cwu id="MATH-US-00045">
<number>45</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>r</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>r</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>128</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00045" file="US20030002662A1-20030102-M00045.NB"/>
<image id="EMI-M00045" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00045.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0423" lvl="7"><number>&lsqb;0423&rsqb;</number> and, of express &phgr;(r<highlight><subscript>1,p</subscript></highlight>, r<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;r<highlight><subscript>1,p</subscript></highlight>, r<highlight><subscript>1,q</subscript></highlight>), &phgr;(r<highlight><subscript>1,p, &minus;r</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;r<highlight><subscript>1,p</subscript></highlight>, &minus;r<highlight><subscript>1,q</subscript></highlight>), the apparatus sets an expression satisfying 0&amp;1t; r&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be r&prime; (where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by the Chinese remainder theorem, and more than one r&prime; may exist). Moreover, the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>x&prime;&par;w&prime;&equals;G</italic></highlight>(<highlight><italic>r</italic></highlight>&prime;)&oplus;<highlight><italic>y</italic></highlight><highlight><subscript>2&prime;</subscript></highlight>&emsp;&emsp;(129) </in-line-formula></paragraph>
<paragraph id="P-0424" lvl="7"><number>&lsqb;0424&rsqb;</number> (where, x&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, w&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>) and, based on  
<math-cwu id="MATH-US-00046">
<number>46</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mrow>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mi>x</mi>
                  <mi>&prime;</mi>
                </msup>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
            </mtr>
          </mtable>
          <mo>&it;</mo>
          <mtable>
            <mtr>
              <mtd>
                <mrow>
                  <mrow>
                    <mi>if</mi>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <msup>
                      <mi>&omega;</mi>
                      <mi>&prime;</mi>
                    </msup>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <mi>H</mi>
                    <mo>(</mo>
                    <mrow>
                      <mrow>
                        <msup>
                          <mi>x</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&it;</mo>
                        <mrow>
                          <mo>&LeftDoubleBracketingBar;</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                        </mrow>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>130</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00046" file="US20030002662A1-20030102-M00046.NB"/>
<image id="EMI-M00046" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00046.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0425" lvl="7"><number>&lsqb;0425&rsqb;</number> decrypts the ciphertext, thereby obtaining the plaintext (Here, it is stipulated that, in the case where x&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect). </paragraph>
<paragraph id="P-0426" lvl="0"><number>&lsqb;0426&rsqb;</number> Also, the secret key (p, q) can also be created from prime numbers p&prime;, q&prime;, using p&equals;2p&prime;&plus;1, q&equals;2q&prime;&plus;1. </paragraph>
<paragraph id="P-0427" lvl="0"><number>&lsqb;0427&rsqb;</number> In the public-key encryption method in the present embodiment, the value of d (d&gE;1) is set to be variable. Based on this condition, in the case where the bit length of the plaintext always remains short, the value of d is increased in a range where the unique factorization of n into its prime factors is difficult. This increase allows the decryption processing to be executed at a high-speed. </paragraph>
<paragraph id="P-0428" lvl="0"><number>&lsqb;0428&rsqb;</number> It can be demonstrated that, in the case of, e.g., d&equals;3, the complete cryptanalysis of the method according to the present embodiment is impossible on the premise of the difficulty in the unique factorization problem of n. Namely, if there exists an algorithm for solving the unique factorization problem of n, the utilization of the algorithm makes it possible to configure an algorithm for executing the complete cryptanalysis of the method according to the present embodiment. Also, if there exists the algorithm for executing the complete cryptanalysis of the method according to the present embodiment, the utilization of the algorithm makes it possible to configure the algorithm for solving the unique factorization problem of n. </paragraph>
<paragraph id="P-0429" lvl="7"><number>&lsqb;0429&rsqb;</number> (20th Embodiment) </paragraph>
<paragraph id="P-0430" lvl="0"><number>&lsqb;0430&rsqb;</number> In the present embodiment, the explanation will be given below regarding a modified example of the 4th embodiment. </paragraph>
<paragraph id="P-0431" lvl="7"><number>&lsqb;0431&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0432" lvl="0"><number>&lsqb;0432&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0433" lvl="7"><number>&lsqb;0433&rsqb;</number> a secret key p<highlight><subscript>i </subscript></highlight>(1&lE;i&lE;d) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>: prime numbers </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>&equiv;3(<highlight><italic>mod</italic></highlight>4) (1<highlight><italic>&lE;i&lE;d, d&gt;</italic></highlight>1)&emsp;&emsp;(131) </in-line-formula></paragraph>
<paragraph id="P-0434" lvl="7"><number>&lsqb;0434&rsqb;</number> and a public key (N, k, G, H) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;&Pi;</italic></highlight><highlight><subscript>i&equals;1</subscript></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>p</italic></highlight><highlight><subscript>i </subscript></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n </superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H</italic></highlight><highlight><subscript>1</subscript></highlight>:&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H</italic></highlight><highlight><subscript>2</subscript></highlight>&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(132) </in-line-formula></paragraph>
<paragraph id="P-0435" lvl="7"><number>&lsqb;0435&rsqb;</number> Also, the publication information is outputted via the communications line <highlight><bold>300</bold></highlight> or the like, then being sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or being published. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0436" lvl="0"><number>&lsqb;0436&rsqb;</number> (1) Following the operation by the sender and using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus <highlight><bold>100</bold></highlight> selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x&isin;&equals;&lcub;0, 1&rcub;<highlight><superscript>n </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s</italic></highlight>&equals;(<highlight><italic>x&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>))&par;<highlight><italic>H</italic></highlight><highlight><subscript>2</subscript></highlight>(<highlight><italic>x&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight><highlight><subscript>1</subscript></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(133) </in-line-formula></paragraph>
<paragraph id="P-0437" lvl="7"><number>&lsqb;0437&rsqb;</number> (where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&lE;log<highlight><subscript>2</subscript></highlight>(N&plus;1)), and further, defines </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN,</italic></highlight>&emsp;&emsp;(134) </in-line-formula></paragraph>
<paragraph id="P-0438" lvl="7"><number>&lsqb;0438&rsqb;</number> as the ciphertext. Moreover, the sender-side apparatus, using the communications apparatus <highlight><bold>106</bold></highlight>, transmits the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>) to the receiver-side apparatus <highlight><bold>200</bold></highlight> of the receiver via the communications line <highlight><bold>300</bold></highlight>. </paragraph>
<paragraph id="P-0439" lvl="0"><number>&lsqb;0439&rsqb;</number> (2) Following the operation by the receiver and using the above-described secret information (p, q) and the power multiplication unit <highlight><bold>202</bold></highlight>, the remainder arithmetic-operation unit <highlight><bold>203</bold></highlight>, and the arithmetic-operation unit <highlight><bold>204</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from the ciphertext (y<highlight><subscript>1</subscript></highlight>, y<highlight><subscript>2</subscript></highlight>),  
<math-cwu id="MATH-US-00047">
<number>47</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mrow>
            <mn>1</mn>
            <mo>,</mo>
            <msub>
              <mi>p</mi>
              <mi>i</mi>
            </msub>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow>
          <msubsup>
            <mi>y</mi>
            <mn>1</mn>
            <mfrac>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>p</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
              <mn>4</mn>
            </mfrac>
          </msubsup>
          <mo>&it;</mo>
          <msub>
            <mrow>
              <mi>mod</mi>
              <mo>&it;</mo>
              <mi>p</mi>
            </mrow>
            <mi>i</mi>
          </msub>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mn>1</mn>
              <mo>&leq;</mo>
              <mi>i</mi>
              <mo>&leq;</mo>
              <mi>d</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>135</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00047" file="US20030002662A1-20030102-M00047.NB"/>
<image id="EMI-M00047" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00047.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0440" lvl="7"><number>&lsqb;0440&rsqb;</number> and, of 2<highlight><superscript>d </superscript></highlight>expressions &phgr;(&plusmn;x<highlight><subscript>1,p1</subscript></highlight>, &plusmn;x<highlight><subscript>1,p2</subscript></highlight>, . . . , &plusmn;x<highlight><subscript>1,pd</subscript></highlight>) the apparatus sets an expression satisfying 0&amp;1t; w&prime;&amp;1t; N/2 to be w&prime; (Here, &phgr; designates a ring isomorphism mapping from Z/(p<highlight><subscript>1</subscript></highlight>)&times;Z/(p<highlight><subscript>2</subscript></highlight>)&times; . . . &times;Z/(p<highlight><subscript>d</subscript></highlight>) to Z/(N) by the Chinese remainder theorem. Also, more than one w&prime; may exist). Moreover, for w&prime;&equals;s<highlight><subscript>1</subscript></highlight>&prime;&par;s<highlight><subscript>2</subscript></highlight>&prime;&par;t&prime;(s<highlight><subscript>1</subscript></highlight>&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, s<highlight><subscript>2</subscript></highlight>&isin;&lcub;0, 1&rcub;<highlight><superscript>k1</superscript></highlight>, t&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>), the apparatus calculates </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight><highlight><subscript>1</subscript></highlight>(<highlight><italic>s</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&prime;&par;s</italic></highlight><highlight><subscript>2</subscript></highlight>&prime;)&oplus;<highlight><italic>t&prime;, x&prime;&equals;s</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&prime;&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>&prime;)&emsp;&emsp;(136) </in-line-formula></paragraph>
<paragraph id="P-0441" lvl="7"><number>&lsqb;0441&rsqb;</number> and, based on  
<math-cwu id="MATH-US-00048">
<number>48</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mrow>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mi>x</mi>
                  <mi>&prime;</mi>
                </msup>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
            </mtr>
          </mtable>
          <mo>&it;</mo>
          <mtable>
            <mtr>
              <mtd>
                <mrow>
                  <mrow>
                    <mi>if</mi>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <msubsup>
                      <mi>s</mi>
                      <mn>2</mn>
                      <mi>&prime;</mi>
                    </msubsup>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <msub>
                      <mi>H</mi>
                      <mn>2</mn>
                    </msub>
                    <mo>(</mo>
                    <mrow>
                      <mrow>
                        <msup>
                          <mi>x</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&it;</mo>
                        <mrow>
                          <mo>&LeftDoubleBracketingBar;</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                        </mrow>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>137</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00048" file="US20030002662A1-20030102-M00048.NB"/>
<image id="EMI-M00048" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00048.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0442" lvl="7"><number>&lsqb;0442&rsqb;</number> decrypts the ciphertext, thereby obtaining the plaintext (Here, it is stipulated that, in the case where x&prime;&equals;*, the receiver-side apparatus <highlight><bold>200</bold></highlight> denies the decryption of the ciphertext, and informs the operator of a notice to the effect). </paragraph>
<paragraph id="P-0443" lvl="0"><number>&lsqb;0443&rsqb;</number> Also, the secret key p, q can also be created from prime numbers p&prime;, q&prime;, using p&equals;2p&prime;&plus;1, q&equals;2q&prime;&plus;In the public-key encryption method in the present embodiment, the value of d (d &amp;gt; 1) is set to be variable. </paragraph>
<paragraph id="P-0444" lvl="0"><number>&lsqb;0444&rsqb;</number> It can be demonstrated that the complete cryptanalysis of the method according to the present embodiment is impossible on the premise of the difficulty in the unique factorization problem of n. Namely, if there exists an algorithm for solving the unique factorization problem of n, the utilization of the algorithm makes it possible to configure an algorithm for executing the complete cryptanalysis of the method according to the present embodiment. Also, if there exists the algorithm for executing the complete cryptanalysis of the method according to the present embodiment, the utilization of the algorithm makes it possible to configure the algorithm for solving the unique factorization problem of n. </paragraph>
<paragraph id="P-0445" lvl="0"><number>&lsqb;0445&rsqb;</number> As described above, in the present embodiment, the explanation has been given in the general scheme where the sender and the receiver perform the cipher communications with the use of the apparatuses of their own. Concretely, however, the method in the embodiment is applicable to various types of systems. </paragraph>
<paragraph id="P-0446" lvl="0"><number>&lsqb;0446&rsqb;</number> For example, in the electronic on-line shopping system, it turns out that the sender is a user, the sender-side apparatus is a computer such as a personal computer, the receiver is a retail shop, and the receiver-side apparatus is a computer such as a personal computer. At this time, in many cases, an order-form by the user concerning a commodity or the like is encrypted using a common-key cypher. The encryption key at that time is encrypted by the method according to the present embodiment, then being transmitted to the retail-shop-side apparatus. </paragraph>
<paragraph id="P-0447" lvl="0"><number>&lsqb;0447&rsqb;</number> Also, in the electronic mail system, the apparatuses of their own are computers such as personal computers and, in many cases, a transmission text (i.e., a mail) is encrypted using a common-key cypher. In that case, the common key is encrypted by the method according to the present embodiment, then being transmitted to the computer of the receiver. </paragraph>
<paragraph id="P-0448" lvl="0"><number>&lsqb;0448&rsqb;</number> In addition to the above-described various types of systems, the method in the present embodiment is also applicable to a variety of systems where the conventional public key encryption schemes have been used. </paragraph>
<paragraph id="P-0449" lvl="0"><number>&lsqb;0449&rsqb;</number> Although the respective calculations in the present embodiment have been explained on the assumption that the CPUs execute the respective programs stored in the memories, the following configuration is also allowable: The calculations are not entirely dependent on the programs, and instead, any one of the programs is replaced by an into-hardware-formed arithmetic-operation apparatus that performs data exchange with the other arithmetic-operation apparatuses and the CPUs. The application examples described herein are also in common in modified examples and 21st and 22nd embodiments that will be explained next. </paragraph>
<paragraph id="P-0450" lvl="0"><number>&lsqb;0450&rsqb;</number> Moreover, as a modified example of the public-key encryption method, the explanation will be given below concerning the following processing steps: At first, as the steps of the key generation, </paragraph>
<paragraph id="P-0451" lvl="7"><number>&lsqb;0451&rsqb;</number> a secret key (p, q) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(138) </in-line-formula></paragraph>
<paragraph id="P-0452" lvl="7"><number>&lsqb;0452&rsqb;</number> is created, and further, </paragraph>
<paragraph id="P-0453" lvl="7"><number>&lsqb;0453&rsqb;</number> a public key (N, k) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight>&emsp;&emsp;(139) </in-line-formula></paragraph>
<paragraph id="P-0454" lvl="7"><number>&lsqb;0454&rsqb;</number> is created, and </paragraph>
<paragraph id="P-0455" lvl="2"><number>&lsqb;0455&rsqb;</number> (1) the sender defines, for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>k&minus;</superscript></highlight>2)  
<math-cwu id="MATH-US-00049">
<number>49</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>1</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>x</mi>
              <mrow>
                <mn>2</mn>
                <mo>&it;</mo>
                <mi>N</mi>
              </mrow>
            </msup>
            <mo>&it;</mo>
            <mrow>
              <mi>mod</mi>
              <mo>&it;</mo>
              <mi>N</mi>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>2</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mi>x</mi>
              <mi>N</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>140</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00049" file="US20030002662A1-20030102-M00049.NB"/>
<image id="EMI-M00049" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00049.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0456" lvl="2"><number>&lsqb;0456&rsqb;</number> &emsp;as the ciphertext so as to transmit the ciphertext to the receiver-side apparatus <highlight><bold>200</bold></highlight> (where, a&equals;(m/N) designates the Jacobi symbol), and </paragraph>
<paragraph id="P-0457" lvl="2"><number>&lsqb;0457&rsqb;</number> (2) using the secret key (p, q) of the receiver, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from the ciphertext,  
<math-cwu id="MATH-US-00050">
<number>50</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mrow>
              <mi>mod</mi>
              <mo>&it;</mo>
              <mi>q</mi>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>141</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00050" file="US20030002662A1-20030102-M00050.NB"/>
<image id="EMI-M00050" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00050.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0458" lvl="2"><number>&lsqb;0458&rsqb;</number> &emsp;and, of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p, &minus;x</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), the apparatus defines, as the decryption result, an expression satisfying (x/N)&equals;y<highlight><subscript>3 </subscript></highlight>and 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>(where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by the Chinese remainder theorem). </paragraph>
<paragraph id="P-0459" lvl="0"><number>&lsqb;0459&rsqb;</number> Furthermore, as another modified example of the public-key encryption method, the explanation will be given below regarding the following another processing steps: </paragraph>
<paragraph id="P-0460" lvl="7"><number>&lsqb;0460&rsqb;</number> At first, as the steps of the key generation, </paragraph>
<paragraph id="P-0461" lvl="7"><number>&lsqb;0461&rsqb;</number> a secret key p<highlight><subscript>i </subscript></highlight>(1&lE;i&lE;d) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>: prime numbers </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>&equiv;3(<highlight><italic>mod</italic></highlight>4) (1<highlight><italic>&lE;i&lE;d, d&gt;</italic></highlight>1)&emsp;&emsp;(142) </in-line-formula></paragraph>
<paragraph id="P-0462" lvl="7"><number>&lsqb;0462&rsqb;</number> is created, and further, </paragraph>
<paragraph id="P-0463" lvl="7"><number>&lsqb;0463&rsqb;</number> a public key (N, k) given by </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;&Pi;</italic></highlight><highlight><subscript>i&equals;1</subscript></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>p</italic></highlight><highlight><subscript>i </subscript></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight>&emsp;&emsp;(143) </in-line-formula></paragraph>
<paragraph id="P-0464" lvl="7"><number>&lsqb;0464&rsqb;</number> is created, and </paragraph>
<paragraph id="P-0465" lvl="2"><number>&lsqb;0465&rsqb;</number> (1) the sender defines, for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>k</superscript></highlight>), </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;x</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN,</italic></highlight>&emsp;&emsp;(144) </in-line-formula></paragraph>
<paragraph id="P-0466" lvl="2"><number>&lsqb;0466&rsqb;</number> &emsp;as the ciphertext so as to transmit the ciphertext to the receiver-side apparatus <highlight><bold>200</bold></highlight>, and </paragraph>
<paragraph id="P-0467" lvl="2"><number>&lsqb;0467&rsqb;</number> (2) using the secret key p<highlight><subscript>i </subscript></highlight>of the receiver, the receiver-side apparatus <highlight><bold>200</bold></highlight> calculates, from the ciphertext,  
<math-cwu id="MATH-US-00051">
<number>51</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>1</mn>
                  <mo>,</mo>
                  <msub>
                    <mi>p</mi>
                    <mi>i</mi>
                  </msub>
                </mrow>
              </msub>
              <mo>=</mo>
              <mrow>
                <msubsup>
                  <mi>y</mi>
                  <mn>1</mn>
                  <mfrac>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mn>4</mn>
                  </mfrac>
                </msubsup>
                <mo>&it;</mo>
                <mi>m</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>o</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>d</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <msub>
                  <mi>p</mi>
                  <mi>i</mi>
                </msub>
              </mrow>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mn>1</mn>
                <mo>&leq;</mo>
                <mi>i</mi>
                <mo>&leq;</mo>
                <mi>d</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>145</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00051" file="US20030002662A1-20030102-M00051.NB"/>
<image id="EMI-M00051" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00051.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0468" lvl="2"><number>&lsqb;0468&rsqb;</number> &emsp;and, of 2<highlight><superscript>d </superscript></highlight>expressions &phgr;(&plusmn;x<highlight><subscript>1,p1</subscript></highlight>, &plusmn;x<highlight><subscript>1,p2</subscript></highlight>, . . . , &plusmn;x<highlight><subscript>1,pd</subscript></highlight>), the apparatus decrypts the ciphertext from an expression satisfying 0&amp;1t; x&prime;&amp;1t; N/2 (Here, &phgr; designates a ring isomorphism mapping from Z/(p<highlight><subscript>1</subscript></highlight>)&times;Z/(p<highlight><subscript>2</subscript></highlight>)&times; . . . &times;Z/(p<highlight><subscript>d</subscript></highlight>) to Z/(N) by the Chinese remainder theorem. Also, more than one x&prime; may exist), thereby securing the decryption&apos;s uniqueness. </paragraph>
<paragraph id="P-0469" lvl="7"><number>&lsqb;0469&rsqb;</number> (21st Embodiment) </paragraph>
<paragraph id="P-0470" lvl="0"><number>&lsqb;0470&rsqb;</number> In the present embodiment, the explanation will be given below concerning the case where, via a cipher communication, the sender of a plaintext (which is also referred to as &ldquo;message&rdquo;) transmits, to the receiver, the message becoming the transmission data. <cross-reference target="DRAWINGS">FIG. 16</cross-reference> is a diagram for illustrating the processing steps in the 21st embodiment. </paragraph>
<paragraph id="P-0471" lvl="7"><number>&lsqb;0471&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0472" lvl="0"><number>&lsqb;0472&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver creates, in advance, </paragraph>
<paragraph id="P-0473" lvl="2"><number>&lsqb;0473&rsqb;</number> (a) </paragraph>
<paragraph id="P-0474" lvl="7"><number>&lsqb;0474&rsqb;</number> a secret key (p, q) given by an expression (146): </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(146) </in-line-formula></paragraph>
<paragraph id="P-0475" lvl="2"><number>&lsqb;0475&rsqb;</number> &emsp;and further, creates </paragraph>
<paragraph id="P-0476" lvl="2"><number>&lsqb;0476&rsqb;</number> (b) a public key (N, k, G, H) given by an expression (147): </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(147) </in-line-formula></paragraph>
<paragraph id="P-0477" lvl="2"><number>&lsqb;0477&rsqb;</number> &emsp;and </paragraph>
<paragraph id="P-0478" lvl="3"><number>&lsqb;0478&rsqb;</number> (I) the sender-side apparatus selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), and </paragraph>
<paragraph id="P-0479" lvl="2"><number>&lsqb;0479&rsqb;</number> (c) calculates an expression (148): </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&equals;x</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(148) </in-line-formula></paragraph>
<paragraph id="P-0480" lvl="2"><number>&lsqb;0480&rsqb;</number> &emsp;(where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&equals;k), and further, </paragraph>
<paragraph id="P-0481" lvl="2"><number>&lsqb;0481&rsqb;</number> (d) calculates an expression (149): </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>w&equals;s&par;t,</italic></highlight>&emsp;&emsp;(149) </in-line-formula></paragraph>
<paragraph id="P-0482" lvl="2"><number>&lsqb;0482&rsqb;</number> &emsp;and </paragraph>
<paragraph id="P-0483" lvl="2"><number>&lsqb;0483&rsqb;</number> (e) calculates an expression (150): </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y&equals;w</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN</italic></highlight>&emsp;&emsp;(150) </in-line-formula></paragraph>
<paragraph id="P-0484" lvl="2"><number>&lsqb;0484&rsqb;</number> &emsp;and defines this result y as the ciphertext so as to transmit the ciphertext to the receiver-side apparatus, and </paragraph>
<paragraph id="P-0485" lvl="3"><number>&lsqb;0485&rsqb;</number> (II) the receiver-side apparatus, using the secret key (p, q) of itself, (f) calculates, from the ciphertext y, an expression (151):  
<math-cwu id="MATH-US-00052">
<number>52</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <msub>
              <mi>&alpha;</mi>
              <mn>0</mn>
            </msub>
            <mo>=</mo>
            <mrow>
              <msup>
                <mi>y</mi>
                <mfrac>
                  <mrow>
                    <mi>p</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                  <mn>4</mn>
                </mfrac>
              </msup>
              <mo>&it;</mo>
              <mi>m</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>o</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>d</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>p</mi>
            </mrow>
          </mrow>
          <mo>,</mo>
          <mstyle>
            <mtext>&NewLine;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mrow>
            <msub>
              <mi>&beta;</mi>
              <mn>0</mn>
            </msub>
            <mo>=</mo>
            <msub>
              <mi>&alpha;</mi>
              <mn>0</mn>
            </msub>
          </mrow>
          <mo>,</mo>
          <mstyle>
            <mtext>&NewLine;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mrow>
            <msub>
              <mi>&alpha;</mi>
              <mi>k</mi>
            </msub>
            <mo>=</mo>
            <mrow>
              <mfrac>
                <mn>1</mn>
                <mrow>
                  <mn>2</mn>
                  <mo>&it;</mo>
                  <msub>
                    <mi>&beta;</mi>
                    <mrow>
                      <mi>k</mi>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msub>
                </mrow>
              </mfrac>
              <mo>&it;</mo>
              <mrow>
                <mo>(</mo>
                <mfrac>
                  <mrow>
                    <mrow>
                      <mrow>
                        <mi>y</mi>
                        <mo>&it;</mo>
                        <mi>m</mi>
                      </mrow>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>&it;</mo>
                      <mi>o</mi>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>&it;</mo>
                      <mi>d</mi>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>&it;</mo>
                      <msup>
                        <mi>p</mi>
                        <mrow>
                          <mi>k</mi>
                          <mo>+</mo>
                          <mn>1</mn>
                        </mrow>
                      </msup>
                    </mrow>
                    <mo>-</mo>
                    <msubsup>
                      <mi>&beta;</mi>
                      <mrow>
                        <mi>k</mi>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mn>2</mn>
                    </msubsup>
                  </mrow>
                  <msup>
                    <mi>p</mi>
                    <mi>k</mi>
                  </msup>
                </mfrac>
                <mo>)</mo>
              </mrow>
              <mo>&it;</mo>
              <mi>m</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>o</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>d</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>p</mi>
            </mrow>
          </mrow>
          <mo>,</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>k</mi>
              <mo>&GreaterEqual;</mo>
              <mn>1</mn>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>&it;</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <mrow>
            <msub>
              <mi>&beta;</mi>
              <mi>k</mi>
            </msub>
            <mo>=</mo>
            <mrow>
              <munderover>
                <mo>&Sum;</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>0</mn>
                </mrow>
                <mi>k</mi>
              </munderover>
              <mo>&it;</mo>
              <mrow>
                <msub>
                  <mi>&alpha;</mi>
                  <mi>i</mi>
                </msub>
                <mo>&it;</mo>
                <msup>
                  <mi>p</mi>
                  <mi>i</mi>
                </msup>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>k</mi>
                    <mo>&GreaterEqual;</mo>
                    <mn>1</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mo>,</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>151</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00052" file="US20030002662A1-20030102-M00052.NB"/>
<image id="EMI-M00052" wi="216.027" he="76.0914" file="US20030002662A1-20030102-M00052.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0486" lvl="2"><number>&lsqb;0486&rsqb;</number> &emsp;and, using this result, </paragraph>
<paragraph id="P-0487" lvl="2"><number>&lsqb;0487&rsqb;</number> (g) calculates an expression (152):  
<math-cwu id="MATH-US-00053">
<number>53</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mi>p</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <munderover>
            <mo>&Sum;</mo>
            <mrow>
              <mi>i</mi>
              <mo>=</mo>
              <mn>0</mn>
            </mrow>
            <mrow>
              <mi>d</mi>
              <mo>-</mo>
              <mn>1</mn>
            </mrow>
          </munderover>
          <mo>&it;</mo>
          <mrow>
            <msub>
              <mi>&alpha;</mi>
              <mi>i</mi>
            </msub>
            <mo>&it;</mo>
            <msup>
              <mi>p</mi>
              <mi>i</mi>
            </msup>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>152</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00053" file="US20030002662A1-20030102-M00053.NB"/>
<image id="EMI-M00053" wi="216.027" he="25.9119" file="US20030002662A1-20030102-M00053.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0488" lvl="2"><number>&lsqb;0488&rsqb;</number> &emsp;and further, </paragraph>
<paragraph id="P-0489" lvl="2"><number>&lsqb;0489&rsqb;</number> (h) calculates an expression (153):  
<math-cwu id="MATH-US-00054">
<number>54</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mi>q</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <msup>
            <mi>y</mi>
            <mfrac>
              <mrow>
                <mi>q</mi>
                <mo>+</mo>
                <mn>1</mn>
              </mrow>
              <mn>4</mn>
            </mfrac>
          </msup>
          <mo>&it;</mo>
          <mi>m</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mi>o</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mi>d</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mi>q</mi>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>153</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00054" file="US20030002662A1-20030102-M00054.NB"/>
<image id="EMI-M00054" wi="216.027" he="15.11055" file="US20030002662A1-20030102-M00054.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0490" lvl="2"><number>&lsqb;0490&rsqb;</number> &emsp;and, concerning each of expressions &phgr;(x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>), and &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>) (where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by the Chinese remainder theorem), </paragraph>
<paragraph id="P-0491" lvl="2"><number>&lsqb;0491&rsqb;</number> (i) sets each of the expressions to be as given by an expression (154): </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&prime;&par;t&prime;</italic></highlight> (<highlight><italic>s&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>, t&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k0</superscript></highlight>)&emsp;&emsp;(154) </in-line-formula></paragraph>
<paragraph id="P-0492" lvl="2"><number>&lsqb;0492&rsqb;</number> &emsp;and </paragraph>
<paragraph id="P-0493" lvl="2"><number>&lsqb;0493&rsqb;</number> (j) calculates an expression (155): </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;, </italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>x&prime;&par;z&prime;&equals;s&prime;&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>&prime;) (<highlight><italic>x&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n</superscript></highlight><highlight><italic>, z&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>)&emsp;&emsp;(155) </in-line-formula></paragraph>
<paragraph id="P-0494" lvl="2"><number>&lsqb;0494&rsqb;</number> &emsp;and </paragraph>
<paragraph id="P-0495" lvl="2"><number>&lsqb;0495&rsqb;</number> (k) obtains the decryption result given by an expression (156):  
<math-cwu id="MATH-US-00055">
<number>55</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>x</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>if</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <msup>
                    <mi>z</mi>
                    <mi>&prime;</mi>
                  </msup>
                </mrow>
                <mo>=</mo>
                <msup>
                  <mn>0</mn>
                  <msub>
                    <mi>k</mi>
                    <mn>1</mn>
                  </msub>
                </msup>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>156</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00055" file="US20030002662A1-20030102-M00055.NB"/>
<image id="EMI-M00055" wi="216.027" he="23.04855" file="US20030002662A1-20030102-M00055.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0496" lvl="7"><number>&lsqb;0496&rsqb;</number> (Here, it is stipulated that, in the case where the decryption result is * (or invalid), the receiver-side apparatus denies the above-described ciphertext). </paragraph>
<paragraph id="P-0497" lvl="0"><number>&lsqb;0497&rsqb;</number> The secret key (p, q) can also be created from prime numbers p&prime;, q&prime;, using p&equals;2p&prime;&plus;1, q&equals;2q&prime;&plus;1. </paragraph>
<paragraph id="P-0498" lvl="0"><number>&lsqb;0498&rsqb;</number> In the public-key encryption method in the present embodiment, the value of d (d&gE;1) can be modified. For example, in the case where the bit length of the plaintext always remains short, the value of d is increased in a range where the unique factorization of n into its prime factors is difficult. This increase allows the decryption processing to be executed at a high-speed. </paragraph>
<paragraph id="P-0499" lvl="0"><number>&lsqb;0499&rsqb;</number> The public-key encryption method according to the present embodiment can be proved to be semantically-secure against the chosen-ciphertext attack on the premise of the difficulty in the unique factorization problem of N. The outline of the proof is as follows: </paragraph>
<paragraph id="P-0500" lvl="0"><number>&lsqb;0500&rsqb;</number> Assuming that there should exist an algorithm that is capable of breaking the public-key encryption method according to the present embodiment (in the meaning of the semantical-security in the adaptive chosen-ciphertext attack, and the definition thereof has been described in, e.g., the literature 14), the use of the algorithm allows the construction of an algorithm for executing the unique factorization of N into its prime factors. This makes it possible to prove that the public-key encryption method in the present embodiment is IND-CCA2 on the premise of the difficulty in the unique factorization problem. </paragraph>
<paragraph id="P-0501" lvl="0"><number>&lsqb;0501&rsqb;</number> In the present embodiment, information indicating a large-or-small relationship between the value of w and that of N/2, e.g., &minus;1 or 1 when the value of w is smaller or larger than that of N/2, respectively, may be published by the sender-side apparatus <highlight><bold>100</bold></highlight> or may be transmitted to the receiver-side apparatus <highlight><bold>200</bold></highlight> by the sender-side apparatus. The receiver-side apparatus <highlight><bold>200</bold></highlight> uses the above-described information in the decryption processing, thereby making it possible to limit the 4 expressions, i.e., &phgr;(x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>), and &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>) into 2 expressions. When d is an odd number, the sender-side apparatus publishes the Jacobi symbol (i.e., w/N) or transmits the Jacobi symbol to the receiver-side apparatus, thereby calculating the values of the Jacobi symbols for &phgr;(x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>), and &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>). This also makes it possible to limit the 4 expressions into 2 expressions. These devices permit the efficiency to be enhanced in the decryption processing. </paragraph>
<paragraph id="P-0502" lvl="0"><number>&lsqb;0502&rsqb;</number> The definition and the calculating method of the Jacobi symbol have been described in, e.g., the literature 16: &ldquo;A. J. Menezes, P. C. van Oorschot, S. A. Vanstone: Jacobi Symbol: Definition &amp; Algorithm, Handbook of Applied Cryptography, CRC Press, pp. 73, (1996)&rdquo;, or the literature 17: &ldquo;H. Cohen: Jacobi Symbol: Definition &amp; Algorithm, A Course in Computational Algebraic Number Theory, Graduate Texts in Math. 138, Springer-Verlag, New York, pp. 27-31, (1993)&rdquo;. </paragraph>
<paragraph id="P-0503" lvl="0"><number>&lsqb;0503&rsqb;</number> The public-key encryption method according to the present embodiment is also usable simultaneously with a common-key cypher with the objective of distributing the data encryption key in the common-key cypher. </paragraph>
<paragraph id="P-0504" lvl="0"><number>&lsqb;0504&rsqb;</number> In the present embodiment, the method of calculating the expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p, &minus;x</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>) from the ciphertext y also provides a high-speed calculation method of determining a square root with N&equals;p<highlight><superscript>d</superscript></highlight>q as the modulus. This calculation method is applicable to another system for performing a calculation of determining a square root (or an m-th power root) with N&equals;p<highlight><superscript>d</superscript></highlight>q as the modulus, thereby allowing the system to execute a high-speed calculation of the power root. </paragraph>
<paragraph id="P-0505" lvl="7"><number>&lsqb;0505&rsqb;</number> (22nd Embodiment) </paragraph>
<paragraph id="P-0506" lvl="0"><number>&lsqb;0506&rsqb;</number> In the present embodiment, there is provided a modified example of the 21st embodiment. <cross-reference target="DRAWINGS">FIG. 17</cross-reference> is a diagram for illustrating the processing steps in the 22nd embodiment. </paragraph>
<paragraph id="P-0507" lvl="7"><number>&lsqb;0507&rsqb;</number> 1. Key Generation Processing </paragraph>
<paragraph id="P-0508" lvl="0"><number>&lsqb;0508&rsqb;</number> Using the key generation unit <highlight><bold>201</bold></highlight> in the receiver-side apparatus <highlight><bold>200</bold></highlight>, the receiver-side apparatus <highlight><bold>200</bold></highlight> creates, in advance, </paragraph>
<paragraph id="P-0509" lvl="2"><number>&lsqb;0509&rsqb;</number> a secret key (p, q) given by an expression (157), and creates </paragraph>
<paragraph id="P-0510" lvl="2"><number>&lsqb;0510&rsqb;</number> a public key (N, k, G, H) given by an expression (158). Here, it is stipulated that the manager of the present system or the receiver-side apparatus has determined the value of d in advance or as required, and that the above-described key generation unit fetches the value. </paragraph>
<paragraph id="P-0511" lvl="0"><number>&lsqb;0511&rsqb;</number> The publication information is sent to the sender-side apparatus <highlight><bold>100</bold></highlight> or is published via the Ad communications line <highlight><bold>300</bold></highlight> or the like. As the publishing method, the well-known method, e.g., the registration into the third party (i.e., the publication information management institution), is available. The other information is stored into the memory <highlight><bold>205</bold></highlight>. 2. Encryption/Decryption Processing </paragraph>
<paragraph id="P-0512" lvl="0"><number>&lsqb;0512&rsqb;</number> (1) Following the operation by the sender and using the random-number generation unit <highlight><bold>101</bold></highlight>, the sender-side apparatus <highlight><bold>100</bold></highlight> selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x&isin;&lcub;0, 1&rcub;<highlight><superscript>n </superscript></highlight>and, using the arithmetic-operation unit <highlight><bold>103</bold></highlight>, the power multiplication unit <highlight><bold>102</bold></highlight>, and the remainder arithmetic-operation unit <highlight><bold>104</bold></highlight>, the sender-side apparatus creates </paragraph>
<paragraph id="P-0513" lvl="2"><number>&lsqb;0513&rsqb;</number> (a) the secret key (p, q) given by an expression (157): </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(157) </in-line-formula></paragraph>
<paragraph id="P-0514" lvl="2"><number>&lsqb;0514&rsqb;</number> &emsp;and further, creates </paragraph>
<paragraph id="P-0515" lvl="2"><number>&lsqb;0515&rsqb;</number> (b) the public key (N, k, G, H) given by an expression (158): </paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n </superscript></highlight>hash function, </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>&bull;<highlight><italic>H&prime;</italic></highlight>:&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(158) </in-line-formula></paragraph>
<paragraph id="P-0516" lvl="2"><number>&lsqb;0516&rsqb;</number> &emsp;and </paragraph>
<paragraph id="P-0517" lvl="3"><number>&lsqb;0517&rsqb;</number> (I) the sender-side apparatus selects the random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for the plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), and </paragraph>
<paragraph id="P-0518" lvl="2"><number>&lsqb;0518&rsqb;</number> (c) calculates an expression (159): </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&prime;&equals;</italic></highlight>(<highlight><italic>x&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>))&par;<highlight><italic>H</italic></highlight>&prime;(<highlight><italic>x&par;r</italic></highlight>), </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(159) </in-line-formula></paragraph>
<paragraph id="P-0519" lvl="2"><number>&lsqb;0519&rsqb;</number> &emsp;(where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&equals;k), and further, </paragraph>
<paragraph id="P-0520" lvl="2"><number>&lsqb;0520&rsqb;</number> (d) calculates an expression (160): </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>w&equals;s&par;t,</italic></highlight>&emsp;&emsp;(160) </in-line-formula></paragraph>
<paragraph id="P-0521" lvl="2"><number>&lsqb;0521&rsqb;</number> &emsp;and </paragraph>
<paragraph id="P-0522" lvl="2"><number>&lsqb;0522&rsqb;</number> (e) calculates an expression (161): </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>y&equals;w</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN</italic></highlight>&emsp;&emsp;(161) </in-line-formula></paragraph>
<paragraph id="P-0523" lvl="2"><number>&lsqb;0523&rsqb;</number> &emsp;and defines this result y as the ciphertext so as to transmit the ciphertext to the receiver-side apparatus <highlight><bold>200</bold></highlight>, and </paragraph>
<paragraph id="P-0524" lvl="3"><number>&lsqb;0524&rsqb;</number> (II) the receiver-side apparatus <highlight><bold>200</bold></highlight>, using the secret key (p, q) of itself, </paragraph>
<paragraph id="P-0525" lvl="2"><number>&lsqb;0525&rsqb;</number> (f) calculates, from the ciphertext, an expression (162):  
<math-cwu id="MATH-US-00056">
<number>56</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>&alpha;</mi>
            <mn>0</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>y</mi>
              <mfrac>
                <mrow>
                  <mi>p</mi>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>&beta;</mi>
            <mn>0</mn>
          </msub>
          <mo>=</mo>
          <msub>
            <mi>&alpha;</mi>
            <mn>0</mn>
          </msub>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>&alpha;</mi>
            <mi>k</mi>
          </msub>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mn>1</mn>
              <mrow>
                <mn>2</mn>
                <mo>&it;</mo>
                <msub>
                  <mi>&beta;</mi>
                  <mrow>
                    <mi>k</mi>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
              </mrow>
            </mfrac>
            <mo>&it;</mo>
            <mrow>
              <mo>(</mo>
              <mfrac>
                <mrow>
                  <mrow>
                    <mrow>
                      <mi>y</mi>
                      <mo>&it;</mo>
                      <mi>m</mi>
                    </mrow>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <mi>o</mi>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <mi>d</mi>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <msup>
                      <mi>p</mi>
                      <mrow>
                        <mi>k</mi>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                    </msup>
                  </mrow>
                  <mo>-</mo>
                  <msubsup>
                    <mi>&beta;</mi>
                    <mrow>
                      <mi>k</mi>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                    <mn>2</mn>
                  </msubsup>
                </mrow>
                <msup>
                  <mi>p</mi>
                  <mi>k</mi>
                </msup>
              </mfrac>
              <mo>)</mo>
            </mrow>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>&beta;</mi>
            <mi>k</mi>
          </msub>
          <mo>=</mo>
          <mrow>
            <munderover>
              <mo>&Sum;</mo>
              <mrow>
                <mi>i</mi>
                <mo>=</mo>
                <mn>0</mn>
              </mrow>
              <mi>k</mi>
            </munderover>
            <mo>&it;</mo>
            <mrow>
              <msub>
                <mi>&alpha;</mi>
                <mi>i</mi>
              </msub>
              <mo>&it;</mo>
              <msup>
                <mi>p</mi>
                <mi>i</mi>
              </msup>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>k</mi>
                  <mo>&GreaterEqual;</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>162</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00056" file="US20030002662A1-20030102-M00056.NB"/>
<image id="EMI-M00056" wi="216.027" he="76.0914" file="US20030002662A1-20030102-M00056.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0526" lvl="2"><number>&lsqb;0526&rsqb;</number> &emsp;and, using this result, </paragraph>
<paragraph id="P-0527" lvl="2"><number>&lsqb;0527&rsqb;</number> (g) calculates an expression (163):  
<math-cwu id="MATH-US-00057">
<number>57</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mi>p</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <munderover>
            <mo>&Sum;</mo>
            <mrow>
              <mi>i</mi>
              <mo>=</mo>
              <mn>0</mn>
            </mrow>
            <mrow>
              <mi>d</mi>
              <mo>-</mo>
              <mn>1</mn>
            </mrow>
          </munderover>
          <mo>&it;</mo>
          <mrow>
            <msub>
              <mi>&alpha;</mi>
              <mi>i</mi>
            </msub>
            <mo>&it;</mo>
            <msup>
              <mi>p</mi>
              <mi>i</mi>
            </msup>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>163</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00057" file="US20030002662A1-20030102-M00057.NB"/>
<image id="EMI-M00057" wi="216.027" he="25.9119" file="US20030002662A1-20030102-M00057.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0528" lvl="2"><number>&lsqb;0528&rsqb;</number> &emsp;and further, </paragraph>
<paragraph id="P-0529" lvl="2"><number>&lsqb;0529&rsqb;</number> (h) calculates an expression (164):  
<math-cwu id="MATH-US-00058">
<number>58</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mi>q</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <msup>
            <mi>y</mi>
            <mfrac>
              <mrow>
                <mi>q</mi>
                <mo>+</mo>
                <mn>1</mn>
              </mrow>
              <mn>4</mn>
            </mfrac>
          </msup>
          <mo>&it;</mo>
          <mi>m</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mi>o</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mi>d</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mi>q</mi>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>164</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00058" file="US20030002662A1-20030102-M00058.NB"/>
<image id="EMI-M00058" wi="216.027" he="15.11055" file="US20030002662A1-20030102-M00058.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0530" lvl="2"><number>&lsqb;0530&rsqb;</number> &emsp;and, concerning each of expressions &phgr;(x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>), and &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>) (where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by the Chinese remainder theorem), </paragraph>
<paragraph id="P-0531" lvl="2"><number>&lsqb;0531&rsqb;</number> (i) sets each of the expressions to be as given by an expression (165): </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>s&prime;&par;z&prime;&par;t&prime; </italic></highlight>(<highlight><italic>s&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n</superscript></highlight><highlight><italic>, z&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>, t&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>)&emsp;&emsp;(165) </in-line-formula></paragraph>
<paragraph id="P-0532" lvl="2"><number>&lsqb;0532&rsqb;</number> &emsp;and </paragraph>
<paragraph id="P-0533" lvl="2"><number>&lsqb;0533&rsqb;</number> (j) calculates an expression (166): </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s&prime;&par;z&prime;</italic></highlight>)&oplus;<highlight><italic>t&prime;, </italic></highlight></in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>x&prime;&equals;s&prime;&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>&prime;) (<highlight><italic>x&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n</superscript></highlight>)&emsp;&emsp;(166) </in-line-formula></paragraph>
<paragraph id="P-0534" lvl="2"><number>&lsqb;0534&rsqb;</number> &emsp;and </paragraph>
<paragraph id="P-0535" lvl="2"><number>&lsqb;0535&rsqb;</number> (k) obtains the decryption result given by an expression (167):  
<math-cwu id="MATH-US-00059">
<number>59</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>x</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mi>if</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mrow>
                  <msup>
                    <mi>H</mi>
                    <mi>&prime;</mi>
                  </msup>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <msup>
                        <mi>x</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&it;</mo>
                      <mrow>
                        <mo>&LeftDoubleBracketingBar;</mo>
                        <mstyle>
                          <mtext>&emsp;</mtext>
                        </mstyle>
                        <mo>&it;</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                    <mo>=</mo>
                    <msup>
                      <mi>z</mi>
                      <mi>&prime;</mi>
                    </msup>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>167</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00059" file="US20030002662A1-20030102-M00059.NB"/>
<image id="EMI-M00059" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00059.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0536" lvl="7"><number>&lsqb;0536&rsqb;</number> (Here, it is stipulated that, in the case where the decryption result is *, the receiver-side apparatus denies the above-described ciphertext). </paragraph>
<paragraph id="P-0537" lvl="0"><number>&lsqb;0537&rsqb;</number> Also, the secret key (p, q) can also be created from prime numbers p&prime;, q&prime;, using p&equals;2p&prime;&plus;1, q&equals;2q&prime;&plus;1. </paragraph>
<paragraph id="P-0538" lvl="0"><number>&lsqb;0538&rsqb;</number> In the public-key encryption method in the present embodiment, the value of d (d&gE;1) can be modified. For example, in the case where the bit length of the plaintext always remains short, the value of d is increased in a range where the unique factorization of n into its prime factors is difficult. This increase allows the decryption processing to be executed at a high-speed. </paragraph>
<paragraph id="P-0539" lvl="0"><number>&lsqb;0539&rsqb;</number> As is the case with the 21st embodiment, the method according to the present embodiment can be proved to be IND-CCA2 on the premise of the difficulty in the unique factorization problem of N. </paragraph>
<paragraph id="P-0540" lvl="0"><number>&lsqb;0540&rsqb;</number> As is the case with the 21st embodiment, with the objective of limiting the expressions, i.e., &phgr;(x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>), and &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>) in the decryption processing, it is also possible to publish or transmit the values of the Jacobi symbols (w/N), or to publish or transmit the information indicating the large-or-small relationship between the value of w and that of N/2. </paragraph>
<paragraph id="P-0541" lvl="0"><number>&lsqb;0541&rsqb;</number> The public-key encryption method according to the present embodiment is also usable simultaneously with a common-key cypher with the objective of distributing the data encryption key in the common-key cypher. </paragraph>
<paragraph id="P-0542" lvl="0"><number>&lsqb;0542&rsqb;</number> It will be further understood by those skilled in the art that the foregoing description has been made on embodiments of the invention and that various changes and modifications may be made in the invention without departing from the spirit of the invention and scope of the appended claims. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is claimed is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. A public-key encryption method where a creator of a ciphertext creates said ciphertext by using a public key of a receiver of said ciphertext and a receiver-side apparatus of said ciphertext decrypts said ciphertext by using a secret key of said receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>defining </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>f:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>one-way trapdoor permutation, </in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(1) </in-line-formula></claim-text>
<claim-text>&emsp;as said public key, and </claim-text>
<claim-text>defining </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>:&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>Trapdoor function&emsp;&emsp;(2) </in-line-formula></claim-text>
<claim-text>&emsp;as said secret key where, k&equals;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&plus;n, wherein 
<claim-text>a sender-side apparatus of said ciphertext, in accordance with an operation by said sender, </claim-text>
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x&isin;&lcub;0, 1&rcub;n, and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;x</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(3) </in-line-formula></claim-text>
</claim-text>
</claim-text>
<claim-text>and further, 
<claim-text>defines </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;f</italic></highlight>(<highlight><italic>s</italic></highlight>), <highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(4) </in-line-formula></claim-text>
<claim-text>&emsp;as said ciphertext so as to transmit said ciphertext to said receiver-side apparatus, 
<claim-text>said receiver-side apparatus, using said secret key of said receiver, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>s&prime;&equals;f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>(<highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight>), <highlight><italic>t&prime;&equals;y</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(5) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(6) </in-line-formula></claim-text>
<claim-text>&emsp;and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00060">
<number>60</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>x</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>[</mo>
                    <mrow>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&CirclePlus;</mo>
                      <mrow>
                        <mi>G</mi>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>]</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <mrow>
                    <msub>
                      <mrow>
                        <mi>if</mi>
                        <mo>&it;</mo>
                        <mstyle>
                          <mtext>&emsp;</mtext>
                        </mstyle>
                        <mo>[</mo>
                        <mrow>
                          <msup>
                            <mi>s</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>&CirclePlus;</mo>
                          <mrow>
                            <mi>G</mi>
                            <mo>&af;</mo>
                            <mrow>
                              <mo>(</mo>
                              <msup>
                                <mi>r</mi>
                                <mi>&prime;</mi>
                              </msup>
                              <mo>)</mo>
                            </mrow>
                          </mrow>
                        </mrow>
                        <mo>]</mo>
                      </mrow>
                      <msub>
                        <mi>k</mi>
                        <mn>1</mn>
                      </msub>
                    </msub>
                    <mo>=</mo>
                    <msup>
                      <mn>0</mn>
                      <msub>
                        <mi>k</mi>
                        <mn>1</mn>
                      </msub>
                    </msup>
                  </mrow>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>7</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00060" file="US20030002662A1-20030102-M00060.NB"/>
<image id="EMI-M00060" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00060.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;decrypting said ciphertext where, it is stipulated that, in a case where x&prime;&equals;*, said receiver-side apparatus denies said ciphertext, and &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate more-significant and less-significant n bits of a, respectively. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. A public-key encryption method where a sender encrypts transmission data by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(8) </in-line-formula></claim-text>
</claim-text>
<claim-text>and further, 
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(9) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender 
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;x</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(10) </in-line-formula></claim-text>
<claim-text>&emsp;where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&amp;1t; k&minus;2, and further, </claim-text>
<claim-text>defines </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00061">
<number>61</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>1</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>s</mi>
              <mrow>
                <mn>2</mn>
                <mo>&it;</mo>
                <mi>N</mi>
              </mrow>
            </msup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>N</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>2</mn>
          </msub>
          <mo>=</mo>
          <mi>t</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>3</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mi>s</mi>
              <mi>N</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>11</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00061" file="US20030002662A1-20030102-M00061.NB"/>
<image id="EMI-M00061" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00061.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;as a ciphertext so as to transmit said ciphertext to a receiver-side apparatus where, a&equals;(m/N) designates a Jacobi symbol, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key (p, q) of said receiver, 
<claim-text>calculating, from said ciphertext, </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00062">
<number>62</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>12</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00062" file="US20030002662A1-20030102-M00062.NB"/>
<image id="EMI-M00062" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00062.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p, &minus;x</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), </claim-text>
<claim-text>setting an expression satisfying (x/N)&equals;y<highlight><subscript>3 </subscript></highlight>and 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by Chinese remainder theorem, and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(13) </in-line-formula></claim-text>
<claim-text>&emsp;and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00063">
<number>63</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>x</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>[</mo>
                    <mrow>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&CirclePlus;</mo>
                      <mrow>
                        <mi>G</mi>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>]</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mrow>
                      <mi>if</mi>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>[</mo>
                      <mrow>
                        <msup>
                          <mi>s</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&CirclePlus;</mo>
                        <mrow>
                          <mi>G</mi>
                          <mo>&af;</mo>
                          <mrow>
                            <mo>(</mo>
                            <msup>
                              <mi>r</mi>
                              <mi>&prime;</mi>
                            </msup>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo>]</mo>
                    </mrow>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msub>
                  <mo>=</mo>
                  <msup>
                    <mn>0</mn>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>14</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00063" file="US20030002662A1-20030102-M00063.NB"/>
<image id="EMI-M00063" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00063.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;decrypting said ciphertext where, it is stipulated that, in a case where x&prime;&equals;*, said receiver-side apparatus denies said ciphertext, and &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate more-significant and less-significant n bits of a, respectively. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. A public-key encryption method where a sender encrypts transmission data by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(15) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key (N, k, G, H) given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d&gE;</italic></highlight>1) </in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(16) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender 
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;x</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(17) </in-line-formula></claim-text>
<claim-text>&emsp;where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&amp;1t; k&minus;2, and further, </claim-text>
<claim-text>defines </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(18) </in-line-formula></claim-text>
<claim-text>&emsp;as a ciphertext so as to transmit said ciphertext to a receiver-side apparatus, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key (p, q) of said receiver, 
<claim-text>calculating, from said ciphertext, </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00064">
<number>64</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>19</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00064" file="US20030002662A1-20030102-M00064.NB"/>
<image id="EMI-M00064" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00064.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p, &minus;x</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), </claim-text>
<claim-text>setting an expression satisfying 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; where, <highlight><bold>100</bold></highlight> designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by Chinese remainder theorem, and more than one s&prime; may exist, and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(20) </in-line-formula></claim-text>
<claim-text>&emsp;and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00065">
<number>65</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>x</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>[</mo>
                    <mrow>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&CirclePlus;</mo>
                      <mrow>
                        <mi>G</mi>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>]</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mrow>
                      <mi>if</mi>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>[</mo>
                      <mrow>
                        <msup>
                          <mi>s</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&CirclePlus;</mo>
                        <mrow>
                          <mi>G</mi>
                          <mo>&af;</mo>
                          <mrow>
                            <mo>(</mo>
                            <msup>
                              <mi>r</mi>
                              <mi>&prime;</mi>
                            </msup>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo>]</mo>
                    </mrow>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msub>
                  <mo>=</mo>
                  <msup>
                    <mn>0</mn>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>21</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00065" file="US20030002662A1-20030102-M00065.NB"/>
<image id="EMI-M00065" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00065.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;decrypting said ciphertext where, it is stipulated that, in a case where x&prime;&equals;*, said receiver-side apparatus (<highlight><bold>200</bold></highlight>) denies said ciphertext, and &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate more-significant and less-significant n bits of a, respectively. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00005">claim 5</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. A public-key encryption method where a sender encrypts transmission data by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key p<highlight><subscript>i </subscript></highlight>(1&lE;i&lE;d) given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>: prime numbers </in-line-formula><in-line-formula><highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>&equiv;3(<highlight><italic>mod</italic></highlight>4) (1<highlight><italic>&lE;i&lE;d, d&gt;</italic></highlight>1)&emsp;&emsp;(22) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;&Pi;</italic></highlight><highlight><subscript>i&equals;1</subscript></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>p</italic></highlight><highlight><subscript>i </subscript></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(23) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender 
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;x</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(24) </in-line-formula></claim-text>
<claim-text>&emsp;where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&lE;log<highlight><subscript>2</subscript></highlight>(N&plus;1), and further, </claim-text>
<claim-text>defines </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(25) </in-line-formula></claim-text>
<claim-text>&emsp;as a ciphertext so as to transmit said ciphertext to a receiver-side apparatus, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating, from said ciphertext, </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00066">
<number>66</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mrow>
            <mn>1</mn>
            <mo>,</mo>
            <mi>pi</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow>
          <msubsup>
            <mi>y</mi>
            <mn>1</mn>
            <mfrac>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>p</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
              <mn>4</mn>
            </mfrac>
          </msubsup>
          <mo>&it;</mo>
          <mi>mod</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mrow>
            <msub>
              <mi>p</mi>
              <mi>i</mi>
            </msub>
            <mo>&af;</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mn>1</mn>
                <mo>&leq;</mo>
                <mi>i</mi>
                <mo>&leq;</mo>
                <mi>d</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>26</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00066" file="US20030002662A1-20030102-M00066.NB"/>
<image id="EMI-M00066" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00066.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of 2<highlight><superscript>d </superscript></highlight>expressions &phgr;(&plusmn;x<highlight><subscript>1,p1</subscript></highlight>, &plusmn;x<highlight><subscript>1,p2</subscript></highlight>, . . . , &plusmn;x<highlight><subscript>1,pd</subscript></highlight>), setting an expression satisfying 0&amp;1t; s&prime;&amp;1t; N/2 to be s&prime; (where, &phgr; designates a ring isomorphism mapping from Z/(p<highlight><subscript>1</subscript></highlight>)&times;Z/(p<highlight><subscript>2</subscript></highlight>)&times; . . . &times;Z/(p<highlight><subscript>d</subscript></highlight>) to Z/(N) by Chinese remainder theorem, and also more than one s&prime; may exist), and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(27) </in-line-formula></claim-text>
<claim-text>&emsp;and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00067">
<number>67</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>x</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>[</mo>
                    <mrow>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&CirclePlus;</mo>
                      <mrow>
                        <mi>G</mi>
                        <mo>&af;</mo>
                        <mrow>
                          <mo>(</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>]</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mrow>
                      <mi>if</mi>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>[</mo>
                      <mrow>
                        <msup>
                          <mi>s</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&CirclePlus;</mo>
                        <mrow>
                          <mi>G</mi>
                          <mo>&af;</mo>
                          <mrow>
                            <mo>(</mo>
                            <msup>
                              <mi>r</mi>
                              <mi>&prime;</mi>
                            </msup>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo>]</mo>
                    </mrow>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msub>
                  <mo>=</mo>
                  <msup>
                    <mn>0</mn>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>28</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00067" file="US20030002662A1-20030102-M00067.NB"/>
<image id="EMI-M00067" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00067.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;decrypting said ciphertext where, it is stipulated that, in a case where x&prime;&equals;*, said receiver-side apparatus denies said ciphertext, and &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate more-significant and less-significant n bits of a, respectively. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, further comprising a step at which, as said prime numbers constituting said secret key, prime numbers of a form of 2p&prime;&plus;1 are selected with respect to another prime numbers p&prime;. </claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein a value of d (d&gE;1) is set to be variable. </claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. A cipher communication method where a sender performs distribution of a data encryption key by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>defining </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>f:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>one-way trapdoor permutation, </in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(29) </in-line-formula></claim-text>
<claim-text>&emsp;as said public key, and </claim-text>
<claim-text>defining </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>:&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>trapdoor function&emsp;&emsp;(30) </in-line-formula></claim-text>
<claim-text>&emsp;as a secret key where, k&equals;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&plus;n, wherein 
<claim-text>(1) said sender, using said data encryption key K (&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), 
<claim-text>encrypts transmission data m so as to create a ciphertext C, and also said sender </claim-text>
<claim-text>selects a random number r&isin;&lcub;O. <highlight><subscript>1</subscript></highlight>&rcub;k&equals;, and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;K</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(31) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;f</italic></highlight>(<highlight><italic>s</italic></highlight>), <highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(32) </in-line-formula></claim-text>
<claim-text>&emsp;and </claim-text>
<claim-text>transmits to a receiver-side apparatus along with C, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>s&prime;&equals;f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>(<highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight>), <highlight><italic>t&prime;&equals;y</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(33) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(34) </in-line-formula></claim-text>
<claim-text>&emsp;and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00068">
<number>68</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>K</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mo>[</mo>
                      <mrow>
                        <msup>
                          <mi>s</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&CirclePlus;</mo>
                        <mrow>
                          <mi>G</mi>
                          <mo>&af;</mo>
                          <mrow>
                            <mo>(</mo>
                            <msup>
                              <mi>r</mi>
                              <mi>&prime;</mi>
                            </msup>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo>]</mo>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mrow>
                      <mi>if</mi>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>[</mo>
                      <mrow>
                        <msup>
                          <mi>s</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&CirclePlus;</mo>
                        <mrow>
                          <mi>G</mi>
                          <mo>&af;</mo>
                          <mrow>
                            <mo>(</mo>
                            <msup>
                              <mi>r</mi>
                              <mi>&prime;</mi>
                            </msup>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo>]</mo>
                    </mrow>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msub>
                  <mo>=</mo>
                  <msup>
                    <mn>0</mn>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>35</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00068" file="US20030002662A1-20030102-M00068.NB"/>
<image id="EMI-M00068" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00068.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;calculating K&prime; where, it is stipulated that, in a case where K&prime;&equals;*, said receiver-side apparatus denies said ciphertext, and &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate more-significant and less-significant n bits of a, respectively, and further, </claim-text>
<claim-text>said receiver-side apparatus, using K&prime;, </claim-text>
<claim-text>performing decryption of said ciphertext C. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. The cipher communication method as claimed in <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. A cipher communication method where a sender performs distribution of a data encryption key by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(36) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(37) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender, using said data encryption key K (&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), 
<claim-text>encrypts transmission data m so as to create a ciphertext C, and also said sender </claim-text>
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>, and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;K</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(38) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>calculates </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00069">
<number>69</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>1</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>s</mi>
              <mrow>
                <mn>2</mn>
                <mo>&it;</mo>
                <mi>N</mi>
              </mrow>
            </msup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>N</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>2</mn>
          </msub>
          <mo>=</mo>
          <mi>t</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>3</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mi>s</mi>
              <mi>N</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>39</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00069" file="US20030002662A1-20030102-M00069.NB"/>
<image id="EMI-M00069" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00069.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;(where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&amp;1t; k&minus;2), and </claim-text>
<claim-text>transmits to a receiver-side apparatus along with C (where, a&equals;(m/N) designates a Jacobi symbol), </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00070">
<number>70</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>40</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00070" file="US20030002662A1-20030102-M00070.NB"/>
<image id="EMI-M00070" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00070.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p, &minus;x</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), </claim-text>
<claim-text>setting an expression satisfying (x/N)&equals;y<highlight><subscript>3 </subscript></highlight>and 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by Chinese remainder theorem, and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(41) </in-line-formula></claim-text>
<claim-text>&emsp;and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00071">
<number>71</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>K</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mo>[</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>&it;</mo>
                      <mrow>
                        <msup>
                          <mi>s</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&CirclePlus;</mo>
                        <mrow>
                          <mi>G</mi>
                          <mo>&af;</mo>
                          <mrow>
                            <mo>(</mo>
                            <msup>
                              <mi>r</mi>
                              <mi>&prime;</mi>
                            </msup>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>]</mo>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mrow>
                      <mi>if</mi>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>[</mo>
                      <mrow>
                        <msup>
                          <mi>s</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&CirclePlus;</mo>
                        <mrow>
                          <mi>G</mi>
                          <mo>&af;</mo>
                          <mrow>
                            <mo>(</mo>
                            <msup>
                              <mi>r</mi>
                              <mi>&prime;</mi>
                            </msup>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo>]</mo>
                    </mrow>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msub>
                  <mo>=</mo>
                  <msup>
                    <mn>0</mn>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>42</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00071" file="US20030002662A1-20030102-M00071.NB"/>
<image id="EMI-M00071" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00071.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;calculating K&prime; where, it is stipulated that, in a case where K&prime;&equals;*, said receiver-side apparatus denies said ciphertext, and &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate more-significant and less-significant n bits of a, respectively, and further, </claim-text>
<claim-text>said receiver-side apparatus, using K&prime;, </claim-text>
<claim-text>performing decryption of said ciphertext C. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. The cipher communication method as claimed in <dependent-claim-reference depends_on="CLM-00011">claim 13</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. A cipher communication method where a sender performs distribution of a data encryption key by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(43) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d&gE;</italic></highlight>1) </in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(44) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender, using said data encryption key K (&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), 
<claim-text>encrypts transmission data m so as to create a ciphertext C, and also said sender </claim-text>
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>, and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;K</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(45) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2N</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(46) </in-line-formula></claim-text>
<claim-text>&emsp;(where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&amp;1t; k&minus;2), and </claim-text>
<claim-text>transmits to a receiver-side apparatus along with C, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00072">
<number>72</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>47</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00072" file="US20030002662A1-20030102-M00072.NB"/>
<image id="EMI-M00072" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00072.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p, &minus;x</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), </claim-text>
<claim-text>setting an expression satisfying 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; where, <highlight><bold>100</bold></highlight> designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by Chinese remainder theorem, and more than one s&prime; may exist, and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(48) </in-line-formula></claim-text>
<claim-text>&emsp;and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00073">
<number>73</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>K</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mo>[</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>&it;</mo>
                      <mrow>
                        <msup>
                          <mi>s</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&CirclePlus;</mo>
                        <mrow>
                          <mi>G</mi>
                          <mo>&af;</mo>
                          <mrow>
                            <mo>(</mo>
                            <msup>
                              <mi>r</mi>
                              <mi>&prime;</mi>
                            </msup>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>]</mo>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mrow>
                      <mi>if</mi>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>[</mo>
                      <mrow>
                        <msup>
                          <mi>s</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&CirclePlus;</mo>
                        <mrow>
                          <mi>G</mi>
                          <mo>&af;</mo>
                          <mrow>
                            <mo>(</mo>
                            <msup>
                              <mi>r</mi>
                              <mi>&prime;</mi>
                            </msup>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo>]</mo>
                    </mrow>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msub>
                  <mo>=</mo>
                  <msup>
                    <mn>0</mn>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>49</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00073" file="US20030002662A1-20030102-M00073.NB"/>
<image id="EMI-M00073" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00073.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;calculating K&prime; where, it is stipulated that, in a case where K&prime;&equals;*, said receiver-side apparatus denies said ciphertext, and &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate more-significant and less-significant n bits of a, respectively, and further, </claim-text>
<claim-text>said receiver-side apparatus, using K&prime;, </claim-text>
<claim-text>performing decryption of said ciphertext C. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. The cipher communication method as claimed in <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. A cipher communication method where a sender performs distribution of a data encryption key by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key p<highlight><subscript>i </subscript></highlight>(1&lE;i&lE;d) given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>: prime numbers </in-line-formula><in-line-formula><highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>&equiv;3(<highlight><italic>mod</italic></highlight>4) (1<highlight><italic>&lE;i&lE;d, d&gt;</italic></highlight>1)&emsp;&emsp;(50) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;&Pi;</italic></highlight><highlight><subscript>i&equals;1</subscript></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>p</italic></highlight><highlight><subscript>i </subscript></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&minus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(51) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender, using said data encryption key K (&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), 
<claim-text>encrypts transmission data m so as to create a ciphertext C, and also said sender </claim-text>
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;K</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(52) </in-line-formula></claim-text>
<claim-text>&emsp;where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&lE;log<highlight><subscript>2</subscript></highlight>(N&plus;1), and further, </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(53) </in-line-formula></claim-text>
<claim-text>&emsp;where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&amp;1t; k&minus;2, and </claim-text>
<claim-text>transmits to a receiver-side apparatus along with C, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00074">
<number>74</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mrow>
            <mn>1</mn>
            <mo>,</mo>
            <mi>pi</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow>
          <msubsup>
            <mi>y</mi>
            <mn>1</mn>
            <mfrac>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>p</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
              <mn>4</mn>
            </mfrac>
          </msubsup>
          <mo>&it;</mo>
          <mi>mod</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mrow>
            <msub>
              <mi>p</mi>
              <mi>i</mi>
            </msub>
            <mo>&af;</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mn>1</mn>
                <mo>&leq;</mo>
                <mi>i</mi>
                <mo>&leq;</mo>
                <mi>d</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>54</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00074" file="US20030002662A1-20030102-M00074.NB"/>
<image id="EMI-M00074" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00074.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of 2<highlight><superscript>d </superscript></highlight>expressions &phgr;(&plusmn;x<highlight><subscript>1,p1</subscript></highlight>, &plusmn;x<highlight><subscript>1,p2</subscript></highlight>, . . . , &plusmn;x<highlight><subscript>1,pd</subscript></highlight>), </claim-text>
<claim-text>setting an expression satisfying 0&amp;1t; s&prime;&amp;1t; N/2 to be s&prime; where, &phgr; designates a ring isomorphism mapping from Z/(p<highlight><subscript>1</subscript></highlight>)&times;Z/(p<highlight><subscript>2</subscript></highlight>)&times; . . . &times;Z/(p<highlight><subscript>d</subscript></highlight>) to Z/(N) by Chinese remainder theorem, and also more than one s&prime; may exist, and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(55) </in-line-formula></claim-text>
<claim-text>&emsp;and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00075">
<number>75</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>K</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mo>[</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>&it;</mo>
                      <mrow>
                        <msup>
                          <mi>s</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&CirclePlus;</mo>
                        <mrow>
                          <mi>G</mi>
                          <mo>&af;</mo>
                          <mrow>
                            <mo>(</mo>
                            <msup>
                              <mi>r</mi>
                              <mi>&prime;</mi>
                            </msup>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>]</mo>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mi>n</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mrow>
                      <mi>if</mi>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>[</mo>
                      <mrow>
                        <msup>
                          <mi>s</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&CirclePlus;</mo>
                        <mrow>
                          <mi>G</mi>
                          <mo>&af;</mo>
                          <mrow>
                            <mo>(</mo>
                            <msup>
                              <mi>r</mi>
                              <mi>&prime;</mi>
                            </msup>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo>]</mo>
                    </mrow>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msub>
                  <mo>=</mo>
                  <msup>
                    <mn>0</mn>
                    <msub>
                      <mi>k</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>56</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00075" file="US20030002662A1-20030102-M00075.NB"/>
<image id="EMI-M00075" wi="216.027" he="24.01245" file="US20030002662A1-20030102-M00075.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;calculating K&prime; where, it is stipulated that, in a case where K&prime;&equals;*, said receiver-side apparatus denies said ciphertext, and &lsqb;a&rsqb;<highlight><superscript>n </superscript></highlight>and &lsqb;a&rsqb;<highlight><subscript>n </subscript></highlight>designate more-significant and less-significant n bits of a, respectively, and further, </claim-text>
<claim-text>said receiver-side apparatus, using K&prime;, performing decryption of said ciphertext C. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. The cipher communication method as claimed in <dependent-claim-reference depends_on="CLM-00011">claim 17</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. The cipher communication method as claimed in <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference>, further comprising a step at which, as said prime numbers constituting said secret key, prime numbers of a form of 2p&prime;&plus;1 are selected with respect to another prime numbers p&prime;. </claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. The cipher communication method as claimed in <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference>, wherein a value of d (d&gE;1) is set to be variable. </claim-text>
</claim>
<claim id="CLM-00021">
<claim-text><highlight><bold>21</bold></highlight>. A public-key encryption method where a creator of a ciphertext creates said ciphertext by using a public key of a receiver of said ciphertext and a receiver-side apparatus of said ciphertext decrypts said ciphertext by using a secret key of said receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>defining </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>f:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>one-way trapdoor permutation, </in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(57) </in-line-formula></claim-text>
<claim-text>&emsp;as said public key, and </claim-text>
<claim-text>defining </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>:&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>trapdoor function&emsp;&emsp;(58) </in-line-formula></claim-text>
<claim-text>&emsp;as said secret key, wherein 
<claim-text>said sender 
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>x&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>x&par;r</italic></highlight>),&emsp;&emsp;(59) </in-line-formula></claim-text>
</claim-text>
</claim-text>
</claim-text>
<claim-text>and further, 
<claim-text>defines </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;f</italic></highlight>(<highlight><italic>s</italic></highlight>), <highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(60) </in-line-formula></claim-text>
<claim-text>&emsp;as said ciphertext so as to transmit said ciphertext to said receiver-side apparatus, 
<claim-text>said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>s&prime;&equals;f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>(<highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight>), <highlight><italic>t&prime;&equals;y</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(61) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>x&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(62) </in-line-formula></claim-text>
<claim-text>&emsp;where, x&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00076">
<number>76</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mstyle>
          <mtext>&emsp;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <mrow>
                  <msup>
                    <mi>x</mi>
                    <mi>&prime;</mi>
                  </msup>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                </mrow>
              </mtd>
              <mtd>
                <mrow>
                  <mi>if</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mrow>
                    <mi>G</mi>
                    <mo>(</mo>
                    <mrow>
                      <mrow>
                        <mrow>
                          <msup>
                            <mi>x</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>&it;</mo>
                          <mrow>
                            <mo>&LeftDoubleBracketingBar;</mo>
                            <msup>
                              <mi>r</mi>
                              <mi>&prime;</mi>
                            </msup>
                          </mrow>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                      <mo>=</mo>
                      <msup>
                        <mi>s</mi>
                        <mi>&prime;</mi>
                      </msup>
                    </mrow>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mi>otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>63</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00076" file="US20030002662A1-20030102-M00076.NB"/>
<image id="EMI-M00076" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00076.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;decrypting said ciphertext where, it is stipulated that, in a case where x&prime;&equals;*, said receiver-side apparatus denies said ciphertext. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00022">
<claim-text><highlight><bold>22</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00022">claim 21</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00023">
<claim-text><highlight><bold>23</bold></highlight>. A public-key encryption method where a sender encrypts transmission data by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(64) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k&minus;2 </superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(65) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender 
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>x&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>x&par;r</italic></highlight>),&emsp;&emsp;(66) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>defines </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00077">
<number>77</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>1</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>s</mi>
              <mrow>
                <mn>2</mn>
                <mo>&it;</mo>
                <mi>N</mi>
              </mrow>
            </msup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>N</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>2</mn>
          </msub>
          <mo>=</mo>
          <mi>t</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>3</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mi>s</mi>
              <mi>N</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>67</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00077" file="US20030002662A1-20030102-M00077.NB"/>
<image id="EMI-M00077" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00077.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;as a ciphertext so as to transmit said ciphertext to a receiver-side apparatus where, a&equals;(m/N) designates a Jacobi symbol, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating, from said ciphertext, </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00078">
<number>78</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>68</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00078" file="US20030002662A1-20030102-M00078.NB"/>
<image id="EMI-M00078" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00078.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p, &minus;x</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), </claim-text>
<claim-text>setting an expression satisfying (x/N)&equals;y<highlight><subscript>3 </subscript></highlight>and 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; (where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by Chinese remainder theorem), and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>x&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(69) </in-line-formula></claim-text>
<claim-text>&emsp;where, x&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00079">
<number>79</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <mrow>
                <msup>
                  <mi>x</mi>
                  <mi>&prime;</mi>
                </msup>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
              </mrow>
            </mtd>
            <mtd>
              <mrow>
                <mi>if</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mrow>
                  <mi>G</mi>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <mrow>
                        <msup>
                          <mi>x</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&it;</mo>
                        <mrow>
                          <mo>&LeftDoubleBracketingBar;</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                        </mrow>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>=</mo>
                    <msup>
                      <mi>s</mi>
                      <mi>&prime;</mi>
                    </msup>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>70</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00079" file="US20030002662A1-20030102-M00079.NB"/>
<image id="EMI-M00079" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00079.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;decrypting said ciphertext where, it is stipulated that, in a case where x&prime;&equals;*, said receiver-side apparatus denies said ciphertext. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00024">
<claim-text><highlight><bold>24</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00022">claim 23</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00025">
<claim-text><highlight><bold>25</bold></highlight>. A public-key encryption method where a sender encrypts transmission data by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(71) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d&gE;</italic></highlight>1) </in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k&minus;2 </superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(72) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender 
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>x&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>x&par;r</italic></highlight>),&emsp;&emsp;(73) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>defines </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2N</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(74) </in-line-formula></claim-text>
<claim-text>&emsp;as a ciphertext so as to transmit said ciphertext to a receiver-side apparatus, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating, from said ciphertext, </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00080">
<number>80</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>75</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00080" file="US20030002662A1-20030102-M00080.NB"/>
<image id="EMI-M00080" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00080.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p, &minus;x</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), </claim-text>
<claim-text>setting an expression satisfying 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by Chinese remainder theorem, and more than one s&prime; may exist, and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>x&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(76) </in-line-formula></claim-text>
<claim-text>&emsp;(where, x&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>) and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00081">
<number>81</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>x</mi>
          <mi>&prime;</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <msup>
                  <mi>x</mi>
                  <mi>&prime;</mi>
                </msup>
              </mtd>
              <mtd>
                <mrow>
                  <mrow>
                    <mi>i</mi>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <mi>f</mi>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <mrow>
                      <mi>G</mi>
                      <mo>&af;</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <msup>
                            <mi>x</mi>
                            <mi>&prime;</mi>
                          </msup>
                          <mo>||</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                  <mo>=</mo>
                  <msup>
                    <mi>s</mi>
                    <mi>&prime;</mi>
                  </msup>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo>*</mo>
              </mtd>
              <mtd>
                <mrow>
                  <mi>o</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>t</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>h</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>e</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>r</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>w</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>i</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>s</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>e</mi>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>77</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00081" file="US20030002662A1-20030102-M00081.NB"/>
<image id="EMI-M00081" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00081.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;decrypting said ciphertext where, it is stipulated that, in a case where x&prime;&equals;*, said receiver-side apparatus denies said ciphertext. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00026">
<claim-text><highlight><bold>26</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00022">claim 25</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00027">
<claim-text><highlight><bold>27</bold></highlight>. A public-key encryption method where a sender encrypts transmission data by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key p<highlight><subscript>i </subscript></highlight>(1&lE;i&lE;d) given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>: prime numbers </in-line-formula><in-line-formula><highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>&equiv;3(<highlight><italic>mod</italic></highlight>4) (1<highlight><italic>&lE;i&lE;d, d&gt;</italic></highlight>1)&emsp;&emsp;(78) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;&Pi;</italic></highlight><highlight><subscript>i&equals;1</subscript></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>p</italic></highlight><highlight><subscript>i </subscript></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(79) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender 
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>x&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>x&par;r</italic></highlight>),&emsp;&emsp;(80) </in-line-formula></claim-text>
<claim-text>&emsp;where, k&minus;1&lE;log<highlight><subscript>2</subscript></highlight>(N&plus;1), and further, </claim-text>
<claim-text>defines </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(81) </in-line-formula></claim-text>
<claim-text>&emsp;as a ciphertext so as to transmit said ciphertext to a receiver-side apparatus, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating, from said ciphertext, </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00082">
<number>82</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>1</mn>
                  <mo>,</mo>
                  <msub>
                    <mi>p</mi>
                    <mi>i</mi>
                  </msub>
                </mrow>
              </msub>
              <mo>=</mo>
              <mrow>
                <msubsup>
                  <mi>y</mi>
                  <mn>1</mn>
                  <mfrac>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mn>4</mn>
                  </mfrac>
                </msubsup>
                <mo>&it;</mo>
                <mi>m</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>o</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>d</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <msub>
                  <mi>p</mi>
                  <mi>i</mi>
                </msub>
              </mrow>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mn>1</mn>
                <mo>&leq;</mo>
                <mi>i</mi>
                <mo>&leq;</mo>
                <mi>d</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>82</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00082" file="US20030002662A1-20030102-M00082.NB"/>
<image id="EMI-M00082" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00082.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of 2<highlight><superscript>d </superscript></highlight>expressions &phgr;(&plusmn;x<highlight><subscript>1,p1</subscript></highlight>, &plusmn;x<highlight><subscript>1,p2</subscript></highlight>, . . . , &plusmn;x<highlight><subscript>1,pd</subscript></highlight>), </claim-text>
<claim-text>setting an expression satisfying 0&amp;1t; s&prime;&amp;1t; N/2 to be s&prime; where, &phgr; designates a ring isomorphism mapping from Z/(p<highlight><subscript>1</subscript></highlight>)&times;Z/(p<highlight><subscript>2</subscript></highlight>)&times; . . . &times;Z/(p<highlight><subscript>d</subscript></highlight>) to Z/(N) by Chinese remainder theorem, and also more than one s&prime; may exist, and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>x&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(83) </in-line-formula></claim-text>
<claim-text>&emsp;where, x&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00083">
<number>83</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>x</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>i</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>f</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mrow>
                    <mi>G</mi>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msup>
                          <mi>x</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>||</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <msup>
                  <mi>s</mi>
                  <mi>&prime;</mi>
                </msup>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mrow>
                <mi>o</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>t</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>h</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>e</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>r</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>w</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>i</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>s</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>e</mi>
              </mrow>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>84</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00083" file="US20030002662A1-20030102-M00083.NB"/>
<image id="EMI-M00083" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00083.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;decrypting said ciphertext where, it is stipulated that, in a case where x&prime;&equals;*, said receiver-side apparatus denies said ciphertext. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00028">
<claim-text><highlight><bold>28</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00022">claim 27</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00029">
<claim-text><highlight><bold>29</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00022">claim 23</dependent-claim-reference>, further comprising a step at which, as said prime numbers constituting said secret key, prime numbers of a form of 2p&prime;&plus;1 are selected with respect to another prime numbers p&prime;. </claim-text>
</claim>
<claim id="CLM-00030">
<claim-text><highlight><bold>30</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00022">claim 23</dependent-claim-reference>, wherein a value of d (d&gE;1) is set to be variable. </claim-text>
</claim>
<claim id="CLM-00031">
<claim-text><highlight><bold>31</bold></highlight>. A cipher communication method where a sender performs distribution of a data encryption key by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>defining </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>f:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>one-way trapdoor permutation, </in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(85) </in-line-formula></claim-text>
<claim-text>&emsp;as said public key, and </claim-text>
<claim-text>defining </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>:&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>trapdoor function&emsp;&emsp;(86) </in-line-formula></claim-text>
<claim-text>&emsp;as a secret key, wherein 
<claim-text>(1) said sender, using said data encryption key K (&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), 
<claim-text>encrypts transmission data m so as to create a ciphertext C, and also said sender </claim-text>
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>, and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>K&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>K&par;r</italic></highlight>),&emsp;&emsp;(87) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;f</italic></highlight>(<highlight><italic>s</italic></highlight>), <highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(88) </in-line-formula></claim-text>
<claim-text>&emsp;and </claim-text>
<claim-text>transmits to a receiver-side apparatus along with C, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>s&prime;&equals;f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>(<highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight>), <highlight><italic>t&prime;&equals;y</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(89) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>K&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(90) </in-line-formula></claim-text>
<claim-text>&emsp;where, K&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00084">
<number>84</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>K</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>i</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>f</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mrow>
                    <mi>G</mi>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msup>
                          <mi>K</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>||</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <msup>
                  <mi>s</mi>
                  <mi>&prime;</mi>
                </msup>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mrow>
                <mi>o</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>t</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>h</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>e</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>r</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>w</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>i</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>s</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>e</mi>
              </mrow>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>91</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00084" file="US20030002662A1-20030102-M00084.NB"/>
<image id="EMI-M00084" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00084.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;calculating K&prime; where, it is stipulated that, in a case where K&prime;&equals;*, said receiver-side apparatus denies said ciphertext, and further, </claim-text>
<claim-text>said receiver-side apparatus, using K&prime;, </claim-text>
<claim-text>performing decryption of said ciphertext C. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00032">
<claim-text><highlight><bold>32</bold></highlight>. The cipher communication method as claimed in <dependent-claim-reference depends_on="CLM-00033">claim 31</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00033">
<claim-text><highlight><bold>33</bold></highlight>. A cipher communication method where a sender performs distribution of a data encryption key by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(92) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&minus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k&minus;2 </superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(93) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender, using said data encryption key K (&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), 
<claim-text>encrypts transmission data m so as to create a ciphertext C, and also said sender </claim-text>
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>, and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>K&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>K&par;r</italic></highlight>),&emsp;&emsp;(94) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>calculates </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00085">
<number>85</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>1</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>s</mi>
              <mrow>
                <mn>2</mn>
                <mo>&it;</mo>
                <mi>N</mi>
              </mrow>
            </msup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>N</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>2</mn>
          </msub>
          <mo>=</mo>
          <mi>t</mi>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>3</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mi>s</mi>
              <mi>N</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>95</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00085" file="US20030002662A1-20030102-M00085.NB"/>
<image id="EMI-M00085" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00085.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and </claim-text>
<claim-text>transmits to a receiver-side apparatus along with C where, a&equals;(m/N) designates a Jacobi symbol, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00086">
<number>86</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>96</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00086" file="US20030002662A1-20030102-M00086.NB"/>
<image id="EMI-M00086" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00086.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p, &minus;x</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), </claim-text>
<claim-text>setting an expression satisfying (x/N)&equals;y<highlight><subscript>3 </subscript></highlight>and 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by Chinese remainder theorem, and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>K&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(97) </in-line-formula></claim-text>
<claim-text>&emsp;where, K&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00087">
<number>87</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>K</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>i</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>f</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mrow>
                    <mi>G</mi>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msup>
                          <mi>K</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>||</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <msup>
                  <mi>s</mi>
                  <mi>&prime;</mi>
                </msup>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mrow>
                <mi>o</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>t</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>h</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>e</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>r</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>w</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>i</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>s</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>e</mi>
              </mrow>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>98</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00087" file="US20030002662A1-20030102-M00087.NB"/>
<image id="EMI-M00087" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00087.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;calculating K&prime; where, it is stipulated that, in a case where K&prime;&equals;*, said receiver-side apparatus denies said ciphertext, and further, </claim-text>
<claim-text>said receiver-side apparatus, using K&prime;, </claim-text>
<claim-text>performing decryption of said ciphertext C. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00034">
<claim-text><highlight><bold>34</bold></highlight>. The cipher communication method as claimed in <dependent-claim-reference depends_on="CLM-00033">claim 33</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00035">
<claim-text><highlight><bold>35</bold></highlight>. A cipher communication method where a sender performs distribution of a data encryption key by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(99) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d&gE;</italic></highlight>1) </in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&minus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k&minus;2 </superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&minus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(100) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender, using said data encryption key K (&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), 
<claim-text>encrypts transmission data m so as to create a ciphertext C, and also said sender </claim-text>
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>, and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>K&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>K&par;r</italic></highlight>),&emsp;&emsp;(101) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2N</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(102) </in-line-formula></claim-text>
<claim-text>&emsp;and </claim-text>
<claim-text>transmits to a receiver-side apparatus along with C, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00088">
<number>88</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>m</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>o</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>d</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>103</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00088" file="US20030002662A1-20030102-M00088.NB"/>
<image id="EMI-M00088" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00088.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p, &minus;x</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), setting an expression satisfying 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be s&prime; where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by Chinese remainder theorem, and more than one s&prime; may exist, and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>K&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(104 ) </in-line-formula></claim-text>
<claim-text>&emsp;where, K&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00089">
<number>89</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>K</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>i</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mi>f</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <mrow>
                    <mi>G</mi>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msup>
                          <mi>K</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>||</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <msup>
                  <mi>s</mi>
                  <mi>&prime;</mi>
                </msup>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mrow>
                <mi>o</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>t</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>h</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>e</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>r</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>w</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>i</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>s</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>e</mi>
              </mrow>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>105</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00089" file="US20030002662A1-20030102-M00089.NB"/>
<image id="EMI-M00089" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00089.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;calculating K&prime; where, it is stipulated that, in a case where K&prime;&equals;*, said receiver-side apparatus denies said ciphertext, and further, </claim-text>
<claim-text>said receiver-side apparatus, using K&prime;, </claim-text>
<claim-text>performing decryption of said ciphertext C. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00036">
<claim-text><highlight><bold>36</bold></highlight>. The cipher communication method as claimed in <dependent-claim-reference depends_on="CLM-00033">claim 35</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00037">
<claim-text><highlight><bold>37</bold></highlight>. A cipher communication method where a sender performs distribution of a data encryption key by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key p<highlight><subscript>i </subscript></highlight>(1&lE;i&lE;d) given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>: prime numbers </in-line-formula><in-line-formula><highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>&equiv;3(<highlight><italic>mod</italic></highlight>4) (1<highlight><italic>&lE;i&lE;d, d&gt;</italic></highlight>1)&emsp;&emsp;(106) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;&Pi;</italic></highlight><highlight><subscript>i&equals;1</subscript></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>p</italic></highlight><highlight><subscript>i </subscript></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(107) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender, using said data encryption key K (&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), 
<claim-text>encrypts transmission data m so as to create a ciphertext C, and also said sender </claim-text>
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>, and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;G</italic></highlight>(<highlight><italic>K&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;(<highlight><italic>K&par;r</italic></highlight>),&emsp;&emsp;(108) </in-line-formula></claim-text>
<claim-text>&emsp;where, k&minus;1&lE;log<highlight><subscript>2</subscript></highlight>(N&plus;1), and further, calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(109) </in-line-formula></claim-text>
<claim-text>&emsp;and </claim-text>
<claim-text>transmits to a receiver-side apparatus along with C, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00090">
<number>90</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>1</mn>
                  <mo>,</mo>
                  <msub>
                    <mi>p</mi>
                    <mi>i</mi>
                  </msub>
                </mrow>
              </msub>
              <mo>=</mo>
              <mrow>
                <msubsup>
                  <mi>y</mi>
                  <mn>1</mn>
                  <mfrac>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mn>4</mn>
                  </mfrac>
                </msubsup>
                <mo>&it;</mo>
                <mi>m</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>o</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mi>d</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <msub>
                  <mi>p</mi>
                  <mi>i</mi>
                </msub>
              </mrow>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mn>1</mn>
                <mo>&leq;</mo>
                <mi>i</mi>
                <mo>&leq;</mo>
                <mi>d</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>110</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00090" file="US20030002662A1-20030102-M00090.NB"/>
<image id="EMI-M00090" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00090.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of 2<highlight><superscript>d </superscript></highlight>expressions &phgr;(&plusmn;x<highlight><subscript>1,p1</subscript></highlight>, &plusmn;x<highlight><subscript>1,p2</subscript></highlight>, . . . , &plusmn;x<highlight><subscript>1,pd</subscript></highlight>), setting an expression satisfying 0&amp;1t; s&prime;&amp;1t; N/2 to be s&prime; where, &phgr; designates a ring isomorphism mapping from Z/(p<highlight><subscript>1</subscript></highlight>)&times;Z/(p<highlight><subscript>2</subscript></highlight>)&times; . . . &times;Z/(p<highlight><subscript>d</subscript></highlight>) to Z/(N) by Chinese remainder theorem, and also more than one s&prime; may exist, and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>K&prime;&par;r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;</italic></highlight>&emsp;&emsp;(111) </in-line-formula></claim-text>
<claim-text>&emsp;where, K&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, r&prime;&isin;&lcub;, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00091">
<number>91</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>K</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mi>if</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mrow>
                  <mi>G</mi>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <mrow>
                        <msup>
                          <mi>K</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&it;</mo>
                        <mrow>
                          <mo>&LeftDoubleBracketingBar;</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                        </mrow>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>=</mo>
                    <msup>
                      <mi>s</mi>
                      <mi>&prime;</mi>
                    </msup>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>112</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00091" file="US20030002662A1-20030102-M00091.NB"/>
<image id="EMI-M00091" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00091.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;calculating K&prime; where, it is stipulated that, in a case where K&prime;&equals;*, said receiver-side apparatus denies said ciphertext, and further, </claim-text>
<claim-text>said receiver-side apparatus, using K&prime;, </claim-text>
<claim-text>performing decryption of said ciphertext C. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00038">
<claim-text><highlight><bold>38</bold></highlight>. The cipher communication method as claimed in <dependent-claim-reference depends_on="CLM-00033">claim 37</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00039">
<claim-text><highlight><bold>39</bold></highlight>. The cipher communication method as claimed in <dependent-claim-reference depends_on="CLM-00033">claim 31</dependent-claim-reference>, further comprising a step at which, as said prime numbers constituting said secret key, prime numbers of a form of 2p&prime;&plus;1 are selected with respect to another prime numbers p&prime;. </claim-text>
</claim>
<claim id="CLM-00040">
<claim-text><highlight><bold>40</bold></highlight>. The cipher communication method as claimed in <dependent-claim-reference depends_on="CLM-00033">claim 31</dependent-claim-reference>, wherein a value of d (d&gE;1) is set to be variable. </claim-text>
</claim>
<claim id="CLM-00041">
<claim-text><highlight><bold>41</bold></highlight>. A public-key encryption method where a creator of a ciphertext creates said ciphertext by using a public key of a receiver of said ciphertext and a receiver-side apparatus of said ciphertext decrypts said ciphertext by using a secret key of said receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>defining </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>f:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>one-way trapdoor permutation, </in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&minus;k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(113) </in-line-formula></claim-text>
<claim-text>&emsp;as said public key, and </claim-text>
<claim-text>defining </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>:&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k </superscript></highlight>trapdoor function&emsp;&emsp;(114) </in-line-formula></claim-text>
<claim-text>&emsp;as said secret key, wherein 
<claim-text>said sender 
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k </superscript></highlight>for a plaintext x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, and </claim-text>
<claim-text>defines </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;f</italic></highlight>(<highlight><italic>r</italic></highlight>), <highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight>&equals;(<highlight><italic>x&par;H</italic></highlight>(<highlight><italic>x&par;r</italic></highlight>))&oplus;<highlight><italic>G</italic></highlight>(<highlight><italic>r</italic></highlight>),&emsp;&emsp;(115) </in-line-formula></claim-text>
<claim-text>&emsp;as said ciphertext so as to transmit said ciphertext to said receiver-side apparatus, </claim-text>
<claim-text>said receiver-side apparatus, using said secret key of said receiver, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>r&prime;&equals;f</italic></highlight><highlight><superscript>&minus;1</superscript></highlight>(<highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight>)&emsp;&emsp;(116) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>x&prime;&par;w&prime;&equals;G</italic></highlight>(<highlight><italic>r</italic></highlight>&prime;)&oplus;<highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(117) </in-line-formula></claim-text>
<claim-text>&emsp;where, x&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, w&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00092">
<number>92</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>x</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>if</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <msup>
                    <mi>w</mi>
                    <mi>&prime;</mi>
                  </msup>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mi>H</mi>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <msup>
                        <mi>x</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&it;</mo>
                      <mrow>
                        <mo>&LeftDoubleBracketingBar;</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                      </mrow>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>118</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00092" file="US20030002662A1-20030102-M00092.NB"/>
<image id="EMI-M00092" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00092.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;decrypting said ciphertext where, it is stipulated that, in a case where x&prime;&equals;*, said receiver-side apparatus denies said ciphertext. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00042">
<claim-text><highlight><bold>42</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00044">claim 41</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00043">
<claim-text><highlight><bold>43</bold></highlight>. A public-key encryption method where a sender encrypts transmission data by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(119) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&minus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(120) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender 
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k&minus;2 </superscript></highlight>for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), and </claim-text>
<claim-text>defines </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00093">
<number>93</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>1</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>r</mi>
              <mrow>
                <mn>2</mn>
                <mo>&it;</mo>
                <mi>N</mi>
              </mrow>
            </msup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>N</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>2</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>x</mi>
                    <mo>&it;</mo>
                    <mrow>
                      <mo>&LeftDoubleBracketingBar;</mo>
                      <mrow>
                        <mrow>
                          <mrow>
                            <mi>H</mi>
                            <mo>(</mo>
                            <mi>x</mi>
                          </mrow>
                          <mo>&RightDoubleBracketingBar;</mo>
                        </mrow>
                        <mo>&it;</mo>
                        <mi>r</mi>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mo>&CirclePlus;</mo>
            <mrow>
              <mi>G</mi>
              <mo>&af;</mo>
              <mrow>
                <mo>(</mo>
                <mi>r</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>3</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mi>r</mi>
              <mi>N</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>121</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00093" file="US20030002662A1-20030102-M00093.NB"/>
<image id="EMI-M00093" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00093.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;as a ciphertext so as to transmit said ciphertext to a receiver-side apparatus where, a&equals;(m/N) designates a Jacobi symbol, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating, from said ciphertext, </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00094">
<number>94</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>r</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>r</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>122</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00094" file="US20030002662A1-20030102-M00094.NB"/>
<image id="EMI-M00094" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00094.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of expressions &phgr;(r<highlight><subscript>1,p</subscript></highlight>, r<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;r<highlight><subscript>1,p</subscript></highlight>, r<highlight><subscript>1,q</subscript></highlight>), &phgr;(r<highlight><subscript>1,p, &minus;r</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;r<highlight><subscript>1,p</subscript></highlight>, &minus;r<highlight><subscript>1,q</subscript></highlight>), </claim-text>
<claim-text>setting an expression satisfying (r/N)&equals;y<highlight><subscript>3 </subscript></highlight>and 0&amp;1t; r&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be r&prime; where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by Chinese remainder theorem, and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>x&prime;&par;w&prime;&equals;G</italic></highlight>(<highlight><italic>r</italic></highlight>&prime;)&oplus;<highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(123) </in-line-formula></claim-text>
<claim-text>&emsp;here, x&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, w&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00095">
<number>95</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>x</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>if</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <msup>
                    <mi>w</mi>
                    <mi>&prime;</mi>
                  </msup>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mi>H</mi>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <msup>
                        <mi>x</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&it;</mo>
                      <mrow>
                        <mo>&LeftDoubleBracketingBar;</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                      </mrow>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>124</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00095" file="US20030002662A1-20030102-M00095.NB"/>
<image id="EMI-M00095" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00095.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;decrypting said ciphertext where, it is stipulated that, in a case where x&prime;&equals;*, said receiver-side apparatus denies said ciphertext. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00044">
<claim-text><highlight><bold>44</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00044">claim 43</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00045">
<claim-text><highlight><bold>45</bold></highlight>. A public-key encryption method where a sender encrypts transmission data by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(125) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d&gE;</italic></highlight>1) </in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&minus;k&minus;2</superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(126) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender 
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k </superscript></highlight>for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), and </claim-text>
<claim-text>defines </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;r</italic></highlight><highlight><superscript>2N</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight>&equals;(<highlight><italic>x&par;H</italic></highlight>(<highlight><italic>x&par;r</italic></highlight>))&oplus;<highlight><italic>G</italic></highlight>(<highlight><italic>r</italic></highlight>),&emsp;&emsp;(127) </in-line-formula></claim-text>
<claim-text>&emsp;as a ciphertext so as to transmit said ciphertext to a receiver-side apparatus, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating, from said ciphertext, </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00096">
<number>96</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>r</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>r</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>128</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00096" file="US20030002662A1-20030102-M00096.NB"/>
<image id="EMI-M00096" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00096.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of expressions &phgr;(r<highlight><subscript>1,p</subscript></highlight>, r<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;r<highlight><subscript>1,p</subscript></highlight>, r<highlight><subscript>1,q</subscript></highlight>), &phgr;(r<highlight><subscript>1,p, &minus;r</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;r<highlight><subscript>1,p</subscript></highlight>, &minus;r<highlight><subscript>1,q</subscript></highlight>), setting an expression satisfying 0&amp;1t; r&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>to be r&prime; where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by Chinese remainder theorem, and more than one r&prime; may exist, and further, </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>x&prime;&par;w&prime;&equals;G</italic></highlight>(<highlight><italic>r</italic></highlight>&prime;)&oplus;<highlight><italic>y</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(129) </in-line-formula></claim-text>
<claim-text>&emsp;where, x&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, w&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00097">
<number>97</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>x</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>if</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <msup>
                    <mi>w</mi>
                    <mi>&prime;</mi>
                  </msup>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mi>H</mi>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <msup>
                        <mi>x</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&it;</mo>
                      <mrow>
                        <mo>&LeftDoubleBracketingBar;</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                      </mrow>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>130</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00097" file="US20030002662A1-20030102-M00097.NB"/>
<image id="EMI-M00097" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00097.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;decrypting said ciphertext where, it is stipulated that, in a case where x&prime;&equals;*, said receiver-side apparatus denies said ciphertext. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00046">
<claim-text><highlight><bold>46</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00044">claim 45</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00047">
<claim-text><highlight><bold>47</bold></highlight>. A public-key encryption method where a sender encrypts transmission data by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key p<highlight><subscript>i </subscript></highlight>(1&lE;i&lE;d) given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>: prime numbers </in-line-formula><in-line-formula><highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>&equiv;3(<highlight><italic>mod</italic></highlight>4) (1<highlight><italic>&lE;i&lE;d, d&gt;</italic></highlight>1)&emsp;&emsp;(131) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;&Pi;</italic></highlight><highlight><subscript>i&equals;1</subscript></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>p</italic></highlight><highlight><subscript>i </subscript></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n </superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H</italic></highlight><highlight><subscript>1</subscript></highlight>:&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function </in-line-formula><in-line-formula>&bull;<highlight><italic>H</italic></highlight><highlight><subscript>2</subscript></highlight>:&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(132) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender 
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), and </claim-text>
<claim-text>calculates </claim-text>
<claim-text><in-line-formula><highlight><italic>s</italic></highlight>&equals;(<highlight><italic>x&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>))&par;<highlight><italic>H</italic></highlight><highlight><subscript>2</subscript></highlight>(<highlight><italic>x&par;r</italic></highlight>), <highlight><italic>t&equals;H</italic></highlight><highlight><subscript>1</subscript></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(133) </in-line-formula></claim-text>
<claim-text>&emsp;where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&lE;log<highlight><subscript>2</subscript></highlight>(N&plus;1), and further, </claim-text>
<claim-text>defines </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;s</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN, y</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&equals;t,</italic></highlight>&emsp;&emsp;(134) </in-line-formula></claim-text>
<claim-text>&emsp;as a ciphertext so as to transmit said ciphertext to a receiver-side apparatus, </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating, from said ciphertext, </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00098">
<number>98</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mrow>
            <mn>1</mn>
            <mo>,</mo>
            <mi>pi</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow>
          <msubsup>
            <mi>y</mi>
            <mn>1</mn>
            <mfrac>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>p</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
              <mn>4</mn>
            </mfrac>
          </msubsup>
          <mo>&it;</mo>
          <mi>mod</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mrow>
            <msub>
              <mi>p</mi>
              <mi>i</mi>
            </msub>
            <mo>&af;</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mn>1</mn>
                <mo>&leq;</mo>
                <mi>i</mi>
                <mo>&leq;</mo>
                <mi>d</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>135</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00098" file="US20030002662A1-20030102-M00098.NB"/>
<image id="EMI-M00098" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00098.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of 2<highlight><superscript>d </superscript></highlight>expressions &phgr;(&plusmn;x<highlight><subscript>1,p1</subscript></highlight>, &plusmn;x<highlight><subscript>1,p2</subscript></highlight>, . . . , &plusmn;x<highlight><subscript>1,pd</subscript></highlight>), </claim-text>
<claim-text>setting an expression satisfying 0&amp;1t; w&prime;&amp;1t; N/2 to be w&prime; where, &phgr; designates a ring isomorphism mapping from Z/(p<highlight><subscript>1</subscript></highlight>)&times;Z/(p<highlight><subscript>2</subscript></highlight>)&times; . . . &times;Z/(p<highlight><subscript>d</subscript></highlight>) to Z/(N) by Chinese remainder theorem, and also more than one w&prime; may exist and further, for w&prime;&equals;s<highlight><subscript>1</subscript></highlight>&prime;&par;s<highlight><subscript>2</subscript></highlight>&prime;&par;t&prime;(s<highlight><subscript>1</subscript></highlight>&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>, s<highlight><subscript>2</subscript></highlight>&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k1</superscript></highlight>, t&prime;&isin;&lcub;0, 1&rcub;<highlight><superscript>k0</superscript></highlight>), </claim-text>
<claim-text>calculating </claim-text>
<claim-text><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight><highlight><subscript>1</subscript></highlight>(<highlight><italic>s</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&prime;&par;s</italic></highlight><highlight><subscript>2</subscript></highlight>&prime;)&oplus;<highlight><italic>t&prime;, x&prime;&equals;s</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&prime;&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>&prime;)&emsp;&emsp;(136) </in-line-formula></claim-text>
<claim-text>&emsp;and, based on </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00099">
<number>99</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>x</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>if</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <msubsup>
                    <mi>s</mi>
                    <mn>2</mn>
                    <mi>&prime;</mi>
                  </msubsup>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msub>
                    <mi>H</mi>
                    <mn>2</mn>
                  </msub>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <msup>
                        <mi>x</mi>
                        <mi>&prime;</mi>
                      </msup>
                      <mo>&it;</mo>
                      <mrow>
                        <mo>&LeftDoubleBracketingBar;</mo>
                        <msup>
                          <mi>r</mi>
                          <mi>&prime;</mi>
                        </msup>
                      </mrow>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>137</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00099" file="US20030002662A1-20030102-M00099.NB"/>
<image id="EMI-M00099" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00099.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;decrypting said ciphertext where, it is stipulated that, in a case where x&prime;&equals;*, said receiver-side apparatus denies said ciphertext. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00048">
<claim-text><highlight><bold>48</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00044">claim 47</dependent-claim-reference>, further comprising a step at which said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00049">
<claim-text><highlight><bold>49</bold></highlight>. A public-key encryption method where a sender encrypts transmission data by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(138) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;pq&verbar;</italic></highlight>&emsp;&emsp;(139) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>said sender 
<claim-text>defines, for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>k&minus;2</superscript></highlight>), </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00100">
<number>100</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>1</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>x</mi>
              <mrow>
                <mn>2</mn>
                <mo>&it;</mo>
                <mi>N</mi>
              </mrow>
            </msup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>N</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>y</mi>
            <mn>2</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mi>x</mi>
              <mi>N</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>140</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00100" file="US20030002662A1-20030102-M00100.NB"/>
<image id="EMI-M00100" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00100.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;as a ciphertext so as to transmit said ciphertext to a receiver-side apparatus where, a&equals;(m/N) designates a Jacobi symbol, and </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating, from said ciphertext, </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00101">
<number>101</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>q</mi>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>x</mi>
            <mrow>
              <mn>1</mn>
              <mo>,</mo>
              <mi>q</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <msubsup>
              <mi>y</mi>
              <mn>1</mn>
              <mfrac>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>&it;</mo>
                  <msup>
                    <mi>p</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msubsup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>q</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>141</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00101" file="US20030002662A1-20030102-M00101.NB"/>
<image id="EMI-M00101" wi="216.027" he="36.9684" file="US20030002662A1-20030102-M00101.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of expressions &phgr;(x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, x<highlight><subscript>1,q</subscript></highlight>), &phgr;(x<highlight><subscript>1,p, &minus;x</subscript></highlight><highlight><subscript>1,q</subscript></highlight>) and &phgr;(&minus;x<highlight><subscript>1,p</subscript></highlight>, &minus;x<highlight><subscript>1,q</subscript></highlight>), </claim-text>
<claim-text>defining, as a decryption result, an expression satisfying (x/N)&equals;y<highlight><subscript>3 </subscript></highlight>and 0&amp;1t; x&amp;1t; 2<highlight><superscript>k&minus;2 </superscript></highlight>where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by Chinese remainder theorem. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00050">
<claim-text><highlight><bold>50</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00044">claim 49</dependent-claim-reference>, wherein, in said plaintext, said encryption processing, and said decryption processing, said limitation condition imposed by said Jacobi symbol is eliminated in correspondence with said security-enhancing conversion method. </claim-text>
</claim>
<claim id="CLM-00051">
<claim-text><highlight><bold>51</bold></highlight>. A public-key encryption method where a sender encrypts transmission data by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>creating a secret key p<highlight><subscript>i </subscript></highlight>(1&lE;i&lE;d) given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>: prime numbers </in-line-formula><in-line-formula><highlight><italic>p</italic></highlight><highlight><subscript>i</subscript></highlight>&equiv;3(<highlight><italic>mod</italic></highlight>4) (1<highlight><italic>&lE;i&lE;d, d&gt;</italic></highlight>1)&emsp;&emsp;(142) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>creating said public key given by </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;&Pi;</italic></highlight><highlight><subscript>i&equals;1</subscript></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>p</italic></highlight><highlight><subscript>i </subscript></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight>&emsp;&emsp;(143) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(1) said sender 
<claim-text>defines, for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>k</superscript></highlight>), </claim-text>
<claim-text><in-line-formula><highlight><italic>y</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&equals;x</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN,</italic></highlight>&emsp;&emsp;(144) </in-line-formula></claim-text>
<claim-text>&emsp;as a ciphertext so as to transmit said ciphertext to a receiver-side apparatus, and </claim-text>
</claim-text>
<claim-text>(2) said receiver-side apparatus, using said secret key of said receiver, 
<claim-text>calculating, from said ciphertext, </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00102">
<number>102</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mrow>
            <mn>1</mn>
            <mo>,</mo>
            <mi>pi</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow>
          <msubsup>
            <mi>y</mi>
            <mn>1</mn>
            <mfrac>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>p</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
              <mn>4</mn>
            </mfrac>
          </msubsup>
          <mo>&it;</mo>
          <mi>mod</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mrow>
            <msub>
              <mi>p</mi>
              <mi>i</mi>
            </msub>
            <mo>&af;</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mn>1</mn>
                <mo>&leq;</mo>
                <mi>i</mi>
                <mo>&leq;</mo>
                <mi>d</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>145</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00102" file="US20030002662A1-20030102-M00102.NB"/>
<image id="EMI-M00102" wi="216.027" he="17.03835" file="US20030002662A1-20030102-M00102.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, of 2<highlight><superscript>d </superscript></highlight>expressions &phgr;(&plusmn;x<highlight><subscript>1,p1</subscript></highlight>, &plusmn;x<highlight><subscript>1,p2</subscript></highlight>, . . . , &plusmn;x<highlight><subscript>1,pd</subscript></highlight>), </claim-text>
<claim-text>decrypting said ciphertext from an expression satisfying 0&amp;1t; x&prime;&amp;1t; N/2 where, &phgr; designates a ring isomorphism mapping from Z/(p<highlight><subscript>1</subscript></highlight>)&times;Z/(p<highlight><subscript>2</subscript></highlight>)&times; . . . &times;Z/(p<highlight><subscript>d</subscript></highlight>) to Z/(N) by Chinese remainder theorem, and also more than one s&prime; may exist, thereby securing uniqueness of said decryption. </claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00052">
<claim-text><highlight><bold>52</bold></highlight>. A public-key encryption method where a sender-side apparatus encrypts transmission data by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>(a) creating a secret key given by an expression (146): </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(146) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>(b) creating said public key given by an expression (147): </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(147) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(I) said sender-side apparatus 
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), and </claim-text>
</claim-text>
</claim-text>
<claim-text>(c) calculates an expression (148): </claim-text>
<claim-text><in-line-formula><highlight><italic>s&equals;x</italic></highlight>0<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>), </in-line-formula><in-line-formula><highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(148) </in-line-formula></claim-text>
<claim-text>&emsp;where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&equals;k, and further, </claim-text>
<claim-text>(d) calculates an expression (149): </claim-text>
<claim-text><in-line-formula><highlight><italic>w&equals;s&par;t,</italic></highlight>&emsp;&emsp;(149) </in-line-formula></claim-text>
<claim-text>&emsp;and </claim-text>
<claim-text>(e) calculates an expression (150): </claim-text>
<claim-text><in-line-formula><highlight><italic>y&equals;w</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN, </italic></highlight>&emsp;&emsp;(150) </in-line-formula></claim-text>
<claim-text>&emsp;and 
<claim-text>defines this result y as a ciphertext so as to transmit said ciphertext to a receiver-side apparatus, </claim-text>
<claim-text>(II) said receiver-side apparatus, using said secret key of itself, </claim-text>
</claim-text>
<claim-text>(f) calculating, from said ciphertext y, an expression (151): </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00103">
<number>103</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <msub>
              <mi>&alpha;</mi>
              <mn>0</mn>
            </msub>
            <mo>=</mo>
            <mrow>
              <msup>
                <mi>y</mi>
                <mfrac>
                  <mrow>
                    <mi>p</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                  <mn>4</mn>
                </mfrac>
              </msup>
              <mo>&it;</mo>
              <mi>mod</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>p</mi>
            </mrow>
          </mrow>
          <mo>,</mo>
          <mstyle>
            <mtext>&NewLine;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mrow>
            <msub>
              <mi>&beta;</mi>
              <mn>0</mn>
            </msub>
            <mo>=</mo>
            <msub>
              <mi>&alpha;</mi>
              <mn>0</mn>
            </msub>
          </mrow>
          <mo>,</mo>
          <mstyle>
            <mtext>&NewLine;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mrow>
            <msub>
              <mi>&alpha;</mi>
              <mi>k</mi>
            </msub>
            <mo>=</mo>
            <mrow>
              <mfrac>
                <mn>1</mn>
                <mrow>
                  <mn>2</mn>
                  <mo>&it;</mo>
                  <msub>
                    <mi>&beta;</mi>
                    <mrow>
                      <mi>k</mi>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msub>
                </mrow>
              </mfrac>
              <mo>&it;</mo>
              <mrow>
                <mo>(</mo>
                <mfrac>
                  <mrow>
                    <mrow>
                      <mi>y</mi>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>&it;</mo>
                      <mi>mod</mi>
                      <mo>&it;</mo>
                      <mstyle>
                        <mtext>&emsp;</mtext>
                      </mstyle>
                      <mo>&it;</mo>
                      <msup>
                        <mi>p</mi>
                        <mrow>
                          <mi>k</mi>
                          <mo>+</mo>
                          <mn>1</mn>
                        </mrow>
                      </msup>
                    </mrow>
                    <mo>-</mo>
                    <msubsup>
                      <mi>&beta;</mi>
                      <mrow>
                        <mi>k</mi>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mn>2</mn>
                    </msubsup>
                  </mrow>
                  <msup>
                    <mi>p</mi>
                    <mi>k</mi>
                  </msup>
                </mfrac>
                <mo>)</mo>
              </mrow>
              <mo>&it;</mo>
              <mi>mod</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>p</mi>
            </mrow>
          </mrow>
          <mo>,</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>k</mi>
              <mo>&GreaterEqual;</mo>
              <mn>1</mn>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>&it;</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <mrow>
            <msub>
              <mi>&beta;</mi>
              <mi>k</mi>
            </msub>
            <mo>=</mo>
            <mrow>
              <munderover>
                <mo>&Sum;</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>0</mn>
                </mrow>
                <mi>k</mi>
              </munderover>
              <mo>&it;</mo>
              <mrow>
                <msub>
                  <mi>&alpha;</mi>
                  <mi>i</mi>
                </msub>
                <mo>&it;</mo>
                <mrow>
                  <msup>
                    <mi>p</mi>
                    <mi>i</mi>
                  </msup>
                  <mo>&af;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>k</mi>
                      <mo>&GreaterEqual;</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mo>,</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>151</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00103" file="US20030002662A1-20030102-M00103.NB"/>
<image id="EMI-M00103" wi="216.027" he="76.0914" file="US20030002662A1-20030102-M00103.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, using this result, </claim-text>
<claim-text>(g) calculating an expression (152): </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00104">
<number>104</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mi>p</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <munderover>
            <mo>&Sum;</mo>
            <mrow>
              <mi>i</mi>
              <mo>=</mo>
              <mn>0</mn>
            </mrow>
            <mrow>
              <mi>d</mi>
              <mo>-</mo>
              <mn>1</mn>
            </mrow>
          </munderover>
          <mo>&it;</mo>
          <mrow>
            <msub>
              <mi>&alpha;</mi>
              <mi>i</mi>
            </msub>
            <mo>&it;</mo>
            <msup>
              <mi>p</mi>
              <mi>i</mi>
            </msup>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>152</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00104" file="US20030002662A1-20030102-M00104.NB"/>
<image id="EMI-M00104" wi="216.027" he="25.9119" file="US20030002662A1-20030102-M00104.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>(h) calculating an expression (153): </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00105">
<number>105</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mi>q</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <msup>
            <mi>y</mi>
            <mfrac>
              <mrow>
                <mi>q</mi>
                <mo>+</mo>
                <mn>1</mn>
              </mrow>
              <mn>4</mn>
            </mfrac>
          </msup>
          <mo>&it;</mo>
          <mi>mod</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mi>q</mi>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>153</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00105" file="US20030002662A1-20030102-M00105.NB"/>
<image id="EMI-M00105" wi="216.027" he="15.11055" file="US20030002662A1-20030102-M00105.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, concerning each of expressions &phgr;(x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>), and &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>) (where, <highlight><bold>100</bold></highlight> designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by Chinese remainder theorem), </claim-text>
<claim-text>(i) setting each of said expressions to be as given by an expression (154): </claim-text>
<claim-text><in-line-formula><highlight><italic>s&prime;&par;t&prime; (s&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>, t&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k0</superscript></highlight>)&emsp;&emsp;(154) </in-line-formula></claim-text>
<claim-text>&emsp;and </claim-text>
<claim-text>(j) calculating an expression (155): </claim-text>
<claim-text><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>&prime;)&oplus;<highlight><italic>t&prime;, </italic></highlight></in-line-formula><in-line-formula><highlight><italic>x&prime;&par;z&prime;&equals;s&prime;&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>&prime;) (<highlight><italic>x&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n</superscript></highlight><highlight><italic>, z&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>)&emsp;&emsp;(155) </in-line-formula></claim-text>
<claim-text>&emsp;and </claim-text>
<claim-text>(k) obtaining a decryption result given by an expression (156): </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00106">
<number>106</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>x</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mrow>
                  <mi>if</mi>
                  <mo>&it;</mo>
                  <mstyle>
                    <mtext>&emsp;</mtext>
                  </mstyle>
                  <mo>&it;</mo>
                  <msup>
                    <mi>z</mi>
                    <mi>&prime;</mi>
                  </msup>
                </mrow>
                <mo>=</mo>
                <msup>
                  <mn>0</mn>
                  <msub>
                    <mi>k</mi>
                    <mn>1</mn>
                  </msub>
                </msup>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>156</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00106" file="US20030002662A1-20030102-M00106.NB"/>
<image id="EMI-M00106" wi="216.027" he="23.04855" file="US20030002662A1-20030102-M00106.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;where, it is stipulated that, in a case where said decryption result is * or invalid, said receiver-side apparatus denies said ciphertext. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00053">
<claim-text><highlight><bold>53</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00055">claim 52</dependent-claim-reference>, wherein said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00054">
<claim-text><highlight><bold>54</bold></highlight>. A public-key encryption method where a sender-side apparatus encrypts transmission data by using a public key of a receiver, comprising the steps of: 
<claim-text>as key generation steps, 
<claim-text>(a) creating a secret key given by an expression (157): </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>p,q</italic></highlight>: prime numbers, </in-line-formula><in-line-formula><highlight><italic>p&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4), <highlight><italic>q&equiv;</italic></highlight>3(<highlight><italic>mod</italic></highlight>4)&emsp;&emsp;(157) </in-line-formula></claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>(b) creating said public key given by an expression (158): </claim-text>
<claim-text><in-line-formula>&bull;<highlight><italic>N&equals;p</italic></highlight><highlight><superscript>d</superscript></highlight><highlight><italic>q </italic></highlight>(<highlight><italic>d </italic></highlight>is odd number) </in-line-formula><in-line-formula>&bull;<highlight><italic>k&equals;&verbar;N&verbar;</italic></highlight></in-line-formula><in-line-formula>&bull;<highlight><italic>G:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>n</superscript></highlight>hash function, </in-line-formula><in-line-formula>&bull;<highlight><italic>H:&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>0 </subscript></highlight></superscript></highlight>hash function </in-line-formula><in-line-formula>&bull;<highlight><italic>H&prime;: &lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n&plus;k</superscript></highlight><highlight><superscript><highlight><subscript>0</subscript></highlight></superscript></highlight>&rarr;&lcub;0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1 </subscript></highlight></superscript></highlight>hash function&emsp;&emsp;(158) </in-line-formula></claim-text>
<claim-text>&emsp;wherein 
<claim-text>(I) said sender-side apparatus 
<claim-text>selects a random number r&isin;&lcub;0, 1&rcub;<highlight><superscript>k0 </superscript></highlight>for a plaintext x (x&isin;&lcub;0, 1&rcub;<highlight><superscript>n</superscript></highlight>), and </claim-text>
</claim-text>
</claim-text>
<claim-text>(c) calculates an expression (159): </claim-text>
<claim-text><in-line-formula><highlight><italic>s</italic></highlight>&equals;(<highlight><italic>x&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>))&par;<highlight><italic>H</italic></highlight>&prime;(<highlight><italic>x&par;r</italic></highlight>), </in-line-formula><in-line-formula><highlight><italic>t&equals;H</italic></highlight>(<highlight><italic>s</italic></highlight>)&oplus;<highlight><italic>r,</italic></highlight>&emsp;&emsp;(159) </in-line-formula></claim-text>
<claim-text>&emsp;where, n&plus;k<highlight><subscript>0</subscript></highlight>&plus;k<highlight><subscript>1</subscript></highlight>&equals;k, and further, </claim-text>
<claim-text>(d) calculates an expression (160): </claim-text>
<claim-text><in-line-formula><highlight><italic>w&equals;s&par;t,</italic></highlight>&emsp;&emsp;(160) </in-line-formula></claim-text>
<claim-text>&emsp;and </claim-text>
<claim-text>(e) calculates an expression (161): </claim-text>
<claim-text><in-line-formula><highlight><italic>y&equals;w</italic></highlight><highlight><superscript>2</superscript></highlight><highlight><italic>modN,</italic></highlight>&emsp;&emsp;(161) </in-line-formula></claim-text>
<claim-text>&emsp;and 
<claim-text>defines this result y as a ciphertext so as to transmit said ciphertext to a receiver-side apparatus, </claim-text>
<claim-text>(II) said receiver-side apparatus, using said secret key of itself, </claim-text>
</claim-text>
<claim-text>(f) calculating, from said ciphertext y, an expression (162): </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00107">
<number>107</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>&alpha;</mi>
            <mn>0</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>y</mi>
              <mfrac>
                <mrow>
                  <mi>p</mi>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
                <mn>4</mn>
              </mfrac>
            </msup>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>&beta;</mi>
            <mn>0</mn>
          </msub>
          <mo>=</mo>
          <msub>
            <mi>&alpha;</mi>
            <mn>0</mn>
          </msub>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>&alpha;</mi>
            <mi>k</mi>
          </msub>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mn>1</mn>
              <mrow>
                <mn>2</mn>
                <mo>&it;</mo>
                <msub>
                  <mi>&beta;</mi>
                  <mrow>
                    <mi>k</mi>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
              </mrow>
            </mfrac>
            <mo>&it;</mo>
            <mrow>
              <mo>(</mo>
              <mfrac>
                <mrow>
                  <mrow>
                    <mi>y</mi>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <mi>mod</mi>
                    <mo>&it;</mo>
                    <mstyle>
                      <mtext>&emsp;</mtext>
                    </mstyle>
                    <mo>&it;</mo>
                    <msup>
                      <mi>p</mi>
                      <mrow>
                        <mi>k</mi>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                    </msup>
                  </mrow>
                  <mo>-</mo>
                  <msubsup>
                    <mi>&beta;</mi>
                    <mrow>
                      <mi>k</mi>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                    <mn>2</mn>
                  </msubsup>
                </mrow>
                <msup>
                  <mi>p</mi>
                  <mi>k</mi>
                </msup>
              </mfrac>
              <mo>)</mo>
            </mrow>
            <mo>&it;</mo>
            <mi>mod</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>p</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>&NewLine;</mtext>
        </mstyle>
        <mo>&it;</mo>
        <mrow>
          <msub>
            <mi>&beta;</mi>
            <mi>k</mi>
          </msub>
          <mo>=</mo>
          <mrow>
            <munderover>
              <mo>&Sum;</mo>
              <mrow>
                <mi>i</mi>
                <mo>=</mo>
                <mn>0</mn>
              </mrow>
              <mi>k</mi>
            </munderover>
            <mo>&it;</mo>
            <mrow>
              <msub>
                <mi>&alpha;</mi>
                <mi>i</mi>
              </msub>
              <mo>&it;</mo>
              <mrow>
                <msup>
                  <mi>p</mi>
                  <mi>i</mi>
                </msup>
                <mo>&af;</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>k</mi>
                    <mo>&GreaterEqual;</mo>
                    <mn>1</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>162</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00107" file="US20030002662A1-20030102-M00107.NB"/>
<image id="EMI-M00107" wi="216.027" he="76.0914" file="US20030002662A1-20030102-M00107.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, using this result, </claim-text>
<claim-text>(g) calculating an expression (163): </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00108">
<number>108</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mi>p</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <munderover>
            <mo>&Sum;</mo>
            <mrow>
              <mi>i</mi>
              <mo>=</mo>
              <mn>0</mn>
            </mrow>
            <mrow>
              <mi>d</mi>
              <mo>-</mo>
              <mn>1</mn>
            </mrow>
          </munderover>
          <mo>&it;</mo>
          <mrow>
            <msub>
              <mi>&alpha;</mi>
              <mi>i</mi>
            </msub>
            <mo>&it;</mo>
            <msup>
              <mi>p</mi>
              <mi>i</mi>
            </msup>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>163</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00108" file="US20030002662A1-20030102-M00108.NB"/>
<image id="EMI-M00108" wi="216.027" he="25.9119" file="US20030002662A1-20030102-M00108.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and further, </claim-text>
<claim-text>(h) calculating an expression (164): </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00109">
<number>109</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>x</mi>
          <mi>q</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <msup>
            <mi>y</mi>
            <mfrac>
              <mrow>
                <mi>q</mi>
                <mo>+</mo>
                <mn>1</mn>
              </mrow>
              <mn>4</mn>
            </mfrac>
          </msup>
          <mo>&it;</mo>
          <mi>mod</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mi>q</mi>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>164</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00109" file="US20030002662A1-20030102-M00109.NB"/>
<image id="EMI-M00109" wi="216.027" he="15.11055" file="US20030002662A1-20030102-M00109.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;and, concerning each of expressions &phgr;(x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, x<highlight><subscript>q</subscript></highlight>), &phgr;(x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>), and &phgr;(&minus;x<highlight><subscript>p</subscript></highlight>, &minus;x<highlight><subscript>q</subscript></highlight>) where, &phgr; designates a ring isomorphism mapping from Z/(p)&times;Z/(q) to Z/(pq) by Chinese remainder theorem, </claim-text>
<claim-text>(i) setting each of said expressions to be as given by an expression (165): </claim-text>
<claim-text><in-line-formula><highlight><italic>s&prime;&par;z&prime;&par;t&prime; </italic></highlight>(<highlight><italic>s&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n</superscript></highlight><highlight><italic>, z&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k</superscript></highlight><highlight><superscript><highlight><subscript>1</subscript></highlight></superscript></highlight><highlight><italic>, t&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>k0</superscript></highlight>)&emsp;&emsp;(165) </in-line-formula></claim-text>
<claim-text>&emsp;and </claim-text>
<claim-text>(j) calculating an expression (166): </claim-text>
<claim-text><in-line-formula><highlight><italic>r&prime;&equals;H</italic></highlight>(<highlight><italic>s&prime;&par;z&prime;</italic></highlight>)&oplus;<highlight><italic>t&prime;, </italic></highlight></in-line-formula><in-line-formula><highlight><italic>x&prime;&equals;s&prime;&oplus;G</italic></highlight>(<highlight><italic>r</italic></highlight>&prime;) (<highlight><italic>x&prime;&isin;&lcub;</italic></highlight>0,1&rcub;<highlight><superscript>n</superscript></highlight>)&emsp;&emsp;(166) </in-line-formula></claim-text>
<claim-text>&emsp;and </claim-text>
<claim-text>(k) obtaining a decryption result given by an expression (167): </claim-text>
<claim-text> 
<math-cwu id="MATH-US-00110">
<number>110</number>
<math>
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <msup>
                <mi>x</mi>
                <mi>&prime;</mi>
              </msup>
            </mtd>
            <mtd>
              <mrow>
                <mi>if</mi>
                <mo>&it;</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mrow>
                  <msup>
                    <mi>H</mi>
                    <mi>&prime;</mi>
                  </msup>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <mrow>
                        <msup>
                          <mi>x</mi>
                          <mi>&prime;</mi>
                        </msup>
                        <mo>&it;</mo>
                        <mrow>
                          <mo>&LeftDoubleBracketingBar;</mo>
                          <msup>
                            <mi>r</mi>
                            <mi>&prime;</mi>
                          </msup>
                        </mrow>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>=</mo>
                    <msup>
                      <mi>z</mi>
                      <mi>&prime;</mi>
                    </msup>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mo>*</mo>
            </mtd>
            <mtd>
              <mi>otherwise</mi>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>167</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
<mathematica-file id="MATHEMATICA-00110" file="US20030002662A1-20030102-M00110.NB"/>
<image id="EMI-M00110" wi="216.027" he="22.08465" file="US20030002662A1-20030102-M00110.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</claim-text>
<claim-text>&emsp;where, it is stipulated that, in a case where said decryption result is *, said receiver-side apparatus denies said ciphertext. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00055">
<claim-text><highlight><bold>55</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00055">claim 54</dependent-claim-reference>, wherein said receiver-side apparatus generates and publishes said publication information. </claim-text>
</claim>
<claim id="CLM-00056">
<claim-text><highlight><bold>56</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00055">claim 52</dependent-claim-reference>, wherein said sender-side apparatus publishes or transmits a Jacobi symbol (w/N), said sender-side apparatus also publishing information or transmitting said information to said receiver-side apparatus, said information indicating a large-or-small relationship between a value of w and that of N/2. </claim-text>
</claim>
<claim id="CLM-00057">
<claim-text><highlight><bold>57</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00055">claim 52</dependent-claim-reference>, wherein, as said prime numbers constituting said secret key, prime numbers of a form of 2p&prime;&plus;1 are selected with respect to another prime numbers p&prime;. </claim-text>
</claim>
<claim id="CLM-00058">
<claim-text><highlight><bold>58</bold></highlight>. The public-key encryption method as claimed in <dependent-claim-reference depends_on="CLM-00055">claim 52</dependent-claim-reference>, wherein a value of d (d&gE;1) is set to be variable.</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>4</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030002662A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030002662A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030002662A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030002662A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030002662A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030002662A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030002662A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030002662A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030002662A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00009">
<image id="EMI-D00009" file="US20030002662A1-20030102-D00009.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00010">
<image id="EMI-D00010" file="US20030002662A1-20030102-D00010.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00011">
<image id="EMI-D00011" file="US20030002662A1-20030102-D00011.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00012">
<image id="EMI-D00012" file="US20030002662A1-20030102-D00012.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00013">
<image id="EMI-D00013" file="US20030002662A1-20030102-D00013.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00014">
<image id="EMI-D00014" file="US20030002662A1-20030102-D00014.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00015">
<image id="EMI-D00015" file="US20030002662A1-20030102-D00015.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00016">
<image id="EMI-D00016" file="US20030002662A1-20030102-D00016.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00017">
<image id="EMI-D00017" file="US20030002662A1-20030102-D00017.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
