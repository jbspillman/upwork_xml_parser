<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030002708A1-20030102-D00000.TIF SYSTEM "US20030002708A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030002708A1-20030102-D00001.TIF SYSTEM "US20030002708A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030002708A1-20030102-D00002.TIF SYSTEM "US20030002708A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030002708A1-20030102-D00003.TIF SYSTEM "US20030002708A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030002708A1-20030102-D00004.TIF SYSTEM "US20030002708A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030002708A1-20030102-D00005.TIF SYSTEM "US20030002708A1-20030102-D00005.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030002708</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10080569</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20020225</filing-date>
</domestic-filing-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>G06K009/00</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>382</class>
<subclass>100000</subclass>
</uspc>
</classification-us-primary>
</classification-us>
<title-of-invention>System and method for watermark detection</title-of-invention>
</technical-information>
<continuity-data>
<non-provisional-of-provisional>
<document-id>
<doc-number>60270594</doc-number>
<document-date>20010223</document-date>
<country-code>US</country-code>
</document-id>
</non-provisional-of-provisional>
</continuity-data>
<inventors>
<first-named-inventor>
<name>
<given-name>Joe</given-name>
<family-name>Pasqua</family-name>
</name>
<residence>
<residence-us>
<city>Menlo Park</city>
<state>CA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
</inventors>
<correspondence-address>
<name-1>Tyler S. Brown</name-1>
<name-2>Morrison &amp; Foerster LLP</name-2>
<address>
<address-1>2000 Pennsylvania Ave., N.W.</address-1>
<city>Washington</city>
<state>DC</state>
<postalcode>20006-1888</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">A system and method is provided for increasing watermark detection speed and accuracy by using detection information during the detection process. When a source document is watermarked, detection information is determined and stored for later use in the detection process. The detection information can be in any format and includes information about the features of the source document wherein the watermark information is embedded. During detection of watermark values in a non-source document, the watermark detector uses the detection information to determine which of the non-source document features contain the watermark information. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">FIELD OF THE INVENTION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> The present invention relates to a system and method for watermark detection in a dissimilar target media. More particularly, the present invention relates to using source media analysis to aid watermark detection in a dissimilar target media. </paragraph>
</section>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> When watermarking the electronic form of a textual document it is often desirable to be able to detect the watermark from either the electronic form or from a hardcopy. The hardcopy pages are scanned into the computer resulting in an image of each page. In this form a great deal of semantic information has been lost. For example, there is no notion of a word or a paragraph&mdash;there are just pixels. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> This is a problem for many document watermarking algorithms because they use changes to things like line spacing or margins to carry the watermark information. Thus, to detect the watermark, these features must be found. </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> Because of the loss of semantic information, a great deal of processing must be performed to infer the features of the original document. For instance, one must use analytic techniques to determine which pieces of the page are text, which are line art, and which are images. This is necessary to correctly locate and synchronize to the embedded watermark. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> Watermarking techniques usually embed and detect watermarks in semantically equivalent representations of the content. For example, an image watermarking scheme embeds and detects watermarks in images. In the area of watermarking textual documents, other techniques for detecting watermarks from hard copy deal only with operating in the image space. For example, see U.S. Pat. Nos. 6,086,706 and 5,629,770. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> Some watermarking systems perform an analysis of the piece of source content and store information that will be used later to speed the application of watermarks in that same piece of content later. The idea is that if a given piece of content is to be watermarked a number of times with different watermark values, the content can be preprocessed when it is first encountered to derive information that will make the subsequent application of watermarks faster. In these systems, the analysis and the information derived from the analysis both apply to the same form of content. In addition, these systems use the information only at embedding time. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> These sorts of image analysis can be slow, produce inexact results, and in some cases are guaranteed to produce an incorrect result. A need exists for a way to detect watermarks in the scanned image of the hardcopy of a textual document without having to perform costly, and potentially incorrect, image analysis. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> The present invention provides a system and method for overcoming the disadvantages and drawbacks of conventional systems. This invention provides a system and method for using source media analysis to aid in watermark detection in a dissimilar target media. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> In accordance with one embodiment of the present invention, a method of watermark detection is provided. The method of watermark detection includes analyzing a source document, embedding the watermark information in the source document, determining detection information, analyzing a nonsource document, and using the detection information to determine the watermark value for the nonsource document. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> In accordance with one embodiment of the invention, a system for watermark detection using analysis information of the source document in the detection is provided. The system includes a first computer system that embeds watermark information in a source document and determines detection information for the source document, and a detection system including a watermark detector that detects a watermark value for a nonsource document using the detection information generated by the first computer system. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> Still other embodiments of the present invention will become apparent to those skilled in the art from the following detail description, wherein is shown and described only the embodiments of the invention by way of illustration of the best moods contemplated for carrying out the invention. As will be realized, the invention was capable of modification in various obvious aspects, all without departing from the spirit and scope of the present invention. Accordingly, the drawings and details description ought to be regarded as illustrative in nature and not restrictive. </paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> depicts an example of the source document. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> depicts one embodiment of the processing steps and data flow. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> depicts an example page. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> depicts an example of the process according to one embodiment of the invention. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> depicts a block diagram of a system according to one embodiment of the invention.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF THE INVENTION </heading>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> This invention provides a faster, more accurate way to detect watermarks in the hardcopy version of a document. The invention uses information present in the semantically rich representation of a source document to facilitate the efficient and accurate detection of a watermark in a semantically poor representation of the document. This situation arises since it is desirable to be able to watermark the electronic form of a document and detect the watermark in a hardcopy version. The hardcopy is scanned into the computer and represented as an image. The image is semantically poor since it contains none of the higher level information present in the original such as the words, lines, paragraphs, etc. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> The present invention analyzes a semantically rich source document <highlight><bold>10</bold></highlight> to determine information about the features <highlight><bold>12</bold></highlight> that will carry the watermark information <highlight><bold>14</bold></highlight>. The semantically rich source document <highlight><bold>10</bold></highlight> can be in any form such as Adobe PDF or Microsoft Word. The set of documents features <highlight><bold>12</bold></highlight> in the source document <highlight><bold>10</bold></highlight> are features that may be used to carry the watermark information <highlight><bold>14</bold></highlight>. The features <highlight><bold>12</bold></highlight> could be lines, words, paragraphs, margins, or any number of features. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> The detection information <highlight><bold>16</bold></highlight> gathered by the analysis of the source document <highlight><bold>10</bold></highlight> is preferably stored in the form that can be interpreted by a watermark detector <highlight><bold>18</bold></highlight>. The watermark detector <highlight><bold>18</bold></highlight> operates on a semantically poor representation of the document <highlight><bold>20</bold></highlight>. The semantically poor version <highlight><bold>20</bold></highlight> of the watermark document can be in any format such as image formats TIFF, GIF, or JPEG. The detection information <highlight><bold>16</bold></highlight> is used by the watermark detector <highlight><bold>18</bold></highlight> to locate in document <highlight><bold>20</bold></highlight> the features <highlight><bold>12</bold></highlight> that were used to carry the watermark information <highlight><bold>14</bold></highlight>. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> The present intervention provides many benefits including increased detection speed and detection accuracy. For example, without detection information <highlight><bold>16</bold></highlight>, the watermark detector <highlight><bold>18</bold></highlight> would have to use image analysis operations to find the relevant features <highlight><bold>12</bold></highlight>. Such an approach would involve segmenting the import document <highlight><bold>20</bold></highlight> into general features <highlight><bold>22</bold></highlight> of various types and determining a correspondence between these general features <highlight><bold>22</bold></highlight> and the watermark features <highlight><bold>12</bold></highlight> used to carry the watermark. The general features <highlight><bold>22</bold></highlight> can be such things as characters, words, lines, line art or images. By referring to an image analysis operation to find the relevant features, the detection process is significantly slowed. Thus, having a description of the watermark features <highlight><bold>12</bold></highlight> that is derived from the source document <highlight><bold>10</bold></highlight> obviates the need for this sort of costly image processing. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> The following example illustrates the distinctions between the detection information <highlight><bold>16</bold></highlight> and the watermark information <highlight><bold>14</bold></highlight>. The watermark information <highlight><bold>14</bold></highlight> could be the name of the recipient of the source document <highlight><bold>10</bold></highlight>. This watermark might be encoded into the document by shifting the position of lines or words within lines to encode bits of the name. To extract the watermark information <highlight><bold>14</bold></highlight>, the detector must be able to find the lines or words into which the watermark has been encoded. The detection information <highlight><bold>16</bold></highlight> tells the detector where to find these lines on the page. For example, one bit of the watermark information <highlight><bold>14</bold></highlight> might be encoded as a shift in the margin of a line of text in the source document <highlight><bold>10</bold></highlight>. The line of text is a document feature <highlight><bold>12</bold></highlight>. Identifying a line of text in the source document <highlight><bold>10</bold></highlight> is easy to do since the source document, e.g. a Microsoft Word file, carries this information directly. Identifying the line of text in a scanned image of the document can be difficult and inaccurate since the image must be analyzed and the line structure inferred by the detector. To avoid this difficulty, the present invention collects the location of the line on the page from the source document <highlight><bold>10</bold></highlight> and stores it as part of the detection information <highlight><bold>16</bold></highlight>. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> Another example involves watermarking a graphic composed of lines and arcs. The watermarking algorithm embeds the watermark information <highlight><bold>14</bold></highlight> into the rich source document <highlight><bold>10</bold></highlight> where lines and arcs are clearly identified and their positions are known precisely. The watermarking algorithm modifies the lines and arcs (document features <highlight><bold>12</bold></highlight>) to carry the watermark information <highlight><bold>14</bold></highlight>. When the watermark information is to be extracted from an image representation of the document, the detector would have to analyze the image to find the lines and arcs that carry the watermark information. Once again, this is error prone and slow. To avoid this, the watermark embedding program collects detection information <highlight><bold>16</bold></highlight> that is readily available in the source document <highlight><bold>10</bold></highlight> about the location of the lines and arcs (document features <highlight><bold>12</bold></highlight>) that carry the watermark information <highlight><bold>14</bold></highlight>. At watermark detection time, the detector uses the detection information <highlight><bold>16</bold></highlight> to locate the relevant lines and arcs rather than doing a slow and inexact image analysis. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> The invention increases detection accuracy since the objects used to carry the watermark need not be inferred from an analysis of the page image. Such an analysis can be flawed due to noise in the semantically poor document <highlight><bold>20</bold></highlight> and other factors. After all, an image analyzer is ultimately just making an educated guess about which pixels correspond to which high level features. In some cases it is impossible to accurately determine the features <highlight><bold>12</bold></highlight> as they are known in the source document <highlight><bold>10</bold></highlight>. In, for example, a watermarking scheme that varies the position of lines of text in a document to carry watermark information, the detector must determine which pixels in the semantically poor document <highlight><bold>20</bold></highlight> correspond to lines of text in the source document <highlight><bold>10</bold></highlight>. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> Consider an original document that contains an image of a tree and ten lines of text. A good image analysis module might accurately segment the page into an image object and ten lines of text. The detector could then analyze the locations of the lines of text to extract the watermark. Now consider a page that contains the same ten lines of text, but replaces the image of the tree with a picture of a book cover (see <cross-reference target="DRAWINGS">FIG. 1</cross-reference>). From the perspective of the watermark embedding software, the picture of the book cover is just an image, and therefore contains no lines of text that will contribute to carrying the watermark data. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> From the perspective of a detector operating on the semantically poor document <highlight><bold>20</bold></highlight>, there is no way to distinguish between a line of text that is part of the picture of the book cover and one of the ten actual lines of text. The detector will not be able to accurately extract the watermark since it cannot determine which features of the semantically poor document <highlight><bold>20</bold></highlight> correspond to the features of source document <highlight><bold>10</bold></highlight>. This is a single example of the detector being confused by lack of semantic information in the semantically poor document <highlight><bold>10</bold></highlight>. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> In this invention, the system and method preferably identify the features <highlight><bold>12</bold></highlight> that are used to carry watermark information <highlight><bold>14</bold></highlight> in the source document <highlight><bold>10</bold></highlight> and where they are located on the page. We store this detection information <highlight><bold>16</bold></highlight> so that it can later be used by the detector <highlight><bold>18</bold></highlight> (see <cross-reference target="DRAWINGS">FIG. 2</cross-reference>). Given detection information <highlight><bold>16</bold></highlight>, the detector does not have to guess at the features based on image analysis. It can make use of the correct information that was derived from source document <highlight><bold>10</bold></highlight>. </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> The precise format of detection information <highlight><bold>16</bold></highlight> and the data it carries can be tailored to the watermarking algorithm being employed. That is, not all of the semantic information of source document <highlight><bold>10</bold></highlight> needs to be carried in detection information <highlight><bold>16</bold></highlight>. Only information relevant to the watermarking algorithm needs to be preserved. Detection information <highlight><bold>16</bold></highlight> can be expressed in any format desired. The examples in this description use a particular schema of the Extensible Markup Language (XML) to carry the information. </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> The following example demonstrates a use of this invention with a particular watermarking algorithm. This is merely meant as an illustration and is not the only way that this invention can be used. A person skilled in the art can see that a major utility of this invention is that it can be applied to many different watermarking algorithms operating in the domain of electronic documents whose watermarks must be detected from printed versions. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> Consider a textual watermarking scheme that relies on the spacing between words to carry watermark data. Such an approach is described in U.S. Pat. Nos. 6,086,706 and 5,629,770, incorporated herein by reference. This scheme changes the spacing between specific groups of words and it is those changes that carry the watermark data. In order to detect the watermark in the semantically poor document <highlight><bold>20</bold></highlight>, the words that carry the watermark data must be located. </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> If the detector <highlight><bold>18</bold></highlight> relies on image analysis to find the words on a page, it could easily be fooled by words that were not present as text in source document <highlight><bold>10</bold></highlight> (refer to the discussion above and see <cross-reference target="DRAWINGS">FIG. 1</cross-reference>). </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> Instead, the present invention could identify the words of source document <highlight><bold>10</bold></highlight> used to carry the watermark and store their locations in detection information <highlight><bold>16</bold></highlight>. Later, the detector <highlight><bold>18</bold></highlight> would use detection information <highlight><bold>16</bold></highlight> to locate the words in the semantically poor document <highlight><bold>20</bold></highlight>. The following XML structure is an example of how detection information <highlight><bold>16</bold></highlight> might be represented in this case.  
<table-cwu id="TABLE-US-00001">
<number>1</number>
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="OFFSET" colwidth="14PT" align="left"/>
<colspec colname="1" colwidth="203PT" align="left"/>
<thead>
<row>
<entry></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry namest="OFFSET" nameend="1" align="center" rowsep="1"></entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry></entry>
<entry>&lt;Document name&equals;&ldquo;The Rooster Crowed at Midnight&rdquo;&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&lt;Page number&equals;&ldquo;1&rdquo;&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&lt;Block numberOfLinesInBlock&equals;&ldquo;33&rdquo;&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&emsp;&lt;BoundingBox x&equals;&ldquo;0&rdquo; y&equals;&ldquo;0&rdquo; w&equals;&ldquo;2400&rdquo; h&equals;&ldquo;1700&rdquo;/&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&emsp;&lt;LineOfWords&equals;number&equals;&ldquo;1&rdquo; numberOfWords&equals;&ldquo;13&rdquo;&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&emsp;&emsp;3, 7, 10</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&emsp;&lt;/LineOfWords&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&emsp;&lt;LineOfWords number&equals;&ldquo;3&rdquo; numberOfWords&equals;&ldquo;17&rdquo;&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&emsp;&emsp;2, 9, 12, 15</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&emsp;&lt;/LineOfWords&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&emsp;. . .</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&lt;/Block&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&lt;Block numberOfLines&equals;&ldquo;27&rdquo;&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&emsp;. . .</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&lt;/Block&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&lt;/Page&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&lt;Page number&equals;&ldquo;122&rdquo;&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;. . .</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&lt;/Page&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&lt;/Document&gt;</entry>
</row>
<row>
<entry></entry>
<entry namest="OFFSET" nameend="1" align="center" rowsep="1"></entry>
</row>
</tbody>
</tgroup>
</table>
</table-cwu>
</paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> This structure contains an element that corresponds to each page of the document that carries watermark information. Each page is segmented into non-overlapping blocks of text. Each block specifies its bounding box (i.e. location and size) as well as the number of lines of text that are present in the original. This number may be used as part of the detection algorithm or just for consistency checking. Each block element contains some number of LineOfWords elements. Each of these represents a line of text and identifies the number of the line in the block, the number of words in the line, and the index of each word that can carry watermark information. </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> In the example above, the first page contains two blocks. The first block contains several LineOfWords items. The first of those identifies words 3, 7, and 10 as those that can be shifted in order carry the watermark information. </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> This structure would not have any block that corresponds to an image since images contain no accessible words. Thus the image of the book cover in <cross-reference target="DRAWINGS">FIG. 1</cross-reference> would be omitted from this structure thereby avoiding confusion over which words should be included in the watermark detection process. </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> In another example, a watermark is embedded in a source document <highlight><bold>10</bold></highlight> that is a graphic composed of lines and arcs. The watermark information <highlight><bold>14</bold></highlight> is embedded by making subtle modifications to a subset of the lines and arcs in the graphic. These are the document features <highlight><bold>12</bold></highlight>. During the embedding process the location and shape of each document feature used to carry a part of the watermark is collected and stored as detection information <highlight><bold>16</bold></highlight>. The following XML structure is an example of how the detection information <highlight><bold>16</bold></highlight> might be represented in XML form.  
<table-cwu id="TABLE-US-00002">
<number>2</number>
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="OFFSET" colwidth="49PT" align="left"/>
<colspec colname="1" colwidth="168PT" align="left"/>
<thead>
<row>
<entry></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry namest="OFFSET" nameend="1" align="center" rowsep="1"></entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry></entry>
<entry>&lt;Graphic name&equals;&ldquo;My Company Logo&rdquo;&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&lt;Shape type&equals;&ldquo;Line&rdquo;&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&lt;StartPoint x&equals;&ldquo;58.93&rdquo; y&equals;&ldquo;4.88&rdquo;&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&lt;EndPoint x&equals;&ldquo;103.2&rdquo; y&equals;&ldquo;63.03&rdquo;&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&lt;/Shape&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&lt;Shape type&equals;&ldquo;Arc&rdquo;&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&lt;Center x&equals;&ldquo;0&rdquo; y&equals;&ldquo;0&rdquo;&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&lt;Radius&gt;1&lt;/Radius&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&emsp;&lt;AngleRange start&equals;&ldquo;0&rdquo; end&equals;&ldquo;45&rdquo;&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;&lt;/Shape&gt;</entry>
</row>
<row>
<entry></entry>
<entry>&emsp;. . .</entry>
</row>
<row>
<entry></entry>
<entry>&lt;/Graphic&gt;</entry>
</row>
<row>
<entry></entry>
<entry namest="OFFSET" nameend="1" align="center" rowsep="1"></entry>
</row>
</tbody>
</tgroup>
</table>
</table-cwu>
</paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> This structure contains a Shape element corresponding to each document feature used to carry watermark information. Each Shape identifies itself as either a line or an arc and provides the relevant geometric information needed to describe it. The set of feature included in detection information <highlight><bold>16</bold></highlight> is normally a small subset of the total number of features in the document. Not all of the information from the source document <highlight><bold>10</bold></highlight> needs to be repeated in the detection information <highlight><bold>16</bold></highlight>. For example, the color associated with a given line or arc is not relevant here while it must be contained in the source document <highlight><bold>10</bold></highlight>. </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> The detection information <highlight><bold>16</bold></highlight> is a subset of the information in the source document <highlight><bold>10</bold></highlight>. It contains only data regarding features that either carry watermark information <highlight><bold>14</bold></highlight> or are used in aiding in the detection of that information. There need not be information about every document feature in the source. Furthermore, even for the document features that carry watermark information, not all of the information in the source document describing that feature needs to be included in the detection information <highlight><bold>16</bold></highlight>. For example, when embedding a watermark in textual information by modifying intra-line or intra-word spacing, information about type faces need not be carried. Only information about the locations of lines is relevant. By dropping information that is not needed by the detection process, the detection information <highlight><bold>16</bold></highlight> is made quite small relative to the source document <highlight><bold>10</bold></highlight>. </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> During the detection process, the detection information <highlight><bold>16</bold></highlight> is used to locate the document features that carry the watermark. In the Graphic example above, the detector would know that a line exists whose starting point is the coordinate (58.93, 4.88) and whose ending coordinate is (103.2, 63.03). The detector can use this information to find the line in the scanned image rather than having to perform complex algorithms such as a Hough Transform to locate the line. The same is true for arcs. The process makes available information about the document features that is easy to extract from the source document, but difficult to determine from the semantically poor document. </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> The overall flow of this process is as follows: </paragraph>
<paragraph id="P-0040" lvl="2"><number>&lsqb;0040&rsqb;</number> 1. Receive a source document <highlight><bold>10</bold></highlight> that is to be watermarked. </paragraph>
<paragraph id="P-0041" lvl="2"><number>&lsqb;0041&rsqb;</number> 2. Analyze source document <highlight><bold>10</bold></highlight> to determine the document features <highlight><bold>12</bold></highlight> that will be used to carry the watermark information. This analysis and the result resultant features <highlight><bold>12</bold></highlight> are dependent on the watermarking algorithm in use. </paragraph>
<paragraph id="P-0042" lvl="2"><number>&lsqb;0042&rsqb;</number> 3. Store detection information <highlight><bold>16</bold></highlight> about the nature and location of the features in a file. </paragraph>
<paragraph id="P-0043" lvl="2"><number>&lsqb;0043&rsqb;</number> 4. During detection, read detection information <highlight><bold>16</bold></highlight> to determine features <highlight><bold>12</bold></highlight>. Identify these features in semantically poor document <highlight><bold>20</bold></highlight> using the segmentation and location information provided in detection information <highlight><bold>16</bold></highlight>. </paragraph>
<paragraph id="P-0044" lvl="2"><number>&lsqb;0044&rsqb;</number> 5. Having identified and located the features of interest in semantically poor document <highlight><bold>20</bold></highlight>, use the watermark detection algorithm to read the watermark value. </paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> Source document <highlight><bold>10</bold></highlight> could be analyzed each time the detector <highlight><bold>18</bold></highlight> is run rather than just once as indicated above. Thus, if it is known in advance that the source document will be available at detection time, the creation of the detection information may be deferred until detection time. This might be a reasonable approach if: </paragraph>
<paragraph id="P-0046" lvl="2"><number>&lsqb;0046&rsqb;</number> detection information <highlight><bold>16</bold></highlight> is not used in the embedding process; </paragraph>
<paragraph id="P-0047" lvl="2"><number>&lsqb;0047&rsqb;</number> source document <highlight><bold>10</bold></highlight> will be present at detection time; and </paragraph>
<paragraph id="P-0048" lvl="2"><number>&lsqb;0048&rsqb;</number> it is undesirable to have to store and maintain detection information <highlight><bold>16</bold></highlight>. </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> Other schemes for watermarking textual documents rely on the locations of lines of text to embed a watermark. Examples of this approach can be found in U.S. Pat. Nos. 6,086,706 and 5,629,770. As in the example of word-shifting given above, line-shifting approaches also require the accurate detection of source features at detection time. In this case the features <highlight><bold>12</bold></highlight> of interest are lines of text and the analysis detection information <highlight><bold>16</bold></highlight> describes blocks of text and the lines in those blocks that are used to carry watermark and other information. For example, detection information <highlight><bold>16</bold></highlight> might indicate which lines have been deliberately left untouched to serve as reference points allowing the detector to better register the original document <highlight><bold>10</bold></highlight> to poor document <highlight><bold>20</bold></highlight>. </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> The source analysis phase would be a matter of decomposing the page into non-overlapping blocks of text content that excluded any areas containing non-text content. <cross-reference target="DRAWINGS">FIG. 3</cross-reference> shows how the sample page shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference> would be decomposed into blocks. Note that the text within the image of the book cover is not included in any block since it contains no text from the perspective of the source document <highlight><bold>10</bold></highlight>. A key benefit of this invention is that analysis in the source space is much simpler and more accurate than in the image space. </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> This method is applicable to a variety of techniques for watermarking documents. This allows a watermark algorithm provider to change or improve his offerings without having to find new image analysis methods that apply to the new offerings. </paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> A subsidiary benefit of this invention is that this same information may speed the application of transactional watermarks by providing the embedding program with information about which objects can carry watermark information, thus avoiding repeated analysis of source document <highlight><bold>10</bold></highlight>. </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> shows one embodiment of the process according to this invention. Step <highlight><bold>24</bold></highlight>, acquire source document <highlight><bold>10</bold></highlight>. Step <highlight><bold>26</bold></highlight>, analyze source document <highlight><bold>10</bold></highlight> for features <highlight><bold>12</bold></highlight>. </paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> Step <highlight><bold>28</bold></highlight>, insert watermark information <highlight><bold>14</bold></highlight> into source document <highlight><bold>10</bold></highlight>. Step <highlight><bold>30</bold></highlight>, determine detection information <highlight><bold>16</bold></highlight> and store detection information <highlight><bold>16</bold></highlight>. </paragraph>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> Step <highlight><bold>32</bold></highlight>, acquire hard copy <highlight><bold>20</bold></highlight>. Step <highlight><bold>34</bold></highlight>, scan hard copy <highlight><bold>20</bold></highlight>. Step <highlight><bold>36</bold></highlight>, use detection information <highlight><bold>16</bold></highlight> to locate features <highlight><bold>12</bold></highlight> and hard copy <highlight><bold>20</bold></highlight>. Step <highlight><bold>38</bold></highlight>, determine watermark value in features <highlight><bold>12</bold></highlight>. </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> shows one example of the system according to the present invention. Computer system <highlight><bold>40</bold></highlight> is connected to a document source <highlight><bold>42</bold></highlight> and connection <highlight><bold>44</bold></highlight>. Computer system <highlight><bold>40</bold></highlight> can be a type of system that is able to acquire, analyze, and insert watermark information into a document. Document source <highlight><bold>42</bold></highlight> can be any number of components containing a source document <highlight><bold>10</bold></highlight> such as a database connected to system <highlight><bold>40</bold></highlight> locally or a remote database connected to the system through a network connection. In addition, document source <highlight><bold>42</bold></highlight> could be a scanner that scans a hard copy of an original creating a semantically rich source document using, for example, an OCR process. Computer system <highlight><bold>40</bold></highlight> acquires the source document <highlight><bold>10</bold></highlight> from document source <highlight><bold>42</bold></highlight>. As described, for example, in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>, system <highlight><bold>40</bold></highlight> analyzes the source document <highlight><bold>10</bold></highlight> to determine the features <highlight><bold>12</bold></highlight> and insert watermarking information <highlight><bold>14</bold></highlight> into features <highlight><bold>12</bold></highlight>. Computer system <highlight><bold>40</bold></highlight> also determines detection information <highlight><bold>16</bold></highlight> and stores detection information <highlight><bold>16</bold></highlight> for use in the detection process. Detection information <highlight><bold>16</bold></highlight> can be in any format and includes information allowing the detection of the relevant features to be analyzed for determination of the watermark value in those features. Computer system <highlight><bold>40</bold></highlight> is also connected to a distribution or publication component such as printer <highlight><bold>46</bold></highlight>. </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> Once the distribution or publication component generates a hard copy, the hard copy is distributed through normal channels. When a hard copy is acquired and the watermark for that hard copy needs to be determined, detection system <highlight><bold>48</bold></highlight> can be employed. The detection system <highlight><bold>48</bold></highlight> can be the same as computer system <highlight><bold>40</bold></highlight> or an entirely different detection system. In this example, the hard copy is analyzed by scanner <highlight><bold>50</bold></highlight> and is connected to the detection system <highlight><bold>48</bold></highlight>. Detection system <highlight><bold>48</bold></highlight> requires and uses detection information <highlight><bold>16</bold></highlight> to determine the relevant features <highlight><bold>12</bold></highlight> that contain a watermark information <highlight><bold>14</bold></highlight>. A watermark detector <highlight><bold>18</bold></highlight> will then be employed on the scanned hard copy to determine the watermark value of the relevant features <highlight><bold>12</bold></highlight>. The watermarked source document need not be printed at system <highlight><bold>40</bold></highlight>, it could be distributed electronically and printed elsewhere. </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> Although the invention has been described relative to a particular embodiment, one of skill in the art will appreciate that this description is merely exemplary and the system and method of this invention may include additional or different components, while operating within the scope of the invention. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is claimed is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. A method of watermarking a document comprising: 
<claim-text>acquire a source document; </claim-text>
<claim-text>analyzing the source document for features; </claim-text>
<claim-text>inserting watermark information into the features of the source document; </claim-text>
<claim-text>determining detection information; </claim-text>
<claim-text>storing the detection information; </claim-text>
<claim-text>acquiring a nonsource document; </claim-text>
<claim-text>scanning the nonsource document; </claim-text>
<claim-text>locating the features in the nonsource document using the detection information; and </claim-text>
<claim-text>determining a watermark value of the nonsource document. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The method of watermarking a document according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the detection information includes information of the location of the features. </claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The method of watermarking a document according to <dependent-claim-reference depends_on="CLM-00002">claim 2</dependent-claim-reference>, wherein the source document is a semantically rich document and the nonsource document is a semantically poor document. </claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The method of watermarking a document according to <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein the non-source document is a hardcopy of the source document. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. A method of watermark detection, comprising: 
<claim-text>analyzing a semantically rich document; </claim-text>
<claim-text>determining detection information based on the analysis of the semantically rich document, the detection information including information on the watermark features and location of the watermark features; </claim-text>
<claim-text>scanning a semantically poor document; and </claim-text>
<claim-text>determining a watermark value of the semantically poor document using the detection information. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The method of watermark detection according to <dependent-claim-reference depends_on="CLM-00005">claim 5</dependent-claim-reference>, wherein the semantically rich document is an electronic document and the semantically poor document is a hardcopy. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. A method of watermark detection, comprising: 
<claim-text>analyzing a nonsource document; and </claim-text>
<claim-text>detecting a watermark value of the nonsource document using detection information. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The method of watermark detection according to <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference>, wherein the detection information includes information on the location of source features. </claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. The method of watermark detection according to <dependent-claim-reference depends_on="CLM-00008">claim 8</dependent-claim-reference>, wherein the nonsource document is a hardcopy of a source document. </claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. A system for watermark detection, comprising: 
<claim-text>a first system connected to a document source; </claim-text>
<claim-text>a publication component connected to the first system; </claim-text>
<claim-text>a second system connected to a scanning device; and </claim-text>
<claim-text>a watermark detector connected to the second system.</claim-text>
</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>2</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030002708A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030002708A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030002708A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030002708A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030002708A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030002708A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
