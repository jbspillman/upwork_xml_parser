<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030001860A1-20030102-M00001.NB SYSTEM "US20030001860A1-20030102-M00001.NB" NDATA NB>
<!ENTITY US20030001860A1-20030102-M00001.TIF SYSTEM "US20030001860A1-20030102-M00001.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-M00002.NB SYSTEM "US20030001860A1-20030102-M00002.NB" NDATA NB>
<!ENTITY US20030001860A1-20030102-M00002.TIF SYSTEM "US20030001860A1-20030102-M00002.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00000.TIF SYSTEM "US20030001860A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00001.TIF SYSTEM "US20030001860A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00002.TIF SYSTEM "US20030001860A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00003.TIF SYSTEM "US20030001860A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00004.TIF SYSTEM "US20030001860A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00005.TIF SYSTEM "US20030001860A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00006.TIF SYSTEM "US20030001860A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00007.TIF SYSTEM "US20030001860A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00008.TIF SYSTEM "US20030001860A1-20030102-D00008.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00009.TIF SYSTEM "US20030001860A1-20030102-D00009.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00010.TIF SYSTEM "US20030001860A1-20030102-D00010.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00011.TIF SYSTEM "US20030001860A1-20030102-D00011.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00012.TIF SYSTEM "US20030001860A1-20030102-D00012.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00013.TIF SYSTEM "US20030001860A1-20030102-D00013.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00014.TIF SYSTEM "US20030001860A1-20030102-D00014.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00015.TIF SYSTEM "US20030001860A1-20030102-D00015.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00016.TIF SYSTEM "US20030001860A1-20030102-D00016.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00017.TIF SYSTEM "US20030001860A1-20030102-D00017.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00018.TIF SYSTEM "US20030001860A1-20030102-D00018.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00019.TIF SYSTEM "US20030001860A1-20030102-D00019.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00020.TIF SYSTEM "US20030001860A1-20030102-D00020.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00021.TIF SYSTEM "US20030001860A1-20030102-D00021.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00022.TIF SYSTEM "US20030001860A1-20030102-D00022.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00023.TIF SYSTEM "US20030001860A1-20030102-D00023.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00024.TIF SYSTEM "US20030001860A1-20030102-D00024.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00025.TIF SYSTEM "US20030001860A1-20030102-D00025.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00026.TIF SYSTEM "US20030001860A1-20030102-D00026.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00027.TIF SYSTEM "US20030001860A1-20030102-D00027.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00028.TIF SYSTEM "US20030001860A1-20030102-D00028.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00029.TIF SYSTEM "US20030001860A1-20030102-D00029.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00030.TIF SYSTEM "US20030001860A1-20030102-D00030.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00031.TIF SYSTEM "US20030001860A1-20030102-D00031.TIF" NDATA TIF>
<!ENTITY US20030001860A1-20030102-D00032.TIF SYSTEM "US20030001860A1-20030102-D00032.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030001860</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10103965</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20020322</filing-date>
</domestic-filing-data>
<foreign-priority-data>
<priority-application-number>
<doc-number>2001-087763</doc-number>
</priority-application-number>
<filing-date>20010326</filing-date>
<country-code>JP</country-code>
</foreign-priority-data>
<foreign-priority-data>
<priority-application-number>
<doc-number>2001-333134</doc-number>
</priority-application-number>
<filing-date>20011030</filing-date>
<country-code>JP</country-code>
</foreign-priority-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>G09G005/02</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>345</class>
<subclass>590000</subclass>
</uspc>
</classification-us-primary>
</classification-us>
<title-of-invention>Medium recording color transformation lookup table, printing apparatus, printing method, medium recording printing program, color transformation apparatus, and medium recording color transformation program</title-of-invention>
</technical-information>
<inventors>
<first-named-inventor>
<name>
<given-name>Satoshi</given-name>
<family-name>Yamazaki</family-name>
</name>
<residence>
<residence-non-us>
<city>Nagano</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Makoto</given-name>
<family-name>Fujino</family-name>
</name>
<residence>
<residence-non-us>
<city>Nagano</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<assignee>
<organization-name>SEIKO EPSON CORPORATION</organization-name>
<assignee-type>03</assignee-type>
</assignee>
<correspondence-address>
<name-1>BEYER WEAVER &amp; THOMAS LLP</name-1>
<name-2></name-2>
<address>
<address-1>P.O. BOX 778</address-1>
<city>BERKELEY</city>
<state>CA</state>
<postalcode>94704-0778</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">When printing a photograph including colors in the range of the green hue to the blue hue wherein the color gamut of the printer is wider in the direction of chroma rise, the colors of its print result will be poorer in tones than the colors of the actual subject. </paragraph>
<paragraph id="A-0002" lvl="0">According to the present invention, color gamut shift is executed for gamut mapping in which the shape of the color gamut of the first image processing device expands so as to be close to the shape of the color gamut of the second image processing device in a homogenous hue range. Moreover, color gamut expansion is executed for gamut mapping in which a certain region of the resulting gamut after the color gamut shift further expands into the color gamut of the second image processing device. Based on the thus defined relationship fo color gamut between the color gamut of the first image processing device and the color gamut of the second image processing device, color transformation is executed. In circumstances where a plurality of color gamuts are available on an image processing device, gamut mapping relationships between the first and second devices are defined for each gamut, thereby finer adjustment can be performed. Thus, image output in desirable colors can be obtained by making effective use of the color gamuts of the image processing device. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> 1. Field of the Invention </paragraph>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> The present invention relates to a medium recording a color transformation lookup table for color transformation on printing, a printing apparatus and a printing method both using the color transformation lookup table, a medium recording a printing program, a color transformation apparatus, and a medium recording a color transformation program. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> 2. Description of the Prior Art </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> Image processing devices such as displays, printers have the device-dependent color gamut, that is, the range of colors producible by the device. When two image processing devices are compared in the aspect of colors, generally, some colors are producible on both devices; other colors are producible only on either device. For some image processing devices, despite having the ability of fine color reproduction, it was conventionally practiced to limit their color gamut to a certain extent enough to make their output look in homogenous colors to the human eyes. For example, assume that an image on a display is printed by a printer. In a color region where the color gamut of the display is wider than that of the printer, the colors visible on the display are mapped to fall within the color gamut of the display and the color gamut of the printer. Colors in another color region where the color gamut of the printer is wider than that of the display are not used when images are printed. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> For conventional color transformation programs based on the above-described color-mapping method, a problem was posed which will be described below. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> If an image presented on the display is printed, using the colors in a region that fall within both color gamuts of the display and of the printer, the colors of the printed image well match the colors of the image on the display. However, because colors out of the color reproducible range of the display are not produced by printing, best-quality print results are not always produced. For example, when printing a photograph including colors in the range of the green hue to the blue hue wherein the color gamut of the printer is wider in the direction of chroma rise, the colors of its print result will be poorer in tones than the colors of the actual subject. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> To solve the problem, an object of the present invention is to provide a medium recording a color transformation lookup table, printing apparatus, printing method, a medium recording a printing program, a color transformation apparatus, and a medium recording a color transformation program, in order to permit an image processing device to produce desirable color image outputs by making more effective use of its color gamut. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> In accordance with one aspect of the present invention, a medium recording a color transformation lookup table is provided. The color transformation lookup table is referenced for transformation of first color image data used on a first image processing device into second color image data used on a second image processing device and has a first set of values and a second set of values which represent a relationship between color gamuts of the first image processing device and the second image processing device, </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> wherein if there exists the region that is out of the color gamut of the first image processing device but falls within the color gamut of the second image processing device in a certain hue of the device-independent color space, the relationship is equivalent to the relationship of color gamut determined, based on gamut mapping in a predefined device-independent color space, through a process comprising: </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> a color gamut shift step to obtain the mapping which expands the shape of the color gamut of the first image processing device so as to be close to the shape of the color gamut of the second image processing device in a homogeneous hue range; and </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> a color gamut expansion step to obtain the mapping which expands a certain region of the resulting gamut processed at the color gamut shift step into the inside of color gamut of the second image processing device. </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> In the present invention of this aspect, by using a color transformation program that comprises the steps of inputting the first color image data for use on the first image processing device and transforming the first color image data into the second color image data for use on the second image output program, the first color image data is transformed into the second color image data, based on the relationship between color gamuts of the first image processing device and the second image processing device, which has been defined by the color gamut shift step. The color gamut shift step performs gamut mapping in which the shape of the color gamut of the first image processing device expands so as to be close to the shape of the color gamut of the second image processing device. In the predefined device-independent color space, this step is carried out in a hue in which a color region exists that is out of the color gamut of the first image processing device, but falls within the color gamut of the second image processing device. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> When shifting the color gamut of the first image processing device, expansion rather than compression takes place so that the shape of the color gamut will be made close to the shape of the color gamut of the second image processing device. Consequently, if the color gamut of the second image processing device is wider than that of the first image processing device, the resulting gamut by shift maintains the characteristics of the color gamut of the first image processing device, while it is close to the characteristics of the color gamut of the second image processing device. Color gamut shift can take place without unnatural color transformation. By making the color gamut of the first image processing device close to the color gamut of the second image processing device, the region expands where the color gamut of the first image processing device overlaps with the color gamut of the second image processing device. This makes it possible to decrease the number of colors that are out of the color gamut of the second image processing device and increase the number of colors available on the second image processing device. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> In order to obtain images with finer tones in a hue in which a color region exists that is out of the color gamut of the first image processing device, but falls within the color gamut of the second image processing device, following the color gamut shift step, the color gamut expansion step is carried out for gamut mapping in which a certain region of the resulting gamut after the color gamut shift further expands into the color gamut of the second image processing device. Consequently, the gamut obtained by shifting the color gamut of the first image processing device through the color gamut shift step is further modified to include colors that are out of the color gamut of the first image processing device, but fall within the color gamut of the second image output. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> Color transformation of the first color image data into the second color image data, based on the finally obtained gamut, enables effective use of colors that are out of the color gamut of the first image processing device, but fall within the color gamut of the second image output. By using the color gamut shift step in combination with the color gamut expansion step as required, both unnatural color transformation prevention and effective use of the color gamut of the second image processing device can be achieved at the same time. The above-described process can be augmented by adding another step. For a region that still falls out of the color gamut of the second image processing device after the execution of the color gamut shift and color gamut expansion steps, it is advisable to compress the region into the color gamut and define the gamut mapping relationship between the first and second image processing devices. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> In this way, according to the present invention, unnatural color transformation can be prevented with effective use of the color gamut of the second image processing device. Because color transformation is executed by simply referencing the color transformation lookup table, it is not necessary to execute the color gamut shift and color gamut expansion steps whenever transforming the first color image data into the second color image data. Thus, the resources or the like for performing the color transformation function can be saved. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> As the device-independent color space, any of diverse color space schemes such as Lab, XYZ can be adopted as color space. The first and second image processing devices are not limited to specific ones and may be any device that reproduces images, using color image data such as displays, printers, scanners, digital cameras. These devices are not always separate ones. For example, a fax machine has a scanner as the first image processing device and a printer as the second image processing device, which are integrated therein, and the present invention can be applied to the fax machine. The above-described process does not actively cause color variation when being carried out in a certain hue. However, some color variation is allowable as difference between the hue of the second color image data and the hue of the first color image data due to the property of the device-independent color space in which the process is carried out, the transformation between spaces, and the device-dependent error of an image processing device, etc. Even if the process does not actively cause hue variation, hue variation of &ldquo;0 to 10&rdquo; degrees may take place over the region for which color gamut shift is executed. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> To reflect the foregoing relationship of color gamut in image output, transformation of the first color image data into the second color image data is executed by referencing the lookup table created in advance. Owing to the information obtained about the relationship between the color gamuts of the first image processing device and the second image processing device defined in the lookup table created in advance, it is not necessary to execute the color gamut shift and color gamut expansion steps whenever transforming the first color image data into the second color image data. Thus, the resources for performing the color transformation function can be saved. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> Requirements for the lookup table are containing data that defines the relationship between color gamuts of the first image processing device and the second image processing device so as to enable transformation of the first color image data into the second image data. In building this table, any of diverse method can be adopted. For example, one method is such that the table is built by mapping typical color data as the first color image data to corresponding data as the second color image data and color data for any point is calculated by interpolation. Another method is such that the table is built by mapping typical color values by the coordinates of the color gamut of the first image processing device to corresponding color values by the coordinates of the color gamut of the second image processing device in the device-independent color space and color values at any coordinates are calculated by interpolation. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> By way of illustration, as suitable devices to which the present invention is applicable, the first image processing device is a display and the second image processing device is a printer. In this embodiment, the color transformation function is performed to transform the first color image data expressed in an RGB color space into the second color image data expressed in a CMYK color space on the assumption of the following. The first color image data is expressed in the predefined device-independent color space, the color gamut shift step or/and the color gamut expansion step are executed, and then the second color image data is obtained, based on the finally obtained gamut data in the predefined device-independent color space. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> To perform management of color compatibility between the display and printer, it is required that a specific device-independent color space intervenes therebetween in transforming the first color image data expressed in the display&apos;s device-dependent or device-independent RGB color space into the second color image data expressed in the printer&apos;s device-dependent CMYK color space. By thus performing the above-described process of the present invention in the device-independent color space, the management of color compatibility as well as the above-described unnatural color transformation prevention and effective use of the color gamut of the second image processing device can be accomplished. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> By comparison of the display&apos;s color gamut and the printer&apos; color gamut, around the green hue to the blue hue, such a tendency is found that the display&apos;s color gamut is characterized by higher chroma in the high lightness range and the printer&apos;s color gamut higher chroma in the medium and low lightness range. In other words, the display&apos;s color gamut is greater in the high lightness range and the printer&apos;s color gamut is greater in the medium and low lightness range. On the assumption that the present invention is applied to the display and printer, the invention enables effective use of the printer&apos;s color gamut in the medium and low lightness range, so that print results featuring finer tones around the green hue to the blue hue can be produced. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> Colors constituting the color gamut of an image processing device can be expressed by combinations of a plurality of color components. Color components used to express colors in a color space are usually three colors, but three colors are not always used for defining the relationship between color gamuts. Before or/and after the color gamut shift and color gamut expansion steps, the first set of values and second set of values of a color transformation lookup table are defined after increasing or decreasing the number of color components in a color space to which the color gamut belongs. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> Specifically, by means of the color separation into color components, three color components in the device-independent color space can be changed to any number of color components. The relationship between the color gamuts of the first color data and the second color data can be defined to directly match the number of color components used by the image output device. For example, if the second image processing device is a printer, it is conceivable that color components such as four CMYK colors, six colors of CMYK plus lc (light cyan) and lm (light magenta), seven colors of CMYKlclm plus DY (dark yellow) are available on the printer. Once RGB color data from the display&apos;s color gamut has been mapped to CMY color data, the CMY color data is transformed into CMYK color data or the like by color separation into color components, so that RGB color data can easily be mapped to CMYK color data or the like. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> In this way, the relationship between the color gamuts of the first color data and the second color data directly matching the number of color components used by the image output device can be obtained. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> Requirements for the color gamut shift step are that it is capable of gamut mapping in which the shape of the color gamut of the first image processing device expands so as to be close to the shape of the color gamut of the second image processing device in a homogenous hue range. Requirements for the color gamut expansion step are that it is capable of gamut mapping in which a certain region of the resulting gamut after the color gamut shift further expands into the color gamut of the second image processing device. In one embodiment, it is advisable to effect these steps as follows. The color gamut shift step causes lightness to decrease and chroma to increase based on the coordinates of the device-independent color space; meanwhile the color gamut expansion step causes chroma to increase while keeping lightness nearly constant, based on the coordinates of the gamut processed at the color gamut shift step in the device-independent color space. </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> Among three attributes colors, i.e., hue, lightness, and chroma, the human eyes are normally most sensitive to hue change. Accordingly, the above-described process of the present invention does not actively cause hue change, or hue variation. As the color gamut shift step causes lightness to decrease and chroma to increase, the present invention can function effectively in circumstances where the color gamut of the first image processing device is greater in the high lightness range and the gamut of the second image processing device is greater in the medium and low lightness range. By decreasing lightness while increasing chroma, gamut mapping that does not cause unnatural color appearance to the human eyes can be obtained. As the color gamut expansion step causes chroma to increase while keeping lightness constant, the present invention can function effectively in circumstances where the gamut of the second image processing device extends wider in the high chroma range. In consequence, the second image processing device outputs fine tone color images. </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> In view of the foregoing, it is advisable to effect the color gamut shift step as follows. The mapping in the color gamut shift step is obtained in such a manner that the higher the chroma point is in the color gamut of the first image processing device in a certain hue, the greater the displacement by shift is. That is because difference in gamut shape between the image input device and output device is significant in the high chroma range, when the color gamut is expressed in the color space based on the lightness, chroma, and hue coordinates. Thus, when shifting the color gamut of the image input device, shifting the contour of its protrusion toward rise in chroma is important. Significant shift in the low chroma range may cause inherently little colorful colors to become colorful. Thus, the displacements are set such that more shift will take place in the higher chroma range. In consequence, color gamut shift without causing unnatural color appearance can be accomplished while significantly shifting the color gamut of the first image processing device so that it will expand so as to be close to the color gamut of the second image processing device. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> The above-described color gamut shift step is executed for each hue and the color gamut shift results for all hues must give color values without causing unnatural color appearance as a whole. In view hereof, in yet another embodiment, it is advisable to effect the color gamut shift step as follows. The color gamut shift step varies the displacement by shift according to any of or combination of hue, chroma, and lightness of the color image data which have not processed at the color gamut shift step. The region where the color gamut of the second image processing device is greater than the color gamut of the first image processing device changes, depending on the hue, lightness, and chroma values. </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> By changing the displacement by shift for each hue, shift can exactly follow the color gamut change in terms of hue. By changing the displacement by shift for each lightness value, shift can exactly follow the color gamut change in terms of lightness. By changing the displacement by shift for each chroma value, shift can exactly follow the color gamut change in terms of chroma. By gradually changing the displacement by shift, according to the change in hue, lightness, chroma, tone jumps by mapping can be prevented. The color gamut somewhat differs, depending on the image processing media, device type and used ink of the second image processing device, and the image display device. It is also possible to slightly change the displacement by shift for adjusting such difference. </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> In view of the foregoing, it is advisable to effect the color gamut expansion step as follows. In the color gamut expansion step, the displacement by expansion of the chroma is set up in such a manner that the higher the chroma is which has not processed at the color gamut expansion step, the greater the displacement is. To make tones of images finer for higher chroma available and generate gamut mapping for producing fine tone images, it is necessary to expand the gamut by rising chroma. Significant chroma rise in the low chroma range may cause inherently little colorful colors to become colorful. Thus, the displacements are set such that more expansion will take place in the higher chroma range. In consequence, the resulting gamut mapping enables effective use of the gamut of the second image processing device and production of fine tone images. In further embodiment, it is advisable to effect the color gamut expansion step as follows. In the color gamut expansion step, the chroma expansion is not performed on a certain region where the chroma of the color image data which have not processed at the color gamut expansion step is small. This can prevent gamut expansion from causing inherently little colorful colors to become colorful. </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> The above-described color expansion shift step is executed for each hue and the color gamut expansion results for all hues must give color values without causing unnatural color appearance as a whole. In view hereof, it is advisable to effect the color gamut expansion step as follows. The color gamut expansion step causes displacement by expansion to vary according to any of or combination of hue, chroma, and lightness of the color image data which have not processed at the color gamut expansion step. The region where the color gamut of the second image processing device is greater than the color gamut of the first image processing device changes, depending on the hue, lightness, and chroma values. By changing the displacement by expansion for the hue, lightness, and chroma values, expansion can exactly follow the color gamut change in terms of hue, lightness, and chroma. </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> By gradually changing the displacement by expansion, according to the change in hue, lightness, chroma, tone jumps by mapping can be prevented. The color gamut somewhat differs, depending on the image processing media, device type and used ink of the second image processing device, and the image display device. It is also possible to slightly change the displacement by expansion for adjusting such difference. Furthermore, gradually changing the displacement by expansion, according to the change in hue, lightness, chroma can prevent gamut expansion from generating a region out of the color gamut of the second image processing device. </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> To accommodate different forms of color gamut of an image processing device, it is advisable to perform color transformation as follows. A plurality of color gamuts with different shapes is available to any of or combination of the first image processing device and the second image processing device, and the sets of values represent each relationship of color gamuts. If a plurality of color gamuts of different shapes of an image processing device are available and the same displacements by color gamut shift and color gamut expansion are applied to all gamuts, colors with chroma being over-emphasized or under-emphasized may be produced. For color gamuts, from the viewpoint of color transformation precision as well, it is desirable to perform color transformation using the color data mapping relationships defined for each color gamut. </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> The color transformation performed based on the color data mapping relationships defined for each color gamut prevents unnatural color transformation for each gamut and enables effective use of each gamut. Diverse circumstances can be supposed where color gamuts of an image processing device are available. For example, it can be said that the color gamut differs, depending on the kind of consumables. For a printer, its color gamut somewhat changes by the replacement of image processing medium and ink set. For a scanner, its color gamut somewhat changes by the change to document type such as translucent one, reflecting one. Moreover, the color gamut somewhat changes when the type of the image processing device changes, and even for the same device type, difference in gamut may occur between individual devices. The foregoing manner can accommodate such difference in color gamut. </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> To define color data mapping relationships for each color gamut, it is advisable to define the relationship in the color transformation lookup table by individual displacement by shift or/and displacement by expansion to be performed for each of the color gamuts in the device-independent color space. In the present invention, because gamut mapping relationship between the first and second image processing devices is defined by performing the color gamut shift and color gamut expansion steps, by performing these steps for each color gamut, the mapping relationships can be defined for each gamut. For each color gamut, it is not required that completely different methods of gamut mapping be used. Based on the same gamut mapping method, by using different values of its related parameters, different gamut mapping can be produced. However, it is not necessary to assign different values to all parameters for each color gamut and common values of some parameters can be used. </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> In gamut mapping that varies for each color gamut, it is advisable to effect the color gamut shift step as follows. In the color gamut shift step, the displacement by shift is set up in such a manner that the larger the color gamut of the second image processing device is, the greater the displacement by shift is. A greater color gamut of the second image processing device has a greater region out of the color gamut of the first image processing device. Shifting the gamut of the first image processing device by greater displacement can surely make it close to the gamut of the second image processing device. In consequence, in separate gamut mapping for each color gamut, the region expands where the color gamut of the first image processing device overlaps with that of the second image processing device. This makes it possible to decrease the number of colors that are out of the color gamut of the second image processing device and increase the number of colors available on the second image processing device. </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> In gamut mapping that varies for each color gamut, it is advisable to effect the color gamut shift step as follows. The color gamut shift step causes displacement in such a manner that if the shapes of the gamuts of the second image processing device differs from each other, the displacement by shift of the highest chroma point in the gamut of the first image processing device is varied. In the mode in which the color gamut shift step modifies gamut mapping in such a manner that the highest chroma point in the color gamut of the first image processing device in a certain hue shifts by the greatest displacement and the displacement by shift of other points decreases in proportion as chroma decreases, change to the displacement by shift of the highest chroma point significantly influences the displacement by shift of the entire color gamut. It can be said that the displacement by shift of the entire color gamut is defined by the displacement by shift of the highest chroma point. In this mode, by changing the displacement by shift of the highest chroma point for each color gamut, different gamut mapping for different gamut shape can easily be obtained. </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> Not only in the color gamut shift step, gamut mapping that varies for each color gamut can be performed in the color gamut expansion step as well. In the constitution thereof, the displacement by expansion in the color gamut expansion step is set up in such a manner that the larger the color gamut of the second image processing device is, the greater the displacement by expansion is. This manner of expanding the gamut of the first image processing device by greater displacement to a greater color gamut of the second image processing device enables effective use of the color gamut. A greater color gamut of the second image processing device has the wider region where chroma is relatively high. For the greater color gamut, by expanding the gamut of the first image processing device by greater displacement than expanding it to a smaller gamut of the second image processing device, thereby more vivid colors can be produced. </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> To obtain different gamut mapping for different color gamut shape, a mode is applied in which gamut mapping is adjusted for each color gamut by following the tendency that displacements increase in proportional to the increase in gamut size and this mode is important for an image processing device on which a plurality of color gamuts are available. However, the mode in which the displacements by color gamut shift and color gamut expansion are always set greater for greater gamuts doe not apply to all cases. The following is also possible. For a particular color gamut that belongs to the second image processing device and is smaller than another one of the device, the displacement by shift or/and expansion is set greater than for another one. In other words, when performing color gamut shift or/and expansion, it is possible to set displacements conflicting with the tendency that displacements increase in proportional to increase in gamut size. </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> In this way, it is possible to make color images uniform in impression when produced after color transformation. </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> As the result of color transformation of the present invention, color appearance of images output by the second image processing device is important. After color transformation is executed, the color appearance of images output by the second image processing device is visually checked and then final tuning may be required. Tuning in conflict with the tendency that displacements increase in proportional to the increase in gamut size is allowable. For example, if kinds of image processing media and ink sets can be used on a printer, the printer has color gamuts for each combination of image processing medium and ink set. Even if unnatural color transformation prevention and effective use of color gamut are achieved separately for each color gamut, change of image processing media and/or ink set may cause the printer to output color images that are different in color impression as compared with those produced before the change and the user may want to prevent such difference. </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> In such cases, the color appearance of an image produced with each combination of image processing medium and ink set may differ, depending on the relativity of one color to its surrounding color. If color gamut shift and expansion are executed straightforwardly with the displacements set in accordance with the tendency that displacements increase in proportional to the increase in gamut size, print results of the same image may look different in color impression. When uniform color impression even with color gamuts is reckoned important, tuning is performed, and the set displacements by color gamut shift and expansion may be in conflict with the above tendency for some color gamuts. Such tuning is preferable if uniform print results even with color gamuts are reckoned important and allowable in the present invention. </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> For color transformation purposes, not only the color gamut shift step and color gamut expansion step of the present invention, but also other steps may be taken from different viewpoints. Often, as the result of execution of the combination of the steps, the relationship between the color gamuts of the first image processing device and the second image processing device is defined. When the above relationship is defined as the result of processing including other steps, it may be preferable to set the displacements by color gamut shift and expansion in conflict with the tendency that displacements increase in proportional to the increase in gamut size to eventually obtain fine color appearance. Accordingly, such tuning is allowable. </paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> In color transformation that is executed, based on color data mapping relationships defined for a plurality of color gamuts, it is advisable to obtain another lookup table as follows. The relationship of gamuts is obtained by correcting the sets of values which are stored in a certain storage area and represent a relationship of the gamut. This renders it unnecessary to store the respective lookup tables which represent the predefined relationships of all pairs of gamuts. Thus only a minimum number of lookup tables are required for storing such relationship with regard to a particular color gamut of the second image processing device, saving storage area. For the correction method, any of diverse methods can be adopted. For example, one method is as follows. The shape of a particular color gamut of the second image processing device and the tendency of change of mapping relationship relative to that shape, estimated in advance, are maintained. By comparison between the shape of any color gamut of the second image processing device and the above color gamut shape, how the color gamut has changed is determined, based on which the mapping relationship is corrected. Another method is as follows. By comparing the reference mapping relationship with regard to a particular color gamut of the second image processing device and that for another gamut thereof, only color data of difference is maintained. During the processing for color transformation, color data of difference from the reference mapping relationship about the particular color gamut is replaced. </paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> To practice color transformation of the present invention, it is preferable that the user can choose whether to execute the color transformation. It is also advisable to take the following manner. The sets of values which represent the relationship with the application of color gamut shift or/and color gamut expansion and the relationship without the application of color gamut shift or/and color gamut expansion, are made and stored in a certain storage area; and the relationship is decided based on the mode which is selected in advance by a user. </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> In this manner, the user can choose whether to execute color transformation based on the mapping relationship defined by the execution of color gamut shift or/and color gamut expansion in accordance with the present invention or execute color transformation based on the mapping relationship in other way. Color transformation execution according to the mapping relationship defined by the execution of color gamut shift or/and color gamut expansion of the present invention is advantageous in that vivid color appearance is obtained and unnatural color transformation can be prevented. However, to meet the user&apos;s need that may differ, according to circumstances, it is preferable to provide options including the color transformation in accordance with the present invention. For example, some users may make a fine adjustment of colors on the first image processing device and want exactly the same colors output from the second image processing device. For such users, it is difficult to output a color image to the user&apos;s intention if the color transformation in accordance with the present invention is performed. Thus, it is convenient for such users that color transformation can be performed, based on the mapping relationship defined without the execution of color gamut shift and color gamut expansion of the present invention. This serves the user&apos;s need that may differ. </paragraph>
<paragraph id="P-0048" lvl="0"><number>&lsqb;0048&rsqb;</number> Herein, color transformation lookup tables are prepared to maintain any or combination of the mapping relationship defined by executing the color gamut shift step, the mapping relationship defined by executing the color gamut expansion step, the mapping relationship defined by executing the color gamut shift step, and the color gamut expansion step; and to maintain the mapping relationship defined by without executing these steps. The mapping relationship defined by without executing these steps includes all mapping relationships not modified by color gamut shift and color gamut expansion. When executing color transformation, it is advisable that the mapping relationship to be selected can be specified by mode selected by the user beforehand. </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> For example, explicit modes such as color gamut shift mode, color gamut expansion mode, color gamut shift and expansion mode, and other mode may be applied. Alternatively, non-explicit modes such as vivid mode, moderate mode may be applied. Selecting a mode beforehand may be done at least before color transformation. As means for facilitating mode selection, any of diverse means may be taken; for example, default selection that may be set and reset at any time, a mode selection dialog box presented before color transformation. </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> Even if the above-described color gamut shift step and said color gamut expansion step are executed, hue variation can be limited to a small degree; for example, it can be restricted to 15 degrees or less in Lab space. </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> The above-described color transformation lookup table is used for printing after color transformation and the same color gamut shift step and color gamut expansion step can be employed in a printing apparatus. Conceivably, such apparatus may be put into operation in a stand-alone mode or integrated into some equipment or system and put into operation with another methodology. Not limited to a certain mode of operation, the concept of the invention comprehends a variety of modes in which the invention is embodied and appropriate modifications are permissible within the range of the invention. </paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> The above-described color gamut shift step and color gamut expansion step can be implemented as part of a printing method. </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> These steps can be executed by a computer. In such cases, the color gamut shift and color gamut expansion steps are embodied in program code of a printing program that is stored on a medium. The medium may be a magnetic recording medium, a magneto-optic recording medium, or any other recording medium which will be developed in future, all of which can be considered applicable to the present invention in all the same way. Embodiment of the present invention as software and hardware combination makes no difference in the concept of the invention. Embodiment of the present invention includes such a manner that part thereof is recorded on a medium in advance and will be read appropriately as required. Furthermore, duplicates of the above medium as primary and secondary duplicate products and the like are considered equivalent to the medium without doubt. </paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> According to the above-described steps in accordance with the present invention, color transformation lookup tables can be created before or when color transformation is executed. In view hereof, the present invention can be interpreted as a method of creating color transformation lookup tables.</paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a block diagram showing the simplified hardware structure of a computer that executes a color transformation program for performing color transformation using a color transformation lookup table provided in accordance with one preferred embodiment of the present invention. </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a block diagram showing the simplified structure of the OS and related components in the computer wherein the color transformation program is provided as a color transformation module. </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a flowchart illustrating print operation. </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a conceptual diagram of operation of the present invention. </paragraph>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> shows an exemplary lookup table (LUT). </paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a flowchart illustrating the process of creating the LUT. </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> shows surface views of color gamut forms on the a-b plane cut in lightness segments in the Lab space. </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> shows mapping of color gamut forms on the L (lightness) and C (chroma) coordinates plane cut in the Lab space. </paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> shows how a shift coefficient in chroma varies, depending on hue angles. </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> shows how a shift coefficient in lightness varies, depending on hue angles. </paragraph>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is a flowchart illustrating color gamut shift processing. </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> shows mapping of color gamut forms on the LC plane cut in the Lab space. </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 13</cross-reference> shows how expansion coefficient &agr; varies, depending on hue angles. </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 14</cross-reference> shows how expansion coefficient &bgr; varies, depending on lightness change. </paragraph>
<paragraph id="P-0069" lvl="0"><number>&lsqb;0069&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 15</cross-reference> shows a function curve of expansion coefficient rate. </paragraph>
<paragraph id="P-0070" lvl="0"><number>&lsqb;0070&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 16</cross-reference> is a flowchart illustrating color gamut expansion processing. </paragraph>
<paragraph id="P-0071" lvl="0"><number>&lsqb;0071&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 17</cross-reference> shows mapping of color gamut forms on the LC plane cut in the Lab space. </paragraph>
<paragraph id="P-0072" lvl="0"><number>&lsqb;0072&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 18</cross-reference> is a block diagram showing the simplified structure of the OS and related components wherein the color transformation program is provided as a color transformation part in accordance with another preferred embodiment of the invention. </paragraph>
<paragraph id="P-0073" lvl="0"><number>&lsqb;0073&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 19</cross-reference> is a block diagram showing the simplified structure of the OS and related components wherein the color transformation program is provided as the color transformation module, according to a preferred embodiment 3. </paragraph>
<paragraph id="P-0074" lvl="0"><number>&lsqb;0074&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 20</cross-reference> shows a table listing symbolic values of parameters depending on color gamuts for each combination of ink set and image processing medium. </paragraph>
<paragraph id="P-0075" lvl="0"><number>&lsqb;0075&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 21</cross-reference> is gamut mapping illustration for explaining different values of parameters assigned for each color gamut for color gamut shift. </paragraph>
<paragraph id="P-0076" lvl="0"><number>&lsqb;0076&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 22</cross-reference> is shift coefficient RC (&thgr;) range illustration for explaining different values of parameters assigned for each color gamut for color gamut shift. </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 23</cross-reference> is shift coefficient RL (&thgr;) range illustration for explaining different values of parameters assigned for each color gamut for color gamut shift. </paragraph>
<paragraph id="P-0078" lvl="0"><number>&lsqb;0078&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 24</cross-reference> is gamut mapping illustration for explaining different values of parameters assigned for each color gamut for color gamut expansion. </paragraph>
<paragraph id="P-0079" lvl="0"><number>&lsqb;0079&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 25</cross-reference> is expansion coefficient &agr; range illustration for explaining different values of parameters assigned for each color gamut for color gamut expansion. </paragraph>
<paragraph id="P-0080" lvl="0"><number>&lsqb;0080&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 26</cross-reference> is expansion coefficient &bgr; range illustration for explaining different values of parameters assigned for each color gamut for color gamut expansion. </paragraph>
<paragraph id="P-0081" lvl="0"><number>&lsqb;0081&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 27</cross-reference> is expansion coefficient rate range illustration for explaining different values of parameters assigned for each color gamut for color gamut expansion. </paragraph>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 28</cross-reference> shows another table listing symbolic values of parameters depending on color gamuts for each combination of ink set and image processing medium. </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 29</cross-reference> is a block diagram showing the simplified structure of the OS and related components wherein the color transformation program is provided as the color transformation module, according to a preferred embodiment 5. </paragraph>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 30</cross-reference> is a block diagram showing the simplified structure of the OS and related components wherein the color transformation program is provided as the color transformation module, according to a preferred embodiment 6. </paragraph>
<paragraph id="P-0085" lvl="0"><number>&lsqb;0085&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 31</cross-reference> shows an exemplary Printer Properties window. </paragraph>
<paragraph id="P-0086" lvl="0"><number>&lsqb;0086&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 32</cross-reference> shows another exemplary Printer Properties window.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS </heading>
<paragraph id="P-0087" lvl="0"><number>&lsqb;0087&rsqb;</number> This section describes preferred embodiments of the present invention in the following aspects which will be described in order:  
<table-cwu id="TABLE-US-00001">
<number>1</number>
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="OFFSET" colwidth="14PT" align="left"/>
<colspec colname="1" colwidth="28PT" align="left"/>
<colspec colname="2" colwidth="175PT" align="left"/>
<thead>
<row>
<entry></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry namest="OFFSET" nameend="2" align="center" rowsep="1"></entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry></entry>
<entry>&ensp;(1)</entry>
<entry>Configuration for implementing the present invention</entry>
</row>
<row>
<entry></entry>
<entry>&ensp;(2)</entry>
<entry>Print operation</entry>
</row>
<row>
<entry></entry>
<entry>&ensp;(3)</entry>
<entry>LUT creation process</entry>
</row>
<row>
<entry></entry>
<entry>&ensp;(4)</entry>
<entry>Color gamut shift</entry>
</row>
<row>
<entry></entry>
<entry>&ensp;(5)</entry>
<entry>Color gamut expansion</entry>
</row>
<row>
<entry></entry>
<entry>&ensp;(6)</entry>
<entry>Preferred Embodiment 2</entry>
</row>
<row>
<entry></entry>
<entry>&ensp;(7)</entry>
<entry>Preferred Embodiment 3</entry>
</row>
<row>
<entry></entry>
<entry>&ensp;(8)</entry>
<entry>Preferred Embodiment 4</entry>
</row>
<row>
<entry></entry>
<entry>&ensp;(9)</entry>
<entry>Preferred Embodiment 5</entry>
</row>
<row>
<entry></entry>
<entry>(10)</entry>
<entry>Preferred Embodiment 6</entry>
</row>
<row>
<entry></entry>
<entry namest="OFFSET" nameend="2" align="center" rowsep="1"></entry>
</row>
</tbody>
</tgroup>
</table>
</table-cwu>
</paragraph>
<paragraph id="P-0088" lvl="7"><number>&lsqb;0088&rsqb;</number> (1) Configuration for Implementing the Present Invention </paragraph>
<paragraph id="P-0089" lvl="0"><number>&lsqb;0089&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> shows the simplified hardware structure of a computer that executes a color transformation program provided in accordance with the present invention. <cross-reference target="DRAWINGS">FIG. 2</cross-reference> shows the simplified structure of the OS and related components in the computer wherein the color transformation program is provided as a color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>of a printer driver which is incorporated in the OS. CPU <highlight><bold>11</bold></highlight> of the computer <highlight><bold>10</bold></highlight> is the center of arithmetic processing and can gain access over a system bus <highlight><bold>12</bold></highlight> to ROM <highlight><bold>13</bold></highlight> and RAM <highlight><bold>14</bold></highlight> in which BIOS or the like has been stored. </paragraph>
<paragraph id="P-0090" lvl="0"><number>&lsqb;0090&rsqb;</number> To the system bus <highlight><bold>12</bold></highlight>, a hard disk drive (HDD) <highlight><bold>15</bold></highlight>, floppy disk drive <highlight><bold>16</bold></highlight>, and CD-ROM drive <highlight><bold>17</bold></highlight> which are configured as external storage devices are also connected. The OS <highlight><bold>20</bold></highlight>, application program (APL) <highlight><bold>25</bold></highlight>, and the like stored in the disk on the HDD <highlight><bold>15</bold></highlight> are transferred to the RAM <highlight><bold>14</bold></highlight> and the CPU <highlight><bold>11</bold></highlight> properly accesses the ROM <highlight><bold>13</bold></highlight> and the RAM <highlight><bold>14</bold></highlight> and executes the software. In other words, the CPU executes kinds of programs by using the RAM <highlight><bold>14</bold></highlight> as a temporary working area. </paragraph>
<paragraph id="P-0091" lvl="0"><number>&lsqb;0091&rsqb;</number> To a serial communication I/O unit <highlight><bold>19</bold></highlight><highlight><italic>a, </italic></highlight>input devices for user operation such as a keyboard <highlight><bold>31</bold></highlight> and mouse <highlight><bold>32</bold></highlight> are connected and a display <highlight><bold>18</bold></highlight> for visual presentation is also connected via a video board which is not shown. Connection to a printer <highlight><bold>40</bold></highlight> can be made via a parallel communication I/O unit <highlight><bold>19</bold></highlight><highlight><italic>b. </italic></highlight>As the computer <highlight><bold>10</bold></highlight> whose simplified structure is now explained, a generally configured personal computer can be used. Of course, computers applicable to the present invention are not limited to personal computers. Although a so-called desktop-type computer is assumed to be used in the present preferred embodiment, a notebook-size computer, and a computer with mobile features may be used. Besides, the connection interface between the computer <highlight><bold>10</bold></highlight> and the printer <highlight><bold>40</bold></highlight> is not limited to the above-mentioned one. Any can be adopted from diverse modes of connection such as serial interface, SCSI, USB including any connection mode that will be developed in future. </paragraph>
<paragraph id="P-0092" lvl="0"><number>&lsqb;0092&rsqb;</number> Although a suite of programs is stored in the disk on the HDD <highlight><bold>15</bold></highlight> in the present embodiment, the storage medium is not limited to the hard disk. Other storage media, for example, a floppy disk <highlight><bold>16</bold></highlight><highlight><italic>a </italic></highlight>and a CD-ROM <highlight><bold>17</bold></highlight><highlight><italic>a </italic></highlight>may be used. The programs stored in these storage media are read via the floppy disk drive <highlight><bold>16</bold></highlight> and CD-ROM drive <highlight><bold>17</bold></highlight>, transferred into the computer <highlight><bold>10</bold></highlight>, and installed in the disk on the HDD <highlight><bold>15</bold></highlight><highlight><italic>a. </italic></highlight>Then, the programs are read via the HDD <highlight><bold>15</bold></highlight> into the RAM <highlight><bold>14</bold></highlight> and run for computer control. In addition to the above-mentioned storage media, a magneto-optic disk or the like may also be used. As a semiconductor device, a nonvolatile memory or the like such as a flash card can be used. Alternatively, the programs can be downloaded by accessing an external file server via a modem and over a communication network; in this case, the communication network is a transmission medium by which the present invention is embodied for use. </paragraph>
<paragraph id="P-0093" lvl="0"><number>&lsqb;0093&rsqb;</number> On the computer <highlight><bold>10</bold></highlight> configured in accordance with the present preferred embodiment, the OS <highlight><bold>20</bold></highlight> is installed in which a printer driver (PRTDRV) <highlight><bold>21</bold></highlight>, an input device driver (DRV) <highlight><bold>22</bold></highlight>, and a display driver (DRV) <highlight><bold>23</bold></highlight> are incorporated as shown in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>. The display DRV <highlight><bold>23</bold></highlight> is a driver for controlling the operation of displaying images from image data and other presentations on the display <highlight><bold>18</bold></highlight>. The input device DRV <highlight><bold>22</bold></highlight> is a driver for receiving code signals input from the above-mentioned keyboard <highlight><bold>31</bold></highlight> and mouse <highlight><bold>32</bold></highlight> via the serial communication I/O unit <highlight><bold>19</bold></highlight><highlight><italic>a </italic></highlight>and receiving user input. </paragraph>
<paragraph id="P-0094" lvl="0"><number>&lsqb;0094&rsqb;</number> APL <highlight><bold>25</bold></highlight> is an application program by which retouching a color image and other image processing can be executed and allows the user to print the color image with the printer <highlight><bold>40</bold></highlight> by operating the above-mentioned input devices for user operation under the run of the APL <highlight><bold>25</bold></highlight>. For this print operation, the PRTDRV <highlight><bold>21</bold></highlight> is called. Under the control of the PRTDRV, image data expressing colors in the color gamut of the display <highlight><bold>18</bold></highlight> is acquired and color transformation is executed so that certain colors that are out of the color gamut of the display <highlight><bold>18</bold></highlight>, but fall within the color gamut of the printer <highlight><bold>40</bold></highlight> will be available in printing. In consequence, fine tone color images can be printed free from the constraint of the color gamut of the display <highlight><bold>18</bold></highlight>. For this purpose, the PRTDRV <highlight><bold>21</bold></highlight> comprises the above-mentioned color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>and besides an image data acquisition module <highlight><bold>21</bold></highlight><highlight><italic>a, </italic></highlight>a halftone processing module <highlight><bold>21</bold></highlight><highlight><italic>c, </italic></highlight>and a print data generation module <highlight><bold>21</bold></highlight><highlight><italic>d. </italic></highlight></paragraph>
<paragraph id="P-0095" lvl="0"><number>&lsqb;0095&rsqb;</number> The APL <highlight><bold>25</bold></highlight> makes the computer read image data <highlight><bold>15</bold></highlight><highlight><italic>a </italic></highlight>stored in the disk on the HDD<highlight><bold>15</bold></highlight> into the RAM <highlight><bold>14</bold></highlight>, then retouching and other processing can be performed for the image data. The display DRV<highlight><bold>23</bold></highlight> makes the computer present an image on the display <highlight><bold>18</bold></highlight>, based on the image data <highlight><bold>15</bold></highlight><highlight><italic>a </italic></highlight>read into the RAM <highlight><bold>14</bold></highlight>. When the user performs input by operating the above-mentioned input devices, the APL <highlight><bold>25</bold></highlight> receives the user input through the input device DRV <highlight><bold>22</bold></highlight>, interprets it, and instructs the computer to execute print operation, retouching, or other processing, according to the user input. </paragraph>
<paragraph id="P-0096" lvl="0"><number>&lsqb;0096&rsqb;</number> The image data <highlight><bold>15</bold></highlight><highlight><italic>a </italic></highlight>in the present preferred embodiment is dot-matrix data in which colors are expressed in tones of RGB (read, green, and blue) components in compliance with the sRGB standards. A lookup table (LUT) <highlight><bold>15</bold></highlight><highlight><italic>b, </italic></highlight>which will be explained later, may be built to contain data generated in such a manner as to transform the RGB-based data specific to the display <highlight><bold>18</bold></highlight> into CMYK based data. By altering the LUT <highlight><bold>15</bold></highlight><highlight><italic>a </italic></highlight>as required, it is possible to easily adapt the LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>to another device of display <highlight><bold>18</bold></highlight> and printer <highlight><bold>40</bold></highlight> and change of image processing medium or the like used on the printer <highlight><bold>40</bold></highlight>. </paragraph>
<paragraph id="P-0097" lvl="0"><number>&lsqb;0097&rsqb;</number> When the APL <highlight><bold>25</bold></highlight> receives an input of request for executing print operation in the way described above, the image data <highlight><bold>15</bold></highlight><highlight><italic>a </italic></highlight>is acquired under the control of the image data acquisition module <highlight><bold>21</bold></highlight><highlight><italic>a </italic></highlight>and the image data acquisition module <highlight><bold>21</bold></highlight><highlight><italic>a </italic></highlight>activates the color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b. </italic></highlight>The color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>is run for transforming RGB tone values into CMYK tone values, and under its control, all dots of the image data <highlight><bold>15</bold></highlight><highlight><italic>a </italic></highlight>are transformed into CMYK-based dots. During this transformation, the color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>makes the computer execute interpolation computation while referring to the LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>stored in the disk on the HDD <highlight><bold>15</bold></highlight>. Because the LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>contains data generated through the processing of color gamut shift and color gamut expansion which will be explained later, color data that is out of the color gamut of the display <highlight><bold>18</bold></highlight>, but falls within that of the printer <highlight><bold>40</bold></highlight> can be generated during this color transformation process. </paragraph>
<paragraph id="P-0098" lvl="0"><number>&lsqb;0098&rsqb;</number> The CMYK tone data generated by color transformation under the control of the color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>is handed over to the halftone processing module <highlight><bold>21</bold></highlight><highlight><italic>c. </italic></highlight>The halftone processing module <highlight><bold>21</bold></highlight><highlight><italic>c </italic></highlight>is intended for halftone processing in which CMYK tone values of all dots are transformed into values in the density of the corresponding color inks. In this processing, data for driving the print head to deposit the inks on paper, according to the values of density obtained after transformation is generated. The print data generation module <highlight><bold>21</bold></highlight><highlight><italic>d </italic></highlight>receives such data for driving the print head, and under its control, the data is arranged in sequence in which the data is to be used on the printer <highlight><bold>40</bold></highlight>. On the printer <highlight><bold>40</bold></highlight>, an array of ink jet nozzles, not shown, is installed as an ink jet device. In this nozzle array, because a plurality of ink jet nozzles are installed in parallel in the feed direction, data for dots that are separated by a few dots in the feed direction is used simultaneously. </paragraph>
<paragraph id="P-0099" lvl="0"><number>&lsqb;0099&rsqb;</number> Then, rasterizing is performed, that is, rearranging the data in sequence so that dots data arranged in the scanning direction that are to be used simultaneously will be buffered simultaneously in the printer <highlight><bold>40</bold></highlight>. After the rasterizing, predetermined data such as image resolution is added, and print data is generated that is output to the printer <highlight><bold>40</bold></highlight> via the parallel communication I/O unit <highlight><bold>19</bold></highlight><highlight><italic>b. </italic></highlight>Based on the print data, the printer <highlight><bold>40</bold></highlight> prints an image displayed on the display <highlight><bold>18</bold></highlight>. </paragraph>
<paragraph id="P-0100" lvl="7"><number>&lsqb;0100&rsqb;</number> (2) Print Operation </paragraph>
<paragraph id="P-0101" lvl="0"><number>&lsqb;0101&rsqb;</number> Print operation to be carried out by the hardware and software configured as above will be explained below, based on a flowchart shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference> and a conceptual diagram of operation shown in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>. On the screen of the display <highlight><bold>18</bold></highlight> shown in FIG. <highlight><bold>4</bold></highlight>, an image is displayed under the run of the APL <highlight><bold>25</bold></highlight>; that is, image data <highlight><bold>15</bold></highlight><highlight><italic>a </italic></highlight>stored in the disk on the HDD <highlight><bold>15</bold></highlight> is read into the RAM and an image therefrom is displayed on the screen, when the computer is receiving user request for executing print operation. In short, under the APL <highlight><bold>25</bold></highlight>, when the image data <highlight><bold>15</bold></highlight><highlight><italic>a </italic></highlight>is read into the RAM <highlight><bold>14</bold></highlight>, image A is presented on the display <highlight><bold>18</bold></highlight> from the image data <highlight><bold>15</bold></highlight><highlight><italic>a </italic></highlight>under the control of the display DRV <highlight><bold>23</bold></highlight>. </paragraph>
<paragraph id="P-0102" lvl="0"><number>&lsqb;0102&rsqb;</number> Image A shown in <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a photograph of a scene of the sea and blue sky above, which is captured with a digital camera, not shown, as an image that is colored in a lot of colors of tints in the green hue to the blue hue. Because the LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>in the present preferred embodiment is built to make effective use of colors such as the colors of tints in the green hue to the blue hue, which are out of the color gamut of the display <highlight><bold>18</bold></highlight>, but fall within the color gamut of the printer <highlight><bold>40</bold></highlight>, as will be explained later, an image assuming the hues like image A is suitable for the one to which the present invention should be applied. Under the APL <highlight><bold>25</bold></highlight>, the computer reads the data of image A stored in the disk on the HDD <highlight><bold>15</bold></highlight> into the RAM and presents image A on the display <highlight><bold>18</bold></highlight>. Then, the user can request the computer to execute retouching and other image processing as well as print operation of the image A via the APL. </paragraph>
<paragraph id="P-0103" lvl="0"><number>&lsqb;0103&rsqb;</number> Request for retouching and print operation can be performed by choosing the appropriate item from the menu presented on the display <highlight><bold>18</bold></highlight>, using the input device such as the mouse <highlight><bold>32</bold></highlight>. On the illustrative screen shown in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>, the user is issuing the request for executing print operation by using the pointer of the mouse <highlight><bold>32</bold></highlight>. More specifically, using the mouse <highlight><bold>32</bold></highlight>, when the user points the Print item from the menu by the pointer and clicks it with the button of the mouse <highlight><bold>32</bold></highlight>, the request for executing print operation is issued and the image data <highlight><bold>15</bold></highlight><highlight><italic>a </italic></highlight>is handed over to the PRTDRV <highlight><bold>21</bold></highlight>. </paragraph>
<paragraph id="P-0104" lvl="0"><number>&lsqb;0104&rsqb;</number> Once the image data <highlight><bold>15</bold></highlight><highlight><italic>a </italic></highlight>has been handed over to the PRTDRV <highlight><bold>21</bold></highlight>, print operation illustrated in <cross-reference target="DRAWINGS">FIG. 3</cross-reference> starts. In step S<highlight><bold>100</bold></highlight>, image data <highlight><bold>15</bold></highlight><highlight><italic>a </italic></highlight>of image A is acquired from the RAM <highlight><bold>14</bold></highlight>, where it was stored, under the control the image data acquisition module <highlight><bold>21</bold></highlight><highlight><italic>a. </italic></highlight>Then, the color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>is activated and the RGB to CMYK transformation for all dots of the image data <highlight><bold>15</bold></highlight><highlight><italic>a </italic></highlight>is executed in step S<highlight><bold>110</bold></highlight>. During this transformation, the color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>makes the computer execute interpolation computation while referring to the LUT <highlight><bold>15</bold></highlight><highlight><italic>b, </italic></highlight>thereby generating CMYK data. The LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>contains data created through color gamut shift by which the color gamut of the display <highlight><bold>18</bold></highlight> is made close to that of the printer <highlight><bold>24</bold></highlight> in the region of the green hue to the blue hue of low and medium lightness and color gamut expansion by which the extent of chroma values expands while the lightness keeps virtually constant. The LUT <highlight><bold>15</bold></highlight><highlight><italic>a </italic></highlight>is built to map a given color in the gamut of the display <highlight><bold>18</bold></highlight> to a color of its transformation with higher chroma that is invisible on the display <highlight><bold>18</bold></highlight>. Thus, color transformation can be performed so that the tones of image A can be refined by the effective use of the color gamut of the printer <highlight><bold>40</bold></highlight> free from the constraint of the color gamut of the display <highlight><bold>18</bold></highlight>. </paragraph>
<paragraph id="P-0105" lvl="0"><number>&lsqb;0105&rsqb;</number> After the color transformation, the dot matrix data obtained is subjected to halftone processing in step S<highlight><bold>120</bold></highlight> under the control of the halftone processing module <highlight><bold>21</bold></highlight><highlight><italic>c. </italic></highlight>Furthermore, the data is subjected to rasterizing in step S<highlight><bold>130</bold></highlight> under the control of the print data generation module <highlight><bold>21</bold></highlight><highlight><italic>d. </italic></highlight>Then, the thus generated print data is output to the printer in step S<highlight><bold>140</bold></highlight> via the parallel communication I/O unit <highlight><bold>19</bold></highlight><highlight><italic>b. </italic></highlight>In step S<highlight><bold>150</bold></highlight>, judgment is made as to whether all rasters of the image data <highlight><bold>15</bold></highlight><highlight><italic>a </italic></highlight>have been processed by color transformation and subsequent. Until it has been judged that all rasters have been processed, the steps <highlight><bold>100</bold></highlight> and subsequent steps are repeated. As the result, the printer <highlight><bold>40</bold></highlight> prints image B, using the colors obtained after the color transformation. The sky and sea view of image B is printed with emphasized chroma in the region of the green hue to the blue hue of low and medium lightness as compared with image A. </paragraph>
<paragraph id="P-0106" lvl="0"><number>&lsqb;0106&rsqb;</number> The LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>contains, as is shown in <cross-reference target="DRAWINGS">FIG. 5</cross-reference>, RGB tone data in compliance with the sRGB standards and corresponding CMYK tone data for use on the printer <highlight><bold>40</bold></highlight> for sample points. In the step S<highlight><bold>110</bold></highlight>, the interpolation computation is executed, based on these sample points, thereby mapping any given RGB tone values to CMYK tone values. As the method of interpolation computation, diverse techniques are publicly known and any of them is applicable. In accordance with the present invention, the LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>is created through the processing of color gamut shift and color gamut expansion. Thus, the expansion of the extent of chroma values can be achieved as described above by making effective use of the color gamut of the printer <highlight><bold>40</bold></highlight> and unnatural color transformation does not take place. Next, a process of creating the LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>will be explained. </paragraph>
<paragraph id="P-0107" lvl="7"><number>&lsqb;0107&rsqb;</number> (3) LUT Creation Process </paragraph>
<paragraph id="P-0108" lvl="0"><number>&lsqb;0108&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> illustrates the process flow of creating the LUT <highlight><bold>15</bold></highlight><highlight><italic>b. </italic></highlight>Because this process involves a lot of arithmetic processing, using the computer is desirable to execute arithmetic operation. The processing of color gamut shift and color gamut expansion in accordance with the present invention is performed in such a manner as to alter the lightness and chroma without actively changing the hues in a hue. On the assumption of using a Lab (CIELAB) color space, this processing is performed on a plane intersecting axis L at right angles and in parallel displacement along the axis L in the Lab space. The processing is performed for a region of a certain hue range in which a color region exists that is out of the color gamut of the display <highlight><bold>18</bold></highlight>, but falls within the color gamut of the printer <highlight><bold>40</bold></highlight>. In the present preferred embodiment, the region of the green hue to blue hue applies as described above. Specifically, this region is defined as the range of hue angles 120&deg; to 280&deg; in the Lab space in which the above processing in accordance with the present invention can be performed for the colors of tints in the green hue to the blue hue. This region of target of processing can be changed, according to the applied device type of display and printer, the image processing medium used, and the kinds of ink or other colorant used on the printer. </paragraph>
<paragraph id="P-0109" lvl="0"><number>&lsqb;0109&rsqb;</number> Although the LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>is to hold the mapping between RGB values and CMYK values, the processing is performed in the Lab space, which is device-independent color space, to take the color gamut of the display <highlight><bold>18</bold></highlight> and the color gamut of the printer <highlight><bold>40</bold></highlight> into account. Instep S<highlight><bold>200</bold></highlight>, first, the color gamut of the display is fixed. In the present preferred embodiment, in the image data <highlight><bold>15</bold></highlight><highlight><italic>a, </italic></highlight>colors are expressed by combinations of the respective 256 tone values of the R, G, and B colors. The color gamut of the display <highlight><bold>18</bold></highlight> is fixed by taking all combinations of the respective 256 tone values of R, G, and B into account. Because the RGB data is image data in compliance with the sRGB standards as described above, it can be transformed into color values by the coordinates of the Lab space by using a publicly known transformation formula. In step S<highlight><bold>205</bold></highlight>, this transformation is performed and the color gamut of the display <highlight><bold>18</bold></highlight> in the Lab space is fixed. </paragraph>
<paragraph id="P-0110" lvl="0"><number>&lsqb;0110&rsqb;</number> In step S<highlight><bold>210</bold></highlight>, the color gamut of the printer <highlight><bold>40</bold></highlight> is fixed. In the CMYK tone data for the printer <highlight><bold>40</bold></highlight>, similarly, colors are expressed by combinations of the respective 256 tone values of the C, M, Y, and K colors. Thus, the color gamut of the printer <highlight><bold>40</bold></highlight> is fixed by taking all combinations of the respective 256 tone values of C, M, Y, and K into account. In step S <highlight><bold>215</bold></highlight>, the thus fixed color gamut is transformed into the gamut in the Lab space. Hereon, the printer&apos;s color gamut in the Lab space can be fixed by measuring a color patch printed from the above CMYK data with a calorimeter or by reference to the profile of the printer <highlight><bold>40</bold></highlight>. Not only the CMYK tone data, but also CMY data, CMYKlclm data, and CMYK lclmDY data may be applied. It is also possible to fix the printer&apos;s color gamut in the Lab space, based on the transformation by means of color separation into color components, using the above-mentioned color data in combination. </paragraph>
<paragraph id="P-0111" lvl="0"><number>&lsqb;0111&rsqb;</number> After thus fixing the color gamut of display <highlight><bold>18</bold></highlight> and the color gamut of printer <highlight><bold>19</bold></highlight> in the Lab space, color gamut shift is executed in step S<highlight><bold>220</bold></highlight> to shift and map the color gamut of display <highlight><bold>18</bold></highlight>. Furthermore, color gamut expansion is executed in step S<highlight><bold>230</bold></highlight> to expand and map the thus shifted gamut. Hereon, the above color gamut shift is executed to decrease the lightness and increase the chroma. The resulting gamut mapping is expanded such that the shape of the color gamut of display <highlight><bold>18</bold></highlight> is close to that of printer <highlight><bold>40</bold></highlight>. Thus, the resulting gamut maintains the characteristics of the color gamut of display <highlight><bold>18</bold></highlight>, while it is close to the characteristics of the color gamut of printer <highlight><bold>40</bold></highlight>. Moreover, as compared with the gamut of display before being shifted, the number of colors falling within the color gamut of printer <highlight><bold>40</bold></highlight> has increased and the number of colors out of the color gamut of printer <highlight><bold>40</bold></highlight> has decreased. The color gamut expansion is executed to increase the chroma, thus producing gamut mapping such that the gamut once shifted further expands into the color gamut of printer <highlight><bold>40</bold></highlight>. Thus, the resulting gamut is characterized by the increased number of colors with higher chroma out of the color gamut of display <highlight><bold>18</bold></highlight>. </paragraph>
<paragraph id="P-0112" lvl="0"><number>&lsqb;0112&rsqb;</number> In step S<highlight><bold>240</bold></highlight>, color values by the coordinates that are still out of the color gamut of printer <highlight><bold>40</bold></highlight> after the gamut mapping and modification are compressed toward the center point of lightness. Because the thus produced gamut dot-to-dot corresponds to the original color gamut of display <highlight><bold>18</bold></highlight>, the color data in the resulting gamut is transformed into the CMYK tone values in step S<highlight><bold>250</bold></highlight>. Hereon, this transformation is reverse to the transformation performed in the step S<highlight><bold>215</bold></highlight>. As the result of this transformation, mapping between the sRGB-compliant data and the CMYK data is set definite. In step S<highlight><bold>260</bold></highlight>, the sample points necessary for interpolation computation at color transformation are extracted and their data is set in the LUT <highlight><bold>15</bold></highlight><highlight><italic>b. </italic></highlight></paragraph>
<paragraph id="P-0113" lvl="0"><number>&lsqb;0113&rsqb;</number> The LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>is thus built as exemplified in <cross-reference target="DRAWINGS">FIG. 5</cross-reference>. Apparently, the table contains data representing simple mapping between the sRGB data and the corresponding CMYK data, but this mapping has been obtained through the transition indicated by the dotted lines and arrows below the table. Specifically, the shift of the color gamut of display <highlight><bold>18</bold></highlight> in the Lab space produces gamut mapping (Lab)&prime; and expanding the gamut (Lab)&prime; produces gamut mapping (Lab)&Prime;. Finally, the sRGB color data in the resulting gamut (Lab)&Prime; is transformed into the CMYK data. After color transformation executed by the color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b, </italic></highlight>consequently, such colors are reproduced from the CMYK data that are not reproducible from the sRGB data. Note that the LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>can be adapted to varieties of devices of display <highlight><bold>18</bold></highlight> and printer <highlight><bold>40</bold></highlight>, image processing media, and ink used on the printer <highlight><bold>40</bold></highlight>. </paragraph>
<paragraph id="P-0114" lvl="7"><number>&lsqb;0114&rsqb;</number> (4) Color Gamut Shift </paragraph>
<paragraph id="P-0115" lvl="0"><number>&lsqb;0115&rsqb;</number> In this subsection, the color gamut shift in the above-mentioned step S<highlight><bold>220</bold></highlight> will be explained in detail. <cross-reference target="DRAWINGS">FIG. 7</cross-reference> shows surface views of the color gamut (Lab) of display <highlight><bold>18</bold></highlight> and the color gamut P of printer <highlight><bold>40</bold></highlight> on the a-b plane cut in lightness segments in the Lab space. Here, the range of lightness L values &ldquo;10&lE;L&lE;90&rdquo; is segmented in steps of 10. As shown in <cross-reference target="DRAWINGS">FIG. 7</cross-reference>, in the high lightness range (L is 70 or higher), the color gamut (Lab) of display <highlight><bold>18</bold></highlight> is generally wider than the color gamut P of printer <highlight><bold>40</bold></highlight>. In the medium lightness range (30&lt;L&lt;60) and in the region of the green hue to the blue hue (hue angles of 180&deg;&plusmn;90&deg;), however, the color gamut P of printer <highlight><bold>40</bold></highlight> is wider than the color gamut (Lab) of display <highlight><bold>18</bold></highlight>. Thus, the processing of color gamut shift and color gamut expansion is performed for the region around the hue angle of 180&deg;. </paragraph>
<paragraph id="P-0116" lvl="0"><number>&lsqb;0116&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> shows mapping of the color gamut (Lab) of display <highlight><bold>18</bold></highlight>, the color gamut P of printer <highlight><bold>40</bold></highlight>, and the gamut (Lab)&prime; shifted by color gamut shift on the plane cut at the hue angle of 180&deg; in the Lab space. Here, chroma C (&equals;(a**2&plus;b**2)**(1/2)) is plotted on the abscissa and lightness L is plotted on the ordinate, ranging &ldquo;0&lE;C&lE;100&rdquo; and &ldquo;0&lE;L&lE;100,&rdquo; respectively. In the present preferred embodiment, color gamut shift is executed so that the highest chroma point of the color gamut (Lab) of display <highlight><bold>18</bold></highlight> will shift the most in chroma and lightness. The shifts of other color values by the coordinates (C, L) are determined by how near is the value of the chroma coordinate to the highest chroma point. </paragraph>
<paragraph id="P-0117" lvl="0"><number>&lsqb;0117&rsqb;</number> For a given point in the gamut (Lab), values of its coordinates (Cnew, Lnew) to where to shift are calculated by using the following equations (1) and (2):  
<math-cwu id="MATH-US-00001">
<number>1</number>
<math>
  <mrow>
    <mo>[</mo>
    <mrow>
      <mi>Equation</mi>
      <mo>&it;</mo>
      <mstyle>
        <mtext>&emsp;</mtext>
      </mstyle>
      <mo>&it;</mo>
      <mn>1</mn>
    </mrow>
    <mo>]</mo>
  </mrow>
</math>
<math>
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <mi>Cnew</mi>
          <mo>=</mo>
          <mrow>
            <mi>C</mi>
            <mo>+</mo>
            <mrow>
              <mi>&Delta;</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>C</mi>
              <mo>&it;</mo>
              <mfrac>
                <mi>C</mi>
                <mrow>
                  <mi>CO</mi>
                  <mo>&af;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>&theta;</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mfrac>
              <mo>&it;</mo>
              <mrow>
                <mi>RC</mi>
                <mo>&af;</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>&theta;</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mtd>
      <mtd>
        <mrow>
          <mo>(</mo>
          <mn>1</mn>
          <mo>)</mo>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mi>Lnew</mi>
          <mo>=</mo>
          <mrow>
            <mi>L</mi>
            <mo>+</mo>
            <mrow>
              <mi>&Delta;</mi>
              <mo>&it;</mo>
              <mstyle>
                <mtext>&emsp;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mi>L</mi>
              <mo>&it;</mo>
              <mfrac>
                <mi>C</mi>
                <mrow>
                  <mi>CO</mi>
                  <mo>&af;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>&theta;</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mfrac>
              <mo>&it;</mo>
              <mrow>
                <mi>RL</mi>
                <mo>&af;</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>&theta;</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mtd>
      <mtd>
        <mrow>
          <mo>(</mo>
          <mn>2</mn>
          <mo>)</mo>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
<mathematica-file id="MATHEMATICA-00001" file="US20030001860A1-20030102-M00001.NB"/>
<image id="EMI-M00001" wi="216.027" he="55.93455" file="US20030001860A1-20030102-M00001.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0118" lvl="7"><number>&lsqb;0118&rsqb;</number> where, the values of the coordinates of a given point from where to shift are (C, L), the displacement of the highest chroma point in chroma is &Dgr;C and that in lightness is &Dgr;L, and the highest chroma point is chroma C<highlight><bold>0</bold></highlight> (&thgr;) at hue angle &thgr;. In the present preferred embodiment, the highest chroma point lies at the hue angle of 180&deg;. The displacements &Dgr;C and &Dgr;L in <cross-reference target="DRAWINGS">FIG. 8</cross-reference> can be selected suitably, according to the applied device type of display <highlight><bold>18</bold></highlight> and printer <highlight><bold>40</bold></highlight> and other conditions. </paragraph>
<paragraph id="P-0119" lvl="0"><number>&lsqb;0119&rsqb;</number> In these equations (1) and (2), RC (&thgr;) is a shift coefficient in chroma and RL (&thgr;) is a shift coefficient in lightness and these shift coefficients vary, depending on the hue angles. The shift coefficient in chroma RC (&thgr;) assumes a finite value that varies within the range of &ldquo;&thgr;1&lE;&thgr;&lE;&thgr;2&rdquo; (&thgr;<highlight><bold>1</bold></highlight> and &thgr;<highlight><bold>2</bold></highlight> are equal angles from 180&deg;) as is shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. As the hue angle increases from &thgr;<highlight><bold>1</bold></highlight>, the shift coefficient gradually rises from 0 to 1. As the hue angle decreases from &thgr;<highlight><bold>2</bold></highlight>, the shift coefficient gradually rises from 0 to 1. In a given range of hue angles between &thgr;<highlight><bold>1</bold></highlight> and &thgr;<highlight><bold>2</bold></highlight>, the shift coefficient keeps at 1. </paragraph>
<paragraph id="P-0120" lvl="0"><number>&lsqb;0120&rsqb;</number> The shift coefficient in lightness RL (&thgr;) assumes a finite value that varies within the range of &ldquo;&thgr;1&lE;&thgr;&lE;&thgr;3&rdquo; (&thgr;<highlight><bold>1</bold></highlight> and &thgr;<highlight><bold>3</bold></highlight> are equal angles from 180&deg;) as is shown in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>. As the hue angle increases from &thgr;<highlight><bold>1</bold></highlight>, the shift coefficient gradually rises from 0 to 1. As the hue angle decreases from &thgr;<highlight><bold>3</bold></highlight>, the shift coefficient gradually rises from 0 to 1. In a given range of hue angles between &thgr;<highlight><bold>1</bold></highlight> and &thgr;<highlight><bold>3</bold></highlight>, the shift coefficient keeps at 1. The dependence of the shift coefficients in chroma RC (&thgr;) and lightness RL (&thgr;) on the hue angles is attributed to the projection of the color gamut P of printer <highlight><bold>40</bold></highlight> toward the left, that is, in the direction of the hue angle of 180&deg; in the medium lightness range as shown in <cross-reference target="DRAWINGS">FIG. 7</cross-reference>. This takes account of the geometrical relation between the color gamut P of this shape and the color gamut (Lab). The shift coefficients in chroma RC (&thgr;) and lightness RL (&thgr;) vary, depending on the hue angles, but they do differently. As a result, the color gamut (Lab) of display <highlight><bold>18</bold></highlight> will be finely adjusted to be close to the color gamut P of printer <highlight><bold>40</bold></highlight>. </paragraph>
<paragraph id="P-0121" lvl="0"><number>&lsqb;0121&rsqb;</number> In the above equations (1) and (2), the displacement of the highest chroma point in chroma &Dgr;C or in lightness &Dgr;L is multiplied by a ratio of the chroma coordinate C of a given point from where to shift to chroma C<highlight><bold>0</bold></highlight> (&thgr;) at the highest chroma point. If the coordinates of a point from where to shift are nearer to the edge of the color gamut (Lab) of display <highlight><bold>18</bold></highlight>, the shift in chroma and lightness is greater. The lower the chroma, the shift will be smaller. In other words, for a color of little colorfulness, located near the lightness axis, there will occur a little shift in chroma and lightness. </paragraph>
<paragraph id="P-0122" lvl="0"><number>&lsqb;0122&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is a flowchart illustrating the processing of color gamut shift using the above equations (1) and (2). Referring to <cross-reference target="DRAWINGS">FIG. 11</cross-reference>, at the first step S<highlight><bold>300</bold></highlight>, the highest chroma point displacements &Dgr;C in chroma and &Dgr;L in lightness in the color gamut (Lab) of display <highlight><bold>19</bold></highlight> are determined. In the next step S<highlight><bold>310</bold></highlight>, a hue for which the shift processing is carried out is determined. In the present preferred embodiment, the hue range of &ldquo;&thgr;1 to &thgr;3&rdquo; is set as the target of processing, and in this range, the shift coefficients in chroma RC (&thgr;) and lightness RL (&thgr;) varies, depending on the hue angles. The shift processing is carried out, while changing the hue angle in steps of a predetermined angle sequentially from &thgr;<highlight><bold>1</bold></highlight>. </paragraph>
<paragraph id="P-0123" lvl="0"><number>&lsqb;0123&rsqb;</number> In step <highlight><bold>320</bold></highlight>, values of initial coordinates (C, L) are assigned in the hue of target of processing. In step S<highlight><bold>330</bold></highlight>, chroma C<highlight><bold>0</bold></highlight> (&thgr;) at the highest chroma point in the hue is extracted. In step S<highlight><bold>340</bold></highlight>, calculation is executed by assigning the extracted chroma C<highlight><bold>0</bold></highlight> (&thgr;) and the values of initial coordinates (C, L) to the above equations (1) and (2), assigning a hue angle that is now set for processing to the shift coefficients in chroma RC (&thgr;) and lightness RL (&thgr;) and multiplying the remaining of the equations (1) and (2) by the shift coefficients, respectively. By this calculation, values of shifted from the values of coordinates (C, L) are obtained. </paragraph>
<paragraph id="P-0124" lvl="0"><number>&lsqb;0124&rsqb;</number> After shifting a point from its coordinates (C, L) to its new coordinates (Cnew, Lnew), judgment is made as to whether calculation to obtain (Cnew, and Lnew) has been done for all coordinate points in step S<highlight><bold>350</bold></highlight>. This judgment is made for all coordinate points in the gamut, wherein it is sufficient to select the necessary and sufficient number of points for creating the LUT <highlight><bold>15</bold></highlight><highlight><italic>b, </italic></highlight>because the color gamut shift is one step of creating the LUT <highlight><bold>15</bold></highlight><highlight><italic>b. </italic></highlight>Points for which the calculation is executed can be selected in several manners; for example, calculation is executed for only points given by integer values of coordinates or the Lab color space is latticed with predetermined pitches and calculation is executed for only the lattice points. </paragraph>
<paragraph id="P-0125" lvl="0"><number>&lsqb;0125&rsqb;</number> If the judgment in the step S<highlight><bold>350</bold></highlight> is that calculation has not been done for all coordinate points, the next values of coordinates (C, L) to be assigned to the equations are set in step S<highlight><bold>360</bold></highlight> and the step S<highlight><bold>330</bold></highlight> and subsequent are repeated. If the judgment in the step S<highlight><bold>350</bold></highlight> is that calculation has been done for all coordinate points, whether shift processing has been done for all points over the hue is judged in step S<highlight><bold>370</bold></highlight>. Until it has been judged that shift processing has been done for all points over the hue, the step S<highlight><bold>310</bold></highlight> and subsequent are repeated. By executing the calculation described above, the gamut (Lab)&prime; shifted from the color gamut (Lab) of display <highlight><bold>18</bold></highlight> can be obtained at, for example, hue angle of 180&deg; as shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>. </paragraph>
<paragraph id="P-0126" lvl="7"><number>&lsqb;0126&rsqb;</number> (5) Color Gamut Expansion </paragraph>
<paragraph id="P-0127" lvl="0"><number>&lsqb;0127&rsqb;</number> In this subsection, the color gamut expansion in the above-mentioned step S<highlight><bold>230</bold></highlight> will be explained in detail. <cross-reference target="DRAWINGS">FIG. 12</cross-reference> shows mapping of the color gamut (Lab) of display <highlight><bold>18</bold></highlight>, the color gamut P of printer <highlight><bold>40</bold></highlight>, the gamut (Lab)&prime; shifted by color gamut shift, and the gamut (Lab)&Prime; expanded by color gamut expansion on the plane cut at the hue angle of 180&deg; in the Lab space. Here, similarly, chroma C is plotted on the abscissa and lightness L is plotted on the ordinate, ranging &ldquo;0&lE;C&lE;100&rdquo; and &ldquo;0&lE;L&lE;100,&rdquo; respectively. In the present preferred embodiment, color gamut expansion is executed to increase the chroma. To calculate the chroma rise, first, the maximum chroma value to which chroma will rise is calculated by using the following equation:</paragraph>
<paragraph id="P-0128" lvl="7"><number>&lsqb;0128&rsqb;</number> &lsqb;Equation 2&rsqb;</paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>C</italic></highlight>max&equals;<highlight><italic>Cm</italic></highlight>(1&plus;<highlight><italic>Rm*&agr;*&bgr;*</italic></highlight>rate)&emsp;&emsp;(3)</in-line-formula></paragraph>
<paragraph id="P-0129" lvl="7"><number>&lsqb;0129&rsqb;</number> where, Cmax is the maximum chroma value to which chroma will rise, &agr; is an expansion coefficient depending on hue, &bgr; is an expansion coefficient depending on lightness, rate is an expansion coefficient depending on lightness and hue, and Rm is a maximum expansion rate. </paragraph>
<paragraph id="P-0130" lvl="0"><number>&lsqb;0130&rsqb;</number> The maximum expansion rate Rm limits the chroma rise to a maximum chroma value. In equation (3), Rm is multiplied by &agr;, &bgr;, and rate, so that chroma will rise, depending on hue and lightness. These variables can be set suitably, according to the applied device type of display <highlight><bold>18</bold></highlight> and printer <highlight><bold>40</bold></highlight> and other conditions. The expansion coefficient a assumes a finite value that varies within the range of &ldquo;&thgr;4&lE;&thgr;&lE;&thgr;5&rdquo; (&thgr;<highlight><bold>4</bold></highlight> and &thgr;<highlight><bold>5</bold></highlight> are equal angles from 180&deg;) as is shown in <cross-reference target="DRAWINGS">FIG. 13</cross-reference>. As the hue angle increases from &thgr;<highlight><bold>4</bold></highlight>, the expansion coefficient a gradually rises from 0 to 1. As hue angle decreases from &thgr;<highlight><bold>5</bold></highlight>, the expansion coefficient &agr; gradually rises from 0 to 1. In a given range of hue angles between &thgr;<highlight><bold>4</bold></highlight> and &thgr;<highlight><bold>5</bold></highlight>, the expansion coefficient &agr; keeps at 1. This efficient is used for taking account of the projection of the color gamut P of printer <highlight><bold>40</bold></highlight> toward the left, that is, in the direction of the hue angle of 180&deg; in the medium lightness range as shown in <cross-reference target="DRAWINGS">FIG. 7</cross-reference> and to make effective use of the projection of the gamut P toward the left. </paragraph>
<paragraph id="P-0131" lvl="0"><number>&lsqb;0131&rsqb;</number> The expansion coefficient &bgr; assumes a finite value that varies within the range of &ldquo;L1&lE;L&lE;L2&rdquo; as is shown in <cross-reference target="DRAWINGS">FIG. 14</cross-reference>. As the lightness increases from L<highlight><bold>1</bold></highlight>, the expansion coefficient &bgr; gradually rises from 0 to 1. As the lightness decreases from L<highlight><bold>2</bold></highlight>, the expansion coefficient &bgr; gradually rises from 0 to 1. In a given range of lightness between L<highlight><bold>1</bold></highlight> and L<highlight><bold>2</bold></highlight>, the expansion coefficient &bgr; keeps at 1. The slope of the value change of the expansion coefficient &bgr; near L<highlight><bold>2</bold></highlight> is gentler than that near L<highlight><bold>1</bold></highlight>. This reflects general characteristics that the gamut P appears to be overlap the gamut (Lab) at very low lightness and the gamut (Lab) is wider than the gamut P at very high lightness as shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference>. The expansion coefficient &bgr; reflects general color gamut characteristics and changes, following the function curve shown in <cross-reference target="DRAWINGS">FIG. 14</cross-reference>. </paragraph>
<paragraph id="P-0132" lvl="0"><number>&lsqb;0132&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 15</cross-reference> shows a function curve of the rate expansion coefficient with lightness L plotted on the abscissa and its peak being L (&thgr;). This peak corresponds to the highest chroma point of the gamut (Lab)&prime; for a hue, that is, the peak of the projection of the gamut toward the left. Because this peak value differs if the hue differs, the rate expansion coefficient for a specific value of lightness assumes a different value, depending on the assumed hue. In <cross-reference target="DRAWINGS">FIG. 15</cross-reference>, the rate expansion coefficient assumes a finite value that varies within the range of &ldquo;0&lE;L/peak L (&thgr;)&lE;1.&rdquo; The rate expansion coefficient gradually rises from 0 toward 1, reaches 1 at point &ldquo;11&rdquo; on the abscissa, and gradually falls to 0 in the section from point &ldquo;12&rdquo; to 1. This prevents chroma from rising in the region of lightness higher than the peak. </paragraph>
<paragraph id="P-0133" lvl="0"><number>&lsqb;0133&rsqb;</number> The maximum chroma value to which chroma will rise is calculated by assigning values to the variables described above in the equation (3). Once this calculation has been executed, taking account of the ratio of the chroma values of Cnew obtained by the color gamut shift to the thus obtained maximum chroma value, how chroma will rise at any point is calculated. For each coordinate point in the gamut once shifted, chroma Clnew can be calculated as the value to which chroma will rise, by which gamut expansion will take place.  
<math-cwu id="MATH-US-00002">
<number>2</number>
<math>
  <mrow>
    <mo>[</mo>
    <mrow>
      <mi>Equation</mi>
      <mo>&it;</mo>
      <mstyle>
        <mtext>&emsp;</mtext>
      </mstyle>
      <mo>&it;</mo>
      <mn>3</mn>
    </mrow>
    <mo>]</mo>
  </mrow>
</math>
<math>
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <mi>C1new</mi>
          <mo>=</mo>
          <mrow>
            <mi>Cst</mi>
            <mo>+</mo>
            <mrow>
              <mrow>
                <mo>(</mo>
                <mstyle>
                  <mtext>&emsp;</mtext>
                </mstyle>
                <mo>&it;</mo>
                <mrow>
                  <mi>Cnew</mi>
                  <mo>-</mo>
                  <mi>Cst</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
              <mo>&it;</mo>
              <mi>Cmax</mi>
            </mrow>
            <mo>-</mo>
            <mfrac>
              <mi>Cst</mi>
              <mrow>
                <mi>Cm</mi>
                <mo>-</mo>
                <mi>Cst</mi>
              </mrow>
            </mfrac>
          </mrow>
        </mrow>
      </mtd>
      <mtd>
        <mrow>
          <mo>(</mo>
          <mn>4</mn>
          <mo>)</mo>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
<mathematica-file id="MATHEMATICA-00002" file="US20030001860A1-20030102-M00002.NB"/>
<image id="EMI-M00002" wi="216.027" he="29.0304" file="US20030001860A1-20030102-M00002.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0134" lvl="7"><number>&lsqb;0134&rsqb;</number> Calculation is executed so that chroma will not rise in a region where chroma is lower than chroma Cst. The value of Cst is determined by multiplying the maximum chroma value Cm in the gamut shifted by color gamut shift by a value of 0.2 to 0.4 in the present preferred embodiment. </paragraph>
<paragraph id="P-0135" lvl="0"><number>&lsqb;0135&rsqb;</number> Consequently, chroma rise does not take place for colors in the shaded region in <cross-reference target="DRAWINGS">FIG. 12</cross-reference>, that is, colors showing little colorfulness near the lightness axis. In the present preferred embodiment, the color gamut expansion is restricted so that chroma rise does not exceed the highest chroma in the color gamut P of printer <highlight><bold>40</bold></highlight>. Accordingly, chroma does not rise in the region lighter than point E at the hue angle of 180&deg; as shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference>. Any of diverse methods may be adopted to limit the chroma rise and set a lightness range within which chroma will not rise. For example, it is possible that the compression in the above-mentioned step S<highlight><bold>240</bold></highlight> is arranged to produce final gamut mapping that falls within the color gamut of printer <highlight><bold>40</bold></highlight>. In this case, it is not necessary to restrict the chroma rise by color gamut expansion to less than the highest chroma in the color gamut P of printer <highlight><bold>40</bold></highlight> as described above. </paragraph>
<paragraph id="P-0136" lvl="0"><number>&lsqb;0136&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 16</cross-reference> is a flowchart illustrating the processing of color gamut expansion using the above equations (3) and (4). Referring to <cross-reference target="DRAWINGS">FIG. 16</cross-reference>, at the first step S<highlight><bold>400</bold></highlight>, the maximum expansion rate Rm, the maximum chroma value Cm in the gamut shifted by color gamut shift, and chroma Cst are determined. In the next step S<highlight><bold>410</bold></highlight>, a hue for which the expansion processing is carried out is determined. In the present preferred embodiment, the hue range of &ldquo;&thgr;4 to &thgr;5&rdquo; is set as the target of processing, and in this range, the expansion coefficient a varies, depending on the hue angles. The expansion processing is carried out, while changing the hue angle in steps of a predetermined angle sequentially from &thgr;<highlight><bold>4</bold></highlight>. </paragraph>
<paragraph id="P-0137" lvl="0"><number>&lsqb;0137&rsqb;</number> In step S<highlight><bold>420</bold></highlight>, values of initial coordinates (Cnew, Lnew) obtained after the color gamut shift are assigned in the hue of target of processing. In step S<highlight><bold>430</bold></highlight>, the maximum chroma value Cmax to which chroma will rise is determined by calculation according to the above equation (3). This maximum chroma value is calculated for each value of lightness for defining the boundary of the gamut to expand. Then, in step S<highlight><bold>440</bold></highlight>, calculating chroma Clnew to which the chroma of the target coordinate point will rise is executed by assigning the maximum chroma value Cmax, and Cst, Cm, and Cnew to the equations (3) and (4). The coordinates (Cnew, Lnew) assuming the thus calculated chroma Clnew and the lightness value of Lnew of the point correspond to the coordinates (Cnew, Lnew) of the point after the color gamut shift, and therefore also correspond to the coordinates (C, L) in the color gamut (Lab) before the shift. Thus, by the above calculation, the gamut that has been shifted and expanded in similar correspondence to the color gamut (Lab) of display <highlight><bold>18</bold></highlight> can obtained. </paragraph>
<paragraph id="P-0138" lvl="0"><number>&lsqb;0138&rsqb;</number> After chroma Clnew is calculated in the step S<highlight><bold>440</bold></highlight>, judgment is made as to whether calculation to obtain Clnew has been done for all coordinate points in step S<highlight><bold>450</bold></highlight>. As noted above, this judgment is made for all coordinate points in the gamut, wherein it is sufficient to select the necessary and sufficient number of points for creating the LUT <highlight><bold>15</bold></highlight><highlight><italic>b, </italic></highlight>because the color gamut expansion is regarded as one step of creating the LUT <highlight><bold>15</bold></highlight><highlight><italic>b. </italic></highlight>Points for which the calculation is executed can be selected in several manners; for example, calculation is executed for only points given by integer values of coordinates or the Lab color space is latticed with predetermined pitches and calculation is executed for only the lattice points. </paragraph>
<paragraph id="P-0139" lvl="0"><number>&lsqb;0139&rsqb;</number> If the judgment in the step S<highlight><bold>450</bold></highlight> is that calculation has not been done for all coordinate points, the next values of coordinates (Cnew, Lnew) to be assigned to the equations are set in step S<highlight><bold>460</bold></highlight> and the step S<highlight><bold>430</bold></highlight> and subsequent are repeated. If the judgment in the step S<highlight><bold>450</bold></highlight> is that calculation has been done for all coordinate points, whether expansion processing has been done for all points over the hue is judged in step S<highlight><bold>470</bold></highlight>. Until it has been judged that expansion processing has been done for all points over the hue, the step S<highlight><bold>410</bold></highlight> and subsequent are repeated. By executing the calculation described above, the gamut (Lab)&Prime; expanded from the gamut (Lab)&Prime; can be obtained at, for example, hue angle of 180&deg; as shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference>. </paragraph>
<paragraph id="P-0140" lvl="0"><number>&lsqb;0140&rsqb;</number> The (Lab)&Prime; thus obtained after the processing of color gamut shift and color gamut expansion includes a section that falls out of the color gamut P of printer <highlight><bold>40</bold></highlight> in the higher lightness part. In the present preferred embodiment, as a means of correction, compression is executed in the above-mentioned step. S<highlight><bold>240</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 6</cross-reference>, so that the entirety of the gamut (Lab)&Prime; will fall within the color gamut of printer <highlight><bold>40</bold></highlight>. Specifically, the points out of the color gamut of printer <highlight><bold>40</bold></highlight> are moved toward a middle value <highlight><bold>50</bold></highlight> of lightness to fall within the shaded region H as shown in <cross-reference target="DRAWINGS">FIG. 17</cross-reference>. For example, points F and G on the line from the point F to the middle value <highlight><bold>50</bold></highlight> of lightness (chroma of 0) are moved to points F&prime; and G&prime; respectively along the line. For this compression, kinds of processing techniques are publicly known and any of these techniques can be adopted. </paragraph>
<paragraph id="P-0141" lvl="0"><number>&lsqb;0141&rsqb;</number> As the result of the above-described processing, all points (values) by the coordinates (C, L) before transformation are mapped within the color gamut of printer <highlight><bold>40</bold></highlight>. The thus mapped gamut (Lab)&Prime; includes high chroma points that are out of the color gamut (Lab) of display <highlight><bold>18</bold></highlight>, but falls within the color gamut of printer <highlight><bold>40</bold></highlight> in the medium lightness range. Eventually, the LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>is created, based on this mapping of the gamut (Lab)&Prime; in similar correspondence to the color gamut (Lab) of display <highlight><bold>18</bold></highlight> and this method enables the printer <highlight><bold>40</bold></highlight> to print images with finer tones than images visible on the display <highlight><bold>18</bold></highlight>. </paragraph>
<paragraph id="P-0142" lvl="7"><number>&lsqb;0142&rsqb;</number> (6) Preferred Embodiment 2 </paragraph>
<paragraph id="P-0143" lvl="0"><number>&lsqb;0143&rsqb;</number> For print operation in the above-described preferred embodiment, the color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>of the PRTDRV <highlight><bold>21</bold></highlight> makes the computer execute color transformation by reference to the LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>that maintains the data reflecting the processing result of color gamut shift and color gamut expansion. In this embodiment, by using the LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>arranged for color transformation, the print operation be programmed such that the processing of color gamut shift and color gamut expansion need not be executed each time color transformation is executed. In another preferred embodiment, the print operation may be programmed such that the processing of color gamut shift and color gamut expansion is executed during the color transformation process. <cross-reference target="DRAWINGS">FIG. 18</cross-reference> shows the simplified structure of the OS and related components wherein the processing of color gamut shift and color gamut expansion is executed under the PRTDRV <highlight><bold>21</bold></highlight>. </paragraph>
<paragraph id="P-0144" lvl="0"><number>&lsqb;0144&rsqb;</number> In the structure shown in <cross-reference target="DRAWINGS">FIG. 18</cross-reference>, which is nearly the same as that shown in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, the PRTDRV <highlight><bold>21</bold></highlight> includes a color transformation part <highlight><bold>21</bold></highlight><highlight><italic>e </italic></highlight>instead of the color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b. </italic></highlight>The color transformation part <highlight><bold>21</bold></highlight><highlight><italic>e </italic></highlight>consists of a color gamut shift module <highlight><bold>21</bold></highlight><highlight><italic>e</italic></highlight><highlight><bold>1</bold></highlight> and a color gamut expansion module <highlight><bold>21</bold></highlight><highlight><italic>e</italic></highlight><highlight><bold>2</bold></highlight>. The color gamut shift module <highlight><bold>21</bold></highlight><highlight><italic>e</italic></highlight><highlight><bold>1</bold></highlight> makes the computer execute the above-described color gamut shift processing and the color gamut expansion module <highlight><bold>21</bold></highlight><highlight><italic>e</italic></highlight><highlight><bold>2</bold></highlight> makes the computer execute the above-described color gamut expansion processing. Specifically, when RGB data in compliance with the sRGB standards is acquired under the control of the image data acquisition module <highlight><bold>21</bold></highlight><highlight><italic>a, </italic></highlight>the color transformation part <highlight><bold>21</bold></highlight><highlight><italic>e </italic></highlight>makes the computer transform the RGB data into Lab data, determine its color domain, and determine the color gamut of printer <highlight><bold>40</bold></highlight> in the applied hue in the Lab space, based on the ICC profile of the printer <highlight><bold>40</bold></highlight>. </paragraph>
<paragraph id="P-0145" lvl="0"><number>&lsqb;0145&rsqb;</number> Then, the color gamut shift module <highlight><bold>21</bold></highlight><highlight><italic>e</italic></highlight><highlight><bold>1</bold></highlight> makes the computer execute the above-described steps S<highlight><bold>330</bold></highlight> and S<highlight><bold>340</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 11</cross-reference> per dot of the RGB data and map the above-described gamut (Lab)&prime;. Moreover, the color gamut expansion module <highlight><bold>21</bold></highlight><highlight><italic>e</italic></highlight><highlight><bold>2</bold></highlight> makes the computer execute the above-described steps S<highlight><bold>430</bold></highlight> and S<highlight><bold>440</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 16</cross-reference> and map the above-described gamut (Lab)&Prime;. At this time, if color data by the coordinates after the gamut shift and expansion falls out of the color gamut of printer <highlight><bold>40</bold></highlight>, the computer executes compression in the above-described step S<highlight><bold>240</bold></highlight>. As the result of the processing execution, the RGB data is transformed into any color in the Lab space that is out of the color gamut of display <highlight><bold>18</bold></highlight>, but falls within the color gamut of printer <highlight><bold>40</bold></highlight>. Then, the result of the transformation is further transformed into CMYK data based on the ICC profile of the printer <highlight><bold>40</bold></highlight> and the CMYK data is handed over to the halftone processing module <highlight><bold>21</bold></highlight><highlight><italic>c. </italic></highlight></paragraph>
<paragraph id="P-0146" lvl="0"><number>&lsqb;0146&rsqb;</number> In this way, it is also possible to make the computer <highlight><bold>10</bold></highlight> execute the processing of color gamut shift and color gamut expansion as well as color transformation when making the printer print a certain image. According to the configuration of this embodiment (Embodiment 2), the invention enables the printer <highlight><bold>40</bold></highlight> to output a desirable color image by making more effective use of its color gamut as is the case in the preceding preferred embodiment. In Embodiment 2, the computer must execute the processing of color gamut shift and color gamut expansion, but need not execute the interpolation processing. As an alternative to the embodiment in which the above-described color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>and color transformation part <highlight><bold>21</bold></highlight><highlight><italic>e </italic></highlight>are installed in the computer that operates separately from the printer <highlight><bold>40</bold></highlight>, it is also possible to provide the printer <highlight><bold>40</bold></highlight> with the color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>and color transformation part <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>as its internal functions. </paragraph>
<paragraph id="P-0147" lvl="7"><number>&lsqb;0147&rsqb;</number> (7) Preferred Embodiment 3 </paragraph>
<paragraph id="P-0148" lvl="0"><number>&lsqb;0148&rsqb;</number> The color gamut of printer <highlight><bold>40</bold></highlight> changes when change is made to the device type of the printer <highlight><bold>40</bold></highlight>, image processing medium, and ink used on the printer. Thus, it is desirable to arrange the LUTs for the possible varieties of printer type, image processing medium, and ink on the printer <highlight><bold>40</bold></highlight> as described above. <cross-reference target="DRAWINGS">FIG. 19</cross-reference> shows the simplified structure of the OS and related components wherein different LUTs can be used for different image processing media and ink sets used on the printer <highlight><bold>40</bold></highlight> under the PRTDRV<highlight><bold>20</bold></highlight>. In the structure shown in <cross-reference target="DRAWINGS">FIG. 19</cross-reference>, which is nearly the same as that shown in <cross-reference target="DRAWINGS">FIG. 2, a</cross-reference> plurality of LUTs are provided so that the color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>of the PRTDRV<highlight><bold>21</bold></highlight> will select and use an appropriate LUT for reference, according to the print condition setting performed in advance. </paragraph>
<paragraph id="P-0149" lvl="0"><number>&lsqb;0149&rsqb;</number> Specifically, the PRTDRV <highlight><bold>21</bold></highlight> includes a module not shown that can receive the status of printer <highlight><bold>40</bold></highlight> via the parallel communication I/O unit <highlight><bold>19</bold></highlight><highlight><italic>b </italic></highlight>and determines what ink set is in use, based on the status. The module determines what image processing medium is in use, based on the image processing medium selected by the user, using a Printer Properties window which is not shown. These methods of ink set and image processing medium determination are illustrative. Means for allowing the user to select a desirable ink set may be used or the printer <highlight><bold>40</bold></highlight> may be provided with an image processing medium determination mechanism by which the image processing medium in use is automatically recognized. </paragraph>
<paragraph id="P-0150" lvl="0"><number>&lsqb;0150&rsqb;</number> In the disk storage on the HDD <highlight><bold>15</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 19</cross-reference>, LUTs <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>to <highlight><bold>15</bold></highlight><highlight><italic>g </italic></highlight>are stored whose contents are different for different combinations of image processing medium and ink set. In Embodiment 3, two kinds of ink sets can be used on the printer <highlight><bold>4</bold></highlight>: one ink set consisting of six colors: cyan (C), magenta (M), yellow (Y), black (K), light cyan (lc), and light magenta (<highlight><bold>1</bold></highlight>m); the other consisting of seven colors: cyan (C), magenta (M), yellow (Y), black (K), light cyan (lc), light magenta (lm), and dark yellow (DY). With each ink set, three kinds of image processing media can be used: photo<highlight><bold>1</bold></highlight> (glossy paper), photo<highlight><bold>2</bold></highlight> (glossy paper), and plain paper. Accordingly, six LUTs are prepared beforehand. Of course, the usable ink sets and image processing media are not limited to those mentioned above and the number of LUTs is not limited to six. </paragraph>
<paragraph id="P-0151" lvl="0"><number>&lsqb;0151&rsqb;</number> These LUTs are arranged for six gamuts of printer&apos;s color gamut as determined by combination of image processing medium and ink set. Because the color gamut of printer fixed in the above-described step S<highlight><bold>210</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 6</cross-reference> varies for each combination of image processing medium and ink set, the CMYK data obtained by the result of processing in the steps S<highlight><bold>220</bold></highlight> to S<highlight><bold>240</bold></highlight> differs, and consequently, different LUTs are created. <cross-reference target="DRAWINGS">FIG. 20</cross-reference> shows a table listing symbolic values of parameters given for each combination of ink set and image processing medium, which are used for color gamut shift and color gamut expansion, according to the printer&apos;s color gamut that is mapped as the target gamut of color output. </paragraph>
<paragraph id="P-0152" lvl="0"><number>&lsqb;0152&rsqb;</number> In <cross-reference target="DRAWINGS">FIG. 20</cross-reference>, the ink set consisting of six colors is assumed to be ink set A and the ink set consisting of seven colors ink set B. As shown, the LUT for paper photo<highlight><bold>1</bold></highlight> combined with ink set A is LUT <highlight><bold>15</bold></highlight><highlight><italic>b, </italic></highlight>the LUT for paper photo<highlight><bold>2</bold></highlight> combined with ink set A is LUT <highlight><bold>15</bold></highlight><highlight><italic>c, </italic></highlight>and the LUT for plain paper combined with ink set A is LUT <highlight><bold>15</bold></highlight><highlight><italic>d. </italic></highlight>The LUT for paper photo<highlight><bold>1</bold></highlight> combined with ink set B is LUT <highlight><bold>15</bold></highlight><highlight><italic>e, </italic></highlight>the LUT for paper photo<highlight><bold>2</bold></highlight> combined with ink set B is LUT <highlight><bold>15</bold></highlight><highlight><italic>f, </italic></highlight>and the LUT for plain paper combined with ink set B is LUT <highlight><bold>15</bold></highlight><highlight><italic>g. </italic></highlight></paragraph>
<paragraph id="P-0153" lvl="0"><number>&lsqb;0153&rsqb;</number> In Embodiment 3, the printer&apos; color gamut changes in size, according to the type of paper on which to print images; that is, its gamut is large when photo<highlight><bold>1</bold></highlight> is used, medium with when photo<highlight><bold>2</bold></highlight> is used, and small when plain paper is used with either ink set. Generally, the larger the color gamut, the greater will be the displacements by color gamut shift and the degree of the chroma rise by color gamut expansion. The LUTs <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>to <highlight><bold>15</bold></highlight><highlight><italic>g </italic></highlight>are created, based on the parameter values that are properly selected to be used in the processing of color gamut shift and color gamut expansion to make the displacements by shift and expansion suitable for the color gamut shape that is predetermined for each combination of ink set and paper. </paragraph>
<paragraph id="P-0154" lvl="0"><number>&lsqb;0154&rsqb;</number> The displacements of the highest chroma point in chroma &Dgr;C and in lightness &Dgr;L, which are the parameters for color gamut shift, are set greater for larger color gamut. Specifically, actual values are assigned to these parameters, subject to constraints: &Dgr;C<highlight><bold>1</bold></highlight>&gt;&Dgr;C<highlight><bold>2</bold></highlight>&gt;&Dgr;C<highlight><bold>3</bold></highlight>, &Dgr;C<highlight><bold>4</bold></highlight>&gt;&Dgr;C<highlight><bold>5</bold></highlight>&gt;&Dgr;C<highlight><bold>3</bold></highlight>, &Dgr;L<highlight><bold>1</bold></highlight>&gt;&Dgr;L<highlight><bold>2</bold></highlight>&gt;&Dgr;L<highlight><bold>3</bold></highlight>, and &Dgr;L<highlight><bold>4</bold></highlight>&gt;&Dgr;L<highlight><bold>5</bold></highlight>&gt;&Dgr;L<highlight><bold>3</bold></highlight>. For the shift coefficients in chroma RC (&thgr;) and lightness RL (&thgr;), their value ranges are set greater for larger color gamut. However, all parameters are not necessarily set different for different shapes of color gamuts. In <cross-reference target="DRAWINGS">FIG. 20</cross-reference>, LUT <highlight><bold>15</bold></highlight><highlight><italic>d </italic></highlight>and LUT <highlight><bold>15</bold></highlight><highlight><italic>g </italic></highlight>are created, based common values &Dgr;C<highlight><bold>3</bold></highlight> and &Dgr;L<highlight><bold>3</bold></highlight> used as the displacement parameters in chroma &Dgr;C and lightness &Dgr;L and common functions RC<highlight><bold>2</bold></highlight> (&thgr;) and RL<highlight><bold>2</bold></highlight> (&thgr;) used as the shift coefficients in chroma RC (&thgr;) and lightness RL (&thgr;). LUTs <highlight><bold>15</bold></highlight><highlight><italic>b, </italic></highlight><highlight><bold>15</bold></highlight><highlight><italic>c, </italic></highlight><highlight><bold>15</bold></highlight><highlight><italic>e, </italic></highlight>and <highlight><bold>15</bold></highlight><highlight><italic>f </italic></highlight>are created, based on common functions RC<highlight><bold>1</bold></highlight> (&thgr;) and RL<highlight><bold>1</bold></highlight> (&thgr;) used as the shift coefficients in chroma RC (&thgr;) and lightness RL (&thgr;). For the shift coefficients in chroma RC (&thgr;) and lightness RL (&thgr;), value assignment in the function form instead of adjusting the value range can be adopted. </paragraph>
<paragraph id="P-0155" lvl="0"><number>&lsqb;0155&rsqb;</number> FIGS. <highlight><bold>21</bold></highlight> to <highlight><bold>23</bold></highlight> are provided for explaining different parameter values assigned for each color gamut of printer in the processing of color gamut shift. In Embodiment 3, the displacements of the highest chroma point in chroma &Dgr;C<highlight><bold>2</bold></highlight> and in lightness &Dgr;L<highlight><bold>2</bold></highlight> are assumed identical to the displacements &Dgr;C and &Dgr;L shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>. The shift coefficients in chroma RC<highlight><bold>1</bold></highlight> (&thgr;) and lightness RL<highlight><bold>1</bold></highlight> (&thgr;) are assumed identical to the shift coefficient in chroma RC (&thgr;) shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference> and the shift coefficient in lightness RL (&thgr;) shown in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>. Parameter values different from the above ones are given in FIGS. <highlight><bold>21</bold></highlight> to <highlight><bold>23</bold></highlight>, which are used for creating the LUT <highlight><bold>15</bold></highlight><highlight><italic>d </italic></highlight>that is prepared for plain paper. These parameter values apply to the printer&apos;s color gamut that is smaller than that mapped with the parameters shown in FIGS. <highlight><bold>8</bold></highlight> to <highlight><bold>10</bold></highlight> for the combination of ink set A and paper photo<highlight><bold>2</bold></highlight>. </paragraph>
<paragraph id="P-0156" lvl="0"><number>&lsqb;0156&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 21</cross-reference> is provided for explaining the displacements of the highest chroma point in chroma &Dgr;C<highlight><bold>3</bold></highlight> and in lightness &Dgr;L<highlight><bold>3</bold></highlight>. <cross-reference target="DRAWINGS">FIG. 21</cross-reference> shows mapping of the color gamut (Lab) of display <highlight><bold>18</bold></highlight>, the color gamut P of printer <highlight><bold>40</bold></highlight> for the combination of ink set A and plain paper, and the gamut (Lab)&prime; shifted by color gamut shift on the plane cut at the hue angle of 180&deg; in the Lab space. The color gamut P<highlight><bold>1</bold></highlight> drawn with a dotted line is identical to the printer&apos;s color gamut shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference> for the combination of ink set A and paper photo<highlight><bold>2</bold></highlight>. In <cross-reference target="DRAWINGS">FIG. 21</cross-reference>, here again, chroma C (&equals;(a**2&plus;b**2)**(1/2)) is plotted on the abscissa and lightness L is plotted on the ordinate, ranging &ldquo;0&lE;C&lE;100&rdquo; and &ldquo;0&lE;L&lE;100,&rdquo; respectively. </paragraph>
<paragraph id="P-0157" lvl="0"><number>&lsqb;0157&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 21</cross-reference>, at the hue angle of 180&deg;, the printer&apos;s color gamut P for the combination of ink set A and plain paper is smaller than that for the combination of ink set A and paper photo <highlight><bold>2</bold></highlight>, but somewhat larger than the color gamut (Lab) of display <highlight><bold>18</bold></highlight> in a certain lightness range. If, as the parameter values, the displacements of the highest chroma point in chroma &Dgr;C<highlight><bold>2</bold></highlight> and in lightness &Dgr;L<highlight><bold>2</bold></highlight> are applied, unnaturally colored print results will be produced. However, if excessive shift is suppressed during color gamut shift processing, unnatural color transformation can be prevented. Thus, the displacements of the highest chroma point in chroma &Dgr;C<highlight><bold>3</bold></highlight> and in lightness &Dgr;L<highlight><bold>3</bold></highlight> are applied for the smaller printer&apos;s color gamut P shape; these displacements are smaller than the displacements &Dgr;C<highlight><bold>2</bold></highlight> and &Dgr;L<highlight><bold>2</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>. </paragraph>
<paragraph id="P-0158" lvl="0"><number>&lsqb;0158&rsqb;</number> Although being smaller than the gamut P<highlight><bold>1</bold></highlight>, the gamut P is still larger than the color gamut (Lab) of display <highlight><bold>18</bold></highlight> in the region around the hue angle of 180&deg; and in a certain lightness range. With regard to the dependence of shift on the hue angles and lightness change, the value ranges of its related coefficients are reduced, though the same tendencies as shown in <cross-reference target="DRAWINGS">FIGS. 9 and 10</cross-reference> are kept. Specifically, the shift coefficient in chroma RC<highlight><bold>2</bold></highlight> (&thgr;) is applied that varies within the range of &ldquo;&thgr;6&lE;&thgr;&lE;&thgr;7&rdquo; (&thgr;<highlight><bold>1</bold></highlight>&lE;&thgr;<highlight><bold>6</bold></highlight>, &thgr;<highlight><bold>7</bold></highlight>&lE;&thgr;<highlight><bold>2</bold></highlight>) as is shown in <cross-reference target="DRAWINGS">FIG. 22</cross-reference>; that is, it is a function that assumes &ldquo;1&rdquo; in a given range of hue angles between &thgr;<highlight><bold>6</bold></highlight> and &thgr;<highlight><bold>7</bold></highlight>. The shift coefficient in lightness RL<highlight><bold>2</bold></highlight> (&thgr;) is applied that varies within the range of &ldquo;&thgr;8&lE;&thgr;&lE;&thgr;9&rdquo; (&thgr;<highlight><bold>1</bold></highlight>&lE;&thgr;<highlight><bold>8</bold></highlight>, &thgr;<highlight><bold>9</bold></highlight>&lE;&thgr;<highlight><bold>3</bold></highlight>) as is shown in <cross-reference target="DRAWINGS">FIG. 23</cross-reference>; that is, it is a function that assumes &ldquo;1&rdquo; in a given range of hue angles between &thgr;<highlight><bold>8</bold></highlight> and &thgr;<highlight><bold>9</bold></highlight>. </paragraph>
<paragraph id="P-0159" lvl="0"><number>&lsqb;0159&rsqb;</number> When creating the LUT <highlight><bold>15</bold></highlight><highlight><italic>d, </italic></highlight>the above-mentioned parameter values different from those used when creating the LUT <highlight><bold>15</bold></highlight><highlight><italic>c </italic></highlight>are used to reduce the displacement by shift and assigned to the equations (1) and (2) when executing the calculation in the step S<highlight><bold>220</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 6</cross-reference>. Thereby, excessive color gamut shift is suppressed and the LUT that can prevent unnatural color transformation can be prepared. For other LUTs, by properly selecting optimum values of parameters for a gamut of the printer&apos;s color gamut, color transformation can be adjusted to small difference in the color gamut shape. In the sense of adjustment to difference in the color gamut shape, color gamut expansion is adjusted in the same manner. In Embodiment 3, it is advisable to properly change the parameter values used in the processing of color gamut expansion as well, adaptively for each gamut of printer&apos;s color gamut. The maximum expansion rate Rm that is a parameter for color gamut expansion is set greater for larger color gamut of printer; that is, Rm<highlight><bold>2</bold></highlight>&gt;Rm<highlight><bold>2</bold></highlight>&gt;Rm<highlight><bold>3</bold></highlight>. With regard to the expansion coefficients &agr;, &bgr;, and rate, their value ranges are set broader for larger color gamut of printer or their values are assigned in the function form so that the value will vary to a greater extent for larger color gamut of printer. </paragraph>
<paragraph id="P-0160" lvl="0"><number>&lsqb;0160&rsqb;</number> FIGS. <highlight><bold>24</bold></highlight> to <highlight><bold>27</bold></highlight> are provided for explaining different parameter values assigned for each color gamut of printer in the processing of color gamut expansion. In Embodiment 3, the maximum expansion rate Rm<highlight><bold>2</bold></highlight> and the expansion coefficients &agr;<highlight><bold>2</bold></highlight>, &bgr;<highlight><bold>2</bold></highlight>, and rate<highlight><bold>2</bold></highlight> are assumed identical to the above-described maximum expansion rate Rm and the expansion coefficients &agr;, &bgr;, and rate shown in FIGS. <highlight><bold>13</bold></highlight> to <highlight><bold>15</bold></highlight>, respectively. Parameter values different from the above ones are given in FIGS. <highlight><bold>24</bold></highlight> to <highlight><bold>27</bold></highlight>, which are used for creating the LUT <highlight><bold>15</bold></highlight><highlight><italic>d </italic></highlight>that is prepared for plain paper. The parameter values shown in FIGS. <highlight><bold>24</bold></highlight> to <highlight><bold>27</bold></highlight> apply to the printer&apos;s color gamut that is smaller than that to which the parameter values shown in FIGS. <highlight><bold>13</bold></highlight> to <highlight><bold>15</bold></highlight> apply. </paragraph>
<paragraph id="P-0161" lvl="0"><number>&lsqb;0161&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 24</cross-reference> shows mapping of the color gamut (Lab) of display <highlight><bold>18</bold></highlight>, the color gamut P of printer <highlight><bold>40</bold></highlight> for the combination of ink set A and plain paper, the gamut (Lab)&prime; shifted by color gamut shift, and the gamut (Lab)&Prime; expanded by color gamut expansion on the plane cut at the hue angle of 180&deg; in the Lab space. Here again, the color gamut P<highlight><bold>1</bold></highlight> drawn with a dotted line is identical to the printer&apos;s color gamut shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference> for the combination of ink set A and paper photo<highlight><bold>2</bold></highlight>. In <cross-reference target="DRAWINGS">FIG. 24</cross-reference>, here again, chroma C is plotted on the abscissa and lightness L is plotted on the ordinate, ranging &ldquo;0&lE;C&lE;100&rdquo; and &ldquo;0&lE;L&lE;100,&rdquo; respectively. </paragraph>
<paragraph id="P-0162" lvl="0"><number>&lsqb;0162&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>, the printer&apos;s color gamut P for the combination of ink set A and plain paper is smaller than that for the combination of ink set A and paper photo <highlight><bold>2</bold></highlight>, but somewhat larger than the color gamut (Lab) of display <highlight><bold>18</bold></highlight> in a certain lightness range. Accordingly, it is advisable to expand the gamut (Lab)&prime; along the chroma axis, but expansion should be adjusted to a smaller extent than expansion applied to the gamut P<highlight><bold>1</bold></highlight>. As the parameter values, the maximum expansion rate Rm<highlight><bold>3</bold></highlight> and the expansion coefficients &agr;<highlight><bold>3</bold></highlight>, &bgr;<highlight><bold>3</bold></highlight>, and rate<highlight><bold>3</bold></highlight> are applied for the smaller printer&apos;s color gamut P shape. The values of Rm<highlight><bold>3</bold></highlight>, &agr;<highlight><bold>3</bold></highlight>, &bgr;<highlight><bold>3</bold></highlight>, and rate<highlight><bold>3</bold></highlight> are set smaller than the maximum expansion rate Rm<highlight><bold>2</bold></highlight> and the expansion coefficients &agr;<highlight><bold>2</bold></highlight>, &bgr;<highlight><bold>2</bold></highlight>, and rate<highlight><bold>2</bold></highlight> and color gamut expansion is executed. </paragraph>
<paragraph id="P-0163" lvl="0"><number>&lsqb;0163&rsqb;</number> With regard to the dependence of these parameters on the hue angles and lightness change, the value ranges of the parameters are reduced or their values are assigned to reduce expansion in the function form, though the same tendencies as shown in FIGS. <highlight><bold>13</bold></highlight> to <highlight><bold>15</bold></highlight> are kept. Specifically, the expansion coefficient &agr;<highlight><bold>3</bold></highlight> varies within the range of &ldquo;&thgr;10&lE;&thgr;&lE;&thgr;11&rdquo; (&thgr;<highlight><bold>4</bold></highlight>&lE;&thgr;<highlight><bold>10</bold></highlight>, &thgr;<highlight><bold>11</bold></highlight>&lE;&thgr;<highlight><bold>5</bold></highlight>) as is shown in <cross-reference target="DRAWINGS">FIG. 25</cross-reference>; that is, it is a function that assumes &ldquo;1&rdquo; in a given range of hue angles between &thgr;<highlight><bold>10</bold></highlight> and &thgr;<highlight><bold>11</bold></highlight>. The expansion coefficient &bgr;<highlight><bold>3</bold></highlight> varies within the range of &ldquo;L1&gt;&thgr;&lE;L2&rdquo; as is shown in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>. As compared with expansion coefficient &bgr; shown in <cross-reference target="DRAWINGS">FIG. 14</cross-reference>, the curve of value change of &bgr;<highlight><bold>3</bold></highlight> as lightness L rises from L<highlight><bold>1</bold></highlight> before &bgr;<highlight><bold>3</bold></highlight> reaches &ldquo;1&rdquo; and the curve as &bgr;<highlight><bold>3</bold></highlight> falls from &ldquo;1&rdquo; to &ldquo;0&rdquo; while lightness L continues to rise are gentler. Moreover, the expansion coefficient rate<highlight><bold>3</bold></highlight> varies within the range of &ldquo;0&lE;L/peak L (&thgr;)&lE;1&rdquo; as is shown in <cross-reference target="DRAWINGS">FIG. 27</cross-reference>. As compared with expansion coefficient rate shown in <cross-reference target="DRAWINGS">FIG. 15</cross-reference>, the curve of value change of rate<highlight><bold>3</bold></highlight> as L/peak L (&thgr;) rises from 0 before rate<highlight><bold>3</bold></highlight> reaches &ldquo;1&rdquo; and the curve as L/peak L (&thgr;) falls from &ldquo;1&rdquo; before rate<highlight><bold>3</bold></highlight> reaches &ldquo;1&rdquo; are gentler. </paragraph>
<paragraph id="P-0164" lvl="0"><number>&lsqb;0164&rsqb;</number> When creating the LUT <highlight><bold>15</bold></highlight><highlight><italic>d, </italic></highlight>the above-mentioned parameter values different from those used when creating the LUT <highlight><bold>15</bold></highlight><highlight><italic>c </italic></highlight>are used to reduce the displacement by expansion and assigned to the equations (3) and (4) when executing the calculation in the step S<highlight><bold>230</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 6</cross-reference>. Thereby, the LUT that prevents over-emphasized chroma of colors can be prepared. For other LUTs, by properly selecting optimum values of parameters for a gamut of the printer&apos;s color gamut, color transformation can be adjusted to small difference in the color gamut shape. Of course, the parameter values shown in <cross-reference target="DRAWINGS">FIG. 20</cross-reference> are exemplary. The parameter values may be set different for all gamuts of printer&apos;s color gamut and common parameter values other than those shown in <cross-reference target="DRAWINGS">FIG. 20</cross-reference> may be applied for different sizes of color gamut. Even if different values are assigned to the displacements of the highest chroma point in chroma &Dgr;C and in lightness &Dgr;L and nearly the same value is assigned directly or in the function form to the shift coefficients in chroma RC (&thgr;) and lightness RL (&thgr;), the maximum expansion rate Rm, and the expansion coefficients &agr;, &bgr;, and rate, very fine colored print results may be produced. By arranging in this way the LUTs <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>to <highlight><bold>15</bold></highlight><highlight><italic>g </italic></highlight>for each gamut of printer&apos; color gamut, the color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>of the PRTDRV<highlight><bold>21</bold></highlight> enables the computer to execute color transformation and print operation so that the most suitable chroma for each combination of ink set and image processing medium will be obtained. </paragraph>
<paragraph id="P-0165" lvl="7"><number>&lsqb;0165&rsqb;</number> (8) Preferred Embodiment 4 </paragraph>
<paragraph id="P-0166" lvl="0"><number>&lsqb;0166&rsqb;</number> While relatively great displacements by shift and expansion are set for larger color gamut of printer in Embodiment 3, it is not always necessary to apply the tendency that displacements increase in proportional to the increase in gamut size to all possible shapes of printer&apos;s color gamut when executing the processing of color gamut shift and color gamut expansion. <cross-reference target="DRAWINGS">FIG. 28</cross-reference> shows a table listing symbolic values of parameters given for each combination of ink set and image processing medium, which are used for color gamut shift and color gamut expansion, according to a preferred Embodiment 4. Most of the parameter values given in <cross-reference target="DRAWINGS">FIG. 28</cross-reference> are the same as given in <cross-reference target="DRAWINGS">FIG. 20</cross-reference>, but some of them are different. Specifically, when creating an LUT <highlight><bold>15</bold></highlight><highlight><italic>c </italic></highlight>for the combination of ink set A and paper photo<highlight><bold>2</bold></highlight>, the displacements of the highest chroma point in chroma &Dgr;C<highlight><bold>2</bold></highlight>&prime; and in lightness &Dgr;L<highlight><bold>2</bold></highlight>&prime; and the maximum expansion rate Rm<highlight><bold>2</bold></highlight>&prime; are used. When creating an LUT <highlight><bold>15</bold></highlight><highlight><italic>f </italic></highlight>for the combination of ink set B and paper photo<highlight><bold>2</bold></highlight>, the displacements of the highest chroma point in chroma &Dgr;C<highlight><bold>5</bold></highlight>&prime; and in lightness &Dgr;L<highlight><bold>5</bold></highlight>&prime; shift and the shift coefficient in chroma RC<highlight><bold>1</bold></highlight> (&thgr;)&prime; are used. </paragraph>
<paragraph id="P-0167" lvl="0"><number>&lsqb;0167&rsqb;</number> Hereon, actual values are assigned, subject to constraints: &Dgr;C<highlight><bold>1</bold></highlight>&lt;&Dgr;C<highlight><bold>2</bold></highlight>&prime;&gt;&Dgr;C<highlight><bold>3</bold></highlight>, &Dgr;L<highlight><bold>1</bold></highlight>&lt;&Dgr;L<highlight><bold>2</bold></highlight>&prime;&gt;&Dgr;L<highlight><bold>3</bold></highlight>, Rm<highlight><bold>1</bold></highlight>&lt;Rm<highlight><bold>2</bold></highlight>&prime;&gt;Rm<highlight><bold>3</bold></highlight>, &Dgr;C<highlight><bold>4</bold></highlight>&lt;&Dgr;C<highlight><bold>5</bold></highlight>&prime;&gt;&Dgr;C<highlight><bold>3</bold></highlight>, and &Dgr;L<highlight><bold>4</bold></highlight>&lt;&Dgr;L<highlight><bold>5</bold></highlight>&prime;&gt;&Dgr;L<highlight><bold>3</bold></highlight>. Besides, the shift coefficient in chroma RC<highlight><bold>1</bold></highlight> (&thgr;)&prime; is a function that gives a greater displacement by shift than the shift coefficient in chroma RC<highlight><bold>1</bold></highlight> (&thgr;) does. In Embodiment 4, for the printer&apos;s color gamut for the combination of ink set A or B and paper photo<highlight><bold>2</bold></highlight>, the displacements by color gamut shift and color gamut expansion are set greater, though its size is smaller than the gamut for paper photo<highlight><bold>1</bold></highlight>. In other words, color gamut shift and color gamut expansion are executed with the set displacements conflicting with the tendency that displacements increase in proportional to increase in gamut size. This is intended to make the printer <highlight><bold>40</bold></highlight> output print results whose color tone will be as uniform as possible with all image processing media used. </paragraph>
<paragraph id="P-0168" lvl="0"><number>&lsqb;0168&rsqb;</number> When the printer <highlight><bold>40</bold></highlight> prints various kinds of images, a printed image usually includes a plurality of colors. The impression of a color that the user perceives somewhat changes by its color relativity to its surrounding color and its vividness is influenced by such relativity. Thus, while generally setting greater displacements by shift and expansion for larger color gamut, it is advisable to adjust the displacements, based on the test print results of various kinds of images output by the printer <highlight><bold>40</bold></highlight>, so that the printer can print more vivid tone images. As the result of such adjustment, even for the medium size color gamut for the combination of ink set A or B and paper photo<highlight><bold>2</bold></highlight>, the displacements by shift and expansion may be set the greatest when creating its LUT as in Embodiment 4. </paragraph>
<paragraph id="P-0169" lvl="0"><number>&lsqb;0169&rsqb;</number> The adjustment of the displacements by shift and expansion, conflicting with the tendency that displacements increase in proportional to increase in gamut size, could be carried out for various intentions in addition to outputting print results whose color tone will be uniform with all image processing media used as described above. For example, if other color processing is performed before or after the processing of color gamut shift and color gamut expansion in accordance with the present invention, it may be required for a specific color gamut of printer that the displacements be corrected in conflict with the above tendency and the above processing of the invention be executed, in order to eventually make correction matching the above tendency as a whole including the processing of the invention. </paragraph>
<paragraph id="P-0170" lvl="7"><number>&lsqb;0170&rsqb;</number> (9) Preferred Embodiment 5 </paragraph>
<paragraph id="P-0171" lvl="0"><number>&lsqb;0171&rsqb;</number> While a plurality of LUTs are created beforehand and arranged for different shapes of printer&apos;s color gamut in Embodiments 3 and 4, it is not always necessary to create a plurality of LUTs beforehand. For example, it is also possible to once create and maintain one LUT or a few LUTs and correct some part of the LUT as required for adaptation for a plurality of shapes of printer&apos;s color gamut. <cross-reference target="DRAWINGS">FIG. 29</cross-reference> shows the simplified structure of the OS and related components wherein a suitable LUT is created as required each time printing is performed so that color transformation suitable for a plurality of shapes of printer&apos;s color gamut will be executed under the PRTDRV <highlight><bold>21</bold></highlight>. </paragraph>
<paragraph id="P-0172" lvl="0"><number>&lsqb;0172&rsqb;</number> In the structure shown in <cross-reference target="DRAWINGS">FIG. 29</cross-reference>, which is nearly the same as that shown in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, the PRTDRV <highlight><bold>21</bold></highlight> includes an LUT correction module <highlight><bold>21</bold></highlight><highlight><italic>f. </italic></highlight>The LUT correction module <highlight><bold>21</bold></highlight><highlight><italic>f </italic></highlight>makes the computer reference the LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>which has previously stored in the disk on the HDD <highlight><bold>15</bold></highlight> and correct the LUT appropriately. In Embodiment 5, the module makes the computer execute correction by increasing or decreasing the chroma and lightness mainly for the data in the lightness range of 0 to 80 and in the region around the hue angle of 180&deg;. In Embodiment 5 also, required information is obtained by receiving the status of printer <highlight><bold>40</bold></highlight> via the parallel communication I/O unit <highlight><bold>19</bold></highlight><highlight><italic>b </italic></highlight>and determining what image processing medium and ink set are in use, based on the print condition setting specified, using a Printer Properties window which is not shown. </paragraph>
<paragraph id="P-0173" lvl="0"><number>&lsqb;0173&rsqb;</number> To execute print operation, the PRTDRV <highlight><bold>21</bold></highlight> follows nearly the same the procedure as shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>, but the LUT correction module <highlight><bold>21</bold></highlight><highlight><italic>f </italic></highlight>applied in Embodiment 5 is activated before the color transformation module is activated in the step S<highlight><bold>110</bold></highlight>. Under the control of the LUT correction module <highlight><bold>21</bold></highlight><highlight><italic>f, </italic></highlight>the LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>is retrieved and corrected, based on the information of the currently used image processing medium and ink set determined as described above. The thus corrected LUT is handed over to the color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>under which color transformation of acquired image data is executed. Then, halftone processing and print data generation are executed, according to the procedure shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference> and eventually printing is performed. </paragraph>
<paragraph id="P-0174" lvl="0"><number>&lsqb;0174&rsqb;</number> In Embodiment 5, accordingly, even if a few LUTs are stored in the disk on the HDD <highlight><bold>15</bold></highlight>, a suitable LUT is created for the currently used image processing medium and ink set on the printer <highlight><bold>40</bold></highlight> and images can be printed in more vivid colors than those presented on the display <highlight><bold>18</bold></highlight>. For the correction method by the LUT correction module <highlight><bold>21</bold></highlight><highlight><italic>f, </italic></highlight>any of diverse methods can be adopted. For example, one method is as follows. The gamut mapping for color transformation is properly displaced in the region around the hue angle of 180&deg; and in the lightness range of 0 to 80, based on the comparison in size between the printer&apos;s color gamut for which the LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>has been created and maintained and the color gamut assumed for the currently used combination of image processing medium and ink set. Another method is as follows. By comparing the reference LUT <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>and another LUT for another printer&apos;s color gamut, color data of difference at sample points is maintained and a new LUT is set by replacing that color data of difference at sample points by newly obtained data. </paragraph>
<paragraph id="P-0175" lvl="7"><number>&lsqb;0175&rsqb;</number> (10) Preferred Embodiment 6 </paragraph>
<paragraph id="P-0176" lvl="0"><number>&lsqb;0176&rsqb;</number> Using LUTs created through the processing of color gamut shift and color gamut expansion in accordance with the present invention is advantageous in that unnatural color transformation is prevented and color gamut can be effectively used. On the other hand, it is advisable to enable the user to choose whether to use LUTs provided in accordance with the present invention to meet the user&apos;s need that may differ, according to circumstances. <cross-reference target="DRAWINGS">FIG. 30</cross-reference> shows the simplified structure of the OS and related components wherein LUTs, some of which have been created through the processing of color gamut shift and color gamut expansion in accordance with the present invention, and some of which have been created without being modified by such processing, are made available under the PRTDRV <highlight><bold>21</bold></highlight>. In the structure shown in <cross-reference target="DRAWINGS">FIG. 30</cross-reference>, which is nearly the same as that shown in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, arrangement is made such that the color transformation module <highlight><bold>12</bold></highlight><highlight><italic>b </italic></highlight>of the PRTDRV <highlight><bold>21</bold></highlight> selectively uses an appropriate LUT out of the LUTs <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>to <highlight><bold>15</bold></highlight><highlight><italic>c, </italic></highlight>according to mode setting specified in advance. </paragraph>
<paragraph id="P-0177" lvl="0"><number>&lsqb;0177&rsqb;</number> The LUTs <highlight><bold>15</bold></highlight><highlight><italic>b </italic></highlight>to <highlight><bold>15</bold></highlight><highlight><italic>n </italic></highlight>includes those defined for each combination of image processing medium and ink set as described above and those created without being modified by color gamut shift and color gamut expansion. Specifically, LUTs for a combination of image processing medium and ink set are classified into an LUT created through color gamut shift, an LUT created through color gamut expansion, an LUT created through color gamut shift and color gamut expansion, and an LUT created without being modified by color gamut shift and color gamut expansion, which are stored in the disk on the HDD <highlight><bold>15</bold></highlight>. </paragraph>
<paragraph id="P-0178" lvl="0"><number>&lsqb;0178&rsqb;</number> Under the control of PRTDRV <highlight><bold>21</bold></highlight>, the computer presents a Printer Properties window <highlight><bold>21</bold></highlight><highlight><italic>g </italic></highlight>on the display <highlight><bold>18</bold></highlight> when executing print operation; an example of this window is shown in <cross-reference target="DRAWINGS">FIG. 31</cross-reference>. The Printer Properties window <highlight><bold>21</bold></highlight><highlight><italic>g </italic></highlight>have entry boxes for start page, end page, the number of copies, and other information required for printing, and the OK button to be used to request print execution, the Cancel button to be used to abort print operation, and the like. Inputs to the Printer Properties window <highlight><bold>21</bold></highlight><highlight><italic>g </italic></highlight>can be performed through the keyboard <highlight><bold>31</bold></highlight> and mouse <highlight><bold>32</bold></highlight>. </paragraph>
<paragraph id="P-0179" lvl="0"><number>&lsqb;0179&rsqb;</number> In Embodiment 6, other information required for printing can be input, using the Printer Properties window <highlight><bold>21</bold></highlight><highlight><italic>g, </italic></highlight>and the PRTDRV<highlight><bold>21</bold></highlight> selects an appropriate LUT, based on the information furnished. Specifically, the Printer Properties window <highlight><bold>21</bold></highlight><highlight><italic>g </italic></highlight>are provided with a paper select box <highlight><bold>21</bold></highlight><highlight><italic>g</italic></highlight><highlight><bold>1</bold></highlight>, mode select radio buttons <highlight><bold>21</bold></highlight><highlight><italic>g</italic></highlight><highlight><bold>2</bold></highlight>, and ink set select radio buttons <highlight><bold>21</bold></highlight><highlight><italic>g</italic></highlight><highlight><bold>3</bold></highlight>. The paper select box <highlight><bold>21</bold></highlight><highlight><italic>g</italic></highlight><highlight><bold>1</bold></highlight> allows the user to select paper to be used on the printer <highlight><bold>40</bold></highlight> from a pull-down menu listing preset kinds of paper. The ink set select radio buttons <highlight><bold>21</bold></highlight><highlight><italic>g</italic></highlight><highlight><bold>3</bold></highlight> allow the user to select an ink set to be used on the printer <highlight><bold>40</bold></highlight> by checking either radio button. </paragraph>
<paragraph id="P-0180" lvl="0"><number>&lsqb;0180&rsqb;</number> The mode select radio buttons <highlight><bold>21</bold></highlight><highlight><italic>g</italic></highlight><highlight><bold>2</bold></highlight> allows the user to choose whether to use LUTs created through color gamut shift and color gamut expansion by checking the radio buttons ON/OFF. Based on user-preference setting, the color transformation module <highlight><bold>21</bold></highlight> of the PRTDRV <highlight><bold>21</bold></highlight> makes the computer extract an LUT suitable for the selected medium, ink set, and processing mode from the HDD <highlight><bold>15</bold></highlight> and execute color transformation. If only the radio button of color gamut shift is set ON, an LUT created through color gamut shift is extracted. If only the radio button of color gamut expansion is set ON, an LUT created through color gamut expansion is extracted. If both radio buttons of color gamut shift and color gamut expansion are set ON, an LUT created through color gamut shift and color gamut expansion is extracted. If both radio buttons of color gamut shift and color gamut expansion are set OFF, an LUT created without being modified by color gamut shift and color gamut expansion is extracted. </paragraph>
<paragraph id="P-0181" lvl="0"><number>&lsqb;0181&rsqb;</number> In this way, in Embodiment 6, whether to use LUTs created through color gamut shift or/and color gamut expansion can be set, according to user preference, and whether to print an image presented on the display <highlight><bold>18</bold></highlight> with chroma emphasized by using LUTs provided in accordance with the present invention can be determined at the discretion of the user. If LUTs have been created without being modified by color gamut shift and color gamut expansion for some purpose, it can be said that Embodiment 6 allows for choice between such purpose and the purpose of the present invention when executing print operation. For example, if LUTs created without being modified by color gamut shift and color gamut expansion are suitable for reproducing colors visible on the display <highlight><bold>18</bold></highlight> as faithfully as possible, Embodiment 6 allows for choice of whether to print in exactly the same colors as visible on the display <highlight><bold>18</bold></highlight>. </paragraph>
<paragraph id="P-0182" lvl="0"><number>&lsqb;0182&rsqb;</number> In Embodiment 6, options may be arranged in different ways. Instead of providing options allowing for choice between LUTs created through color shift gamut and LUTs created through color gamut expansion, it is possible to provide options for choice between LUTs created through both processing and those created being without modified by both. As labels of options for LUTs, instead of the explicit ones shown in <cross-reference target="DRAWINGS">FIG. 31</cross-reference> for choice of color gamut shift and color gamut expansion, a sensuous word may be used that allows the user to appreciate and select a mode. In simpler arrangement of options for LUTs, in the same configuration as shown is <cross-reference target="DRAWINGS">FIG. 31</cross-reference>, for a combination of image processing medium and ink set, LUT created through both color gamut shift and color gamut expansion and LUT created without being modified both processing are stored in the disk on the HDD <highlight><bold>15</bold></highlight>. </paragraph>
<paragraph id="P-0183" lvl="0"><number>&lsqb;0183&rsqb;</number> Under the control of the PRTDRV <highlight><bold>21</bold></highlight>, instead of the Printer Properties window <highlight><bold>21</bold></highlight><highlight><italic>g </italic></highlight>shown in <cross-reference target="DRAWINGS">FIG. 31</cross-reference>, for example, a Printer Properties window <highlight><bold>210</bold></highlight><highlight><italic>g </italic></highlight>which is shown in <cross-reference target="DRAWINGS">FIG. 32</cross-reference> maybe presented. On the Printer Properties window <highlight><bold>210</bold></highlight><highlight><italic>g, </italic></highlight>a mode select checkbox <highlight><bold>21</bold></highlight><highlight><italic>g</italic></highlight><highlight><bold>4</bold></highlight> instead of the radio buttons for mode selection on the window shown in <cross-reference target="DRAWINGS">FIG. 31</cross-reference> is provided for allowing the user to choose whether to apply a vivid mode. When the checkbox is checked, the color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>of the PRTDRV <highlight><bold>21</bold></highlight> makes the computer execute color transformation, using an LUT created through both color gamut shift and color gamut expansion. </paragraph>
<paragraph id="P-0184" lvl="0"><number>&lsqb;0184&rsqb;</number> Accordingly, an image shown on the display <highlight><bold>18</bold></highlight> is printed in colors that are more vivid. When the checkbox is not checked, the color transformation module <highlight><bold>21</bold></highlight><highlight><italic>b </italic></highlight>of the PRTDRV <highlight><bold>21</bold></highlight> makes the computer execute color transformation, using an LUT created without being modified by both color gamut shift and color gamut expansion. If a rather sensuous word is used as the label of a mode, even beginners not having sufficient knowledge could easily carry out printing with an appropriate LUT selected by their preference. </paragraph>
<paragraph id="P-0185" lvl="0"><number>&lsqb;0185&rsqb;</number> As explained above, in accordance with the present invention, color gamut shift is executed to obtain gamut mapping in which the shape of the color gamut of a first image processing device expands so as to be close to the shape of the color gamut of a second image processing device in a homogenous hue range and color gamut expansion is further executed to obtain gamut mapping in which a certain region of the resulting gamut after the color gamut shift further expands into the color gamut of the second image processing device. Based on the relationship between the color gamuts of the first image processing device and the second image processing device defined by the foregoing processing execution, color transformation is executed. In circumstances where a plurality of color gamuts are available on an image processing device are available, gamut mapping relationships between the first and second devices are defined for each gamut, thereby finer adjustment can be performed. Thus, image output in desirable colors can be obtained by making effective use of the color gamuts of the image processing device. </paragraph>
<paragraph id="P-0186" lvl="0"><number>&lsqb;0186&rsqb;</number> The present invention may be embodied in other specific forms without departing from the spirit or essential characteristics thereof. The described embodiments are to be considered in all respects only as illustrated and not restrictive. The scope of the invention is, therefore, indicated by the appended claims rather than by the foregoing description. All changes which come within the meaning and range of equivalency of the claims are to be embraced within the scope of the claims. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">We claim: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. A medium recording a color transformation lookup table to be referenced for transformation of first color image data used on a first image processing device into second color image data used on a second image processing device and to have a first set of values and a second set of values which represent a relationship between color gamuts of the first image processing device and the second image processing device, 
<claim-text>wherein if there exists the region that is out of the color gamut of the first image processing device but falls within the color gamut of the second image processing device in a certain hue of the device-independent color space, said relationship is equivalent to the relationship of color gamut determined, based on gamut mapping in a predefined device-independent color space, through a process comprising: 
<claim-text>a color gamut shift step to obtain the mapping which expands the shape of the color gamut of the first image processing device so as to be close to the shape of the color gamut of the second image processing device in a homogeneous hue range; and </claim-text>
<claim-text>a color gamut expansion step to obtain the mapping which expands a certain region of the resulting gamut processed at said color gamut shift step into the inside of color gamut of the second image processing device. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein: 
<claim-text>said first image processing device is a display and said second image processing device is a printer; and </claim-text>
<claim-text>for transforming the first color image data expressed in an RGB color space into the second color image data expressed in a CMYK color space, said relationship between the color gamuts of those data is defined in the prescribed device-independent color space and is stored in said color transformation lookup table as values for relating a first set of values to a second set of values so as to represent the defined relationship of color gamut. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein: 
<claim-text>said first set of values and second set of values of a color transformation lookup table are defined after increasing or decreasing the number of color components in a color space to which said color gamut belongs. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein: 
<claim-text>said color gamut shift step causes lightness to decrease and chroma to increase based on the coordinates of said device-independent color space; meanwhile said color gamut expansion step causes chroma to increase while keeping lightness nearly constant, based on the coordinates of the gamut processed at the color gamut shift step in said device-independent color space. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein: 
<claim-text>the mapping in said color gamut shift step is obtained in such a manner that the higher the chroma point is in the color gamut of the first image processing device in a certain hue, the greater the displacement by shift is. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein: 
<claim-text>said color gamut shift step varies the displacement by shift according to any of or combination of hue, chroma, and lightness of the color image data which have not processed at said color gamut shift step. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein: 
<claim-text>in said color gamut expansion step, the displacement by expansion of the chroma is set up in such a manner that the higher the chroma is which has not processed at said color gamut expansion step, the greater the displacement by expansion is. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein: 
<claim-text>in said color gamut expansion step, the chroma expansion is not performed on a certain region where the chroma which have not processed at said color gamut expansion step is small. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein: 
<claim-text>said color gamut expansion step causes displacement by expansion to vary according to any of or combination of hue, chroma, and lightness of the color image data which have not processed at said color gamut expansion step. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein: 
<claim-text>a plurality of color gamuts with different shapes is available to any of or combination of the first image processing device and the second image processing device, and said sets of values represent each relationship of color gamuts. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein: 
<claim-text>said relationship in said color transformation lookup table is defined by individual displacement by shift or/and displacement by expansion to be performed for each of the color gamuts in the device-independent color space. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein: 
<claim-text>in said color gamut shift step, the displacement by shift is set up in such a manner that the larger the color gamut of the second image processing device is, the greater the displacement by shift is. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00005">claim 5</dependent-claim-reference>, wherein: 
<claim-text>if the shapes of the gamuts of the second image processing device differs from each other, the displacement by shift of the highest chroma point in the gamut of the first image processing device is varied. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein: 
<claim-text>in said color gamut expansion step, the displacement by expansion is set up in such a manner that the larger the color gamut of the second image processing device is, the greater the displacement by expansion is. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00011">claim 12</dependent-claim-reference>, wherein: 
<claim-text>in said color gamut shift step, the displacement by shift is set up in such a manner that the smaller the exceptional color gamut of the second image processing device is, the greater the displacement by shift is. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00011">claim 10</dependent-claim-reference>, wherein: 
<claim-text>said relationship of gamuts is obtained by correcting the sets of values which are stored in a certain storage area and represent a relationship of the gamut. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein: 
<claim-text>the sets of values which represent the relationship with the application of color gamut shift or/and color gamut expansion and the relationship without the application of color gamut shift or/and color gamut expansion, are made and stored in a certain storage area; and </claim-text>
<claim-text>the relationship is decided based on the mode which is selected in advance by a user. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. A medium recording a color transformation lookup table as recited in <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein: 
<claim-text>when color transformation is executed by referencing to said color transformation lookup table, even if said color gamut shift step or/and said color gamut expansion step have been executed, hue displacement is restricted to 15 degrees or less in L*a*b* space. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. A printing apparatus for performing the steps comprising inputting first color image data for use on a first image processing device, transforming the first color image data into second color image data for use in printing by referencing a color transformation lookup table, and thereby printing, 
<claim-text>wherein said color transformation lookup table having a first set of values and a second set of values which represent a relationship between color gamuts of the first image processing device and the second image processing device, and </claim-text>
<claim-text>if there exists the region that is out of the color gamut of the first image processing device but falls within the color gamut of the second image processing device in a certain hue of the device-independent color space, said relationship is equivalent to the relationship of color gamut determined, based on gamut mapping in a predefined device-independent color space, through a process comprising: 
<claim-text>a color gamut shift step to obtain the mapping which expands the shape of the color gamut of the first image processing device so as to be close to the shape of the color gamut of the second image processing device in a homogeneous hue range; and </claim-text>
<claim-text>a color gamut expansion step to obtain the mapping which expands a certain region of the resulting gamut processed at said color gamut shift step into the inside of color gamut of the second image processing device. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. A printing method comprising inputting first color image data for use on a first image processing device, transforming the first color image data into second color image data for use in printing by referencing a color transformation lookup table, and thereby printing, 
<claim-text>wherein said color transformation lookup table having a first set of values and a second set of values which represent a relationship between color gamuts of the first image processing device and the second image processing device, and </claim-text>
<claim-text>if there exists the region that is out of the color gamut of the first image processing device but falls within the color gamut of the second image processing device in a certain hue of the device-independent color space, said relationship is equivalent to the relationship of color gamut determined, based on gamut mapping in a predefined device-independent color space, through a process comprising 
<claim-text>a color gamut shift step to obtain the mapping which expands the shape of the color gamut of the first image processing device so as to be close to the shape of the color gamut of the second image processing device in a homogeneous hue range; and </claim-text>
<claim-text>a color gamut expansion step to obtain the mapping which expands a certain region of the resulting gamut processed at said color gamut shift step into the inside of color gamut of the second image processing device; and </claim-text>
<claim-text>wherein printing is performed by referencing said color transformation lookup table to transform the first color image data into second color image data. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00021">
<claim-text><highlight><bold>21</bold></highlight>. A medium recording a computer-executable printing program for causing a computer to perform the computer-implemented actions of inputting first color image data for use on a first image processing device, transforming the first color image data into second color image data for use in printing by referencing a color transformation lookup table, and thereby printing, 
<claim-text>wherein said color transformation lookup table having a first set of values and a second set of values which represent a relationship between color gamuts of the first image processing device and the second image processing device, and </claim-text>
<claim-text>if there exists the region that is out of the color gamut of the first image processing device but falls within the color gamut of the second image processing device in a certain hue of the device-independent color space, said relationship is equivalent to the relationship of color gamut determined, based on gamut mapping in a predefined device-independent color space, through a process comprising: 
<claim-text>a color gamut shift step to obtain the mapping which expands the shape of the color gamut of the first image processing device so as to be close to the shape of the color gamut of the second image processing device in a homogeneous hue range; and </claim-text>
<claim-text>a color gamut expansion step to obtain the mapping which expands a certain region of the resulting gamut processed at said color gamut shift step into the inside of color gamut of the second image processing device, and </claim-text>
</claim-text>
<claim-text>wherein said printing program comprising: 
<claim-text>a step of transforming the first color image data into the second color image data by referencing said color transformation lookup table, </claim-text>
<claim-text>a step of transforming the second color image data into print data, and </claim-text>
<claim-text>a step of outputting the print data to a printer, thereby executing printing. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00022">
<claim-text><highlight><bold>22</bold></highlight>. A color transformation apparatus for performing the steps comprising inputting first color image data for use on a first image processing device and transforming the first color image data into second color image data for use on a second image processing device, 
<claim-text>wherein, the color gamut of the first image processing device and the color gamut of the second image processing device can be mapped in a color space where colors can be defined in terms of lightness, chroma, and hue, and at the hue in which a region exists where the color gamut of the second image processing device is wider than the color gamut of the first image processing device in low lightness and high chroma ranges, said color transformation apparatus performs the steps of: 
<claim-text>color gamut shift by which the color gamut of the first image processing device shifts toward lower lightness and higher chroma; </claim-text>
<claim-text>color gamut expansion by which the chroma of the resulting gamut after the color gamut shift rises and the gamut moves toward a region where the gamut of the second image processing device is wider in chroma; </claim-text>
<claim-text>compressing a region that falls out of the color gamut of the second image processing device after the color gamut expansion so that the region will enter the color gamut of the second image processing device; </claim-text>
<claim-text>defining a color transformation table in which color values by the coordinates of the finally obtained gamut are mapped to color values by the coordinates of the original color gamut of the first image processing device; and </claim-text>
<claim-text>transforming the first color image data into the second color image data, based on the color transformation table. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00023">
<claim-text><highlight><bold>23</bold></highlight>. A medium comprising a color transformation program recorded thereon for inputting RGB data for use on a display and transforming the RGB data into CMY data for use on a printer, 
<claim-text>wherein, after mapping the color gamut of the display device and the color gamut of the printer in a color space where colors can be defined in terms of lightness, chroma, and hue, for a sector of hues in which a region exists where the color gamut of the printer device is wider than the color gamut of the display in low lightness and high chroma ranges, said color transformation program causes a computer to perform the computer-implemented actions of: 
<claim-text>color gamut shift by which the color gamut of the display shifts toward lower lightness and higher chroma ranges such that the highest chroma point in the color gamut of the display in a hue will shift by the greatest displacement and the lower the chroma of a point from where to shift, the smaller will be the displacement of the point, wherein the color gamut shift is executed for all hues in said sector so that the farther from the center of the sector, the smaller will be the displacement by shift; </claim-text>
<claim-text>color gamut expansion by which the resulting gamut after the color gamut shift expands toward a higher chroma range such that, in a lightness range in which the chroma of the color gamut of the printer is higher than that of the resulting gamut, the higher the chroma of a point, the greater will be the displacement of the point, wherein the color gamut expansion is executed for all hues in said sector so that the farther from the center of the sector, the smaller will be the displacement by expansion; </claim-text>
<claim-text>compressing a region that falls out of the color gamut of the printer after the color gamut expansion toward the center of the color space, </claim-text>
<claim-text>creating a color transformation table in which color values by the coordinates of the finally obtained gamut are mapped to color values by the coordinates of the original color gamut of the display; </claim-text>
<claim-text>storing in advance the color transformation table into predetermined storage area ; and </claim-text>
<claim-text>transforming the RGB data into the CMY data, based on the color transformation table.</claim-text>
</claim-text>
</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>8</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030001860A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030001860A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030001860A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030001860A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030001860A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030001860A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030001860A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030001860A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030001860A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00009">
<image id="EMI-D00009" file="US20030001860A1-20030102-D00009.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00010">
<image id="EMI-D00010" file="US20030001860A1-20030102-D00010.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00011">
<image id="EMI-D00011" file="US20030001860A1-20030102-D00011.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00012">
<image id="EMI-D00012" file="US20030001860A1-20030102-D00012.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00013">
<image id="EMI-D00013" file="US20030001860A1-20030102-D00013.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00014">
<image id="EMI-D00014" file="US20030001860A1-20030102-D00014.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00015">
<image id="EMI-D00015" file="US20030001860A1-20030102-D00015.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00016">
<image id="EMI-D00016" file="US20030001860A1-20030102-D00016.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00017">
<image id="EMI-D00017" file="US20030001860A1-20030102-D00017.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00018">
<image id="EMI-D00018" file="US20030001860A1-20030102-D00018.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00019">
<image id="EMI-D00019" file="US20030001860A1-20030102-D00019.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00020">
<image id="EMI-D00020" file="US20030001860A1-20030102-D00020.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00021">
<image id="EMI-D00021" file="US20030001860A1-20030102-D00021.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00022">
<image id="EMI-D00022" file="US20030001860A1-20030102-D00022.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00023">
<image id="EMI-D00023" file="US20030001860A1-20030102-D00023.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00024">
<image id="EMI-D00024" file="US20030001860A1-20030102-D00024.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00025">
<image id="EMI-D00025" file="US20030001860A1-20030102-D00025.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00026">
<image id="EMI-D00026" file="US20030001860A1-20030102-D00026.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00027">
<image id="EMI-D00027" file="US20030001860A1-20030102-D00027.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00028">
<image id="EMI-D00028" file="US20030001860A1-20030102-D00028.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00029">
<image id="EMI-D00029" file="US20030001860A1-20030102-D00029.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00030">
<image id="EMI-D00030" file="US20030001860A1-20030102-D00030.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00031">
<image id="EMI-D00031" file="US20030001860A1-20030102-D00031.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00032">
<image id="EMI-D00032" file="US20030001860A1-20030102-D00032.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
