<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030005321A1-20030102-D00000.TIF SYSTEM "US20030005321A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030005321A1-20030102-D00001.TIF SYSTEM "US20030005321A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030005321A1-20030102-D00002.TIF SYSTEM "US20030005321A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030005321A1-20030102-D00003.TIF SYSTEM "US20030005321A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030005321A1-20030102-D00004.TIF SYSTEM "US20030005321A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030005321A1-20030102-D00005.TIF SYSTEM "US20030005321A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030005321A1-20030102-D00006.TIF SYSTEM "US20030005321A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030005321A1-20030102-D00007.TIF SYSTEM "US20030005321A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030005321A1-20030102-D00008.TIF SYSTEM "US20030005321A1-20030102-D00008.TIF" NDATA TIF>
<!ENTITY US20030005321A1-20030102-D00009.TIF SYSTEM "US20030005321A1-20030102-D00009.TIF" NDATA TIF>
<!ENTITY US20030005321A1-20030102-D00010.TIF SYSTEM "US20030005321A1-20030102-D00010.TIF" NDATA TIF>
<!ENTITY US20030005321A1-20030102-D00011.TIF SYSTEM "US20030005321A1-20030102-D00011.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030005321</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10166269</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20020611</filing-date>
</domestic-filing-data>
<foreign-priority-data>
<priority-application-number>
<doc-number>2001-197058</doc-number>
</priority-application-number>
<filing-date>20010628</filing-date>
<country-code>JP</country-code>
</foreign-priority-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>G06F012/14</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>713</class>
<subclass>193000</subclass>
</uspc>
</classification-us-primary>
</classification-us>
<title-of-invention>Information processing device</title-of-invention>
</technical-information>
<inventors>
<first-named-inventor>
<name>
<given-name>Shuzo</given-name>
<family-name>Fujioka</family-name>
</name>
<residence>
<residence-non-us>
<city>Hyogo</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
</inventors>
<correspondence-address>
<name-1>BURNS DOANE SWECKER &amp; MATHIS L L P</name-1>
<name-2></name-2>
<address>
<address-1>POST OFFICE BOX 1404</address-1>
<city>ALEXANDRIA</city>
<state>VA</state>
<postalcode>22313-1404</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">An information processing device is provided with a storage unit for storing key data used to perform encryption processing for data security as well as inversion of the key data, and an encryption processing unit for reading the key data together with the inversion of the key data from the storage unit, and for performing the encryption processing by using the key data read out of the storage unit. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> 1. Field of the Invention </paragraph>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> The present invention relates to an information processing device of contact type, such as a contact IC card, connected to a reader by way of a cable (connector) and an information processing device of contactless type, such as a contactless IC card, connected to a reader by radio. Particularly, it relates to an information processing device having a security function for data security. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> 2. Description of Related Art </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> With the recently-increasing use of data communications, falsification and illegal use of data through the interception of the data being communicated increase. To retain the security of data against such misbehavior, prior art information processing devices have an encryption function. In other words, prior art information processing devices encrypt data to be transmitted by using key data, and decrypt received data by using the key data used for the encryption. In a prior art information processing device having such an encryption function, key data is stored in a nonvolatile memory, and the key data is read out of the nonvolatile memory and data to be transmitted is encrypted according to a sequence of operations as shown in <cross-reference target="DRAWINGS">FIG. 21</cross-reference>. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> In other words, the prior art information processing device, in step ST<highlight><bold>1</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 21</cross-reference>, performs operations by using the key data based on an arithmetic computation program A. The prior art information processing device then, in step ST<highlight><bold>2</bold></highlight>, performs operations by using the same key data based on an arithmetic computation program B. By using execution results obtained by the execution of the arithmetic computation programs A and B using the same key data, the prior art information processing device further, in step ST<highlight><bold>3</bold></highlight>, performs operations according to another arithmetic computation program C. Thus any person, who does not know the key data, cannot intercept encrypted data obtained by the execution of the arithmetic computation programs according to the procedure. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> However, any person who gets the key data can easily intercept the processed, i.e., encrypted data. For example, the key data can be estimated by physically taking the IC chip of the information processing device out of the package and then performing a failure analysis on the IC chip, analyzing timing such as the timing at which the arithmetic computation programs associated with the encryption processing are executed, or monitoring and analyzing the power consumption in the IC chip. Particularly, the power analysis through which the key data can be analyzed based on changes in the power consumption in the IC chip is a threat. When the prior art information processing device reads the key data stored in the nonvolatile memory, the power consumption in the IC chip varies with time according to whether each bit of the key data is &ldquo;1&rdquo; or &ldquo;0&rdquo;. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> Thus, because the power consumption in the IC chip changes depending on the value of the key data when reading the key data for the encryption of data to be transmitted or when an encryption circuit operates, the key data can be estimated with relative ease. Particularly, when processing data according to the sequence of operations as shown in <cross-reference target="DRAWINGS">FIG. 21</cross-reference>, since the arithmetic computation program A and the arithmetic computation program B are always executed in the same order, changes in the power consumption can appear clearly and it is therefore easy to analyze the key data. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> The power analysis is a well-known technique, for example, as disclosed in &ldquo;III.3.3 power analysis&rdquo; of &ldquo;Report of the investigation about the safety of smart cards in 1999&rdquo;, and therefore the explanation of the power analysis will be omitted hereafter. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> Furthermore, in the case of a contactless IC card, since the contactless IC card receives a supply of electric power by radio, changes in the power consumption due to internal operations can easily appear on a power wire (Vcc line). Furthermore, since the contactless IC card uses the AM modulation (ASK modulation) and generates a power supply from a modulated wave at the same time, the modulated wave can also appear on the Vcc line. Therefore, no data is sent and received by such a prior art contactless IC card while encryption is carried out. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> Japanese patent application publications No. 2000-259799, No. 2000-165375, No.2000-78666, No. 11-338347, and No. 6-4407 disclose such prior art information processing devices. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> A problem with prior art information processing devices constructed as above is that because the power consumption in the information processing device changes depending on the value of key data when reading the key data for encryption of data to be transmitted or when an encryption circuit operates, the key data can be estimated with relative ease and therefore any person, who does not know the key data, can intercept encrypted data by analyzing the key data. Particularly, in the case of a contactless IC card, another problem is that since the contactless IC card generates a power supply from a modulated wave at the same time, the modulated wave can also appear on a Vcc line and therefore the key data can be estimated easily. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> The present invention is proposed to solve the above-mentioned problems, and it is therefore an object of the present invention to provide an information processing device in which when reading key data for encryption of data to be transmitted or when an encryption circuit operates, the power consumption in the information processing device does not vary with time depending on the value of the key data, thereby making it difficult for any person who does not know the key data to estimate the key data and hence to intercept encrypted data. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> In accordance with an aspect of the present invention, there is provided an information processing device including an encryption processing circuit for reading key data together with the inversion of the key data from a storage circuit, and for performing encryption processing by using the key data read out of the storage circuit. Consequently, since when reading the key data the inversion of the key data is also read out of the storage circuit, the number of 0s and the number of 1s included in the key data and the inversion of the key data read from the storage circuit become equal to each other. In other words, when reading the key data for encryption of data to be transmitted, the power consumption in the information processing device does not vary with time depending on the value of the key data, but becomes constant during the interval that the key data is being read from the storage circuit. The aspect of the present invention therefore offers an advantage of making it difficult for any person who does not know the key data to estimate the key data through power analysis and hence to intercept encrypted data, thereby providing a high level of security. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> In accordance with a further aspect of the present invention, there is provided an information processing device including a random number generation circuit for generating a random number, and an encryption processing circuit for reading key data from a storage circuit and for performing encryption processing by using the key data read out of the storage circuit while changing a order in which two or more arithmetic computations associated with the encryption processing are performed according to the random number generated by the random number generation circuit. Consequently, since every time the information processing device performs the encryption processing, the information processing device can change the order in which the two or more arithmetic computations are performed according to the random number, the present aspect offers an advantage of making it difficult for any person who does not know the key data to estimate the key data through power analysis and hence to intercept encrypted data. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> In accordance with another aspect of the present invention, there is provided an information processing device including a random number generation circuit for generating a random number, and an encryption processing circuit for reading key data from a storage circuit and for performing encryption processing by using the key data read out of the storage circuit while changing timing at which two or more arithmetic computations associated with the encryption processing are performed according to the random number generated by the random number generation circuit. Consequently, since every time the information processing device performs the encryption processing, the information processing device can change the timing at which the two or more arithmetic computations are performed according to the random number, the present aspect offers an advantage of making it difficult for any person who does not know the key data to estimate the key data through power analysis and hence to intercept encrypted data. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> In accordance with a further aspect of the present invention, there is provided an information processing device including a random number generation circuit for generating a random number, and an encryption processing circuit for sequentially reading a plurality of parts of key data one after another from a storage circuit while determining a part of the key data to be read for the next time according to the random number generated by the random number generation circuit, and for performing encryption processing by using the key data read out of the storage circuit. Consequently, since the information processing device can change the order in which all the parts of the key data are read on a one-by-one basis according to the generated random number, the present aspect offers an advantage of making it difficult for any person to estimate the key data and hence to intercept encrypted data even though he or she gets the value of each part of the key data because he or she cannot get the order in which all the parts of the key data have been read on a one-by-one basis. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> In accordance with another aspect of the present invention, there is provided an information processing device including an encryption processing circuit for reading key data from a storage circuit and for performing encryption processing by using the key data read out of the storage circuit, an arithmetic computation circuit for performing specific arithmetic computations associated with the encryption processing performed by the encryption processing circuit, a first clock generation circuit for supplying a clock to the arithmetic computation circuit, and a second clock generation circuit for supplying another clock different from the clock generated by the first clock generation circuit to the encryption processing circuit. Consequently, the present aspect offers an advantage of making it difficult to analyze the operating electric power consumed within the information processing device and therefore making it more difficult for any person to estimate the key data. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> In accordance with another aspect of the present invention, there is provided an information processing device that sends and receives data to and from a reader, the device including an encryption processing circuit for reading key data from a storage circuit and for performing encryption processing by using the key data read out of the storage circuit, and a transmission circuit for transmitting a random number generated by a random number generation circuit to the reader while the encryption processing circuit performs the encryption processing by using the key data. Consequently, since the contactless information processing device can cause a random noise in a power supply line, the present aspect offers an advantage of making it more difficult to estimate the key data through power analysis. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> In accordance with another aspect of the present invention, there is provided an information processing device including an encryption processing circuit for reading the key data from the storage circuit and for performing the encryption processing by using the key data read out of the storage circuit, and a noise superimposing circuit for superimposing a noise on a power supply line according to a random number generated by a random number generation circuit. Consequently, since the information processing device can superimpose the noise whose level changes at random according to the random number on the power supply line and hence can change the power consumption, the present aspect offers an advantage of making it difficult to estimate the key data through power analysis. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> Further objects and advantages of the present invention will be apparent from the following description of the preferred embodiments of the invention as illustrated in the accompanying drawings.</paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a block diagram showing the structure of an information processing device according to a first embodiment of the present invention; </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2A</cross-reference> is a diagram showing a 1-word part of key data used for arithmetic computations associated with encryption processing which are performed by an encryption circuit of the information processing device according to the first embodiment; </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2B</cross-reference> is a diagram showing storage of the 1-word part of the key data in an E2PROM of the information processing device according to the first embodiment; </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3A</cross-reference> is a schematic circuit diagram showing the structure of an example of each 1-word unit of a read circuit for use in the E2PROM; </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3B</cross-reference> is a diagram showing an operation of each 1-bit part of each 1-word unit of the read circuit when reading a bit of the key data set to &ldquo;1&rdquo;; </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3C</cross-reference> is a diagram showing an operation of each 1-bit part of each 1-word unit of the read circuit when reading a bit of the key data set to &ldquo;0&rdquo;; </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a block diagram showing the structure of an information processing device according to a second embodiment of the present invention; </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is a flow chart showing the operation of the information processing device according to the second embodiment; </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a flow chart showing the operation of an information processing device according to a third embodiment of the present invention; </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7A</cross-reference> is a drawing showing an example of generation of dummy key data according to the third embodiment; </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7B</cross-reference> is a drawing showing another example of generation of dummy key data according to the third embodiment; </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a drawing showing setting of key data to an encryption circuit of an information processing device according to a fourth embodiment of the present invention; </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a flow chart showing the setting of the key data to the encryption circuit of the information processing device according to the fourth embodiment; </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a block diagram showing a supply of clocks to an encryption circuit and a CPU of an information processing device according to a fifth embodiment of the present invention; </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is a block diagram showing selection of two clocks as the clocks supplied to the encryption circuit and the CPU according to a variant of the fifth embodiment; </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a drawing showing the structure of an example of a first clock circuit for use in an information processing device according to a sixth embodiment of the present invention; </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is a drawing showing the structure of another example of the first clock circuit for use in the information processing device according to the sixth embodiment of the present invention; </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 14</cross-reference> is a block diagram showing the structure of a contactless information processing device according to a seventh embodiment of the present invention; </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 15</cross-reference> is a timing chart showing data transfer between the contactless information processing device according to the seventh embodiment of the present invention and a reader; </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 16</cross-reference> is a drawing showing the structure of a response frame which is transmitted to the reader by the contactless information processing device according to the seventh embodiment; </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 17</cross-reference> is a block diagram showing an example of a noise generation circuit for use in an information processing device according to an eighth embodiment of the present invention; </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 18</cross-reference> is a block diagram showing another example of the noise generation circuit of the information processing device according to the eighth embodiment; </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 19</cross-reference> is a block diagram showing the structure of an encryption circuit for use in an information processing device according to a ninth embodiment of the present invention; </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 20</cross-reference> is a schematic circuit diagram showing a pair of lines via which data and inversion of the data are transmitted in the encryption circuit for use in the information processing device according to the ninth embodiment; and </paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 21</cross-reference> is a flow chart showing the operation of a prior art information processing device.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS </heading>
</section>
<section>
<heading lvl="1">Embodiment 1 </heading>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a block diagram showing an information processing device according to a first embodiment of the present invention, which can be a contact integrated circuit (or IC) card having a built-in security function. In the figure, reference numeral <highlight><bold>1</bold></highlight> denotes a CPU for controlling the whole of the microcomputer, such as a contact IC card or the like, and for executing an encryption processing program, reference numeral <highlight><bold>2</bold></highlight> denotes a ROM for storing the encryption processing program to be executed by the CPU <highlight><bold>1</bold></highlight>, reference numeral <highlight><bold>3</bold></highlight> denotes a RAM in which data to be processed by the CPU <highlight><bold>1</bold></highlight> is written, reference numeral <highlight><bold>4</bold></highlight> denotes a nonvolatile memory (E2PROM) disposed for holding key data for data security, reference numeral <highlight><bold>5</bold></highlight> denotes an encryption circuit for performing specific arithmetic computations associated with the encryption processing by using the key data stored in the nonvolatile memory <highlight><bold>4</bold></highlight>, reference numeral <highlight><bold>6</bold></highlight> denotes an interface between input data input to the contact IC card and output data output from the contact IC card. The CPU <highlight><bold>1</bold></highlight>, the ROM <highlight><bold>2</bold></highlight>, the RAM <highlight><bold>3</bold></highlight>, the E2PROM <highlight><bold>4</bold></highlight>, the encryption circuit <highlight><bold>5</bold></highlight>, and the interface <highlight><bold>6</bold></highlight> are connected to one another by way of a bus. </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2A</cross-reference> shows a 1-word part of the key data used in arithmetic computations associated with the encryption processing which are performed by the encryption circuit <highlight><bold>5</bold></highlight>, and <cross-reference target="DRAWINGS">FIG. 2B</cross-reference> shows storage of the part of the key data in the E2PROM <highlight><bold>4</bold></highlight>. In <cross-reference target="DRAWINGS">FIGS. 2A and 2B</cross-reference>, one word (a data unit in which the CPU <highlight><bold>1</bold></highlight> reads the key data from the E2PROM <highlight><bold>4</bold></highlight>) is 16-bit data. As shown in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>B, the first half of &frac12; words of the part of the key data as shown in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>A and dummy data which is the inversion of the first half of the part of the key data are stored in a word of the E2PROM <highlight><bold>4</bold></highlight>, and the second half of &frac12; words of the part of the key data as shown in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>A and the dummy data which is the inversion of the second half of the part of the key data are stored in another word adjacent to the word of the E2PROM <highlight><bold>4</bold></highlight> in which the first half of &frac12; words of the part of the key data and the first half of the corresponding dummy data are stored. Thus, part of the key data and corresponding part of the dummy data are stored in groups of 8 bits in each word (16 bits) of the E2PROM <highlight><bold>4</bold></highlight>. </paragraph>
<paragraph id="P-0048" lvl="0"><number>&lsqb;0048&rsqb;</number> One half of each 1-word part of the key data and a corresponding part of the dummy data which is the inversion of the one half of each part of the key word are read from each word of the E2PROM <highlight><bold>4</bold></highlight>, and they are sent to the encryption circuit <highlight><bold>5</bold></highlight>. The encryption circuit <highlight><bold>5</bold></highlight> then performs arithmetic computations associated with the encryption processing using the key data. <cross-reference target="DRAWINGS">FIG. 3A</cross-reference> is a schematic circuit diagram showing the structure of an example of each 1-word unit of a read circuit for use in the E2PROM <highlight><bold>4</bold></highlight>, <cross-reference target="DRAWINGS">FIG. 3B</cross-reference> shows an operation of each 1-bit part of each 1-word unit of the read circuit when reading a bit of the key data set to &ldquo;1&rdquo;, and <cross-reference target="DRAWINGS">FIG. 3C</cross-reference> shows an operation of each 1-bit part of each 1-word unit of the read circuit when reading a bit of the key data set to &ldquo;0&rdquo;. In other words, an electric current flows to a 1-bit storage element as shown in <cross-reference target="DRAWINGS">FIG. 3B</cross-reference> when binary data &ldquo;1&rdquo; is input to a selection terminal, whereas no electric current flows to the storage element as shown in <cross-reference target="DRAWINGS">FIG. 3C</cross-reference> when binary data &ldquo;0&rdquo; is input to the selection terminal. When one half of each 1-word part of the key data and one half of a corresponding part of the dummy data which is the inversion of the one half of each part of the key word are read from each word of the E2PROM <highlight><bold>4</bold></highlight>, the number of 1s and the number of 0s included in them read out of the E2PROM <highlight><bold>4</bold></highlight> are both 8. In other words, the number of 0s and the number of 1s included in one half of each part of the key data and one half of a corresponding part of the dummy data read from the E2PROM <highlight><bold>4</bold></highlight> are equal. Therefore, when the key data is read out of the E2PROM in word units, the number of bits in each word of the key data which cause an electric current to flow through the read circuit becomes equal to the number of bits in each word of the key data which do not cause an electric current to flow through the read circuit, and hence the power consumption becomes constant during the interval that the key data is being read from the E2PROM. </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> Thus, since the information processing device according to the first embodiment of the present invention simply writes dummy data each bit of which is the inversion of a corresponding bit of the key data in the E2PROM <highlight><bold>4</bold></highlight> as well as the key data, and reads one half of each word of the key data and one half of a corresponding word of the dummy data which is the inversion of the one half of each word of the key word from each word of the E2PROM <highlight><bold>4</bold></highlight> in which the key word and the dummy data are stored when performing the encryption processing using the key data, the information processing device according to the first embodiment of the present invention can use the architecture of the E2PROM for use in prior art information processing devices without changing the architecture of the E2PROM. </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> As mentioned above, in accordance with the first embodiment of the present invention, since the information processing device writes dummy data each bit of which is the inversion of a corresponding bit of the key data in the E2PROM <highlight><bold>4</bold></highlight> as well as the key data, the number of 0s and the number of 1s included in one half of each word of the key data and one half of a corresponding part of the dummy data read from the E2PROM <highlight><bold>4</bold></highlight> become equal to each other when reading the key data from the E2PROM <highlight><bold>4</bold></highlight>. Consequently, when reading the key data for encryption of data to be transmitted or when the encryption circuit operates, the power consumption in the information processing device does not vary with time depending on the value of the key data, but becomes constant during the interval that the key data is being read from the E2PROM. </paragraph>
</section>
<section>
<heading lvl="1">Embodiment 2 </heading>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a block diagram showing an information processing device according to a second embodiment of the present invention. A contact IC card having a built-in security function is illustrated as an example of the information processing device in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>. In the figure, reference numeral <highlight><bold>1</bold></highlight> denotes a CPU, reference numeral <highlight><bold>2</bold></highlight> denotes a ROM, reference numeral <highlight><bold>3</bold></highlight> denotes a RAM, reference numeral <highlight><bold>4</bold></highlight> denotes an E2PROM, reference numeral <highlight><bold>5</bold></highlight> denotes an encryption circuit, and reference numeral <highlight><bold>6</bold></highlight> denotes an interface. These components correspond to those shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference> which are designated by the same reference numerals and therefore the detailed explanation of those components will be omitted hereafter. Furthermore, reference numeral <highlight><bold>7</bold></highlight> denotes a random number generation circuit for generating a random number before the encryption circuit <highlight><bold>5</bold></highlight> performs arithmetic computations associated with encryption processing. </paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is a flow chart showing the operation of the information processing device according to the second embodiment of the present invention. First, the CPU <highlight><bold>1</bold></highlight>, in step ST<highlight><bold>10</bold></highlight>, generates a random number &ldquo;1&rdquo; or &ldquo;0&rdquo; by means of the random number generation circuit <highlight><bold>7</bold></highlight> before executing an encryption processing program containing arithmetic computation programs A, B, and C, as shown in <cross-reference target="DRAWINGS">FIG. 5</cross-reference>. The CPU <highlight><bold>1</bold></highlight> then, in step ST<highlight><bold>11</bold></highlight>, determines whether the generated random number is &ldquo;1&rdquo; or &ldquo;0&rdquo;. If the generated random number is &ldquo;1&rdquo;, the CPU <highlight><bold>1</bold></highlight> advances to step ST<highlight><bold>12</bold></highlight> wherein it performs arithmetic computations based on the arithmetic computation program A by using key data stored in the E2PROM <highlight><bold>4</bold></highlight> by means of the encryption circuit <highlight><bold>5</bold></highlight>. The CPU <highlight><bold>1</bold></highlight> then, in step ST<highlight><bold>13</bold></highlight>, performs arithmetic computations based on the arithmetic computation program B by using the key data by means of the encryption circuit <highlight><bold>5</bold></highlight>. The CPU<highlight><bold>1</bold></highlight> further, in step ST<highlight><bold>14</bold></highlight>, performs arithmetic computations based on the arithmetic computation program C by using execution results obtained by the sequential execution of the arithmetic computation programs A and B using the same key data by means of the encryption circuit <highlight><bold>5</bold></highlight>. </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> In contrast, if it is determined in step ST<highlight><bold>11</bold></highlight> that the random number generated by the random number generation circuit <highlight><bold>7</bold></highlight> is &ldquo;0&rdquo;, the CPU <highlight><bold>1</bold></highlight> advances to step ST<highlight><bold>15</bold></highlight> wherein it performs arithmetic computations based on the arithmetic computation program B by using the key data stored in the E2PROM <highlight><bold>4</bold></highlight> by means of the encryption circuit <highlight><bold>5</bold></highlight>. The CPU <highlight><bold>1</bold></highlight> then, in step ST<highlight><bold>16</bold></highlight>, performs arithmetic computations based on the arithmetic computation program A by using the key data by means of the encryption circuit <highlight><bold>5</bold></highlight>. The CPU<highlight><bold>1</bold></highlight> further, in step ST<highlight><bold>14</bold></highlight>, performs arithmetic computations based on the arithmetic computation program C by using execution results obtained by the sequential execution of the arithmetic computation programs B and A using the same key data by means of the encryption circuit <highlight><bold>5</bold></highlight>. In this case, because the arithmetic computation program C uses the computation results from the arithmetic computation programs A and B, the arithmetic computation program C cannot perform arithmetic computations prior to the execution of the arithmetic computation programs A and B. In other words, as long as the execution of the arithmetic computation programs A and B is completed, the CPU can perform the encryption processing properly even if the sequence of the execution of the arithmetic computation programs A and B is changed. </paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> In the second embodiment of the present invention, every time the CPU <highlight><bold>1</bold></highlight> starts the execution of the encryption processing program, the CPU <highlight><bold>1</bold></highlight> thus generates a random number by means of the random number generation circuit <highlight><bold>7</bold></highlight> and changes the order in which the arithmetic computation programs A and B are executed according to the random number. Therefore, even if any person tries to monitor a Vcc line disposed as power supply wire many times so as to estimate the key data through power analysis, he or she will understand that it is difficult to perform the power analysis because the sequence of the execution of the arithmetic computation programs A and B is changed and hence the power consumption changes every time the Vcc line is monitored. </paragraph>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> Another encryption circuit disposed independently of the encryption circuit <highlight><bold>5</bold></highlight> can perform arithmetic computations concurrently while the CPU <highlight><bold>1</bold></highlight> is executing an arithmetic computation program. For example, the other encryption circuit can perform an encryption operation using dummy public-key data concurrently while the encryption circuit <highlight><bold>5</bold></highlight> performs an encryption operation using common-key data. The other encryption circuit can also perform an encryption operation using dummy common-key data concurrently while the encryption circuit <highlight><bold>5</bold></highlight> performs an encryption operation using public-key data. In general, an LSI (information processing device) having a security function has both the encryption circuits. </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> As mentioned above, in accordance with the second embodiment of the present invention, every time the information processing device executes the encryption processing program the information processing device generates a random number and changes the order in which the arithmetic computation programs A and B are executed according to the random number. Consequently, the second embodiment offers an advantage of making it difficult for any person who does not know the key data to estimate the key data through power analysis so as to intercept encrypted data. </paragraph>
</section>
<section>
<heading lvl="1">Embodiment 3 </heading>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a flow chart showing the operation of an information processing device according to a third embodiment of the present invention. Although the information processing device according to the third embodiment includes a structure similar to that of the information processing device according to the second embodiment as shown in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>, the information processing device according to the third embodiment differs from that of the above-mentioned second embodiment in that a random number generation circuit <highlight><bold>7</bold></highlight> generates a random number having an integer value ranging from &ldquo;0&rdquo; to &ldquo;3&rdquo;, a CPU <highlight><bold>1</bold></highlight> changes the timing at which it executes arithmetic computation programs A and B by using true key data stored in an E2PROM <highlight><bold>4</bold></highlight> according to the random number generated by the random number generation circuit <highlight><bold>7</bold></highlight>, and the E2PROM <highlight><bold>4</bold></highlight> holds a plurality of dummy key data as well as the key data. </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> In operation, the CPU <highlight><bold>1</bold></highlight>, in step ST<highlight><bold>20</bold></highlight>, generates a random number having an integer value ranging from &ldquo;0&rdquo; to &ldquo;3&rdquo; by means of the random number generation circuit <highlight><bold>7</bold></highlight>. <cross-reference target="DRAWINGS">FIGS. 7A and 7B</cross-reference> are drawings for showing two methods of generating one dummy key data according to the random number having an integer value ranging from &ldquo;0&rdquo; to &ldquo;3&rdquo;, respectively. One of the two methods comprises the step of selecting a dummy key set from among four dummy key sets {circumflex over (1)} to {circumflex over (4)} which correspond to the four integer values &ldquo;0&rdquo; to &ldquo;3&rdquo;, respectively, and which are stored in the E2PROM <highlight><bold>4</bold></highlight>, as shown in <cross-reference target="DRAWINGS">FIG. 7</cross-reference>A, according to the random number generated by the random number generation circuit <highlight><bold>7</bold></highlight>. Furthermore, the other method, as shown in <cross-reference target="DRAWINGS">FIG. 7</cross-reference>B, comprises the steps of storing a data string in a readable area of the E2PROM <highlight><bold>4</bold></highlight>, generating a starting address of data to be read out of the E2PROM <highlight><bold>4</bold></highlight> using the random number generated by the random number generation circuit <highlight><bold>7</bold></highlight>, reading a necessary amount of data from a location of the E2PROM <highlight><bold>4</bold></highlight> specified by the starting address, and using the read data as the dummy key data. </paragraph>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> The CPU <highlight><bold>1</bold></highlight> then, in step ST<highlight><bold>21</bold></highlight>, determines if the generated random number is &ldquo;0&rdquo;, &ldquo;1&rdquo;, &ldquo;2&rdquo;, or &ldquo;3&rdquo;. If the random number generated by the random number generation circuit <highlight><bold>7</bold></highlight> is &ldquo;0&rdquo;, the CPU <highlight><bold>1</bold></highlight> advances to step ST<highlight><bold>22</bold></highlight> in which it performs arithmetic computations based on the arithmetic computation program A by using the true key data stored in the E2PROM <highlight><bold>4</bold></highlight> by means of an encryption circuit <highlight><bold>5</bold></highlight>. The CPU <highlight><bold>1</bold></highlight> then, in step ST<highlight><bold>23</bold></highlight>, performs arithmetic computations based on the arithmetic computation program B by using the same key data by means of the encryption circuit <highlight><bold>5</bold></highlight>. After that, the CPU <highlight><bold>1</bold></highlight> advances to step ST<highlight><bold>24</bold></highlight> in which it selects the first dummy key set {circumflex over (1)} corresponding to the random number &ldquo;0&rdquo; from the E2PROM <highlight><bold>4</bold></highlight> and performs arithmetic computations based on a dummy arithmetic computation program by using the dummy key set {circumflex over (1)} by means of the encryption circuit <highlight><bold>5</bold></highlight>. The CPU <highlight><bold>1</bold></highlight> then, in step ST<highlight><bold>25</bold></highlight>, performs arithmetic computations based on an arithmetic computation program C by using execution results obtained from the sequential execution of the arithmetic computation programs A and B using the true key data by means of the encryption circuit <highlight><bold>5</bold></highlight>. </paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> If the random number generated by the random number generation circuit <highlight><bold>7</bold></highlight> is &ldquo;1&rdquo;, the CPU <highlight><bold>1</bold></highlight> advances to step ST<highlight><bold>26</bold></highlight> in which it performs arithmetic computations based on the arithmetic computation program A by using the true key data stored in the E2PROM <highlight><bold>4</bold></highlight> by means of the encryption circuit <highlight><bold>5</bold></highlight>. Next, the CPU <highlight><bold>1</bold></highlight>, in step ST<highlight><bold>27</bold></highlight>, selects the second dummy key set {circumflex over (2)} corresponding to the random number &ldquo;1&rdquo; from the E2PROM <highlight><bold>4</bold></highlight> and performs arithmetic computations based on the dummy arithmetic computation program by using the dummy key set {circumflex over (2)} by means of the encryption circuit <highlight><bold>5</bold></highlight>. The CPU <highlight><bold>1</bold></highlight> then advances to step ST<highlight><bold>28</bold></highlight> in which it performs arithmetic computations based on the arithmetic computation program B by using the true key data stored in the E2PROM <highlight><bold>4</bold></highlight>. The CPU <highlight><bold>1</bold></highlight> further, in step ST<highlight><bold>25</bold></highlight>, performs arithmetic computations based on the arithmetic computation program C by using execution results obtained from the sequential execution of the arithmetic computation programs A and B using the true key data by means of the encryption circuit <highlight><bold>5</bold></highlight>. In this case, as compared with the case of the random number&equals;0, the time at which the arithmetic computation program B is executed is changed by the execution in step ST<highlight><bold>27</bold></highlight> of the dummy arithmetic computation program using the second dummy key data. </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> If the random number generated by the random number generation circuit <highlight><bold>7</bold></highlight> is &ldquo;2&rdquo;, the CPU <highlight><bold>1</bold></highlight> advances to step ST<highlight><bold>29</bold></highlight> in which it selects the third dummy key set {circumflex over (3)} corresponding to the random number &ldquo;2&rdquo; from the E2PROM <highlight><bold>4</bold></highlight> and performs arithmetic computations based on the dummy arithmetic computation program by using the dummy key set {circumflex over (3)} by means of the encryption circuit <highlight><bold>5</bold></highlight>. The CPU <highlight><bold>1</bold></highlight> then, in step ST<highlight><bold>30</bold></highlight>, performs arithmetic computations based on the arithmetic computation program A by using the true key data stored in the E2PROM <highlight><bold>4</bold></highlight> by means of the encryption circuit <highlight><bold>5</bold></highlight>. After that, the CPU <highlight><bold>1</bold></highlight> advances to step ST<highlight><bold>31</bold></highlight> in which it performs arithmetic computations based on the arithmetic computation program B by using the true key data stored in the E2PROM <highlight><bold>4</bold></highlight> by means of the encryption circuit <highlight><bold>5</bold></highlight>. The CPU <highlight><bold>1</bold></highlight> further, in step ST<highlight><bold>25</bold></highlight>, performs arithmetic computations based on the arithmetic computation program C by using execution results obtained from the sequential execution of the arithmetic computation programs A and B using the true key data by means of the encryption circuit <highlight><bold>5</bold></highlight>. In this case, as compared with the case of the random number&equals;0, the timing at which the arithmetic computation programs A and B are executed are changed by the execution in step ST<highlight><bold>29</bold></highlight> of the dummy arithmetic computation program using the third dummy key data. </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> If the random number generated by the random number generation circuit <highlight><bold>7</bold></highlight> is &ldquo;3&rdquo;, the CPU <highlight><bold>1</bold></highlight> advances to step ST<highlight><bold>32</bold></highlight> in which it selects the fourth dummy key set {circumflex over (4)} corresponding to the random number &ldquo;3&rdquo; from the E2PROM <highlight><bold>4</bold></highlight> and performs arithmetic computations based on the dummy arithmetic computation program by using the dummy key set {circumflex over (4)} by means of the encryption circuit <highlight><bold>5</bold></highlight>. The CPU <highlight><bold>1</bold></highlight> then, in step ST<highlight><bold>33</bold></highlight>, performs arithmetic computations based on the arithmetic computation program A by using the true key data stored in the E2PROM <highlight><bold>4</bold></highlight> by means of the encryption circuit <highlight><bold>5</bold></highlight>. After that, the CPU <highlight><bold>1</bold></highlight>, in step ST<highlight><bold>34</bold></highlight>, performs arithmetic computations based on the dummy arithmetic computation program by using the fourth dummy key set {circumflex over (4)} stored in the E2PROM <highlight><bold>4</bold></highlight> by means of the encryption circuit <highlight><bold>5</bold></highlight>. The CPU <highlight><bold>1</bold></highlight> then advances to step ST<highlight><bold>35</bold></highlight> in which it performs arithmetic computations based on the arithmetic computation program B by using the true key data stored in the E2PROM <highlight><bold>4</bold></highlight> by means of the encryption circuit <highlight><bold>5</bold></highlight>. The CPU <highlight><bold>1</bold></highlight> further, in step ST<highlight><bold>25</bold></highlight>, performs arithmetic computations based on the arithmetic computation program C by using execution results obtained from the sequential execution of the arithmetic computation programs A and B using the true key data by means of the encryption circuit <highlight><bold>5</bold></highlight>. In this case, as compared with the case of the random number&equals;0, the timing at which the arithmetic computation programs A and B are executed are changed by the execution in steps ST<highlight><bold>32</bold></highlight> and ST<highlight><bold>34</bold></highlight> of the dummy arithmetic computation program using the fourth dummy key data. </paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> Even in the third embodiment of the present invention, another encryption circuit disposed independently of the encryption circuit <highlight><bold>5</bold></highlight> performs encryption processing concurrently while the CPU <highlight><bold>1</bold></highlight> is executing one arithmetic computation program. For example, the other encryption circuit can perform an encryption operation using dummy public-key data concurrently while the encryption circuit <highlight><bold>5</bold></highlight> performs an encryption operation using common-key data. The other encryption circuit can also perform an encryption operation using dummy common-key data concurrently while the encryption circuit <highlight><bold>5</bold></highlight> performs an encryption operation using public-key data. In general, an LSI (information processing device) having a security function has both the encryption processing circuits. </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> As mentioned above, in accordance with the third embodiment of the present invention, since every time the CPU performs the encryption processing, the timing at which the arithmetic computation programs A and B are executed and power consumption may be monitored can be changed according to the generated random number, the third embodiment offers an advantage of making it difficult for any person who does not know the key data to perform power analysis so as to intercept encrypted data. </paragraph>
</section>
<section>
<heading lvl="1">Embodiment 4 </heading>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a drawing showing setting of key data to an encryption circuit of an information processing device according to a fourth embodiment of the present invention. In the figure, reference numeral <highlight><bold>41</bold></highlight> denotes a key data area of an E2PROM <highlight><bold>4</bold></highlight> in which the key data used for encryption processing is stored, and reference numeral <highlight><bold>51</bold></highlight> denotes a register to which the key data stored in the key data area <highlight><bold>41</bold></highlight> is set from the E2PROM <highlight><bold>4</bold></highlight>. The encryption circuit <highlight><bold>5</bold></highlight> performs arithmetic computations associated with the encryption processing based on an arithmetic computation program by using the key data set to the register <highlight><bold>51</bold></highlight>. </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> It is necessary to set the key data from the E2PROM <highlight><bold>4</bold></highlight> to the register <highlight><bold>51</bold></highlight> of the encryption circuit <highlight><bold>5</bold></highlight> before the encryption circuit <highlight><bold>5</bold></highlight> performs arithmetic computations associated with the encryption processing. In this case, if a plurality of bytes of the key data are read on a byte-by-byte basis from the E2PROM <highlight><bold>4</bold></highlight> in the same order every time the key data is set to the register <highlight><bold>51</bold></highlight>, the key data can be easily estimated. Therefore, the information processing device according to the fourth embodiment of the present invention changes the order in which the plurality of bytes of the key data are read on a byte-by-byte basis from the E2PROM <highlight><bold>4</bold></highlight> every time the key data is set to the register <highlight><bold>51</bold></highlight>, thereby making it difficult to estimate the key data. <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a flow chart showing a procedure of changing the order in which the plurality of bytes of the key data are read on a byte-by-byte basis from the E2PROM <highlight><bold>4</bold></highlight> every time the key data is set to the register <highlight><bold>51</bold></highlight> of the encryption circuit <highlight><bold>5</bold></highlight> in the case that the key data is 8-byte data. </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> First, a counter for counting the number of bytes of the key data is set at N&equals;8 in step ST<highlight><bold>50</bold></highlight>. The CPU then advances to step ST<highlight><bold>51</bold></highlight> in which it generates a random number having an integer value ranging from 1 to 8 by means of a random number generation circuit <highlight><bold>7</bold></highlight>. The CPU then, in step ST<highlight><bold>52</bold></highlight>, reads 1 byte of the key data corresponding to the random number generated by the random number generation circuit <highlight><bold>7</bold></highlight> from the key data area <highlight><bold>41</bold></highlight> of the E2PROM <highlight><bold>4</bold></highlight>, and sets the byte to the register <highlight><bold>51</bold></highlight> of the encryption circuit <highlight><bold>5</bold></highlight>. In this case, the CPU selects 1 byte of the key data other than one or more bytes of the key data, which have already been set to the register <highlight><bold>51</bold></highlight>, according to the random number, and sets the selected 1 byte of the key data to the register <highlight><bold>51</bold></highlight> of the encryption circuit <highlight><bold>5</bold></highlight>. Then the count value of the counter is decremented by one in step ST<highlight><bold>53</bold></highlight>, and the above-mentioned processes are repeated in step ST<highlight><bold>54</bold></highlight> until the setting of all the 8 bytes of the key data to the register is completed. </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> As mentioned above, in accordance with the fourth embodiment of the present invention, the order in which all the bytes of the key data are read on a byte-by-byte basis is changed according to the generated random number. The fourth embodiment offers an advantage of making it difficult for any person to estimate the key data so as to intercept encrypted data even though he or she gets the value of each byte of the key data because he or she cannot get the order in which all the bytes of the key data have been read on a byte-by-byte basis. </paragraph>
</section>
<section>
<heading lvl="1">Embodiment 5 </heading>
<paragraph id="P-0069" lvl="0"><number>&lsqb;0069&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a block diagram showing a supply of clocks in an information processing device according to a fifth embodiment of the present invention. In the figure, reference numeral <highlight><bold>8</bold></highlight><highlight><italic>a </italic></highlight>denotes a first clock circuit for supplying a clock to an encryption circuit <highlight><bold>5</bold></highlight>, and reference numeral <highlight><bold>8</bold></highlight><highlight><italic>b </italic></highlight>denotes a second clock circuit for supplying another clock different from the clock output from the first clock circuit <highlight><bold>8</bold></highlight><highlight><italic>a </italic></highlight>to a CPU <highlight><bold>1</bold></highlight>. </paragraph>
<paragraph id="P-0070" lvl="0"><number>&lsqb;0070&rsqb;</number> If the CPU <highlight><bold>1</bold></highlight> and the encryption circuit <highlight><bold>5</bold></highlight> are made to operate from an identical clock from the same clock circuit, changes in the power consumption can appear clearly. Even if two clocks of different frequencies are generated from a clock generated by the same clock circuit by using a frequency divider and the CPU <highlight><bold>1</bold></highlight> and the encryption circuit <highlight><bold>5</bold></highlight> are made to operate from the two clocks of different frequencies, respectively, changes in the power consumption can appear clearly because those clocks are synchronized with each other. In contrast, in accordance with the fifth embodiment of the present invention, different clocks are supplied from the two clock circuits <highlight><bold>8</bold></highlight><highlight><italic>a </italic></highlight>and <highlight><bold>8</bold></highlight><highlight><italic>b </italic></highlight>disposed independently of each other to the CPU <highlight><bold>1</bold></highlight> and the encryption circuit <highlight><bold>5</bold></highlight>, as shown in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>. Thus, noise caused by the operating electric power supplied to the CPU <highlight><bold>1</bold></highlight> and the encryption circuit <highlight><bold>5</bold></highlight> asynchronously occurs on a Vcc line by supplying the first clock from the first clock circuit <highlight><bold>8</bold></highlight><highlight><italic>a </italic></highlight>to the encryption circuit <highlight><bold>5</bold></highlight>, and supplying the second clock from the second clock circuit <highlight><bold>8</bold></highlight><highlight><italic>b </italic></highlight>to the CPU <highlight><bold>1</bold></highlight>. Therefore, it becomes difficult to analyze the operating electric power consumed within the information processing device based on the Vcc line, thereby making it more difficult for any person to estimate the key data. </paragraph>
<paragraph id="P-0071" lvl="0"><number>&lsqb;0071&rsqb;</number> Furthermore, while it is preferable that the second clock supplied to the CPU <highlight><bold>1</bold></highlight> should not depend on the temperature and operating voltage, the use of a clock having a temperature characteristic and a voltage characteristic as the second clock supplied to the encryption circuit <highlight><bold>5</bold></highlight> makes it more difficult to analyze the operating electric power from the Vcc line. </paragraph>
<paragraph id="P-0072" lvl="0"><number>&lsqb;0072&rsqb;</number> When the information processing device is a contactless IC card, an oscillation circuit, such as a VCO whose oscillation frequency can change according to an input voltage, can be used for the clock generation because the operating voltage becomes unstable in the contactless IC card. </paragraph>
<paragraph id="P-0073" lvl="0"><number>&lsqb;0073&rsqb;</number> A variant of the fifth embodiment has a mechanism, as shown in <cross-reference target="DRAWINGS">FIG. 11</cross-reference>, of selecting two clocks, as the first and second clocks respectively supplied to the CPU <highlight><bold>1</bold></highlight> and the encryption circuit <highlight><bold>5</bold></highlight>, from among a plurality of clocks by means of a selector <highlight><bold>9</bold></highlight>. The variant controls the selector <highlight><bold>9</bold></highlight> by generating a random number before the encryption circuit <highlight><bold>5</bold></highlight> performs arithmetic computations associated with the encryption processing so as to select two clocks as the first and second clocks to be respectively supplied to the CPU <highlight><bold>1</bold></highlight> and the encryption circuit <highlight><bold>5</bold></highlight>, and returns to its original state in which two clocks previously supplied to the CPU <highlight><bold>1</bold></highlight> and the encryption circuit <highlight><bold>5</bold></highlight> before the performance of the encryption processing are respectively supplied to them. </paragraph>
<paragraph id="P-0074" lvl="0"><number>&lsqb;0074&rsqb;</number> As mentioned above, in accordance with the fifth embodiment of the present invention, the information processing device can supply different clocks from the two clock circuits <highlight><bold>8</bold></highlight><highlight><italic>a </italic></highlight>and <highlight><bold>8</bold></highlight><highlight><italic>b </italic></highlight>disposed independently of each other to the CPU <highlight><bold>1</bold></highlight> and the encryption circuit <highlight><bold>5</bold></highlight>, respectively, thereby making it difficult to analyze the operating electric power consumed within the information processing device and therefore making it more difficult for any person to estimate the key data. </paragraph>
</section>
<section>
<heading lvl="1">Embodiment 6 </heading>
<paragraph id="P-0075" lvl="0"><number>&lsqb;0075&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a drawing showing the structure of an example of a first clock circuit <highlight><bold>8</bold></highlight><highlight><italic>a, </italic></highlight>as shown in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>, for use in an information processing device according to a sixth embodiment of the present invention. The clock circuit as shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference> uses an oscillation circuit. In the figure, R<highlight><bold>0</bold></highlight> and C<highlight><bold>0</bold></highlight> denote a resistor and a capacitor that determine the fundamental frequency of the oscillation circuit, respectively, C<highlight><bold>1</bold></highlight> to C<highlight><bold>3</bold></highlight> denote capacitors used for changing the oscillation frequency, and SW<highlight><bold>1</bold></highlight> to SW<highlight><bold>3</bold></highlight> denote switches that are turned on or off according to a random number applied thereto so as to connect or disconnect the capacitors C<highlight><bold>1</bold></highlight> to C<highlight><bold>3</bold></highlight> to or from the oscillation circuit. These capacitors C<highlight><bold>1</bold></highlight> to C<highlight><bold>3</bold></highlight> may have different capacities, or may have an identical capacity. </paragraph>
<paragraph id="P-0076" lvl="0"><number>&lsqb;0076&rsqb;</number> In operation, the switches SW<highlight><bold>1</bold></highlight> to SW<highlight><bold>3</bold></highlight> are controlled by a 3-bit random number generated by a random number generation circuit <highlight><bold>7</bold></highlight> as shown in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>. In other words, if the random number is &ldquo;000&rdquo;, all the switches SW<highlight><bold>1</bold></highlight> to SW<highlight><bold>3</bold></highlight> are turned off. If the random number is &ldquo;001&rdquo;, only the switch SW<highlight><bold>1</bold></highlight> is turned on. If the random number is &ldquo;010&rdquo;, only the switch SW<highlight><bold>2</bold></highlight> is turned on. If the random number is &ldquo;011&rdquo;, only the switches SW<highlight><bold>1</bold></highlight> and SW<highlight><bold>2</bold></highlight> are turned on. If the random number is &ldquo;100&rdquo;, only the switch SW<highlight><bold>3</bold></highlight> is turned on. If the random number is &ldquo;101&rdquo;, only the switches SW<highlight><bold>1</bold></highlight> and SW<highlight><bold>3</bold></highlight> are turned on, . . . , and if the random number is &ldquo;111&rdquo;, all the switches SW<highlight><bold>1</bold></highlight> to SW<highlight><bold>3</bold></highlight> are turned on. Therefore, when the random number is &ldquo;000&rdquo;, the oscillation frequency of the oscillation circuit becomes its maximum value (fundamental frequency). Therefore, when one or more of the capacitors C<highlight><bold>1</bold></highlight> to C<highlight><bold>3</bold></highlight> are selectively connected in parallel to the capacitor C<highlight><bold>0</bold></highlight> according to the generated random number, the oscillation frequency decreases according to which one or more of the capacitors C<highlight><bold>1</bold></highlight> to C<highlight><bold>3</bold></highlight> are connected in parallel. When the random number is &ldquo;111&rdquo;, the oscillation frequency becomes its minimum value. Thus, the clock to be supplied to an encryption circuit <highlight><bold>5</bold></highlight> is generated based on the oscillation frequency of the oscillation circuit that can vary according to the random number. </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> Another example of the first clock circuit <highlight><bold>8</bold></highlight><highlight><italic>a </italic></highlight>including a combination of a DAC and a VCO is shown in <cross-reference target="DRAWINGS">FIG. 13</cross-reference>. In the figure, reference numeral <highlight><bold>81</bold></highlight> denotes the DAC for converting a random number generated by the random number generation circuit <highlight><bold>7</bold></highlight> as shown in <cross-reference target="DRAWINGS">FIG. 4</cross-reference> into an equivalent analog value, and reference numeral <highlight><bold>82</bold></highlight> denotes the VCO whose oscillation frequency is controlled by the analog value output from the DAC <highlight><bold>81</bold></highlight>. </paragraph>
<paragraph id="P-0078" lvl="0"><number>&lsqb;0078&rsqb;</number> In operation, a random number in the form of a digital signal generated by the random number generation circuit <highlight><bold>7</bold></highlight> is input to the DAC <highlight><bold>81</bold></highlight>. When the DAC <highlight><bold>81</bold></highlight> receives the random number in the form of a digital signal, it converts the random number into an equivalent analog value and then sends the analog value to the VCO <highlight><bold>82</bold></highlight>. The VCO <highlight><bold>82</bold></highlight> is controlled by the analog voltage and oscillates at a frequency corresponding to the random number. Thus, the clock to be supplied to the encryption circuit <highlight><bold>5</bold></highlight> is generated based on the oscillation frequency of the oscillation circuit which can vary according to the random number. </paragraph>
<paragraph id="P-0079" lvl="0"><number>&lsqb;0079&rsqb;</number> The encryption circuit <highlight><bold>5</bold></highlight> changes in its operating electric power as the operation frequency of the clock supplied from the first clock circuit <highlight><bold>8</bold></highlight><highlight><italic>a </italic></highlight>changes. Thus, if the encryption circuit <highlight><bold>5</bold></highlight> changes in its operating electric power according to the random number every time the encryption circuit <highlight><bold>5</bold></highlight> performs arithmetic computations associated with encryption processing, the power analysis becomes more difficult. </paragraph>
<paragraph id="P-0080" lvl="0"><number>&lsqb;0080&rsqb;</number> The operation frequency of the clock supplied from the first clock circuit <highlight><bold>8</bold></highlight><highlight><italic>a </italic></highlight>can be made to change before or while the encryption circuit <highlight><bold>5</bold></highlight> performs arithmetic computations associated with encryption processing. The more times the operation frequency of the clock supplied from the first clock circuit <highlight><bold>8</bold></highlight><highlight><italic>a </italic></highlight>is made to change, the more difficult the power analysis becomes. In a variant, the information processing device can include two or more clock circuits constructed as shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference> or <highlight><bold>13</bold></highlight>, which are used for supplying clocks to a CPU <highlight><bold>1</bold></highlight>, public key cryptography processing, and private key cryptography processing, respectively. </paragraph>
<paragraph id="P-0081" lvl="0"><number>&lsqb;0081&rsqb;</number> As mentioned above, in accordance with the sixth embodiment of the present invention, since the clock to be supplied to the encryption circuit <highlight><bold>5</bold></highlight> from the first clock circuit <highlight><bold>8</bold></highlight> is made to change according to the random number generated by the random number generation circuit <highlight><bold>7</bold></highlight>, the encryption circuit <highlight><bold>5</bold></highlight> changes in its operating electric power according to the random number every time the encryption circuit <highlight><bold>5</bold></highlight> performs arithmetic computations associated with the encryption processing, thereby making it more difficult to estimate the key data through power analysis. </paragraph>
</section>
<section>
<heading lvl="1">Embodiment 7 </heading>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 14</cross-reference> is a block diagram showing an information processing device according to a seventh embodiment of the present invention. In the figure, a contactless IC card having a built-in security function is illustrated as an example of the information processing device of the seventh embodiment. In the figure, reference numeral <highlight><bold>10</bold></highlight> denotes an antenna that sends and receives an electric wave to and from a reader (not shown), reference numeral <highlight><bold>11</bold></highlight> denotes a sending and receiving circuit for sending and receiving transmission data from and to the contactless IC card byway of the antenna <highlight><bold>10</bold></highlight>, and reference numeral <highlight><bold>12</bold></highlight> denotes a power supply generation circuit for generating power from the electric wave received by way of the antenna <highlight><bold>10</bold></highlight>. </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> In operation, the contactless IC card performs AM modulation and AM demodulation by mean of the sending and receiving circuit <highlight><bold>11</bold></highlight>, and performs data transmission with a reader (not shown). Power required for the contactless IC card to operate is generated from an electric wave received by way of the antenna <highlight><bold>10</bold></highlight> by the power supply generation circuit <highlight><bold>12</bold></highlight>, and is then supplied to the sending and receiving circuit <highlight><bold>11</bold></highlight>, a CPU <highlight><bold>1</bold></highlight>, an encryption circuit <highlight><bold>5</bold></highlight>, a random number generation circuit <highlight><bold>7</bold></highlight>, and so on. </paragraph>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 15</cross-reference> is timing chart showing the timing at which data are transmitted between the contactless IC card and a reader (not shown) when a command accompanied by encryption processing is executed. First, the sending and receiving circuit <highlight><bold>11</bold></highlight> receives a command accompanied by encryption processing and transmitted from the reader by way of the antenna <highlight><bold>10</bold></highlight>. The sending and receiving circuit <highlight><bold>11</bold></highlight> demodulates and sends the received command to the CPU <highlight><bold>1</bold></highlight>, and the CPU <highlight><bold>1</bold></highlight> processes the command. When the execution of the command is ended, the sending and receiving circuit <highlight><bold>11</bold></highlight> AM-modulates execution results and then transmits the AM-modulated execution results to the reader by way of the antenna <highlight><bold>10</bold></highlight>. </paragraph>
<paragraph id="P-0085" lvl="0"><number>&lsqb;0085&rsqb;</number> While the CPU <highlight><bold>1</bold></highlight> executes an encryption processing program during the execution of the command, the random number generation circuit <highlight><bold>7</bold></highlight> generates a random number, and the sending and receiving circuit <highlight><bold>11</bold></highlight> AM-modulates the random number and transmits the AM-modulated random number to the reader. Thus, the transmission of the random number during the execution of the command accompanied by encryption processing makes it difficult to monitor a Vcc line because a random noise is generated in the Vcc line. </paragraph>
<paragraph id="P-0086" lvl="0"><number>&lsqb;0086&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 16</cross-reference> is a drawing showing the structure of a response frame indicating execution results of a command accompanied by encryption processing which is sent to the reader when the execution of the command is completed. As shown in the figure, since an SOF code indicating the head of the response frame, an EOF code indicating the end of the response frame, and a CRC code for communication error check are added to the response frame, the random number is not misidentified as any response on the reader side. </paragraph>
<paragraph id="P-0087" lvl="0"><number>&lsqb;0087&rsqb;</number> When a contactless IC card in which the degree of modulation can be controlled in the sending and receiving circuit <highlight><bold>11</bold></highlight> is used as the information processing device, the degree of modulation can be changed according to the random number generated by the random number generation circuit <highlight><bold>7</bold></highlight>. Thus, the determination of the degree of modulation by using the random number can change the magnitude of the random noise generated in the Vcc line. The transmission rate having the same frequency as the operation frequency of the encryption circuit enhances the effect. Furthermore, when the transmission rate and the operation frequency of the encryption circuit are set so that they are the same as the frequency of an electric wave received by way of the antenna, the random noise generated in the Vcc line and ripples caused by rectification overlap one another and this results in enhancing the above-mentioned effect. </paragraph>
<paragraph id="P-0088" lvl="0"><number>&lsqb;0088&rsqb;</number> As mentioned above, in accordance with the seventh embodiment of the present invention, since the contactless IC card transmits a random number to a reader while performing encryption processing, the contactless IC card can cause a random noise in the Vcc line, thereby making it more difficult to estimate the key data through power analysis. </paragraph>
</section>
<section>
<heading lvl="1">Embodiment 8 </heading>
<paragraph id="P-0089" lvl="0"><number>&lsqb;0089&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 17</cross-reference> is a block diagram showing an example of a noise generation circuit for use in an information processing device according to an eighth embodiment of the present invention. In the figure, reference numeral <highlight><bold>7</bold></highlight> denotes a random number generation circuit, reference numeral <highlight><bold>71</bold></highlight> denotes a shift register disposed in the random number generation circuit <highlight><bold>7</bold></highlight>, and reference numeral <highlight><bold>13</bold></highlight> denotes a noise generation circuit for superimposing a noise on a Vcc line according to a random number generated by the random number generation circuit <highlight><bold>7</bold></highlight>. The noise generation circuit is provided with an AND gate AND for opening or closing a path through which the noise is passed according to the random number generated by the random number generation circuit <highlight><bold>7</bold></highlight>, a field-effect transistor TR having a gate terminal connected to an output terminal of the AND gate AND, and a resistor R<highlight><bold>1</bold></highlight> connected to the field-effect transistor TR. </paragraph>
<paragraph id="P-0090" lvl="0"><number>&lsqb;0090&rsqb;</number> The information processing device, such as a contact IC card without a modulation circuit included in a contactless IC card, has the built-in noise generation circuit <highlight><bold>13</bold></highlight>, as shown in <cross-reference target="DRAWINGS">FIG. 17</cross-reference>, for generating a noise according to a random number generated by the random number generation circuit <highlight><bold>7</bold></highlight> and for superimposing the noise on the Vcc line. The random number generation circuit <highlight><bold>7</bold></highlight> sends the random number to the noise generation circuit <highlight><bold>13</bold></highlight> bit by bit by means of the shift register <highlight><bold>71</bold></highlight>. The AND gate AND of the noise generation circuit <highlight><bold>13</bold></highlight> is opened when the input random number is at a high level, and is closed when the input random number is at a low level. Therefore, when the random number from the random number generation circuit <highlight><bold>7</bold></highlight> is at a high level, the power consumption increases, whereas when the random number is at a low level, the power consumption has a usual value. </paragraph>
<paragraph id="P-0091" lvl="0"><number>&lsqb;0091&rsqb;</number> The noise generation circuit <highlight><bold>13</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 17</cross-reference> can change the resistance of the series circuit that consists of the field-effect transistor TR and the resistor R<highlight><bold>1</bold></highlight> connected in series between the Vcc line and a ground according to the random number by applying the noise generated therein to the gate terminal of the field-effect transistor TR according to the random number, so that the noise whose level can change at random is superimposed on the Vcc line. It is therefore possible to change the resistance of the series circuit at random according to the random number by changing the gate voltage of the field-effect transistor TR according to the random number. Because the level of the noise that thus changes at random according to the random number is superimposed on the Vcc line and hence the power consumption changes, the estimation of the key data through power analysis becomes more difficult. </paragraph>
<paragraph id="P-0092" lvl="0"><number>&lsqb;0092&rsqb;</number> The noise generation circuit used by the eighth embodiment of the present invention is not limited to the one as shown in <cross-reference target="DRAWINGS">FIG. 17</cross-reference>. As an alternative, a plurality of resistors can be connected to a field-effect transistor by way of switches, respectively. <cross-reference target="DRAWINGS">FIG. 18</cross-reference> is a circuit diagram showing an example of such a noise generation circuit. In the figure, TR denotes the field-effect transistor, R<highlight><bold>1</bold></highlight> to R<highlight><bold>3</bold></highlight> denote the resistors, and SW<highlight><bold>1</bold></highlight> to SW<highlight><bold>3</bold></highlight> denote switches. </paragraph>
<paragraph id="P-0093" lvl="0"><number>&lsqb;0093&rsqb;</number> In the noise generation circuit constructed as shown in <cross-reference target="DRAWINGS">FIG. 18</cross-reference>, the connection of the three resistors R<highlight><bold>1</bold></highlight> to R<highlight><bold>3</bold></highlight> between the field-effect transistor TR and the Vcc line can be changed by controlling the switches SW<highlight><bold>1</bold></highlight> to SW<highlight><bold>3</bold></highlight> according to a 3-bit random number so that the resistance of the parallel circuit constructed of the plurality of resistors R<highlight><bold>1</bold></highlight> to R<highlight><bold>3</bold></highlight> connected in series to the field-effect transistor TR changes according to the random number. As a result, the resistance of the series circuit that consists of the field-effect transistor TR and the plurality of resistors R<highlight><bold>1</bold></highlight> to R<highlight><bold>3</bold></highlight> connected between the Vcc line and a ground changes according to the random number. Therefore, since the level of the noise superimposed on the Vcc line changes at random according to the random number, the estimation of the key data through power analysis becomes difficult. The transmission rate having the same frequency as the operation frequency of the encryption circuit enhances the effect. Furthermore, when the transmission rate and the operation frequency of the encryption circuit are set so that they are the same as the frequency of an electric wave received by way of the antenna, the random noise generated in the Vcc line and ripples caused by rectification overlap one another and this results in enhancing the above-mentioned effect. </paragraph>
<paragraph id="P-0094" lvl="0"><number>&lsqb;0094&rsqb;</number> As mentioned above, in accordance with the eighth embodiment of the present invention, since in the noise generation circuit the resistance of the series circuit that consists of a field-effect transistor TR and at least a resistor is changed according to a random number generated by the random number generation circuit, a noise whose level changes at random according to the random number is superimposed on the Vcc line and hence the power consumption changes, thereby making it more difficult to estimate the key data through power analysis. </paragraph>
</section>
<section>
<heading lvl="1">Embodiment 9 </heading>
<paragraph id="P-0095" lvl="0"><number>&lsqb;0095&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 19</cross-reference> is a block diagram showing the structure of an encryption circuit for use in an information processing device according to a ninth embodiment of the present invention. In the figure, reference numeral <highlight><bold>5</bold></highlight> denotes an encryption circuit, reference numeral <highlight><bold>51</bold></highlight> denotes a register disposed in the encryption circuit <highlight><bold>5</bold></highlight>, and reference numeral <highlight><bold>52</bold></highlight> denotes an operation unit of the encryption circuit <highlight><bold>5</bold></highlight>. </paragraph>
<paragraph id="P-0096" lvl="0"><number>&lsqb;0096&rsqb;</number> In operation, any data D (D<highlight><bold>0</bold></highlight> to Dn), such as key data or arithmetic computation result data, which is transmitted between the register <highlight><bold>51</bold></highlight> and the operation unit <highlight><bold>52</bold></highlight>, is transmitted together with corresponding inverted data D&prime; (D<highlight><bold>0</bold></highlight>&prime; to Dn&prime;), which is the inversion of the data D, by way of a pair of lines. When any data D and corresponding inverted data D&prime; are thus transmitted with them paired with each other, the numbers of 1s and 0s included in the data D and the corresponding inverted data D&prime; transmitted are equal to each other. Therefore, even when any data D is transmitted between the register <highlight><bold>51</bold></highlight> and the operation unit <highlight><bold>52</bold></highlight>, the power consumption does not change according to how many the data D includes 1s and 0s, unlike the case where only the data D is transmitted. </paragraph>
<paragraph id="P-0097" lvl="0"><number>&lsqb;0097&rsqb;</number> Referring next to <cross-reference target="DRAWINGS">FIG. 20</cross-reference>, there is illustrated a schematic circuit diagram showing transmission of data D in the encryption circuit <highlight><bold>5</bold></highlight> according to the ninth embodiment. In the figure, L denotes a load circuit disposed on a line, Ld denotes a dummy circuit connected to a line, and TR denotes a transistor for precharging a corresponding line. </paragraph>
<paragraph id="P-0098" lvl="0"><number>&lsqb;0098&rsqb;</number> When any data D is transmitted between the register <highlight><bold>51</bold></highlight> and the operation unit <highlight><bold>52</bold></highlight>, there is a possibility that which line changes in voltage can be guessed through analysis of the power consumption if the load imposed on the line via which the data D is transmitted is not equal to the load imposed on the corresponding line via which corresponding inverted data D&prime; is transmitted. Therefore, in the ninth embodiment, a dummy circuit Ld is connected to every line with fewer load circuits L, as shown in <cross-reference target="DRAWINGS">FIG. 20</cross-reference>, even though the dummy circuit Ld is not needed under normal operating conditions. As a result, the load imposed on every line becomes nearly equal. </paragraph>
<paragraph id="P-0099" lvl="0"><number>&lsqb;0099&rsqb;</number> Furthermore, when, after making data D and corresponding inverted data D&prime; propagate through the pair of lines, making next data D and corresponding inverted data D&prime; propagate through the pair of lines while leaving the pair of lines intact as it is, the power consumption differs according to the numbers of 1s and 0s included in the previous data D and corresponding inverted data D&prime; and it therefore becomes easy to perform power analysis. Therefore, in the ninth embodiment, a precharging cycle used for setting and keeping the pair of lines at an identical state is provided prior to any data transmission as shown in <cross-reference target="DRAWINGS">FIG. 20</cross-reference>. In other words, in the precharging cycle, the line via which the next data D is to be transmitted is set to a high level by a corresponding transistor TR, and the line via which the corresponding inverted data D&prime; is transmitted is set to a low level by a corresponding transistor TR. </paragraph>
<paragraph id="P-0100" lvl="0"><number>&lsqb;0100&rsqb;</number> As mentioned above, in accordance with the ninth embodiment of the present invention, since any data D is transmitted between the register <highlight><bold>51</bold></highlight> and the operation unit <highlight><bold>52</bold></highlight> together with corresponding inverted data D&prime;, which is the inversion of the data D, by way of a pair of lines, and the loads imposed on the pair of lines are equalized and a precharge is carried out prior to the transmission of any data, the power consumption does not depend on the numbers of 1s and 0s included in the transmitted data D, and hence becomes constant. Consequently, the encryption circuit of the present embodiment makes it more difficult to estimate the key data through power analysis. </paragraph>
</section>
<section>
<heading lvl="1">Embodiment 10 </heading>
<paragraph id="P-0101" lvl="0"><number>&lsqb;0101&rsqb;</number> An information processing device according to a tenth embodiment of the present invention has a combination of any one of the function according to the first embodiment of storing the first half of each word of the key data and data which is the inversion of the first half of each word of the key data in one word of the E2PROM, storing the second half of each word of the key data and data which is the inversion of the second half of each word of the key data in another word adjacent to the word of the E2PROM in which the first half of each word of the key data and the corresponding inverted data are stored, and reading the key data together with the inverted data with the number of 1s included in the key data and the inverted data being equal to the number of 0s included in the key data and the inverted data, the function according to the second embodiment of changing the order in which the arithmetic computation programs A and B included in the encryption processing program are executed according to a random number, the function according to the fourth embodiment of reading the plurality of bytes of the key data on a byte-by-byte basis in the order determined by random numbers, and the function according to the fifth embodiment of generating a clock to be supplied to the encryption circuit and another clock to be supplied to the CPU by means of the first and second clock circuits disposed independently of each other, and the function according to the seventh embodiment of transmitting a random number to a reader during the execution of a command accompanied by encryption processing and/or the function according to the eighth embodiment of superimposing a noise on the Vcc line according to a random number. </paragraph>
<paragraph id="P-0102" lvl="0"><number>&lsqb;0102&rsqb;</number> Therefore the tenth embodiment offers an advantage of providing a higher level of security at a low cost with the combination. </paragraph>
<paragraph id="P-0103" lvl="0"><number>&lsqb;0103&rsqb;</number> Many widely different embodiments of the present invention may be constructed without departing from the spirit and scope of the present invention. It should be understood that the present invention is not limited to the specific embodiments described in the specification, except as defined in the appended claims. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is claimed is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. An information processing device comprising: 
<claim-text>a storage circuit for storing key data used to perform encryption processing for data security as well as inversion of the key data; and </claim-text>
<claim-text>an encryption processing circuit for reading the key data together with the inversion of the key data from said storage circuit, and for performing the encryption processing by using the key data read out of said storage circuit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The information processing device according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said encryption processing circuit includes an encryption circuit for performing arithmetic computations associated with the encryption processing, and said encryption circuit has a line via which data such as the key data is transmitted, another line via which inverted data which is inversion of said data is transmitted, and a precharging circuit for precharging said line and said other line at certain levels, respectively, in a precharging cycle prior to transmission of said data and said other data via said line and said other line. </claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. An information processing device comprising: 
<claim-text>a storage circuit for storing key data used to perform encryption processing for data security; </claim-text>
<claim-text>a random number generation circuit for generating a random number; and </claim-text>
<claim-text>an encryption processing circuit for reading the key data from said storage circuit and for performing the encryption processing by using the key data read out of said storage circuit while changing a order in which two or more arithmetic computations associated with the encryption processing are performed according to the random number generated by said random number generation circuit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The information processing device according to <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein said encryption processing circuit includes an encryption circuit for performing arithmetic computations associated with the encryption processing, and said encryption circuit has a line via which data such as the key data is transmitted, another line via which inverted data which is inversion of said data is transmitted, and a precharging circuit for precharging said line and said other line at certain levels, respectively, in a precharging cycle prior to transmission of said data and said other data via said line and said other line. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. An information processing device comprising: 
<claim-text>a storage circuit for storing key data used to perform encryption processing for data security; </claim-text>
<claim-text>a random number generation circuit for generating a random number; and </claim-text>
<claim-text>an encryption processing circuit for reading the key data from said storage circuit and for performing the encryption processing by using the key data read out of said storage circuit while changing timing at which two or more arithmetic computations associated with the encryption processing are performed according to the random number generated by said random number generation circuit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The information processing device according to claim <highlight><bold>5</bold></highlight>, wherein said encryption processing circuit includes an encryption circuit for performing arithmetic computations associated with the encryption processing, and said encryption circuit has a line via which data such as the key data is transmitted, another line via which inverted data which is inversion of said data is transmitted, and a precharging circuit for precharging said line and said other line at certain levels, respectively, in a precharging cycle prior to transmission of said data and said other data via said line and said other line. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. An information processing device comprising: 
<claim-text>a storage circuit for storing key data used to perform encryption processing for data security; </claim-text>
<claim-text>a random number generation circuit for generating a random number; and </claim-text>
<claim-text>an encryption processing circuit for sequentially reading a plurality of parts of the key data one after another from said storage circuit while determining a part of the key data to be read for the next time according to the random number generated by said random number generation circuit, and for performing the encryption processing by using the key data read out of said storage circuit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The information processing device according to <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference>, wherein said encryption processing circuit includes an encryption circuit for performing arithmetic computations associated with the encryption processing, and said encryption circuit has a line via which data such as the key data is transmitted, another line via which inverted data which is inversion of said data is transmitted, and a precharging circuit for precharging said line and said other line at certain levels, respectively, in a precharging cycle prior to transmission of said data and said other data via said line and said other line. </claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. An information processing device comprising: 
<claim-text>a storage circuit for storing key data used to perform encryption processing for data security; </claim-text>
<claim-text>an encryption processing circuit for reading the key data from said storage circuit and for performing the encryption processing by using the key data read out of said storage circuit; </claim-text>
<claim-text>an arithmetic computation circuit for performing specific arithmetic computations associated with the encryption processing performed by said encryption processing circuit; </claim-text>
<claim-text>a first clock generation circuit for supplying a clock to said arithmetic computation circuit; and </claim-text>
<claim-text>a second clock generation circuit for supplying another clock different from the clock generated by said first clock generation circuit to said encryption processing circuit; </claim-text>
</claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. The information processing device according to <dependent-claim-reference depends_on="CLM-00009">claim 9</dependent-claim-reference>, further comprising a random number generation circuit for generating a random number, wherein said first clock generation circuit changes a frequency of the clock generated thereby according to the random number generated by said random number generation circuit. </claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. The information processing device according to <dependent-claim-reference depends_on="CLM-00009">claim 9</dependent-claim-reference>, wherein said encryption processing circuit includes an encryption circuit for performing arithmetic computations associated with the encryption processing, and said encryption circuit has a line via which data such as the key data is transmitted, another line via which inverted data which is inversion of said data is transmitted, and a precharging circuit for precharging said line and said other line at certain levels, respectively, in a precharging cycle prior to transmission of said data and said other data via said line and said other line. </claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. An information processing device that sends and receives data to and from a reader, said device comprising: 
<claim-text>a storage circuit for storing key data used to perform encryption processing for data security; </claim-text>
<claim-text>a random number generation circuit for generating a random number; </claim-text>
<claim-text>an encryption processing circuit for reading the key data from said storage circuit and for performing the encryption processing by using the key data read out of said storage circuit; and </claim-text>
<claim-text>a transmission circuit for transmitting the random number generated by said random number generation circuit to said reader while said encryption processing circuit performs the encryption processing by using the key data. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. The information processing device according to <dependent-claim-reference depends_on="CLM-00011">claim 12</dependent-claim-reference>, where said transmission circuit determines a degree of modulation with which said transmission circuit modulates the random number generated by said random number generation circuit when transmitting the random number to said reader according to the random number. </claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. The information processing device according to <dependent-claim-reference depends_on="CLM-00011">claim 12</dependent-claim-reference>, wherein said encryption processing circuit includes an encryption circuit for performing arithmetic computations associated with the encryption processing, and said encryption circuit has a line via which data such as the key data is transmitted, another line via which inverted data which is inversion of said data is transmitted, and a precharging circuit for precharging said line and said other line at certain levels, respectively, in a precharging cycle prior to transmission of said data and said other data via said line and said other line. </claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. An information processing device comprising: 
<claim-text>a storage circuit for storing key data used to perform encryption processing for data security; </claim-text>
<claim-text>a random number generation circuit for generating a random number; </claim-text>
<claim-text>an encryption processing circuit for reading the key data from said storage circuit and for performing the encryption processing by using the key data read out of said storage circuit; and; and </claim-text>
<claim-text>a noise superimposing circuit for superimposing a noise on a power supply line according to the random number generated by said random number generation circuit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. The information processing device according to <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference>, wherein said noise superimposing circuit includes a series circuit having a field-effect transistor and at least a resistor connected in series to said field-effect transistor, and connected between a power supply line and a ground, and a circuit for changing a resistance of said series circuit according to the random number generated by said random number generation circuit. </claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. The information processing device according to <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference>, wherein said encryption processing circuit includes an encryption circuit for performing arithmetic computations associated with the encryption processing, and said encryption circuit has a line via which data such as the key data is transmitted, another line via which inverted data which is inversion of said data is transmitted, and a precharging circuit for precharging said line and said other line at certain levels, respectively, in a precharging cycle prior to transmission of said data and said other data via said line and said other line.</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>1</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030005321A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030005321A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030005321A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030005321A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030005321A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030005321A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030005321A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030005321A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030005321A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00009">
<image id="EMI-D00009" file="US20030005321A1-20030102-D00009.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00010">
<image id="EMI-D00010" file="US20030005321A1-20030102-D00010.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00011">
<image id="EMI-D00011" file="US20030005321A1-20030102-D00011.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
