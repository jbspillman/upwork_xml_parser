<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030002436A1-20030102-D00000.TIF SYSTEM "US20030002436A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030002436A1-20030102-D00001.TIF SYSTEM "US20030002436A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030002436A1-20030102-D00002.TIF SYSTEM "US20030002436A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030002436A1-20030102-D00003.TIF SYSTEM "US20030002436A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030002436A1-20030102-D00004.TIF SYSTEM "US20030002436A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030002436A1-20030102-D00005.TIF SYSTEM "US20030002436A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030002436A1-20030102-D00006.TIF SYSTEM "US20030002436A1-20030102-D00006.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030002436</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10176845</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20020620</filing-date>
</domestic-filing-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>G01R031/08</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>370</class>
<subclass>218000</subclass>
</uspc>
</classification-us-primary>
<classification-us-secondary>
<uspc>
<class>370</class>
<subclass>244000</subclass>
</uspc>
</classification-us-secondary>
</classification-us>
<title-of-invention>Detecting network misuse</title-of-invention>
</technical-information>
<continuity-data>
<non-provisional-of-provisional>
<document-id>
<doc-number>60299809</doc-number>
<document-date>20010620</document-date>
<country-code>US</country-code>
</document-id>
</non-provisional-of-provisional>
</continuity-data>
<inventors>
<first-named-inventor>
<name>
<given-name>Thomas</given-name>
<middle-name>E.</middle-name>
<family-name>Anderson</family-name>
</name>
<residence>
<residence-us>
<city>Seattle</city>
<state>WA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>David</given-name>
<middle-name>J.</middle-name>
<family-name>Wetherall</family-name>
</name>
<residence>
<residence-us>
<city>Seattle</city>
<state>WA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Stefan</given-name>
<middle-name>R.</middle-name>
<family-name>Savage</family-name>
</name>
<residence>
<residence-us>
<city>Carlsbad</city>
<state>CA</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<correspondence-address>
<name-1>SCHWABE, WILLIAMSON &amp; WYATT, P.C.</name-1>
<name-2></name-2>
<address>
<address-1>10260 SW GREENBURG ROAD</address-1>
<address-2>SUITE 820</address-2>
<city>PORTLAND</city>
<state>OR</state>
<postalcode>97223</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">An apparatus is equipped to receive network traffic data for network traffic routed over one or more network links relevant to a network link. Selected numbers of analysis are performed to determine if the network link of interest is being misused. The analyses include but are not limited to analyses to determine whether the network traffic routed are inconsistent with an expected traffic pattern, whether unallocated source addresses are present, whether source addresses exhibit an uncharacteristic even distribution pattern, whether a server is uncharacteristically excessive in responding to the same source address, whether normal bursty behavior is absent from the traffic, whether a ratio of packets in one direction to packets in another direction is out of balance, whether a ratio of packets of one type to packets of another type is out of balance, and whether a server is uncharacteristically excessive in responding with error responses. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> 1. Field of the Invention </paragraph>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> The present invention relates to the field of networking. More specifically, the present invention relates to the detection of network misuses, such as denial-of-service attacks. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> 2. Background Information </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> With advances in integrated circuit, microprocessor, networking and communication technologies, an increasing number of devices, in particular, digital computing devices, are being networked together. Devices are often first coupled to a local area network, such as an Ethernet based office/home network. In turn, the local area networks are interconnected together through wide area networks, such as SONET networks, ATM networks, Frame Relays, and the like. Of particular notoriety is the TCP/IP based global inter-networks, Internet. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> As a result this trend of increased connectivity, an increasing number of applications that are network dependent are being deployed. Examples of these network dependent applications include but are not limited to, email, net based telephony, world wide web and various types of e-commerce. For these applications, success inherently means high volume of network traffic for their implementing servers. To ensure continuing success, quality of service through orderly and efficient handling of the large volume of network traffic has become of paramount importance. Various subject matters, such as scalability, distributive deployment and caching of contents as well as preventing network misuse have become of great interest to the artesian. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> An apparatus is equipped to receive network traffic data relevant for network traffic routed over a network link. Selected numbers of analyses are performed to determine whether the network link is being misused. The analyses include but are not limited to analyses to determine whether the network traffic routed are inconsistent with an expected traffic pattern, whether unallocated source addresses are present, whether source addresses exhibit an uncharacteristic even distribution pattern, whether a server is uncharacteristically excessive in responding to the same source address, whether normal bursty behavior is absent from the traffic, whether a ratio of packets in one direction to packets in another direction is out of balance, whether a ratio of packets of one type to packets of another type is out of balance, and whether a server is uncharacteristically excessive in responding with error responses. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> In one embodiment, network traffic data are collected for network traffic routed over the related network links as well as the network link of interest. In one embodiment, distributed sensors are employed to collect and provide the network traffic data. The distributed sensors are selectively activated/deactivated based on the results of the analyses. In one embodiment, in like manner, routing devices are selectively regulated to regulate the network traffic being routed over the network link. In one embodiment, the regulations and de-regulations are administered via the corresponding sensors. </paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF DRAWINGS </heading>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> The present invention will be described by way of exemplary embodiments, but not limitations, illustrated in the accompanying drawings in which like references denote similar elements, and in which: </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> illustrates a network view of the present invention, in accordance with one embodiment; </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> illustrates a method view of the same invention, in accordance with one embodiment; </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> illustrates a functional view of the director of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, in accordance with one embodiment; </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> FIGS. <highlight><bold>4</bold></highlight>-<highlight><bold>6</bold></highlight> illustrate the operational flow of the relevant aspects of the send/receive, analyzer and regulator functions of <cross-reference target="DRAWINGS">FIG. 3</cross-reference>, in accordance with one embodiment each; and </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> illustrates an example computer system suitable for use to host a software implementation of a sensor or the director, in accordance with one embodiment.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF THE INVENTION </heading>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> In the following description, various aspects of the present invention will be described. However, it will be apparent to those skilled in the art that the present invention may be practiced with only some or all aspects of the present invention. For purposes of explanation, specific numbers, materials and configurations are set forth in order to provide a thorough understanding of the present invention. However, it will also be apparent to one skilled in the art that the present invention may be practiced without the specific details. In other instances, well known features are omitted or simplified in order not to obscure the present invention. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> Parts of the description will be presented in terms of operations performed by a processor based device, using terms such as receiving, analyzing, determining, instructing, and the like, consistent with the manner commonly employed by those skilled in the art to convey the substance of their work to others skilled in the art. As well understood by those skilled in the art, the quantities take the form of electrical, magnetic, or optical signals capable of being stored, transferred, combined, and otherwise manipulated through mechanical and electrical components of the processor based device; and the term processor include microprocessors, micro-controllers, digital signal processors, and the like, that are standalone, adjunct or embedded. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> Parts of the description will be described using various acronyms, including but are not limited to:  
<table-cwu id="TABLE-US-00001">
<number>1</number>
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="OFFSET" colwidth="35PT" align="left"/>
<colspec colname="1" colwidth="56PT" align="left"/>
<colspec colname="2" colwidth="126PT" align="left"/>
<thead>
<row>
<entry></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry namest="OFFSET" nameend="2" align="center" rowsep="1"></entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry></entry>
<entry>ATM</entry>
<entry>Asynchronous Transfer Mode</entry>
</row>
<row>
<entry></entry>
<entry>DNS</entry>
<entry>Domain Name Service</entry>
</row>
<row>
<entry></entry>
<entry>IP</entry>
<entry>Internet Protocol</entry>
</row>
<row>
<entry></entry>
<entry>SONET</entry>
<entry>Synchronous Optical Network</entry>
</row>
<row>
<entry></entry>
<entry>TCP</entry>
<entry>Transmission Control Protocol</entry>
</row>
<row>
<entry></entry>
<entry namest="OFFSET" nameend="2" align="center" rowsep="1"></entry>
</row>
</tbody>
</tgroup>
</table>
</table-cwu>
</paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> The terms &ldquo;routing devices&rdquo; and &ldquo;route&rdquo; are used throughout this application, in the claims as well as in the specification. The terms as used herein are intended to be genus terms that include the conventional routers and conventional routing, as well as all other variations of network trafficking, such as, switches or switching, gateways, hubs and the like. Thus, unless particularized, the terms are to be given this broader meaning. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> Various operations will be described as multiple discrete steps in turn, in a manner that is most helpful in understanding the present invention, however, the order of description should not be construed as to imply that these operations are necessarily order dependent. In particular, these operations need not be performed in the order of presentation. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> Further, the description repeatedly uses the phrase &ldquo;in one embodiment&rdquo;, which ordinarily does not refer to the same embodiment, although it may. </paragraph>
</section>
<section>
<heading lvl="1">Overview </heading>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, wherein a block diagram illustrating a network view of the present invention, in accordance with one embodiment, is shown. As illustrated, client devices <highlight><bold>108</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>108</bold></highlight><highlight><italic>n </italic></highlight>are coupled to servers <highlight><bold>110</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>110</bold></highlight><highlight><italic>n </italic></highlight>through networking fabric <highlight><bold>112</bold></highlight>, which includes a number of routing devices <highlight><bold>106</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>106</bold></highlight><highlight><italic>n </italic></highlight>coupled to each other forming a plurality of network links. Client devices <highlight><bold>108</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>108</bold></highlight><highlight><italic>n</italic></highlight>, via routing devices <highlight><bold>106</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>106</bold></highlight><highlight><italic>n</italic></highlight>, or more specifically, over the network links formed by routing devices <highlight><bold>106</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>106</bold></highlight><highlight><italic>n</italic></highlight>, selectively access servers <highlight><bold>110</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>110</bold></highlight><highlight><italic>n </italic></highlight>for services. Unfortunately, as those skilled in the art would appreciate, the same network links that make servers <highlight><bold>110</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>110</bold></highlight><highlight><italic>n </italic></highlight>readily accessible to client devices <highlight><bold>108</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>108</bold></highlight><highlight><italic>n </italic></highlight>also render them vulnerable to abuse or misuse by one or more of client devices <highlight><bold>108</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>108</bold></highlight><highlight><italic>n</italic></highlight>. For example, one or more client devices <highlight><bold>108</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>108</bold></highlight><highlight><italic>n </italic></highlight>may individually or in combination launch an attack, such as a denial of service attack, or otherwise victimize one or more servers <highlight><bold>110</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>110</bold></highlight><highlight><italic>n</italic></highlight>, routing devices <highlight><bold>106</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>106</bold></highlight><highlight><italic>b </italic></highlight>and/or the links interconnected the elements. In accordance with the present invention, director <highlight><bold>102</bold></highlight>, complemented by a number of sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n</italic></highlight>, are employed to detect and prevent such abuse or misuse of the network links, to be described more fully below. For the illustrated embodiment, sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n </italic></highlight>are disposed in distributed locations. In alternate embodiments, some or all of sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n </italic></highlight>may be integrally disposed with routing devices <highlight><bold>106</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>106</bold></highlight><highlight><italic>b</italic></highlight>. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> Example network <highlight><bold>112</bold></highlight> represents a broad range of private as well as public networks or interconnected networks, such as an enterprise network of a multi-national corporation, or the Internet. Networking nodes, such as clients <highlight><bold>108</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>108</bold></highlight><highlight><italic>n </italic></highlight>and server <highlight><bold>110</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>110</bold></highlight><highlight><italic>n </italic></highlight>represent a broad range of these elements known in the art, including individual user machines, e-commerce sites, and the like. As alluded to earlier, routing devices <highlight><bold>106</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>106</bold></highlight><highlight><italic>n </italic></highlight>represent a broad range of network trafficking equipment, including but are not limited to conventional routers, switches, gateways, hubs and the like. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> While for ease of understanding, only one director <highlight><bold>102</bold></highlight>, and a handful each of network nodes, clients <highlight><bold>108</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>108</bold></highlight><highlight><italic>n </italic></highlight>and servers <highlight><bold>110</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>110</bold></highlight><highlight><italic>n</italic></highlight>, routing devices <highlight><bold>106</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>106</bold></highlight><highlight><italic>n </italic></highlight>and sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n </italic></highlight>are included in the illustration, from the description to follow, those skilled in the art will appreciate that the present invention may be practiced with more than one director <highlight><bold>102</bold></highlight> as well as more or less network nodes, routing devices <highlight><bold>106</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>106</bold></highlight><highlight><italic>n </italic></highlight>and sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n</italic></highlight>. In particular, the present invention may also be practiced with one or more directors <highlight><bold>102</bold></highlight>. When more than one director <highlight><bold>102</bold></highlight> is employed, each director <highlight><bold>102</bold></highlight> may be assigned responsibility for a subset of sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n</italic></highlight>, and the directors <highlight><bold>102</bold></highlight> may relate to each other in a master/slave relationship, with one of the directors <highlight><bold>102</bold></highlight> serving as the &ldquo;master&rdquo; (and the others as &ldquo;slave&rdquo;), or as peers to one another or organized into an hierarchy, to collective discharge the responsibilities described below. </paragraph>
</section>
<section>
<heading lvl="1">Method </heading>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> Referring now also to <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, wherein a method view of the present invention, in accordance with one embodiment is shown. As illustrated, for a network link of interest, e.g. a network link on a critical path to a server subscriber of the services offered by director <highlight><bold>102</bold></highlight>, director <highlight><bold>102</bold></highlight> activates an initial subset of sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n </italic></highlight>to monitor and collect descriptive data for network traffic routed over the network link of interest and/or related links, block <highlight><bold>202</bold></highlight>. The selected ones of sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n </italic></highlight>may monitor the routing devices <highlight><bold>106</bold></highlight>* that are directly responsible for routing traffic onto the network link of interest, that is the routing devices <highlight><bold>106</bold></highlight>* to which the network link of interest is directly attached, and/or monitoring the routing devices <highlight><bold>106</bold></highlight>* that are indirectly responsible for routing traffic onto the network link of interest, that is the routing devices <highlight><bold>106</bold></highlight>* are remotely disposed, however by virtue of the destination of the traffic being routed, the traffic will eventually be routed over the network link of interest. The selected ones of sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n </italic></highlight>may also monitor related network links, which traffic patterns may be indicative of the nature of the network traffic being routed over the network link of interest. &lsqb;The asterisk employed in the afore description and the description to follow represents a &ldquo;wildcard&rdquo; portion for the reference, i.e. <highlight><bold>106</bold></highlight>* may be any one or more of <highlight><bold>106</bold></highlight><highlight><italic>a </italic></highlight>through <highlight><bold>106</bold></highlight><highlight><italic>n.&rsqb;</italic></highlight></paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> Periodically, or on demand, director <highlight><bold>102</bold></highlight> receives from the activated sensors <highlight><bold>106</bold></highlight>* descriptive data associated with the traffic of interest, i.e. network traffic routed over the network link of interest and/or related network links, block <highlight><bold>204</bold></highlight>. In response, for the illustrated embodiment, director <highlight><bold>102</bold></highlight> determines whether the network link of interest is at least suspicious of being abused or misused, block <highlight><bold>206</bold></highlight>. In various implementations, director <highlight><bold>102</bold></highlight> performs one or more analyses, using the received descriptive data, to determine whether the network link of interest is at least suspicious of being abused or misused. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> The descriptive data provided and the analyses performed are interdependent on each other. The precise nature of the descriptive data provided and the interdependent analyses performed are application dependent, i.e. dependent on the type and/or protocol of the network, and/or interest of the service subscriber. Examples of descriptive data include source addresses, destination addresses, packet types, packet sizes, volume of packets, and so forth. Volume of packets as well as other description data may also be stratified by packet types, addresses, and other stratification criteria. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> If it is determined that the network link of interest is at least suspicious of being abused or misused, director <highlight><bold>102</bold></highlight> further determines whether additional monitoring or data collection are needed before definitively concluding that the network link of interest is being misused, and imposes selective regulations to impact on network traffic accordingly, block <highlight><bold>208</bold></highlight>. If additional monitoring or data collection is &ldquo;preferred&rdquo;, director <highlight><bold>102</bold></highlight> launches additional selected ones of sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n </italic></highlight>to perform the additional monitoring to collect additional data to confirm that indeed the network link of interest is being misused, i.e. returning to block <highlight><bold>202</bold></highlight>. </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> If additional collection of data is not desired or eventually upon collection of additional data, director <highlight><bold>102</bold></highlight> becomes sufficiently confident that the network link of interest is being misused, at such time, director <highlight><bold>102</bold></highlight> determines the location or locations, and amount of regulations to impact on network traffic, to thwart the network link of interest from being misused, block <highlight><bold>210</bold></highlight>-<highlight><bold>212</bold></highlight>. </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> Back at block <highlight><bold>206</bold></highlight>, if director <highlight><bold>102</bold></highlight> is not at least suspicious of the network link of interest is being abused, director <highlight><bold>102</bold></highlight> further determines if any regulation is in effect, and if so, whether any of the regulation may be relaxed, block <highlight><bold>214</bold></highlight>. If not, the process continues back at block <highlight><bold>204</bold></highlight>, where director <highlight><bold>102</bold></highlight> receives additional report of descriptive data associated with the network traffic routed over the network link of interest and/or related links. From there, director conditionally repeats the earlier described analyses and related operations, blocks <highlight><bold>206</bold></highlight>-<highlight><bold>214</bold></highlight>. Eventually, director <highlight><bold>102</bold></highlight> determines at block <highlight><bold>214</bold></highlight> that at least a portion of the regulation in effect may be relaxed. At such time, director <highlight><bold>102</bold></highlight> determines the location or locations of de-regulation, and the amount of de-regulation at the respective selected locations, block <highlight><bold>216</bold></highlight>-<highlight><bold>218</bold></highlight>. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> The above described method is repeated by director <highlight><bold>102</bold></highlight> periodically for each of the network links of interest. Before proceeding to describe the present invention further, it should be noted that the phrase network link as used in the present application includes a virtual link as well as a physical link. A virtual link is a collection of physical links. When the network link is a virtual link, director <highlight><bold>102</bold></highlight> performs the analyses to be described based on the aggregated descriptive data of the corresponding physical links. </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> Further, distributed sensing and regulation of network traffic are the subject matters of co-pending U.S. patent applications, Ser. No. 09/631,898, entitled &ldquo;A Distributed Solution For Regulating Network Traffic&rdquo;, filed on Aug. 4, 2000, and Ser. No. 09/685,518, entitled &ldquo;Progressive and Distributed Regulation of Selected Network Traffic Destined for a Network Node&rdquo;, filed on Oct. 9, 2000, respectively. These applications are hereby fully incorporated by reference. </paragraph>
</section>
<section>
<heading lvl="1">Detection Analyses </heading>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> Continuing to refer to <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, as described earlier, in response to the receipt of a new &ldquo;round&rdquo; or set of descriptive data associated with network traffic relevant to the network link of interest (provided periodically or on demand), director <highlight><bold>102</bold></highlight> performs one or more analyses in determining whether the network link of interest is at least suspicious of being misused. </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> In one embodiment, director <highlight><bold>102</bold></highlight> determines whether a network link of interest is being misused by comparing the traffic pattern depicted by the provided descriptive data against a set of &ldquo;user-defined&rdquo; thresholds for a plurality of traffic pattern metrics. More specifically, director <highlight><bold>102</bold></highlight> concludes that the network link is at least suspicious of being misused if the traffic pattern metrics as measured by the received descriptive data exceed the &ldquo;user-defined&rdquo; thresholds. In this embodiment, the service subscriber quantitatively defines for director <highlight><bold>102</bold></highlight> the &ldquo;good&rdquo; traffic it expects on the network link of interest. The definition may be effectuated using any operational specification techniques known in the art. Traffics exceeding the defined level are deemed to be &ldquo;suspicious&rdquo;. For example, a subscriber may define that a network link of interest is to have no more than 50 Mb/s of DNS traffic and 1 Mb/s of TCP zone transfers. Thus, if director <highlight><bold>102</bold></highlight> receives reporting from sensors <highlight><bold>104</bold></highlight>* that infer a high volume of traffic for either one of these metrics, director <highlight><bold>102</bold></highlight> will at least deem the traffic being routed over the network link of interest as suspicious, and increase monitoring. If the excessive pattern persists for a predetermined period, director <highlight><bold>102</bold></highlight> will deem the network link as being misused, and regulate it accordingly. </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> In one embodiment focusing specifically on IP traffics, director <highlight><bold>102</bold></highlight> determines whether a network link of interest is being misused in accordance with whether unallocated IP addresses are present as source addresses of the traffic routed over the network link of interest. Such presence is likely, as an attacker often uses randomly generated addresses as source addresses of the attack traffic. Such randomly generated source addresses are likely to include source addresses that are unallocated. The allocated addresses may be pre-provided to director <highlight><bold>102</bold></highlight> (e.g. in the form of a database) or may be pre-determined by director <highlight><bold>102</bold></highlight> by systematically pinging trial addresses for responses (and saving the responded IP addresses in a database). </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> In one embodiment, director <highlight><bold>102</bold></highlight> determines whether a network link of interest is being misused in accordance with the distribution profile of the source addresses of the network traffic routed over the network link of interest. More specifically, director <highlight><bold>102</bold></highlight> considers the network link of interest is at least suspicious of being misused if the source addresses of the network traffic routed over the network link of interest are evenly layered on top of the normal traffic pattern, which typically involves only a relatively small subset of source addresses. Such characteristic is likely, as an attacker tends to use randomly generated addresses as source addresses of the attack traffic. Such randomly generated source addresses tend to evenly distributed. Any one of a number of statistical techniques known in the art may be employed to perform the above described distribution profile analysis. </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> In one embodiment, director <highlight><bold>102</bold></highlight> determines whether a network link of interest is being misused in accordance with the number and type of packets being sent to a network node or set of nodes from the same source address. More specifically, director <highlight><bold>102</bold></highlight> considers the network link of interest is at least suspicious of being misused if the number of packets being sent to a network node or set of nodes from the same source address for certain type of packets exceeds a predetermined small threshold. Such characteristic is likely in situations where certain servers, such as domain name servers, are being used to launch attack packets against a victim server. </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> In one embodiment, director <highlight><bold>102</bold></highlight> determines whether a network link of interest is being misused in accordance with the burstiness characteristics of the network traffic routed over the network link of interest, more specifically, the lack thereof. Such lack of burstiness characteristic is likely in traffic intensity, intensity per subnet, packet sizes, and/or number of packets per flow, if the traffics routed are attack traffic as opposed to normal traffic. Similarly, any one of a number of statistical techniques known in the art may be employed to perform the above described burstiness analysis. </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> In one embodiment, director <highlight><bold>102</bold></highlight> determines whether a network link of interest is being misused in accordance with a ratio of the packets flowing in one direction to packets flowing in the opposite direction. More specifically, director <highlight><bold>102</bold></highlight> considers the network link of interest is at least suspicious of being misused if the ratio is imbalanced, i.e. more than a predetermined threshold deviated from the numeric constant &ldquo;1&rdquo;. Again such uneven characteristic between the two directions is likely when the network traffics routed are attack traffic as opposed to normal network traffic. </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> In one embodiment, director <highlight><bold>102</bold></highlight> determines whether a network link of interest is being misused in accordance with a ratio of a first packet type to a second packet type. More specifically, director <highlight><bold>102</bold></highlight> considers the network link of interest is at least suspicious of being misused if the ratio is imbalanced, i.e. more than a predetermined threshold deviated from a target ratio. Such uneven characteristic between the selected pairs of packet types may be indicative of attack traffic. For example, in the case of TCP/IP, during normal operation, TCP ACK packets should be about half of data packets. If the ratio is substantially different from the target ratio of 0.5, it is likely the abnormal traffics are attack traffic. </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> In one embodiment, director <highlight><bold>102</bold></highlight> determines whether a network link of interest is being misused in accordance with response traffics. More specifically, director <highlight><bold>102</bold></highlight> considers the network link of interest is at least suspicious of being misused if an excess amount of the traffic being routed is recognizable error packets. For example, in the case of TCP/IP traffic, if an excessive amount of RST packets are being routed, which may be indicative of an excess amount of ACK packets being sent without the corresponding SYN packets. </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> When multiple analyses are employed for the decision making process, a weighted approach may be employed to give different weights to the results of the different analyses in their contributions towards the ultimate conclusion as to whether a network link of interest is at least suspicious of being misused. In alternate embodiment, a more sophisticated modeling approach may be employed instead. That is, the results of the analyses are provided as inputs to the model that models the expected normal behavior of the network links of interest, and predicts whether abnormal behavior are about to occur or occurring. </paragraph>
</section>
<section>
<heading lvl="1">Sensors </heading>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> Referring back to <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, as described earlier, sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n </italic></highlight>are employed to monitor and collect descriptive data associated with network traffic routed over the network links of interest. As described in the incorporated by reference application, sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n </italic></highlight>may be externally disposed and correspondingly coupled to and monitor routing devices <highlight><bold>106</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>106</bold></highlight><highlight><italic>n</italic></highlight>. Alternatively, sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n </italic></highlight>may individually or collectively monitor and report on the network traffic routed through more than one routing device, as opposed to the corresponding configuration. In yet other embodiments, some or all of sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n </italic></highlight>may be integrally disposed within routing devices <highlight><bold>106</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>106</bold></highlight><highlight><italic>h </italic></highlight>instead. Sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n</italic></highlight>, whether externally disposed or integrally disposed, may be coupled to director <highlight><bold>102</bold></highlight> using any one of a number of communication links known in the art, such as modem links over conventional phone lines, Digital Subscriber Lines (DSL), Integrated Service Digital Network (ISDN) connections, Asynchronous Transfer Mode (ASM) links, Frame Relay connections, and the like. </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> In one embodiment, sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n </italic></highlight>use an access control list (ACL), and commands associated therewith, such as &ldquo;access-list&rdquo; and &ldquo;show access-list&rdquo; to gather up the relevant data. Similarly, in one embodiment, sensors <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>-<highlight><bold>104</bold></highlight><highlight><italic>n </italic></highlight>use interface related commands such as &ldquo;show interface rate-limit&rdquo; and &ldquo;rate-limit&rdquo; to regulate and de-regulate an interface. These commands, including their operations and constitutions, are known in the art. See product literatures from routing device manufacturers, such as CISCO Systems, Inc of San Jose, Calif. </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> In alternate embodiments, for certain routing devices, if supported, the relevant data gathered may also include &ldquo;netflow&rdquo; data. In other embodiments, the relevant data may also be obtained through known network management services, such as Simple Network Management Protocol (SNMP), Remote Monitoring (RMON), port mirroring, or packet sampling (if one or more of these service are supported by the routing devices). </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> For further details, refer to the specification of incorporated by reference application Ser. No. 09/631,898. </paragraph>
</section>
<section>
<heading lvl="1">Director </heading>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 3</cross-reference>, wherein a functional view of the director, in accordance with one embodiment is shown. As illustrated, director <highlight><bold>102</bold></highlight> includes send/receive function <highlight><bold>302</bold></highlight>, analyzer <highlight><bold>304</bold></highlight>, and regulator <highlight><bold>306</bold></highlight>, operatively coupled to each other as shown. Send/receive function <highlight><bold>302</bold></highlight> is employed to receive network traffic data (e.g. reported by the distributively disposed sensors), and to send monitor instructions to the sensing devices as well as regulation/de-regulation instructions to the routing devices to be regulated (e.g. through the distributively disposed sensors). Analyzer <highlight><bold>304</bold></highlight> analyzes the network traffic data reported to determine if a network link of interest is at least suspicious of being misused, and alerts regulator <highlight><bold>306</bold></highlight> accordingly. Regulator <highlight><bold>306</bold></highlight> is used to determine where and the specific regulation/de-regulation actions to be taken. </paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> FIGS. <highlight><bold>4</bold></highlight>-<highlight><bold>6</bold></highlight> illustrate the operational flow of the relevant aspects of the send/receive, analyzer and regulation functions <highlight><bold>302</bold></highlight>-<highlight><bold>306</bold></highlight>, in accordance with one embodiment each. As illustrated in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>, for the send/receive function, upon start up, it determines if there are network traffic data to be received (e.g. from the distributively disposed sensors), block <highlight><bold>402</bold></highlight>. If there are, send/receive function <highlight><bold>302</bold></highlight> receives the network traffic data being reported accordingly. If there are not, send/receive function <highlight><bold>302</bold></highlight> determines if there are monitor or regulation/de-regulation instructions to be sent (e.g. to the distributively disposed sensors). If there are, send/receive function <highlight><bold>302</bold></highlight> sends the monitor or regulation/regulation instructions accordingly. If there are not, send/receive function <highlight><bold>302</bold></highlight> returns to block <highlight><bold>402</bold></highlight> to determine if there are data to be received again. </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> As illustrated in <cross-reference target="DRAWINGS">FIG. 5</cross-reference>, upon start up, analyzer <highlight><bold>304</bold></highlight> selects a network link of interest to be analyzed, block <highlight><bold>502</bold></highlight>. Analyzer <highlight><bold>304</bold></highlight> analyzes the received descriptive data, performing one or more of the earlier described analyses, block <highlight><bold>504</bold></highlight>. Based on the results of the analysis, analyzer <highlight><bold>304</bold></highlight> determines if more data or to be collected, in particular, whether additional sensors <highlight><bold>104</bold></highlight>* are to be activated for the additional collection of network traffic data, block <highlight><bold>506</bold></highlight>. If additional sensors <highlight><bold>104</bold></highlight>* are to be activated for the additional collection of network traffic data, analyzer <highlight><bold>304</bold></highlight> selects and activates selected ones of the sensors accordingly, block <highlight><bold>508</bold></highlight>. </paragraph>
<paragraph id="P-0048" lvl="0"><number>&lsqb;0048&rsqb;</number> If sufficient number of sensors <highlight><bold>104</bold></highlight>* have been activated for the additional collection of network traffic data, analyzer <highlight><bold>304</bold></highlight> further determines if network traffic are to be regulated, further regulated or de-regulated, block <highlight><bold>510</bold></highlight>. If not, analyzer <highlight><bold>304</bold></highlight> returns to block <highlight><bold>504</bold></highlight>, and continues operation from there. If network traffic is to be regulated, further regulated or de-regulated, analyzer <highlight><bold>304</bold></highlight> notifies regulator <highlight><bold>306</bold></highlight> accordingly, block <highlight><bold>512</bold></highlight>. </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> Analyzer <highlight><bold>304</bold></highlight> repeats this process for each network link of interest to be &ldquo;protected&rdquo; from misuse. </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> As illustrated in <cross-reference target="DRAWINGS">FIG. 6</cross-reference>, upon receipt of an alert, regulator <highlight><bold>306</bold></highlight> determines if the alert is for (further) regulation or de-regulation, block <highlight><bold>602</bold></highlight>. If the alert is for (further) regulation, regulator <highlight><bold>306</bold></highlight> determines the routing devices to be regulated, block <highlight><bold>606</bold></highlight>. Further, regulator <highlight><bold>306</bold></highlight> determines the regulation to be applied, block <highlight><bold>608</bold></highlight>. Examples of regulations include but are not limited to bandwidth allocation, rate limiting, packet filtering, giving priority to &ldquo;good&rdquo; traffics, and so forth. Note that the regulations may negatively impact the &ldquo;good&rdquo; traffics, because as long as the &ldquo;bad&rdquo; traffics are more negatively impacted, the regulations would still be useful to &ldquo;good&rdquo; traffics. </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> Upon making these determinations, regulator <highlight><bold>306</bold></highlight> provides the regulation instructions to the routing devices to be regulated accordingly (e.g. through the sensors), block <highlight><bold>614</bold></highlight>. On the other hand, if the alert is for de-regulation, regulator <highlight><bold>306</bold></highlight> determines the location or locations for de-regulation, <highlight><bold>610</bold></highlight>. Further, regulator <highlight><bold>306</bold></highlight> determines the level of de-regulation (bandwidth restoration, rate limit relaxation etc.), block <highlight><bold>612</bold></highlight>. Upon making these determinations, regulator <highlight><bold>306</bold></highlight> provides the de-regulation instructions to the routing devices to be de-regulated accordingly (e.g. through the sensors), block <highlight><bold>614</bold></highlight>. In one embodiment, regulator <highlight><bold>306</bold></highlight> regulates and de-regulates in a progressive manner as described in incorporated by reference application Ser. No. 09/685,518. </paragraph>
</section>
<section>
<heading lvl="1">Example Host Computer System </heading>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> illustrates an example computer system suitable for use as either a host to a software implementation of a sensor, or the director in accordance with one embodiment. As shown, computer system <highlight><bold>700</bold></highlight> includes one or more processors <highlight><bold>702</bold></highlight> (typically depending on whether it is used as host to sensor or the director), and system memory <highlight><bold>704</bold></highlight>. Additionally, computer system <highlight><bold>700</bold></highlight> includes mass storage devices <highlight><bold>706</bold></highlight> (such as diskette, hard drive, CDROM and so forth), input/output devices <highlight><bold>708</bold></highlight> (such as keyboard, cursor control and so forth) and communication interfaces <highlight><bold>710</bold></highlight> (such as network interface cards, modems and so forth). The elements are coupled to each other via system bus <highlight><bold>712</bold></highlight>, which represents one or more buses. In the case of multiple buses, they are bridged by one or more bus bridges (not shown). Each of these elements performs its conventional functions known in the art. In particular, system memory <highlight><bold>704</bold></highlight> and mass storage <highlight><bold>706</bold></highlight> are employed to store a working copy and a permanent copy of the programming instructions implementing the sensor and/or director teachings of the present invention. The permanent copy of the programming instructions may be loaded into mass storage <highlight><bold>706</bold></highlight> in the factory, or in the field, as described earlier, through a distribution medium (not shown) or through communication interface <highlight><bold>710</bold></highlight> (from a distribution server (not shown). The constitution of these elements <highlight><bold>702</bold></highlight>-<highlight><bold>712</bold></highlight> are known, and accordingly will not be further described. </paragraph>
</section>
<section>
<heading lvl="1">Conclusion and Epilogue </heading>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> Thus, it can be seen from the above descriptions, a novel method and apparatus for detecting misuse of a network has been described. The novel scheme decrease the likelihood of the network links being misused to launch attacks or otherwise victimize a server node or a set of server nodes. </paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> While the present invention has been described referencing the illustrated and above enumerated embodiments, the present invention is not limited to these described embodiments. Numerous modification and alterations may be made, consistent with the scope of the present invention as set forth in the claims to follow. Thus, the above described embodiments are merely illustrative, and not restrictive on the present invention. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is claimed is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. A networking method comprising: 
<claim-text>receiving threshold specifications for a plurality of network traffic metrics defining an expected network traffic pattern for one or more network links relevant to a network link of interest; </claim-text>
<claim-text>receiving network traffic data associated with said network traffic metrics; and </claim-text>
<claim-text>determining whether said network link of interest is being misused based on said received network traffic data and said received threshold specifications for said network traffic metrics defining said expected network traffic pattern for said one or more network links relevant to said network link of interest. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said receiving of threshold specifications comprises receiving threshold specifications for a plurality of network traffic metrics for a plurality of network traffic types. </claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein 
<claim-text>at least one of said network links is a virtual network link comprising a plurality of physical network links; </claim-text>
<claim-text>said receiving of threshold specifications comprises receiving threshold specifications for said plurality of network traffic metrics for said virtual network link; </claim-text>
<claim-text>said receiving of network traffic data comprises receiving network traffic data associated with said network traffic metrics for said plurality of physical network links; and </claim-text>
<claim-text>said determining comprises aggregating said received network traffic data related to said physical network links to generate network traffic data associated with said network traffic metrics for said virtual network link. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the method further comprises activating/deactivating monitoring of network traffic routed over one or more network links relevant to said network link of interest based at least in part on the result of said determining. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the method further comprises activating/deactivating regulation of network traffic at one or more network nodes based at least in part on the result of said determining. </claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the method further comprises repeating said receiving of network traffic data, and said determining, and automatically adjusting said received threshold specifications to be employed in a next repetition of said determining, based at least in part on the result of one or more prior performance of said determining. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. An apparatus comprising 
<claim-text>storage medium having stored therein executable instructions designed to implement a plurality of network link misuse determination functions including 
<claim-text>a receiving function to receive threshold specifications for a plurality of network traffic metrics defining an expected network traffic pattern for one or more network links relevant to a network link of interest, </claim-text>
<claim-text>a determination function to receive network traffic data associated with said network traffic metrics, and in response, determine whether said network link of interest is being misused based on said received network traffic data and said received threshold specifications for said network traffic metrics defining said expected network traffic pattern for said network link of interest; and </claim-text>
</claim-text>
<claim-text>one or more processors coupled to the storage medium to execute the instructions. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference>, wherein said receiving function is designed to receive threshold specifications for a plurality of network traffic metrics for a plurality of network traffic types. </claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference>, wherein 
<claim-text>at least one of said network links is a virtual network link comprising a plurality of physical network links; </claim-text>
<claim-text>said receiving function is designed to receive threshold specifications for said plurality of network traffic metrics for said virtual network link; </claim-text>
<claim-text>said determining function is designed to receive network traffic data associated with said network traffic metrics for said plurality of physical network links and in response, aggregate said received network traffic data related to said physical network links to generate network traffic data associated with said network traffic metrics for said virtual network link. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference>, wherein said determining function is further designed to activate/deactivate monitoring of network traffic relevant to said network link of interest based at least in part on the result of said determining function. </claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference>, wherein the instructions are further designed to implement a regulation function that activates/deactivates regulation of selected network traffic at one or more network nodes based at least in part on the result of said determining function. </claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference>, wherein the instructions further implement a control function to control said second receiving function and said determining function to repeat said receiving of network traffic data, and said determining of misuse, and to automatically adjust said received threshold specifications to be employed by said determining function in a next repetition of said determining, based at least in part on the result of one or more prior performance of said determining. </claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. A networking method comprising: 
<claim-text>establishing a database of allocated IP addresses; </claim-text>
<claim-text>receiving source addresses of network traffic routed over one or more network links relevant to a network link of interest; and </claim-text>
<claim-text>determining whether said network link of interest is being misused based on said received source addresses and said established database of allocated IP addresses. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 13</dependent-claim-reference>, wherein said establishing comprises systematically pinging IP addresses for replies. </claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 13</dependent-claim-reference>, wherein the method further comprises activating/deactivating monitoring of network traffic to be routed over one or more network links relevant to said network link of interest based at least in part on the result of said determining. </claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 13</dependent-claim-reference>, wherein the method further comprises activating/deactivating regulation of network traffic at one or more network nodes based at least in part on the result of said determining. </claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. An apparatus comprising 
<claim-text>storage medium having stored therein executable instructions designed to implement a plurality of network link misuse determination functions including 
<claim-text>a database establishing function to establish a database of allocated IP addresses, </claim-text>
<claim-text>a receiving function to receive source addresses of network traffic routed over one or more network links relevant to a network link of interest, and </claim-text>
<claim-text>a determination function to determine if said network link of interest is being misused based on said established database of IP addresses and said received source addresses of network traffic routed over said one or more network links relevant to said network link of interest; and </claim-text>
</claim-text>
<claim-text>one or more processors coupled to the storage medium to execute the instructions. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00011">claim 17</dependent-claim-reference>, wherein said database establishing function is designed to establish said database by systematically pinging IP addresses for replies. </claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00011">claim 17</dependent-claim-reference>, wherein said receiving function is further designed to activate/deactivate monitoring of network traffic to be routed over one or more network links relevant to said network link of interest based at least in part on the result of said determining function. </claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00011">claim 17</dependent-claim-reference>, wherein the instructions are further designed to implement a regulation function that activates/deactivates regulation of selected network traffic at one or more network nodes based at least in part on the result of said determining function. </claim-text>
</claim>
<claim id="CLM-00021">
<claim-text><highlight><bold>21</bold></highlight>. A networking method comprising: 
<claim-text>receiving source addresses of network traffic routed over one or more network links relevant to a network link of interest; </claim-text>
<claim-text>generating a distribution profile of said source addresses; </claim-text>
<claim-text>determining one or more characteristic measures for said distribution profile; and </claim-text>
<claim-text>determining whether said network link of interest is being misused based on said one or more characteristic measures of said distribution profile. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00022">
<claim-text><highlight><bold>22</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00022">claim 21</dependent-claim-reference>, wherein said generating comprises generating said distribution profile for a subnet range. </claim-text>
</claim>
<claim id="CLM-00023">
<claim-text><highlight><bold>23</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00022">claim 21</dependent-claim-reference>, wherein the method further comprises activating/deactivating monitoring of network traffic to be routed over one or more network links relevant to said network link of interest based at least in part on the result of said determining. </claim-text>
</claim>
<claim id="CLM-00024">
<claim-text><highlight><bold>24</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00022">claim 21</dependent-claim-reference>, wherein the method further comprises activating/deactivating regulation of network traffic at one or more network nodes based at least in part on the result of said determining. </claim-text>
</claim>
<claim id="CLM-00025">
<claim-text><highlight><bold>25</bold></highlight>. An apparatus comprising 
<claim-text>storage medium having stored therein executable instructions designed to implement a plurality of network link misuse determination functions including 
<claim-text>a receiving function to receive source addresses of network traffic routed over one or more network links relevant to a network link of interest, </claim-text>
<claim-text>a generation function to generate a distribution profile of said received source addresses, </claim-text>
<claim-text>a first determination function to determine one or more characteristic measures for said generated distribution profile, and </claim-text>
<claim-text>a second determination function to determine whether said network link of interest is being misused based on said one or more determined characteristic measures of said distribution profile; and </claim-text>
</claim-text>
<claim-text>one or more processors coupled to the storage medium to execute the instructions. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00026">
<claim-text><highlight><bold>26</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00022">claim 25</dependent-claim-reference>, wherein said generation function is designed to accept a subnet range specification, and generates said distribution profile for said specified subnet range. </claim-text>
</claim>
<claim id="CLM-00027">
<claim-text><highlight><bold>27</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00022">claim 25</dependent-claim-reference>, wherein said receiving function is further designed to activate/deactivate monitoring of network traffic to be routed over one or more network links relevant to said network link of interest based at least in part on the result of said determining function. </claim-text>
</claim>
<claim id="CLM-00028">
<claim-text><highlight><bold>28</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00022">claim 25</dependent-claim-reference>, wherein the instructions are further designed to implement a regulation function that activates/deactivates regulation of selected network traffic at one or more network nodes based at least in part on the result of said determining function. </claim-text>
</claim>
<claim id="CLM-00029">
<claim-text><highlight><bold>29</bold></highlight>. A networking method comprising: 
<claim-text>receiving source addresses, destination addresses and traffic types of network traffic routed over one or more network links relevant to a network link of interest; </claim-text>
<claim-text>determining a transmission frequency for a type of network traffic transmitted from a source address to one or more destination addresses; and </claim-text>
<claim-text>determining whether said network link of interest is being misused based on whether said determined transmission frequency is consistent with said network traffic type. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00030">
<claim-text><highlight><bold>30</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00022">claim 29</dependent-claim-reference>, wherein the method further comprises activating/deactivating monitoring of network traffic to be routed over one or more network links relevant to said network link of interest based at least in part on the result of said determining. </claim-text>
</claim>
<claim id="CLM-00031">
<claim-text><highlight><bold>31</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00022">claim 29</dependent-claim-reference>, wherein the method further comprises activating/deactivating regulation of network traffic at one or more network nodes based at least in part on the result of said determining. </claim-text>
</claim>
<claim id="CLM-00032">
<claim-text><highlight><bold>32</bold></highlight>. An apparatus comprising 
<claim-text>storage medium having stored therein executable instructions designed to implement a plurality of network link misuse determination functions including 
<claim-text>a receiving function to receive source addresses, destination addresses and traffic types of network traffic routed over one or more network links relevant to a network link of interest, </claim-text>
<claim-text>a first determination function to determine a transmission frequency for a type of network traffic transmitted from a source address to one or more destination addresses, and </claim-text>
<claim-text>a second determination function to determine whether said network link of interest is being misused based on whether said determined transmission frequency is consistent with said network traffic type; and </claim-text>
</claim-text>
<claim-text>one or more processors coupled to the storage medium to execute the instructions. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00033">
<claim-text><highlight><bold>33</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00033">claim 32</dependent-claim-reference>, wherein said receiving function is further designed to activate/deactivate monitoring of network traffic to be routed over one or more network links relevant to said network link of interest based at least in part on the result of said determining function. </claim-text>
</claim>
<claim id="CLM-00034">
<claim-text><highlight><bold>34</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00033">claim 32</dependent-claim-reference>, wherein the instructions are further designed to implement a regulation function that activates/deactivates regulation of selected network traffic at one or more network nodes based at least in part on the result of said determining function. </claim-text>
</claim>
<claim id="CLM-00035">
<claim-text><highlight><bold>35</bold></highlight>. A networking method comprising: 
<claim-text>receiving descriptive data associated with network traffic routed over one or more network links relevant to a network link of interest; </claim-text>
<claim-text>generating at least one measurement metric that normally exhibits a bursty characteristic during normal operation; and </claim-text>
<claim-text>determining whether said network link of interest is being misused based on whether said at least one generated measurement metric exhibits said bursty characteristic. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00036">
<claim-text><highlight><bold>36</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00033">claim 35</dependent-claim-reference>, wherein said at least one generated measurement metric comprises at least a selected one of traffic intensity, intensity per subnet, packet sizes and packets per flow. </claim-text>
</claim>
<claim id="CLM-00037">
<claim-text><highlight><bold>37</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00033">claim 35</dependent-claim-reference>, wherein the method further comprises activating/deactivating monitoring of network traffic to be routed over one or more network links relevant to said network link of interest based at least in part on the result of said determining. </claim-text>
</claim>
<claim id="CLM-00038">
<claim-text><highlight><bold>38</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00033">claim 35</dependent-claim-reference>, wherein the method further comprises activating/deactivating regulation of network traffic at one or more network nodes based at least in part on the result of said determining. </claim-text>
</claim>
<claim id="CLM-00039">
<claim-text><highlight><bold>39</bold></highlight>. An apparatus comprising 
<claim-text>storage medium having stored therein executable instructions designed to implement a plurality of network link misuse determination functions including 
<claim-text>a generator function to receive descriptive data associated with network traffic routed over one or more network links relevant to a network link of interest, and in response, generate at least one measurement metric that normally exhibits a bursty characteristic during normal operation, and </claim-text>
<claim-text>a determination function to determine whether said network link of interest is being misused based on whether said at least one generated measurement metric exhibits said bursty characteristic; and </claim-text>
</claim-text>
<claim-text>one or more processors coupled to the storage medium to execute the instructions. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00040">
<claim-text><highlight><bold>40</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00033">claim 39</dependent-claim-reference>, wherein said at least one generated measurement metric comprises at least a selected one of traffic intensity, intensity per subnet, packet sizes and packets per flow. </claim-text>
</claim>
<claim id="CLM-00041">
<claim-text><highlight><bold>41</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00033">claim 39</dependent-claim-reference>, wherein said receiving function is further designed to activate/deactivate monitoring of network traffic to be routed over one or more network links relevant to said network link of interest based at least in part on the result of said determining function. </claim-text>
</claim>
<claim id="CLM-00042">
<claim-text><highlight><bold>42</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00033">claim 39</dependent-claim-reference>, wherein the instructions are further designed to implement a regulation function that activates/deactivates regulation of selected network traffic at one or more network nodes based at least in part on the result of said determining function. </claim-text>
</claim>
<claim id="CLM-00043">
<claim-text><highlight><bold>43</bold></highlight>. A networking method comprising: 
<claim-text>receiving descriptive data associated with network traffic flows routed over one or more network links relevant to a network link of interest; </claim-text>
<claim-text>generating a ratio for a selected one of packets flowing in a first direction to packets flowing in a second direction and packets of a first type to packets of a second type, using said received descriptive data; and </claim-text>
<claim-text>determining whether said network link of interest is being misused based at least in part on said generated ratio. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00044">
<claim-text><highlight><bold>44</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00044">claim 43</dependent-claim-reference>, wherein the method further comprises activating/deactivating distributed monitoring of network traffic to be routed over one or more network links relevant to said network link of interest based at least in part on the result of said determining. </claim-text>
</claim>
<claim id="CLM-00045">
<claim-text><highlight><bold>45</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00044">claim 43</dependent-claim-reference>, wherein the method further comprises activating/deactivating regulation of network traffic at one or more network nodes based at least in part on the result of said determining. </claim-text>
</claim>
<claim id="CLM-00046">
<claim-text><highlight><bold>46</bold></highlight>. An apparatus comprising 
<claim-text>storage medium having stored therein executable instructions designed to implement a plurality of network link misuse determination functions including 
<claim-text>a generation function to receive descriptive data associated with network traffic flows routed over one or more network links relevant to a network link of interest and in response, generate a ratio for a selected one of packets flowing in a first direction to packets flowing in a second direction and packets of a first type to packets to a second type, using said received descriptive data, and </claim-text>
<claim-text>a determination function to determine whether said network link of interest is being misused based at least in part on said generated ratio; and </claim-text>
</claim-text>
<claim-text>one or more processors coupled to the storage medium to execute the instructions. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00047">
<claim-text><highlight><bold>47</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00044">claim 46</dependent-claim-reference>, wherein said receiving function is further designed to activate/deactivate monitoring of network traffic to be routed over one or more network links relevant to said network link of interest based at least in part on the result of said determining function. </claim-text>
</claim>
<claim id="CLM-00048">
<claim-text><highlight><bold>48</bold></highlight>. The apparatus of <dependent-claim-reference depends_on="CLM-00044">claim 46</dependent-claim-reference>, wherein the instructions are further designed to implement a regulation function that activates/deactivates regulation of selected network traffic at one or more network nodes based at least in part on the result of said determining function.</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>1</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030002436A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030002436A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030002436A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030002436A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030002436A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030002436A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030002436A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
