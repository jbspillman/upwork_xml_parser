<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030002419A1-20030102-D00000.TIF SYSTEM "US20030002419A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00001.TIF SYSTEM "US20030002419A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00002.TIF SYSTEM "US20030002419A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00003.TIF SYSTEM "US20030002419A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00004.TIF SYSTEM "US20030002419A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00005.TIF SYSTEM "US20030002419A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00006.TIF SYSTEM "US20030002419A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00007.TIF SYSTEM "US20030002419A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00008.TIF SYSTEM "US20030002419A1-20030102-D00008.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00009.TIF SYSTEM "US20030002419A1-20030102-D00009.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00010.TIF SYSTEM "US20030002419A1-20030102-D00010.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00011.TIF SYSTEM "US20030002419A1-20030102-D00011.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00012.TIF SYSTEM "US20030002419A1-20030102-D00012.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00013.TIF SYSTEM "US20030002419A1-20030102-D00013.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00014.TIF SYSTEM "US20030002419A1-20030102-D00014.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00015.TIF SYSTEM "US20030002419A1-20030102-D00015.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00016.TIF SYSTEM "US20030002419A1-20030102-D00016.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00017.TIF SYSTEM "US20030002419A1-20030102-D00017.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00018.TIF SYSTEM "US20030002419A1-20030102-D00018.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00019.TIF SYSTEM "US20030002419A1-20030102-D00019.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00020.TIF SYSTEM "US20030002419A1-20030102-D00020.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00021.TIF SYSTEM "US20030002419A1-20030102-D00021.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00022.TIF SYSTEM "US20030002419A1-20030102-D00022.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00023.TIF SYSTEM "US20030002419A1-20030102-D00023.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00024.TIF SYSTEM "US20030002419A1-20030102-D00024.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00025.TIF SYSTEM "US20030002419A1-20030102-D00025.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00026.TIF SYSTEM "US20030002419A1-20030102-D00026.TIF" NDATA TIF>
<!ENTITY US20030002419A1-20030102-D00027.TIF SYSTEM "US20030002419A1-20030102-D00027.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030002419</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10177670</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20020624</filing-date>
</domestic-filing-data>
<foreign-priority-data>
<priority-application-number>
<doc-number>2001-194819(P)</doc-number>
</priority-application-number>
<filing-date>20010627</filing-date>
<country-code>JP</country-code>
</foreign-priority-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>G11B007/005</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>369</class>
<subclass>059220</subclass>
</uspc>
</classification-us-primary>
</classification-us>
<title-of-invention>Optical disk apparatus permitting high-precision Viterbi decoding</title-of-invention>
</technical-information>
<inventors>
<first-named-inventor>
<name>
<given-name>Toshitaka</given-name>
<family-name>Kuma</family-name>
</name>
<residence>
<residence-non-us>
<city>Anpachi-gun</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Hiroshi</given-name>
<family-name>Watanabe</family-name>
</name>
<residence>
<residence-non-us>
<city>Anpachi-gun</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<assignee>
<organization-name>Sanyo Electric Co., Ltd.</organization-name>
<address>
<city>Moriguchi-shi</city>
<country>
<country-code>JP</country-code>
</country>
</address>
<assignee-type>03</assignee-type>
</assignee>
<correspondence-address>
<name-1>ARMSTRONG,WESTERMAN &amp; HATTORI, LLP</name-1>
<name-2></name-2>
<address>
<address-1>1725 K STREET, NW.</address-1>
<address-2>SUITE 1000</address-2>
<city>WASHINGTON</city>
<state>DC</state>
<postalcode>20006</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">The optical disk apparatus is provided with a Viterbi decoder and an expected value correction circuit. The branch metric operation unit calculates first, second and third errors between sampling data and expected values, and outputs them to the expected value correction circuit. The expected value correction circuit extracts the sampling data in a region where its variation is small based on the first, second and third errors, calculates the average values of the extracted sampling data to correct the first, second and third expected values, and outputs the corrected expected values to the branch metric operation unit. The Viterbi decoder performs Viterbi decoding of the sampling data based on the first, second and third corrected expected values. Thus, high-precision Viterbi decoding is permitted even if the amplitude value of the reproduction signal varies. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> 1. Field of the Invention </paragraph>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> The present invention relates to optical disk apparatuses reproducing signals from optical disks, and more particularly to an optical disk apparatus which reproduces signals from an optical disk by accurately converting sampling data of the reproduction signal from multilevel data to binary data even if the reproduction signal varies in amplitude. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> 2. Description of the Background Art </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> Recently, with an increase in recording density of digital disks such as magneto-optical disks, optical disks and phase change disks, a partial response (PR) coding method has been widely used which utilizes intersymbol interference by matching transmission signals with transmission path characteristics. Viterbi decoding (maximum likelihood decoding) is known as a decoding method of the PR coding. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> In the Viterbi decoding for a conventional optical disk apparatus, a radio frequency (RF) signal being a reproduction signal obtained from an optical disk is sampled, and an error or square error (branch metric) between the sampled digital data and an expected value is calculated. From this square error, an accumulative error (path metric) is calculated for each data stream, and the data stream whose accumulative error is the smallest is selected as the most likely data stream. The RF signal converted to digital data is then converted from multilevel data to binary data. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> In the conventional optical disk apparatus, however, in the case where the expected value for use in the Viterbi decoding is fixed to a constant value, the branch metric or the path metric, which is calculated based on the square error between the amplitude of the RF signal and the expected value of the amplitude, would not always allow precise Viterbi decoding, due to variation in amplitude of the RF signal attributable to unevenness in rotation speed, eccentricity or tilt of the digital disk. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> Japanese Patent Laying-Open No. 9-320206 discloses a method for performing accurate Viterbi decoding despite such variation in amplitude of the RF signal, wherein a reproduction signal obtained from an optical disk is sampled and, from among the sampled data, a zero-cross sample value located nearest the zero-cross point and values preceding and succeeding the zero-cross sample value are employed as expected values in a Viterbi decoder. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> According to the method described in the Japanese Patent Laying-Open No. 9-320206, however, the sampling values in the region where the reproduction signal obtained from the optical disk exhibits largest variation in amplitude have been used as the expected values. This hinders stable setting of the expected values, and as a result, Viterbi decoding cannot be performed with high accuracy. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> Based on the foregoing, an object of the present invention is to provide an optical disk apparatus which ensures accurate Viterbi decoding despite variation in amplitude value of a reproduction signal. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> According to the present invention, the optical disk apparatus includes: an optical pickup which irradiates laser light onto an optical disk and detects its reflected light; a sampling circuit which samples a reproduction signal detected by the optical pickup in synchronization with a reference clock and outputs sampling values; an expected value correction circuit which corrects an expected value for use in converting the sampling value from multilevel data to binary data using the sampling values in a region where variation is small; and a Viterbi decoding circuit which converts the sampling value from multilevel data to binary data such that an error between the corrected expected value input from the expected value correction circuit and the sampling value becomes small. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> Preferably, the Viterbi decoding circuit calculates an error between the sampling value and an expected value and outputs the error to the expected value correction circuit, and the expected value correction circuit corrects the expected value based on the error to obtain the corrected expected value, and outputs the corrected expected value to the Viterbi decoding circuit. </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> Preferably, the expected value includes a first expected value greater than a direct-current component of the reproduction signal, a second expected value located in a symmetrical position to the first expected value with respect to the direct-current component of the reproduction signal, and a third expected value equal to the direct-current component of the reproduction signal. The expected value correction circuit corrects the first and second expected values, and outputs, to the Viterbi decoding circuit, a first corrected expected value obtained by correcting the first expected value and a second corrected expected value obtained by correcting the second expected value. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> Preferably, the Viterbi decoding circuit calculates a first error between the first expected value and the sampling value, a second error between the second expected value and the sampling value and a third error between the third expected value and the sampling value, and outputs them to the expected value correction circuit. The expected value correction circuit includes: a signal generating circuit which detects a smallest error from among absolute values of the first, second and third errors, and generates, when the detected error is the first error, a first extract signal for extracting the sampling values corresponding to a region where the first error holds a minimal value, and generates, when the detected error is the second error, a second extract signal for extracting the sampling values corresponding to a region where the second error holds a minimal value; an averaging circuit which extracts the sampling values in the region where the variation is small based on the first or second extract signal, and calculates an average value of the extracted sampling values; and an expected value operation circuit which determines the first corrected expected value based on the average value from the averaging circuit and calculates the second corrected expected value based on the first corrected expected value and the third expected value. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> Preferably, the signal generating circuit includes: a select signal generating circuit which calculates a difference between the third error at a first timing and the third error at a second timing that is one cycle later than the first timing, and generates an error select signal having an activated level when the difference is smaller than a reference value and having an inactivated level when the difference is greater than the reference value; an absolute value operation circuit which calculates absolute values of the first, second and third errors; a minimal error determination circuit which detects a minimal value from among the three absolute values calculated by the absolute value operation circuit, and generates, when the detected minimal value is the absolute value of the first error, a first error minimal signal having an activated level corresponding to a time period where the first error holds a minimal value, and generates, when the detected minimal value is the absolute value of the second error, a second error minimal signal having an activated level corresponding to a time period where the second error holds a minimal value; and an AND gate which carries out logical AND of the first or second error minimal signal and the error select signal to generate the first or second extract signal. The averaging circuit latches the third error in synchronization with an activated level of the first or second extract signal, and calculates an average of the average value of the third error at the first timing and the third error at the second timing. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> Preferably, the Viterbi decoding circuit calculates a first error between the first expected value and the sampling value, a second error between the second expected value and the sampling value, and a third error between the third expected value and the sampling value, and outputs them to the expected value correction circuit. The expected value correction circuit includes: a signal generating circuit which detects a smallest error from among absolute values of the first, second and third errors, and generates, when the detected error is the first error, a first extract signal for extracting the sampling values corresponding to a central portion of a region where the first error holds a minimal value, and generates, when the detected error is the second error, a second extract signal for extracting the sampling values corresponding to a central portion of a region where the second error holds a minimal value; an averaging circuit which extracts the sampling values based on the first or second extract signal and calculates an average value of the. extracted sampling values; and an expected value operation circuit which determines the first corrected expected value based on the average value from the averaging circuit, and calculates the second corrected expected value based on the first corrected expected value and the third expected value. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> Preferably, the signal generating circuit includes: an absolute value operation circuit which calculates absolute values of the first, second and third errors; a minimal error determination circuit which detects a minimal value from among the three absolute values calculated by the absolute value operation circuit and generates, when the detected minimal value is the absolute value of the first error, a first error minimal signal having an activated level corresponding to a time period where the first error holds a minimal value, and generates, when the detected minimal value is the absolute value of the second error, a second error minimal signal having an activated level corresponding to a time period where the second error holds a minimal value; and an AND gate which carries out logical AND of the first error minimal signal, a first delayed error minimal signal having the first error minimal signal delayed by a prescribed amount of the reference clock and a second delayed error minimal signal having the first delayed error minimal signal delayed by the prescribed amount to generate the first extract signal, and carries out logical AND of the second error minimal signal, a third delayed error minimal signal having the second error minimal signal delayed by the prescribed amount of the reference clock and a fourth delayed error minimal signal having the third delayed error minimal signal delayed by the prescribed amount to generate the second extract signal. The averaging circuit latches the third error in synchronization with an activated level of the first or second extract signal, and calculates an average of the average value of the third error at the first timing and the third error at the second timing. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> Preferably, the Viterbi decoding circuit calculates a first error between the first expected value and the sampling value, a second error between the second expected value and the sampling value, and a third error between the third expected value and the sampling value and outputs them to the expected value correction circuit. The expected value correction circuit includes: a signal generating circuit which detects a smallest error from among the first, second and third errors, and generates, when the detected error is the first error, a first extract signal for extracting the first errors, and generates, when the detected error is the second error, a second extract signal for extracting the second errors; an averaging circuit which extracts the first or second errors based on the first or second extract signal, and calculates an average value of the extracted errors; and an expected value operation circuit which determines the first or second corrected expected value based on a reference expected value added with the average value of the errors. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> Preferably, the signal generating circuit includes: a minimal error determination circuit which detects a minimal value from among the first, second and third errors and generates, when the detected minimal value is the first error, a first error minimal signal having an activated level corresponding to a time period where the first error holds a minimal value and a first select signal for selecting the first error, and generates, when the detected minimal value is the second error, a second error minimal signal having an activated level corresponding to a time period where the second error holds a minimal value and a second select signal for selecting the second error; a select circuit which selects the first or second error based on the first and second select signals; a select signal generating circuit which receives the error selected by the select circuit and calculates a difference between the error at the first timing and the error at the second timing,. and generates an error select signal having an activated level when the difference is smaller than a reference value and having an inactivated level when the difference is greater than the reference value; and an AND gate which carries out logical AND between the first or second error minimal signal and the error select signal to generate the first or second extract signal. The averaging circuit latches the error selected by the select circuit in a time period where the first or second extract signal is at an activated level, and calculates an average of the average value of the error at the first timing and the error at the second timing. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> Preferably, the Viterbi decoding circuit calculates a first error between the first expected value and the sampling value, a second error between the second expected value and the sampling value and a third error between the third expected value and the sampling value, and outputs them to the expected value correction circuit. The expected value correction circuit includes: a signal generating circuit which detects a smallest error from among the first, second and third errors and generates, when the detected error is the first error, a first extract signal for extracting a central portion of a region where the first error holds a minimal value, and generates, when the detected error is the second error, a second extract signal for extracting a central portion of a region where the second error holds a minimal value; an averaging circuit which extracts the first or second errors corresponding to the central portion based on the first or second extract signal and calculates an average value of the extracted errors; and an expected value operation circuit which determines the first or second corrected expected value based on a reference expected value added with the average value of the errors. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> Preferably, the signal generating circuit includes: a minimal error determination circuit which detects a minimal value from among the first, second and third errors and generates, when the detected minimal value is the first error, a first error minimal signal having an activated level corresponding to a time period where the first error holds a minimal value, and generates, when the detected minimal value is the second error, a second error minimal signal having an activated level corresponding to a time period where the second error holds a minimal value; and an AND gate which carries out logical AND of the first error minimal signal, a first delayed error minimal signal having the first error minimal signal delayed by a prescribed amount of the reference clock and a second delayed error minimal signal having the first delayed error minimal signal delayed by the prescribed amount to generate the first extract signal, and carries out logical AND of the second error minimal signal, a third delayed error minimal signal having the second error minimal signal delayed by the prescribed amount of the reference clock and a fourth delayed error minimal signal having the third delayed error minimal signal delayed by the prescribed amount to generate the second extract signal. The averaging circuit latches the first or second error in synchronization with an activated level of the first or second extract signal, and calculates an average of the average value of the first or second error at the first timing and the first or second error at the second timing. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> Preferably, the expected value includes a first expected value greater than a direct-current component of the reproduction signal, a second expected value located in a symmetrical position to the first expected value with respect to the direct-current component of the reproduction signal, and a third expected value equal to the direct-current component of the reproduction signal, and the expected value correction circuit corrects the first, second and third expected values and outputs, to the Viterbi decoding circuit, a first corrected expected value obtained by correcting the first expected value, a second corrected expected value obtained by correcting the second expected value, and a third corrected expected value obtained by correcting the third expected value. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> Preferably, the Viterbi decoding circuit calculates a first error between the first expected value and the sampling value, a second error between the second expected value and the sampling value and a third error between the third expected value and the sampling value, and outputs them to the expected value correction circuit. The expected value correction circuit includes: a signal generating circuit which detects a smallest error from among absolute values of the first, second and third errors and generates, when the detected error is the first error, a first extract signal for extracting the third errors in a region where the first error holds a minimal value, generates, when the detected error is the second error, a second extract signal for extracting the third errors in a region where the second error holds a minimal value, and generates, when the detected error is the third error, a third extract signal for extracting the smallest third errors; a first averaging circuit which extracts the third errors based on the first extract signal and calculates an average value of the extracted errors; a second averaging circuit which extracts the third errors based on the second extract signal and calculates an average value of the extracted errors; a third averaging circuit which extracts the third errors based on the third extract signal and calculates an average value of the extracted errors; and an expected value operation circuit which determines the first corrected expected value based on a first error average value output from the first averaging circuit, determines the second corrected expected value based on a second error average value output from the second averaging circuit, and determines the third corrected expected value based on a third error average value output from the third averaging circuit. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> Preferably, the signal generating circuit includes: a select signal generating circuit which calculates a difference between the third error at the first timing and the third error at the second timing, and generates an error select signal having an activated level when the difference is smaller than a reference value and having an inactivated level when the difference is greater than the reference value; an absolute value operation circuit which calculates absolute values of the first, second and third errors; a minimal error determination circuit which detects a minimal value from among the three absolute values calculated by the absolute value operation circuit and generates, when the detected minimal value is the absolute value of the first error, a first error minimal signal having an activated level corresponding to a time period where the first error holds a minimal value, generates, when the detected minimal value is the absolute value of the second error, a second error minimal signal having an activated level corresponding to a time period where the second error holds a minimal value, and generates, when the detected minimal value is the absolute value of the third error, a third error minimal signal having an activated level corresponding to a time period where the third error holds a minimal value; a first AND gate which carries out logical AND of the first error minimal . signal and the error select signal to generate the first extract signal; a second AND gate which carries out logical AND of the second error minimal signal and the error select signal to generate the second extract signal; and a third AND gate which carries out logical AND of the third error minimal signal and the error select signal to generate the third extract signal. The first averaging circuit latches the third error in synchronization with an activated level of the first extract signal, and calculates an average of the average value of the third error at the first timing and the third error at the second timing. The second averaging circuit latches the third error in synchronization with an activated level of the second extract signal, and calculates an average of the average value of the third error at the first timing and the third error at the second timing. The third averaging circuit latches the third error in synchronization with an activated level of the third extract signal, and calculates an average of the average value of the third error at the first timing and the third error at the second timing. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> Preferably, the Viterbi decoding circuit calculates a first error between the first expected value and the sampling value, a second error between the second expected value and the sampling value, and a third error between the third expected value and the sampling value, and outputs them to the expected value correction circuit. The expected value correction circuit includes: a signal generating circuit which detects a smallest error from among absolute values of the first, second and third errors and generates, when the detected error is the first error, a first extract signal for extracting a central portion of a region where the first error holds a minimal value, generates, when the detected error is the second error, a second extract signal for extracting a central portion of a region where the second error holds a minimal value, and generates, when the detected error is the third error, a third extract signal for extracting a central portion of a region where the third error holds a minimal value; a first averaging circuit which extracts the third errors corresponding to the central portion based on the first extract signal and calculates an average value of the extracted errors; a second averaging circuit which extracts the third errors corresponding to the central portion based on the second extract signal and calculates an average value of the extracted errors; a third averaging circuit which extracts the third errors corresponding to the central portion based on the third extract signal and calculates an average value of the extracted errors; and an expected value operation circuit which determines the first corrected expected value based on a first error average value output from the first averaging circuit, determines the second corrected expected value based on a second error average value output from the second averaging circuit, and determines the third corrected expected value based on a third error average value output from the third averaging circuit. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> Preferably, the signal generating circuit includes: an absolute value operation circuit which calculates absolute values of the first, second and third errors; a minimal error determination circuit which detects a minimal value from the three absolute values calculated by the absolute value operation circuit and generates, when the detected minimal value is the absolute value of the first error, a first error minimal signal having an activated level corresponding to a time period where the first error holds a minimal value, generates, when the detected minimal value is the absolute value of the second error, a second error minimal signal having an activated level corresponding to a time period where the second error holds a minimal value, and generates, when the detected minimal value is the absolute value of the third error, a third error minimal signal having an activated level corresponding to a time period where the third error holds a minimal value; a first AND gate which carries out logical AND of the first error minimal signal, a first delayed error minimal signal having the first error minimal signal delayed by a prescribed amount of the reference clock and a second delayed error minimal signal having the first delayed error minimal signal delayed by the prescribed amount, to generate the first extract signal; a second AND gate which carries out logical AND of the second error minimal signal, a third delayed error minimal signal having the second error minimal signal delayed by the prescribed amount of the reference clock and a fourth delayed error minimal signal having the third delayed error minimal signal delayed by the prescribed amount, to generate the second extract signal; and a third AND gate which carries out logical AND of the third error minimal signal, a fifth delayed error minimal signal having the third error minimal signal delayed by the prescribed amount of the reference clock and a sixth delayed error minimal signal having the fifth delayed error minimal signal delayed by the prescribed amount, to generate the third extract signal. The first averaging circuit latches the third error in synchronization with an activated level of the first extract signal, and calculates an average of the average value of the third error at the first timing and the third error at the second timing. The second averaging circuit latches the third error in synchronization with an activated level of the second extract signal, and calculates an average of the average value of the third error at the first timing and the third error at the second timing. The third averaging circuit latches the third error in synchronization with an activated level of the third extract signal, and calculates an average of the average value of the third error at the first timing and the third error at the second timing. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> Preferably, the Viterbi decoding circuit calculates a first error between the first expected value and the sampling value, a second error between the second expected value and the sampling value and a third error between the third expected value and the sampling value, and outputs them to the expected value correction circuit. The expected value correction circuit includes: a signal generating circuit which detects a smallest error from among absolute values of the first, second and third errors and generates, when the detected error is the first error, a first extract signal for extracting the first errors, generates, when the detected error is the second error, a second extract signal for extracting the second errors, and generates, when the detected error is the third error, a third extract signal for extracting the third errors; a first averaging circuit which extracts the first errors based on the first extract signal and calculates an average value of the extracted errors; a second averaging circuit which extracts the second errors based on the second extract signal and calculates an average value of the extracted errors; a third averaging circuit which extracts the third errors based on the third extract signal and calculates an average value of the extracted errors; and an expected value operation circuit which determines the first corrected expected value based on a first reference expected value added with a first error average value output from the first averaging circuit, determines the second corrected expected value based on a second reference expected value added with a second error average value output from the second averaging circuit, and determines the third corrected expected value based on a third reference expected value added with a third error average value output from the third averaging circuit. </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> Preferably, the signal generating circuit includes: a minimal error determination circuit which detects a minimal value from among the first, second and third errors and generates, when the detected minimal value is the first error, a first error minimal signal having an activated level corresponding to a time period where the first error holds a minimal value and a first select signal for selecting the first error, generates, when the detected minimal value is the second error, a second error minimal signal having an activated level corresponding to a time period where the second error holds a minimal value and a second select signal for selecting the second error, and generates, when the detected minimal value is the third error, a third error minimal signal having an activated level corresponding to a time period where the third error holds a minimal value and a third select signal for selecting the third error; a select circuit which selects the first, second and third errors based on the first, second and third select signals, respectively; a select signal generating circuit which receives the error selected by the select circuit and calculates a difference between the error at the first timing and the error at the second timing, and generates an error select signal having an activated level when the difference is smaller than a reference value and having an inactivated level when the difference is greater than the reference value; a first AND gate which carries out logical AND of the first error minimal signal and the error select signal to generate the first extract signal; a second AND gate which carries out logical AND of the second error minimal signal and the error select signal to generate the second extract signal; and a third AND gate which carries out logical AND of the third error minimal signal and the error select signal to generate the third extract signal. The first averaging circuit latches the first error in synchronization with an activated level of the first extract signal, and calculates an average of the average value of the first error at the first timing and the first error at the second timing to output the first error average value. The second averaging circuit latches the second error in synchronization with an activated level of the second extract signal, and calculates an average of the average value of the second error at the first timing and the second error at the second timing to output the second error average value. The third averaging circuit latches the third error in synchronization with an activated level of the third extract signal, and calculates an average of the average value of the third error at the first timing and the third error at the second timing to output the third error average value. </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> Preferably, the Viterbi decoding circuit calculates a first error between the first expected value and the sampling value, a second error between the second expected value and the sampling value and a third error between the third expected value and the sampling value, and outputs them to the expected value correction circuit. The expected value correction circuit includes: a signal generating circuit which detects a smallest error from among absolute values of the first, second and third errors and generates, when the detected error is the first error, a first extract signal for extracting a central portion of a region where the first error holds a minimal value, generates, when the detected error is the second error, a second extract signal for extracting a central portion of a region where the second error holds a minimal value, and generates, when the detected error is the third error, a third extract signal for extracting a central portion of a region where the third error holds a minimal value; a first averaging circuit which extracts the first errors corresponding to the central portion based on the first extract signal and calculates an average value of the extracted errors; a second averaging circuit which extracts the second errors corresponding to the central portion based on the second extract signal and calculates an average value of the extracted errors; a third averaging circuit which extracts the third errors corresponding to the central portion based on the third extract signal and calculates an average value of the extracted errors; and an expected value operation circuit which determines the first corrected expected value based on a first reference expected value added with a first error average value output from the first averaging circuit, determines the second corrected expected value based on a second reference expected value added with a second error average value output from the second averaging circuit, and determines the third corrected expected value based on a third reference expected value added with a third error average value output from the third averaging circuit. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> Preferably, the signal generating circuit includes: a minimal error determination circuit which detects a minimal value from among the first, second and third errors and generates, when the detected minimal value is the first error, a first error minimal signal having an activated level corresponding to a time period where the first error holds a minimal value, generates, when the detected minimal value is the second error, a second error minimal signal having an activated level corresponding to a time period where the second error holds a minimal value, and generates, when the detected minimal value is the third error, a third error minimal signal having an activated level corresponding to a time period where the third error holds a minimal value; a first AND gate which carries out logical AND of the first error minimal signal, a first delayed error minimal signal having the first error minimal signal delayed by a prescribed amount of the reference clock and a second delayed error minimal signal having the first delayed error minimal signal delayed by the prescribed amount to generate the first extract signal; a second AND gate which carries out logical AND of the second error minimal signal, a third delayed error minimal signal having the second error minimal signal delayed by the prescribed amount of the reference clock and a fourth delayed error minimal signal having the third delayed error minimal signal delayed by the prescribed amount to generate the second extract signal; and a third AND gate which carries out logical AND of the third error minimal signal, a fifth delayed error minimal signal having the third error minimal signal delayed by the prescribed amount of the reference clock and a sixth delayed error minimal signal having the fifth delayed error minimal signal delayed by the prescribed amount to generate the third extract signal. The first averaging circuit latches the first error in synchronization with an activated level of the first extract signal, and calculates an average of the average value of the first error at the first timing and the first error at the second timing to output the first error averaging value. The second averaging circuit latches the second error in synchronization with an activated level of the second extract signal, and calculates an average of the average value of the second error at the first timing and the second error at the second timing to output the second error average value. The third averaging circuit latches the third error in synchronization with an activated level of the third extract signal, and calculates an average of the average value of the third error at the first timing and the third error at the second timing to output the third error average value. </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> In the optical disk apparatus according to the present invention, sampling values are detected from a reproduction signal obtained from an optical disk. Expected values for use in converting the sampling value from multilevel data to binary data are corrected based on the sampling values obtained in a region where variation is small. The sampling value is then converted from multilevel data to binary data by Viterbi decoding, using the corrected expected values. As such, according to the present invention, the Viterbi decoding is performed accurately even if the reproduction signal varies in amplitude, and as a result, accurate signal reproduction from the optical disk is ensured. </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> The foregoing and other objects, features, aspects and advantages of the present invention will become more apparent from the following detailed description of the present invention when taken in conjunction with the accompanying drawings.</paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a top plan view showing a magneto-optical disk and its format. </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> illustrates relation between bands, frames and segments. </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> schematically shows a format of a recorded data stream. </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> illustrates data reproduction from a pre-format region and a user data region. </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is a schematic block diagram showing an optical disk apparatus according to a first embodiment of the present invention. </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a block diagram of the Viterbi decoder shown in <cross-reference target="DRAWINGS">FIG. 5</cross-reference>. </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a circuit diagram of the branch metric operation unit and the path metric operation unit shown in <cross-reference target="DRAWINGS">FIG. 6</cross-reference>. </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a circuit and block diagram of the path memory shown in <cross-reference target="DRAWINGS">FIG. 6</cross-reference>. </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a circuit and block diagram of the expected value correction circuit shown in <cross-reference target="DRAWINGS">FIG. 5</cross-reference>. </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a signal timing chart illustrating an operation for correcting expected values in the expected value correction circuit shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is a schematic block diagram of the optical disk apparatus according to a second embodiment of the present invention. </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a circuit and block diagram of the expected value correction circuit shown in <cross-reference target="DRAWINGS">FIG. 11</cross-reference>. </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is a schematic block diagram of the optical disk apparatus according to a third embodiment of the present invention. </paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 14</cross-reference> is a circuit and block diagram of the expected value correction circuit shown in <cross-reference target="DRAWINGS">FIG. 13</cross-reference>. </paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 15</cross-reference> is a signal timing chart illustrating a correcting operation of expected values in the expected value correction circuit shown in <cross-reference target="DRAWINGS">FIG. 14</cross-reference>. </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 16</cross-reference> is a schematic block diagram of the optical disk apparatus according to a fourth embodiment of the present invention. </paragraph>
<paragraph id="P-0048" lvl="0"><number>&lsqb;0048&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 17</cross-reference> is a circuit and block diagram of the expected value correction circuit shown in <cross-reference target="DRAWINGS">FIG. 16</cross-reference>. </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 18</cross-reference> is a schematic block diagram of the optical disk apparatus according to a fifth embodiment of the present invention. </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 19</cross-reference> is a circuit and block diagram of the expected value correction circuit shown in <cross-reference target="DRAWINGS">FIG. 18</cross-reference>. </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 20</cross-reference> is a signal timing chart illustrating an operation for correcting expected values in the expected value correction circuit shown in <cross-reference target="DRAWINGS">FIG. 19</cross-reference>. </paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 21</cross-reference> is a schematic block diagram of the optical disk apparatus according to a sixth embodiment of the present invention. </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 22</cross-reference> is a circuit and block diagram of the expected value correction circuit shown in <cross-reference target="DRAWINGS">FIG. 21</cross-reference>. </paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 23</cross-reference> is a schematic block diagram of the optical disk apparatus according to a seventh embodiment of the present invention. </paragraph>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 24</cross-reference> is a circuit and block diagram of the expected value correction circuit shown in <cross-reference target="DRAWINGS">FIG. 23</cross-reference>. </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 25</cross-reference> is a signal timing chart illustrating an operation for correcting expected values in the expected value correction circuit shown in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>. </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 26</cross-reference> is a schematic block diagram of the optical disk apparatus according to an eighth embodiment of the present invention. </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 27</cross-reference> is a circuit and block diagram of the expected value correction circuit shown in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DESCRIPTION OF THE PREFERRED EMBODIMENTS </heading>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> Hereinafter, embodiments of the present invention will be described in detail with reference to the accompanying drawings. In the drawings, like or corresponding portions are denoted by like reference characters, and description thereof will not be repeated. </paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> First Embodiment </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 1, a</cross-reference> magneto-optical disk from which signals are to be reproduced by an optical disk apparatus of the present invention is described. The magneto-optical disk <highlight><bold>101</bold></highlight> includes a plurality of bands B<highlight><bold>0</bold></highlight>-B<highlight><bold>13</bold></highlight> arranged concentrically in a radial direction. </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> Grooves <highlight><bold>1</bold></highlight> and lands <highlight><bold>2</bold></highlight> are alternately arranged in a radial direction DR<highlight><bold>1</bold></highlight> of magneto-optical disk <highlight><bold>101</bold></highlight>. Groove <highlight><bold>1</bold></highlight> includes a land <highlight><bold>3</bold></highlight>A on the order of 4 &mgr;m in a tangential direction DR<highlight><bold>2</bold></highlight> of magneto-optical disk <highlight><bold>101</bold></highlight>. Land <highlight><bold>2</bold></highlight> includes a groove <highlight><bold>3</bold></highlight>B of about 4 &mgr;m in the tangential direction DR<highlight><bold>2</bold></highlight>. Land <highlight><bold>3</bold></highlight>A and groove <highlight><bold>3</bold></highlight>B are formed adjacent to each other in the radial direction DR<highlight><bold>1</bold></highlight> of magneto-optical disk <highlight><bold>101</bold></highlight>, and they are formed at regular intervals in the tangential direction DR<highlight><bold>2</bold></highlight>. </paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> Land <highlight><bold>3</bold></highlight>A and groove <highlight><bold>3</bold></highlight>B are called &ldquo;fine clock marks&rdquo; and serve as the basis for generation of a reference clock CLK for use in recording signals on and/or reproducing signals from magneto-optical disk <highlight><bold>101</bold></highlight>. Grooves <highlight><bold>1</bold></highlight> and lands <highlight><bold>2</bold></highlight> are arranged spirally or concentrically. </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> Each band B<highlight><bold>0</bold></highlight>-B<highlight><bold>13</bold></highlight> includes a plurality of frames for signals to be recorded and/or reproduced in units of frames. More specifically, magneto-optical disk <highlight><bold>101</bold></highlight> has frames as units of recording arranged at regular intervals, with each frame being formed of 39 segments S<highlight><bold>0</bold></highlight>, S<highlight><bold>1</bold></highlight>, S<highlight><bold>2</bold></highlight>, . . . , S<highlight><bold>38</bold></highlight>. </paragraph>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> Each segment has a length of 532 DCB (Data Channel Bits). At the head of each segment, fine clock marks (FCM) <highlight><bold>3</bold></highlight>A, <highlight><bold>3</bold></highlight>B are formed which indicate phase information of the clock for data recording and reproduction. In the segment S<highlight><bold>0</bold></highlight> at the head of the frame, fine clock marks <highlight><bold>3</bold></highlight>A, <highlight><bold>3</bold></highlight>B are followed by address information indicating an address on magneto-optical disk <highlight><bold>101</bold></highlight>, which is pre-formatted by wobbles <highlight><bold>4</bold></highlight>-<highlight><bold>9</bold></highlight> at the time of manufacture of magneto-optical disk <highlight><bold>101</bold></highlight>. </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> Wobbles <highlight><bold>4</bold></highlight> and <highlight><bold>5</bold></highlight>, wobbles <highlight><bold>6</bold></highlight> and <highlight><bold>7</bold></highlight>, and wobbles <highlight><bold>8</bold></highlight> and <highlight><bold>9</bold></highlight> are formed on the opposite walls of grooves <highlight><bold>1</bold></highlight>, and store the same address information. Such an address information recording method is called a one-sided stagger method, which enables accurate detection of the address information even if magneto-optical disk <highlight><bold>101</bold></highlight> suffers tilt or the like and laser light deflects from the center of groove <highlight><bold>1</bold></highlight> or land <highlight><bold>2</bold></highlight> in the radial direction DR<highlight><bold>1</bold></highlight>. </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> The region where the address information is stored and the region where fine clock marks <highlight><bold>3</bold></highlight>A, <highlight><bold>3</bold></highlight>B are formed are not used as the region for recording user data. A segment Sn is formed of fine clock marks <highlight><bold>3</bold></highlight>A, <highlight><bold>3</bold></highlight>B and user data n-<highlight><bold>1</bold></highlight>. </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, each band B<highlight><bold>0</bold></highlight>-B<highlight><bold>13</bold></highlight> consists of m frames F<highlight><bold>0</bold></highlight> to Fm-<highlight><bold>1</bold></highlight>. The number of frames differs for each band B<highlight><bold>0</bold></highlight>-B<highlight><bold>13</bold></highlight>. One frame consists of 39 segments S<highlight><bold>0</bold></highlight>-S<highlight><bold>38</bold></highlight>, as described above. Signals are recorded on and/or reproduced from magneto-optical disk <highlight><bold>101</bold></highlight> in accordance with the data format as shown in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>. </paragraph>
<paragraph id="P-0069" lvl="0"><number>&lsqb;0069&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 3</cross-reference>, detailed configurations of the segments are described. Of the segments S<highlight><bold>0</bold></highlight>, S<highlight><bold>1</bold></highlight>, S<highlight><bold>2</bold></highlight>, . . . , S<highlight><bold>38</bold></highlight> constituting a frame, segment S<highlight><bold>0</bold></highlight> is an address segment pre-formatted on magneto-optical disk <highlight><bold>101</bold></highlight>, and segments S<highlight><bold>1</bold></highlight>-S<highlight><bold>38</bold></highlight> are data segments secured as the user data recording regions. Segment S<highlight><bold>0</bold></highlight> consists of a fine clock mark region FCM of 12 DCB and an address of 520 DCB. Segment S<highlight><bold>1</bold></highlight> consists of fine clock mark region FCM of 12 DCB, pre-write of 4 DCB, data of 512 DCB, and post-write of 4 DCB. </paragraph>
<paragraph id="P-0070" lvl="0"><number>&lsqb;0070&rsqb;</number> The pre-write indicates the beginning of data, which is formed of a prescribed pattern of &ldquo;0011&rdquo;, for example. The post-write indicates the end of the data and is formed of a prescribed pattern of, e.g., &ldquo;1100&rdquo;. </paragraph>
<paragraph id="P-0071" lvl="0"><number>&lsqb;0071&rsqb;</number> The user data region of segment S<highlight><bold>1</bold></highlight> includes a header having a fixed pattern for use in position confirmation of data at the time of reproduction, position compensation of a reproduction clock, and others. The fixed pattern on the header has its direct-current component restricted, on which a prescribed number of domains of 2T formed at intervals of 2T and a prescribed number of 8T domains formed at 8T intervals, for example, are recorded. </paragraph>
<paragraph id="P-0072" lvl="0"><number>&lsqb;0072&rsqb;</number> The phase compensation is performed by adjusting the sampling timing of the analog signal obtained by reproducing the 2T domain to match the phase of the reproduction clock obtained by delaying the phase of the reference clock for use in signal recording. The position confirmation of a signal at the time of reproduction is performed by reproducing the 8T domain and confirming whether the position of the digital signal obtained by binarizing the reproduction signal matches a predicted position of the digital signal of the 8T domain. Still further, respective patterns of the pre-write, post-write and header are recorded together with user data at the time of recording of the user data. </paragraph>
<paragraph id="P-0073" lvl="0"><number>&lsqb;0073&rsqb;</number> Segments S<highlight><bold>2</bold></highlight>-S<highlight><bold>38</bold></highlight> each consist of fine clock mark region FCM of 12 DCB, pre-write of 4 DCB, data of 512 DCB, and post-write of 4 DCB. </paragraph>
<paragraph id="P-0074" lvl="0"><number>&lsqb;0074&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 4</cross-reference>, detection of an address signal RPP, a fine clock mark signal TPP, and a magneto-optical signal RF from magneto-optical disk <highlight><bold>101</bold></highlight> is now described. Regions <highlight><bold>10</bold></highlight> and <highlight><bold>30</bold></highlight> constitute pre-format regions which are pre-formatted during the manufacture of magneto-optical disk <highlight><bold>101</bold></highlight>. Wobbles <highlight><bold>4</bold></highlight>-<highlight><bold>7</bold></highlight> are formed in region <highlight><bold>10</bold></highlight>, and fine clock marks <highlight><bold>3</bold></highlight>A, <highlight><bold>3</bold></highlight>B are formed in region <highlight><bold>30</bold></highlight>. A region <highlight><bold>20</bold></highlight> constitutes a user data region where user data is recorded. </paragraph>
<paragraph id="P-0075" lvl="0"><number>&lsqb;0075&rsqb;</number> An optical pickup <highlight><bold>102</bold></highlight> irradiates laser light onto magneto-optical disk <highlight><bold>101</bold></highlight> and detects reflected light thereof It includes a photodetector <highlight><bold>1020</bold></highlight> having six detecting regions <highlight><bold>1020</bold></highlight>A, <highlight><bold>1020</bold></highlight>B, <highlight><bold>1020</bold></highlight>C, <highlight><bold>1020</bold></highlight>D, <highlight><bold>1020</bold></highlight>E, and <highlight><bold>1020</bold></highlight>F. The region &ldquo;A&rdquo; <highlight><bold>1020</bold></highlight>A and the region &ldquo;B&rdquo; <highlight><bold>1020</bold></highlight>B, the region &ldquo;C&rdquo; <highlight><bold>1020</bold></highlight>C and the region &ldquo;D&rdquo; <highlight><bold>1020</bold></highlight>D, and the region &ldquo;E&rdquo; <highlight><bold>1020</bold></highlight>E and the region &ldquo;F&rdquo; <highlight><bold>1020</bold></highlight>F are arranged in the tangential direction DR<highlight><bold>2</bold></highlight> of magneto-optical disk <highlight><bold>101</bold></highlight>. Region &ldquo;A&rdquo; <highlight><bold>1020</bold></highlight>A and region &ldquo;D&rdquo; <highlight><bold>1020</bold></highlight>D, and region &ldquo;B&rdquo; <highlight><bold>1020</bold></highlight>B and region &ldquo;C&rdquo; <highlight><bold>1020</bold></highlight>C are arranged in the radial direction DR<highlight><bold>1</bold></highlight> of magneto-optical disk <highlight><bold>101</bold></highlight>. </paragraph>
<paragraph id="P-0076" lvl="0"><number>&lsqb;0076&rsqb;</number> Region &ldquo;A&rdquo; <highlight><bold>1020</bold></highlight>A, region &ldquo;B&rdquo; <highlight><bold>1020</bold></highlight>B, region &ldquo;C&rdquo; <highlight><bold>1020</bold></highlight>C and region &ldquo;D&rdquo; <highlight><bold>1020</bold></highlight>D detect laser light LB irradiated onto magneto-optical disk <highlight><bold>101</bold></highlight> and reflected at the A region, B region, C region and D region, respectively. Region &ldquo;E&rdquo; <highlight><bold>1020</bold></highlight>E and region &ldquo;F&rdquo; <highlight><bold>1020</bold></highlight>F detect the laser light LB reflected at the A, B, C and D regions as a whole and diffracted to two directions different in plane of polarization by a Wollaston prism (not shown) of optical pickup <highlight><bold>102</bold></highlight>. </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> Reproduction signal RF of the magneto-optical signal recorded on region <highlight><bold>20</bold></highlight> being the user data region is detected by calculating a difference between laser light intensity &lsqb;E&rsqb; detected at region &ldquo;E&rdquo; <highlight><bold>1020</bold></highlight>E and laser light intensity &lsqb;F&rsqb; detected at region &ldquo;F&rdquo; <highlight><bold>1020</bold></highlight>F of photodetector <highlight><bold>1020</bold></highlight>. More specifically, a subtracter <highlight><bold>400</bold></highlight> included in a circuit <highlight><bold>40</bold></highlight> calculates the difference between laser light intensity &lsqb;E&rsqb; detected at region &ldquo;E&rdquo; <highlight><bold>1020</bold></highlight>E and laser light intensity &lsqb;F&rsqb; detected at region &ldquo;F&rdquo; <highlight><bold>1020</bold></highlight>F and outputs the reproduction signal RF&equals;&lsqb;E&rsqb;&minus;&lsqb;F&rsqb;. </paragraph>
<paragraph id="P-0078" lvl="0"><number>&lsqb;0078&rsqb;</number> The reproduction signal of the address information recorded by wobbles <highlight><bold>4</bold></highlight>-<highlight><bold>7</bold></highlight> on region <highlight><bold>10</bold></highlight> forming the pre-format region is detected, by a radial push-pull method, as a result of subtraction of the sum of laser light intensity &lsqb;C&rsqb; detected at region &ldquo;C&rdquo; <highlight><bold>1020</bold></highlight>C and laser light intensity &lsqb;D&rsqb; detected at region &ldquo;D&rdquo; <highlight><bold>1020</bold></highlight>D from the sum of laser light intensity &lsqb;A&rsqb; detected at region &ldquo;A&rdquo; <highlight><bold>1020</bold></highlight>A and laser light intensity &lsqb;B&rsqb; detected at region &ldquo;B&rdquo; <highlight><bold>1020</bold></highlight>B. More specifically, address signal RPP is detected by adders <highlight><bold>500</bold></highlight>, <highlight><bold>501</bold></highlight> and a subtracter <highlight><bold>502</bold></highlight> being the elements of a circuit <highlight><bold>50</bold></highlight>. Adder <highlight><bold>500</bold></highlight> outputs &lsqb;A&plus;B&rsqb; that is the sum of laser light intensity &lsqb;A&rsqb; detected at region &ldquo;A&rdquo; <highlight><bold>1020</bold></highlight>A and laser light intensity &lsqb;B&rsqb; detected at region &ldquo;B&rdquo; <highlight><bold>1020</bold></highlight>B. Adder <highlight><bold>501</bold></highlight> outputs &lsqb;C&plus;D&rsqb; that is the sum of laser light intensity &lsqb;C&rsqb; detected at region &ldquo;C&rdquo; <highlight><bold>1020</bold></highlight>C and laser light intensity &lsqb;D&rsqb; detected at region &ldquo;D&rdquo; <highlight><bold>1020</bold></highlight>D. Subtracter <highlight><bold>502</bold></highlight> then subtracts the output &lsqb;C&plus;D&rsqb; of adder <highlight><bold>501</bold></highlight> from the output &lsqb;A&plus;B&rsqb; of adder <highlight><bold>500</bold></highlight> and outputs the address signal RPP &equals;&lsqb;A&plus;B&rsqb;&minus;&lsqb;C &plus;D&rsqb;. </paragraph>
<paragraph id="P-0079" lvl="0"><number>&lsqb;0079&rsqb;</number> Fine clock marks <highlight><bold>3</bold></highlight>A, <highlight><bold>3</bold></highlight>B in region <highlight><bold>30</bold></highlight> constituting the pre-format region are detected, by a tangential push-pull method, as a result of subtraction of the sum of laser light intensity &lsqb;B&rsqb; detected at region &ldquo;B&rdquo; <highlight><bold>1020</bold></highlight>B and laser light intensity &lsqb;C&rsqb; detected at region &ldquo;C&rdquo; <highlight><bold>1020</bold></highlight>C from the sum of laser light intensity &lsqb;A&rsqb; detected at region &ldquo;A&rdquo; <highlight><bold>1020</bold></highlight>A and laser light intensity &lsqb;D&rsqb; detected at region &ldquo;D&rdquo; <highlight><bold>1020</bold></highlight>D. More specifically, fine clock marks <highlight><bold>3</bold></highlight>A, <highlight><bold>3</bold></highlight>B are detected by adders <highlight><bold>503</bold></highlight>, <highlight><bold>504</bold></highlight> and a subtracter <highlight><bold>505</bold></highlight> being the elements of circuit <highlight><bold>50</bold></highlight>. Adder <highlight><bold>503</bold></highlight> outputs &lsqb;A&plus;D&rsqb; that is the sum of laser light intensity &lsqb;A&rsqb; detected at region &ldquo;A&rdquo; <highlight><bold>1020</bold></highlight>A and laser light intensity &lsqb;D&rsqb; detected at region &ldquo;D&rdquo; <highlight><bold>1020</bold></highlight>D. Adder <highlight><bold>504</bold></highlight> outputs &lsqb;B&plus;C&rsqb; that is the sum of laser light intensity &lsqb;B&rsqb; detected at region &ldquo;B&rdquo; <highlight><bold>1020</bold></highlight>B and laser light intensity &lsqb;C&rsqb; detected at region &ldquo;C&rdquo; <highlight><bold>1020</bold></highlight>C. Subtracter <highlight><bold>505</bold></highlight> subtracts the output &lsqb;B&plus;C&rsqb; of adder <highlight><bold>504</bold></highlight> from the output &lsqb;A&plus;D&rsqb; of adder <highlight><bold>503</bold></highlight> and outputs the fine clock mark signal TPP &equals;&lsqb;A&plus;D&rsqb;&minus;&lsqb;B&plus;C&rsqb;. </paragraph>
<paragraph id="P-0080" lvl="0"><number>&lsqb;0080&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 5</cross-reference>, an optical disk apparatus <highlight><bold>100</bold></highlight> according to the first embodiment includes an optical pickup <highlight><bold>102</bold></highlight>, a PLL circuit <highlight><bold>103</bold></highlight>, a BPF <highlight><bold>104</bold></highlight>, an AD converter <highlight><bold>105</bold></highlight>, an equalizer <highlight><bold>106</bold></highlight>, a Viterbi decoder <highlight><bold>107</bold></highlight>, and an expected value correction circuit <highlight><bold>108</bold></highlight>. </paragraph>
<paragraph id="P-0081" lvl="0"><number>&lsqb;0081&rsqb;</number> Optical pickup <highlight><bold>102</bold></highlight> irradiates laser light onto magneto-optical disk <highlight><bold>101</bold></highlight> and detects its reflected light. PLL circuit <highlight><bold>103</bold></highlight> generates a reference clock CLK based on the fine clock mark signal TPP detected by optical pickup <highlight><bold>102</bold></highlight>, such that a prescribed number of periodic signals, e.g., 532 periodic signals, are present between neighboring components of fine clock mark signal TPP. PLL circuit <highlight><bold>103</bold></highlight> outputs the generated reference clock CLK to AD converter <highlight><bold>105</bold></highlight>, equalizer <highlight><bold>106</bold></highlight>, Viterbi decoder <highlight><bold>107</bold></highlight> and expected value correction circuit <highlight><bold>108</bold></highlight>. </paragraph>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> BPF <highlight><bold>104</bold></highlight> cuts high or low frequencies of reproduction signal RF obtained by optical pickup <highlight><bold>102</bold></highlight>. AD converter <highlight><bold>105</bold></highlight> samples reproduction signal RF in synchronization with reference clock CLK, and converts the reproduction signal RF from an analog signal to a digital signal. Equalizer <highlight><bold>106</bold></highlight> performs PR (1, 1) waveform equalization on the reproduction signal RF converted to the digital signal in synchronization with reference clock CLK. More specifically, equalizer <highlight><bold>106</bold></highlight> performs equalization such that the waveforms of the data preceding and succeeding the reproduction signal RF interfere one-to-one with each other. Viterbi decoder <highlight><bold>107</bold></highlight> uses expected values from expected value correction circuit <highlight><bold>108</bold></highlight> to convert the reproduction signal RF from multilevel data to binary data in synchronization with reference clock CLK, and outputs the converted reproduction signal DAT. Expected value correction circuit <highlight><bold>108</bold></highlight> corrects the expected values at Viterbi decoder <highlight><bold>107</bold></highlight> in a manner as will be described below, and outputs the corrected expected values to Viterbi decoder <highlight><bold>107</bold></highlight>. </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> The reproduction signal DAT output from Viterbi decoder <highlight><bold>107</bold></highlight> is subjected to demodulating processing to remove the modulation applied at the time of recording, before being output as reproduction data. Other components, such as a spindle motor which rotates magneto-optical disk <highlight><bold>101</bold></highlight> at a prescribed rotation speed and a servo system included in optical pickup <highlight><bold>102</bold></highlight> which performs focus servo and tracking servo of an objective, are not shown in <cross-reference target="DRAWINGS">FIG. 5</cross-reference>. </paragraph>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 6</cross-reference>, Viterbi decoder <highlight><bold>107</bold></highlight> includes a branch metric operation unit <highlight><bold>110</bold></highlight>, a path metric operation unit <highlight><bold>111</bold></highlight>, and a path memory <highlight><bold>112</bold></highlight>. Branch metric operation unit <highlight><bold>110</bold></highlight> calculates errors D&plus;, D0, D&minus; between sampling data of the reproduction signal and expected values, and outputs the calculated errors D&plus;, D0, D&minus; to expected value correction circuit <highlight><bold>108</bold></highlight>. Branch metric operation unit <highlight><bold>110</bold></highlight> receives expected values E&plus;, E0, E&minus; corrected at expected value correction circuit <highlight><bold>108</bold></highlight>, calculates square errors BM&plus;, BM0, BM&minus; of the sampling data and the expected values E&plus;, E0, E&minus; in synchronization with reference clock CLK, and outputs the calculated square errors BM&plus;, BM0, BM&minus; to path metric operation unit <highlight><bold>111</bold></highlight>. </paragraph>
<paragraph id="P-0085" lvl="0"><number>&lsqb;0085&rsqb;</number> Path metric operation unit <highlight><bold>111</bold></highlight> calculates accumulative errors based on square errors BM&plus;, BM0, BM&minus;, and generates and outputs to path memory <highlight><bold>112</bold></highlight> select signals SEL<highlight><bold>000</bold></highlight>, SEL<highlight><bold>011</bold></highlight>, SEL<highlight><bold>100</bold></highlight>, SEL<highlight><bold>111</bold></highlight> which make the calculated accumulative errors small. Path memory <highlight><bold>112</bold></highlight> selects the most likely data stream based on select signals SEL<highlight><bold>000</bold></highlight>, SEL<highlight><bold>011</bold></highlight>, SEL<highlight><bold>100</bold></highlight>, SEL<highlight><bold>111</bold></highlight>, and outputs the reproduction signal DAT of a binary value. </paragraph>
<paragraph id="P-0086" lvl="0"><number>&lsqb;0086&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 7</cross-reference>, branch metric operation unit <highlight><bold>110</bold></highlight> includes subtracters <highlight><bold>201</bold></highlight>-<highlight><bold>203</bold></highlight>, square multipliers <highlight><bold>204</bold></highlight>-<highlight><bold>206</bold></highlight>, and flip-flops <highlight><bold>207</bold></highlight>-<highlight><bold>209</bold></highlight>. Subtracter <highlight><bold>201</bold></highlight> subtracts expected value E&plus; from sampling data to obtain an error D&plus;, and outputs the obtained error D&plus; to expected value correction circuit <highlight><bold>108</bold></highlight> and square multiplier <highlight><bold>204</bold></highlight>. Subtracter <highlight><bold>202</bold></highlight> subtracts expected value E0 from the sampling data to obtain an error D0, and outputs the obtained error D0 to expected value correction circuit <highlight><bold>108</bold></highlight> and square multiplier <highlight><bold>205</bold></highlight>. Subtracter <highlight><bold>203</bold></highlight> subtracts expected value E&minus; from the sampling data to obtain an error D&minus;, and outputs the obtained error D&minus; to expected value correction circuit <highlight><bold>108</bold></highlight> and square multiplier <highlight><bold>206</bold></highlight>. </paragraph>
<paragraph id="P-0087" lvl="0"><number>&lsqb;0087&rsqb;</number> Square multiplier <highlight><bold>204</bold></highlight> calculates the square of error D&plus; and outputs branch metric BM&plus; to flip-flop <highlight><bold>207</bold></highlight>. Square multiplier <highlight><bold>205</bold></highlight> calculates the square of error D0 and outputs branch metric BM0 to flip-flop <highlight><bold>208</bold></highlight>. Square multiplier <highlight><bold>206</bold></highlight> calculates the square of error D&minus; and outputs branch metric BM&minus; to flip-flop <highlight><bold>209</bold></highlight>. Flip-flop <highlight><bold>207</bold></highlight> delays branch metric BM&plus; by one cycle of reference clock CLK and outputs it to path metric operation unit <highlight><bold>111</bold></highlight>. Flip-flop <highlight><bold>208</bold></highlight> delays branch metric BM0 by one cycle of reference clock CLK to output to path metric operation unit <highlight><bold>111</bold></highlight>. Flip-flop <highlight><bold>209</bold></highlight> delays branch metric BM&minus; by one cycle of reference clock CLK to output to path metric operation unit <highlight><bold>111</bold></highlight>. </paragraph>
<paragraph id="P-0088" lvl="0"><number>&lsqb;0088&rsqb;</number> As such, branch metric operation unit <highlight><bold>110</bold></highlight> calculates the errors and the square errors between the sampling data and respective expected values E&plus;, E0, E&minus;, and outputs the calculated errors to expected value correction circuit <highlight><bold>108</bold></highlight> and outputs the calculated square errors to path metric operation unit <highlight><bold>111</bold></highlight>. Here, three expected values E&plus;, E0, E&minus; are employed because of the following reason. In the PR (1, 1) coding method, sampling data ideally takes three values and, for the purpose of selecting the most likely data stream, it is necessary to examine to which one of the three desired values the sampling data is closest. To this end, the three expected values are required as the reference values. The largest one of the three desired values is defined as a first desired value, the smallest one as a second desired value, and the intermediate value as a third desired value. </paragraph>
<paragraph id="P-0089" lvl="0"><number>&lsqb;0089&rsqb;</number> Path metric operation unit <highlight><bold>111</bold></highlight> includes adders <highlight><bold>210</bold></highlight>-<highlight><bold>217</bold></highlight>, comparators <highlight><bold>218</bold></highlight>-<highlight><bold>221</bold></highlight>, selectors <highlight><bold>222</bold></highlight>-<highlight><bold>225</bold></highlight>, and flip-flops <highlight><bold>226</bold></highlight>-<highlight><bold>237</bold></highlight>. Comparator <highlight><bold>218</bold></highlight> compares a path metric PM111 with a path metric PM011, and outputs a select signal for selecting the smaller path metric to selector <highlight><bold>222</bold></highlight> and flip-flop <highlight><bold>226</bold></highlight>. Selector <highlight><bold>222</bold></highlight> selects the smaller one of path metrics PM011, PM111 based on the select signal from comparator <highlight><bold>218</bold></highlight>, and outputs the selected path metric as a path metric PM11 to adders <highlight><bold>210</bold></highlight> and <highlight><bold>212</bold></highlight>. Adder <highlight><bold>210</bold></highlight> adds branch metric BM&plus; from branch metric operation unit <highlight><bold>110</bold></highlight> and path metric PM11 from selector <highlight><bold>222</bold></highlight>, and outputs the result to flip-flop <highlight><bold>227</bold></highlight>. Flip-flop <highlight><bold>227</bold></highlight> latches the result obtained from adder <highlight><bold>210</bold></highlight> by one cycle of reference clock CLK, and outputs the latched result as a new path metric PM111 to comparator <highlight><bold>218</bold></highlight>. Flip-flop <highlight><bold>226</bold></highlight> latches the select signal from comparator <highlight><bold>218</bold></highlight> by one cycle of reference clock CLK, and outputs the latched select signal as a select signal SEL<highlight><bold>111</bold></highlight> to path memory <highlight><bold>112</bold></highlight>. </paragraph>
<paragraph id="P-0090" lvl="0"><number>&lsqb;0090&rsqb;</number> Comparator <highlight><bold>219</bold></highlight> compares a path metric PM101 with a path metric PM001, and outputs a select signal for selecting the smaller path metric to selector <highlight><bold>223</bold></highlight> and flip-flop <highlight><bold>228</bold></highlight>. Selector <highlight><bold>223</bold></highlight> selects the smaller one of path metrics PM001, PM101 based on the select signal from comparator <highlight><bold>219</bold></highlight>, and outputs the selected path metric as a path metric PM01 to adders <highlight><bold>211</bold></highlight>, <highlight><bold>213</bold></highlight>. Adder <highlight><bold>211</bold></highlight> adds branch metric BM&plus; from branch metric operation unit <highlight><bold>110</bold></highlight> and path metric PM01 from selector <highlight><bold>223</bold></highlight>, and outputs the result to flip-flop <highlight><bold>229</bold></highlight>. Flip-flop <highlight><bold>229</bold></highlight> delays the result obtained from adder <highlight><bold>211</bold></highlight> by one cycle of reference clock CLK, and outputs it as a new path metric PM011 to comparator <highlight><bold>218</bold></highlight>. Flip-flop <highlight><bold>228</bold></highlight> latches the select signal from comparator <highlight><bold>219</bold></highlight> by one cycle of reference clock CLK, and outputs the latched select signal as a select signal SEL<highlight><bold>011</bold></highlight> to path memory <highlight><bold>112</bold></highlight>. </paragraph>
<paragraph id="P-0091" lvl="0"><number>&lsqb;0091&rsqb;</number> Comparator <highlight><bold>220</bold></highlight> compares a path metric PM110 with a path metric PM010, and outputs a select signal for selecting the smaller path metric to selector <highlight><bold>224</bold></highlight> and flip-flop <highlight><bold>235</bold></highlight>. Selector <highlight><bold>224</bold></highlight> selects the smaller one of path metrics PM110, PM010 based on the select signal from comparator <highlight><bold>220</bold></highlight>, and outputs the selected path metric as a path metric PM10 to adders <highlight><bold>214</bold></highlight>, <highlight><bold>216</bold></highlight>. Adder <highlight><bold>216</bold></highlight> adds branch metric BM&minus; from branch metric operation unit <highlight><bold>110</bold></highlight> and path metric PM10 from selector <highlight><bold>224</bold></highlight>, and outputs the result to flip-flop <highlight><bold>234</bold></highlight>. Flip-flop <highlight><bold>234</bold></highlight> delays the result obtained from adder <highlight><bold>216</bold></highlight> by one cycle of reference clock CLK, and outputs it as a new path metric PM100 to comparator <highlight><bold>221</bold></highlight>. Flip-flop <highlight><bold>235</bold></highlight> latches the select signal from comparator <highlight><bold>220</bold></highlight> by one cycle of reference clock CLK, and outputs the latched select signal as a select signal SEL<highlight><bold>100</bold></highlight> to path memory <highlight><bold>112</bold></highlight>. </paragraph>
<paragraph id="P-0092" lvl="0"><number>&lsqb;0092&rsqb;</number> Comparator <highlight><bold>221</bold></highlight> compares a path metric PM100 with a path metric PM000 and outputs a select signal for selecting the smaller path metric to selector <highlight><bold>225</bold></highlight> and flip-flop <highlight><bold>237</bold></highlight>. Selector <highlight><bold>225</bold></highlight> selects the smaller one of path metrics PM100, PM000 based on the select signal from comparator <highlight><bold>221</bold></highlight>, and outputs the selected path metric as a path metric PM00 to adders <highlight><bold>215</bold></highlight>, <highlight><bold>217</bold></highlight>. Adder <highlight><bold>217</bold></highlight> adds branch metric BM&minus; from branch metric operation unit <highlight><bold>110</bold></highlight> and path metric PM00 from selector <highlight><bold>225</bold></highlight>, and outputs the result to flip-flop <highlight><bold>236</bold></highlight>. Flip-flop <highlight><bold>236</bold></highlight> delays the result obtained from adder <highlight><bold>217</bold></highlight> by one cycle of reference clock CLK, and outputs it as a new path metric PM000 to comparator <highlight><bold>221</bold></highlight>. Flip-flop <highlight><bold>237</bold></highlight> latches the select signal from comparator <highlight><bold>221</bold></highlight> by one cycle of reference clock CLK, and outputs the latched select signal as a select signal SEL<highlight><bold>000</bold></highlight> to path memory <highlight><bold>112</bold></highlight>. </paragraph>
<paragraph id="P-0093" lvl="0"><number>&lsqb;0093&rsqb;</number> Adder <highlight><bold>212</bold></highlight> adds path metric PM11 from selector <highlight><bold>222</bold></highlight> and branch metric BM0 from branch metric operation unit <highlight><bold>110</bold></highlight>, and outputs the result to flip-flop <highlight><bold>230</bold></highlight>. Flip-flop <highlight><bold>230</bold></highlight> delays the result obtained from adder <highlight><bold>212</bold></highlight> by one cycle of reference clock CLK, and outputs it as path metric PM110 to comparator <highlight><bold>220</bold></highlight>. </paragraph>
<paragraph id="P-0094" lvl="0"><number>&lsqb;0094&rsqb;</number> Adder <highlight><bold>213</bold></highlight> adds path metric PM01 from selector <highlight><bold>223</bold></highlight> and branch metric BM0 from branch metric operation unit <highlight><bold>110</bold></highlight>, and outputs the result to flip-flop <highlight><bold>231</bold></highlight>. Flip-flop <highlight><bold>231</bold></highlight> delays the result obtained from adder <highlight><bold>213</bold></highlight> by one cycle of reference clock CLK, and outputs it as path metric PM010 to comparator <highlight><bold>220</bold></highlight>. </paragraph>
<paragraph id="P-0095" lvl="0"><number>&lsqb;0095&rsqb;</number> Adder <highlight><bold>214</bold></highlight> adds path metric PM10 from selector <highlight><bold>224</bold></highlight> and branch metric BM0 from branch metric operation unit <highlight><bold>110</bold></highlight>, and outputs the result to flip-flop <highlight><bold>232</bold></highlight>. Flip-flop <highlight><bold>232</bold></highlight> delays the result obtained from adder <highlight><bold>214</bold></highlight> by one cycle of reference clock CLK, and outputs it as path metric PM101 to comparator <highlight><bold>219</bold></highlight>. </paragraph>
<paragraph id="P-0096" lvl="0"><number>&lsqb;0096&rsqb;</number> Adder <highlight><bold>215</bold></highlight> adds path metric PM00 from selector <highlight><bold>225</bold></highlight> and branch metric BM0 from branch metric operation unit <highlight><bold>110</bold></highlight>, and outputs the result to flip-flop <highlight><bold>233</bold></highlight>. Flip-flop <highlight><bold>233</bold></highlight> delays the result obtained from adder <highlight><bold>215</bold></highlight> by one cycle of reference clock CLK, and outputs it as path metric PM001 to comparator <highlight><bold>219</bold></highlight>. </paragraph>
<paragraph id="P-0097" lvl="0"><number>&lsqb;0097&rsqb;</number> As such, path metric operation unit <highlight><bold>111</bold></highlight> calculates accumulative errors (path metrics) with respect to branch metrics BM&plus;, BM0, BM&minus; received from branch metric operation unit <highlight><bold>110</bold></highlight>, and outputs select signals SEL<highlight><bold>000</bold></highlight>, SEL<highlight><bold>100</bold></highlight>, SEL<highlight><bold>011</bold></highlight>, SEL<highlight><bold>111</bold></highlight> for selecting the smaller accumulative errors to path memory <highlight><bold>112</bold></highlight>. </paragraph>
<paragraph id="P-0098" lvl="0"><number>&lsqb;0098&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 8</cross-reference>, path memory <highlight><bold>112</bold></highlight> includes flip-flops <highlight><bold>301</bold></highlight>-<highlight><bold>324</bold></highlight>, selectors <highlight><bold>325</bold></highlight>-<highlight><bold>340</bold></highlight>, and a maximum likelihood data stream determination means <highlight><bold>341</bold></highlight>. Flip-flops <highlight><bold>301</bold></highlight>, <highlight><bold>302</bold></highlight>, <highlight><bold>304</bold></highlight> and <highlight><bold>305</bold></highlight> latch digital data &ldquo;1&rdquo; being a power supply voltage VCC supplied from a power supply node <highlight><bold>342</bold></highlight> by one cycle of reference clock CLK, and output the latched digital data &ldquo;1&rdquo; to selectors <highlight><bold>325</bold></highlight> and <highlight><bold>326</bold></highlight>, selectors <highlight><bold>327</bold></highlight> and <highlight><bold>328</bold></highlight>, selectors <highlight><bold>331</bold></highlight> and <highlight><bold>332</bold></highlight>, and selectors <highlight><bold>325</bold></highlight> and <highlight><bold>326</bold></highlight>, respectively. Flip-flops <highlight><bold>303</bold></highlight>, <highlight><bold>306</bold></highlight>, <highlight><bold>307</bold></highlight> and <highlight><bold>308</bold></highlight> latch digital data &ldquo;0&rdquo; being a ground voltage GND supplied from a ground node <highlight><bold>343</bold></highlight> by one cycle of reference clock CLK, and outputs the latched digital data &ldquo;0&rdquo; to selectors <highlight><bold>329</bold></highlight> and <highlight><bold>330</bold></highlight>, selectors <highlight><bold>327</bold></highlight> and <highlight><bold>328</bold></highlight>, selectors <highlight><bold>329</bold></highlight> and <highlight><bold>330</bold></highlight>, and selectors <highlight><bold>331</bold></highlight> and <highlight><bold>332</bold></highlight>, respectively. </paragraph>
<paragraph id="P-0099" lvl="0"><number>&lsqb;0099&rsqb;</number> Selector <highlight><bold>325</bold></highlight> selects either one of two pieces of digital data input from flip-flops <highlight><bold>301</bold></highlight>, <highlight><bold>305</bold></highlight> based on select signal SEL<highlight><bold>111</bold></highlight>, and outputs the selected digital data to flip-flop <highlight><bold>309</bold></highlight>. Selector <highlight><bold>326</bold></highlight> selects either one of the two pieces of digital data input from flip-flops <highlight><bold>301</bold></highlight>, <highlight><bold>305</bold></highlight> based on select signal SEL<highlight><bold>011</bold></highlight>, and outputs the selected digital data to flip-flop <highlight><bold>310</bold></highlight>. Selector <highlight><bold>327</bold></highlight> selects either one of the two pieces of digital data input from flip-flops <highlight><bold>302</bold></highlight>, <highlight><bold>306</bold></highlight> based on select signal SEL<highlight><bold>111</bold></highlight>, and outputs the selected digital data to flip-flop <highlight><bold>311</bold></highlight>. Selector <highlight><bold>328</bold></highlight> selects either one of the two pieces of digital data input from flip-flops <highlight><bold>302</bold></highlight>, <highlight><bold>306</bold></highlight> based on select signal SEL<highlight><bold>011</bold></highlight>, and outputs the selected digital data to flip-flop <highlight><bold>312</bold></highlight>. </paragraph>
<paragraph id="P-0100" lvl="0"><number>&lsqb;0100&rsqb;</number> Selector <highlight><bold>329</bold></highlight> selects either one of the two pieces of digital data input from flip-flops <highlight><bold>303</bold></highlight>, <highlight><bold>307</bold></highlight> based on select signal SEL<highlight><bold>100</bold></highlight>, and outputs the selected digital data to flip-flop <highlight><bold>313</bold></highlight>. Selector <highlight><bold>330</bold></highlight> selects either one of the two pieces of digital data input from flip-flops <highlight><bold>303</bold></highlight>, <highlight><bold>307</bold></highlight> based on select signal SEL<highlight><bold>000</bold></highlight>, and outputs the selected digital data to flip-flop <highlight><bold>314</bold></highlight>. Selector <highlight><bold>331</bold></highlight> selects either one of the two pieces of digital data input from flip-flops <highlight><bold>304</bold></highlight>, <highlight><bold>308</bold></highlight> based on select signal SEL<highlight><bold>100</bold></highlight>, and outputs the selected digital data to flip-flop <highlight><bold>315</bold></highlight>. Selector <highlight><bold>332</bold></highlight> selects either one of the two pieces of digital data input from flip-flops <highlight><bold>304</bold></highlight>, <highlight><bold>308</bold></highlight> based on select signal SEL<highlight><bold>000</bold></highlight>, and outputs the selected digital data to flip-flop <highlight><bold>316</bold></highlight>. </paragraph>
<paragraph id="P-0101" lvl="0"><number>&lsqb;0101&rsqb;</number> Flip-flops <highlight><bold>309</bold></highlight>-<highlight><bold>316</bold></highlight> latch the digital data input from selectors <highlight><bold>325</bold></highlight>-<highlight><bold>332</bold></highlight>, respectively, by one cycle of reference clock CLK, and output the latched digital data to corresponding selectors in the succeeding stage. </paragraph>
<paragraph id="P-0102" lvl="0"><number>&lsqb;0102&rsqb;</number> Selectors <highlight><bold>333</bold></highlight> and <highlight><bold>335</bold></highlight> each select either one of two pieces of digital data based on select signal SEL<highlight><bold>111</bold></highlight>. Selectors <highlight><bold>334</bold></highlight> and <highlight><bold>336</bold></highlight> each select either one of two pieces of digital data based on select signal SEL<highlight><bold>011</bold></highlight>. Selectors <highlight><bold>337</bold></highlight> and <highlight><bold>339</bold></highlight> each select either one of two pieces of digital data based on select signal SEL<highlight><bold>100</bold></highlight>. Selectors <highlight><bold>338</bold></highlight> and <highlight><bold>340</bold></highlight> each select either one of two pieces of digital data based on select signal SEL<highlight><bold>000</bold></highlight>. </paragraph>
<paragraph id="P-0103" lvl="0"><number>&lsqb;0103&rsqb;</number> Flip-flops <highlight><bold>317</bold></highlight>-<highlight><bold>324</bold></highlight> latch the digital data from selectors <highlight><bold>333</bold></highlight>-<highlight><bold>340</bold></highlight>, respectively, by one cycle of reference clock CLK, and output the latched digital data to maximum likelihood data stream determination means <highlight><bold>341</bold></highlight>. Maximum likelihood data stream determination means <highlight><bold>341</bold></highlight> selects and outputs the most likely binary data by means of majority decision, path metric minimized method or the like. </paragraph>
<paragraph id="P-0104" lvl="0"><number>&lsqb;0104&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 9</cross-reference>, expected value correction circuit <highlight><bold>108</bold></highlight> includes a comparator <highlight><bold>603</bold></highlight>, a threshold value setting unit <highlight><bold>604</bold></highlight>, an absolute value operation unit <highlight><bold>605</bold></highlight>, a minimal difference determination unit <highlight><bold>606</bold></highlight>, an AND gate <highlight><bold>607</bold></highlight>, flip-flops <highlight><bold>609</bold></highlight> and <highlight><bold>615</bold></highlight>, an expected value operation unit <highlight><bold>614</bold></highlight>, an averaging circuit <highlight><bold>616</bold></highlight>, and a difference circuit <highlight><bold>617</bold></highlight>. </paragraph>
<paragraph id="P-0105" lvl="0"><number>&lsqb;0105&rsqb;</number> Absolute value operation unit <highlight><bold>605</bold></highlight> calculates absolute values &verbar;D&plus;&verbar;, &verbar;D0&verbar;, &verbar;D&minus;&verbar; of errors D&plus;, D0, D&minus; input from branch metric operation unit <highlight><bold>110</bold></highlight> in Viterbi decoder <highlight><bold>107</bold></highlight>, and outputs the calculated absolute values &verbar;D&plus;&verbar;, &verbar;D0&verbar;, &verbar;D&minus;&verbar; to minimal difference determination unit <highlight><bold>606</bold></highlight>, and also outputs absolute value &verbar;D0&verbar; to flip-flop <highlight><bold>609</bold></highlight>. </paragraph>
<paragraph id="P-0106" lvl="0"><number>&lsqb;0106&rsqb;</number> Difference circuit <highlight><bold>617</bold></highlight> includes a subtracter <highlight><bold>600</bold></highlight>, a flip-flop <highlight><bold>601</bold></highlight>, and an absolute value operation unit <highlight><bold>602</bold></highlight>. Flip-flop <highlight><bold>601</bold></highlight> latches error D0 by one cycle of reference clock CLK, and outputs the latched error D0 to subtracter <highlight><bold>600</bold></highlight>. Subtracter <highlight><bold>600</bold></highlight> calculates a difference Ad between the error from flip-flop <highlight><bold>601</bold></highlight> and error D0, and outputs the calculated result to absolute value operation unit <highlight><bold>602</bold></highlight>. Absolute value operation unit <highlight><bold>602</bold></highlight> calculates an absolute value &verbar;&Dgr;d&verbar; of difference &Dgr;d, and outputs it to comparator <highlight><bold>603</bold></highlight>. Threshold value setting unit <highlight><bold>604</bold></highlight> holds a threshold value Dset having been set by a personal computer, microcomputer, circuit or the like, and outputs the threshold value Dset to comparator <highlight><bold>603</bold></highlight>. More specifically, with respect to the error D0 between the sampling data and expected value E0, difference circuit <highlight><bold>617</bold></highlight> calculates the change of error D0 from one clock ago, and outputs the calculated result to comparator <highlight><bold>603</bold></highlight>. Thus, absolute value &verbar;&Dgr;d&verbar; indicates a change of the sampling data from one clock ago. </paragraph>
<paragraph id="P-0107" lvl="0"><number>&lsqb;0107&rsqb;</number> Comparator <highlight><bold>603</bold></highlight> compares absolute value &verbar;&Dgr;d&verbar; with threshold value Dset, and outputs a signal Dena having an L (logical low) level when &verbar;&Dgr;d&verbar;&gt;Dset and an H (logical high) level when &verbar;&Dgr;d&verbar;&lt;Dset to AND gate <highlight><bold>607</bold></highlight>. More specifically, comparator <highlight><bold>603</bold></highlight> outputs, to AND gate <highlight><bold>607</bold></highlight>, signal Dena that attains an L level in a region where variation of the sampling data is large and an H level in a region where the variation of the sampling data is small. </paragraph>
<paragraph id="P-0108" lvl="0"><number>&lsqb;0108&rsqb;</number> Minimal difference determination unit <highlight><bold>606</bold></highlight> determines which is the smallest among the input absolute values &verbar;D&plus;&verbar;, &verbar;D0&verbar; and &verbar;D&minus;&verbar;, and outputs a signal minD&plus; of an H level when absolute value &verbar;D&plus;&verbar; is the smallest, outputs a signal minD&minus; of an H level when absolute value &verbar;D&minus;&verbar; is the smallest, and outputs a signal of an L level when absolute value &verbar;D0&verbar; is the smallest. AND gate <highlight><bold>607</bold></highlight> carries out logical AND of signal minD&plus; or minD&minus; and signal Dena, and outputs a signal Dena&plus; or Dena&minus;. Flip-flop <highlight><bold>609</bold></highlight> extracts absolute values &verbar;D0&verbar; in a time period where signal Dena&plus; or Dena&minus; is at an H level, and outputs the extracted absolute values to averaging circuit <highlight><bold>616</bold></highlight>. Flip-flop <highlight><bold>615</bold></highlight> latches signal Dena&plus; or Dena&minus; by one cycle of reference clock CLK, and outputs the latched signal Dena&plus; or Dena&minus; to averaging circuit <highlight><bold>616</bold></highlight>. </paragraph>
<paragraph id="P-0109" lvl="0"><number>&lsqb;0109&rsqb;</number> Averaging circuit <highlight><bold>616</bold></highlight> consists of multipliers <highlight><bold>610</bold></highlight> and <highlight><bold>612</bold></highlight>, an adder <highlight><bold>613</bold></highlight>, and a flip-flop <highlight><bold>611</bold></highlight>. Multiplier <highlight><bold>610</bold></highlight> multiplies absolute value &verbar;D0&verbar; latched by flip-flop <highlight><bold>609</bold></highlight> by &agr;(0&lt;&agr;&lt;1) for output to adder <highlight><bold>613</bold></highlight>. Adder <highlight><bold>613</bold></highlight> adds the output value of multiplier <highlight><bold>610</bold></highlight> and an output value of multiplier <highlight><bold>612</bold></highlight> and outputs it to flip-flop <highlight><bold>611</bold></highlight>. Flip-flop <highlight><bold>611</bold></highlight> extracts the average values output from adder <highlight><bold>613</bold></highlight> in a time period where signal Dena&plus; or Dena&minus; is at an H level, and outputs the extracted average values to multiplier <highlight><bold>612</bold></highlight> and to expected value operation unit <highlight><bold>614</bold></highlight>. Multiplier <highlight><bold>612</bold></highlight> multiplies the average value from flip-flop <highlight><bold>611</bold></highlight> by (1&minus;&agr;) to output to adder <highlight><bold>613</bold></highlight>. As such, averaging circuit <highlight><bold>616</bold></highlight> adds the absolute value &verbar;D0&verbar; multiplied by &agr; and the average value of one clock ago multiplied by (1&minus;&agr;) to average the absolute values &verbar;D0&verbar;. </paragraph>
<paragraph id="P-0110" lvl="0"><number>&lsqb;0110&rsqb;</number> Expected value operation unit <highlight><bold>614</bold></highlight> calculates a corrected expected value E&plus; based on the output value from averaging circuit <highlight><bold>616</bold></highlight> and also calculates a corrected expected value E&minus; that takes a position symmetrical to the calculated, corrected expected value E&plus; with respect to a DC level of the reproduction signal or expected value E0, and outputs the corrected expected values E&plus; and E&minus; to Viterbi decoder <highlight><bold>107</bold></highlight>. </paragraph>
<paragraph id="P-0111" lvl="0"><number>&lsqb;0111&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 10, a</cross-reference> correcting operation of expected values in expected value correction circuit <highlight><bold>108</bold></highlight> is described. The reproduction signal detected from magneto-optical disk <highlight><bold>101</bold></highlight> by optical pickup <highlight><bold>102</bold></highlight> has its high or low frequencies cut by BPF <highlight><bold>104</bold></highlight>, is sampled by AD converter <highlight><bold>105</bold></highlight> in synchronization with reference clock CLK, and has its waveform equalized by equalizer <highlight><bold>106</bold></highlight> before being input to Viterbi decoder <highlight><bold>107</bold></highlight>. Thus, Viterbi decoder <highlight><bold>107</bold></highlight> receives reproduction signal RF of multilevel data. Branch metric operation unit <highlight><bold>110</bold></highlight> in Viterbi decoder <highlight><bold>107</bold></highlight> calculates errors D&plus;, D0, D&minus; between each sampling data of the input reproduction signal RF and expected values E&plus;, E0, E&minus;, and outputs them to expected value correction circuit <highlight><bold>108</bold></highlight>. </paragraph>
<paragraph id="P-0112" lvl="0"><number>&lsqb;0112&rsqb;</number> In expected value correction circuit <highlight><bold>108</bold></highlight>, absolute value operation unit <highlight><bold>605</bold></highlight> calculates absolute values of input errors D&plus;, D0, D&minus;, and outputs the calculated absolute values &verbar;D&plus;&verbar;, &verbar;D0&verbar;, &verbar;D&minus;&verbar; to minimal difference determination unit <highlight><bold>606</bold></highlight>, and also outputs absolute value &verbar;D0&verbar; to flip-flop <highlight><bold>609</bold></highlight>. Minimal difference determination unit <highlight><bold>606</bold></highlight> generates signal minD&plus; or minD&minus; based on absolute values &verbar;D&plus;&verbar;, &verbar;D0&verbar;, &verbar;D&minus;&verbar; in the above-described manner, and outputs the generated signal minD&plus; or minD&minus; to AND gate <highlight><bold>607</bold></highlight>. </paragraph>
<paragraph id="P-0113" lvl="0"><number>&lsqb;0113&rsqb;</number> Difference circuit <highlight><bold>617</bold></highlight> calculates a difference of error D0 with that of one clock ago, and outputs an absolute value &verbar;&Dgr;d&verbar; of the calculated difference to comparator <highlight><bold>603</bold></highlight>. Comparator <highlight><bold>603</bold></highlight> compares absolute value &verbar;&Dgr;d&verbar; with threshold value Dset, and outputs a signal Dena to AND gate <highlight><bold>607</bold></highlight>. AND gate <highlight><bold>607</bold></highlight> carries out logical AND of signal minD&plus; or minD&minus; and signal Dena, and outputs signal Dena&plus; or Dena&minus; to flip-flop <highlight><bold>615</bold></highlight>. Flip-flop <highlight><bold>615</bold></highlight> latches signal Dena&plus; or Dena&minus; by one cycle of reference clock CLK, and outputs the latched signal Dena&plus; or Dena&minus; to averaging circuit <highlight><bold>616</bold></highlight>. </paragraph>
<paragraph id="P-0114" lvl="0"><number>&lsqb;0114&rsqb;</number> Flip-flop <highlight><bold>609</bold></highlight> extracts absolute values &verbar;D0&verbar; output from absolute value operation unit <highlight><bold>605</bold></highlight> in a time period where signal Dena&plus; or Dena&minus; is at an H level, and outputs the extracted absolute values to averaging circuit <highlight><bold>616</bold></highlight>. </paragraph>
<paragraph id="P-0115" lvl="0"><number>&lsqb;0115&rsqb;</number> Averaging circuit <highlight><bold>616</bold></highlight> averages absolute values &verbar;D0&verbar; in the above-described manner, and outputs the averaged absolute value to expected value operation unit <highlight><bold>614</bold></highlight>. In this case, the absolute values &verbar;D0&verbar; input to averaging circuit <highlight><bold>616</bold></highlight> are absolute values of the errors between the sampling data and expected value E0, and therefore, they should approximate the absolute value of the first desired value or the second desired value during the time period where signal Dena&plus; or Dena&minus; is at an H level. More specifically, by having flip-flop <highlight><bold>609</bold></highlight> latching absolute values &verbar;D0&verbar; during the time period where signal Dena&plus; or Dena&minus; is at an H level, values of reproduction signal RF close to the absolute value of the first desired value or the second desired value are extracted. </paragraph>
<paragraph id="P-0116" lvl="0"><number>&lsqb;0116&rsqb;</number> Expected value operation unit <highlight><bold>614</bold></highlight> makes correction of the expected values based on the average value input from averaging circuit <highlight><bold>616</bold></highlight> in the above-described manner, and outputs the corrected expected values E&plus;, E&minus; to Viterbi decoder <highlight><bold>107</bold></highlight>. </paragraph>
<paragraph id="P-0117" lvl="0"><number>&lsqb;0117&rsqb;</number> As such, expected value correction circuit <highlight><bold>108</bold></highlight> extracts amplitude values of reproduction signal RF in regions <highlight><bold>11</bold></highlight>-<highlight><bold>16</bold></highlight> where the signal has approximately uniform amplitudes, and obtains the average values of the extracted amplitude values to correct the expected values E&plus;, E&minus;. Here, expected value E0 is not corrected on the presumption that reproduction signal RF has its plus side and minus side symmetrical to each other with respect to the DC component level of the reproduction signal. </paragraph>
<paragraph id="P-0118" lvl="0"><number>&lsqb;0118&rsqb;</number> Referring again to <cross-reference target="DRAWINGS">FIG. 5, a</cross-reference> signal reproducing operation in optical disk apparatus <highlight><bold>100</bold></highlight> is described. Here, it is assumed that driving of the spindle motor, driving of a semiconductor laser included in optical pickup <highlight><bold>102</bold></highlight>, and tracking servo and focus servo of an objective lens included in optical pickup <highlight><bold>102</bold></highlight> have been completed. </paragraph>
<paragraph id="P-0119" lvl="0"><number>&lsqb;0119&rsqb;</number> Optical pickup <highlight><bold>102</bold></highlight> irradiates laser light onto magneto-optical disk <highlight><bold>101</bold></highlight> and detects its reflected light to detect fine clock mark signal TPP and reproduction signal RF. It outputs the detected reproduction signal RF and fine clock mark signal TPP to BPF <highlight><bold>104</bold></highlight> and PLL circuit <highlight><bold>103</bold></highlight>, respectively. </paragraph>
<paragraph id="P-0120" lvl="0"><number>&lsqb;0120&rsqb;</number> PLL circuit <highlight><bold>103</bold></highlight> generates reference clock CLK based on fine clock mark signal TPP, and outputs the generated reference clock CLK to AD converter <highlight><bold>105</bold></highlight>, equalizer <highlight><bold>106</bold></highlight>, Viterbi decoder <highlight><bold>107</bold></highlight> and expected value correction circuit <highlight><bold>108</bold></highlight>. </paragraph>
<paragraph id="P-0121" lvl="0"><number>&lsqb;0121&rsqb;</number> BPF <highlight><bold>104</bold></highlight> cuts high or low frequencies of the reproduction signal from optical pickup <highlight><bold>102</bold></highlight>. AD converter <highlight><bold>105</bold></highlight> samples the reproduction signal in synchronization with reference clock CLK. Equalizer <highlight><bold>106</bold></highlight> performs waveform-equalization of the reproduction signal being the sampling data in synchronization with reference clock CLK, and outputs the reproduction signal to Viterbi decoder <highlight><bold>107</bold></highlight>. </paragraph>
<paragraph id="P-0122" lvl="0"><number>&lsqb;0122&rsqb;</number> In response, branch metric operation unit <highlight><bold>110</bold></highlight> in Viterbi decoder <highlight><bold>107</bold></highlight> calculates errors D&plus;, D0, D&minus; of the sampling data and expected values E&plus;, E0, E&minus;, and outputs them to expected value correction circuit <highlight><bold>108</bold></highlight>. Expected value correction circuit <highlight><bold>108</bold></highlight> corrects expected values E&plus;, E&minus; in the above-described manner, and outputs the corrected expected values E&plus;, E&minus; to Viterbi decoder <highlight><bold>107</bold></highlight>. Viterbi decoder <highlight><bold>107</bold></highlight> employs the corrected expected values E&plus;, E&minus; and expected value E0 being held to convert reproduction signal RF from multilevel data to binary data in the above-described manner, and outputs the reproduction signal DAT of binary data. Thereafter, reproduction signal DAT is subjected to demodulation before being output as reproduction data. Thus, the signal reproducing operation from magneto-optical disk <highlight><bold>101</bold></highlight> is completed. </paragraph>
<paragraph id="P-0123" lvl="0"><number>&lsqb;0123&rsqb;</number> According to the first embodiment, the optical disk apparatus is provided with the expected value correction circuit which corrects the expected values in Viterbi decoding in accordance with the amplitude of the reproduction signal. Accordingly, the Viterbi decoding is performed accurately even if the reproduction signal varies in amplitude. As a result, accurate signal reproduction is ensured. </paragraph>
<paragraph id="P-0124" lvl="0"><number>&lsqb;0124&rsqb;</number> Second Embodiment </paragraph>
<paragraph id="P-0125" lvl="0"><number>&lsqb;0125&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 11</cross-reference>, the optical disk apparatus <highlight><bold>100</bold></highlight>A according to the second embodiment is identical to optical disk apparatus <highlight><bold>100</bold></highlight> except that the expected value correction circuit <highlight><bold>108</bold></highlight> of optical disk apparatus <highlight><bold>100</bold></highlight> is replaced with an expected value correction circuit <highlight><bold>108</bold></highlight>A. </paragraph>
<paragraph id="P-0126" lvl="0"><number>&lsqb;0126&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 12</cross-reference>, the expected value correction circuit <highlight><bold>108</bold></highlight>A includes a selector <highlight><bold>701</bold></highlight>, a minimal difference determination unit <highlight><bold>702</bold></highlight>, a difference circuit <highlight><bold>617</bold></highlight>, a comparator <highlight><bold>603</bold></highlight>, a threshold value setting unit <highlight><bold>604</bold></highlight>, an AND gate <highlight><bold>608</bold></highlight>, flip-flops <highlight><bold>609</bold></highlight> and <highlight><bold>615</bold></highlight>, an averaging circuit <highlight><bold>707</bold></highlight>, and an expected value operation unit <highlight><bold>708</bold></highlight>. Comparator <highlight><bold>603</bold></highlight>, threshold value setting unit <highlight><bold>604</bold></highlight>, flip-flops <highlight><bold>609</bold></highlight> and <highlight><bold>615</bold></highlight>, and difference circuit <highlight><bold>617</bold></highlight> are identical to those described above. </paragraph>
<paragraph id="P-0127" lvl="0"><number>&lsqb;0127&rsqb;</number> Minimal difference determination unit <highlight><bold>702</bold></highlight> determines which is the smallest among errors D&plus;, D0, D&minus; input from Viterbi decoder <highlight><bold>107</bold></highlight>, and generates, when error D&plus; is the smallest, signal minD&plus; of an H level and a select signal for selecting error D&plus;. It generates signal minD&minus; of an H level and a select signal for selecting error D&minus; when error D&minus; is the smallest, and generates a signal of an H level when error D0 is the smallest. Minimal difference determination unit <highlight><bold>702</bold></highlight> outputs the generated signal minD&plus; or minD&minus; to AND gate <highlight><bold>608</bold></highlight>, and outputs the select signal to selector <highlight><bold>701</bold></highlight>. </paragraph>
<paragraph id="P-0128" lvl="0"><number>&lsqb;0128&rsqb;</number> Selector <highlight><bold>701</bold></highlight> selects either one of errors D&plus;, D&minus; based on the select signal from minimal difference determination unit <highlight><bold>702</bold></highlight>, and outputs the selected error D&plus; or D&minus; to flip-flop <highlight><bold>609</bold></highlight> and difference circuit <highlight><bold>617</bold></highlight>. AND gate <highlight><bold>608</bold></highlight> carries out logical AND of signal minD&plus; or minD&minus; and signal Dena from comparator <highlight><bold>603</bold></highlight>. </paragraph>
<paragraph id="P-0129" lvl="0"><number>&lsqb;0129&rsqb;</number> Averaging circuit <highlight><bold>707</bold></highlight> includes a multiplier <highlight><bold>704</bold></highlight>, an adder <highlight><bold>706</bold></highlight>, a flip-flop <highlight><bold>703</bold></highlight> and a limiter <highlight><bold>705</bold></highlight>. Multiplier <highlight><bold>704</bold></highlight> multiplies the output value of flip-flop <highlight><bold>609</bold></highlight> by &bgr;(0&lt;&bgr;&lt;1), and outputs it to adder <highlight><bold>706</bold></highlight>. Adder <highlight><bold>706</bold></highlight> adds the output value of multiplier <highlight><bold>704</bold></highlight> and an output value of limiter <highlight><bold>705</bold></highlight>. Flip-flop <highlight><bold>703</bold></highlight> latches the output value of adder <highlight><bold>706</bold></highlight> for a time period where signal Dena&plus; or Dena&minus; latched by flip-flop <highlight><bold>615</bold></highlight> by one cycle of reference clock CLK is at an H level, and outputs the latched output value to limiter <highlight><bold>705</bold></highlight>. Limiter <highlight><bold>705</bold></highlight> has preset upper and lower limit values and, when an input value falls outside the range between the lower and upper limit values, outputs the upper limit value or the lower limit value as an output value to adder <highlight><bold>706</bold></highlight> and to expected value operation unit <highlight><bold>708</bold></highlight>. </paragraph>
<paragraph id="P-0130" lvl="0"><number>&lsqb;0130&rsqb;</number> Averaging circuit <highlight><bold>707</bold></highlight> adds error D&plus; or D&minus; input and an average value of one clock ago to calculate the average value of error D&plus; or D&minus;, and outputs it to expected value operation unit <highlight><bold>708</bold></highlight>. Averaging circuit <highlight><bold>707</bold></highlight> is provided with limiter <highlight><bold>705</bold></highlight> because of the following reason. Since a value being input to averaging circuit <highlight><bold>707</bold></highlight> is not an absolute value of error D&plus; or D&minus;, averaging circuit <highlight><bold>707</bold></highlight> should prevent the average value from largely shifting in a minus direction during the averaging process, so as to suppress overdrive of itself. </paragraph>
<paragraph id="P-0131" lvl="0"><number>&lsqb;0131&rsqb;</number> Expected value operation unit <highlight><bold>708</bold></highlight> corrects expected value E&plus; or E&minus; based on the input from averaging circuit <highlight><bold>707</bold></highlight>, and outputs the corrected expected value E&plus; or E&minus; to Viterbi decoder <highlight><bold>107</bold></highlight>. </paragraph>
<paragraph id="P-0132" lvl="0"><number>&lsqb;0132&rsqb;</number> A correcting operation of expected values E&plus;, E&minus; in expected value correction circuit <highlight><bold>108</bold></highlight>A is now described. Minimal difference determination unit <highlight><bold>702</bold></highlight> determines which is the smallest among the input errors D&plus;, D0, D&minus; and, as described above, generates signal minD&plus; or minD&minus; and a select signal, and outputs the signal minD&plus; or minD&minus; to AND gate <highlight><bold>608</bold></highlight> and the select signal to selector <highlight><bold>701</bold></highlight>. Selector <highlight><bold>701</bold></highlight> selects error D&plus; or D&minus; based on the select signal from minimal difference determination unit <highlight><bold>702</bold></highlight>, and outputs it to difference circuit <highlight><bold>617</bold></highlight> and to flip-flop <highlight><bold>609</bold></highlight>. </paragraph>
<paragraph id="P-0133" lvl="0"><number>&lsqb;0133&rsqb;</number> Difference circuit <highlight><bold>617</bold></highlight> calculates a difference of input error D&plus; or D&minus; with that of one clock ago, and outputs an absolute value &verbar;&Dgr;d&verbar; of the calculated difference to comparator <highlight><bold>603</bold></highlight>. Comparator <highlight><bold>603</bold></highlight> compares absolute value &verbar;&Dgr;d&verbar; with threshold value Dset, and outputs signal Dena to AND gate <highlight><bold>608</bold></highlight>. AND gate <highlight><bold>608</bold></highlight> then carries out logical AND of signal minD&plus; or minD&minus; and signal Dena, and outputs signal Dena&plus; or Dena&minus; to flip-flops <highlight><bold>609</bold></highlight> and <highlight><bold>615</bold></highlight>. Flip-flop <highlight><bold>609</bold></highlight> extracts, of the errors D&plus; or D&minus; selected by selector <highlight><bold>701</bold></highlight>, those in a time period where signal Dena&plus; or Dena&minus; is at an H level, and outputs the extracted errors to averaging circuit <highlight><bold>707</bold></highlight>. </paragraph>
<paragraph id="P-0134" lvl="0"><number>&lsqb;0134&rsqb;</number> Flip-flop <highlight><bold>615</bold></highlight> latches signal Dena&plus; or Dena&minus; by one cycle of reference clock CLK, and outputs the latched signal Dena&plus; or Dena&minus; to averaging circuit <highlight><bold>707</bold></highlight>. In response, averaging circuit <highlight><bold>707</bold></highlight> calculates an average value of errors D&plus; or D&minus; in the above-described manner, and outputs the calculated average value to expected value operation unit <highlight><bold>708</bold></highlight>. Expected value operation unit <highlight><bold>708</bold></highlight> corrects expected values E&plus;, E&minus; based on the average value input from averaging circuit <highlight><bold>707</bold></highlight>, and outputs the corrected expected values E&plus;, E&minus; to Viterbi decoder <highlight><bold>107</bold></highlight>. In this case, expected value operation unit <highlight><bold>708</bold></highlight> holds reference values for expected values E&plus;, E&minus;. It corrects the reference values using the average value input from averaging circuit <highlight><bold>707</bold></highlight>, and outputs the corrected expected values E&plus;, E&minus; to Viterbi decoder <highlight><bold>107</bold></highlight>. More specifically, expected value operation unit <highlight><bold>708</bold></highlight> holds reference expected values, and adds the average value received from averaging circuit <highlight><bold>707</bold></highlight> to the reference expected value to correct the expected value E&plus;. It outputs the corrected expected value E&plus; as well as the expected value E&minus; that takes a position symmetrical to the corrected expected value E&plus; with respect to the DC component of the reproduction signal or expected value E0. </paragraph>
<paragraph id="P-0135" lvl="0"><number>&lsqb;0135&rsqb;</number> As such, expected value correction circuit <highlight><bold>108</bold></highlight>A extracts errors between the sampling data of reproduction signal RF in regions <highlight><bold>11</bold></highlight>-<highlight><bold>16</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 10</cross-reference> and the expected values, and calculates the average value of the extracted errors to correct expected values E&plus;, E&minus;. </paragraph>
<paragraph id="P-0136" lvl="0"><number>&lsqb;0136&rsqb;</number> Otherwise, the second embodiment is identical to the first embodiment. </paragraph>
<paragraph id="P-0137" lvl="0"><number>&lsqb;0137&rsqb;</number> According to the second embodiment, the optical disk apparatus is provided with the expected value correction circuit which corrects the expected values in Viterbi decoding in accordance with the amplitude of the reproduction signal. As such, accurate Viterbi decoding is possible even if the amplitude of the reproduction signal varies, which ensures accurate signal reproduction. </paragraph>
<paragraph id="P-0138" lvl="0"><number>&lsqb;0138&rsqb;</number> Third Embodiment </paragraph>
<paragraph id="P-0139" lvl="0"><number>&lsqb;0139&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 13</cross-reference>, the optical disk apparatus <highlight><bold>100</bold></highlight>B according to the third embodiment is identical to optical disk apparatus <highlight><bold>100</bold></highlight> except that expected value correction circuit <highlight><bold>108</bold></highlight> is replaced with an expected value correction circuit <highlight><bold>108</bold></highlight>B. </paragraph>
<paragraph id="P-0140" lvl="0"><number>&lsqb;0140&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 14</cross-reference>, the expected value correction circuit <highlight><bold>108</bold></highlight>B includes a comparator <highlight><bold>603</bold></highlight>, a threshold value setting unit <highlight><bold>604</bold></highlight>, an absolute value operation unit <highlight><bold>605</bold></highlight>, a minimal difference determination unit <highlight><bold>801</bold></highlight>, a difference circuit <highlight><bold>617</bold></highlight>, AND gates <highlight><bold>607</bold></highlight>A, <highlight><bold>607</bold></highlight>B, <highlight><bold>607</bold></highlight>C, flip-flops <highlight><bold>609</bold></highlight>A, <highlight><bold>609</bold></highlight>B, <highlight><bold>609</bold></highlight>C, <highlight><bold>615</bold></highlight>A, <highlight><bold>615</bold></highlight>B, <highlight><bold>615</bold></highlight>C, averaging circuits <highlight><bold>616</bold></highlight>A, <highlight><bold>616</bold></highlight>B, <highlight><bold>616</bold></highlight>C, and an expected value operation unit <highlight><bold>802</bold></highlight>. Comparator <highlight><bold>603</bold></highlight>, threshold value setting unit <highlight><bold>604</bold></highlight>, absolute value operation unit <highlight><bold>605</bold></highlight> and difference circuit <highlight><bold>617</bold></highlight> are identical to those described above. Averaging circuits <highlight><bold>616</bold></highlight>A, <highlight><bold>616</bold></highlight>B, <highlight><bold>616</bold></highlight>C each have a circuit configuration identical to that of averaging circuit <highlight><bold>616</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. </paragraph>
<paragraph id="P-0141" lvl="0"><number>&lsqb;0141&rsqb;</number> Minimal difference determination unit <highlight><bold>801</bold></highlight> determines which is the smallest among the absolute values &verbar;D&plus;&verbar;, &verbar;D0&verbar;, &verbar;D&minus;&verbar; input from absolute value operation unit <highlight><bold>605</bold></highlight>, and outputs signal minD&plus; of an H level and signals minD<highlight><bold>0</bold></highlight>, minD&minus; of an L level at the time when absolute value &verbar;D&plus;&verbar; is the smallest, outputs signal minD<highlight><bold>0</bold></highlight> of an H level and signals minD&plus;, minD&minus; of an L level when absolute value &verbar;D0&verbar; is the smallest, and outputs signal minD&minus; of an H level and signals minD&plus;, minD<highlight><bold>0</bold></highlight> of an L level when absolute value &verbar;D&minus;&verbar; is the smallest. </paragraph>
<paragraph id="P-0142" lvl="0"><number>&lsqb;0142&rsqb;</number> AND gate <highlight><bold>607</bold></highlight>A carries out logical AND of signal minD&plus; and signal Dena and outputs signal Dena&plus; to flip-flops <highlight><bold>609</bold></highlight>A, <highlight><bold>615</bold></highlight>A. AND gate <highlight><bold>607</bold></highlight>B carries out logical AND of signal minD<highlight><bold>0</bold></highlight> and signal Dena and outputs signal Dena<highlight><bold>0</bold></highlight> to flip-flops <highlight><bold>609</bold></highlight>B, <highlight><bold>615</bold></highlight>B. AND gate <highlight><bold>607</bold></highlight>C carries out logical AND of signal minD&minus; and signal Dena and outputs signal Dena&minus; to flip-flops <highlight><bold>609</bold></highlight>C, <highlight><bold>615</bold></highlight>C. </paragraph>
<paragraph id="P-0143" lvl="0"><number>&lsqb;0143&rsqb;</number> Flip-flop <highlight><bold>609</bold></highlight>A extracts, from errors D0, those in a time period where signal Dena&plus; is at an H level, and outputs the extracted errors to averaging circuit <highlight><bold>616</bold></highlight>A. Flip-flop <highlight><bold>609</bold></highlight>B extracts, from errors D0, those in a time period where signal Dena<highlight><bold>0</bold></highlight> is at an H level, and outputs the extracted errors to averaging circuit <highlight><bold>616</bold></highlight>B. Flip-flop <highlight><bold>609</bold></highlight>C extracts, from errors D0, those in a time period where signal Dena&minus; is at an H level, and outputs the extracted errors to averaging circuit <highlight><bold>616</bold></highlight>C. </paragraph>
<paragraph id="P-0144" lvl="0"><number>&lsqb;0144&rsqb;</number> Flip-flop <highlight><bold>615</bold></highlight>A latches signal Dena&plus; by one cycle of reference clock CLK, and outputs the latched signal Dena&plus; to averaging circuit <highlight><bold>616</bold></highlight>A. Flip-flop <highlight><bold>615</bold></highlight>B latches signal Dena<highlight><bold>0</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal Dena<highlight><bold>0</bold></highlight> to averaging circuit <highlight><bold>616</bold></highlight>B. Flip-flop <highlight><bold>615</bold></highlight>C latches signal Dena&minus; by one cycle of reference clock CLK, and outputs the latched signal Dena&minus; to averaging circuit <highlight><bold>616</bold></highlight>C. </paragraph>
<paragraph id="P-0145" lvl="0"><number>&lsqb;0145&rsqb;</number> Averaging circuits <highlight><bold>616</bold></highlight>A, <highlight><bold>616</bold></highlight>B, <highlight><bold>616</bold></highlight>C average the input errors in the above-described manner, and output the resultant average values to expected value operation unit <highlight><bold>802</bold></highlight>. Expected value operation unit <highlight><bold>802</bold></highlight> corrects expected values E&plus;, E0, E&minus; based on the input average values, and outputs the corrected expected values E&plus;, E0, E&minus; to Viterbi decoder <highlight><bold>107</bold></highlight>. </paragraph>
<paragraph id="P-0146" lvl="0"><number>&lsqb;0146&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 15</cross-reference>, an operation for correcting expected values E&plus;, E0, E&minus; in expected value correction circuit <highlight><bold>108</bold></highlight>B is described. When errors D&plus;, D0, D&minus; are input from Viterbi decoder <highlight><bold>107</bold></highlight>, absolute value operation unit <highlight><bold>605</bold></highlight> calculates absolute values of errors D&plus;, D0, D&minus;, and outputs the absolute values &verbar;D&plus;&verbar;, &verbar;D0&verbar;, &verbar;D&minus;&verbar; to minimal difference determination unit <highlight><bold>801</bold></highlight>. Minimal difference determination unit <highlight><bold>801</bold></highlight> determines which is the smallest among the input absolute values &verbar;D&plus;&verbar;, &verbar;D0&verbar;, &verbar;D&minus;&verbar;, and generates signal minD&plus; of an H level and signals. minD<highlight><bold>0</bold></highlight>, minD&minus; of an L level when absolute value &verbar;D&plus;&verbar; is the smallest, generates signal minD<highlight><bold>0</bold></highlight> of an H level and signals minD&plus;, minD&minus; of an L level when absolute value &verbar;D0&verbar; is the smallest, and generates signal minD&minus; of an H level and signals minD&plus;, minD<highlight><bold>0</bold></highlight> of an L level when absolute value &verbar;D&minus;&verbar; is the smallest. </paragraph>
<paragraph id="P-0147" lvl="0"><number>&lsqb;0147&rsqb;</number> Difference circuit <highlight><bold>617</bold></highlight>, as described above, calculates a difference of error D0 with that of one clock ago, and outputs an absolute value &verbar;&Dgr;d&verbar; of the calculated difference to comparator <highlight><bold>603</bold></highlight>. Comparator <highlight><bold>603</bold></highlight> compares absolute value &verbar;&Dgr;d&verbar; with threshold value Dset, and generates signal Dena in the above-described manner. AND gate <highlight><bold>607</bold></highlight>A carries out logical AND of signal minD&plus; and signal Dena, and outputs signal Dena&plus; to flip-flops <highlight><bold>609</bold></highlight>A, <highlight><bold>615</bold></highlight>A. AND gate <highlight><bold>607</bold></highlight>B carries out logical AND of signal minD<highlight><bold>0</bold></highlight> and signal Dena, and outputs signal Dena<highlight><bold>0</bold></highlight> to flip-flops <highlight><bold>609</bold></highlight>B, <highlight><bold>615</bold></highlight>B. AND gate <highlight><bold>607</bold></highlight>C carries out logical AND of signal minD&minus; and signal Dena, and outputs signal Dena&minus; to flip-flops <highlight><bold>609</bold></highlight>C, <highlight><bold>615</bold></highlight>C. </paragraph>
<paragraph id="P-0148" lvl="0"><number>&lsqb;0148&rsqb;</number> In response, flip-flop <highlight><bold>609</bold></highlight>A extracts errors between the sampling data in regions <highlight><bold>11</bold></highlight>, <highlight><bold>12</bold></highlight>, <highlight><bold>15</bold></highlight> and expected value E0 based on the input error D0 and signal Dena&plus;, and outputs the extracted errors to averaging circuit <highlight><bold>616</bold></highlight>A. Flip-flop <highlight><bold>609</bold></highlight>B extracts errors between the sampling data in regions <highlight><bold>17</bold></highlight>, <highlight><bold>18</bold></highlight>, <highlight><bold>19</bold></highlight> and expected value E0 based on the input error D0 and signal Dena<highlight><bold>0</bold></highlight>, and outputs the extracted errors to averaging circuit <highlight><bold>616</bold></highlight>B. Flip-flop <highlight><bold>609</bold></highlight>C extracts errors between the sampling data in regions <highlight><bold>13</bold></highlight>, <highlight><bold>14</bold></highlight>, <highlight><bold>16</bold></highlight> and expected value E0 based on the input error D0 and signal Dena&minus;, and outputs the extracted errors to averaging circuit <highlight><bold>616</bold></highlight>C. Flip-flops <highlight><bold>615</bold></highlight>A, <highlight><bold>615</bold></highlight>B, <highlight><bold>615</bold></highlight>C latch signals Dena&plus;, Dena<highlight><bold>0</bold></highlight>, Dena&minus;, respectively, by one cycle of reference clock CLK, and outputs the latched signals Dena&plus;, Dena<highlight><bold>0</bold></highlight>, Dena&minus; to averaging circuits <highlight><bold>616</bold></highlight>A, <highlight><bold>616</bold></highlight>B, <highlight><bold>616</bold></highlight>C, respectively. </paragraph>
<paragraph id="P-0149" lvl="0"><number>&lsqb;0149&rsqb;</number> Averaging circuit <highlight><bold>616</bold></highlight>A calculates an average value of the errors between the sampling data in regions <highlight><bold>11</bold></highlight>, <highlight><bold>12</bold></highlight>, <highlight><bold>15</bold></highlight> and expected value E0, and outputs it to expected value operation unit <highlight><bold>802</bold></highlight>. Averaging circuit <highlight><bold>616</bold></highlight>B calculates an average value of the errors between the sampling data in regions <highlight><bold>17</bold></highlight>, <highlight><bold>18</bold></highlight>, <highlight><bold>19</bold></highlight> and expected value E0, and outputs it to expected value operation unit <highlight><bold>802</bold></highlight>. Further, averaging circuit <highlight><bold>616</bold></highlight>C calculates an average value of the errors between the sampling data in regions <highlight><bold>13</bold></highlight>, <highlight><bold>14</bold></highlight>, <highlight><bold>16</bold></highlight> and expected value E0, and outputs it to expected value operation unit <highlight><bold>802</bold></highlight>. </paragraph>
<paragraph id="P-0150" lvl="0"><number>&lsqb;0150&rsqb;</number> In response, expected value operation unit <highlight><bold>802</bold></highlight> corrects expected values E&plus;, E0, E&minus; using the three average values input, and outputs the corrected expected values E&plus;, E0, E&minus; to Viterbi decoder <highlight><bold>107</bold></highlight>. </paragraph>
<paragraph id="P-0151" lvl="0"><number>&lsqb;0151&rsqb;</number> As such, expected value correction circuit <highlight><bold>108</bold></highlight>B extracts minimal errors from among errors D0 between the sampling data and expected value E0, and corrects expected values E&plus;, E0, E&minus; using the average values of the extracted errors. </paragraph>
<paragraph id="P-0152" lvl="0"><number>&lsqb;0152&rsqb;</number> Otherwise, the third embodiment is identical to the first embodiment. </paragraph>
<paragraph id="P-0153" lvl="0"><number>&lsqb;0153&rsqb;</number> According to the third embodiment, the optical disk apparatus is provided with the expected value correction circuit which corrects expected values in Viterbi decoding, including the one at the DC component level of the reproduction signal, in accordance with the amplitude of the reproduction signal. Thus, accurate Viterbi decoding is possible even if the DC component of the reproduction signal varies, and, as a result, accurate signal reproduction is ensured. </paragraph>
<paragraph id="P-0154" lvl="0"><number>&lsqb;0154&rsqb;</number> Fourth Embodiment </paragraph>
<paragraph id="P-0155" lvl="0"><number>&lsqb;0155&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 16</cross-reference>, the optical disk apparatus <highlight><bold>100</bold></highlight>C according to the fourth embodiment is identical to optical disk apparatus <highlight><bold>100</bold></highlight> except that expected value correction circuit <highlight><bold>108</bold></highlight> of optical disk apparatus <highlight><bold>100</bold></highlight> is replaced with an expected value correction circuit <highlight><bold>108</bold></highlight>C. </paragraph>
<paragraph id="P-0156" lvl="0"><number>&lsqb;0156&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 17</cross-reference>, the expected value correction circuit <highlight><bold>108</bold></highlight>C includes a minimal difference determination unit <highlight><bold>901</bold></highlight>, a selector <highlight><bold>701</bold></highlight>, a difference circuit <highlight><bold>617</bold></highlight>, a comparator <highlight><bold>603</bold></highlight>, a threshold value setting unit <highlight><bold>604</bold></highlight>, AND gates <highlight><bold>607</bold></highlight>A, <highlight><bold>607</bold></highlight>B, <highlight><bold>607</bold></highlight>C, flip-flops <highlight><bold>609</bold></highlight>A, <highlight><bold>609</bold></highlight>B, <highlight><bold>609</bold></highlight>C, <highlight><bold>615</bold></highlight>A, <highlight><bold>615</bold></highlight>B, <highlight><bold>615</bold></highlight>C, averaging circuits <highlight><bold>707</bold></highlight>A, <highlight><bold>707</bold></highlight>B, <highlight><bold>707</bold></highlight>C, and an expected value operation unit <highlight><bold>902</bold></highlight>. </paragraph>
<paragraph id="P-0157" lvl="0"><number>&lsqb;0157&rsqb;</number> Comparator <highlight><bold>603</bold></highlight>, threshold value setting unit <highlight><bold>604</bold></highlight>, difference circuit <highlight><bold>617</bold></highlight>, AND gates <highlight><bold>607</bold></highlight>A, <highlight><bold>607</bold></highlight>B, <highlight><bold>607</bold></highlight>C, flip-flops <highlight><bold>609</bold></highlight>A, <highlight><bold>609</bold></highlight>B, <highlight><bold>609</bold></highlight>C, <highlight><bold>615</bold></highlight>A, <highlight><bold>615</bold></highlight>B, <highlight><bold>615</bold></highlight>C and selector <highlight><bold>701</bold></highlight> function as described above. Averaging circuits <highlight><bold>707</bold></highlight>A, <highlight><bold>707</bold></highlight>B, <highlight><bold>707</bold></highlight>C each have the same circuit configuration as averaging circuit <highlight><bold>707</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference>. </paragraph>
<paragraph id="P-0158" lvl="0"><number>&lsqb;0158&rsqb;</number> Minimal difference determination unit <highlight><bold>901</bold></highlight> determines which is the smallest among errors D&plus;, D0, D&minus; input from Viterbi decoder <highlight><bold>107</bold></highlight>. When error D&plus; is the smallest, minimal difference determination unit <highlight><bold>901</bold></highlight> generates signal minD&plus; of an H level, a select signal for selecting error D&plus;, and signals minD<highlight><bold>0</bold></highlight>, minD&minus; of an L level. When error D0 is the smallest, minimal difference determination unit <highlight><bold>901</bold></highlight> generates signal minD<highlight><bold>0</bold></highlight> of an H level, a select signal for selecting error D0, and signals minD&plus;, minD&minus; of an L level. Further, when error D&minus; is the smallest, minimal difference determination unit <highlight><bold>901</bold></highlight> generates signal minD&minus; of an H level, a select signal for selecting error D&minus;, and signals minD&plus;, minD<highlight><bold>0</bold></highlight> of an L level. </paragraph>
<paragraph id="P-0159" lvl="0"><number>&lsqb;0159&rsqb;</number> Expected value operation unit <highlight><bold>902</bold></highlight> holds reference expected values for respective expected values E&plus;, E0, E&minus;, and corrects the expected values E&plus;, E0, E&minus; based on average values input. Expected value operation unit <highlight><bold>902</bold></highlight> then outputs the corrected expected values E&plus;, E0, E&minus; to Viterbi decoder <highlight><bold>107</bold></highlight>. </paragraph>
<paragraph id="P-0160" lvl="0"><number>&lsqb;0160&rsqb;</number> An operation for correcting expected values E&plus;, E0, E&minus; in expected value correction circuit <highlight><bold>108</bold></highlight>C is now described. When errors D&plus;, D0, D&minus; are input from Viterbi decoder <highlight><bold>107</bold></highlight>, minimal difference determination unit <highlight><bold>901</bold></highlight> determines which is the smallest among the input errors D&plus;, D0, D&minus;, and generates signal minD&plus; of an H level, signals minD<highlight><bold>0</bold></highlight>, minD&minus; of an L level and a select signal at the time when error D&plus; is the smallest. When error D0 is the smallest, the unit <highlight><bold>901</bold></highlight> generates signal minD<highlight><bold>0</bold></highlight> of an H level, signals minD&plus;, minD&minus; of an L level and a select signal. When error D&minus; is the smallest, it generates signal minD&minus; of an H level, signals minD&plus;, minD<highlight><bold>0</bold></highlight> of an L level and a select signal. </paragraph>
<paragraph id="P-0161" lvl="0"><number>&lsqb;0161&rsqb;</number> Selector <highlight><bold>701</bold></highlight> selects either one of the errors D&plus;, D0, D&minus; based on the select signal from minimal difference determination unit <highlight><bold>901</bold></highlight>, and outputs the selected error D&plus;, D0 or D&minus; to flip-flops <highlight><bold>609</bold></highlight>A, <highlight><bold>609</bold></highlight>B, <highlight><bold>609</bold></highlight>C and difference circuit <highlight><bold>617</bold></highlight>. </paragraph>
<paragraph id="P-0162" lvl="0"><number>&lsqb;0162&rsqb;</number> Difference circuit <highlight><bold>617</bold></highlight>, as described above, calculates a difference of the input error D&plus;, D0 or D&minus; with that of one clock ago, and outputs an absolute value &verbar;&Dgr;d&verbar; of the calculated difference to comparator <highlight><bold>603</bold></highlight>. Comparator <highlight><bold>603</bold></highlight> compares absolute value &verbar;&Dgr;d&verbar; with threshold value Dset, and generates signal Dena in the above-described manner. AND gate <highlight><bold>607</bold></highlight>A carries out logical AND of signal minD&plus; and signal Dena, and outputs signal Dena&plus; to flip-flops <highlight><bold>609</bold></highlight>A, <highlight><bold>615</bold></highlight>A. AND gate <highlight><bold>607</bold></highlight>B carries out logical AND of signal minD<highlight><bold>0</bold></highlight> and signal Dena, and outputs signal Dena<highlight><bold>0</bold></highlight> to flip-flops <highlight><bold>609</bold></highlight>B, <highlight><bold>615</bold></highlight>B. Further, AND gate <highlight><bold>607</bold></highlight>C carries out logical AND of signal minD&minus; and signal Dena, and outputs signal Dena&minus; to flip-flops <highlight><bold>609</bold></highlight>C, <highlight><bold>615</bold></highlight>C. </paragraph>
<paragraph id="P-0163" lvl="0"><number>&lsqb;0163&rsqb;</number> In response, flip-flop <highlight><bold>609</bold></highlight>A extracts errors between expected value E&plus; and the sampling data in regions <highlight><bold>11</bold></highlight>, <highlight><bold>12</bold></highlight>, <highlight><bold>15</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 15</cross-reference> based on the input error D&plus; and signal Dena&plus;, and outputs the extracted errors to averaging circuit <highlight><bold>707</bold></highlight>A. Flip-flop <highlight><bold>609</bold></highlight>B extracts errors between the sampling data in regions <highlight><bold>17</bold></highlight>, <highlight><bold>18</bold></highlight>, <highlight><bold>19</bold></highlight> and expected value E0 based on the input error D0 and signal Dena<highlight><bold>0</bold></highlight>, and outputs the extracted errors to averaging circuit <highlight><bold>707</bold></highlight>B. Further, flip-flop <highlight><bold>609</bold></highlight>C extracts errors between the sampling data in regions <highlight><bold>13</bold></highlight>, <highlight><bold>14</bold></highlight>, <highlight><bold>16</bold></highlight> and expected value E&minus; based on the input error D&minus; and signal Dena&minus;, and outputs the extracted errors to averaging circuit <highlight><bold>707</bold></highlight>C. Flip-flops <highlight><bold>615</bold></highlight>A, <highlight><bold>615</bold></highlight>B, <highlight><bold>615</bold></highlight>C latch signals Dena&plus;, Dena<highlight><bold>0</bold></highlight>, Dena&minus;, respectively, by one cycle of reference clock CLK, and outputs the latched signals Dena&plus;, Dena<highlight><bold>0</bold></highlight>, Dena&minus; to averaging circuits <highlight><bold>707</bold></highlight>A, <highlight><bold>707</bold></highlight>B, <highlight><bold>707</bold></highlight>C, respectively. </paragraph>
<paragraph id="P-0164" lvl="0"><number>&lsqb;0164&rsqb;</number> Averaging circuit <highlight><bold>707</bold></highlight>A calculates an average value of the errors between the sampling data in regions <highlight><bold>11</bold></highlight>, <highlight><bold>12</bold></highlight>, <highlight><bold>15</bold></highlight> and expected value E&plus;, and outputs it to expected value operation unit <highlight><bold>902</bold></highlight>. Averaging circuit <highlight><bold>707</bold></highlight>B calculates an average value of the errors between the sampling data in regions <highlight><bold>17</bold></highlight>, <highlight><bold>18</bold></highlight>, <highlight><bold>19</bold></highlight> and expected value E0, and outputs it to expected value operation unit <highlight><bold>902</bold></highlight>. Further, averaging circuit <highlight><bold>707</bold></highlight>C calculates an average value of the errors between the sampling data in regions <highlight><bold>13</bold></highlight>, <highlight><bold>14</bold></highlight>, <highlight><bold>16</bold></highlight> and expected value E&minus;, and outputs it to expected value operation unit <highlight><bold>902</bold></highlight>. </paragraph>
<paragraph id="P-0165" lvl="0"><number>&lsqb;0165&rsqb;</number> In response, expected value operation unit <highlight><bold>902</bold></highlight> corrects expected values E&plus;, E0, E&minus; using the three averaging values input, and outputs the corrected expected values E&plus;, E0, E&minus; to Viterbi decoder <highlight><bold>107</bold></highlight>. </paragraph>
<paragraph id="P-0166" lvl="0"><number>&lsqb;0166&rsqb;</number> As such, expected value correction circuit <highlight><bold>108</bold></highlight>C extracts minimal errors from among errors D&plus; between the sampling data and expected value E&plus;, and corrects the expected value E&plus; using the average value of the extracted errors. It also extracts minimal errors from among errors D0 between the sampling data and expected value E0, and corrects the expected value E0 using the average value of the extracted errors. Further, it extracts minimal errors from among errors D&minus; between the sampling data and expected value E&minus;, and corrects the expected value E&minus; using the average value of the extracted errors. </paragraph>
<paragraph id="P-0167" lvl="0"><number>&lsqb;0167&rsqb;</number> Otherwise, the present embodiment is identical to the first embodiment. </paragraph>
<paragraph id="P-0168" lvl="0"><number>&lsqb;0168&rsqb;</number> According to the fourth embodiment, the optical disk apparatus is provided with the expected value correction circuit which corrects the expected values in Viterbi decoding, including the expected value at the zero-cross point, in accordance with the amplitude of the reproduction signal. Thus, even if the DC component of the reproduction signal varies, the Viterbi decoding can be conducted accurately, and as a result, accurate signal reproduction is ensured. </paragraph>
<paragraph id="P-0169" lvl="0"><number>&lsqb;0169&rsqb;</number> Fifth Embodiment </paragraph>
<paragraph id="P-0170" lvl="0"><number>&lsqb;0170&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 18</cross-reference>, the optical disk apparatus <highlight><bold>100</bold></highlight>D according to the fifth embodiment is identical to optical disk apparatus <highlight><bold>100</bold></highlight> except that expected value correction circuit <highlight><bold>108</bold></highlight> of optical disk apparatus <highlight><bold>100</bold></highlight> is replaced with an expected value correction circuit <highlight><bold>108</bold></highlight>D. </paragraph>
<paragraph id="P-0171" lvl="0"><number>&lsqb;0171&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 19</cross-reference>, the expected value correction circuit <highlight><bold>108</bold></highlight>D includes an absolute value operation unit <highlight><bold>605</bold></highlight>, a minimal difference determination unit <highlight><bold>606</bold></highlight>, flip-flops <highlight><bold>615</bold></highlight>, <highlight><bold>609</bold></highlight>, <highlight><bold>1101</bold></highlight>, <highlight><bold>1102</bold></highlight>, <highlight><bold>1104</bold></highlight>, an AND gate <highlight><bold>1103</bold></highlight>, an averaging circuit <highlight><bold>616</bold></highlight>, and an expected value operation unit <highlight><bold>614</bold></highlight>. </paragraph>
<paragraph id="P-0172" lvl="0"><number>&lsqb;0172&rsqb;</number> Absolute value operation unit <highlight><bold>605</bold></highlight>, minimal difference determination unit <highlight><bold>606</bold></highlight>, flip-flops <highlight><bold>609</bold></highlight>, <highlight><bold>615</bold></highlight>, averaging circuit <highlight><bold>616</bold></highlight>, and expected value operation unit <highlight><bold>614</bold></highlight> function as described above. </paragraph>
<paragraph id="P-0173" lvl="0"><number>&lsqb;0173&rsqb;</number> Flip-flop <highlight><bold>1101</bold></highlight> latches signal minD&plus; or minD&minus; output from minimal difference determination unit <highlight><bold>606</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD&plus; or minD&minus; to flip-flop <highlight><bold>1102</bold></highlight> and to AND gate <highlight><bold>1103</bold></highlight>. Flip-flop <highlight><bold>1102</bold></highlight> further latches signal minD&plus; or minD&minus; latched by flip-flop <highlight><bold>1101</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD&plus; or minD&minus; to AND gate <highlight><bold>1103</bold></highlight>. </paragraph>
<paragraph id="P-0174" lvl="0"><number>&lsqb;0174&rsqb;</number> AND gate <highlight><bold>1103</bold></highlight> receives three signals minD&plus; or minD&minus; having their phases shifted by one cycle of reference clock CLK each, and carries out logical AND of the received three signals minD&plus; or minD&minus; to generate signal Dena&plus; or Dena&minus;. AND gate <highlight><bold>1103</bold></highlight> then outputs the generated signal Dena&plus; or Dena&minus; to flip-flops <highlight><bold>609</bold></highlight>, <highlight><bold>615</bold></highlight>. The signals Dena&plus;, Dena&minus; generated by AND gate <highlight><bold>1103</bold></highlight> each have a time period being at an H level that is shorter than those of signals Dena&plus;, Dena&minus; in the first through fourth embodiments described above. Flip-flop <highlight><bold>1104</bold></highlight> latches absolute value &verbar;D0&verbar; from absolute value operation unit <highlight><bold>605</bold></highlight> by one cycle of reference clock CLK, and outputs the latched absolute value &verbar;D0&verbar; to flip-flop <highlight><bold>609</bold></highlight>. </paragraph>
<paragraph id="P-0175" lvl="0"><number>&lsqb;0175&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 20, a</cross-reference> correcting operation of expected values E&plus;, E0, E&minus; in expected value correction circuit <highlight><bold>108</bold></highlight>D is described. In receipt of errors D&plus;, D0, D&minus; from Viterbi decoder <highlight><bold>107</bold></highlight>, absolute value operation unit <highlight><bold>605</bold></highlight> calculates absolute values of errors D&plus;, D0, D&minus;, and outputs the calculated absolute values &verbar;D&plus;&verbar;, &verbar;D0&verbar;, &verbar;D&minus;&verbar; to minimal difference determination unit <highlight><bold>606</bold></highlight>, and also outputs absolute value &verbar;D0&verbar; to flip-flop <highlight><bold>1104</bold></highlight>. Flip-flop <highlight><bold>1104</bold></highlight> latches absolute value &verbar;D0&verbar; by one cycle of reference clock CLK, and outputs the latched absolute value &verbar;D0&verbar; to flip-flop <highlight><bold>609</bold></highlight>. </paragraph>
<paragraph id="P-0176" lvl="0"><number>&lsqb;0176&rsqb;</number> Minimal difference determination unit <highlight><bold>606</bold></highlight> determines which is the smallest among the input absolute values &verbar;D&plus;&verbar;, &verbar;D0&verbar;, &verbar;D&minus;&verbar;, and generates signal minD&plus; of an H level and signals minD<highlight><bold>0</bold></highlight>, minD&minus; of an L level when absolute value &verbar;D&plus;&verbar; is the smallest, generates signal minD<highlight><bold>0</bold></highlight> of an H level and signals minD&plus;, minD&minus; of an L level when absolute value &verbar;D0&verbar; is the smallest, and generates signal minD&minus; of an H level and signals minD&plus;, minD<highlight><bold>0</bold></highlight> of an L level when absolute value &verbar;D&minus;&verbar; is the smallest. Minimal difference determination unit <highlight><bold>606</bold></highlight> then outputs the generated signal minD&plus; or minD&minus; to flip-flop <highlight><bold>1101</bold></highlight> and to AND gate <highlight><bold>1103</bold></highlight>. </paragraph>
<paragraph id="P-0177" lvl="0"><number>&lsqb;0177&rsqb;</number> Flip-flop <highlight><bold>1101</bold></highlight> latches signal minD&plus; or minD&minus; by one cycle of reference clock CLK, and outputs the latched signal minD&plus; or minD&minus; to flip-flop <highlight><bold>1102</bold></highlight>. Flip-flop <highlight><bold>1102</bold></highlight> further latches the input signal minD&plus; or minD&minus; by one cycle of reference clock CLK, and outputs the latched signal minD&plus; or minD&minus; to AND gate <highlight><bold>1103</bold></highlight>. In response, AND gate <highlight><bold>1103</bold></highlight> carries out logical AND of three signals minD&plus; or minD&minus; with their phases shifted by one cycle of reference clock CLK each to generate signal Dena&plus; or Dena&minus;, and outputs the generated signal Dena&plus; or Dena&minus; to flip-flops <highlight><bold>609</bold></highlight>, <highlight><bold>615</bold></highlight>. </paragraph>
<paragraph id="P-0178" lvl="0"><number>&lsqb;0178&rsqb;</number> In response, flip-flop <highlight><bold>609</bold></highlight> extracts absolute values &verbar;D0&verbar; input from flip-flop <highlight><bold>1104</bold></highlight> in a time period where signal Dena&plus; or Dena&minus; is at an H level. More specifically, flip-flop <highlight><bold>609</bold></highlight> extracts the absolute values of the amplitude values in regions <highlight><bold>21</bold></highlight>-<highlight><bold>28</bold></highlight>, and outputs the extracted absolute values to averaging circuit <highlight><bold>616</bold></highlight>. Flip-flop <highlight><bold>615</bold></highlight> latches signal Dena&plus; or Dena&minus; by one cycle of reference clock CLK, and outputs the latched signal Dena&plus; or Dena&minus; to averaging circuit <highlight><bold>616</bold></highlight>. Averaging circuit <highlight><bold>616</bold></highlight> averages the absolute values input from flip-flop <highlight><bold>609</bold></highlight> in the above-described manner, and outputs an average value of the averaged absolute values to expected value operation unit <highlight><bold>614</bold></highlight>. Expected value operation unit <highlight><bold>614</bold></highlight> makes correction of the expected values by designating the input average value as the corrected expected value E&plus;, and the input average value with its sign inverted as the corrected expected value E&minus;. Expected value operation unit <highlight><bold>614</bold></highlight> then outputs the corrected expected values E&plus;, E&minus; to Viterbi decoder <highlight><bold>107</bold></highlight>. </paragraph>
<paragraph id="P-0179" lvl="0"><number>&lsqb;0179&rsqb;</number> As such, expected value correction circuit <highlight><bold>108</bold></highlight>D corrects the expected values using the amplitude values that have less variation than those used for correction of expected values by expected value correction circuit <highlight><bold>108</bold></highlight>. </paragraph>
<paragraph id="P-0180" lvl="0"><number>&lsqb;0180&rsqb;</number> Although logical AND of three signals minD&plus; or minD&minus; having their phases shifted by one cycle of reference clock CLK each has been carried out in the above description, the present embodiment is not limited thereto. All that is needed is to perform logical AND of at least two signals minD&plus; or minD&minus; with their phases shifted by one clock each. </paragraph>
<paragraph id="P-0181" lvl="0"><number>&lsqb;0181&rsqb;</number> Otherwise, the fifth embodiment is identical to the first embodiment. </paragraph>
<paragraph id="P-0182" lvl="0"><number>&lsqb;0182&rsqb;</number> According to the fifth embodiment, the optical disk apparatus is provided with the expected value correction circuit which corrects expected values in Viterbi decoding in accordance with the amplitude of the reproduction signal, using the sampling data in the region where the data exhibits less variation. This enables more reliable correction of expected values, leading to more accurate Viterbi decoding. As a result, accurate signal reproduction is ensured. </paragraph>
<paragraph id="P-0183" lvl="0"><number>&lsqb;0183&rsqb;</number> Sixth Embodiment </paragraph>
<paragraph id="P-0184" lvl="0"><number>&lsqb;0184&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 21</cross-reference>, the optical disk apparatus <highlight><bold>100</bold></highlight>E according to the sixth embodiment is identical to optical disk apparatus <highlight><bold>100</bold></highlight>A except that expected value correction circuit <highlight><bold>108</bold></highlight>A of optical disk apparatus <highlight><bold>100</bold></highlight>A is replaced with an expected value correction circuit <highlight><bold>108</bold></highlight>E. </paragraph>
<paragraph id="P-0185" lvl="0"><number>&lsqb;0185&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 22</cross-reference>, the expected value correction circuit <highlight><bold>108</bold></highlight>E differs from expected value correction circuit <highlight><bold>108</bold></highlight>A only in that comparator <highlight><bold>603</bold></highlight>, threshold value setting circuit <highlight><bold>604</bold></highlight> and difference circuit <highlight><bold>617</bold></highlight> have been removed therefrom, and flip-flops <highlight><bold>1201</bold></highlight>, <highlight><bold>1202</bold></highlight>, <highlight><bold>1204</bold></highlight> and an AND gate <highlight><bold>1203</bold></highlight> have been added thereto. </paragraph>
<paragraph id="P-0186" lvl="0"><number>&lsqb;0186&rsqb;</number> Flip-flop <highlight><bold>1201</bold></highlight> latches signal minD&plus; or minD&minus; output from minimal difference determination unit <highlight><bold>702</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD&plus; or minD&minus; to flip-flop <highlight><bold>1202</bold></highlight> and to AND gate <highlight><bold>1203</bold></highlight>. Flip-flop <highlight><bold>1202</bold></highlight> further latches signal minD&plus; or minD&minus; output from flip-flop <highlight><bold>1201</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD&plus; or minD&minus; to AND gate <highlight><bold>1203</bold></highlight>. </paragraph>
<paragraph id="P-0187" lvl="0"><number>&lsqb;0187&rsqb;</number> AND gate <highlight><bold>1203</bold></highlight> carries out logical AND of three signals minD&plus; or minD&minus; having their phases shifted by one cycle of reference clock CLK each to generate signal Dena&plus; or Dena&minus;, and outputs the generated signal Dena&plus; or Dena&minus; to flip-flops <highlight><bold>609</bold></highlight>, <highlight><bold>615</bold></highlight>. </paragraph>
<paragraph id="P-0188" lvl="0"><number>&lsqb;0188&rsqb;</number> An operation for correcting expected values E&plus;, E&minus; in expected value correction circuit <highlight><bold>108</bold></highlight>E is now described. Minimal difference determination unit <highlight><bold>702</bold></highlight> determines which is the smallest among the input errors D&plus;, D0, D&minus;, and generates signal minD&plus; or minD&minus; and a select signal, as described above. It then outputs the signal minD&plus; or minD&minus; to flip-flop <highlight><bold>1201</bold></highlight> and to AND gate <highlight><bold>1203</bold></highlight>, and outputs the select signal to selector <highlight><bold>701</bold></highlight>. Selector <highlight><bold>701</bold></highlight> selects error D&plus; or D&minus; based on the select signal from minimal difference determination unit <highlight><bold>702</bold></highlight>, and outputs it to flip-flop <highlight><bold>1204</bold></highlight>. </paragraph>
<paragraph id="P-0189" lvl="0"><number>&lsqb;0189&rsqb;</number> Flip-flop <highlight><bold>1204</bold></highlight> latches the input error D&plus; or D&minus; by one cycle of reference clock CLK, and outputs the latched error D&plus; or D&minus; to flip-flop <highlight><bold>609</bold></highlight>. </paragraph>
<paragraph id="P-0190" lvl="0"><number>&lsqb;0190&rsqb;</number> Flip-flop <highlight><bold>1201</bold></highlight> latches the input signal minD&plus; or minD&minus; by one cycle of reference clock CLK, and outputs the latched signal minD&plus; or minD&minus; to flip-flop <highlight><bold>1202</bold></highlight> and to AND gate <highlight><bold>1203</bold></highlight>. Flip-flop <highlight><bold>1202</bold></highlight> further latches the input signal minD&plus; or minD&minus; by one cycle of reference clock CLK, and outputs the latched signal minD&plus; or minD&minus; to AND gate <highlight><bold>1203</bold></highlight>. AND gate <highlight><bold>1203</bold></highlight> carries out logical AND of three signals minD&plus; or minD&minus; having their phases shifted by one cycle of reference clock CLK each, and generates signal Dena&plus; or Dena&minus; to output to flip-flops <highlight><bold>609</bold></highlight>, <highlight><bold>615</bold></highlight>. </paragraph>
<paragraph id="P-0191" lvl="0"><number>&lsqb;0191&rsqb;</number> In response, flip-flop <highlight><bold>609</bold></highlight> extracts errors D&plus; or D&minus;, selected by selector <highlight><bold>701</bold></highlight>, in a time period where signal Dena&plus; or Dena&minus; is at an H level, and outputs the extracted errors to averaging circuit <highlight><bold>707</bold></highlight>. </paragraph>
<paragraph id="P-0192" lvl="0"><number>&lsqb;0192&rsqb;</number> Flip-flop <highlight><bold>615</bold></highlight> latches signal Dena&plus; or Dena&minus; by one cycle of reference clock CLK, and outputs the latched signal Dena&plus; or Dena&minus; to averaging circuit <highlight><bold>707</bold></highlight>. In response, averaging circuit <highlight><bold>707</bold></highlight> calculates an average value of the errors D&plus; or D&minus; in the above-described manner, and outputs the calculated average value to expected value operation unit <highlight><bold>708</bold></highlight>. Expected value operation unit <highlight><bold>708</bold></highlight> corrects the expected values E&plus;, E&minus; based on the average value received from averaging circuit <highlight><bold>707</bold></highlight> in the above-described manner, and outputs the corrected expected values E&plus;, E&minus; to Viterbi decoder <highlight><bold>107</bold></highlight>. </paragraph>
<paragraph id="P-0193" lvl="0"><number>&lsqb;0193&rsqb;</number> As such, expected value correction circuit <highlight><bold>108</bold></highlight>E extracts the errors between the sampling data of reproduction signal RF in regions <highlight><bold>21</bold></highlight>-<highlight><bold>28</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 20</cross-reference> and the expected values, and calculates the average value of the extracted errors for correction of expected values E&plus;, E&minus;. Regions <highlight><bold>21</bold></highlight>-<highlight><bold>28</bold></highlight> are narrower than regions <highlight><bold>11</bold></highlight>-<highlight><bold>16</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>. Expected value correction circuit <highlight><bold>108</bold></highlight>E extracts the errors between expected values E&plus;, E&minus; and the sampling data of the reproduction signal in the regions where the data exhibit less variation than in the case of expected value correction circuit <highlight><bold>108</bold></highlight>A, and uses the extracted errors to correct expected values E&plus;, E&minus;. </paragraph>
<paragraph id="P-0194" lvl="0"><number>&lsqb;0194&rsqb;</number> Although execution of logical AND of three signals minD&plus; or minD&minus; having their phases shifted by one cycle of reference clock CLK each has been described above, the present embodiment is not limited thereto. All that is needed is execution of logical AND of at least two signals minD&plus; or minD&minus; with their phases shifted by one clock of reference clock CLK each. </paragraph>
<paragraph id="P-0195" lvl="0"><number>&lsqb;0195&rsqb;</number> Otherwise, the sixth embodiment is identical to the second embodiment. </paragraph>
<paragraph id="P-0196" lvl="0"><number>&lsqb;0196&rsqb;</number> According to the sixth embodiment, the optical disk apparatus is provided with the expected value correction circuit which corrects the expected values in Viterbi decoding in accordance with the amplitude of the reproduction signal, employing the errors of the sampling data in the regions where the data exhibit less variation. Accordingly, more reliable correction of expected values, and hence, more accurate Viterbi decoding becomes possible, and as a result, accurate signal reproduction is ensured. </paragraph>
<paragraph id="P-0197" lvl="0"><number>&lsqb;0197&rsqb;</number> Seventh Embodiment </paragraph>
<paragraph id="P-0198" lvl="0"><number>&lsqb;0198&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 23</cross-reference>, the optical disk apparatus <highlight><bold>100</bold></highlight>F according to the seventh embodiment is identical to optical disk apparatus <highlight><bold>100</bold></highlight>B except that expected value correction circuit <highlight><bold>108</bold></highlight>B of optical disk apparatus <highlight><bold>100</bold></highlight>B is replaced with an expected value correction circuit <highlight><bold>108</bold></highlight>F. </paragraph>
<paragraph id="P-0199" lvl="0"><number>&lsqb;0199&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 24</cross-reference>, the expected value correction circuit <highlight><bold>108</bold></highlight>F differs from expected value correction circuit <highlight><bold>108</bold></highlight>B only in that comparator <highlight><bold>603</bold></highlight>, threshold value setting unit <highlight><bold>604</bold></highlight> and difference circuit <highlight><bold>617</bold></highlight> have been removed therefrom and flip-flops <highlight><bold>1301</bold></highlight>, <highlight><bold>1302</bold></highlight>, <highlight><bold>1310</bold></highlight>, <highlight><bold>1304</bold></highlight>, <highlight><bold>1305</bold></highlight>, <highlight><bold>1311</bold></highlight>, <highlight><bold>1307</bold></highlight>, <highlight><bold>1308</bold></highlight>, <highlight><bold>1312</bold></highlight> and AND gates <highlight><bold>1303</bold></highlight>, <highlight><bold>1306</bold></highlight>, <highlight><bold>1309</bold></highlight> have been added thereto. </paragraph>
<paragraph id="P-0200" lvl="0"><number>&lsqb;0200&rsqb;</number> Flip-flop <highlight><bold>1301</bold></highlight> latches signal minD&plus; from minimal difference determination unit <highlight><bold>801</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD&plus; to flip-flop <highlight><bold>1302</bold></highlight> and to AND gate <highlight><bold>1303</bold></highlight>. Flip-flop <highlight><bold>1302</bold></highlight> further latches the signal minD&plus; from flip-flop <highlight><bold>1301</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD&plus; to AND gate <highlight><bold>1303</bold></highlight>. </paragraph>
<paragraph id="P-0201" lvl="0"><number>&lsqb;0201&rsqb;</number> AND gate <highlight><bold>1303</bold></highlight> carries out logical AND of the three signals minD&plus; having their phases shifted by one cycle of reference clock CLK each to generate signal Dena&plus;, and outputs the generated signal Dena&plus; to flip-flops <highlight><bold>609</bold></highlight>A,<highlight><bold>615</bold></highlight>A. </paragraph>
<paragraph id="P-0202" lvl="0"><number>&lsqb;0202&rsqb;</number> Flip-flop <highlight><bold>1304</bold></highlight> latches signal minD<highlight><bold>0</bold></highlight> from minimal difference determination unit <highlight><bold>801</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD<highlight><bold>0</bold></highlight> to flip-flop <highlight><bold>1305</bold></highlight> and to AND gate <highlight><bold>1306</bold></highlight>. Flip-flop <highlight><bold>1305</bold></highlight> further latches signal minD<highlight><bold>0</bold></highlight> from flip-flop <highlight><bold>1304</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD<highlight><bold>0</bold></highlight> to AND gate <highlight><bold>1306</bold></highlight>. </paragraph>
<paragraph id="P-0203" lvl="0"><number>&lsqb;0203&rsqb;</number> AND gate <highlight><bold>1306</bold></highlight> carries out logical AND of the three signals minD<highlight><bold>0</bold></highlight> with their phases shifted by one cycle of reference clock CLK each to generate signal Dena<highlight><bold>0</bold></highlight>, and outputs the generated signal Dena<highlight><bold>0</bold></highlight> to flip-flops <highlight><bold>609</bold></highlight>B, <highlight><bold>615</bold></highlight>B. </paragraph>
<paragraph id="P-0204" lvl="0"><number>&lsqb;0204&rsqb;</number> Flip-flop <highlight><bold>1307</bold></highlight> latches signal minD&minus; from minimal difference determination unit <highlight><bold>801</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD&minus; to flip-flop <highlight><bold>1308</bold></highlight> and to AND gate <highlight><bold>1309</bold></highlight>. Flip-flop <highlight><bold>1308</bold></highlight> further latches minD&minus; from flip-flop <highlight><bold>1307</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD&minus; to AND gate <highlight><bold>1309</bold></highlight>. </paragraph>
<paragraph id="P-0205" lvl="0"><number>&lsqb;0205&rsqb;</number> AND gate <highlight><bold>1309</bold></highlight> carries out logical AND of the three signals minD&minus; having their phases shifted by one cycle of reference clock CLK each to generate signal Dena&minus;, and outputs the generated signal Dena&minus; to flip-flops <highlight><bold>609</bold></highlight>C, <highlight><bold>615</bold></highlight>C. </paragraph>
<paragraph id="P-0206" lvl="0"><number>&lsqb;0206&rsqb;</number> Flip-flop <highlight><bold>1310</bold></highlight> latches error D0 by one cycle of reference clock CLK and outputs the latched error D0 to flip-flop <highlight><bold>609</bold></highlight>A. Flip-flop <highlight><bold>1311</bold></highlight> latches error D0 by one cycle of reference clock CLK and outputs the latched error DO to flip-flop <highlight><bold>609</bold></highlight>B. Flip-flop <highlight><bold>1312</bold></highlight> latches error D0 by one cycle of reference clock CLK and outputs the latched error D0 to flip-flop <highlight><bold>609</bold></highlight>C. </paragraph>
<paragraph id="P-0207" lvl="0"><number>&lsqb;0207&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 25</cross-reference>, an operation for correcting expected values E&plus;, E0, E&minus; in expected value correction circuit <highlight><bold>108</bold></highlight>F is described. When errors D&plus;, D0, D&minus; are input from Viterbi decoder <highlight><bold>107</bold></highlight>, absolute value operation unit <highlight><bold>605</bold></highlight> calculates absolute values of errors D&plus;, D0, D&minus;, and outputs the absolute values &verbar;D&plus;&verbar;, &verbar;D0&verbar;, &verbar;D&minus;&verbar; to minimal difference determination unit <highlight><bold>801</bold></highlight>. Minimal difference determination unit <highlight><bold>801</bold></highlight> determines which is the smallest among the received absolute values &verbar;D&plus;&verbar;, &verbar;D0&verbar;, &verbar;D&minus;&verbar;, and generates signal minD&plus; of an H level and signals minD<highlight><bold>0</bold></highlight>, minD&minus; of an L level when absolute value &verbar;D&plus;&verbar; is the smallest, generates signal minD<highlight><bold>0</bold></highlight> of an H level and signals minD&plus;, minD&minus; of an L level when absolute value &verbar;D0&verbar; is the smallest, and generates signal minD&minus; of an H level and signals minD&plus;, minD<highlight><bold>0</bold></highlight> of an L level when absolute value &verbar;D&minus;&verbar; is the smallest. </paragraph>
<paragraph id="P-0208" lvl="0"><number>&lsqb;0208&rsqb;</number> Flip-flop <highlight><bold>1301</bold></highlight> latches the input signal minD&plus; by one cycle of reference clock CLK, and outputs the latched signal minD&plus; to flip-flop <highlight><bold>1302</bold></highlight> and to AND gate <highlight><bold>1303</bold></highlight>. Flip-flop <highlight><bold>1302</bold></highlight> further latches the received signal minD&plus; by one cycle of reference clock CLK, and outputs the latched signal minD&plus; to AND gate <highlight><bold>1303</bold></highlight>. AND gate <highlight><bold>1303</bold></highlight> carries out logical AND of the three signals minD&plus; having their phases shifted by one cycle of reference clock CLK each to generate signal Dena&plus;, and outputs the generated signal Dena&plus; to flip-flops <highlight><bold>609</bold></highlight>A, <highlight><bold>615</bold></highlight>A. </paragraph>
<paragraph id="P-0209" lvl="0"><number>&lsqb;0209&rsqb;</number> Flip-flop <highlight><bold>1304</bold></highlight> latches the input signal minD<highlight><bold>0</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD<highlight><bold>0</bold></highlight> to flip-flop <highlight><bold>1305</bold></highlight> and to AND gate <highlight><bold>1306</bold></highlight>. Flip-flop <highlight><bold>1305</bold></highlight> further latches the input signal minD<highlight><bold>0</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD<highlight><bold>0</bold></highlight> to AND gate <highlight><bold>1306</bold></highlight>. AND gate <highlight><bold>1306</bold></highlight> carries out logical AND of the three signals minD<highlight><bold>0</bold></highlight> having their phases shifted by one cycle of reference clock CLK each to generate signal Dena<highlight><bold>0</bold></highlight>, and outputs the generated signal Dena<highlight><bold>0</bold></highlight> to flip-flops <highlight><bold>609</bold></highlight>B, <highlight><bold>615</bold></highlight>B. </paragraph>
<paragraph id="P-0210" lvl="0"><number>&lsqb;0210&rsqb;</number> Further, flip-flop <highlight><bold>1307</bold></highlight> latches the input signal minD&minus; by one cycle of reference clock CLK, and outputs the latched signal minD&minus; to flip-flop <highlight><bold>1308</bold></highlight> and to AND gate <highlight><bold>1309</bold></highlight>. Flip-flop <highlight><bold>1308</bold></highlight> further latches the input signal minD&minus; by one cycle of reference clock CLK, and outputs the latched signal minD&minus; to AND gate <highlight><bold>1309</bold></highlight>. AND gate <highlight><bold>1309</bold></highlight> carries out logical AND of the three signals minD&minus; with their phases shifted by one cycle of reference clock CLK each to generate signal Dena&minus;, and outputs the generated signal Dena&minus; to flip-flops <highlight><bold>609</bold></highlight>C, <highlight><bold>615</bold></highlight>C. </paragraph>
<paragraph id="P-0211" lvl="0"><number>&lsqb;0211&rsqb;</number> Flip-flop <highlight><bold>1310</bold></highlight> latches error D0 by one cycle of reference clock CLK, and outputs the latched error D0 to flip-flop <highlight><bold>609</bold></highlight>A. Flip-flop <highlight><bold>1311</bold></highlight> latches error D0 by one cycle of reference clock CLK, and outputs the latched error D0 to flip-flop <highlight><bold>609</bold></highlight>B. Flip-flop <highlight><bold>1312</bold></highlight> latches error D0 by one cycle of reference clock CLK, and outputs the latched error D0 to flip-flop <highlight><bold>609</bold></highlight>C. </paragraph>
<paragraph id="P-0212" lvl="0"><number>&lsqb;0212&rsqb;</number> In response, flip-flop <highlight><bold>609</bold></highlight>A extracts errors between expected value E0 and sampling data in regions <highlight><bold>21</bold></highlight>, <highlight><bold>23</bold></highlight>, <highlight><bold>25</bold></highlight>, <highlight><bold>27</bold></highlight> based on the input error D0 and signal Dena&plus;, and outputs the extracted errors to averaging circuit <highlight><bold>616</bold></highlight>A. Flip-flop <highlight><bold>609</bold></highlight>B extracts errors between expected value E0 and sampling data in region <highlight><bold>29</bold></highlight> based on the input error D0 and signal Dena<highlight><bold>0</bold></highlight>, and outputs the extracted errors to averaging circuit <highlight><bold>616</bold></highlight>B. Further, flip-flop <highlight><bold>609</bold></highlight>C extracts errors between expected value E0 and sampling data in regions <highlight><bold>22</bold></highlight>, <highlight><bold>24</bold></highlight>, <highlight><bold>26</bold></highlight>, <highlight><bold>28</bold></highlight> based on the input error D0 and signal Dena&minus;, and outputs the extracted errors to averaging circuit <highlight><bold>616</bold></highlight>C. Flip-flips <highlight><bold>615</bold></highlight>A, <highlight><bold>615</bold></highlight>B, <highlight><bold>615</bold></highlight>C latch signals Dena&plus;, Dena<highlight><bold>0</bold></highlight>, Dena&minus;, respectively, by one cycle of reference clock CLK, and output the latched signals Dena&plus;, Dena<highlight><bold>0</bold></highlight>, Dena&minus; to averaging circuits <highlight><bold>616</bold></highlight>A, <highlight><bold>616</bold></highlight>B, <highlight><bold>616</bold></highlight>C, respectively. </paragraph>
<paragraph id="P-0213" lvl="0"><number>&lsqb;0213&rsqb;</number> Averaging circuit <highlight><bold>616</bold></highlight>A calculates an average value of the errors between the sampling data in regions <highlight><bold>21</bold></highlight>, <highlight><bold>23</bold></highlight>, <highlight><bold>25</bold></highlight>, <highlight><bold>27</bold></highlight> and expected value E0, and outputs the average value to expected value operation unit <highlight><bold>802</bold></highlight>. Averaging circuit <highlight><bold>616</bold></highlight>B calculates an average value of the errors between the sampling data in region <highlight><bold>29</bold></highlight> and expected value E0, and outputs the average value to expected value operation unit <highlight><bold>802</bold></highlight>. Further, averaging circuit <highlight><bold>616</bold></highlight>C calculates an average value of the errors between the sampling data in regions <highlight><bold>22</bold></highlight>, <highlight><bold>24</bold></highlight>, <highlight><bold>26</bold></highlight>, <highlight><bold>28</bold></highlight> and expected value E0, and outputs the average value to expected value operation unit <highlight><bold>802</bold></highlight>. </paragraph>
<paragraph id="P-0214" lvl="0"><number>&lsqb;0214&rsqb;</number> In response, expected value operation unit <highlight><bold>802</bold></highlight> corrects expected values E&plus;, E0, E&minus; using the received three average values, and outputs the corrected expected values E&plus;, E0, E&minus; to Viterbi decoder <highlight><bold>107</bold></highlight>. </paragraph>
<paragraph id="P-0215" lvl="0"><number>&lsqb;0215&rsqb;</number> As such, expected value correction circuit <highlight><bold>108</bold></highlight>F extracts errors D&plus; between the sampling data and expected value E&plus; in the regions where variation is less obvious, and uses the average value of the extracted errors to correct the expected value E&plus;. Likewise, it extracts errors D0 between the sampling data and expected value E0 in the region(s) with less variation, and uses the average value of the extracted errors to correct the expected value E0. It further extracts errors D&minus; between the sampling data and expected value E&minus; in the regions where variation is less obvious, and uses the average value of the extracted errors to correct the expected value E&minus;. </paragraph>
<paragraph id="P-0216" lvl="0"><number>&lsqb;0216&rsqb;</number> Although logical AND of three signals minD&plus;, three signals minD<highlight><bold>0</bold></highlight> and three signals minD&minus; with their phases shifted by one cycle of reference clock CLK each has been carried out in the above description, the present embodiment is not limited thereto. All that is needed is execution of logical AND of at least two signals minD&plus;, at least two signals minD<highlight><bold>0</bold></highlight> and at least two signals minD&minus; with their phases shifted by one clock each. </paragraph>
<paragraph id="P-0217" lvl="0"><number>&lsqb;0217&rsqb;</number> Otherwise, the seventh embodiment is identical to the third embodiment. </paragraph>
<paragraph id="P-0218" lvl="0"><number>&lsqb;0218&rsqb;</number> According to the seventh embodiment, the optical disk apparatus is provided with the expected value correction circuit which corrects the expected values in the Viterbi decoding, including the one at the zero-cross point, using the errors between the expected values and the sampling data in the regions where the data exhibit less variation. Thus, more reliable correction of expected values becomes possible, and accurate Viterbi decoding is permitted even if the DC component of the reproduction signal varies. As a result, accurate signal reproduction is ensured. </paragraph>
<paragraph id="P-0219" lvl="0"><number>&lsqb;0219&rsqb;</number> Eighth Embodiment </paragraph>
<paragraph id="P-0220" lvl="0"><number>&lsqb;0220&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 26</cross-reference>, the optical disk apparatus <highlight><bold>100</bold></highlight>G according to the eighth embodiment is identical to optical disk apparatus <highlight><bold>100</bold></highlight>C except that expected value correction circuit <highlight><bold>108</bold></highlight>C of optical disk apparatus <highlight><bold>100</bold></highlight>C is replaced with an expected value correction circuit <highlight><bold>108</bold></highlight>G. </paragraph>
<paragraph id="P-0221" lvl="0"><number>&lsqb;0221&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 27</cross-reference>, the expected value correction circuit <highlight><bold>108</bold></highlight>G differs from expected value correction circuit <highlight><bold>108</bold></highlight>C only in that comparator <highlight><bold>603</bold></highlight>, threshold value setting unit <highlight><bold>604</bold></highlight> and difference circuit <highlight><bold>617</bold></highlight> have been removed therefrom and flip-flops <highlight><bold>1401</bold></highlight>, <highlight><bold>1402</bold></highlight>, <highlight><bold>1404</bold></highlight>, <highlight><bold>1405</bold></highlight>, <highlight><bold>1410</bold></highlight>A, <highlight><bold>1407</bold></highlight>, <highlight><bold>1408</bold></highlight> and AND gates <highlight><bold>1403</bold></highlight>, <highlight><bold>1406</bold></highlight>, <highlight><bold>1409</bold></highlight> have been added thereto. </paragraph>
<paragraph id="P-0222" lvl="0"><number>&lsqb;0222&rsqb;</number> Flip-flop <highlight><bold>1401</bold></highlight> latches signal minD&plus; from minimal difference determination unit <highlight><bold>901</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD&plus; to flip-flop <highlight><bold>1402</bold></highlight> and to AND gate <highlight><bold>1403</bold></highlight>. Flip-flop <highlight><bold>1402</bold></highlight> further latches the signal minD&plus; from flip-flop <highlight><bold>1401</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD&plus; to AND gate <highlight><bold>1403</bold></highlight>. </paragraph>
<paragraph id="P-0223" lvl="0"><number>&lsqb;0223&rsqb;</number> AND gate <highlight><bold>1403</bold></highlight> carries out logical AND of the three signals minD&plus; with their phases shifted by one cycle of reference clock CLK each to generate signal Dena&plus;, and outputs the generated signal Dena&plus; to flip-flops <highlight><bold>609</bold></highlight>A, <highlight><bold>615</bold></highlight>A. </paragraph>
<paragraph id="P-0224" lvl="0"><number>&lsqb;0224&rsqb;</number> Flip-flop <highlight><bold>1404</bold></highlight> latches signal minD<highlight><bold>0</bold></highlight> from minimal difference determination unit <highlight><bold>901</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD<highlight><bold>0</bold></highlight> to flip-flop <highlight><bold>1405</bold></highlight> and to AND gate <highlight><bold>1406</bold></highlight>. Flip-flop <highlight><bold>1405</bold></highlight> further latches the signal minD<highlight><bold>0</bold></highlight> from flip-flop <highlight><bold>1404</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD<highlight><bold>0</bold></highlight> to AND gate <highlight><bold>1406</bold></highlight>. </paragraph>
<paragraph id="P-0225" lvl="0"><number>&lsqb;0225&rsqb;</number> AND gate <highlight><bold>1406</bold></highlight> carries out logical AND of the three signals minD<highlight><bold>0</bold></highlight> with their phases shifted by one cycle of reference clock CLK each to generate signal Dena<highlight><bold>0</bold></highlight>, and outputs the generated signal Dena<highlight><bold>0</bold></highlight> to flip-flops <highlight><bold>609</bold></highlight>B, <highlight><bold>615</bold></highlight>B. </paragraph>
<paragraph id="P-0226" lvl="0"><number>&lsqb;0226&rsqb;</number> Flip-flop <highlight><bold>1407</bold></highlight> latches signal minD&minus; from minimal difference determination unit <highlight><bold>901</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD&minus; to flip-flop <highlight><bold>1408</bold></highlight> and to AND gate <highlight><bold>1409</bold></highlight>. Flip-flop <highlight><bold>1408</bold></highlight> further latches the signal minD&minus; from flip-flop <highlight><bold>1407</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD&minus; to AND gate <highlight><bold>1409</bold></highlight>. </paragraph>
<paragraph id="P-0227" lvl="0"><number>&lsqb;0227&rsqb;</number> AND gate <highlight><bold>1409</bold></highlight> carries out logical AND of the three signals minD&minus; with their phases shifted by one cycle of reference clock CLK each to generate signal Dena&minus;, and outputs the generated signal Dena&minus; to flip-flops <highlight><bold>609</bold></highlight>C, <highlight><bold>615</bold></highlight>C. </paragraph>
<paragraph id="P-0228" lvl="0"><number>&lsqb;0228&rsqb;</number> Flip-flop <highlight><bold>1410</bold></highlight>A latches error D&plus;, D0 or D&minus; received from selector <highlight><bold>701</bold></highlight> by one cycle of reference clock CLK, and outputs the latched error D&plus;, D0 or D&minus; to flip-flops <highlight><bold>609</bold></highlight>A, <highlight><bold>609</bold></highlight>B, <highlight><bold>609</bold></highlight>C. </paragraph>
<paragraph id="P-0229" lvl="0"><number>&lsqb;0229&rsqb;</number> A correcting operation of expected values E&plus;, E0, E&minus; in expected value correction circuit <highlight><bold>108</bold></highlight>G is now described. In receipt of errors D&plus;, D0, D&minus; from Viterbi decoder <highlight><bold>107</bold></highlight>, minimal difference determination unit <highlight><bold>901</bold></highlight> determines which is the smallest among the input errors D&plus;, D0, D&minus;. When error D&plus; is the smallest, the unit <highlight><bold>901</bold></highlight> generates signal minD&plus; of an H level, signals minD<highlight><bold>0</bold></highlight>, minD&minus; of an L level, and a select signal for selecting error D&plus;. When error D0 is the smallest, it generates signal minD<highlight><bold>0</bold></highlight> of an H level, signals minD&plus;, minD&minus; of an L level, and a select signal for selecting error D0. When error D&minus; is the smallest, it generates signal minD&minus; of an H level, signals minD&plus;, minD<highlight><bold>0</bold></highlight> of an L level, and a select signal for selecting error D&minus;. </paragraph>
<paragraph id="P-0230" lvl="0"><number>&lsqb;0230&rsqb;</number> Selector <highlight><bold>701</bold></highlight> selects one of errors D&plus;, D0, D&minus; based on the select signal from minimal difference determination unit <highlight><bold>901</bold></highlight>, and outputs the selected error D&plus;, D0 or D&minus; to flip-flop <highlight><bold>1410</bold></highlight>A. </paragraph>
<paragraph id="P-0231" lvl="0"><number>&lsqb;0231&rsqb;</number> Flip-flop <highlight><bold>1401</bold></highlight> latches input signal minD&plus; by one cycle of reference clock CLK, and outputs the latched signal minD&plus; to flip-flop <highlight><bold>1402</bold></highlight> and to AND gate <highlight><bold>1403</bold></highlight>. Flip-flop <highlight><bold>1402</bold></highlight> further latches the input signal minD&plus; by one cycle of reference clock CLK, and outputs the latched signal minD&plus; to AND gate <highlight><bold>1403</bold></highlight>. AND gate <highlight><bold>1403</bold></highlight> carries out logical AND of the three signals minD&plus; with their phases shifted by one cycle of reference clock CLK each to generate signal Dena&plus;, and outputs the generated signal Dena&plus; to flip-flops <highlight><bold>609</bold></highlight>A, <highlight><bold>615</bold></highlight>A. </paragraph>
<paragraph id="P-0232" lvl="0"><number>&lsqb;0232&rsqb;</number> Flip-flop <highlight><bold>1404</bold></highlight> latches input signal minD<highlight><bold>0</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD<highlight><bold>0</bold></highlight> to flip-flop <highlight><bold>1405</bold></highlight> and to AND gate <highlight><bold>1406</bold></highlight>. Flip-flop <highlight><bold>1405</bold></highlight> further latches the input signal minD<highlight><bold>0</bold></highlight> by one cycle of reference clock CLK, and outputs the latched signal minD<highlight><bold>0</bold></highlight> to AND gate <highlight><bold>1406</bold></highlight>. AND gate <highlight><bold>1406</bold></highlight> carries out logical AND of the three signals minD<highlight><bold>0</bold></highlight> with their phases shifted by one cycle of reference clock CLK each to generate signal Dena<highlight><bold>0</bold></highlight>, and outputs the generated signal Dena<highlight><bold>0</bold></highlight> to flip-flops <highlight><bold>609</bold></highlight>B, <highlight><bold>615</bold></highlight>B. </paragraph>
<paragraph id="P-0233" lvl="0"><number>&lsqb;0233&rsqb;</number> Further, flip-flop <highlight><bold>1407</bold></highlight> latches input signal minD&minus; by one cycle of reference clock CLK, and outputs the latched signal minD&minus; to flip-flop <highlight><bold>1408</bold></highlight> and to AND gate <highlight><bold>1409</bold></highlight>. Flip-flop <highlight><bold>1408</bold></highlight> further latches the input signal minD&minus; by one cycle of reference clock CLK, and outputs the latched signal minD&minus; to AND gate <highlight><bold>1409</bold></highlight>. AND gate <highlight><bold>1409</bold></highlight> carries out logical AND of the three signals minD&minus; having their phases shifted by one cycle of reference clock CLK each to generate signal Dena&minus;, and outputs the generated signal Dena&minus; to flip-flops <highlight><bold>609</bold></highlight>C, <highlight><bold>615</bold></highlight>C. </paragraph>
<paragraph id="P-0234" lvl="0"><number>&lsqb;0234&rsqb;</number> Flip-flop <highlight><bold>1410</bold></highlight>A latches one of the errors D&plus;, D0, D&minus; received from selector <highlight><bold>701</bold></highlight> by one cycle of reference clock CLK, and outputs the latched error D&plus;, D0 or D&minus; to flip-flops <highlight><bold>609</bold></highlight>A, <highlight><bold>609</bold></highlight>B, <highlight><bold>609</bold></highlight>C. </paragraph>
<paragraph id="P-0235" lvl="0"><number>&lsqb;0235&rsqb;</number> In response, flip-flop <highlight><bold>609</bold></highlight>A extracts errors between expected value E&plus; and sampling data in regions <highlight><bold>21</bold></highlight>, <highlight><bold>23</bold></highlight>, <highlight><bold>25</bold></highlight>, <highlight><bold>27</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 25</cross-reference> based on input error D&plus; and signal Dena&plus;, and outputs the extracted errors to averaging circuit <highlight><bold>707</bold></highlight>A. Flip-flop <highlight><bold>609</bold></highlight>B extracts errors between expected value E0 and sampling data in region <highlight><bold>29</bold></highlight> based on input error D0 and signal Dena<highlight><bold>0</bold></highlight>, and outputs the extracted errors to averaging circuit <highlight><bold>707</bold></highlight>B. Further, flip-flop <highlight><bold>609</bold></highlight>C extracts errors between expected value E&minus; and sampling data in regions <highlight><bold>22</bold></highlight>, <highlight><bold>24</bold></highlight>, <highlight><bold>26</bold></highlight>, <highlight><bold>28</bold></highlight> based on input error D&minus; and signal Dena&minus;, and outputs the extracted errors to averaging circuit <highlight><bold>707</bold></highlight>C. In this case, although flip-flop <highlight><bold>1410</bold></highlight>A outputs one of the errors D&plus;, D0, D&minus; to flip-flops <highlight><bold>609</bold></highlight>A, <highlight><bold>609</bold></highlight>B and <highlight><bold>609</bold></highlight>C, each flip-flop <highlight><bold>609</bold></highlight>A, <highlight><bold>609</bold></highlight>B, <highlight><bold>609</bold></highlight>C is activated only when corresponding signal Dena&plus;, Dena<highlight><bold>0</bold></highlight>, Dena&minus; is at an H level. Thus, flip-flop <highlight><bold>609</bold></highlight>A outputs the errors between expected value E&plus; and the sampling data in regions <highlight><bold>21</bold></highlight>, <highlight><bold>23</bold></highlight>, <highlight><bold>25</bold></highlight>, <highlight><bold>27</bold></highlight>, flip-flop <highlight><bold>609</bold></highlight>B outputs the errors between expected value E0 and the sampling data in region <highlight><bold>29</bold></highlight>, and flip-flop <highlight><bold>609</bold></highlight>C outputs the errors between expected value E&minus;<highlight><bold>0</bold></highlight>and the sampling data in regions <highlight><bold>22</bold></highlight>, <highlight><bold>24</bold></highlight>, <highlight><bold>26</bold></highlight>, <highlight><bold>28</bold></highlight>. </paragraph>
<paragraph id="P-0236" lvl="0"><number>&lsqb;0236&rsqb;</number> Flip-flops <highlight><bold>615</bold></highlight>A, <highlight><bold>615</bold></highlight>B, <highlight><bold>615</bold></highlight>C latch signals Dena&plus;, Dena<highlight><bold>0</bold></highlight>, Dena&minus;, respectively, by one cycle of reference clock CLK, and output the latched signals Dena&plus;, Dena<highlight><bold>0</bold></highlight>, Dena&minus; to averaging circuits <highlight><bold>707</bold></highlight>A, <highlight><bold>707</bold></highlight>B, <highlight><bold>707</bold></highlight>C, respectively. </paragraph>
<paragraph id="P-0237" lvl="0"><number>&lsqb;0237&rsqb;</number> Averaging circuit <highlight><bold>707</bold></highlight>A calculates an average value of the errors between expected value E&plus; and the sampling data in regions <highlight><bold>21</bold></highlight>, <highlight><bold>23</bold></highlight>, <highlight><bold>25</bold></highlight>, <highlight><bold>27</bold></highlight>, and outputs the average value to expected value operation unit <highlight><bold>902</bold></highlight>. Averaging circuit <highlight><bold>707</bold></highlight>B calculates an average value of the errors between expected value E0 and the sampling data in region <highlight><bold>29</bold></highlight>, and outputs the average value to expected value operation unit <highlight><bold>902</bold></highlight>. Further, averaging circuit <highlight><bold>707</bold></highlight>C calculates an average value of the errors between expected value E&minus; and the sampling data in regions <highlight><bold>22</bold></highlight>, <highlight><bold>24</bold></highlight>, <highlight><bold>26</bold></highlight>, <highlight><bold>28</bold></highlight>, and outputs the average value to expected value operation unit <highlight><bold>902</bold></highlight>. </paragraph>
<paragraph id="P-0238" lvl="0"><number>&lsqb;0238&rsqb;</number> In response, expected value operation unit <highlight><bold>902</bold></highlight> corrects expected values E&plus;, E0, E&minus; using the input three average values, and outputs the corrected expected values E&plus;, E0, E&minus; to Viterbi decoder <highlight><bold>107</bold></highlight>. </paragraph>
<paragraph id="P-0239" lvl="0"><number>&lsqb;0239&rsqb;</number> Although logical AND of three signals minD&plus;, three signals minD<highlight><bold>0</bold></highlight> and three signals minD&minus; with their phases shifted by one cycle of reference clock CLK each has been carried out in the above description, the eighth embodiment is not limited thereto. All that is needed is to perform logical AND of at least two signals minD&plus;, at least two signals minD<highlight><bold>0</bold></highlight> and at least two signals minD&minus; with their phases shifted by one clock each. </paragraph>
<paragraph id="P-0240" lvl="0"><number>&lsqb;0240&rsqb;</number> Otherwise, the present embodiment is identical to the fourth embodiment. </paragraph>
<paragraph id="P-0241" lvl="0"><number>&lsqb;0241&rsqb;</number> According to the eighth embodiment, the optical disk apparatus is provided with the expected value correction circuit which corrects the expected values in the Viterbi decoding, including the one at the zero-cross point, using the errors between the expected values and the sampling data in the regions where the data exhibit less variation. Thus, more reliable correction of the expected values becomes possible, and Viterbi decoding is performed accurately even if the DC component of the reproduction signal varies. As a result, accurate signal reproduction is ensured. </paragraph>
<paragraph id="P-0242" lvl="0"><number>&lsqb;0242&rsqb;</number> In each embodiment above, correction of expected values in Viterbi decoding has been described taking signal reproduction from a magneto-optical disk as an example. However, the present invention is not limited thereto, but rather is applicable to signal reproduction from a phase change disk and an optical disk like DVD, and is generally applicable to any optical disk apparatus which reproduces signals by Viterbi decoding. </paragraph>
<paragraph id="P-0243" lvl="0"><number>&lsqb;0243&rsqb;</number> Further, in each embodiment above, Viterbi decoder <highlight><bold>107</bold></highlight> has made correction of the expected values by outputting errors D&plus;, D0, D&minus; to corresponding expected value correction circuit <highlight><bold>108</bold></highlight>, <highlight><bold>108</bold></highlight>A, <highlight><bold>108</bold></highlight>B, <highlight><bold>108</bold></highlight>C, <highlight><bold>108</bold></highlight>D, <highlight><bold>108</bold></highlight>E, <highlight><bold>108</bold></highlight>F or <highlight><bold>108</bold></highlight>G. However, the signals for use in correcting the expected values only need to be error components, and Viterbi decoder <highlight><bold>107</bold></highlight> may output branch metrics BM&plus;, BM0, BM&minus;, for example, to corresponding expected value correction circuit <highlight><bold>108</bold></highlight>, <highlight><bold>108</bold></highlight>A, <highlight><bold>108</bold></highlight>B, <highlight><bold>108</bold></highlight>C, <highlight><bold>108</bold></highlight>D, <highlight><bold>108</bold></highlight>E, <highlight><bold>108</bold></highlight>F or <highlight><bold>108</bold></highlight>G. </paragraph>
<paragraph id="P-0244" lvl="0"><number>&lsqb;0244&rsqb;</number> Although the present invention has been described and illustrated in detail, it is clearly understood that the same is by way of illustration and example only and is not to be taken by way of limitation, the spirit and scope of the present invention being limited only by the terms of the appended claims. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is claimed is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. An optical disk apparatus comprising: 
<claim-text>an optical pickup irradiating laser light onto an optical disk and detecting reflected light thereof; </claim-text>
<claim-text>a sampling circuit sampling a reproduction signal detected by said optical pickup in synchronization with a reference clock and outputting sampling values; </claim-text>
<claim-text>an expected value correction circuit correcting an expected value for use in converting said sampling value from multilevel data to binary data using the sampling values in a region where variation is small; and </claim-text>
<claim-text>a Viterbi decoding circuit converting said sampling value from multilevel data to binary data such that an error between the corrected expected value input from said expected value correction circuit and said sampling value becomes small. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein 
<claim-text>said Viterbi decoding circuit calculates an error between said sampling value and an expected value and outputs the error to said expected value correction circuit, and </claim-text>
<claim-text>said expected value correction circuit corrects said expected value based on said error to obtain said corrected expected value, and outputs said corrected expected value to said Viterbi decoding circuit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00002">claim 2</dependent-claim-reference>, wherein 
<claim-text>said expected value includes a first expected value greater than a direct-current component of said reproduction signal, a second expected value located in a symmetrical position to said first expected value with respect to the direct-current component of said reproduction signal, and a third expected value equal to the direct-current component of said reproduction signal, and </claim-text>
<claim-text>said expected value correction circuit corrects said first and second expected values, and outputs a first corrected expected value obtained by correcting said first expected value and a second corrected expected value obtained by correcting said second expected value to said Viterbi decoding circuit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein 
<claim-text>said Viterbi decoding circuit calculates a first error between said first expected value and said sampling value, a second error between said second expected value and said sampling value and a third error between said third expected value and said sampling value to output to said expected value correction circuit, and </claim-text>
<claim-text>said expected value correction circuit includes 
<claim-text>a signal generating circuit detecting a smallest error from among absolute values of said first, second and third errors, and generating, when the detected error is said first error, a first extract signal for extracting the sampling values corresponding to a region where said first error holds a minimal value, and generating, when said detected error is said second error, a second extract signal for extracting the sampling values corresponding to a region where said second error holds a minimal value, </claim-text>
<claim-text>an averaging circuit extracting the sampling values in said region where said variation is small based on said first or second extract signal, and calculating an average value of the extracted sampling values, and </claim-text>
<claim-text>an expected value operation circuit determining said first corrected expected value based on the average value from said averaging circuit, and calculating said second corrected expected value based on said first corrected expected value and said third expected value. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00004">claim 4</dependent-claim-reference>, wherein 
<claim-text>said signal generating circuit includes 
<claim-text>a select signal generating circuit calculating a difference between said third error at a first timing and said third error at a second timing that is one cycle former than said first timing, and generating an error select signal having an activated level when the difference is smaller than a reference value and having an inactivated level when said difference is greater than the reference value, </claim-text>
<claim-text>an absolute value operation circuit calculating absolute values of said first, second and third errors, </claim-text>
<claim-text>a minimal error determination circuit detecting a minimal value from among the three absolute values calculated by said absolute value operation circuit, and generating, when the detected minimal value is the absolute value of said first error, a first error minimal signal having an activated level corresponding to a time period where said first error holds a minimal value, and generating, when said detected minimal value is the absolute value of said second error, a second error minimal signal having an activated level corresponding to a time period where said second error holds a minimal value, and </claim-text>
<claim-text>an AND gate carrying out logical AND of said first or second error minimal signal and said error select signal to generate said first or second extract signal, and </claim-text>
<claim-text>said averaging circuit latches said third error in synchronization with an activated level of said first or second extract signal, and calculates an average of the average value of said third error at said first timing and said third error at said second timing. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein 
<claim-text>said Viterbi decoding circuit calculates a first error between said first expected value and said sampling value, a second error between said second expected value and said sampling value, and a third error between said third expected value and said sampling value to output to said expected value correction circuit, and </claim-text>
<claim-text>said expected value correction circuit includes 
<claim-text>a signal generating circuit detecting a smallest error from among absolute values of said first, second and third errors, and generating, when the detected error is said first error, a first extract signal for extracting the sampling values corresponding to a central portion of a region where said first error holds a minimal value, and generating, when said detected error is said second error, a second extract signal for extracting the sampling values corresponding to a central portion of a region where said second error holds a minimal value, </claim-text>
<claim-text>an averaging circuit extracting said sampling values based on said first or second extract signal, and calculating an average value of the extracted sampling values, and </claim-text>
<claim-text>an expected value operation circuit determining said first corrected expected value based on the average value from said averaging circuit, and calculating said second corrected expected value based on said first corrected expected value and said third expected value. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00006">claim 6</dependent-claim-reference>, wherein 
<claim-text>said signal generating circuit includes 
<claim-text>an absolute value operation circuit calculating absolute values of said first, second and third errors, </claim-text>
<claim-text>a minimal error determination circuit detecting a minimal value from among the three absolute values calculated by said absolute value operation circuit, and generating, when the detected minimal value is the absolute value of said first error, a first error minimal signal having an activated level corresponding to a time period where said first error holds a minimal value, and generating, when said detected minimal value is the absolute value of said second error, a second error minimal signal having an activated level corresponding to a time period where said second error holds a minimal value, and </claim-text>
<claim-text>an AND gate generating said first extract signal by carrying out logical AND of said first error minimal signal, a first delayed error minimal signal having said first error minimal signal delayed by a prescribed amount of said reference clock and a second delayed error minimal signal having the first delayed error minimal signal delayed by said prescribed amount, and generating said second extract signal by carrying out logical AND of said second error minimal signal, a third delayed error minimal signal having said second error minimal signal delayed by said prescribed amount of said reference clock and a fourth delayed error minimal signal having the third delayed error minimal signal delayed by said prescribed amount, and </claim-text>
<claim-text>said averaging circuit latches said third error in synchronization with an activated level of said first or second extract signal, and calculates an average of the average value of said third error at said first timing and said third error at said second timing. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein 
<claim-text>said Viterbi decoding circuit calculates a first error between said first expected value and said sampling value, a second error between said second expected value and said sampling value, and a third error between said third expected value and said sampling value to output to said expected value correction circuit, and </claim-text>
<claim-text>said expected value correction circuit includes 
<claim-text>a signal generating circuit detecting a smallest error from among said first, second and third errors, and generating, when the detected error is said first error, a first extract signal for extracting said first errors, and generating, when said detected error is said second error, a second extract signal for extracting said second errors, </claim-text>
<claim-text>an averaging circuit extracting said first or second errors based on said first or second extract signal, and calculating an average value of the extracted errors, and </claim-text>
<claim-text>an expected value operation circuit determining said first or second corrected expected value based on a reference expected value added with the average value of said errors. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00008">claim 8</dependent-claim-reference>, wherein 
<claim-text>said signal generating circuit includes 
<claim-text>a minimal error determination circuit detecting a minimal value from among said first, second and third errors, and generating, when the detected minimal value is said first error, a first error minimal signal having an activated level corresponding to a time period where said first error holds a minimal value and a first select signal for selecting said first error, and generating, when said detected minimal value is said second error, a second error minimal signal having an activated level corresponding to a time period where said second error holds a minimal value and a second select signal for selecting said second error, </claim-text>
<claim-text>a select circuit selecting said first or second error based on said first and second select signals, </claim-text>
<claim-text>a select signal generating circuit receiving the error selected by said select circuit and calculating a difference between said error at said first timing and said error at said second timing, and generating an error select signal having an activated level when the difference is smaller than a reference value and having an inactivated level when said difference is greater than the reference value, and </claim-text>
<claim-text>an AND gate carrying out logical AND between said first or second error minimal signal and said error select signal to generate said first or second extract signal, and </claim-text>
<claim-text>said averaging circuit latches the error selected by said select circuit in a time period where said first or second extract signal is at an activated level, and calculates an average of the average value of said error at said first timing and said error at said second timing. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein 
<claim-text>said Viterbi decoding circuit calculates a first error between said first expected value and said sampling value, a second error between said second expected value and said sampling value and a third error between said third expected value and said sampling value to output to said expected value correction circuit, and </claim-text>
<claim-text>said expected value correction circuit includes 
<claim-text>a signal generating circuit detecting a smallest error from among said first, second and third errors, and generating, when the detected error is said first error, a first extract signal for extracting a central portion of a region where said first error holds a minimal value, and generating, when said detected error is said second error, a second extract signal for extracting a central portion of a region where said second error holds a minimal value, </claim-text>
<claim-text>an averaging circuit extracting said first or second errors corresponding to said central portion based on said first or second extract signal and calculating an average value of the extracted errors, and </claim-text>
<claim-text>an expected value operation circuit determining said first or second corrected expected value based on a reference expected value added with the average value of said errors. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00011">claim 10</dependent-claim-reference>, wherein 
<claim-text>said signal generating circuit includes 
<claim-text>a minimal error determination circuit detecting a minimal value from among said first, second and third errors, and generating, when the detected minimal value is said first error, a first error minimal signal having an activated level corresponding to a time period where said first error holds a minimal value, and generating, when said detected minimal value is said second error, a second error minimal signal having an activated level corresponding to a time period where said second error holds a minimal value, and </claim-text>
<claim-text>an AND gate carrying out logical AND of said first error minimal signal, a first delayed error minimal signal having said first error minimal signal delayed by a prescribed amount of said reference clock and a second delayed error minimal signal having the first delayed error minimal signal delayed by said prescribed amount to generate said first extract signal, and carrying out logical AND of said second error minimal signal, a third delayed error minimal signal having said second error minimal signal delayed by said prescribed amount of said reference clock and a fourth delayed error minimal signal having the third delayed error minimal signal delayed by said prescribed amount to generate said second extract signal, and </claim-text>
<claim-text>said averaging circuit latches said first or second error in synchronization with an activated level of said first or second extract signal, and calculates an average of the average value of said first or second error at said first timing and said first or second error at said second timing. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00002">claim 2</dependent-claim-reference>, wherein 
<claim-text>said expected value includes a first expected value greater than a direct-current component of said reproduction signal, a second expected value located in a symmetrical position to said first expected value with respect to the direct-current component of said reproduction signal, and a third expected value equal to the direct-current component of said reproduction signal, and </claim-text>
<claim-text>said expected value correction circuit corrects said first, second and third expected values, and outputs to said Viterbi decoding circuit a first corrected expected value obtained by correcting said first expected value, a second corrected expected value obtained by correcting said second expected value and a third corrected expected value obtained by correcting said third expected value. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00011">claim 12</dependent-claim-reference>, wherein 
<claim-text>said Viterbi decoding circuit calculates a first error between said first expected value and said sampling value, a second error between said second expected value and said sampling value and a third error between said third expected value and said sampling value to output to said expected value correction circuit, and </claim-text>
<claim-text>said expected value correction circuit includes 
<claim-text>a signal generating circuit detecting a smallest error from among absolute values of said first, second and third errors, and generating, when the detected error is said first error, a first extract signal for extracting the third errors in a region where said first error holds a minimal value, generating, when said detected error is said second error, a second extract signal for extracting the third errors in a region where said second error holds a minimal value, and generating, when said detected error is said third error, a third extract signal for extracting the smallest third errors, </claim-text>
<claim-text>a first averaging circuit extracting said third errors based on said first extract signal and calculating an average value of the extracted errors, </claim-text>
<claim-text>a second averaging circuit extracting said third errors based on said second extract signal and calculating an average value of the extracted errors, </claim-text>
<claim-text>a third averaging circuit extracting said third errors based on said third extract signal and calculating an average value of the extracted errors, and </claim-text>
<claim-text>an expected value operation circuit determining said first corrected expected value based on a first error average value output from said first averaging circuit, determining said second corrected expected value based on a second error average value output from said second averaging circuit, and determining said third corrected expected value based on a third error average value output from said third averaging circuit. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00011">claim 13</dependent-claim-reference>, wherein 
<claim-text>said signal generating circuit includes 
<claim-text>a select signal generating circuit calculating a difference between said third error at said first timing and said third error at said second timing, and generating an error select signal having an activated level when the difference is smaller than a reference value and having an inactivated level when said difference is greater than the reference value, </claim-text>
<claim-text>an absolute value operation circuit calculating absolute values of said first, second and third errors, </claim-text>
<claim-text>a minimal error determination circuit detecting a minimal value from among the three absolute values calculated by said absolute value operation circuit, and generating, when the detected minimal value is the absolute value of said first error, a first error minimal signal having an activated level corresponding to a time period where said first error holds a minimal value, generating, when said detected minimal value is the absolute value of said second error, a second error minimal signal having, an activated level corresponding to a time period where said second error holds a minimal value, and generating, when said detected minimal value is the absolute value of said third error, a third error minimal signal having an activated level corresponding to a time period where said third error holds a minimal value, </claim-text>
<claim-text>a first AND gate carrying out logical AND of said first error minimal signal and said error select signal to generate said first extract signal, </claim-text>
<claim-text>a second AND gate carrying out logical AND of said second error minimal signal and said error select signal to generate said second extract signal, and </claim-text>
<claim-text>a third AND gate carrying out logical AND of said third error minimal signal and said error select signal to generate said third extract signal, </claim-text>
<claim-text>said first averaging circuit latches said third error in synchronization with an activated level of said first extract signal, and calculates an average of the average value of said third error at said first timing and said third error at said second timing, </claim-text>
<claim-text>said second averaging circuit latches said third error in synchronization with an activated level of said second extract signal, and calculates an average of the average value of said third error at said first timing and said third error at said second timing, and </claim-text>
<claim-text>said third averaging circuit latches said third error in synchronization with an activated level of said third extract signal, and calculates an average of the average value of said third error at said first timing and said third error at said second timing. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00011">claim 12</dependent-claim-reference>, wherein 
<claim-text>said Viterbi decoding circuit calculates a first error between said first expected value and said sampling value, a second error between said second expected value and said sampling value, and a third error between said third expected value and said sampling value, and outputs said first, second and third errors to said expected value correction circuit, and </claim-text>
<claim-text>said expected value correction circuit includes 
<claim-text>a signal generating circuit detecting a smallest error from among absolute values of said first, second and third errors, and generating, when the detected error is said first error, a first extract signal for extracting a central portion of a region where said first error holds a minimal value, generating, when said detected error is said second error, a second extract signal for extracting a central portion of a region where said second error holds a minimal value, and generating, when said detected error is said third error, a third extract signal for extracting a central portion of a region where said third error holds a minimal value, </claim-text>
<claim-text>a first averaging circuit extracting said third errors corresponding to said central portion based on said first extract signal, and calculating an average value of the extracted errors, </claim-text>
<claim-text>a second averaging circuit extracting said third errors corresponding to said central portion based on said second extract signal, and calculating an average value of the extracted errors, </claim-text>
<claim-text>a third averaging circuit extracting said third errors corresponding to said central portion based on said third extract signal, and calculating an average value of the extracted errors, and </claim-text>
<claim-text>an expected value operation circuit determining said first corrected expected value based on a first error average value output from said first averaging circuit, determining said second corrected expected value based on a second error average value output from said second averaging circuit, and determining said third corrected expected value based on a third error average value output from said third averaging circuit. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference>, wherein 
<claim-text>said signal generating circuit includes 
<claim-text>an absolute value operation circuit calculating absolute values of said first, second and third errors, </claim-text>
<claim-text>a minimal error determination circuit detecting a minimal value from the three absolute values calculated by said absolute value operation circuit, and generating, when the detected minimal value is the absolute value of said first error, a first error minimal signal having an activated level corresponding to a time period where said first error holds a minimal value, generating, when said detected minimal value is the absolute value of said second error, a second error minimal signal having an activated level corresponding to a time period where said second error holds a minimal value, and generating, when said detected minimal value is the absolute value of said third error, a third error minimal signal having an activated level corresponding to a time period where said third error holds a minimal value, </claim-text>
<claim-text>a first AND gate carrying out logical AND of said first error minimal signal, a first delayed error minimal signal having said first error minimal signal delayed by a prescribed amount of said reference clock and a second delayed error minimal signal having the first delayed error minimal signal delayed by said prescribed amount to generate said first extract signal, </claim-text>
<claim-text>a second AND gate carrying out logical AND of said second error minimal signal, a third delayed error minimal signal having said second error minimal signal delayed by said prescribed amount of said reference clock and a fourth delayed error minimal signal having the third delayed error minimal signal delayed by said prescribed amount to generate said second extract signal, and </claim-text>
<claim-text>a third AND gate carrying out logical AND of said third error minimal signal, a fifth delayed error minimal signal having said third error minimal signal delayed by said prescribed amount of said reference clock and a sixth delayed error minimal signal having the fifth delayed error minimal signal delayed by said prescribed amount to generate said third extract signal, </claim-text>
<claim-text>said first averaging circuit latches said third error in synchronization with an activated level of said first extract signal, and calculates an average of the average value of said third error at said first timing and said third error at said second timing, </claim-text>
<claim-text>said second averaging circuit latches said third error in synchronization with an activated level of said second extract signal, and calculates an average of the average value of said third error at said first timing and said third error at said second timing, and </claim-text>
<claim-text>said third averaging circuit latches said third error in synchronization with an activated level of said third extract signal, and calculates an average of the average value of said third error at said first timing and said third error at said second timing. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00011">claim 12</dependent-claim-reference>, wherein 
<claim-text>said Viterbi decoding circuit calculates a first error between said first expected value and said sampling value, a second error between said second expected value and said sampling value and a third error between said third expected value and said sampling value to output to said expected value correction circuit, and </claim-text>
<claim-text>said expected value correction circuit includes 
<claim-text>a signal generating circuit detecting a smallest error from among absolute values of said first, second and third errors, and generating, when the detected error is said first error, a first extract signal for extracting said first errors, generating, when said detected error is said second error, a second extract signal for extracting said second errors, and generating, when said detected error is said third error, a third extract signal for extracting said third errors, </claim-text>
<claim-text>a first averaging circuit extracting said first errors based on said first extract signal, and calculating an average value of the extracted errors, </claim-text>
<claim-text>a second averaging circuit extracting said second errors based on said second extract signal, and calculating an average value of the extracted errors, </claim-text>
<claim-text>a third averaging circuit extracting said third errors based on said third extract signal, and calculating an average value of the extracted errors, and </claim-text>
<claim-text>an expected value operation circuit determining said first corrected expected value based on a first reference expected value added with a first error average value output from said first averaging circuit, determining said second corrected expected value based on a second reference expected value added with a second error average value output from said second averaging circuit, and determining said third corrected expected value based on a third reference expected value added with a third error average value output from said third averaging circuit. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00011">claim 17</dependent-claim-reference>, wherein 
<claim-text>said signal generating circuit includes 
<claim-text>a minimal error determination circuit detecting a minimal value from among said first, second and third errors, and generating, when the detected minimal value is said first error, a first error minimal signal having an activated level corresponding to a time period where said first error holds a minimal value and a first select signal for selecting said first error, generating, when said detected minimal value is said second error, a second error minimal signal having an activated level corresponding to a time period where said second error holds a minimal value and a second select signal for selecting said second error, and generating, when said detected minimal value is said third error, a third error minimal signal having an activated level corresponding to a time period where said third error holds a minimal value and a third select signal for selecting said third error, </claim-text>
<claim-text>a select circuit selecting said first, second and third errors based on said first, second and third select signals, respectively, </claim-text>
<claim-text>a select signal generating circuit receiving the error selected by said select circuit and calculating a difference between said error at said first timing and said error at said second timing, and generating an error select signal having an activated level when the difference is smaller than a reference value and an inactivated level when said difference is greater than the reference value, </claim-text>
<claim-text>a first AND gate carrying out logical AND of said first error minimal signal and said error select signal to generate said first extract signal, </claim-text>
<claim-text>a second AND gate carrying out logical AND of said second error minimal signal and said error select signal to generate said second extract signal, and </claim-text>
<claim-text>a third AND gate carrying out logical AND of said third error minimal signal and said error select signal to generate said third extract signal, </claim-text>
<claim-text>said first averaging circuit latches said first error in synchronization with an activated level of said first extract signal, and calculates an average of the average value of said first error at said first timing and said first error at said second timing to output said first error average value, </claim-text>
<claim-text>said second averaging circuit latches said second error in synchronization with an activated level of said second extract signal, and calculates an average of the average value of said second error at said first timing and said second error at said second timing to output said second error average value, and </claim-text>
<claim-text>said third averaging circuit latches said third error in synchronization with an activated level of said third extract signal, and calculates an average of the average value of said third error at said first timing and said third error at said second timing to output said third error average value. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00011">claim 12</dependent-claim-reference>, wherein 
<claim-text>said Viterbi decoding circuit calculates a first error between said first expected value and said sampling value, a second error between said second expected value and said sampling value and a third error between said third expected value and said sampling value to output to said expected value correction circuit, and </claim-text>
<claim-text>said expected value correction circuit includes 
<claim-text>a signal generating circuit detecting a smallest error from among absolute values of said first, second and third errors, and generating, when the detected error is said first error, a first extract signal for extracting a central portion of a region where said first error holds a minimal value, generating, when said detected error is said second error, a second extract signal for extracting a central portion of a region where said second error holds a minimal value, and generating, when said detected error is said third error, a third extract signal for extracting a central portion of a region where said third error holds a minimal value, </claim-text>
<claim-text>a first averaging circuit extracting said first errors corresponding to said central portion based on said first extract signal, and calculating an average value of the extracted errors, </claim-text>
<claim-text>a second averaging circuit extracting said second errors corresponding to said central portion based on said second extract signal, and calculating an average value of the extracted errors, </claim-text>
<claim-text>a third averaging circuit extracting said third errors corresponding to said central portion based on said third extract signal, and calculating an average value of the extracted errors, and </claim-text>
<claim-text>an expected value operation circuit determining said first corrected expected value based on a first reference expected value added with a first error average value output from said first averaging circuit, determining said second corrected expected value based on a second reference expected value added with a second error average value output from said second averaging circuit, and determining said third corrected expected value based on a third reference expected value added with a third error average value output from said third averaging circuit. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. The optical disk apparatus according to <dependent-claim-reference depends_on="CLM-00011">claim 19</dependent-claim-reference>, wherein 
<claim-text>said signal generating circuit includes 
<claim-text>a minimal error determination circuit detecting a minimal value from among said first, second and third errors, and generating, when the detected minimal value is said first error, a first error minimal signal having an activated level corresponding to a time period where said first error holds a minimal value, generating, when said detected minimal value is said second error, a second error minimal signal having an activated level corresponding to a time period where said second error holds a minimal value, and generating, when said detected minimal value is said third error, a third error minimal signal having an activated level corresponding to a time period where said third error holds a minimal value, </claim-text>
<claim-text>a first AND gate carrying out logical AND of said first error minimal signal, a first delayed error minimal signal having said first error minimal signal delayed by a prescribed amount of said reference clock and a second delayed error minimal signal having the first delayed error minimal signal delayed by said prescribed amount to generate said first extract signal, </claim-text>
<claim-text>a second AND gate carrying out logical AND of said second error minimal signal, a third delayed error minimal signal having said second error minimal signal delayed by said prescribed amount of said reference clock and a fourth delayed error minimal signal having the third delayed error minimal signal delayed by said prescribed amount to generate said second extract signal, and </claim-text>
<claim-text>a third AND gate carrying out logical AND of said third error minimal signal, a fifth delayed error minimal signal having said third error minimal signal delayed by said prescribed amount of said reference clock and a sixth delayed error minimal signal having the fifth delayed error minimal signal delayed by said prescribed amount to generate said third extract signal, </claim-text>
<claim-text>said first averaging circuit latches said first error in synchronization with an activated level of said first extract signal, and calculates an average of the average value of said first error at said first timing and said first error at said second timing to output said first error averaging value, </claim-text>
<claim-text>said second averaging circuit latches said second error in synchronization with an activated level of said second extract signal, and calculates an average of the average value of said second error at said first timing and said second error at said second timing to output said second error average value, and </claim-text>
<claim-text>said third averaging circuit latches said third error in synchronization with an activated level of said third extract signal, and calculates an average of the average value of said third error at said first timing and said third error at said second timing to output said third error average value.</claim-text>
</claim-text>
</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>13</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030002419A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030002419A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030002419A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030002419A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030002419A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030002419A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030002419A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030002419A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030002419A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00009">
<image id="EMI-D00009" file="US20030002419A1-20030102-D00009.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00010">
<image id="EMI-D00010" file="US20030002419A1-20030102-D00010.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00011">
<image id="EMI-D00011" file="US20030002419A1-20030102-D00011.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00012">
<image id="EMI-D00012" file="US20030002419A1-20030102-D00012.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00013">
<image id="EMI-D00013" file="US20030002419A1-20030102-D00013.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00014">
<image id="EMI-D00014" file="US20030002419A1-20030102-D00014.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00015">
<image id="EMI-D00015" file="US20030002419A1-20030102-D00015.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00016">
<image id="EMI-D00016" file="US20030002419A1-20030102-D00016.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00017">
<image id="EMI-D00017" file="US20030002419A1-20030102-D00017.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00018">
<image id="EMI-D00018" file="US20030002419A1-20030102-D00018.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00019">
<image id="EMI-D00019" file="US20030002419A1-20030102-D00019.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00020">
<image id="EMI-D00020" file="US20030002419A1-20030102-D00020.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00021">
<image id="EMI-D00021" file="US20030002419A1-20030102-D00021.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00022">
<image id="EMI-D00022" file="US20030002419A1-20030102-D00022.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00023">
<image id="EMI-D00023" file="US20030002419A1-20030102-D00023.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00024">
<image id="EMI-D00024" file="US20030002419A1-20030102-D00024.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00025">
<image id="EMI-D00025" file="US20030002419A1-20030102-D00025.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00026">
<image id="EMI-D00026" file="US20030002419A1-20030102-D00026.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00027">
<image id="EMI-D00027" file="US20030002419A1-20030102-D00027.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
