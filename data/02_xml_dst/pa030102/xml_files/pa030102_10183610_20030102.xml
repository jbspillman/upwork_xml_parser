<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030002865A1-20030102-D00000.TIF SYSTEM "US20030002865A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030002865A1-20030102-D00001.TIF SYSTEM "US20030002865A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030002865A1-20030102-D00002.TIF SYSTEM "US20030002865A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030002865A1-20030102-D00003.TIF SYSTEM "US20030002865A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030002865A1-20030102-D00004.TIF SYSTEM "US20030002865A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030002865A1-20030102-D00005.TIF SYSTEM "US20030002865A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030002865A1-20030102-D00006.TIF SYSTEM "US20030002865A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030002865A1-20030102-D00007.TIF SYSTEM "US20030002865A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030002865A1-20030102-D00008.TIF SYSTEM "US20030002865A1-20030102-D00008.TIF" NDATA TIF>
<!ENTITY US20030002865A1-20030102-D00009.TIF SYSTEM "US20030002865A1-20030102-D00009.TIF" NDATA TIF>
<!ENTITY US20030002865A1-20030102-D00010.TIF SYSTEM "US20030002865A1-20030102-D00010.TIF" NDATA TIF>
<!ENTITY US20030002865A1-20030102-D00011.TIF SYSTEM "US20030002865A1-20030102-D00011.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030002865</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10183610</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20020628</filing-date>
</domestic-filing-data>
<foreign-priority-data>
<priority-application-number>
<doc-number>2001-198529</doc-number>
</priority-application-number>
<filing-date>20010629</filing-date>
<country-code>JP</country-code>
</foreign-priority-data>
<foreign-priority-data>
<priority-application-number>
<doc-number>2002-126983</doc-number>
</priority-application-number>
<filing-date>20020426</filing-date>
<country-code>JP</country-code>
</foreign-priority-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>H04N005/781</ipc>
</classification-ipc-primary>
<classification-ipc-secondary>
<ipc>H04N007/173</ipc>
</classification-ipc-secondary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>386</class>
<subclass>125000</subclass>
</uspc>
</classification-us-primary>
<classification-us-secondary>
<uspc>
<class>725</class>
<subclass>087000</subclass>
</uspc>
</classification-us-secondary>
<classification-us-secondary>
<uspc>
<class>725</class>
<subclass>091000</subclass>
</uspc>
</classification-us-secondary>
</classification-us>
<title-of-invention>Data playback apparatus and data relay apparatus</title-of-invention>
</technical-information>
<inventors>
<first-named-inventor>
<name>
<given-name>Yoshinori</given-name>
<family-name>Matsui</family-name>
</name>
<residence>
<residence-non-us>
<city>Ikoma-shi</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Youji</given-name>
<family-name>Notoya</family-name>
</name>
<residence>
<residence-non-us>
<city>Neyagawa-shi</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<correspondence-address>
<name-1>WENDEROTH, LIND &amp; PONACK, L.L.P.</name-1>
<name-2></name-2>
<address>
<address-1>2033 K STREET N. W.</address-1>
<address-2>SUITE 800</address-2>
<city>WASHINGTON</city>
<state>DC</state>
<postalcode>20006-1021</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">When a server as a transmission source of content data is changed in a state where the content data from the server are played back in a receiving terminal, the receiving terminal receives the content data starting from the head of its not-yet-played portion to be played. A receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>for receiving content data transmitted from a server to be played is provided with a time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a </italic></highlight>for generating not-yet-played range information Ir indicating a range of a not-yet-played portion in the content data on the basis of time information concerning the playback process, which information is added to the content data in predetermined data units. When receiving a message for requesting to change the server S as the data transmission source, the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>transmits a message requesting the content data to a new transmission source server with adding the not-yet-played range information to the data. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">FIELD OF THE INVENTION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> The present invention relates to a data playback apparatus and a data relay apparatus and, more particularly, to a server change processing for changing a server as a data transmission source to another server in a state where data are being received and played back by a receiving terminal. </paragraph>
</section>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> The processing of changing a server that is a transmission source of content data such as image data and audio data (hereinafter, referred to also as a specific server), to another server (hereinafter, referred to also as an alternate server) in a state where the content data are being received and played back by a receiving terminal is carried out in accordance with a REDIRECT request from the specific server. This REDIRECT request is one of methods according to an RTSP (Real Time Streaming Protocol), i.e., a protocol for exchanging messages between a server and a receiving terminal, and this method is issued from a data transmitting end to a receiving end. The RTSP is standardized (RFC2326) by Internet standardization groups such as IETF (Internet Engineering Task Force), and is increasingly implemented. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> As methods according to RTSP, there are a SETUP request for setting a session between a server and a terminal (establishing a state in which data can be communicated), a PLAY request for requesting playback of data on the receiving end to a server, a TEARDOWN request for releasing a session (releasing a state in which data can be communicated) and the like, in addition to the REDIRECT request. </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> The REDIRECT request always includes Location information indicating a URL (Universal Resource Locator) of the alternate server. When receiving this REDIRECT request, the receiving terminal finishes the session between the present server (specific server) and the receiving terminal, establishes a session with the alternate server, and receives data transmitted from the alternate server to be played back. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is a block diagram for explaining a prior art receiving terminal. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> A prior art receiving terminal <highlight><bold>200</bold></highlight> receives content data including at least one of image data and audio data which are transmitted from a server S, via a network such as the Internet, and plays the received data. The receiving terminal <highlight><bold>200</bold></highlight> has an RTSP exchange unit <highlight><bold>201</bold></highlight> that exchanges RTSP messages M with the server S, and an RTSP receiving unit <highlight><bold>202</bold></highlight> that receives content data (hereinafter, referred to also as RTP packet data) Dp that is transmitted being contained in RTP packets from the server S, in accordance with a control signal Ct from the RTSP exchange unit <highlight><bold>201</bold></highlight>. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> The RTSP exchange unit <highlight><bold>201</bold></highlight> outputs an SSRC (Synchronization Source) as identification information that indicates an ID number for identifying an RTP packet, or operation instructing information that controls a data receiving operation in the RTP receiving unit <highlight><bold>202</bold></highlight>, as the control signal Ct, on the basis of information that is obtained by exchanging RTSP messages M. The SSRC (packet identification information) that indicates the ID number of each packet is one of RTP packet attribution information that is supplied from the server. The ID numbers of RTP packets which are transmitted from one server and contain the same content data are all the same. The content data are audio/video data (AV data) including image information and sound information. The RTP receiving unit <highlight><bold>202</bold></highlight> extracts the content data which are contained in each RTP packet, and outputs AV data Dr corresponding to each frame. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> The receiving terminal <highlight><bold>200</bold></highlight> has a decoding unit <highlight><bold>203</bold></highlight> for decoding the AV data Dr to output decoded AV data Dd, and a display unit <highlight><bold>204</bold></highlight> for performing image display or sound playback on the basis of the decoded AV data Dd. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> The server S has an RTSP exchange unit Sm for exchanging messages with the receiving terminal <highlight><bold>200</bold></highlight>, and an RTP transmission unit Sd for transmitting desired data being contained in RTP packets to the receiving terminal <highlight><bold>200</bold></highlight> in accordance with a control signal Cs from the RTSP exchange unit Sm. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> Next, the operation will be described. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a diagram showing the exchange of the RTSP messages M and the transmission of the RTP packets Dp, performed between the server and the receiving terminal. In <cross-reference target="DRAWINGS">FIG. 12</cross-reference>, for convenience of explanation, a specific server Sa having an RTSP exchange unit Sa<highlight><bold>1</bold></highlight> and an RTP transmission unit Sa<highlight><bold>2</bold></highlight>, and an alternate server Sb having an RTSP exchange unit Sb<highlight><bold>1</bold></highlight> and an RTP transmission unit Sb<highlight><bold>2</bold></highlight> are shown as servers S. Further, to simplify the explanations, the message exchanges performed between a DESCRIBE request that requests the content data and a PLAY request that requests the data playback in the receiving terminal are omitted here. </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> When a DESCRIBE request (DESCRIBE rtsp://svr-A.com/v.mp4) T<highlight><bold>1</bold></highlight> that requests file data (v.mp4) held in the server (svr-A.com) Sa is issued as the RTSP message M from the RTSP exchange unit <highlight><bold>201</bold></highlight> in the receiving terminal <highlight><bold>200</bold></highlight> to the server Sa, this DESCRIBE request T<highlight><bold>1</bold></highlight> is received by the RTSP exchange unit Sa<highlight><bold>1</bold></highlight> in the server Sa, and a response (RTSP/1.0 OK) to this request T<highlight><bold>1</bold></highlight> is issued to the receiving terminal <highlight><bold>200</bold></highlight>. Thereafter, the message M is further exchanged between the server Sa and the receiving terminal <highlight><bold>200</bold></highlight>. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> Then, when a PLAY request (PLAY rtsp://svr-A.com/v.mp4) T<highlight><bold>2</bold></highlight> that requests playback of the file data (v.mp4) is issued as an RTSP message M from the RTSP exchange unit <highlight><bold>201</bold></highlight> in the receiving terminal <highlight><bold>200</bold></highlight> to the server (svr-A.com) Sa, this PLAY request T<highlight><bold>2</bold></highlight> is received by the RTSP exchange unit Sa<highlight><bold>1</bold></highlight> in the server Sa, and a response (RTSP/1.0 OK) Al to the request T<highlight><bold>2</bold></highlight> is successively issued by the RTSP exchange unit Sa<highlight><bold>1</bold></highlight> to the receiving terminal <highlight><bold>200</bold></highlight>. Thereafter, in the server Sa, a transmission command A<highlight><bold>2</bold></highlight> that instructs to transmit the file data (V.mp4) to the receiving terminal is issued from the RTSP exchange unit Sa<highlight><bold>1</bold></highlight> to the RTP transmission unit Sa<highlight><bold>2</bold></highlight>. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> Then, the file data (v.mp4) are transmitted from the RTP transmission unit Sa<highlight><bold>2</bold></highlight> in the server Sa to the receiving terminal <highlight><bold>200</bold></highlight> being contained in RTP packets as RTP packet data Da. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> The RTP packet data Da are received by the RTP receiving unit <highlight><bold>202</bold></highlight> in the receiving terminal <highlight><bold>200</bold></highlight> in accordance with the control signal Ct from the RTSP exchange unit <highlight><bold>201</bold></highlight>, and audio/video data (AV data) Dr corresponding to each frame are outputted. The AV data Dr are decoded by the decoding unit <highlight><bold>203</bold></highlight>, and decoded AV data Dd are outputted to the display unit <highlight><bold>204</bold></highlight>. The display unit <highlight><bold>204</bold></highlight> performs image display and sound playback on the basis of the decoded AV data Dd. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> When the REDIRECT request (REDIRECT rtsp://svr-A.com/v.mp4) A<highlight><bold>3</bold></highlight> is issued from the server Sa as the RTSP message M in a state where the data Da transmitted from the server Sa are received and played back in the receiving terminal <highlight><bold>200</bold></highlight>, this REDIRECT request A<highlight><bold>3</bold></highlight> is received by the RTSP exchange unit <highlight><bold>201</bold></highlight> in the receiving terminal <highlight><bold>200</bold></highlight>. This REDIRECT request A<highlight><bold>3</bold></highlight> requests to finish the session with the present server (specific server) Sa, establish a new session with the alternate server Sb, and receive content data from the alternate server to be played back. This REDIRECT request A<highlight><bold>3</bold></highlight> includes Location information (Location: rtsp://svr-B.com/v.mp4) indicating a URL (Universal Resource Locator) of the alternate server. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> Then, a response (RPST/1.0 OK) T<highlight><bold>3</bold></highlight> that acknowledges the REDIRECT request A<highlight><bold>3</bold></highlight> is issued from the RTSP exchange unit <highlight><bold>201</bold></highlight> to the server Sa. Further, a TEARDOWN request (TEARDOWN rpst://svr-A.com/v.mp4) T<highlight><bold>4</bold></highlight> that request termination of the session is issued to the server Sa. Then, in the server Sa, a processing for issuing a response (RTSP/1.0 OK) A<highlight><bold>4</bold></highlight> that acknowledges the TEARDOWN request T<highlight><bold>4</bold></highlight>, as well as finishing the transmission of the RTP packet data Da from the server Sa is carried out. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> After the response A<highlight><bold>4</bold></highlight> to the TEARDOWN request T<highlight><bold>4</bold></highlight> from the server Sa is received by the RTSP exchange unit <highlight><bold>201</bold></highlight> in the receiving terminal <highlight><bold>200</bold></highlight>, a DESCRIBE request (DESCRIBE rtsp://svr-B.com/v.mp4) T<highlight><bold>5</bold></highlight> that requests the file data (v.mp4) held in the server (svr-B.com) Sb is issued to the server Sb as the RTSP message M, on the basis of the Location information of the alternate server Sb included in the TEARDOWN request T<highlight><bold>4</bold></highlight>. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> Then, this DESCRIBE request T<highlight><bold>5</bold></highlight> is received by the RTSP exchange unit Sb<highlight><bold>1</bold></highlight> in the server Sb, and a response to this request T<highlight><bold>5</bold></highlight> is issued from the RTSP exchange unit Sb<highlight><bold>1</bold></highlight> to the receiving terminal <highlight><bold>200</bold></highlight>. Thereafter, the message M is further exchanged between the server Sb and the receiving terminal <highlight><bold>200</bold></highlight>. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> Then, when the PLAY request (PLAY rtsp://svr-B.com/v.mp4) T<highlight><bold>6</bold></highlight> that request the playback of the file data (V.mp4) in the receiving terminal is issued from the RTSP exchange unit <highlight><bold>201</bold></highlight> to the server (svr-B.com) Sb as the RTSP message M, this PLAY request T<highlight><bold>6</bold></highlight> is received by the RTSP exchange unit Sb<highlight><bold>1</bold></highlight> in the server Sb, and a response (RTSP/1.0 OK) A<highlight><bold>5</bold></highlight> to the request T<highlight><bold>6</bold></highlight> is issued from the RTSP exchange unit Sb<highlight><bold>1</bold></highlight> to the receiving terminal <highlight><bold>200</bold></highlight>. Thereafter, in the server Sb, a transmission command A<highlight><bold>6</bold></highlight> that instructs to transmit the file data (v.mp4) to the receiving terminal <highlight><bold>200</bold></highlight> is issued from the RTSP exchange unit Sb<highlight><bold>1</bold></highlight> to the RTP transmission unit Sb<highlight><bold>2</bold></highlight>. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> Then, the file data (v.mp4) Db are transmitted from the RTP transmission unit Sb<highlight><bold>2</bold></highlight> to the receiving terminal <highlight><bold>200</bold></highlight> as RTP packet data Dp, being contained in RTP packets. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> The RTP packet data Db are received by the RTP receiving unit <highlight><bold>202</bold></highlight> in the receiving terminal <highlight><bold>200</bold></highlight> on the basis of the control signal Ct from the RTSP exchange unit <highlight><bold>201</bold></highlight>, and audio/video data (AV data) Dr corresponding to each frame are outputted. The AV data Dr are decoded by the decoding unit <highlight><bold>203</bold></highlight>, and decoded AV data Dd are outputted to the display unit <highlight><bold>204</bold></highlight>. In the display unit <highlight><bold>204</bold></highlight>, image display and sound playback is performed on the basis of the decoded AV data Dd. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> As described above, when receiving the REDIRECT request from the server Sa, the receiving terminal <highlight><bold>200</bold></highlight> carries out the server change processing for finishing a session with the present server (specific server) Sa, and establishing a new session with the alternate server Sb. Thereafter, the receipt and playback of content data from the alternate server is started. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> In the conventional receiving terminal <highlight><bold>200</bold></highlight>, when the specific server as a supply source of data is switched to the alternate server in accordance with the REDIRECT request in a state where content data are received from the specific server Sa and played back, the receipt and playback of content data from the alternate server is started unfavorably from its head portion. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> Hereinafter, this problem will be described in more detail. Descriptions will be given of a case where the REDIRECT request from the server Sa is received when playback of content data whose playback time is ten minutes on the whole is carried out in the receiving terminal <highlight><bold>200</bold></highlight> starting from the head of the content data up to a position whose playback time is six minutes, and a transmission server for the content data is switched from the specific server Sa to the alternate server Sb. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> In this case, since the conventional receiving terminal <highlight><bold>200</bold></highlight> only requests the content data to the server Sb, content data are transmitted from the server Sb starting from its head portion. Therefore, in the receiving terminal <highlight><bold>200</bold></highlight>, the receipt and playback of the content data is performed from its head portion. Consequently, although the portion of the content data corresponding to first six minutes has been already viewed, this portion is adversely played back again in the receiving terminal <highlight><bold>200</bold></highlight>. That is, when the server is changed in accordance with the REDIRECT request, efficient playback cannot be performed in the receiving terminal, and also extra communication fees are required. </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> In receiving terminals including a time bar for designating a playback position, the user can set the playback position after the server changing by adjusting the time bar so as not to play back a portion which has already been played back. However, not all the receiving terminals include such a user interface. Further, there may be some contents whose playback positions cannot be adjusted by the user operation. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> The present invention has for its object to provide a data playback apparatus and a data playback method which, when a server as a transmission source of content data is changed in accordance with a REDIRECT request while the content data which are supplied from the data transmission source are being received and played back in a receiving terminal, can continuously perform receipt and playback of the content data starting from a data playback position at a timing when the server is changed. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> It is an object of the present invention to provide a data relay apparatus and data relay method which, when a server as a transmission source of content data is changed in accordance with a REDIRECT request from the server as the data transmission source while the content data which are supplied from the data transmission source is being relayed and transmitted to a receiving terminal, can continuously perform transmission of the content data to the receiving terminal from a data transmission position at a timing when the transmission server is changed. </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> Other objects and advantages of the present invention will become apparent from the detailed description and specific embodiments described are provided only for illustration since various additions and modifications within the spirit and scope of the invention will be apparent to those of skill in the art from the detailed description. </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> According to a 1st aspect, there is provided a data playback apparatus which requests data including at least one of image information and audio information, and plays back the data transmitted in accordance with the request while receiving the data, comprising: a message transmission/receiving unit operable to transmit/receive messages to establish a state in which data can be received, and outputting a control signal that controls a receiving operation for the data; a data receiving unit operable to receive the data in accordance with the control signal; and a range information generation unit operable to generate not-yet-played range information that indicates a range of a not-yet-played portion in the data, on the basis of time information concerning a playback process, which is added to the data in predetermined data units, and the message transmission/receiving unit transmits a message for requesting data corresponding to the not-yet-played portion indicated by the not-yet-played range information to a new server, when receiving a message requesting to change the server as a target of the data request. Therefore, when a server that is transmitting desired data is changed in accordance with a server changing request during when the desired data from the server are played back by the data playback apparatus, the data playback apparatus can receive and play back the desired data starting from the head of the not-yet-played portion. Accordingly, after the server is changed, receiving and playing back again already-played portions of the desired data can be avoided, whereby the communication fees can be reduced, and further reproduced images and sounds can be efficiently viewed and listened. </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> According to a 2nd aspect of the present invention, in the data playback apparatus of the 1st aspect, the time information is information which is added to the data for each frame as the data unit, and indicates a time when the frame is displayed. Therefore, after the server is changed, display of reproduced images can be performed starting from a head frame of a not yet-played portion in the desired data. </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> According to a 3rd aspect of the present invention, in the data playback apparatus of the 1st aspect, the data receiving unit receives the data which are contained in packets, and the time information is added to each of the packets. Therefore, after the server is changed, the data can be received starting from a head packet that contains a not-yet-played portion in the desired data. </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> According to a 4th aspect of the present invention, in the data playback apparatus of the 3rd aspect, the range information generation unit generates the not-yet-played range information on the basis of latest time information added to a latest packet that was received by the data receiving unit, and either first initial time information added to a packet that was received first after the data receivable state is established, or second initial time information added to a packet that is to be received first after the data receivable state is established, which is obtained by the transmission/receipt of messages by the message transmission/receiving unit. Therefore, the second initial time information is used in cases where the second initial time information is obtained, while the first initial time information is used in cases where the second initial time information is not obtained. </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> According to a 5th aspect of the present invention, there is provided a data playback method for requesting data including at least one of image information and audio information, and playing back the data transmitted in accordance with the request while receiving the same, comprising: a message transmission/receiving step of transmitting/receiving messages to establish a state in which data can be received, and generating a control signal that controls a receiving operation for the data; a data receiving step of receiving the data in accordance with the control signal after the data receivable state is established; and a range information generation step of generating not-yet-played range information that indicates a range of a not-yet-played portion in the data, on the basis of time information concerning a playback process, which is added to the data in predetermined data units, and the message transmission/receiving step transmits a message for requesting data corresponding to the not-yet-played portion indicated by the not-yet-played range information to a new server, when a message for requesting to change the server as a target of the data request is received. Therefore, when a server that is transmitting the desired data is changed in accordance with a server changing request during when the desired data from the server are being played back in a receiving terminal, the receiving terminal can receive and play back the desired data starting from the head of the not-yet-played portion. Accordingly, communication fees required for the receipt of data after the server is changed can be reduced, and further reproduced images and sounds can be efficiently viewed and listened. </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> According to a 6th aspect of the present invention, there is provided a data relay apparatus that is connected to plural servers via a network, and requests data including at least one of image information and audio information to a specific server selected from the plural servers, to relay the data transmitted from the specific server in accordance with the request to transmit the same, including: a server-side message exchange unit operable to exchange messages with the specific server to establish a state where the data transmitted from the specific server can be received, and output a receipt control signal that controls a receiving operation for the transmitted data; a data receiving unit operable to receive the data transmitted from the specific server in accordance with the receipt control signal; and a range information generation unit operable to generate not-yet-played range information that indicates a range of a not-yet-played portion in the data, on the basis of time information concerning a playback process, which information is added to the data in predetermined data units, and the server-side message exchange unit transmits a message for requesting the data to an alternate server with adding the not-yet-played range information to the message, when a message for requesting to switch a server as a supply source of the data from the specific server to the alternate server is received from the specific server. Therefore, when a server which is transmitting desired data is changed in accordance with a server changing request during when the desired data from the server are played back in the receiving terminal, the data relay apparatus can receive the desired data starting from the head of the not-yet-played portion and transmit the data to the receiving terminal. Accordingly, communication fees required for the receipt of data after the server is changed can be reduced without changing the structure of the receiving terminal, and further reproduced images and sounds can be efficiently viewed and listened. </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> According to a 7th aspect of the present invention, the data relay apparatus of the 6th aspect including: a buffer for temporarily retaining the received data; a terminal-side message exchange unit operable to exchange messages with a transmission destination to establish a state where the data retained in the buffer can be transmitted, and outputting a transmission control signal that controls a transmission operation for the data; and a data transmission unit operable to transmit the data retained in the buffer on the basis of the transmission control signal. Therefore, even when a server which is transmitting desired data is changed in accordance with a server changing request during when the desired data from the server are played back in a receiving terminal, a session that is established between the data relay apparatus and the receiving terminal (i.e., a state in which data can be transmitted from the data relay apparatus to the receiving terminal) is not finished. Accordingly, even when the server that is transmitting the desired data is changed, message exchanges for finishing a session and establishing a new session between the data relay apparatus and the receiving terminal are not required. </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> According to an 8th aspect of the present invention, in the data relay apparatus of the 7th aspect, the data receiving unit receives the data which are contained in packets transmitted from the server as a transmission source of the data, and the data transmission unit has an attribute information rewriting section for rewriting attribute information that is added to packets which contain data transmitted from the alternate server, into attribute information that is added to packets which contain the data transmitted from the specific server so that a data playback process in a transmission destination of the data is not interrupted, and transmits the packets which contain the data transmitted from the alternate server, with rewriting the attribute information thereof into the attribute information of the packets containing the data transmitted from the specific server. Therefore, even when a server that is transmitting desired data is changed in accordance with a server changing request during when the desired data from the server are played back in a receiving terminal, the receiving terminal performs the playback of the desired data without interruption, whereby the display states of reproduced images are not disturbed, and noises are not included in played sounds. </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> According to a 9th aspect of the present invention, there is provided a data relay method for requesting data including at least one of image information and audio information, to a specific server selected from plural servers on a network, and relaying the data transmitted from the specific server in accordance with the request to transmit the same, comprising: a message exchange step of exchanging messages with the specific server to establish a state in which data transmitted from the specific server can be received, and generating a receipt control signal that controls a receiving operation for the transmitted data; a data receiving step of receiving the data transmitted from the specific server in accordance with the receipt control signal after the transmitted data receivable state is established; and a range information generation step of generating not-yet-played range information that indicates a range of a not-yet-played portion in the data on the basis of time information concerning a playback process, which is added to the data in predetermined data units, and the message exchange step transmits a message for requesting the data to an alternate server with adding the not-yet-played range information to the message, when a message for requesting to switch a server as a supply source of the data from the specific server to the alternate server is issued from the specific server. Therefore, when a server that is transmitting desired data is changed in accordance with a server changing request during when the desired data from the server are played back in a receiving terminal, the data relay apparatus receives the desired data starting from the head of its not-yet-played portion, and transmits the data to the receiving terminal, whereby communication fees required for receipt of the data after the server is changed can be reduced without changing the structure of the receiving terminal, and further reproduced images and sounds can be efficiently viewed and listened.</paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a block diagram for explaining a data playback apparatus according to a first embodiment of the present invention. </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a diagram showing storage areas in a time information storage processing unit of the data playback apparatus according to the first embodiment. </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a flowchart showing an operation process in the time information storage processing unit of the data playback apparatus according to the first embodiment. </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a diagram showing accesses for RTSP messages M and packet data D, which are performed between a server and a receiving terminal according to a predetermined protocol. </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference>(<highlight><italic>a</italic></highlight>) is a diagram showing details of message exchange between the data playback apparatus of the first embodiment and a server, and <cross-reference target="DRAWINGS">FIG. 5</cross-reference>(<highlight><italic>b</italic></highlight>) is a diagram showing SDP information included in a REDIRECT request for the data playback apparatus. </paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a block diagram for explaining a data playback apparatus according to a second embodiment of the present invention. </paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a block diagram for explaining a data relay apparatus according to a third embodiment of the present invention. </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a block diagram illustrating a specific structure of the data relay apparatus according to the third embodiment. </paragraph>
<paragraph id="P-0048" lvl="0"><number>&lsqb;0048&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a diagram showing accesses of messages and data between the data relay apparatus according to the third embodiment and servers, and the data relay apparatus and a receiving terminal. </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a diagram for explaining a portable phone as a data playback apparatus according to a fourth embodiment of the present invention. </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is a block diagram illustrating a prior art data playback apparatus. </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a diagram showing accesses for RTSP messages and packet data D, which are performed between a server and a receiving terminal according to a predetermined protocol.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS </heading>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> Hereinafter, embodiments of the present invention will be described. </paragraph>
<paragraph id="P-0053" lvl="7"><number>&lsqb;0053&rsqb;</number> &lsqb;Embodiment 1&rsqb;</paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a block diagram for explaining a data playback apparatus according to a first embodiment of the present invention. </paragraph>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> A data playback apparatus (hereinafter, also referred to as a receiving terminal) <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>according to the first embodiment receives content data including image data and audio data which are transmitted from a server S via a network such as Internet to be played, as well as issues a request including information that indicates a range of contents data to be played back, as a PLAY request to an alternate server when a REDIRECT request that requests to switch a server as a supply source of the content data from a first server (specific server) to a second server (alternate server) is issued from a server. </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> More specifically, the data playback apparatus (receiving terminal) <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>according to the first embodiment includes, like the prior art receiving terminal <highlight><bold>200</bold></highlight>, an RTSP exchange unit <highlight><bold>101</bold></highlight> for exchanging RTSP messages M with various servers S on the network; an RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>a </italic></highlight>for receiving content data (RTP packet data) Dp which are transmitted being contained in RTP packets from the server S, on the basis of control signal Ct that is outputted from the RTSP exchange unit <highlight><bold>101</bold></highlight>; and a time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a </italic></highlight>for storing time information that is obtained by the RTSP exchange unit <highlight><bold>101</bold></highlight> and the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>a </italic></highlight>as well as generating not-yet-played range information Ir indicating a range of not-yet-played portion in the content data on the basis of the obtained time information. </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> Here, the RTSP exchange unit <highlight><bold>101</bold></highlight> establishes a session (a state in which data transmitted from the server can be received) between a predetermined server and the receiving terminal by exchanging the RTSP message M, and outputs time information Tsi indicating a time stamp initial value Vinfo corresponding to the established session to the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a</italic></highlight>. In addition, the RTSP exchange unit <highlight><bold>101</bold></highlight> issues a PLAY request including playback range information that is read from the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a </italic></highlight>to the specific server Sa, and issues a PLAY request including the not-yet-played range information Ir that is read from the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a </italic></highlight>to the alternate server Sb. Here, the playback range information is information concerning the playback time of the content data. The time information Tsi indicating the time stamp initial value Vinfo is information that is included in an RTP Info field included in a response to the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>with respect to the PLAY request and, more specifically, information indicating a time stamp value that is added to a packet which is to be received first after a session is established. </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> The RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>a </italic></highlight>receives the RTP packet data Dp from the server and outputs audio/video data (AV data) Dr corresponding to each frame, as well as outputs time stamp information Tsp that is added to each RTP packet to the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a. </italic></highlight></paragraph>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> The time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a </italic></highlight>has a memory (not shown) that stores the time stamp initial value Vinfo which is designated by the time information Tsi included in the RTP info field and a time stamp value added to each RTP packet, and generates the not-yet-played range information Ir from the time stamp values stored in the memory. </paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> The receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>has, as the conventional receiving terminal <highlight><bold>200</bold></highlight>, a decoding unit <highlight><bold>103</bold></highlight> for decoding AV data Dr from the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>a </italic></highlight>to output decoded AV data Dd, and a display unit <highlight><bold>104</bold></highlight><highlight><italic>a </italic></highlight>for performing image display and sound playback on the basis of the decoded AV data Dd. </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a diagram showing data storage areas in the memory of the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a. </italic></highlight></paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> The memory in the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a </italic></highlight>has a first storage area A that stores the latest time stamp value Vp, a second storage area B that stores a time stamp initial value Vp<highlight><bold>1</bold></highlight> of an RTP packet, a third storage area C that stores a time stamp initial value Vinfo which is designated by information of the RTP Info field, and a fourth storage area D that stores information other than the time stamp. </paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> More specifically, the first storage are A is an area for storing a time stamp value of a received RTP packet as the latest time stamp value Vp, every time the RTP packet is received by the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>a</italic></highlight>. The second storage area B is an area for storing a time stamp value of an RTP packet that is received first after a session is established between the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>and the server S, as the time stamp initial value Vp<highlight><bold>1</bold></highlight> of the RTp packet. Further, the fourth storage area D is an area for storing SDP (Session Description Protocol) information Isdp included in a response from the server with respect to the REDIRECT request from the receiving terminal, and the like. As shown in <cross-reference target="DRAWINGS">FIG. 5</cross-reference>(<highlight><italic>b</italic></highlight>), the SDP information Isdp includes information Ise concerning the entire session, information Ivi concerning a video stream, information Iau associated with an audio stream, and the like. The information Ivi and Iau include scale information (MP4-VES/90000) Isv and scale information (AMR/8000) Isa associated with a ratio between a time stamp value and a unit of time (one second), respectively. Further, the information Ise concerning the entire session includes playback time information (t&equals;0.0000-60.000) Irt indicating the playback time of the whole content data in this session. In this case, it is shown that the content data are played back in a range from zero second to 60 seconds. </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> To be more specific, the scale information (MP4V-ES/90000) Isv shows that the time stamp value (90000) of the video stream corresponds one second. The scale information (AMP/8000) Isa shows that the time stamp value (8000) of the audio stream corresponds to one second. </paragraph>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> In the packet transmission according to RTP/UDP (User Datagram Protocol), packets do not arrive at the receiving terminal according to the order in which the packets are transmitted and the transmission orders vary with packet transmission lines. Therefore, when the order in which the RTP packets arrive is changed from the order in which the packets are transmitted, the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>a </italic></highlight>changes the arrival order of the received RTP packets on the basis of sequence numbers added to the RTP packets so as to coincide with the transmission order. </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> The operation processing carried out in the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a </italic></highlight>comprises a time stamp subtraction process that uses the time stamp values stored in the respective storage areas A to C, a time stamp conversion process that converts a result of the subtraction process into time information (already-played range information) indicating a range corresponding to an already-played portion of the content data based on one second, and a not-yet-played portion calculation process that obtains not-yet-played range information Ir indicating a time range corresponding to a not-yet-played portion of the content data from the already-played range information. </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> To be more specific, in the time stamp subtraction process, a difference in the time stamp &Dgr;vinfo (&equals;Vp-Vinfo) is obtained by subtracting the time stamp initial value Vinfo from the latest time stamp value Vp stored in the first storage area A when the time stamp initial value Vinfo is stored in the third storage area C, while a difference in the time stamp &Dgr;Vp1 (&equals;Vp-Vp1) is obtained by subtracting the time stamp initial value Vp1 stored in the second storage area B from the latest time stamp value Vp stored in the first storage area A when the time stamp initial value Vinfo is not stored in the third storage area C. Further, in the time stamp conversion process, the difference in the time stamp &Dgr;vinfo or &Dgr;Vp1 is converted into a time length (for example, 20 seconds) of the already-played portion based on one second, using the scale information Isa or Isv. Further, in the not-yet-played portion calculation process, not-yet-played range information Ir indicating a time range (t&equals;20.000-60.000) corresponding to a not-yet-played portion of the content data is obtained on the basis of the time range information corresponding to the already-played portion, which has been obtained in the time stamp conversion process. </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> Next, the operation will be described. </paragraph>
<paragraph id="P-0069" lvl="0"><number>&lsqb;0069&rsqb;</number> Hereinafter, a description will be given of a case where a server that supplies data of a file (v.mp4) as content data is switched from the first server (svr-A.com) Sa to the second server (svr-B.com) Sb. </paragraph>
<paragraph id="P-0070" lvl="0"><number>&lsqb;0070&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a diagram for explaining an operation of the data playback apparatus <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>according to the first embodiment. <cross-reference target="DRAWINGS">FIG. 5</cross-reference>(<highlight><italic>a</italic></highlight>) shows messages, such as a Setup request, which are outputted between a DESCRIBE request and a PLAY request, and omitted in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>. In <cross-reference target="DRAWINGS">FIG. 4</cross-reference>, for convenience of explanations, a specific server Sa having an RTSP exchange unit Sa<highlight><bold>1</bold></highlight> and an RTP transmission unit Sa<highlight><bold>2</bold></highlight>, and an alternate server Sb having an RTSP exchange unit Sb<highlight><bold>1</bold></highlight> and an RTP transmission unit Sb<highlight><bold>2</bold></highlight> are shown as the servers S, as in <cross-reference target="DRAWINGS">FIG. 12</cross-reference>. </paragraph>
<paragraph id="P-0071" lvl="0"><number>&lsqb;0071&rsqb;</number> When a DESCRIBE request (DESCRIBE rtsp://svr-A.com/v.mp4) T<highlight><bold>1</bold></highlight> that requests file data (v.mp4) in the server (svr-A.com) Sa is issued from the RTSP exchange unit <highlight><bold>101</bold></highlight> in the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>as an RTSP message M, the first server Sa receives the DESCRIBE request T<highlight><bold>1</bold></highlight> by the RTSP exchange unit Sa<highlight><bold>1</bold></highlight>, and a response All with respect to this request T<highlight><bold>1</bold></highlight> (see <cross-reference target="DRAWINGS">FIG. 5</cross-reference>(<highlight><italic>a</italic></highlight>)) is issued from the RTSP exchange unit Sa<highlight><bold>1</bold></highlight>. Thereafter, message exchange is carried out between the server Sa and the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a. </italic></highlight></paragraph>
<paragraph id="P-0072" lvl="0"><number>&lsqb;0072&rsqb;</number> The response All to the DESCRIBE request T<highlight><bold>1</bold></highlight> includes SDP information Isdp as shown in <cross-reference target="DRAWINGS">FIG. 5</cross-reference>(<highlight><italic>a</italic></highlight>). When the response A<highlight><bold>11</bold></highlight> is received by the RTSP exchange unit <highlight><bold>101</bold></highlight>, the RTSP exchange unit <highlight><bold>101</bold></highlight> analyzes the SDP information Isdp included in the response A<highlight><bold>11</bold></highlight>, and outputs playback time information of the content data, the scale information Isv of the time stamp concerning video data and the scale information Isa of the time stamp concerning audio data, and the like, in the SDP information Isdp, to the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a</italic></highlight>. The time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a </italic></highlight>stores these information in the fourth storage area D. </paragraph>
<paragraph id="P-0073" lvl="0"><number>&lsqb;0073&rsqb;</number> Thereafter, as shown in <cross-reference target="DRAWINGS">FIG. 5</cross-reference>(<highlight><italic>a</italic></highlight>), a Setup request T<highlight><bold>12</bold></highlight> for video data to the server Sa, a response A<highlight><bold>12</bold></highlight> with respect to the request T<highlight><bold>12</bold></highlight> to the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a</italic></highlight>, a Setup request T<highlight><bold>13</bold></highlight> for audio data to the server Sa, and a response A<highlight><bold>13</bold></highlight> with respect to the request T<highlight><bold>13</bold></highlight> to the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>are issued. </paragraph>
<paragraph id="P-0074" lvl="0"><number>&lsqb;0074&rsqb;</number> Then, a PLAY request (PLAY rtsp://svr-A.com/v.mp4) T<highlight><bold>2</bold></highlight>a which includes playback range information (Range: 0.000-60.000), requesting playback of file data (v.mp4) in the server (svr-A.com) Sa is issued from the RTSP exchange unit <highlight><bold>101</bold></highlight> as an RTSP message M. Here, the playback range information is information that is read from the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a. </italic></highlight></paragraph>
<paragraph id="P-0075" lvl="0"><number>&lsqb;0075&rsqb;</number> In the server Sa, the PLAY request T<highlight><bold>2</bold></highlight>a is received by the RTSP exchange unit Sa<highlight><bold>1</bold></highlight>, and a response A<highlight><bold>1</bold></highlight>a to the request T<highlight><bold>2</bold></highlight>a is issued from the RTSP exchange unit Sa<highlight><bold>1</bold></highlight>. The response Ala includes the playback range information (Range: 0.000-60.000), and time information Tsi indicating a time stamp value of an RTP packet which is received first in this session (time stamp initial value) is included in the RTP info field of the response A<highlight><bold>1</bold></highlight>a. The time information Tsi outputted from the RTSP exchange unit <highlight><bold>101</bold></highlight> is inputted to the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a</italic></highlight>, and the time stamp initial value Vinfo indicated by the time information Tsi is stored in the third storage area C. Here, as the content data including image information and audio information are transmitted from the server, a time stamp initial value Vinfo1 associated with images and a time stamp initial value Vinfo2 associated with sounds are designated in the RTP info field. However, the not-yet-played range information Ir can be generated with at least one of these time stamp initial values. Therefore, in the following descriptions, the time stamp initial values Vinfo1 and Vinfo2 associated with images and sounds are not distinguished from each other, and referred to only as the time stamp initial value Vinfo. </paragraph>
<paragraph id="P-0076" lvl="0"><number>&lsqb;0076&rsqb;</number> When a command (transmission command) A<highlight><bold>2</bold></highlight> that instructs to transmit data corresponding to the file (v.mp4) to the receiving terminal is issued to the RTP transmission unit Sa<highlight><bold>2</bold></highlight> from the RTSP conversion unit Sa<highlight><bold>1</bold></highlight> in the server Sa, the data corresponding to the file (v.mp4) are transmitted from the RTP transmission unit Sa<highlight><bold>2</bold></highlight> to the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a</italic></highlight>, being contained in RTP packets, as RTP packet data Da. </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> The RTP packet data Da are received by the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>a </italic></highlight>in the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>in accordance with the control signal Ct from the RTSP exchange unit <highlight><bold>101</bold></highlight>, and audio/video data (AV data) Dr corresponding to each frame are outputted. At this time, the information Tsp indicating a time stamp that is added to each RTP packet is outputted from the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>a </italic></highlight>to the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a</italic></highlight>, and stored in the first and second storage areas A and B. More specifically, a time stamp value Vp of an RTP packet that was received most recently in the established session is stored in the first storage area A, and a time stamp value (initial value) Vp<highlight><bold>1</bold></highlight> of an RTP packet that was received first in the established session is stored in the second storage area B. </paragraph>
<paragraph id="P-0078" lvl="0"><number>&lsqb;0078&rsqb;</number> The AV data Dr that are outputted from the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>a </italic></highlight>are decoded by the decoding unit <highlight><bold>103</bold></highlight>, and decoded AV data Dd are outputted to the display unit <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>. In the display unit <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>, image display and sound playback is performed on the basis of the decoded AV data Dd. </paragraph>
<paragraph id="P-0079" lvl="0"><number>&lsqb;0079&rsqb;</number> As described above, when a REDIRECT request A<highlight><bold>3</bold></highlight> is issued from the server Sa as an RTSP message in a state where data Da transmitted from the server Sa are received and played back in the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a</italic></highlight>, the REDIRECT request A<highlight><bold>3</bold></highlight> is received by the RTSP exchange unit <highlight><bold>101</bold></highlight> in the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a</italic></highlight>. The REDIRECT request A<highlight><bold>3</bold></highlight> is a request indicating to finish the session with the present server Sa, establish a session with the alternate server Sb, and receive data from the alternate server to be played. This REDIRECT request A<highlight><bold>3</bold></highlight> includes Location information (rtsp://svr-B.com/v.mp4) indicating a URL (Universal Resource Locator) of the alternate server. </paragraph>
<paragraph id="P-0080" lvl="0"><number>&lsqb;0080&rsqb;</number> At this time, when it is informed from the RTSP exchange unit <highlight><bold>101</bold></highlight> to the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a </italic></highlight>that the REDIRECT request A<highlight><bold>3</bold></highlight> has been received, an operation processing for generating playback range information that indicates a time range of content data which are requested to the alternate server Sb is carried out in the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a. </italic></highlight></paragraph>
<paragraph id="P-0081" lvl="0"><number>&lsqb;0081&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a flowchart showing the processing for generating the playback range information. </paragraph>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> In the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a</italic></highlight>, judgement as to whether the time stamp initial value Vinfo is stored or not in the third storage area C is made (step S1). When the time stamp initial value Vinfo is stored in the third storage area C, an operation processing is carried out for subtracting the time stamp initial value Vinfo stored in the third storage area C from the latest time stamp value Vp that is stored in the first storage area A (step S2). On the other hand, when the time stamp initial value Vinfo is not stored in the third storage area C, an operation process is carried out for subtracting a time stamp initial value Vpl that is stored in the second storage area B from the latest time stamp value Vp stored in the first storage area A (step S3). </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> Thereafter, a scaling process for converting a difference in the time stamp &Dgr;Vinfo (&equals;Vp-Vinfo) or &Dgr;Vp1 (&equals;Vp-Vp1) that is obtained by the subtraction process, into time information based on one second, using scale information of a time stamp stored in the fourth storage area D, is carried out to generate not-yet-played range information, i.e., information indicating a range of a not-yet-played portion in the content data as the data Da transmitted from the server Sa. </paragraph>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> Then, a response T<highlight><bold>3</bold></highlight> that acknowledges the REDIRECT request A<highlight><bold>3</bold></highlight> is issued from the RTSP exchange unit <highlight><bold>101</bold></highlight>, and further a TEARDOWN request T<highlight><bold>4</bold></highlight> that request termination of the session is issued to the server Sa. In the server Sa, a processing for finishing transmission of the RTP packet data Da is carried out, as well as a response A<highlight><bold>4</bold></highlight> that acknowledges the TEARDOWN request T<highlight><bold>4</bold></highlight> is issued. </paragraph>
<paragraph id="P-0085" lvl="0"><number>&lsqb;0085&rsqb;</number> In the RTSP exchange unit <highlight><bold>101</bold></highlight> in the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a</italic></highlight>, after the response A<highlight><bold>4</bold></highlight> to the TEARDOWN request T<highlight><bold>4</bold></highlight> from the server Sa is received, a DESCRIBED request (DESCRIBE rtsp://svr-B.com/v.mp4) T<highlight><bold>5</bold></highlight> that requests file data (v.mp4) in the server (svr-B.com) Sb is issued as an RTSP message M, on the basis of the Location information of the alternate server Sb included in the REDIRECT request A<highlight><bold>3</bold></highlight>. </paragraph>
<paragraph id="P-0086" lvl="0"><number>&lsqb;0086&rsqb;</number> This DESCRIBE request T<highlight><bold>5</bold></highlight> is received by the RTSP exchange unit Sb<highlight><bold>1</bold></highlight> in the server Sb, and a response (now shown) to the request T<highlight><bold>5</bold></highlight> is issued from the RTSP exchange unit Sb<highlight><bold>1</bold></highlight> to the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a</italic></highlight>. Thereafter, message exchange is further performed between the server Sb and the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a</italic></highlight>. </paragraph>
<paragraph id="P-0087" lvl="0"><number>&lsqb;0087&rsqb;</number> When a PLAY request (PLAY rtsp://svr-B.com/v.mp4) T<highlight><bold>6</bold></highlight>a including not-yet-played range information (Range: ntp&equals;360.0&minus;), which requests playback of file data (v.mp4) in the server (svr-B.com) Sb is issued from the RTSP exchange unit <highlight><bold>101</bold></highlight> in the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>as an RTSP message M, the PLAY request T<highlight><bold>6</bold></highlight>a is received by the RTSP exchange unit Sb<highlight><bold>1</bold></highlight> in the server Sb. After a response A<highlight><bold>5</bold></highlight> to the request T<highlight><bold>6</bold></highlight>a is issued to the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a</italic></highlight>, a transmission command A<highlight><bold>6</bold></highlight> that instructs to transmit the file data (v.mp4) to the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>is issued from the RTSP exchange unit Sb<highlight><bold>1</bold></highlight> to the RTP transmission unit Sb<highlight><bold>2</bold></highlight> in the server Sb. </paragraph>
<paragraph id="P-0088" lvl="0"><number>&lsqb;0088&rsqb;</number> Then, in the RTP transmission unit Sb<highlight><bold>2</bold></highlight>, a processing is carried out for transmitting a not-yet-played portion in the file data (v.mp4) designated by the not-yet-played range information, being contained in RTP packets as RTP packet data Db, to the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>in accordance with the control signal Cs from the RTSP exchange unit Sb<highlight><bold>1</bold></highlight>. </paragraph>
<paragraph id="P-0089" lvl="0"><number>&lsqb;0089&rsqb;</number> The transmitted data Db are received by the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>a </italic></highlight>in the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>in accordance with the control signal Ct from the RTSP exchange unit <highlight><bold>101</bold></highlight>, and audio/video data (AV data) Dr corresponding to each frame are outputted from the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>a</italic></highlight>. The AV data Dr are decoded by the decoding unit <highlight><bold>103</bold></highlight>, and decoded AV data Dd are outputted to the display unit <highlight><bold>104</bold></highlight>. In the display unit <highlight><bold>104</bold></highlight>, image display and sound playback is performed on the basis of the decoded AV data Dd. </paragraph>
<paragraph id="P-0090" lvl="0"><number>&lsqb;0090&rsqb;</number> As described above, according to the first embodiment, the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>that receives data requested to the server to be played back is provided with the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a </italic></highlight>for generating not-yet-played range information that indicates a range of a not-yet-played portion in the data, on the basis of time information associated with a playback process, which is added to the data in predetermined data units. Accordingly, when receiving a message requesting to change the server (REDIRECT request) as a data transmission source, the receiving terminal transmits a message requesting the data (DESCRIBE request) to a new transmission source server, with adding the not-yet-played range information to the message. Therefore, when the server as the data transmission source is changed while playback of the desired data from the server is performed in the receiving terminal <highlight><bold>1001</bold></highlight>, the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>can receive the data from the head of the not-yet-played portion thereof and playback the same. In other words, receiving and playing back again already-played portions in the content data after the server is changed can be avoided, whereby the communication fees can be reduced, and further the played images and sounds can be viewed and listened efficiently. </paragraph>
<paragraph id="P-0091" lvl="0"><number>&lsqb;0091&rsqb;</number> In this first embodiment, the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>issues a message (TEARDOWN request) T<highlight><bold>4</bold></highlight> requesting the termination of the session to the server Sa, immediately after a message (REDIRECT request) A<highlight><bold>3</bold></highlight> requesting to switch the server as a content data transmission source from the server Sa to another server Sb is received from the server Sa, i.e., following the response T<highlight><bold>3</bold></highlight> to the server Sa with respect to the REDIRECT request A<highlight><bold>3</bold></highlight>. However, the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>may issue the TEARDOWN request T<highlight><bold>4</bold></highlight> to the server Sa, not immediately after receiving the REDIRECT request A<highlight><bold>3</bold></highlight> but after confirming that the content data Db from the server Sb are received by the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a. </italic></highlight></paragraph>
<paragraph id="P-0092" lvl="0"><number>&lsqb;0092&rsqb;</number> In this case, the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>can distinguish the content data transmitted from the server Sa from the content data transmitted from the server Sb, on the basis of information which is included in various fields of packets containing the content data. </paragraph>
<paragraph id="P-0093" lvl="0"><number>&lsqb;0093&rsqb;</number> For example, RTP (Real Time Transport Protocol), TCP/IP (Transmission Control Protocol/Internet Protocol), UDP/IP (User Datagram Protocol/Internet Protocol) and the like are used as typical transmission protocols for transmitting data on the Internet. A header corresponding to each transmission protocol such as RTP, TCP, UDP, and IP, i.e., an RTP header, a TCP header, a UDP header, or an IP header is included in the packets. </paragraph>
<paragraph id="P-0094" lvl="0"><number>&lsqb;0094&rsqb;</number> Accordingly, the receiving terminal <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>can distinguish the content data transmitted from the server Sa from the content data transmitted from the server Sb, on the basis of information indicating a transmission destination port number included in the TCP header or the UDP header, information indicating an SSRC (Session Resource) or a PT (Payload Type) included in the RTP header, or information indicating an IP address of the transmission source in the IP header. Here, the SSRC is an identification number (ID) for identifying an RTP packet. </paragraph>
<paragraph id="P-0095" lvl="7"><number>&lsqb;0095&rsqb;</number> &lsqb;Embodiment 2&rsqb; </paragraph>
<paragraph id="P-0096" lvl="0"><number>&lsqb;0096&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a block diagram for explaining a data playback apparatus according to a second embodiment of the present invention. </paragraph>
<paragraph id="P-0097" lvl="0"><number>&lsqb;0097&rsqb;</number> A data playback apparatus (receiving terminal) <highlight><bold>100</bold></highlight><highlight><italic>b </italic></highlight>according to the second embodiment includes, in place of the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>a</italic></highlight>, the display unit <highlight><bold>104</bold></highlight><highlight><italic>a </italic></highlight>and the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a </italic></highlight>of the data playback apparatus <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>according to the first embodiment, an RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>b </italic></highlight>that carries out a data receiving process different from that of the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>a</italic></highlight>, a display unit <highlight><bold>104</bold></highlight><highlight><italic>b </italic></highlight>that carries out a data display process different from that of the display unit <highlight><bold>104</bold></highlight><highlight><italic>a</italic></highlight>, and a time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>b </italic></highlight>that carries out a time information storage process different from that of the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a. </italic></highlight></paragraph>
<paragraph id="P-0098" lvl="0"><number>&lsqb;0098&rsqb;</number> More specifically, the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>b </italic></highlight>is the same as the RTP receiving unit <highlight><bold>202</bold></highlight> in the prior art data playback apparatus <highlight><bold>200</bold></highlight>. The display unit <highlight><bold>104</bold></highlight><highlight><italic>b </italic></highlight>performs image display and sound playback on the basis of decoded AV data Dd, as well as outputs time stamp information Tsf that is added to each frame. The time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>b </italic></highlight>has first to fourth storage areas A to D, as in the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a</italic></highlight>. A time stamp value Vf that is added to the latest frame in an established session is stored in the first storage area A. A time stamp value Vf<highlight><bold>1</bold></highlight> added to a frame that is displayed first in the established session is stored in the second storage area B. A time stamp initial value Vinfo that is indicated by information Tsi of an RTP info field and information other than the time stamps are stored in the third and fourth storage areas C and D, respectively, as in the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a </italic></highlight>of the first embodiment. </paragraph>
<paragraph id="P-0099" lvl="0"><number>&lsqb;0099&rsqb;</number> Other construction of the data playback apparatus <highlight><bold>100</bold></highlight><highlight><italic>b </italic></highlight>according to the second embodiment is the same as that of the data playback apparatus <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>according to the first embodiment. </paragraph>
<paragraph id="P-0100" lvl="0"><number>&lsqb;0100&rsqb;</number> In the data playback apparatus (receiving terminal) <highlight><bold>100</bold></highlight><highlight><italic>b </italic></highlight>having such a construction according to the second embodiment, when a REDIRECT request that requests to switch a transmission source server for content data from a present server to another server is issued while the content data are being played back, not-yet-played range information indicating a range of a not-yet-played portion in the content data is generated on the basis of the time stamp initial value Vinfo of an RTP packet that is indicated by the RTP info field and the time stamp values Vf<highlight><bold>1</bold></highlight> and Vfn added to frames to be played, and a PLAY request including the not-yet-played range information is issued to the another server. Therefore, as in the first embodiment, after the server is changed in accordance with a server changing request while the content data are being played, the receipt and playback of the content data can be continuously performed starting from a playback position at a time when the server has been changed. </paragraph>
<paragraph id="P-0101" lvl="0"><number>&lsqb;0101&rsqb;</number> In the first and second embodiments, a time stamp that is added to a received RTP packet or a time stamp indicating a display time that is added to each frame is used as the initial value and the latest value of the time stamp corresponding to the established session. However, a time stamp indicating a decoding time corresponding to each frame may be used as the initial value and the latest value of the time stamp in the established session. </paragraph>
<paragraph id="P-0102" lvl="7"><number>&lsqb;0102&rsqb;</number> &lsqb;Embodiment 3&rsqb; </paragraph>
<paragraph id="P-0103" lvl="0"><number>&lsqb;0103&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a block diagram for explaining a data relay apparatus according to a third embodiment of the present invention. In this figure, the same reference numerals as those in <cross-reference target="DRAWINGS">FIG. 1</cross-reference> denote the same components of the data playback apparatus <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>according to the first embodiment. </paragraph>
<paragraph id="P-0104" lvl="0"><number>&lsqb;0104&rsqb;</number> A data relay apparatus <highlight><bold>100</bold></highlight><highlight><italic>c </italic></highlight>according to this third embodiment is a gateway apparatus that relays data which are supplied from a data transmission source to a data receiving terminal, and is connected to plural servers (A) Sa, (B) Sb, (X) Sx, and a receiving terminal <highlight><bold>200</bold></highlight> on a network such as the Internet. </paragraph>
<paragraph id="P-0105" lvl="0"><number>&lsqb;0105&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a block diagram illustrating a specific structure of the data relay apparatus according to the third embodiment. </paragraph>
<paragraph id="P-0106" lvl="0"><number>&lsqb;0106&rsqb;</number> This gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c </italic></highlight>includes a server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> that exchanges RTSP messages M with various servers S on a network; an RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> that receives content data (RTP packet data) Ds which are transmitted from the server S, being contained in RTP packets, in accordance with a control signal Cs that is outputted from the server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight>; and a time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>c </italic></highlight>that stores time information Tsi and Tsp outputted from the server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> and the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> as well as generates not-yet-played range information Ir that indicates a time range of a not-yet-played portion in the content data on the basis of the time information Tsi and Tsp. </paragraph>
<paragraph id="P-0107" lvl="0"><number>&lsqb;0107&rsqb;</number> The server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> exchanges the RTSP messages Ms with a server S to establish a session between the server S and the data relay apparatus <highlight><bold>100</bold></highlight><highlight><italic>c</italic></highlight>, outputs the time information Tsi indicating a time stamp initial value Vinfo corresponding to the established session, to the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>c</italic></highlight>, and transmits the not-yet-played information Ir that is read from the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>c </italic></highlight>to the server S, with being contained in a PLAY request. The time information Tsi indicating the time stamp initial value Vinfo is information that is designated by an RTP info field included in a response from the server S to the PLAY request from the receiving terminal <highlight><bold>200</bold></highlight>, as in the first embodiment. </paragraph>
<paragraph id="P-0108" lvl="0"><number>&lsqb;0108&rsqb;</number> The RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> receives the RTP packets Ds from the server S, and outputs audio/video data (AV data) Dr corresponding to each frame, contained in the RTP packets, as well as outputs the time information Tsp indicating a time stamp that is added to each RTP packet, to the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>c. </italic></highlight></paragraph>
<paragraph id="P-0109" lvl="0"><number>&lsqb;0109&rsqb;</number> The time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>c </italic></highlight>has a memory (not shown) for storing the time stamp initial value Vinfo that is indicated by the information Tsi of the RTP info field, and time stamp values Vp and Vp<highlight><bold>1</bold></highlight> which are added to each RTP packet, and generates the not-yet-played range information Ir indicating a time range of a not-yet-played portion in the content data on the basis of the time stamp values stored in the memory. This process for generating the not-yet-played range information Ir in the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>c </italic></highlight>is the same as that in the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a </italic></highlight>in the data playback apparatus <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>according to the first embodiment. </paragraph>
<paragraph id="P-0110" lvl="0"><number>&lsqb;0110&rsqb;</number> The gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c </italic></highlight>includes a buffer <highlight><bold>106</bold></highlight> for temporarily retaining the AV data Dr from the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight>, a terminal-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>2</bold></highlight> for establishing a session to communicate data with the receiving terminal <highlight><bold>200</bold></highlight> on the basis of message information Mp from the server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight>, and an RTP transmission unit <highlight><bold>102</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>2</bold></highlight> for transmitting data Dr stored in the buffer <highlight><bold>106</bold></highlight>, being contained in RTP packets, as RTP packet data Dt to the receiving terminal <highlight><bold>200</bold></highlight> in accordance with a control signal Ct from the terminal side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>2</bold></highlight>. </paragraph>
<paragraph id="P-0111" lvl="0"><number>&lsqb;0111&rsqb;</number> The RTP transmission unit <highlight><bold>102</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>2</bold></highlight> includes an attribute information rewriting unit (not shown) for rewriting attribute values, such as a time stamp value, a sequence number, an SSRC value, and a PT value, which are added to RTP packets transmitted from a server after server changing, to respective attribute values which are added to the RTP packets transmitted from a server before the server changing, so as to prevent the playback process for the content data in the receiving terminal from being interrupted, and transmits the RTP packets having rewritten information to the receiving terminal <highlight><bold>200</bold></highlight>. </paragraph>
<paragraph id="P-0112" lvl="0"><number>&lsqb;0112&rsqb;</number> Next, the operation of the relay apparatus will be described. </paragraph>
<paragraph id="P-0113" lvl="0"><number>&lsqb;0113&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a diagram showing an operation flow of the data relay apparatus according to the third embodiment. </paragraph>
<paragraph id="P-0114" lvl="0"><number>&lsqb;0114&rsqb;</number> Hereinafter, a description is given of a case where a server that supplies data of a file (v.mp4) as content data is switched from the first server (svr-A.com) Sa to the second server (svr-B.com) Sb. </paragraph>
<paragraph id="P-0115" lvl="0"><number>&lsqb;0115&rsqb;</number> When a DESCRIBE request (DESCRIBE rtsp://svr-A.com/v.mp4) T<highlight><bold>11</bold></highlight> that requests the file data (v.mp4) in the server (svr-A.com) Sa is issued from the receiving terminal <highlight><bold>200</bold></highlight> as an RTSP message Mt, the terminal-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>2</bold></highlight> in the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c </italic></highlight>receives the DESCRIBE request T<highlight><bold>11</bold></highlight>, and transmits message information Mp indicating the request T<highlight><bold>11</bold></highlight> to the server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight>. The server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> carries out a process for transmitting the DESCRIBE request T<highlight><bold>11</bold></highlight> indicated by the message information Mp as an RTSP message Ms to the server Sa. When the DESCRIBE request T<highlight><bold>11</bold></highlight> is received by the server Sa, a response (not shown) to this request T<highlight><bold>11</bold></highlight> is issued, and this response is transmitted to the receiving terminal <highlight><bold>200</bold></highlight> through the server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> and the terminal-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>2</bold></highlight> in the data relay apparatus <highlight><bold>100</bold></highlight><highlight><italic>c. </italic></highlight></paragraph>
<paragraph id="P-0116" lvl="0"><number>&lsqb;0116&rsqb;</number> Thereafter, message exchange is further performed between the server Sa and the receiving terminal <highlight><bold>200</bold></highlight> via the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c. </italic></highlight></paragraph>
<paragraph id="P-0117" lvl="0"><number>&lsqb;0117&rsqb;</number> When sessions for communication (states in which data can be communicated according to the RTP) between the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c </italic></highlight>and the receiving terminal <highlight><bold>200</bold></highlight> and between the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c </italic></highlight>and the server Sa are established, a PLAY request (PLAY rtsp://svr-A.com/v.mp4) T<highlight><bold>12</bold></highlight> including playback range information (Range: 0.000-60.000), which requests playback of the file data (v.mp4) in the server (svr-A.com) Sa, is issued from the receiving terminal <highlight><bold>200</bold></highlight> as an RTSP message Mt. The PLAY request T<highlight><bold>12</bold></highlight> is received by the terminal-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>2</bold></highlight> in the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c</italic></highlight>, and message information Mp indicating the request T<highlight><bold>12</bold></highlight> is transmitted to the server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight>. </paragraph>
<paragraph id="P-0118" lvl="0"><number>&lsqb;0118&rsqb;</number> When the PLAY request T<highlight><bold>12</bold></highlight> is transmitted as the RTSP message Ms from the server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> to the server Sa, this PLAY request T<highlight><bold>12</bold></highlight> is received by the server Sa, and a response (OK) A<highlight><bold>11</bold></highlight> to this request T<highlight><bold>12</bold></highlight> is issued. This response All includes playback range information (Range: 0.000-60.000). Further, RTP info field information corresponding to the response A<highlight><bold>11</bold></highlight> includes time information Tsi indicating a time stamp value of an RTP packet that is transmitted first in this session (time stamp initial value) Vinfo. The time information Tsi indicating the time stamp initial value Vinfo is inputted to the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>c</italic></highlight>, and the time stamp initial value Vinfo is stored in the third storage area C in the memory of the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>c. </italic></highlight></paragraph>
<paragraph id="P-0119" lvl="0"><number>&lsqb;0119&rsqb;</number> The message information Mp indicating the response All is transmitted from the server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> to the terminal-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>2</bold></highlight>. The response A<highlight><bold>11</bold></highlight> indicated by the message information Mp is transmitted from the terminal-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>2</bold></highlight> to the receiving terminal <highlight><bold>200</bold></highlight> as an RTSP message Mt. </paragraph>
<paragraph id="P-0120" lvl="0"><number>&lsqb;0120&rsqb;</number> Thereafter, the file data (v.mp4) including image information and sound information as the content data requested by the receiving terminal <highlight><bold>200</bold></highlight> are transmitted from the server Sa to the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c</italic></highlight>, being contained in RTSP packets, as the RTSP packet data Dsa. </paragraph>
<paragraph id="P-0121" lvl="0"><number>&lsqb;0121&rsqb;</number> The RTSP packet data Dsa are received by the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> in the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c </italic></highlight>in accordance with the control signal Cs from the server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight>, and audio/video data (AV data) Dr corresponding to each frame are outputted. At this time, the time information Tsp indicating the time stamp value that is added to each RTP packet is outputted from the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> to the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>c</italic></highlight>, and stored in the first and second storage areas A and B in the memory (see <cross-reference target="DRAWINGS">FIG. 2</cross-reference>). A time stamp value (initial value) Vp<highlight><bold>1</bold></highlight> of an RTP packet that was received first in this session is stored in the storage area B. A time stamp value Vp of the latest RTP packet that was received most recently in this session is stored in the first storage area A. </paragraph>
<paragraph id="P-0122" lvl="0"><number>&lsqb;0122&rsqb;</number> The AV data Dr outputted from the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> are stored successively in the buffer <highlight><bold>106</bold></highlight>. The AV data Dr stored in the buffer <highlight><bold>106</bold></highlight> are transmitted by the RTP transmission unit <highlight><bold>102</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>2</bold></highlight> to the receiving terminal <highlight><bold>200</bold></highlight>, being contained in RTP packets, as the RTP packet data Dta. </paragraph>
<paragraph id="P-0123" lvl="0"><number>&lsqb;0123&rsqb;</number> When a REDIRECT request A<highlight><bold>12</bold></highlight> is issued from the server Sa as an RTSP message Ms in a state where the content data are transmitted from the server Sa to the receiving terminal <highlight><bold>200</bold></highlight> via the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c </italic></highlight>and the content data received as the RTP packet data Dta are played back in the receiving terminal <highlight><bold>200</bold></highlight>, the REDIRECT request A<highlight><bold>12</bold></highlight> is received by the server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> in the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c</italic></highlight>. This REDIRECT request A<highlight><bold>12</bold></highlight> requests to finish the session with the present server (first server) Sa, establish a session with an alternate server (second server) Sb, and receive data supplied from the alternate server Sb to be played back. This REDIRECT request A<highlight><bold>12</bold></highlight> includes Location information (rtsp://svr-B.com/v.mp4) indicating an URL (Universal Resource Locator) of the alternate server (second server) Sb. </paragraph>
<paragraph id="P-0124" lvl="0"><number>&lsqb;0124&rsqb;</number> At this time, the server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> informs to the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>c </italic></highlight>that it has received the REDIRECT request A<highlight><bold>12</bold></highlight>. Then, the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>c </italic></highlight>carries out an operation processing for generating not-yet-played range information Ir indicating a time range of a not-yet-played portion in the content data which are requested to the second server Sb. The processing for generating the not-yet-played information Ir is the same as that in the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a </italic></highlight>according to the first embodiment. </paragraph>
<paragraph id="P-0125" lvl="0"><number>&lsqb;0125&rsqb;</number> A response (OK) T<highlight><bold>13</bold></highlight> that acknowledges the REDIRECT request A<highlight><bold>12</bold></highlight> is issued from the server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> in the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c </italic></highlight>to the server Sa. Further, a TEARDOWN request T<highlight><bold>14</bold></highlight> that requests termination of the session is issued to the server Sa. In the server Sa, a processing for finishing transmission of the RTP packet data Ds is carried out, as well as. a response (OK) A<highlight><bold>13</bold></highlight> that acknowledges the TEARDOWN request T<highlight><bold>14</bold></highlight> is issued. </paragraph>
<paragraph id="P-0126" lvl="0"><number>&lsqb;0126&rsqb;</number> In the server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> of the gateway apparatus <highlight><bold>100</bold></highlight>c, after the response A<highlight><bold>13</bold></highlight> to the TEARDOWN request T<highlight><bold>14</bold></highlight> is received from the server Sa, a DESCRIBE request (DESCRIBE rtsp://svr-B.com/v.mp4) T<highlight><bold>15</bold></highlight> that request the file data (v.mp4) in the server (svr-B.com) Sb is issued as the RTSP message Ms, on the basis of the Location information of the alternate server Sb included in the REDIRECT request A<highlight><bold>12</bold></highlight>. </paragraph>
<paragraph id="P-0127" lvl="0"><number>&lsqb;0127&rsqb;</number> This DESCRIBE request T<highlight><bold>15</bold></highlight> is received by the server Sb, and a response (not shown) to the request T<highlight><bold>15</bold></highlight> is issued to the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c</italic></highlight>. Thereafter, message exchange is further performed between the server Sb and the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c. </italic></highlight></paragraph>
<paragraph id="P-0128" lvl="0"><number>&lsqb;0128&rsqb;</number> When a PLAY request (PLAY rtsp://svr-B.com/v.mp4) T<highlight><bold>16</bold></highlight> including the not-yet-played range information Ir, which requests playback of the file data (v.mp4) in the server (svr-B.com) is issued as the RTSP message Ms from the server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> of the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c</italic></highlight>, this PLAY request T<highlight><bold>16</bold></highlight> is received by the server Sb and a response A<highlight><bold>14</bold></highlight> to the request T<highlight><bold>16</bold></highlight> is issued. </paragraph>
<paragraph id="P-0129" lvl="0"><number>&lsqb;0129&rsqb;</number> Thereafter, a portion of the file data (v.mp4), indicated by the not-yet-played range information Ir is transmitted being contained in RTP packets, as RTP packet data Dsb from the server Sb to the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c. </italic></highlight></paragraph>
<paragraph id="P-0130" lvl="0"><number>&lsqb;0130&rsqb;</number> The RTP packet data Dsb are received by the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> in the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c </italic></highlight>in accordance with the control signal Cs from the server-side RTSP exchange unit <highlight><bold>101</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight>, and audio/video data (AV data) Dr corresponding to each frame are outputted. The AV data Dr are temporarily retained in the buffer <highlight><bold>106</bold></highlight>. The AV data Dr retained in the buffer <highlight><bold>106</bold></highlight> are transmitted by the RTP transmission unit <highlight><bold>102</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>2</bold></highlight> to the receiving terminal <highlight><bold>200</bold></highlight>, as RTP packet data Dt being contained in RTP packets. </paragraph>
<paragraph id="P-0131" lvl="0"><number>&lsqb;0131&rsqb;</number> At this time, in the RTP transmission unit <highlight><bold>102</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>2</bold></highlight>, attribute values such as a time stamp value, a sequence number, an SSRC value, and a PT value, which are added to RTP packets transmitted from the alternate server Sb are rewritten to respective attribute values added to the RTP packets transmitted from the server Sa, so as to prevent the playback process for the content data in the receiving terminal <highlight><bold>200</bold></highlight> from being interrupted, and the RTP packets having the rewritten attribute values are transmitted to the receiving terminal <highlight><bold>200</bold></highlight>. </paragraph>
<paragraph id="P-0132" lvl="0"><number>&lsqb;0132&rsqb;</number> As described above, according to the third embodiment, the gateway apparatus <highlight><bold>100</bold></highlight><highlight><italic>c </italic></highlight>that carries out a relay processing of receiving content data from the server and transmitting the received content data to the receiving terminal retains time stamps added to RTP packets from the server, generates range information indicating a range of a not-yet-transmitted portion in the content data which are requested by the receiving terminal on the basis of the retained time stamp values when a REDIRECT request that requests to change the server transmitting the content data is issued, and requests the not-yet-transmitted portion in the content data which are requested by the receiving terminal to a new server. Therefore, when a transmission server is changed in accordance with the REDIRECT request during playback of the content data in the receiving terminal, the receiving terminal can receive the requested content data from the head of the not-yet-transmitted portion. </paragraph>
<paragraph id="P-0133" lvl="0"><number>&lsqb;0133&rsqb;</number> Further, in this third embodiment, the buffer <highlight><bold>106</bold></highlight> that temporarily retains the AV data Dr from the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>1</bold></highlight> is included. Therefore, the receiving terminal <highlight><bold>200</bold></highlight> is hard to be affected by jitter resulting from the network between the server and the data relay apparatus. </paragraph>
<paragraph id="P-0134" lvl="0"><number>&lsqb;0134&rsqb;</number> In this third embodiment, when the transmission server is changed, the RTP transmission unit <highlight><bold>102</bold></highlight><highlight><italic>c</italic></highlight><highlight><bold>2</bold></highlight> rewrites attribute values that are added to RTP packets transmitted from a new server Sb, to attribute values added to RTP packets transmitted from the previous server Sa so as to prevent the playback process for the content data in the receiving terminal <highlight><bold>200</bold></highlight> from being interrupted. Therefore, in the receiving terminal, even when the transmission server is changed while content data from the transmission server are being played back, the playback of the content data is performed without interruption, thereby avoiding disturbed display states of reproduced images or noises in played sounds. </paragraph>
<paragraph id="P-0135" lvl="0"><number>&lsqb;0135&rsqb;</number> In this third embodiment, the data relay apparatus (gateway apparatus) <highlight><bold>100</bold></highlight><highlight><italic>c </italic></highlight>issues a message (TEARDOWN request) T<highlight><bold>14</bold></highlight> requesting the termination of a session to the server Sa immediately after a message (REDIRECT request) A<highlight><bold>12</bold></highlight> requesting to switch a server as a content data transmission source from the first server Sa to the second server Sb is received from the first server Sa, i.e., following the response T<highlight><bold>13</bold></highlight> to the server Sa with respect to the REDIRECT request A<highlight><bold>12</bold></highlight>. However, the data relay apparatus <highlight><bold>100</bold></highlight><highlight><italic>c </italic></highlight>may issue the TEARDOWN request T<highlight><bold>14</bold></highlight> to the server Sa, not immediately after receiving the REDIRECT request A<highlight><bold>12</bold></highlight> but after confirming that the content data Dsb from the server Sb are received by the data relay apparatus <highlight><bold>100</bold></highlight><highlight><italic>c. </italic></highlight></paragraph>
<paragraph id="P-0136" lvl="0"><number>&lsqb;0136&rsqb;</number> In this case, as described in the first embodiment, the data relay apparatus <highlight><bold>100</bold></highlight><highlight><italic>c </italic></highlight>can distinguish the content data Dsa transmitted from the server Sa from the content data Dsb transmitted from the server Sb, on the basis of information indicating a transmission destination port number included in the TCP header or the UDP header, information indicating an SSRC (Session Resource) or a PT (Payload Type) included in the RTP header, or information indicating an IP address of the transmission source in the IP header. </paragraph>
<paragraph id="P-0137" lvl="0"><number>&lsqb;0137&rsqb;</number> In the first and second embodiments, receiving terminals that can be connected to servers via a network such as the Internet are shown as playback apparatus that receive data requested to the server and play back the same. However, as specific examples of the receiving terminal, there are PCs (personal computers) and portable phones and the like. </paragraph>
<paragraph id="P-0138" lvl="7"><number>&lsqb;0138&rsqb;</number> &lsqb;Embodiment 4&rsqb; </paragraph>
<paragraph id="P-0139" lvl="0"><number>&lsqb;0139&rsqb;</number> A portable phone that plays back data requested to a server while receiving the same as the data playback apparatus according to the first embodiment will be described as a fourth embodiment. </paragraph>
<paragraph id="P-0140" lvl="0"><number>&lsqb;0140&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a diagram for explaining a portable phone according to the fourth embodiment. </paragraph>
<paragraph id="P-0141" lvl="0"><number>&lsqb;0141&rsqb;</number> A portable phone <highlight><bold>300</bold></highlight> according to the fourth embodiment includes a signal processing unit <highlight><bold>302</bold></highlight> for carrying out various signal processings, and a radio communication unit <highlight><bold>303</bold></highlight> for outputting a radio signal N received via an antenna <highlight><bold>301</bold></highlight> as a received signal to the signal processing unit <highlight><bold>302</bold></highlight> as well as transmitting a transmission signal generated by the signal processing unit <highlight><bold>302</bold></highlight> as a radio signal N via the antenna <highlight><bold>301</bold></highlight>. </paragraph>
<paragraph id="P-0142" lvl="0"><number>&lsqb;0142&rsqb;</number> The portable phone <highlight><bold>300</bold></highlight> further has a liquid crystal display panel (LCD) <highlight><bold>306</bold></highlight> for displaying images, a microphone <highlight><bold>308</bold></highlight> for inputting voices, a speaker <highlight><bold>307</bold></highlight> for playing back an audio signal, a display control unit <highlight><bold>304</bold></highlight> for receiving an image signal processed by the signal processing unit <highlight><bold>302</bold></highlight> and controlling the liquid crystal display panel (LCD) <highlight><bold>306</bold></highlight> so that the image display is performed in accordance with the image signal, and an audio input/output unit <highlight><bold>305</bold></highlight> for outputting an audio signal inputted from the microphone <highlight><bold>308</bold></highlight> to the signal processing unit <highlight><bold>302</bold></highlight> as well as outputting an audio signal processed by the signal processing unit <highlight><bold>302</bold></highlight> to the speaker <highlight><bold>307</bold></highlight>. To simplify the explanations, a button manipulation part of the portable phone is not shown here. </paragraph>
<paragraph id="P-0143" lvl="0"><number>&lsqb;0143&rsqb;</number> The signal processing unit <highlight><bold>302</bold></highlight> performs the same playback process as that in the data playback apparatus <highlight><bold>100</bold></highlight><highlight><italic>a </italic></highlight>according to the first embodiment. More specifically, the signal processing unit <highlight><bold>302</bold></highlight> has signal processing units corresponding to the RTSP exchange unit <highlight><bold>101</bold></highlight>, the RTP receiving unit <highlight><bold>102</bold></highlight><highlight><italic>a</italic></highlight>, the decoding unit <highlight><bold>103</bold></highlight>, and the time information storage processing unit <highlight><bold>105</bold></highlight><highlight><italic>a </italic></highlight>on the receiving terminal end of the first embodiment. Further, the display control unit <highlight><bold>304</bold></highlight> and the liquid crystal display panel (LCD) <highlight><bold>306</bold></highlight> in the portable phone <highlight><bold>300</bold></highlight> according to the fourth embodiment correspond to the display unit <highlight><bold>104</bold></highlight><highlight><italic>a </italic></highlight>according to the first embodiment. </paragraph>
<paragraph id="P-0144" lvl="0"><number>&lsqb;0144&rsqb;</number> In the portable phone <highlight><bold>300</bold></highlight> having such a construction, when a message requesting to change a server as a data transmission source is received in a state where data requested to the server are being received and played back, a data requesting process is carried out to transmit a message requesting data to a new transmission server with adding the not-yet-played range information that indicates a range of a not-yet-played portion in the data to the message. </paragraph>
<paragraph id="P-0145" lvl="0"><number>&lsqb;0145&rsqb;</number> In this fourth embodiment, a portable phone that carries out the same data playback process as that in the data playback apparatus according to the first embodiment is shown. However, this portable phone may carry out the same data playback process as in the data playback apparatus <highlight><bold>100</bold></highlight><highlight><italic>b </italic></highlight>according to the second embodiment. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is claimed is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. A data playback apparatus which requests data including at least one of image information and audio information, and plays back the data transmitted in accordance with the request while receiving the data, comprising: 
<claim-text>a message transmission/receiving unit operable to transmit/receive messages to establish a state in which data can be received, and outputting a control signal that controls a receiving operation for the data; </claim-text>
<claim-text>a data receiving unit operable to receive the data in accordance with the control signal; and </claim-text>
<claim-text>a range information generation unit operable to generate not-yet-played range information that indicates a range of a not-yet-played portion in the data, on the basis of time information concerning a playback process, which is added to the data in predetermined data units, </claim-text>
<claim-text>said message transmission/receiving unit transmitting a message for requesting data corresponding to the not-yet-played portion indicated by the not-yet-played range information to a new server, when receiving a message requesting to change the server as a target of the data request. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The data playback apparatus of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein 
<claim-text>the time information is information which is added to the data for each frame as the data unit, and indicates a time when the frame is displayed. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The data playback apparatus of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein 
<claim-text>the data receiving unit receives the data which are contained in packets, and </claim-text>
<claim-text>the time information is added to each of the packets. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The data playback apparatus of <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference> wherein 
<claim-text>the range information generation unit generates the not-yet-played range information on the basis of latest time information added to a latest packet that was received by the data receiving unit, and either first initial time information added to a packet that was received first after the data receivable state is established, or second initial time information added to a packet that is to be received first after the data receivable state is established, which is obtained by the transmission/receipt of messages by the message transmission/receiving unit. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. A data playback method for requesting data including at least one of image information and audio information, and playing back the data transmitted in accordance with the request while receiving the same, comprising: 
<claim-text>a message transmission/receiving step of transmitting/receiving messages to establish a state in which data can be received, and generating a control signal that controls a receiving operation for the data; </claim-text>
<claim-text>a data receiving step of receiving the data in accordance with the control signal after the data receivable state is established; and </claim-text>
<claim-text>a range information generation step of generating not-yet-played range information that indicates a range of a not-yet-played portion in the data, on the basis of time information concerning a playback process, which is added to the data in predetermined data units, </claim-text>
<claim-text>said message transmission/receiving step transmitting a message for requesting data corresponding to the not-yet-played portion indicated by the not-yet-played range information to a new server, when a message for requesting to change the server as a target of the data request is received. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. A data relay apparatus that is connected to plural servers via a network, and requests data including at least one of image information and audio information to a specific server selected from the plural servers, to relay the data transmitted from the specific server in accordance with the request to transmit the same, including: 
<claim-text>a server-side message exchange unit operable to exchange messages with the specific server to establish a state where the data transmitted from the specific server can be received, and output a receipt control signal that controls a receiving operation for the transmitted data; </claim-text>
<claim-text>a data receiving unit operable to receive the data transmitted from the specific server in accordance with the receipt control signal; and </claim-text>
<claim-text>a range information generation unit operable to generate not-yet-played range information that indicates a range of a not-yet-played portion in the data, on the basis of time information concerning a playback process, which information is added to the data in predetermined data units, </claim-text>
<claim-text>said server-side message exchange unit transmitting a message for requesting the data to an alternate server with adding the not-yet-played range information to the message, when a message for requesting to switch a server as a supply source of the data from the specific server to the alternate server is received from the specific server. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. The data relay apparatus of <dependent-claim-reference depends_on="CLM-00006">claim 6</dependent-claim-reference> including: 
<claim-text>a buffer for temporarily retaining the received data; </claim-text>
<claim-text>a terminal-side message exchange unit operable to exchange messages with a transmission destination to establish a state where the data retained in the buffer can be transmitted, and outputting a transmission control signal that controls a transmission operation for the data; and </claim-text>
<claim-text>a data transmission unit operable to transmit the data retained in the buffer on the basis of the transmission control signal. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The data relay apparatus of <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference> wherein 
<claim-text>the data receiving unit receives the data which are contained in packets transmitted from the server as a transmission source of the data, and </claim-text>
<claim-text>the data transmission unit has an attribute information rewriting section for rewriting attribute information that is added to packets which contain data transmitted from the alternate server, into attribute information that is added to packets which contain the data transmitted from the specific server so that a data playback process in a transmission destination of the data is not interrupted, and transmits the packets which contain the data transmitted from the alternate server, with rewriting the attribute information thereof into the attribute information of the packets containing the data transmitted from the specific server. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. A data relay method for requesting data including at least one of image information and audio information, to a specific server selected from plural servers on a network, and relaying the data transmitted from the specific server in accordance with the request to transmit the same, comprising: 
<claim-text>a message exchange step of exchanging messages with the specific server to establish a state in which data transmitted from the specific server can be received, and generating a receipt control signal that controls a receiving operation for the transmitted data; </claim-text>
<claim-text>a data receiving step of receiving the data transmitted from the specific server in accordance with the receipt control signal after the transmitted data receivable state is established; and </claim-text>
<claim-text>a range information generation step of generating not-yet-played range information that indicates a range of a not-yet-played portion in the data on the basis of time information concerning a playback process, which is added to the data in predetermined data units, </claim-text>
<claim-text>said message exchange step transmitting a message for requesting the data to an alternate server with adding the not-yet-played range information to the message, when a message for requesting to switch a server as a supply source of the data from the specific server to the alternate server is issued from the specific server.</claim-text>
</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>1</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030002865A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030002865A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030002865A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030002865A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030002865A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030002865A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030002865A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030002865A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030002865A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00009">
<image id="EMI-D00009" file="US20030002865A1-20030102-D00009.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00010">
<image id="EMI-D00010" file="US20030002865A1-20030102-D00010.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00011">
<image id="EMI-D00011" file="US20030002865A1-20030102-D00011.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
