<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030005322A1-20030102-D00000.TIF SYSTEM "US20030005322A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030005322A1-20030102-D00001.TIF SYSTEM "US20030005322A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030005322A1-20030102-D00002.TIF SYSTEM "US20030005322A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030005322A1-20030102-D00003.TIF SYSTEM "US20030005322A1-20030102-D00003.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030005322</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10187211</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20020627</filing-date>
</domestic-filing-data>
<foreign-priority-data>
<priority-application-number>
<doc-number>20011401</doc-number>
</priority-application-number>
<filing-date>20010629</filing-date>
<country-code>FI</country-code>
</foreign-priority-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>G06F012/14</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>713</class>
<subclass>193000</subclass>
</uspc>
</classification-us-primary>
</classification-us>
<title-of-invention>Method for processing audiovisual information in an electronic device, a system, and an electronic device</title-of-invention>
</technical-information>
<inventors>
<first-named-inventor>
<name>
<given-name>Antti</given-name>
<family-name>Kiiveri</family-name>
</name>
<residence>
<residence-non-us>
<city>Oulu</city>
<country-code>FI</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
</inventors>
<assignee>
<organization-name>Nokia Corporation</organization-name>
<assignee-type>03</assignee-type>
</assignee>
<correspondence-address>
<name-1>WARE FRESSOLA VAN DER SLUYS &amp;</name-1>
<name-2>ADOLPHSON, LLP</name-2>
<address>
<address-1>BRADFORD GREEN BUILDING 5</address-1>
<address-2>755 MAIN STREET, P O BOX 224</address-2>
<city>MONROE</city>
<state>CT</state>
<postalcode>06468</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">The invention relates to a method for processing audiovisual information in an electronic device comprising at least one control block for controlling the operation of the electronic device, and a memory. The audiovisual information is encrypted. The control block is provided with a protected processing block, and part of the memory is available in said protected processing block only. The audiovisual information is decrypted in said protected processing block and transmitted from the protected processing block to means for presenting audiovisual information. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">FIELD OF THE INVENTION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> The present invention relates to a method for processing audiovisual information in an electronic device which comprises at least one control block for controlling the operation of an electronic device and a memory. The invention also relates to a system for processing audiovisual information in an electronic device comprising at least one control block for controlling the operation of the electronic device, a memory, and means for presenting audiovisual information. The invention further relates to an electronic device comprising at least one control block for controlling the operation of the electronic device, a memory, and means for presenting audiovisual information. </paragraph>
</section>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> At present, mobile communication devices can be used to communicate with various databases, payment systems or the like. In such connections, the secure and reliable processing of data is significant, because e.g. in payment applications, the user can, for example, order and pay for products. Thus, the system must be so reliable that what the user sees, for example, on the display of the mobile communication device, really corresponds to what takes place in the system. However, it is now already possible to download programs from various data sources into mobile communication devices, wherein the user cannot be fully certain of the reliability of such programs. In some cases, such a program may modify the information visible on the display to such a format which does not correspond to the information entered in the mobile communication device and/or the information transmitted from the mobile communication device. It is thus possible that the user believes to have paid the price visible on the display for the product ordered by him/her, but the program has modified the user&apos;s payment instructions in such a way that the price has been higher or that the price paid for the product to the supplier has been correct but, in addition to the price charged for the product, for example, an extra sum has been transferred from the user&apos;s account e.g. to the account of the program provider. Another possibility of misuse in the above-presented order event is that the user believes that he/she enters the correct delivery address but the program in the mobile communication device replaces the delivery address with another address. Thus, the user will not receive the product although having paid for it. When using the mobile communication device, other situations may also occur in which the information visible on the display may be different from the information actually processed in the mobile communication device. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> In mobile communication devices, portable sound reproduction devices, computers, etc., it is now possible to reproduce digital audio information. The copying of such audio information in digital format is relatively easy. In the copying, the sound quality remains substantially as good as the sound quality of the original recording. To make the copying more difficult, various copy protection methods have been developed, such as the recording of digital audio information in encrypted format. The reproduction of such a recording requires decryption. Thus, in connection with the purchase of the recording, the purchaser is given a decryption key which the user must enter in the sound reproducer before the recording can be listened to. Another possibility is that the decryption key is sent to the purchaser of the recording by mail, wherein the recording can be listened to. A problem with arrangements like this is, however, that it does not prevent the transmission of the decryption key with a copied recording. </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> It is known that information needed by the user or the device can be encrypted with one key, the encrypted information can be stored in the memory of the device, and it can be decrypted with another key. In asymmetric encryption, the key used in encryption is different from the key used in decryption. Correspondingly, in symmetric encryption, the key used in encryption is the same as the key used in decryption. In asymmetric encryption, these keys are normally called a public key and a personal key. The public key is intended for encryption and the personal key is intended for decryption. Although the public key may be commonly known, it can normally not be used to easily determine the personal key corresponding to the public key, wherein it is very difficult for an outsider to find out information encrypted with this public key. One example of a system based on the use of such a public key and a personal key is the PGP system (Pretty Good Privacy), in which the user encrypts the information to be transmitted with the public key of the receiver, and the receiver will then open the encrypted information with his/her own personal key. However, there are considerable drawbacks in the systems of prior art. The key strings required by sufficiently secure systems are so long that even their storage in a safe way may, depending on the storage technology used in each application, cause considerable costs. If the key string is too short, it will be relatively easy to break up with modern data processing equipment. This problem is particularly significant in portable data processing and communicating devices, in which the limited processing capacity also prevents the use of long keys. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> It is an aim of the present invention to provide a method for processing audiovisual information in such a way that the electronic device is equipped with a protected processing block in which the processing of audiovisual information is arranged. The blocks operating in the protected processing block are arranged in the same integrated circuit, wherein the information to be processed cannot be accessed from the outside of the blocks operating in the protected processing block. The aim of such an arrangement is to make the unauthorized processing of information and the copying of unencrypted information impossible in practice. The invention is based on the idea that in the protected processing block in the electronic device, the processing of the audio means and the display is only allowed for the processor operating in said block. More precisely, the method according to the present invention is primarily characterized in that the audiovisual information is encrypted, that the control block is provided with a protected processing block, that a part of the memory is only available in said protected processing block, that the audiovisual information is decrypted in said protected processing block, and the audiovisual information is transmitted from the protected processing block to means for presenting audiovisual information. The system according to the present invention is primarily characterized in that the system comprises means for encrypting audiovisual information; that the electronic device is provided with a protected processing block; that the protected processing block comprises means for using a part of the memory only in said protected mode; means for decrypting audiovisual information; and that the electronic device comprises means for transmitting audiovisual information from the protected processing block to the means for presenting audiovisual information. The electronic device according to the present invention is primarily characterized in that the electronic device comprises means for processing encrypted audiovisual information, that the electronic device is provided with a protected processing block; that the protected processing block comprises means for using a part of the memory only in said protected mode; means for decrypting audiovisual information; and that the electronic device comprises means for transmitting audiovisual information from the protected processing block to the means for presenting audiovisual information. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> The present invention shows remarkable advantages compared to solutions of prior art. The user can rely on the information visible on the display of the electronic device according to the invention, because the unauthorized modification of the visual information between the display and the processor which controls the display is difficult. In a corresponding manner, unencrypted audio information is only processed in the means belonging to the protected block, wherein the copying of the audio information in unencrypted format is not possible. Thus, no special arrangements will be required in the resale of recordings, because the decryption key is not transmitted to the purchaser of the recording. Furthermore, the replacement of a damaged recording with a new one is possible with the arrangement of the invention, because the recording will only function in a specific electronic device.</paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> In the following, the invention will be described in more detail with reference to the appended drawings, in which </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> shows an electronic device according to a preferred embodiment of the invention in a reduced block chart, </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> shows the structure of the control block according to a preferred embodiment of the invention in a reduced manner, and </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> shows the operation of the system according to a preferred embodiment of the invention in a reduced chart.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF THE INVENTION </heading>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> The invention can be applied in an electronic device <highlight><bold>1</bold></highlight>, in which it is possible to process audiovisual information. Such electronic devices <highlight><bold>1</bold></highlight> include, for example, a mobile communication device, a computer, such as a personal computer (PC) or a portable computer, as well as sound reproducers which are only intended for sound reproduction. The electronic device <highlight><bold>1</bold></highlight> according to an advantageous embodiment of the invention, shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, comprises at least a control block <highlight><bold>2</bold></highlight>, memory means <highlight><bold>3</bold></highlight>, and a user interface <highlight><bold>4</bold></highlight> which preferably comprises a display <highlight><bold>4</bold></highlight><highlight><italic>a </italic></highlight>and/or audio means <highlight><bold>4</bold></highlight><highlight><italic>b</italic></highlight>, <highlight><bold>4</bold></highlight><highlight><italic>c</italic></highlight>, <highlight><bold>4</bold></highlight><highlight><italic>d </italic></highlight>as well as a keyboard <highlight><bold>4</bold></highlight><highlight><italic>e</italic></highlight>. Furthermore, the electronic device of <cross-reference target="DRAWINGS">FIG. 1</cross-reference> comprises mobile communication means <highlight><bold>5</bold></highlight>. The memory means <highlight><bold>3</bold></highlight> preferably comprise a read-only memory ROM and a random access memory RAM. At least a part of the read-only memory ROM is an electrically erasable programmable read-only memory EEPROM, such as a FLASH memory. The read-only memory ROM is used, for example, for storing program commands of the processor, for specific fixed setting data, or the like. It is also possible to connect an external memory card <highlight><bold>6</bold></highlight>, such as a Flash memory card, to the electronic device. For this purpose, the electronic device is equipped with memory card connection means <highlight><bold>7</bold></highlight>. For connecting a smart card, such as a SIM card <highlight><bold>9</bold></highlight>, the electronic device <highlight><bold>1</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is also equipped with smart card connection means <highlight><bold>8</bold></highlight>. A part of the memory can also be arranged in the control block <highlight><bold>2</bold></highlight>. Furthermore, the control block <highlight><bold>2</bold></highlight> may comprise a digital signal processing unit <highlight><bold>2</bold></highlight><highlight><italic>b </italic></highlight>which is not necessarily the same as a digital signal processing unit <highlight><bold>213</bold></highlight> possibly belonging to the protected processing block <highlight><bold>2</bold></highlight><highlight><italic>a. </italic></highlight></paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> shows, in a reduced manner, the structure of the protected processing block <highlight><bold>2</bold></highlight><highlight><italic>a </italic></highlight>arranged in the control block <highlight><bold>2</bold></highlight> according to an advantageous embodiment of the invention. The protected processing block <highlight><bold>2</bold></highlight><highlight><italic>a </italic></highlight>comprises, for example, a processor <highlight><bold>201</bold></highlight> (central processing unit, CPU) and preferably also a digital signal processor (DSP) <highlight><bold>213</bold></highlight>. The processor <highlight><bold>201</bold></highlight> can be arranged either as a separate processor, wherein the electronic device <highlight><bold>1</bold></highlight> has a processor (not shown) for controlling the operation of the electronic device <highlight><bold>1</bold></highlight>, or the processor <highlight><bold>201</bold></highlight> may be implemented in such a way that the processor of the electronic device <highlight><bold>1</bold></highlight> is equipped with a protected mode for performing the operations according to the invention. The processor <highlight><bold>201</bold></highlight> is not limited to any particular processor but it may vary in different applications. The program code controlling the operation of the processor <highlight><bold>201</bold></highlight> can be partly stored in a read-only memory <highlight><bold>202</bold></highlight>, which may be a one time programmable read-only memory (OTPROM) and/or a programmable read-only memory (e.g. an electrically erasable programmable read-only memory, EEPROM). In the read-only memory <highlight><bold>202</bold></highlight> is also stored a device-specific key SK<highlight><bold>1</bold></highlight> to be used, in connection with the method according to the invention, for encryption functions and identification functions in a way described below in this description. The protected processing block <highlight><bold>21</bold></highlight> may also contain a random access memory <highlight><bold>203</bold></highlight>. The protected processing block <highlight><bold>2</bold></highlight><highlight><italic>a </italic></highlight>is also provided with a digital-to-analog converter <highlight><bold>214</bold></highlight>, in which an audio signal in digital format is converted to analog format. The digital-to-analog converter <highlight><bold>214</bold></highlight> is preferably implemented in the same circuit as the processor <highlight><bold>201</bold></highlight> or, if the protected mode is implemented in connection with the processor controlling the operation of the electronic device <highlight><bold>1</bold></highlight>, the digital-to-analog converter <highlight><bold>214</bold></highlight> is preferably implemented in the same circuit as this processor. Thus, audio information cannot be recorded in unencrypted format. For presenting visual information, the protected processing block <highlight><bold>2</bold></highlight> is provided with a display driver <highlight><bold>215</bold></highlight>, in which the information intended to be presented on the display <highlight><bold>4</bold></highlight><highlight><italic>a </italic></highlight>is converted to control signals of the display <highlight><bold>4</bold></highlight><highlight><italic>a</italic></highlight>. Furthermore, the protected processing block <highlight><bold>2</bold></highlight><highlight><italic>a </italic></highlight>contains a connection block <highlight><bold>204</bold></highlight>, by means of which the protected processing block <highlight><bold>2</bold></highlight><highlight><italic>a </italic></highlight>can be connected to other functional blocks of the electronic device <highlight><bold>1</bold></highlight>. In addition, by means of the connection block <highlight><bold>204</bold></highlight>, the control signals to be led to the display <highlight><bold>4</bold></highlight><highlight><italic>a </italic></highlight>can be coupled, either from the digital signal processor <highlight><bold>213</bold></highlight> of the protected processing block <highlight><bold>2</bold></highlight><highlight><italic>a</italic></highlight>, from the processor <highlight><bold>201</bold></highlight>, or from a block outside the protected processing block <highlight><bold>2</bold></highlight><highlight><italic>a</italic></highlight>, comprising means (not shown) for generating the signals required for controlling the display. In this advantageous embodiment of the invention, the protected processing block <highlight><bold>2</bold></highlight>a and the other functional blocks <highlight><bold>2</bold></highlight><highlight><italic>b</italic></highlight>-<highlight><bold>2</bold></highlight><highlight><italic>f </italic></highlight>of the control block <highlight><bold>2</bold></highlight> are presented as discrete blocks. However, it is obvious that at least part of said other functional blocks <highlight><bold>2</bold></highlight><highlight><italic>b</italic></highlight>-<highlight><bold>2</bold></highlight><highlight><italic>f </italic></highlight>of the control block can be arranged as a single integrated block in connection with the protected processing block <highlight><bold>2</bold></highlight><highlight><italic>a. </italic></highlight></paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> In the following, the operation of the method according to a preferred embodiment of the invention in the electronic device of <cross-reference target="DRAWINGS">FIG. 1</cross-reference> will be described with reference to the system shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>. It is assumed that the user starts, for example, a payment application, in which the user of the electronic device must be able to rely on the information to be presented on the display. Thus, the communication means, such as the mobile communication means <highlight><bold>5</bold></highlight>, are used to set up a data transmission connection to the payment server <highlight><bold>10</bold></highlight> of a bank, preferably by means of a mobile communication network <highlight><bold>11</bold></highlight>. The data transmission connection is preferably an encrypted connection in which preferably asymmetric encryption is employed. Upon setting up the connection, identification data is transmitted from the electronic device <highlight><bold>1</bold></highlight>, to identify the electronic device. This identification data can be, for example, a device identity. If necessary, this identification data to be transmitted can be verified, for example, with a digital signature. In the electronic device <highlight><bold>1</bold></highlight>, this is preferably performed by using the identification data and the device-specific key SK<highlight><bold>1</bold></highlight>. The payment server <highlight><bold>10</bold></highlight> checks the identification data by computing, on the basis of the public key corresponding to the identification data, reference data which should be identical to the digital signature transmitted in connection with the identification data. If the comparison shows that the electronic device <highlight><bold>1</bold></highlight> corresponds to the identification data, a connection can be set up. The information to be transmitted from the payment server <highlight><bold>10</bold></highlight> is encrypted with a public key PK<highlight><bold>1</bold></highlight> corresponding to the device-specific key of the electronic device, which the payment server <highlight><bold>10</bold></highlight> can retrieve, for example, from a database <highlight><bold>12</bold></highlight> containing a storage of public keys. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> In the electronic device <highlight><bold>1</bold></highlight>, the encrypted information is received and led to the protected processing block <highlight><bold>2</bold></highlight><highlight><italic>a</italic></highlight>. In the protected processing block <highlight><bold>2</bold></highlight><highlight><italic>a</italic></highlight>, the processor <highlight><bold>201</bold></highlight> decrypts the data by using the device-specific key SK<highlight><bold>1</bold></highlight>. If necessary, the information is stored in unencrypted format in the random access memory <highlight><bold>203</bold></highlight> of the protected processing block. Preferably, this random access memory <highlight><bold>203</bold></highlight> is also provided with a display buffer <highlight><bold>209</bold></highlight>, in which the information to be presented on the display <highlight><bold>4</bold></highlight><highlight><italic>a </italic></highlight>can be stored. The processor <highlight><bold>201</bold></highlight> transmits the content of the display buffer to the display driver <highlight><bold>215</bold></highlight> which forms, on the basis of this, control signals for changing the colour and/or brightness of pixels on the display <highlight><bold>4</bold></highlight><highlight><italic>a</italic></highlight>, if necessary. It is also possible that the display driver <highlight><bold>215</bold></highlight> can read the content of the display buffer, wherein the processor <highlight><bold>201</bold></highlight> does not need to transmit information directly to the display driver <highlight><bold>215</bold></highlight>. In the electronic device according to an advantageous embodiment of the invention, encrypted information related to the display is processed in unencrypted format only within the protected processing block <highlight><bold>2</bold></highlight><highlight><italic>a</italic></highlight>; consequently, the programs running in the electronic device <highlight><bold>1</bold></highlight> cannot distort the information to be presented on the display. This improves the safe usage of the electronic device <highlight><bold>1</bold></highlight> compared with electronic devices <highlight><bold>1</bold></highlight> of prior art. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> The invention can also be applied in such a way that, for displaying encrypted visual information, the display <highlight><bold>4</bold></highlight><highlight><italic>a </italic></highlight>is provided with a window in which this information is displayed. Thus, the processing block <highlight><bold>201</bold></highlight> controls the display driver in such a way that when the information contained in the window is updated, information is retrieved from the memory means <highlight><bold>203</bold></highlight> of the protected processing block <highlight><bold>2</bold></highlight><highlight><italic>a</italic></highlight>. By means of the connecting block <highlight><bold>204</bold></highlight>, the processing block prevents that possible other functional blocks, located outside the protected processing block and controlling the display, cannot process the display driver <highlight><bold>215</bold></highlight> and/or the display <highlight><bold>4</bold></highlight><highlight><italic>a. </italic></highlight></paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> In the processing of audio information, it is possible to apply principles corresponding to those presented above, in connection with the displaying of visual information. For example, the user has stored music, which is in encrypted format, on a memory means, such as a Flash memory card. Thus, the music cannot be listened to without decryption. In the encryption of the audio information, a random symmetric key has been preferably used, encrypted with the public key PK<highlight><bold>1</bold></highlight> of the device. Thus, the decryption is only possible by means of the random key opened with the device-specific key SK<highlight><bold>1</bold></highlight> of the device. The processor <highlight><bold>201</bold></highlight> retrieves audio information from the Flash memory and decrypts it with the device-specific key SK<highlight><bold>1</bold></highlight> and, if necessary, stores information in an audio buffer <highlight><bold>216</bold></highlight>. After this, the decrypted audio information is transmitted to the digital-to-analog converter <highlight><bold>214</bold></highlight>, in which the information is converted to analog format. This information, converted to analog format, can be transmitted outside the protected processing block, preferably to be amplified in an audio amplifier <highlight><bold>4</bold></highlight><highlight><italic>b </italic></highlight>and to be led to a speaker/an earpiece <highlight><bold>4</bold></highlight><highlight><italic>c. </italic></highlight></paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> The invention can also be applied by using two or more processors (not shown) instead of one processor <highlight><bold>201</bold></highlight>. Thus, one processor <highlight><bold>201</bold></highlight> is primarily used in the protected processing block <highlight><bold>2</bold></highlight><highlight><italic>a</italic></highlight>, and the other processors are used in other functions. The other processors do not have access to the memory <highlight><bold>202</bold></highlight>, <highlight><bold>203</bold></highlight> used by the processor operating in the protected processing block, nor to the control of the display driver <highlight><bold>215</bold></highlight> and/or the digital-to-analog converter <highlight><bold>214</bold></highlight> at the stage when encrypted information is processed in unencrypted format. The necessary communication between the processor <highlight><bold>201</bold></highlight> of the protected mode and the other processors can, in this embodiment, be arranged, for example, by means of a two-gate memory (not shown) or by determining, in the random access memory <highlight><bold>2</bold></highlight><highlight><italic>f</italic></highlight>, <highlight><bold>3</bold></highlight><highlight><italic>c</italic></highlight>, a memory space which can be processed by the processor of the protected mode and by at least one normal mode processor. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> It is obvious that, for different uses, it is possible to store more than one device-specific key SK<highlight><bold>1</bold></highlight> in the read-only memory <highlight><bold>202</bold></highlight> of the processing block <highlight><bold>2</bold></highlight><highlight><italic>a</italic></highlight>. On the other hand, one device-specific key SK<highlight><bold>1</bold></highlight> stored in the read-only memory <highlight><bold>202</bold></highlight> of the processing block <highlight><bold>2</bold></highlight><highlight><italic>a </italic></highlight>can be used for encrypting several keys needed in the operation of the electronic device. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> For digital signatures, several systems have been used, such as the RSA, DSA (Digital Signatures Algorithm), and ECC (Elliptic Curve Cryptography). These systems use algorithms which compress the information to be signed, including SHA-1 (Secure Hash Algorithm) and MD<highlight><bold>5</bold></highlight> (Message Digest 5) to be mentioned in this context. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> At the stage of manufacture of the electronic device <highlight><bold>1</bold></highlight> according to the invention, and/or at the stage of updating the software, the required check-up data and programs are formed in the memory <highlight><bold>2</bold></highlight><highlight><italic>d</italic></highlight>, <highlight><bold>2</bold></highlight><highlight><italic>e</italic></highlight>, <highlight><bold>3</bold></highlight><highlight><italic>a</italic></highlight>, <highlight><bold>3</bold></highlight><highlight><italic>b </italic></highlight>preferably in the following way. The program codes required in the verifications are stored in the control block <highlight><bold>2</bold></highlight>, including a boot program, a program for computing the digital signature, and encryption and decryption algorithm/algorithms. The manufacturer stores the device-specific key SK<highlight><bold>1</bold></highlight> and possibly also the device identity DID in the read-only memory <highlight><bold>202</bold></highlight> of the processing block. At the stage of assembling the components (block <highlight><bold>302</bold></highlight>), also the control block <highlight><bold>2</bold></highlight> is installed in the circuit card of the electronic device <highlight><bold>1</bold></highlight> (not shown). The manufacturer stores the other possible application programs, for example, in the programmable memory <highlight><bold>3</bold></highlight><highlight><italic>b </italic></highlight>and/or in the one time programmable memory <highlight><bold>3</bold></highlight><highlight><italic>a</italic></highlight>. After this, the electronic device <highlight><bold>1</bold></highlight> can be delivered to a dealer or a service provider, such as a mobile telephone operator. Furthermore, the manufacturer preferably transmits the public key related to the device-specific key in a database, from which public keys can be retrieved for use in different situations, when necessary. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> The device-specific key SK<highlight><bold>1</bold></highlight> can also be stored at another time than at the stage of manufacture of the electronic device. The device-specific key can be, for example, another key for encrypting the pair of keys intended for protecting this music or other content by encryption. Thus, the pair of keys to be used for protecting the content can be supplied to the electronic device later. In this embodiment, either a pair of keys (X) or a shared secret is determined between the electronic device and the manufacturer. By using these, it is possible to deliver a pair of keys (Y) to the electronic device <highlight><bold>1</bold></highlight> later, to be used for protecting the content according to the invention. Thus, the pair of keys to be used for protecting the content does not need to be ready in the electronic device <highlight><bold>1</bold></highlight>. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> In an advantageous embodiment of the invention, the public key (Yj) of the pair of keys (Y) is used to encrypt a symmetric key (k) formed by the content provider. The content is thus encrypted with the key (k), and the key (k) is protected with the key (Yj). When both the encrypted content and the key (k) are dispatched to the electronic device <highlight><bold>1</bold></highlight>, the asymmetric algorithm is used with the device-specific key (Yh) of the electronic device to open the key (k) used in the encryption of the content. After this, the content can be opened with the encrypted key (k). Thus, an asymmetric algorithm is only used to open a small quantity of data, the rest being opened with a symmetric algorithm. Because a symmetric algorithm is even 1000 times faster than an asymmetric algorithm, a significant performance benefit can be achieved with this solution. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> The encryption of information to be transmitted in encrypted format to the electronic device <highlight><bold>1</bold></highlight> is preferably performed at the stage of transmission, or at the stage when the information is stored on a storage means, such as said Flash memory card. At the stage of encryption, said public key PK<highlight><bold>1</bold></highlight> must be determined. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> It is obvious that the present invention is not limited solely to the above-presented embodiments, but it can be modified within the scope of the appended claims. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. A method for processing audiovisual information in an electronic device which comprises at least one control block for controlling the operation of an electronic device and a memory, wherein the audiovisual information is encrypted, that the control block is provided with a protected processing block, that a part of the memory is only available in said protected processing block, that the audiovisual information is decrypted in said protected processing block, and the audiovisual information is transmitted from the protected processing block to means for presenting audiovisual information. </claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The method according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein in the electronic device, audiovisual information is processed in unencrypted format in said protected processing block only. </claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The method according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the electronic device is provided with at least a device-specific key, by which the encrypted audiovisual information is decrypted. </claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The method according to <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein a public key is provided to correspond to said device-specific key, for encrypting audiovisual information intended to be presented in the electronic device. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. The method according to <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein said device-specific key is stored in the electronic device at the stage of manufacture of the electronic device. </claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The method according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein at least the following steps are performed: forming at least a device-specific key and a corresponding public key; storing said device-specific key in the electronic device; forming a pair of keys comprising a first key to be used for encrypting audiovisual information and a second key to be used for decrypting audiovisual information encrypted with the first key; encrypting the second key of said pair of keys with said public key; transmitting the encrypted second key of the pair of keys to the electronic device, in which the second key is decrypted with said secret key, wherein the audiovisual information is decrypted in the electronic device with said decrypted second key of the pair of keys. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. The method according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein at least the following steps are performed: forming at least a device-specific key and a corresponding public key; storing said device-specific key in the electronic device; forming an encryption key to be used for encrypting and decrypting audiovisual information; encrypting said encryption key with said public key; transmitting the encrypted encryption key to the electronic device, in which the encryption key is decrypted with said device-specific key, wherein the audiovisual information is decrypted in the electronic device with said decrypted encryption key. </claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The method according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said protected processing block is provided with a digital-to-analog converter, by which the decrypted audio information is converted to an analog audio signal. </claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. The method according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein, outside said protected processing block, a digital-to-analog converter is provided, by which the decrypted audio information is arranged to be converted to an analog audio signal. </claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. The method according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said protected processing block is provided with means for controlling the display, by which the decrypted visual information is converted to control signals for the display. </claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. A system for processing audiovisual information in an electronic device comprising at least one control block for controlling the operation of the electronic device, a memory, and means for presenting audiovisual information, wherein the system comprises means for encrypting audiovisual information; that the electronic device is provided with a protected processing block; that the protected processing block comprises means for using a part of the memory only in said protected mode; means for decrypting audiovisual information; and that the electronic device comprises means for transmitting audiovisual information from the protected processing block to the means for presenting audiovisual information. </claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. The system according to <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference>, wherein the electronic device comprises means for arranging audiovisual information to be processed in unencrypted format in said protected processing block only. </claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. The system according to <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference>, wherein the electronic device is provided with at least a device-specific key, by which the encrypted audiovisual information is arranged to be decrypted. </claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. The system according to <dependent-claim-reference depends_on="CLM-00011">claim 13</dependent-claim-reference>, wherein the system comprises means for forming a public key corresponding to said device-specific key, whereby audiovisual information intended to be presented in the electronic device is arranged to be encrypted. </claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. The system according to <dependent-claim-reference depends_on="CLM-00011">claim 13</dependent-claim-reference>, wherein said device-specific key has been stored in the electronic device at the stage of manufacture of the electronic device. </claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. The system according to <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference> comprising at least: 
<claim-text>a device-specific key and a corresponding public key, and which device-specific key is stored in the electronic device; </claim-text>
<claim-text>a pair of keys comprising a first key to be used for encryption of audiovisual information and a second key to be used for decrypting audiovisual information encrypted with the first key, </claim-text>
<claim-text>means for encrypting the second key of said pair of keys with said public key, </claim-text>
<claim-text>means for transmitting the encrypted second key of the pair of keys to the electronic device which comprises means for decrypting the second key with said secret key, and means for decrypting audiovisual information with said decrypted second key of the pair of keys. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. The system according to <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference> comprising at least: 
<claim-text>a device-specific key and a corresponding public key, and which device-specific key is stored in the electronic device; </claim-text>
<claim-text>an encryption key to be used for the encryption of audiovisual information and for the decryption of encrypted audiovisual information, </claim-text>
<claim-text>means for encrypting said encryption key with said public key, </claim-text>
<claim-text>means for transmitting the encrypted encryption key to the electronic device which comprises means for decrypting the encryption key with said secret key, and means for decrypting audiovisual information with said decrypted encryption key. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. The system according to <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference>, wherein said protected processing block comprises a digital-to-analog converter, by which the decrypted audio information is converted to an analog audio signal. </claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. The system according to <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference>, wherein the electronic device comprises a digital-to-analog converter which is provided outside said protected processing block and by which the decrypted audio information is arranged to be converted to an analog audio signal. </claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. The system according to <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference>, wherein said protected processing block comprises means for controlling the display, by which the decrypted audio information is converted to control signals for the display. </claim-text>
</claim>
<claim id="CLM-00021">
<claim-text><highlight><bold>21</bold></highlight>. The system according to <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference> comprising means for making payment transactions, and means for encrypting visual information related to the payment transaction to be transmitted to the electronic device. </claim-text>
</claim>
<claim id="CLM-00022">
<claim-text><highlight><bold>22</bold></highlight>. An electronic device comprising at least one control block for controlling the operation of the electronic device, a memory, and means for presenting audiovisual information, wherein the electronic device comprises means for processing encrypted audiovisual information, that the electronic device is provided with a protected processing block; that the protected processing block comprises means for using a part of the memory only in said protected mode; means for decrypting audiovisual information; and that the electronic device comprises means for transmitting audiovisual information from the protected processing block to the means for presenting audiovisual information. </claim-text>
</claim>
<claim id="CLM-00023">
<claim-text><highlight><bold>23</bold></highlight>. The electronic device according to <dependent-claim-reference depends_on="CLM-00022">claim 22</dependent-claim-reference>, wherein the electronic device is provided with at least a device-specific key, by which the encrypted audiovisual information is arranged to be decrypted. </claim-text>
</claim>
<claim id="CLM-00024">
<claim-text><highlight><bold>24</bold></highlight>. The electronic device according to <dependent-claim-reference depends_on="CLM-00022">claim 22</dependent-claim-reference>, wherein the electronic device is provided with at least a device-specific key, by which the key used for decrypting the encrypted audiovisual information is arranged to be decrypted. </claim-text>
</claim>
<claim id="CLM-00025">
<claim-text><highlight><bold>25</bold></highlight>. An electronic device according to <dependent-claim-reference depends_on="CLM-00022">claim 22</dependent-claim-reference> comprising means for performing mobile station functions.</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>2</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030005322A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030005322A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030005322A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030005322A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
