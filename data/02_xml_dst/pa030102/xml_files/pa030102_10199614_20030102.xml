<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030005315A1-20030102-D00000.TIF SYSTEM "US20030005315A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030005315A1-20030102-D00001.TIF SYSTEM "US20030005315A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030005315A1-20030102-D00002.TIF SYSTEM "US20030005315A1-20030102-D00002.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030005315</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10199614</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20020719</filing-date>
</domestic-filing-data>
<foreign-priority-data>
<priority-application-number>
<doc-number>00 100 995.0</doc-number>
</priority-application-number>
<filing-date>20000119</filing-date>
<country-code>EP</country-code>
</foreign-priority-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>H04L009/32</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>713</class>
<subclass>189000</subclass>
</uspc>
</classification-us-primary>
</classification-us>
<title-of-invention>Integrated security circuit</title-of-invention>
</technical-information>
<continuity-data>
<continuations>
<continuation-of>
<parent-child>
<child>
<document-id>
<doc-number>10199614</doc-number>
<kind-code>A1</kind-code>
<document-date>20020719</document-date>
</document-id>
</child>
<parent>
<document-id>
<doc-number>PCT/EP00/13136</doc-number>
<document-date>20001222</document-date>
<country-code>US</country-code>
</document-id>
</parent>
<parent-status>UNKNOWN</parent-status>
</parent-child>
</continuation-of>
</continuations>
</continuity-data>
<inventors>
<first-named-inventor>
<name>
<given-name>Helmut</given-name>
<family-name>Horvat</family-name>
</name>
<residence>
<residence-non-us>
<city>Graz</city>
<country-code>AT</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Stefan</given-name>
<family-name>Wallstab</family-name>
</name>
<residence>
<residence-non-us>
<city>Munchen</city>
<country-code>DE</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<correspondence-address>
<name-1>LERNER AND GREENBERG, P.A.</name-1>
<name-2></name-2>
<address>
<address-1>Post Office Box 2480</address-1>
<city>Hollywood</city>
<state>FL</state>
<postalcode>33022-2480</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">An integrated security circuit, for example, a microcontroller for smart cards, includes a function unit executing a security function. A control device determines the number of executions of the security function per unit of time. The continued execution of the security function is blocked when a threshold value is exceeded. For such a purpose, an analog timekeeper incorporating a charge storage device is preferably provided that measures the elapsing time even with the supply potential disconnected. A usage counter is updated whenever the security function is called. The security circuit offers increased protection against statistical attacks. The complexity involved in the implementation is justifiably low. The security circuit is compatible with the existing system. </paragraph>
</subdoc-abstract>
<subdoc-description>
<cross-reference-to-related-applications>
<heading lvl="1">CROSS-REFERENCE TO RELATED APPLICATION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> This application is a continuation of copending International Application No. PCT/EP00/13136, filed Dec. 22, 2000, which designated the United States and was not published in English.</paragraph>
</cross-reference-to-related-applications>
<summary-of-invention>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> 1. Field of the Invention </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> The invention relates to an integrated security circuit having a function unit for executing a security function. </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> Integrated security circuits are used, for example, in smart cards. The circuit is integrated monolithically in a microcontroller, and computes, for example, the encoding and decoding of the data traffic between the microcontroller and a reader. The security-sensitive functions of the microcontroller on the smart card are exposed to unauthorized, fraudulent attacks aimed at decoding the data. A prior art method of attack involves repeatedly using security-sensitive functions of interest on the microcontroller with data sorted according to suitable criteria. Special statistical techniques and correlation measures are applied to the measurements so obtained to gain information that enables the data traffic to and from the smart card to be decoded. To determine a cryptographic key, it may be necessary to activate the smart card some 10,000 times, and to determine each time whether the microcontroller accepts the access as authorized or rejects it as unauthorized. Microcontrollers in the prior art permit any number of such attack attempts in practice. After several hours or days of attempts, the cryptographic key might then be reconstructed. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> Existing methods of warding off statistical attacks focus, for example, on corrupting the measurements by superimposing interference signals or shifting the wanted signal in time so that statistical analyses are made more difficult. An effective configuration slows down the processing speed in the useful application, but low complexity of signal corruption might not provide sufficient protection. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> Another option in the prior art involves updating the key used after a certain number of usages, for example, by adjusting the key by a one-way function such as a hash function or by the N-count technique. One disadvantage of these measures is that not only does the smart-card microcontroller need to be redesigned accordingly, but also the whole security system including all the smart cards already issued and the readers. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> It is accordingly an object of the invention to provide an integrated security circuit that overcomes the hereinafore-mentioned disadvantages of the heretofore-known devices of this general type and that has a high level of security against unauthorized attacks. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> With the foregoing and other objects in view, there is provided, in accordance with the invention, an integrated security circuit, including a function unit adapted to execute a security function, and a control device connected to the function unit and adapted to determine a number of executions of the security function per unit of time and, the control device enabling and blocking a continued execution of the security function dependent upon the determination, the control device having a counting device connected to the function unit and counting each execution of the security function after an initialization, a capacitor, in dependence on whose charge state an expiry signal can be generated indicating that a defined maximum time period has expired, and a switch connected to the counting device and to the capacitor, the switch recharging the capacitor and initializing the counting device when the expiry signal is present. The switch can be a switching means and the capacitor can be a charge storage device. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> In the security circuit according to the invention, the number of usages per unit of time is employed as the criterion for blocking the security function. By a suitable configuration of the parameters, the time required to determine a sufficient amount of measurement data can be made discouragingly long for an attacker. The additional measures cause a negligible increase in the computing load on the microcontroller. There is, thus, no increase in the necessary processing speed. Additional circuit measures are required, but the circuit complexity is low. The interface to the whole system does not change so that the security circuit according to the invention is compatible with the relevant existing circuits. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> The configuration of the control device determining the number of executions of the security function per unit of time includes two counting devices. One of the counters, the usage counter, is incremented (incremental counter), or alternatively decremented (decremental counter), whenever the safety function is called. A timing device measures the elapsing absolute time. When the circuit is initialized, the timing device is charged and the counting device set to a defined value. If the counting device reaches a threshold value without the timing device having run down, execution of the security function is blocked. The overall outcome is that the number of executions of the security function per unit of time is measured, and the execution of the security function is blocked if a defined number is exceeded. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> The timing device is advantageously configured to operate even with the supply voltage disconnected. When the timing device has run down, either with or without the supply voltage connected, an expiry signal is output so that the timing device and the usage counter can be recharged. The block on the security function is removed once the usage counter has been reset. Alternatively it is also possible that, when the threshold value is exceeded by the usage counter, the security circuit is permanently blocked, and, hence, made unusable. </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> Because the timing device continues to run even while the supply voltage is disconnected, it is not possible to get the time on the clock to expire more quickly by switching the supply voltage off and on rapidly, and, hence, to achieve a greater number of measurements in one attack. The timing device can have an analog or digital construction. An analog timing device uses a charge storage device, which is discharged after being charged up, the discharge process continuing even after the supply voltage is disconnected. A digital timing device can be implemented as an incremental or decremental counter in which an energy store, for example, a battery, maintains the power supply specifically for the counter. The remaining circuits of the microcontroller are not supplied with power. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> The analog configuration of the timing device includes a capacitor that is charged at initialization and subsequently only discharged through leakage-current losses. In the capacitor configuration it is advantageous to enclose one of the poles of the capacitor - except for the contact surface in dielectric. The dielectric may be silicon dioxide or silicon nitride. The pole is then sufficiently well insulated for almost no leakage currents to flow away from the plate surface itself. The capacitor is controlled by a switching transistor in MOS semiconductor technology. When the switching transistor is in the on state, the capacitor is charged; when the switching transistor is in the off state, the capacitor discharges only through leakage currents flowing away through that electrode region connected to the capacitor pole in question. By applying a drive to the substrate contact of the switching transistor, its behavior in the on and off state can be further improved. The voltage across the capacitor is interrogated through a comparator to determine the discharged state and to activate the expiry signal. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> The discharge curve for the capacitor is temperature dependent. The capacitor discharges more quickly at a higher temperature than at a lower temperature. The security function can only be executed at typical operating temperatures, however, to obtain appropriate measurements for a statistical attack. The time required for heating up and cooling down prevents sufficient numbers of measurements being generated in a reasonable time. A time basis that is based on the discharge of traps at nitrite layers through Fowler-Nordheim tunneling is not dependent on temperature and is suitable as an alternative storage medium to a capacitor. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> There are various implementation options for the usage counter. The usage counter can be implemented purely in software, where the count value is incremented or decremented respectively and analyzed only by the central processing unit (CPU) of the microcontroller. After each update, the count value is advantageously written back to the non-volatile memory (NVM) included anyway on the microcontroller chip so that it is retained even after a loss of voltage. Mixed configurations of hardware and software are also possible, in particular, where it is intended to monitor the usage of a coprocessor. The CPU reads the current value of the usage counter from the NVM, and writes it as a start value to a hardware counter. In addition, the hardware counter is loaded with the threshold value, the blocking signal being generated when the threshold value is reached. The final value can also be held in a ROM memory, however. If the threshold value is reached, the hardware counter stops and blocks the coprocessor. The threshold value can also be written to the NVM as a precaution to retain the information even if the supply voltage is disconnected. Once the coprocessor operation is finished, the actual counter status is written to the NVM. Alternatively, the hardware counter could also access the NVM directly. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> The usage counter can also be implemented as an analog circuit. The counter status is then represented by the amount of charge in a charge storage device, thus, achieving independence from an operating clock. If both the operations counter and the timekeeper are implemented as analog circuits, then the information representing the number of usages per unit of time is given by the ratio of the voltage conditions of the two charge storage devices. The charge storage devices for the timekeeper and usage counter are initially charged to different voltages. Each time the security function is called, a brief, incomplete charge equalization process is performed. When a certain voltage ratio is attained, for example, when both voltages are equal, then this determines that the maximum permissible number of usages of the security function per unit of time has been reached. A further call of the security function is then blocked. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> In accordance with another feature of the invention, there is provided means for defining a threshold value, the defining means connected to the function unit, and the function unit adapted to block an execution of the security function when the counting device exceeds the threshold value and, otherwise, enable the execution of the security function. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> In accordance with a further feature of the invention, there is provided a threshold value generator connected to the function unit and generating a threshold value, and the function unit adapted to block an execution of the security function when the counting device exceeds the threshold value and, otherwise, enable the execution of the security function. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> In accordance with an added feature of the invention, there are provided contacts for a supply voltage, the contacts connected to the function unit and the control device, the function unit being adapted to execute the security function when the supply voltage is present, and the capacitor being adapted to measure an elapsing time both when the supply voltage is present and when the supply voltage is subsequently not present. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> In accordance with an additional feature of the invention, the counting device is one of a digital incremental counter and a decremental counter respectively incremented and decremented whenever the security function is called, the counter is preset, at the initialization, to a value selected from the group consisting of zero and the threshold value, and the counter is adapted to generate a signal to one of enable and block continued execution of the security function when the value is exceeded. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> In accordance with yet another feature of the invention, the capacitor can only be discharged through a leakage-current loss. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> In accordance with yet a further feature of the invention, there is provided a MOS switching transistor having a gate electrode and a substrate contact, an additional MOS switching transistor, and contacts for a supply voltage, the contacts connected to the function unit and the control device. The MOS switching transistor and the capacitor form a series circuit connected between the contacts. The gate electrode is to be controlled by a signal specifying the initialization. The substrate contact is selectively connected to one of the contacts through the additional MOS switching transistor. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> In accordance with yet an added feature of the invention, there is provided a first contact for a reference signal, a comparator having an input side and an output side with a second contact, the input side connected to the one of the two poles enclosed by the dielectric and to the first contact, and the second contact supplies the expiry signal. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> In accordance with a concomitant feature of the invention, the security function is selected from one of the group consisting of an encoding of data and a decoding of data. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> Other features that are considered as characteristic for the invention are set forth in the appended claims. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> Although the invention is illustrated and described herein as embodied in an integrated security circuit, it is, nevertheless, not intended to be limited to the details shown because various modifications and structural changes may be made therein without departing from the spirit of the invention and within the scope and range of equivalents of the claims. </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> The construction and method of operation of the invention, however, together with additional objects and advantages thereof, will be best understood from the following description of specific embodiments when read in connection with the accompanying drawings.</paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a block circuit diagram of an integrated security circuit according to the invention; </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a block circuit diagram of a circuit according to the invention containing elements of a microcontroller relevant to the invention; and </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is an analog schematic circuit diagram of a timing device suitable for the security circuit according to the invention.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DESCRIPTION OF THE PREFERRED EMBODIMENTS </heading>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> Referring now to the figures of the drawings in detail and first, particularly to <cross-reference target="DRAWINGS">FIG. 1</cross-reference> thereof, there is shown a timing device or timekeeper <highlight><bold>3</bold></highlight>, a usage counter <highlight><bold>2</bold></highlight>, and a function device <highlight><bold>1</bold></highlight> that executes a security function. A control device <highlight><bold>4</bold></highlight> is employed for controlling the process. The circuit is contained in a microcontroller that is disposed on a smart card. The function unit <highlight><bold>1</bold></highlight> encodes and decodes the data traffic between smart card and reader. </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> To prevent statistical attacks for possible determination of the function characteristic or even the key of the device <highlight><bold>1</bold></highlight>, there is a provision to limit the number of usages of the function unit <highlight><bold>1</bold></highlight> per unit of time. To do so, the timekeeper <highlight><bold>3</bold></highlight> is charged by a control signal A from the control device <highlight><bold>4</bold></highlight> so that it can subsequently run down. An expiry signal B, which is returned from the timekeeper <highlight><bold>3</bold></highlight> to the control device <highlight><bold>4</bold></highlight>, indicates that the absolute time measured by the timekeeper <highlight><bold>3</bold></highlight> has elapsed. The timekeeper <highlight><bold>3</bold></highlight> can be configured as a digital counter or analog counting device. An example of an analog configuration is shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>. </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> The usage counter <highlight><bold>2</bold></highlight> is a digital counter, which is also initialized, i.e., set to a defined value, when the timekeeper <highlight><bold>3</bold></highlight> is charged. The usage counter <highlight><bold>2</bold></highlight> is incremented every time the function unit <highlight><bold>1</bold></highlight> is called by the signal D. If the counter <highlight><bold>2</bold></highlight> reaches a defined maximum value, the signal C is activated. If the maximum value of the counter <highlight><bold>2</bold></highlight> is reached without the timekeeper <highlight><bold>3</bold></highlight> having yet run down, the control device <highlight><bold>4</bold></highlight> concludes that a defined number of calls of the safety function in the unit <highlight><bold>1</bold></highlight> over a time period determined by the timekeeper <highlight><bold>3</bold></highlight> has been reached. The control unit <highlight><bold>4</bold></highlight> thereupon blocks every further call of the safety function in the function unit <highlight><bold>1</bold></highlight>. In the example described, the usage counter <highlight><bold>2</bold></highlight> is an incremental counter. Alternatively, it can also be configured as a decremental counter that is set to a start value at initialization and then decremented down to a final value, for example, the counter status zero. </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> The timekeeper <highlight><bold>3</bold></highlight> is configured such that it continues to run and measure the elapsing absolute time even with the supply voltage disconnected. The usage counter <highlight><bold>2</bold></highlight> also saves the instantaneous usage count value after the supply voltage is disconnected. Saving is accomplished by storing the instantaneous counter status of the counter <highlight><bold>2</bold></highlight> temporarily in a non-volatile memory that is present anyway on the microcontroller. Alternatively, a battery backup is possible. </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> The assessment of whether or not the timekeeper has run down can be made adjustable to achieve flexibility with regard to both the usage parameter and the time-period parameter. For some purposes, affording five usages every five minutes can be sufficient, while for other purposes it may make sense to perform the measurement over a longer time period, e.g., 60 usages per hour. It is then quite possible for these 60 usages to take place in the first five minutes of the hour. </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> The microcontroller <highlight><bold>10</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 2</cross-reference> contains a central processing unit CPU <highlight><bold>11</bold></highlight>, which controls the operating processes and performs calculations. Data can be permanently stored in a non-volatile memory NVM <highlight><bold>12</bold></highlight> even after disconnecting the supply voltage. CPU <highlight><bold>11</bold></highlight> and NVM <highlight><bold>12</bold></highlight> communicate through a chip-internal bus <highlight><bold>13</bold></highlight>. The timekeeper <highlight><bold>3</bold></highlight> is provided as a separate circuit block. The signals A, B controlling the timekeeper <highlight><bold>3</bold></highlight> are provided through the bus <highlight><bold>13</bold></highlight>. The usage counter <highlight><bold>2</bold></highlight> is disposed on the chip of the microcontroller <highlight><bold>10</bold></highlight> as an additional separate circuit block. It is supplied with the signals A and D through the bus <highlight><bold>13</bold></highlight>. The function unit <highlight><bold>1</bold></highlight> is implemented by the CPU <highlight><bold>11</bold></highlight> and suitable software control. When the counter <highlight><bold>2</bold></highlight> reaches the predefined final value, the status is signaled to the CPU <highlight><bold>11</bold></highlight> as control signal C. The usage counter <highlight><bold>2</bold></highlight> receives the start value and final value from the NVM <highlight><bold>12</bold></highlight>. After each update of the counter status of the counter <highlight><bold>2</bold></highlight>, this is written back to the NVM <highlight><bold>12</bold></highlight> so that it is still available even after reconnecting the supply voltage after the supply voltage is disconnected, if the timekeeper <highlight><bold>3</bold></highlight> has not yet run down. </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> The timekeeper <highlight><bold>3</bold></highlight> is advantageously configured as an analog counter. An exemplary embodiment is shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>. The timekeeper includes a charge storage device <highlight><bold>31</bold></highlight> whose charge state represents the elapsed time. The charge storage device <highlight><bold>31</bold></highlight> is a capacitor. A switching transistor <highlight><bold>32</bold></highlight> and the capacitor <highlight><bold>31</bold></highlight> form a series circuit connected between supply voltage contacts for the supply potentials VDD and VSS. The switching transistor <highlight><bold>32</bold></highlight> is implemented in MOS circuit technology as an N-channel transistor and is used for charging and discharging the capacitor <highlight><bold>31</bold></highlight>. To charge the timekeeper, i.e., to charge the capacitor <highlight><bold>31</bold></highlight>, the signal A at the gate contact of the switching transistor <highlight><bold>32</bold></highlight> is activated so that the N-channel MOS transistor <highlight><bold>32</bold></highlight> is in the on state. The capacitor <highlight><bold>31</bold></highlight> is charged from the supply potential VDD. A resistor <highlight><bold>33</bold></highlight> connected between the gate contact of the transistor <highlight><bold>32</bold></highlight> and the contact to ground VSS is used to ensure that the transistor <highlight><bold>32</bold></highlight> switches off when the signal A is deactivated. </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> To minimize leakage-current losses at the capacitor <highlight><bold>31</bold></highlight>, one of its poles, for instance, the pole connected to the transistor <highlight><bold>32</bold></highlight>, is enclosed completely in silicon oxide or nitride, except for the connecting lead between capacitor plate and transistor <highlight><bold>32</bold></highlight>. Silicon oxide and nitride also form the dielectric of the capacitor <highlight><bold>31</bold></highlight>. The configuration can be realized by combining a metal layer and the gate polysilicon into a pole. The first pole is connected to the transistor <highlight><bold>32</bold></highlight>. A metal2-layer, substrate and poly2-layer form the second pole connected to ground VSS. Metal1- and metal2-layers are two metallizations lying one on top of the other in this case. </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> When the switching transistor <highlight><bold>32</bold></highlight> is in the off state, the charge is stored in the capacitor <highlight><bold>31</bold></highlight> and is only released through leakage-current paths that are set up in the semiconductor substrate. The charge is retained in the capacitor <highlight><bold>31</bold></highlight> even after disconnecting the supply voltage VDD, VSS. Insulating the pole of the capacitor <highlight><bold>31</bold></highlight> connected to the switching transistor prevents leakage-current losses from the pole directly into the substrate. Thus, the capacitor <highlight><bold>31</bold></highlight> can only be discharged through the doping structure of the capacitor-side contact <highlight><bold>32</bold></highlight><highlight><italic>a </italic></highlight>of the switching transistor <highlight><bold>32</bold></highlight>. The N-channel MOS transistor <highlight><bold>32</bold></highlight> is fabricated in a P-type well. Low leakage currents are set up here, developing in the path between the doping region that forms the contact <highlight><bold>32</bold></highlight><highlight><italic>a </italic></highlight>of the transistor <highlight><bold>32</bold></highlight>, the well, and the substrate. The discharge path is of a sufficiently high resistance to enable a suitably long time period to be measured by the timekeeper. On the other hand, however, the discharge ends at a reasonable time. The discharge rate lies in the order of magnitude of 1 fA/&mgr;m<highlight><superscript>2 </superscript></highlight>at room temperature. The discharge rate can be scaled by suitable geometric adjustment of the doping structures. The doping region of the contact <highlight><bold>32</bold></highlight><highlight><italic>a </italic></highlight>is advantageously fabricated as a circular region starting from the substrate surface to achieve a minimum contact area with the P-type well. When the supply voltage VDD, VSS is present, the contact <highlight><bold>32</bold></highlight><highlight><italic>a </italic></highlight>acts as source contact of the transistor <highlight><bold>32</bold></highlight>; when the supply voltage is disconnected, the voltage conditions reverse so that the contact <highlight><bold>32</bold></highlight><highlight><italic>a </italic></highlight>acts as gate electrode. The voltage lying across the capacitor <highlight><bold>31</bold></highlight> is interrogated by a comparator <highlight><bold>36</bold></highlight>. The comparator <highlight><bold>36</bold></highlight> is enabled when the supply voltage VDD, VSS is present. It compares the voltage across the capacitor <highlight><bold>31</bold></highlight> with a reference voltage VREF and, if the capacitor voltage <highlight><bold>31</bold></highlight> has fallen below the reference voltage VREF, it generates the disable signal B, thereby indicating that the time period to be measured has expired. </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> The substrate contact <highlight><bold>32</bold></highlight><highlight><italic>b </italic></highlight>of the switching transistor <highlight><bold>32</bold></highlight> can be connected to ground VSS through a P-channel MOS transistor <highlight><bold>34</bold></highlight>. The P-channel MOS transistor <highlight><bold>34</bold></highlight> is controlled by a signal F so as to drive it into the on state after the switching transistor <highlight><bold>32</bold></highlight> is switched off so that the substrate contact <highlight><bold>32</bold></highlight><highlight><italic>b </italic></highlight>of the switching transistor <highlight><bold>32</bold></highlight> is taken to ground VSS. The configuration has the effect of further reducing any subthreshold currents flowing through the channel of the transistor <highlight><bold>32</bold></highlight>. When, conversely, the switching transistor <highlight><bold>32</bold></highlight> is switched to the on state to charge the capacitor <highlight><bold>31</bold></highlight>, the transistor <highlight><bold>34</bold></highlight> is switched off so that the substrate contact <highlight><bold>32</bold></highlight><highlight><italic>b </italic></highlight>of the switching transistor <highlight><bold>32</bold></highlight> is pulled through a capacitor <highlight><bold>35</bold></highlight> to the positive supply voltage VDD to drive the conducting channel of the switching transistor <highlight><bold>32</bold></highlight> further into the on state. </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> As an alternative to the switched substrate contact <highlight><bold>32</bold></highlight><highlight><italic>b </italic></highlight>of the switching transistor <highlight><bold>32</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 3, a</cross-reference> negative bias can be applied to the gate of the transistor <highlight><bold>32</bold></highlight> through a switched capacitor, i.e., the gate is set to a potential below ground VSS. This is done to turn the transistor <highlight><bold>32</bold></highlight> even further into the off region and so avoid sub-threshold currents through its channel. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">We claim: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. An integrated security circuit, comprising: 
<claim-text>a function unit adapted to execute a security function; and </claim-text>
<claim-text>a control device connected to said function unit and adapted to determine a number of executions of said security function per unit of time and, said control device enabling and blocking a continued execution of said security function dependent upon said determination, said control device having: 
<claim-text>a counting device connected to said function unit and counting each execution of said security function after an initialization; </claim-text>
<claim-text>a capacitor, in dependence on whose charge state an expiry signal can be generated indicating that a defined maximum time period has expired; and </claim-text>
<claim-text>a switch connected to said counting device and to said capacitor, said switch recharging said capacitor and initializing said counting device when said expiry signal is present. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The integrated security circuit according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, including: 
<claim-text>a means for defining a threshold value, said defining means connected to said function unit; and </claim-text>
<claim-text>said function unit adapted to block an execution of said security function when said counting device exceeds said threshold value and, otherwise, enable the execution of said security function. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The integrated security circuit according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, including: 
<claim-text>a threshold value generator connected to said function unit and generating a threshold value; and </claim-text>
<claim-text>said function unit adapted to block an execution of said security function when said counting device exceeds said threshold value and, otherwise, enable the execution of said security function. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The integrated security circuit according to <dependent-claim-reference depends_on="CLM-00002">claim 2</dependent-claim-reference>, including contacts for a supply voltage, said contacts connected to said function unit and said control device, said function unit being adapted to execute said security function when the supply voltage is present, and said capacitor being adapted to measure an elapsing time both when the supply voltage is present and when the supply voltage is subsequently not present. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. The integrated security circuit according to <dependent-claim-reference depends_on="CLM-00002">claim 2</dependent-claim-reference>, wherein: 
<claim-text>said counting device is one of a digital incremental counter and a decremental counter respectively incremented and decremented whenever said security function is called; </claim-text>
<claim-text>said counter is preset, at said initialization, to a value selected from the group consisting of zero and said threshold value; and </claim-text>
<claim-text>said counter is adapted to generate a signal to one of enable and block continued execution of said security function when said value is exceeded. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The integrated security circuit according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said capacitor can only be discharged through a leakage-current loss. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. The integrated security circuit according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said capacitor is only discharged through a leakage-current loss. </claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The integrated security circuit according to <dependent-claim-reference depends_on="CLM-00006">claim 6</dependent-claim-reference>, wherein: 
<claim-text>said capacitor has two poles and an interlying dielectric; and one of said two poles is enclosed by said dielectric. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. The integrated security circuit according to <dependent-claim-reference depends_on="CLM-00006">claim 6</dependent-claim-reference>, including 
<claim-text>a MOS switching transistor having a gate electrode and a substrate contact; </claim-text>
<claim-text>an additional MOS switching transistor; contacts for a supply voltage, said contacts connected to said function unit and said control device; </claim-text>
<claim-text>said MOS switching transistor and said capacitor forming a series circuit connected between said contacts; </claim-text>
<claim-text>said gate electrode is to be controlled by a signal specifying said initialization; and </claim-text>
<claim-text>said substrate contact is selectively connected to one of said contacts through said additional MOS switching transistor. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. The integrated security circuit according to <dependent-claim-reference depends_on="CLM-00008">claim 8</dependent-claim-reference>, including: 
<claim-text>a MOS switching transistor having a gate electrode and a substrate contact; </claim-text>
<claim-text>an additional MOS switching transistor; contacts for a supply voltage, said contacts connected to said function unit and said control device; </claim-text>
<claim-text>said MOS switching transistor and said capacitor forming a series circuit connected between said contacts; </claim-text>
<claim-text>said gate electrode is to be controlled by a signal specifying said initialization; and </claim-text>
<claim-text>said substrate contact is selectively connected to one of said contacts through said additional MOS switching transistor. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. The integrated security circuit according to <dependent-claim-reference depends_on="CLM-00008">claim 8</dependent-claim-reference>, including: 
<claim-text>a first contact for a reference signal; </claim-text>
<claim-text>a comparator having: 
<claim-text>an input side; and </claim-text>
<claim-text>an output side with a second contact; </claim-text>
<claim-text>said input side connected to said one of said two poles enclosed by said dielectric and to said first contact; and </claim-text>
<claim-text>said second contact supplies said expiry signal. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. The integrated security circuit according to <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said security function is selected from one of the group consisting of an encoding of data and a decoding of data. </claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. An integrated security circuit, comprising: 
<claim-text>a function unit adapted to execute a security function; and </claim-text>
<claim-text>a control device connected to said function unit and adapted to determine a number of executions of said security function per unit of time and, said control device enabling and blocking a continued execution of said security function dependent upon said determination, said control device having: 
<claim-text>a counting device connected to said function unit and counting each execution of said security function after an initialization; </claim-text>
<claim-text>a charge storage device, in dependence on whose charge state an expiry signal can be generated indicating that a defined maximum time period has expired; and </claim-text>
<claim-text>a switch connected to said counting device and to said charge storage device, said switch recharging said charge storage device and initializing said counting device when said expiry signal is present. </claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. An integrated security circuit, comprising: 
<claim-text>a function unit adapted to execute a security function; and </claim-text>
<claim-text>a control device connected to said function unit and adapted to determine a number of executions of said security function per unit of time and, said control device enabling and blocking a continued execution of said security function dependent upon said determination, said control device having: 
<claim-text>a counting device connected to said function unit and counting each execution of said security function after an initialization; </claim-text>
<claim-text>a capacitor, in dependence on whose charge state an expiry signal can be generated indicating that a defined maximum time period has expired; and </claim-text>
<claim-text>a switching means connected to said counting device and to said capacitor, said switching means recharging said capacitor and initializing said counting device when said expiry signal is present.</claim-text>
</claim-text>
</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>1</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030005315A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030005315A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030005315A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
