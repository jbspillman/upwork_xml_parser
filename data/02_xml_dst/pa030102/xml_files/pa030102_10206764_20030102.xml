<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030002680A1-20030102-D00000.TIF SYSTEM "US20030002680A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00001.TIF SYSTEM "US20030002680A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00002.TIF SYSTEM "US20030002680A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00003.TIF SYSTEM "US20030002680A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00004.TIF SYSTEM "US20030002680A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00005.TIF SYSTEM "US20030002680A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00006.TIF SYSTEM "US20030002680A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00007.TIF SYSTEM "US20030002680A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00008.TIF SYSTEM "US20030002680A1-20030102-D00008.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00009.TIF SYSTEM "US20030002680A1-20030102-D00009.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00010.TIF SYSTEM "US20030002680A1-20030102-D00010.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00011.TIF SYSTEM "US20030002680A1-20030102-D00011.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00012.TIF SYSTEM "US20030002680A1-20030102-D00012.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00013.TIF SYSTEM "US20030002680A1-20030102-D00013.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00014.TIF SYSTEM "US20030002680A1-20030102-D00014.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00015.TIF SYSTEM "US20030002680A1-20030102-D00015.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00016.TIF SYSTEM "US20030002680A1-20030102-D00016.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00017.TIF SYSTEM "US20030002680A1-20030102-D00017.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00018.TIF SYSTEM "US20030002680A1-20030102-D00018.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00019.TIF SYSTEM "US20030002680A1-20030102-D00019.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00020.TIF SYSTEM "US20030002680A1-20030102-D00020.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00021.TIF SYSTEM "US20030002680A1-20030102-D00021.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00022.TIF SYSTEM "US20030002680A1-20030102-D00022.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00023.TIF SYSTEM "US20030002680A1-20030102-D00023.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00024.TIF SYSTEM "US20030002680A1-20030102-D00024.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00025.TIF SYSTEM "US20030002680A1-20030102-D00025.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00026.TIF SYSTEM "US20030002680A1-20030102-D00026.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00027.TIF SYSTEM "US20030002680A1-20030102-D00027.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00028.TIF SYSTEM "US20030002680A1-20030102-D00028.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00029.TIF SYSTEM "US20030002680A1-20030102-D00029.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00030.TIF SYSTEM "US20030002680A1-20030102-D00030.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00031.TIF SYSTEM "US20030002680A1-20030102-D00031.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00032.TIF SYSTEM "US20030002680A1-20030102-D00032.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00033.TIF SYSTEM "US20030002680A1-20030102-D00033.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00034.TIF SYSTEM "US20030002680A1-20030102-D00034.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00035.TIF SYSTEM "US20030002680A1-20030102-D00035.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00036.TIF SYSTEM "US20030002680A1-20030102-D00036.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00037.TIF SYSTEM "US20030002680A1-20030102-D00037.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00038.TIF SYSTEM "US20030002680A1-20030102-D00038.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00039.TIF SYSTEM "US20030002680A1-20030102-D00039.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00040.TIF SYSTEM "US20030002680A1-20030102-D00040.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00041.TIF SYSTEM "US20030002680A1-20030102-D00041.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00042.TIF SYSTEM "US20030002680A1-20030102-D00042.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00043.TIF SYSTEM "US20030002680A1-20030102-D00043.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00044.TIF SYSTEM "US20030002680A1-20030102-D00044.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00045.TIF SYSTEM "US20030002680A1-20030102-D00045.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00046.TIF SYSTEM "US20030002680A1-20030102-D00046.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00047.TIF SYSTEM "US20030002680A1-20030102-D00047.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00048.TIF SYSTEM "US20030002680A1-20030102-D00048.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00049.TIF SYSTEM "US20030002680A1-20030102-D00049.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00050.TIF SYSTEM "US20030002680A1-20030102-D00050.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00051.TIF SYSTEM "US20030002680A1-20030102-D00051.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00052.TIF SYSTEM "US20030002680A1-20030102-D00052.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00053.TIF SYSTEM "US20030002680A1-20030102-D00053.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00054.TIF SYSTEM "US20030002680A1-20030102-D00054.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00055.TIF SYSTEM "US20030002680A1-20030102-D00055.TIF" NDATA TIF>
<!ENTITY US20030002680A1-20030102-D00056.TIF SYSTEM "US20030002680A1-20030102-D00056.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030002680</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10206764</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20020729</filing-date>
</domestic-filing-data>
<foreign-priority-data>
<priority-application-number>
<doc-number>09-366812</doc-number>
</priority-application-number>
<filing-date>19971226</filing-date>
<country-code>JP</country-code>
</foreign-priority-data>
<foreign-priority-data>
<priority-application-number>
<doc-number>10-228287</doc-number>
</priority-application-number>
<filing-date>19980812</filing-date>
<country-code>JP</country-code>
</foreign-priority-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>H04L009/00</ipc>
</classification-ipc-primary>
<classification-ipc-secondary>
<ipc>G06F017/60</ipc>
</classification-ipc-secondary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>380</class>
<subclass>278000</subclass>
</uspc>
</classification-us-primary>
<classification-us-secondary>
<uspc>
<class>380</class>
<subclass>231000</subclass>
</uspc>
</classification-us-secondary>
<classification-us-secondary>
<uspc>
<class>705</class>
<subclass>052000</subclass>
</uspc>
</classification-us-secondary>
</classification-us>
<title-of-invention>Broadcast reception device and contract management device using common master key in conditional access broadcast system</title-of-invention>
</technical-information>
<continuity-data>
<division-of>
<parent-child>
<child>
<document-id>
<doc-number>10206764</doc-number>
<kind-code>A1</kind-code>
<document-date>20020729</document-date>
</document-id>
</child>
<parent>
<document-id>
<doc-number>09219889</doc-number>
<document-date>19981224</document-date>
<country-code>US</country-code>
</document-id>
</parent>
<parent-status>GRANTED</parent-status>
<parent-patent>
<document-id>
<doc-number>6463155</doc-number>
<country-code>US</country-code>
</document-id>
</parent-patent>
</parent-child>
</division-of>
</continuity-data>
<inventors>
<first-named-inventor>
<name>
<given-name>Koichiro</given-name>
<family-name>Akiyama</family-name>
</name>
<residence>
<residence-non-us>
<city>Kanagawa</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Toru</given-name>
<family-name>Kambayashi</family-name>
</name>
<residence>
<residence-non-us>
<city>Kanagawa</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Shuichi</given-name>
<family-name>Tsujimoto</family-name>
</name>
<residence>
<residence-non-us>
<city>Kanagawa</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Naoki</given-name>
<family-name>Endoh</family-name>
</name>
<residence>
<residence-non-us>
<city>Kanagawa</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<assignee>
<organization-name>KABUSHIKI KAISHA TOSHIBA</organization-name>
<address>
<city>Tokyo</city>
<country>
<country-code>JP</country-code>
</country>
</address>
<assignee-type>03</assignee-type>
</assignee>
<correspondence-address>
<name-1>OBLON SPIVAK MCCLELLAND MAIER &amp; NEUSTADT PC</name-1>
<name-2>FOURTH FLOOR</name-2>
<address>
<address-1>1755 JEFFERSON DAVIS HIGHWAY</address-1>
<city>ARLINGTON</city>
<state>VA</state>
<postalcode>22202</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">A conditional access broadcast system for realizing conditional access while maintaining the safety level is disclosed. A contract management device at a broadcast station side delivers a reception contract information containing at least a contract information for controlling decryption of encrypted contents information delivered from a broadcast station by broadcast and a reception device ID in correspondence, which is encrypted using a master key which is commonly provided with respect to all the broadcast reception devices. At each broadcast reception device, whether or not to give a channel key for decrypting the encrypted contents information to the decryption unit is controlled according to the contract information for own broadcast reception device which is acquired from the encrypted reception contract information. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> 1. Field of the Invention </paragraph>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> The present invention relates to a contract management device for use in the charged broadcast servile in which broadcast delivered contents are to be decrypted according to contract terms (period, viewable or listenable channels), and a broadcast reception device in which contents decryption is controlled by the contract management device. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> 1. Description of the Background Art </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> There are increasing demands for the enhancement of services by the digital broadcasting as the digitalization progresses from the communication satellite (CS) to the cable TV and the terrestrial broadcasting, and it is expected that the digital broadcasting will play the leading role in the future broadcast services. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> The most significant feature of the digital broadcasting is that, due to the introduction of the data compression technique, the utilization efficiency of frequencies required in broadcasting programs can be improved and the number of broadcast channels can be increased considerably compared with the analog broadcasting. In addition, as it is possible to apply the highly sophisticated error correction technique, it is possible to provide uniform services in high quality. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> By the digitalization of the broadcasting, it becomes possible to provide multimedia services using a variety of information forms (video, audio, text, data, etc.), and many systems for providing such services have been appearing recently. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> In such a system, in the case of providing a charged broadcast service in which scrambled contents are to be descrambled or encrypted contents are to be decrypted according to the contract period, there is a need to be able to carry out the customer management in accordance with contract periods. Here, the customer management in accordance with contract periods implies an ability to make programs of contracted channels viewable or listenable only within the contract period for which the required fee has been paid, for example. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> In addition, there is a need to provide the key information, which is necessary in decrypting encrypted contents or descrambling scrambled contents at the reception device, only to the proper viewers or listeners (according to the contracted channels and the contract period) and without failure, from a viewpoint of preventing the improper viewing or listening. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> In this regard, conventionally, a unique master key is provided for each broadcast reception device separately, and only work keys of the contracted channels are sent to each viewer or listener with a reception contract by encrypting them using the corresponding master key. Here, the work key is a key uniquely defined for each channel, which can decrypt a channel key of that channel that is broadcasted in an encrypted form. The channel key is used in descrambling scrambled broadcast contents. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> In addition, this work key is to be set up for each contract period (usually one month), and sent from the broadcast station whenever the contract is renewed, so that there is a need to sent necessary and sufficient amount of work keys to respective contractors at each contract period. This scheme has an advantage in that the contract period can be faithfully obeyed by updating the work key. However, as long as this scheme is adopted, it is necessary to broadcast the work keys to all the contractors every month, which is becoming a severe requirement in view of the required amount of transmission because of the increasing number of contractors and channels for the CS broadcasting. In particular, this requirement is very hard to satisfy in the broadcasting service with respect to mobile reception devices which is expected to be associated with a poor reception state, a short reception time and a narrow bandwidth. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> It is therefore an object of the present invention to provide a conditional access broadcast system using a broadcast reception device and a contract management device which is capable of realizing conditional access while maintaining the safety level even when the broadcast bandwidth available to transmission of information related to the conditional access is narrow or when the number of contractors increased beyond the expectation. </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> According to one aspect of the present invention there is provided a broadcast reception device, comprising: a memory for storing a master key commonly provided with respect to a plurality of broadcast reception devices and one reception device ID uniquely assigned to said broadcast reception device; a reception unit for receiving encrypted contents information delivered from a broadcast station by broadcast; a decryption unit for decrypting encrypted reception contract information using the master key and the encrypted contents information using a channel key, the encrypted reception contract information being received from the broadcast station and containing at least a contract information for controlling decryption of the encrypted contents information and a reception device ID in correspondence; and a control unit for selectively acquiring one contract information corresponding to a reception device ID that coincides with said one reception device ID, from the encrypted reception contract information decrypted by the decryption unit, and controlling whether or not to give the channel key to the decryption unit according to said one contract information. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> According to another aspect of the present invention there is provided a contract management device, comprising: a management unit for managing contract information for controlling decryption of encrypted contents information delivered from a broadcast station by broadcast, with respect to a plurality of broadcast reception devices each of which decrypts the encrypted contents information according to the contract information; and a delivery unit for delivering to said plurality of broadcast reception devices a reception contract information containing at least the contract information and a reception device ID in correspondence, the reception device ID being uniquely assigned to each broadcast reception device, by encrypting the reception contract information using a master key which is commonly provided with respect to said plurality of broadcast reception devices. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> Other features and advantages of the present invention will become apparent from the following description taken in conjunction with the accompanying drawings.</paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a schematic block diagram showing a broadcast system using a contract management device and a broadcast reception device according to the first embodiment of the present invention. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a diagram showing an outline of procedures for subscription, contract change, contract update, cancellation, and charging of a broadcast service provided in the broadcast system of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a block diagram showing an exemplary configuration of a contract management device according to the first embodiment of the present invention. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a diagram showing an exemplary data format for a contracting user database in the contract management device of <cross-reference target="DRAWINGS">FIG. 3</cross-reference>. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is a diagram showing an exemplary data format for a seed database in the contract management device of <cross-reference target="DRAWINGS">FIG. 3</cross-reference>. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a diagram showing an exemplary data format for a channel key database in the contract management device of <cross-reference target="DRAWINGS">FIG. 3</cross-reference>. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a flow chart of a processing for registration into a contracting user database in the contract management device of <cross-reference target="DRAWINGS">FIG. 3</cross-reference>. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a flow chart of a processing in the contract management device of <cross-reference target="DRAWINGS">FIG. 3</cross-reference>. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9A</cross-reference> is a diagram conceptually showing an exemplary information to be multiplexed to broadcast waves for mainly delivering contents that can be used in the broadcast system of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9B</cross-reference> is a diagram showing an exemplary data format of an appending information that can be used in the broadcast system of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a block diagram showing an exemplary configuration of a contents information delivery device in the contract management device of <cross-reference target="DRAWINGS">FIG. 3</cross-reference>. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11A</cross-reference> is a diagram conceptually showing another exemplary information to be multiplexed to broadcast waves for mainly delivering contents that can be used in the broadcast system of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11B</cross-reference> is a diagram showing another exemplary data format of an appending information that can be used in the broadcast system of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a diagram showing an exemplary data format of a terminal related appending information that can be used in the broadcast system of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is a diagram showing an exemplary data format of a channel related appending information that can be used in the broadcast system of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 14</cross-reference> is a block diagram showing an exemplary configuration of a broadcast reception device according to the first embodiment of the present invention. </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 15</cross-reference> is a flow chart of a processing in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 14</cross-reference>. </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 16</cross-reference> is a flow chart of a master key generation processing in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 14</cross-reference>. </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 17</cross-reference> is a flow chart of a judgement processing in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 14</cross-reference>. </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 18</cross-reference> is a flow chart of a contents information decryption processing in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 14</cross-reference>. </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 19</cross-reference> is a graph showing changes in time of amounts of appending information to be transmitted in relation to new contracts and cancellations in the broadcast system of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 20</cross-reference> is a flow chart of a processing in a filter of the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 14</cross-reference> in the case of monitoring a reception state of appending information. </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 21</cross-reference> is a flow chart of a processing in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 14</cross-reference> in the case of using a terminal related appending information and a channel related appending information. </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 22</cross-reference> is a flow chart of a judgement processing in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 14</cross-reference> in the case of using a terminal related appending information and a channel related appending information. </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 23</cross-reference> is a flow chart of a contents information decryption processing in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 14</cross-reference> in the case of using a terminal related appending information and a channel related appending information. </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 24</cross-reference> is a schematic block diagram showing a broadcast system using a contract management device and a broadcast reception device according to the second embodiment of the present invention. </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 25</cross-reference> is a block diagram showing an exemplary configuration of a contract management device according to the second embodiment of the present invention. </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 26</cross-reference> is a block diagram showing an exemplary configuration of a broadcast reception device according to the second embodiment of the present invention. </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> <cross-reference target="DRAWINGS">FIGS. 27A and 27B</cross-reference> are diagrams showing exemplary forms of appending information to be recorded in a card shaped recording medium for two different cases in the broadcast system of <cross-reference target="DRAWINGS">FIG. 24</cross-reference>. </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 28</cross-reference> is a flow chart of a processing in a card reader of the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 26</cross-reference>. </paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 29</cross-reference> is a flow chart of a processing in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 26</cross-reference>. </paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 30</cross-reference> is a flow chart of a judgement processing in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 26</cross-reference>. </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 31</cross-reference> is a block diagram showing an exemplary configuration of a broadcast reception device according to the third embodiment of the present invention. </paragraph>
<paragraph id="P-0048" lvl="0"><number>&lsqb;0048&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 32</cross-reference> is a diagram showing four stage key structure used in encrypting broadcast contents in the third embodiment of the present invention. </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 33</cross-reference> is a diagram showing an exemplary information structure delivered by an ordinary channel in the third embodiment of the present invention. </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 34</cross-reference> is a diagram showing an exemplary structure of a broadcast contents information delivered by the ordinary channel of <cross-reference target="DRAWINGS">FIG. 33</cross-reference>. </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 35</cross-reference> is a diagram showing an exemplary structure of a channel key information delivered by the ordinary channel of <cross-reference target="DRAWINGS">FIG. 33</cross-reference>. </paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 36</cross-reference> is a diagram showing an exemplary information structure delivered by a contract information channel in the third embodiment of the present invention. </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 37</cross-reference> is a diagram showing an exemplary structure of a contract information packet delivered by the contract information channel of <cross-reference target="DRAWINGS">FIG. 36</cross-reference>. </paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 38</cross-reference> is a diagram showing an exemplary structure of a reception contract information contained in the contract information packet of <cross-reference target="DRAWINGS">FIG. 37</cross-reference>. </paragraph>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 39</cross-reference> is a diagram showing an exemplary structure of a master key seed information delivered by the contract information channel of <cross-reference target="DRAWINGS">FIG. 36</cross-reference>. </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 40</cross-reference> is a diagram showing time zones at which transmissions of two channel keys overlap at a timing of channel key switching in the third embodiment of the present invention. </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 41</cross-reference> is a diagram showing an exemplary format of channel keys and their identifiers in a channel key storage unit of the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 31</cross-reference>. </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 42</cross-reference> is a flow chart of a processing in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 31</cross-reference>. </paragraph>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 43</cross-reference> is a flow chart of a processing with respect to broadcast contents in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 31</cross-reference>. </paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 44</cross-reference> is a flow chart of a processing with respect to a channel key information in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 31</cross-reference>. </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 45</cross-reference> is a flow chart of a processing with respect to a contract information packet in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 31</cross-reference>. </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 46</cross-reference> is a diagram showing an exemplary authenticator for an encrypted key information that can be used in the third embodiment of the present invention. </paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 47</cross-reference> is a diagram showing an exemplary authenticator for a non-encrypted key information that can be used in the third embodiment of the present invention. </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 48</cross-reference> is a diagram showing another exemplary authenticator for a non-encrypted key information that can be used in the third embodiment of the present invention. </paragraph>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 49</cross-reference> is a diagram showing an exemplary form of a reception contract information that can be used in the third embodiment of the present invention. </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 50</cross-reference> is a diagram showing another exemplary form of a reception contract information that can be used in the third embodiment of the present invention. </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 51</cross-reference> is a block diagram showing an exemplary configuration of a broadcast reception device according to the fourth embodiment of the present invention. </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 52</cross-reference> is a diagram showing three stage key structure used in encrypting broadcast contents in the fourth embodiment of the present invention. </paragraph>
<paragraph id="P-0069" lvl="0"><number>&lsqb;0069&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 53</cross-reference> is a diagram showing an exemplary information structure delivered by an ordinary channel in the fourth embodiment of the present invention. </paragraph>
<paragraph id="P-0070" lvl="0"><number>&lsqb;0070&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 54</cross-reference> is a diagram showing an exemplary structure of a contract information packet delivered by a contract information channel in the fourth embodiment of the present invention. </paragraph>
<paragraph id="P-0071" lvl="0"><number>&lsqb;0071&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 55</cross-reference> is a diagram showing an exemplary structure of a reception contract information in the fourth embodiment of the present invention. </paragraph>
<paragraph id="P-0072" lvl="0"><number>&lsqb;0072&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 56</cross-reference> is a diagram showing another exemplary structure of a contract information packet delivered by a contract information channel in the fourth embodiment of the present invention. </paragraph>
<paragraph id="P-0073" lvl="0"><number>&lsqb;0073&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 57</cross-reference> is a diagram showing another exemplary structure of a reception contract information in the fourth embodiment of the present invention. </paragraph>
<paragraph id="P-0074" lvl="0"><number>&lsqb;0074&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 58</cross-reference> is a diagram showing a still another exemplary structure of a reception contract information in the fourth embodiment of the present invention. </paragraph>
<paragraph id="P-0075" lvl="0"><number>&lsqb;0075&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 59</cross-reference> is a diagram showing an exemplary form of channel keys, channel key identifiers and channel number identifiers in a channel key storage unit of the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 51</cross-reference>. </paragraph>
<paragraph id="P-0076" lvl="0"><number>&lsqb;0076&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 60</cross-reference> is a block diagram showing a modified configuration of a broadcast reception device according to the fourth embodiment of the present invention. </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 61</cross-reference> is a block diagram showing an exemplary configuration of a broadcast reception device according to the fifth embodiment of the present invention. </paragraph>
<paragraph id="P-0078" lvl="0"><number>&lsqb;0078&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 62</cross-reference> is a block diagram showing an exemplary configuration of a first latch unit for scan path test in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 61</cross-reference>. </paragraph>
<paragraph id="P-0079" lvl="0"><number>&lsqb;0079&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 63</cross-reference> is a flow chart of a processing in the first latch unit for scan path test of <cross-reference target="DRAWINGS">FIG. 62</cross-reference>. </paragraph>
<paragraph id="P-0080" lvl="0"><number>&lsqb;0080&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 64</cross-reference> is a diagram showing an exemplary structure of a contract information packet containing an authentication information that can be used in the fifth embodiment of the present invention. </paragraph>
<paragraph id="P-0081" lvl="0"><number>&lsqb;0081&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 65</cross-reference> is a flow chart of a processing in the first latch unit for scan path test of <cross-reference target="DRAWINGS">FIG. 62</cross-reference> in the case of using a digital signature as an authentication information. </paragraph>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 66</cross-reference> is a block diagram showing another exemplary configuration of a first latch unit for scan path test in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 61</cross-reference>. </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 67</cross-reference> is a block diagram showing an exemplary configuration of a second latch unit for scan path test in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 61</cross-reference>. </paragraph>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 68</cross-reference> is a block diagram showing an exemplary configuration of an authentication unit in the broadcast reception unit of <cross-reference target="DRAWINGS">FIG. 61</cross-reference> in the case where a reception contract information contains a digital signature. </paragraph>
<paragraph id="P-0085" lvl="0"><number>&lsqb;0085&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 69</cross-reference> is a diagram showing an exemplary structure of a reception contract information containing a digital signature that can be used in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 61</cross-reference>. </paragraph>
<paragraph id="P-0086" lvl="0"><number>&lsqb;0086&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 70</cross-reference> is a block diagram showing an exemplary configuration of a contract management device according to the third embodiment of the present invention. </paragraph>
<paragraph id="P-0087" lvl="0"><number>&lsqb;0087&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 71</cross-reference> is a block diagram showing an exemplary configuration of a contract management device according to the fourth embodiment of the present invention. </paragraph>
<paragraph id="P-0088" lvl="0"><number>&lsqb;0088&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 72</cross-reference> is a block diagram showing an exemplary configuration of a contract information packet generation unit in the contract management device of <cross-reference target="DRAWINGS">FIG. 70</cross-reference>. </paragraph>
<paragraph id="P-0089" lvl="0"><number>&lsqb;0089&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 73</cross-reference> is a flow chart for a processing in the contract information packet generation unit of <cross-reference target="DRAWINGS">FIG. 72</cross-reference>. </paragraph>
<paragraph id="P-0090" lvl="0"><number>&lsqb;0090&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 74</cross-reference> is a diagram showing a basic structure of a reception contract information that can be used in the third embodiment of the present invention. </paragraph>
<paragraph id="P-0091" lvl="0"><number>&lsqb;0091&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 75</cross-reference> is a diagram showing an exemplary structure of a reception contract information containing an authenticator that can be used in the third embodiment of the present invention. </paragraph>
<paragraph id="P-0092" lvl="0"><number>&lsqb;0092&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 76</cross-reference> is a diagram showing an exemplary structure of a reception contract information containing an authenticator and a digital signature that can be used in the third embodiment of the present invention. </paragraph>
<paragraph id="P-0093" lvl="0"><number>&lsqb;0093&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 77</cross-reference> is a diagram showing an exemplary form of a reception contract information containing an authenticator and a digital signature that can be used in the third embodiment of the present invention. </paragraph>
<paragraph id="P-0094" lvl="0"><number>&lsqb;0094&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 78</cross-reference> is a diagram showing another exemplary form of a reception contract information containing an authenticator and a digital signature that can be used in the third embodiment of the present invention. </paragraph>
<paragraph id="P-0095" lvl="0"><number>&lsqb;0095&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 79</cross-reference> is a diagram showing an exemplary form of a reception contract information that can be used in the fourth embodiment of the present invention. </paragraph>
<paragraph id="P-0096" lvl="0"><number>&lsqb;0096&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 80</cross-reference> is a diagram showing another exemplary form of a reception contract information that can be used in the fourth embodiment of the present invention. </paragraph>
<paragraph id="P-0097" lvl="0"><number>&lsqb;0097&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 81</cross-reference> is a block diagram showing an exemplary configuration of a contract management device according to the sixth embodiment of the present invention. </paragraph>
<paragraph id="P-0098" lvl="0"><number>&lsqb;0098&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 82</cross-reference> is a block diagram showing an exemplary configuration of a broadcast reception device according to the sixth embodiment of the present invention.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS </heading>
<paragraph id="P-0099" lvl="0"><number>&lsqb;0099&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 1</cross-reference> to <cross-reference target="DRAWINGS">FIG. 23</cross-reference>, the first embodiment of a conditional access broadcast system according to the present invention will be described in detail. </paragraph>
<paragraph id="P-0100" lvl="7"><number>&lsqb;0100&rsqb;</number> (1) Overview of the Broadcast System: </paragraph>
<paragraph id="P-0101" lvl="0"><number>&lsqb;0101&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> shows a schematic configuration of the broadcast system using the contract management device and the broadcast reception device according to the present invention, for an exemplary form of service in which contents are to be provided to a reception device <highlight><bold>100</bold></highlight> of each user who has the reception contract, from a broadcast station <highlight><bold>200</bold></highlight> through a satellite. Note that the exemplary case of satellite broadcast will be described here, but the present invention is equally applicable to the form of service in which contents are to be provided by the terrestrial broadcast. </paragraph>
<paragraph id="P-0102" lvl="0"><number>&lsqb;0102&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> schematically shows a flow of procedures for contracting subscription or continuation to the broadcast service of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, renewing contract, cancelling contract, and charging. As shown in <cross-reference target="DRAWINGS">FIG. 2, a</cross-reference> user who wishes to subscribe to the broadcast service of <cross-reference target="DRAWINGS">FIG. 1</cross-reference> carries out a prescribed subscription order in accordance with contract terms such as desired viewable or listenable channels and viewable or listenable period, at a prescribed agency such as a reception device retail store which carries out the proxy subscription. When the contract terms are registered in a contracting user database on the broadcast station side through the agency, the service with respect to the user in accordance with the registered contract terms will be started. The fee to be paid by the user for this service may be paid by a credit card or through a bank, for example. </paragraph>
<paragraph id="P-0103" lvl="0"><number>&lsqb;0103&rsqb;</number> The service will be provided to the user basically according to the registered contract terms in the contracting user database on the broadcast station side so that at a time of continuation, renewal, or cancellation of the contract terms registered at a time of subscription it suffices to update or delete the registered contract terms in the contracting user database upon receiving a notice to that effect either directly from the user or through a prescribed agency. Here the broadcast station may start or continue the service with respect to the user upon confirming the payment of the subscription fee, the reception fee, etc. </paragraph>
<paragraph id="P-0104" lvl="7"><number>&lsqb;0104&rsqb;</number> (2) Contract Management Device: </paragraph>
<paragraph id="P-0105" lvl="0"><number>&lsqb;0105&rsqb;</number> (2-1) </paragraph>
<paragraph id="P-0106" lvl="0"><number>&lsqb;0106&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> shows an exemplary configuration of a contract management device according to this first embodiment, which is to be provided at the broadcast station <highlight><bold>200</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. </paragraph>
<paragraph id="P-0107" lvl="0"><number>&lsqb;0107&rsqb;</number> The broadcast station <highlight><bold>200</bold></highlight> broadcasts contents information (&lsqb;Contents&rsqb;Kch) which is encrypted using a channel key Kch prescribed for each channel, and appending information (&lsqb;Appending&rsqb;Km) which is containing a terminal ID, a channel key Kch, etc., and encrypted using a master key Km. </paragraph>
<paragraph id="P-0108" lvl="0"><number>&lsqb;0108&rsqb;</number> The appending information is used in giving a reception permission only to a user who has a broadcast reception contract and paid the reception fee. The reception device provided at each user&apos;s home receives the encrypted appending information (&lsqb;Appending&rsqb;Km) and decrypts it using the master key Km provided in that reception device. Then the terminal ID contained therein is compared with the terminal ID assigned to that reception device, and if they coincide, the channel key Kch contained therein is stored into a database provided in that reception device and will be used in decrypting the encrypted contents information (&lsqb;Contents&rsqb;Kch). </paragraph>
<paragraph id="P-0109" lvl="0"><number>&lsqb;0109&rsqb;</number> The channel key Kch is changed regularly at a certain period (one month for example), and any subsequent appending information will not be sent to a user whose contract period has expired so that it becomes impossible for such a user to view or listen the broadcast contents as a corresponding channel key Kch cannot be obtained. </paragraph>
<paragraph id="P-0110" lvl="0"><number>&lsqb;0110&rsqb;</number> In addition, in order to improve the security level of this scheme, the master key Km is updated regularly at a certain period. This is done by using common random number generators that are provided at both the reception device and the broadcast device, and regularly transmitting an initial value (referred to as a seed hereafter) for causing the random number generator to generate a random number, to the reception device by the broadcast radio waves. In this way, even if the master key Km is revealed, this master key Km is valid only for a certain period so that it is possible to prevent the improper viewing or listening. Moreover, the information necessary in generating the decryption key is delivered rather than delivering the decryption key itself so that the security level is high. </paragraph>
<paragraph id="P-0111" lvl="0"><number>&lsqb;0111&rsqb;</number> Now, the contract management device of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> functions to generate the appending information and to broadcast the generated appending information in an encrypted form using the master key Km. </paragraph>
<paragraph id="P-0112" lvl="0"><number>&lsqb;0112&rsqb;</number> First, a registration processing for a contracting user database <highlight><bold>1</bold></highlight> will be described with reference to <cross-reference target="DRAWINGS">FIG. 3</cross-reference> and <cross-reference target="DRAWINGS">FIG. 7</cross-reference>. When the broadcast contract with a user who wishes to subscribe to the broadcast service of <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is made, the contract information is entered into the contract management device of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> (step S<highlight><bold>1</bold></highlight>), and stored in a payment confirmation waiting database <highlight><bold>2</bold></highlight> (steps S<highlight><bold>2</bold></highlight> to S<highlight><bold>3</bold></highlight>). Those entries in the payment confirmation waiting database <highlight><bold>2</bold></highlight> for which the payment confirmation is made are sequentially sent to the contracting user database <highlight><bold>1</bold></highlight>, and deleted from the payment confirmation waiting database <highlight><bold>2</bold></highlight> (steps S<highlight><bold>2</bold></highlight> to S<highlight><bold>4</bold></highlight>). </paragraph>
<paragraph id="P-0113" lvl="0"><number>&lsqb;0113&rsqb;</number> The contracting user database <highlight><bold>1</bold></highlight> stores data in a format shown in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>, where a reception terminal ID indicates an information for identifying the reception terminal, channel numbers indicates channel numbers covered by the contract, and a contract period indicates a period (until Jan. 31, 1998, for example) covered by the contract in a prescribed format. </paragraph>
<paragraph id="P-0114" lvl="0"><number>&lsqb;0114&rsqb;</number> The validity of the contract period is to be checked at a prescribed timing by the contract period checking unit <highlight><bold>7</bold></highlight>. When it is found invalid there, the corresponding contract information is sent to a contract cancelled user database <highlight><bold>6</bold></highlight> and deleted from the contracting user database <highlight><bold>1</bold></highlight>. Consequently, the information regarding users for which the contract periods expired will be deleted from the contracting user database <highlight><bold>1</bold></highlight> so that no appending information will be delivered to these users. </paragraph>
<paragraph id="P-0115" lvl="0"><number>&lsqb;0115&rsqb;</number> A seed database <highlight><bold>3</bold></highlight> stores a master key generated from a seed for master key by a seed and master key generation unit <highlight><bold>10</bold></highlight> at a prescribed timing, along with its seed ID and valid period, in a format shown in <cross-reference target="DRAWINGS">FIG. 5</cross-reference>. </paragraph>
<paragraph id="P-0116" lvl="0"><number>&lsqb;0116&rsqb;</number> A channel key database <highlight><bold>4</bold></highlight> stores a channel number generated by a channel key generation unit <highlight><bold>11</bold></highlight> at a prescribed timing, along with a channel number, a channel key ID and its valid period, in a format shown in <cross-reference target="DRAWINGS">FIG. 6</cross-reference>. </paragraph>
<paragraph id="P-0117" lvl="0"><number>&lsqb;0117&rsqb;</number> Next, a procedure for generating an appending information corresponding to each contracting user and sending it to the reception device using the broadcast device <highlight><bold>13</bold></highlight> will be described with reference to <cross-reference target="DRAWINGS">FIG. 8</cross-reference>. </paragraph>
<paragraph id="P-0118" lvl="0"><number>&lsqb;0118&rsqb;</number> An appending information generation control unit <highlight><bold>9</bold></highlight> sends a command for appending information generation to an appending information generation unit <highlight><bold>8</bold></highlight> (step S<highlight><bold>11</bold></highlight>). This command has a content of &ldquo;send an appending information for contracting users who have the contract for one month from Dec. 1, 1997&rdquo;, for example, which may be expressed by a bit sequence of a prescribed format. When such a command is issued, the appending information generation unit <highlight><bold>8</bold></highlight> searches the information of users who have the contract for at least one month from Dec. 1, 1997, through the contracting user database <highlight><bold>1</bold></highlight>, and reads that information from there (steps S<highlight><bold>12</bold></highlight> to S<highlight><bold>13</bold></highlight>). Then, a terminal ID and channel numbers of each user are obtained from the user information read out from the contracting user database <highlight><bold>1</bold></highlight> (step S<highlight><bold>14</bold></highlight>). </paragraph>
<paragraph id="P-0119" lvl="0"><number>&lsqb;0119&rsqb;</number> Here, the minimum unit of the contract period is set to be one month, and the valid period of the contract is assumed to start from the first day of the month and end by the last day of the month. Namely, the channel key for November is to be different from that for December, while channel key for each month is to be kept unchanged within that month. Also, obviously, different channel keys are to be used for different channel numbers even within the same period. </paragraph>
<paragraph id="P-0120" lvl="0"><number>&lsqb;0120&rsqb;</number> Next, the appending information generation unit <highlight><bold>8</bold></highlight> searches a channel key Kch that is valid from Dec. 1, 1997 to Dec. 31, 1997, through the channel key database <highlight><bold>4</bold></highlight>, and reads that channel key Kch from there (step S<highlight><bold>15</bold></highlight>). Also, a master key Km corresponding to a seed that is valid from Dec. 1, 1997 to Dec. 31, 1997 is searched through the seed database <highlight><bold>3</bold></highlight>, and that master key Km is read out from there (step S<highlight><bold>16</bold></highlight>). Here, again, the minimum unit of the master key switching is set to be one month. Note however that it is not absolutely necessary to change the master key in one month in view of its characteristics. </paragraph>
<paragraph id="P-0121" lvl="0"><number>&lsqb;0121&rsqb;</number> According to the information (each user&apos;s terminal ID, contracted channel numbers, and channel key Kch) obtained above, the appending information generation unit <highlight><bold>8</bold></highlight> generates the appending information for each user as shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>B, and encrypts it using the master key Km (step S<highlight><bold>17</bold></highlight>). The encrypted appending information for each contracting user generated here will be sequentially sent to the appending information generation control unit <highlight><bold>9</bold></highlight> and the broadcast device <highlight><bold>13</bold></highlight>. </paragraph>
<paragraph id="P-0122" lvl="0"><number>&lsqb;0122&rsqb;</number> The broadcast device <highlight><bold>13</bold></highlight> converts the encrypted appending information into broadcast waves of a prescribed frequency bandwidth, and delivers them toward each reception device (step S<highlight><bold>18</bold></highlight>). </paragraph>
<paragraph id="P-0123" lvl="0"><number>&lsqb;0123&rsqb;</number> On the other hand, the encrypted contents information (see <cross-reference target="DRAWINGS">FIG. 9A</cross-reference>) which is encrypted using the channel key Kch corresponding to each channel number will be sent separately (by another bandwidth) from this appending information, and the reception device is made to receive them both. </paragraph>
<paragraph id="P-0124" lvl="0"><number>&lsqb;0124&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> shows an exemplary configuration of a contents information delivery device to be provided at the broadcast station <highlight><bold>200</bold></highlight> in order to generate and deliver (broadcast) the encrypted contents information. In <cross-reference target="DRAWINGS">FIG. 10</cross-reference>, the elements identical to those shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference> are given the same reference numerals. </paragraph>
<paragraph id="P-0125" lvl="0"><number>&lsqb;0125&rsqb;</number> The contents information of each channel is stored in the contents information database <highlight><bold>21</bold></highlight> as shown in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>. The encryption unit <highlight><bold>22</bold></highlight> reads out the contents information corresponding to each channel number from the contents information database <highlight><bold>21</bold></highlight>, while reading out the channel key for each channel number that is valid within the appending information generation range mentioned earlier from the channel key database <highlight><bold>4</bold></highlight>, and encrypts the contents information of each channel using the channel key Kch of the corresponding channel number and then sends it to the information appending unit <highlight><bold>23</bold></highlight>. </paragraph>
<paragraph id="P-0126" lvl="0"><number>&lsqb;0126&rsqb;</number> In the case of updating the master key Km at a prescribed interval, the information appending unit <highlight><bold>23</bold></highlight> reads out the master key seed or the seed ID which is valid within the appending information generation range mentioned earlier from the seed database <highlight><bold>3</bold></highlight>, and outputs it to the broadcast device <highlight><bold>13</bold></highlight>. </paragraph>
<paragraph id="P-0127" lvl="0"><number>&lsqb;0127&rsqb;</number> The broadcast device <highlight><bold>13</bold></highlight> multiplexes the contents information encrypted using the channel key and the master key seed or the seed ID, converts them into broadcast waves of a prescribed frequency bandwidth, and delivers them toward each reception device. </paragraph>
<paragraph id="P-0128" lvl="0"><number>&lsqb;0128&rsqb;</number> In the case where all the information cannot be sent at once because there is a need to deliver a large amount of information in order to send the appending information for each channel to each user, it is possible to store the appending information generated by the appending information generation unit <highlight><bold>8</bold></highlight> into the appending information database <highlight><bold>5</bold></highlight> once, sequentially take out a portion to be delivered from there and broadcast it, and then delete it from the appending information database <highlight><bold>5</bold></highlight> after the delivery is completed. Else, it is also possible to control the generation of the appending information from the appending information generation control unit <highlight><bold>9</bold></highlight> such that the appending information generation unit <highlight><bold>8</bold></highlight> generates only those appending information within a deliverable range. </paragraph>
<paragraph id="P-0129" lvl="0"><number>&lsqb;0129&rsqb;</number> There are also cases where the reception device fails (for some reasons) to receive the appending information delivered by a single broadcasting. For this reason, there is a need to send the appending information frequently (as much as possible) starting from a period before the start of the contract period. However, even when such a measure is taken, there can still be some cases where the reception device fails to receive the appending information (for a reason such as that the reception device has been located for a long time at a place where the reception is impossible). In such a case, the user becomes impossible to view or listen and there will be a feedback to the broadcast station side in a form of a claim from the user. Namely, the appending information output request signal containing the terminal ID and the corresponding channel numbers is sent to the appending information output request unit <highlight><bold>12</bold></highlight>, and the appending information output request unit <highlight><bold>12</bold></highlight> sends it to the appending information generation control unit <highlight><bold>9</bold></highlight>. Then, the appending information generation control unit <highlight><bold>9</bold></highlight> searches through the contracting user database <highlight><bold>1</bold></highlight> to confirm the validity of the contract, and generates and broadcasts the encrypted appending information according to the procedure described above. </paragraph>
<paragraph id="P-0130" lvl="0"><number>&lsqb;0130&rsqb;</number> (2-2) </paragraph>
<paragraph id="P-0131" lvl="0"><number>&lsqb;0131&rsqb;</number> Note that the above description is directed to the case where the channel key Kch itself is contained in the appending information, but the present invention is not necessarily limited to this case and it is possible to divide the channel key Kch into two channel sub-keys H and L consisting of upper several tens of bits and remaining lower several tens of bits respectively, for example, and mount only the channel sub-key H on the appending information while the other channel sub-key L is delivered in a form of being appended (or multiplexed) to the contents information encrypted using the channel key Kch. </paragraph>
<paragraph id="P-0132" lvl="0"><number>&lsqb;0132&rsqb;</number> In this case, the appending information generation unit <highlight><bold>8</bold></highlight> of the contract management device extracts the channel sub-key H from the channel key that is valid within the appending information generation range in the channel key database <highlight><bold>4</bold></highlight>, generates the appending information for each user as shown in <cross-reference target="DRAWINGS">FIG. 11B</cross-reference> according to the user&apos;s terminal ID, the contracted channel numbers, and the channel sub-key H, and encrypts it using the master key Km. </paragraph>
<paragraph id="P-0133" lvl="0"><number>&lsqb;0133&rsqb;</number> Also, the information appending unit <highlight><bold>23</bold></highlight> of the contents information delivery device shown in <cross-reference target="DRAWINGS">FIG. 10</cross-reference> further extracts the channel sub-key L from the channel key for each channel number that is valid within the appending information generation range mentioned earlier in the channel key database <highlight><bold>4</bold></highlight>, and outputs it to the broadcast device <highlight><bold>13</bold></highlight>. The broadcast device <highlight><bold>13</bold></highlight> then delivers broadcast waves of a prescribed frequency bandwidth, in which the contents information encrypted using the channel key, the channel sub-key L, and the master key seed or the seed ID if necessary are multiplexed as shown in <cross-reference target="DRAWINGS">FIG. 11</cross-reference>A, toward each reception device. </paragraph>
<paragraph id="P-0134" lvl="0"><number>&lsqb;0134&rsqb;</number> (2-3) </paragraph>
<paragraph id="P-0135" lvl="0"><number>&lsqb;0135&rsqb;</number> It is also possible to consider the case of using the appending information given by an appending information unique to each contracting user (terminal related appending information) as shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference> and an appending information corresponding to a channel number (channel related appending information) as shown in <cross-reference target="DRAWINGS">FIG. 13</cross-reference>. </paragraph>
<paragraph id="P-0136" lvl="0"><number>&lsqb;0136&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference>, the terminal related appending information comprises a terminal ID, channel numbers, and an information indicating whether the contract with the reception device identified by the terminal ID is valid or invalid. This indicates whether the reception contract of the reception device which has the terminal ID described in the terminal related appending information as its own terminal ID is valid or invalid for the channels corresponding to the channel numbers described in the terminal related appending information. </paragraph>
<paragraph id="P-0137" lvl="0"><number>&lsqb;0137&rsqb;</number> Using this terminal related appending information, the reception device sets the corresponding channel valid when the terminal related appending information indicating that the reception contract for that channel is valid (which will also be referred to as valid terminal related appending information or ON signal below) is received, until the terminal related appending information indicating that the reception contract for that channel is invalid (which will also be referred to as invalid terminal related appending information or OFF signal below) is subsequently received. Then, the reception device sets that channel invalid when the invalid terminal related appending information is received, until the valid terminal related appending information is subsequently received. </paragraph>
<paragraph id="P-0138" lvl="0"><number>&lsqb;0138&rsqb;</number> The terminal related appending information does not contain the channel key so that it is possible to reduce the size of the entire appending information to less than a half. Namely, in order to prevent the cryptoanalysis of the contents information encrypted using the channel key, it is necessary to use at least about 56 bits for the channel key, while it is sufficient to use about 30 bits for the information other than the channel key such as the terminal ID, the channel numbers, etc. Consequently, when the channel key is contained in the appending information, a rate occupied by the channel key with respect to the entire appending information becomes quite high. Thus, by eliminating the channel key from the appending information, it becomes possible to reduce the size of the entire appending information to less than a half. As a consequence, the appending information that is smaller than that of the above described scheme will be sent in this case so that the number of appending information that can be sent per unit time can be increased. Moreover, there is no need to send the channel key individually to each user every month, for example, in synchronization with the timing for switching the channel key, and it suffices to deliver the terminal related appending information only at a time of new subscription and at a time of contract expiration so that the amount of appending information to be delivered as a whole can be reduced drastically. </paragraph>
<paragraph id="P-0139" lvl="0"><number>&lsqb;0139&rsqb;</number> In fact, in this case, it is necessary to deliver the terminal related appending information that is to be delivered to each user individually, only at a time of validating the broadcast reception and at a time of invalidating the broadcast reception, so that the amount of appending information to be delivered can be quite small in normal circumstances. </paragraph>
<paragraph id="P-0140" lvl="0"><number>&lsqb;0140&rsqb;</number> In this case, the configuration of the contract management device for delivering the terminal related appending information of <cross-reference target="DRAWINGS">FIG. 12</cross-reference> can be the same as that of <cross-reference target="DRAWINGS">FIG. 3</cross-reference>, but the operation will be different. Namely, the appending information generation unit <highlight><bold>8</bold></highlight> generates the terminal related appending information by retrieving information from the contracting user database <highlight><bold>1</bold></highlight>, the seed database <highlight><bold>3</bold></highlight>, and the contract cancelled user database <highlight><bold>6</bold></highlight>, without retrieving information from the channel key database <highlight><bold>4</bold></highlight>. This is because there is no need to contain the channel key in the terminal related appending information on one hand, and also because it is necessary to send the terminal related appending information to those users who have cancelled the contracts. </paragraph>
<paragraph id="P-0141" lvl="0"><number>&lsqb;0141&rsqb;</number> Now, the processing of the contract management device of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> in this case will be described. </paragraph>
<paragraph id="P-0142" lvl="0"><number>&lsqb;0142&rsqb;</number> The registration processing for the contracting user database <highlight><bold>1</bold></highlight> after the contract information input is carried out according to the flow chart of <cross-reference target="DRAWINGS">FIG. 7</cross-reference>. </paragraph>
<paragraph id="P-0143" lvl="0"><number>&lsqb;0143&rsqb;</number> The appending information generation control unit <highlight><bold>9</bold></highlight> retrieves the new contracting user information registered in the contracting user database <highlight><bold>1</bold></highlight> at a prescribed timing through the appending information generation unit <highlight><bold>8</bold></highlight>. Then, the appending information generation unit <highlight><bold>8</bold></highlight> extracts the terminal ID and the contracted channel numbers from the retrieved new contracting user information, and generates the terminal related appending information as shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference> (in this case the contract is to be validated so that the valid terminal related appending information will be generated). </paragraph>
<paragraph id="P-0144" lvl="0"><number>&lsqb;0144&rsqb;</number> In addition, the appending information generation unit <highlight><bold>8</bold></highlight> searches through the seed database <highlight><bold>3</bold></highlight> and extracts the currently valid master key. Then, the terminal related appending information generated earlier is encrypted using this master key, and sent to the appending information generation control unit <highlight><bold>9</bold></highlight>. </paragraph>
<paragraph id="P-0145" lvl="0"><number>&lsqb;0145&rsqb;</number> The appending information generation control unit <highlight><bold>9</bold></highlight> then sends this to the broadcast device <highlight><bold>13</bold></highlight>, which broadcasts it using a prescribed bandwidth. </paragraph>
<paragraph id="P-0146" lvl="0"><number>&lsqb;0146&rsqb;</number> Here, there can be cases where the number of terminal related appending information to be delivered is too many so that all of them cannot be broadcasted at once. In such a case, it is possible for the appending information generation control unit <highlight><bold>9</bold></highlight> carry out such a control that the generated encrypted terminal related appending information will be temporarily stored in the appending information database <highlight><bold>5</bold></highlight>. </paragraph>
<paragraph id="P-0147" lvl="0"><number>&lsqb;0147&rsqb;</number> At the contracting user side, when the terminal related appending information as shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is received at the reception device owned by the user, the decryption unit (to be described below) inside the reception device decrypts it and checks whether the contract is valid or not. When an indication that the contract is valid is described therein, the user can view or listen the desired programs by decrypting the contents information of the corresponding channel, that is delivered through a bandwidth different from that used for the appending information, for example, using the channel key of that channel. </paragraph>
<paragraph id="P-0148" lvl="0"><number>&lsqb;0148&rsqb;</number> The contract period checking unit <highlight><bold>7</bold></highlight> searches through the contracting user database <highlight><bold>1</bold></highlight> at a prescribed timing, and retrieves information regarding the contract expired users. The retrieved information regarding the contract expired users is then registered into the contract cancelled user database <highlight><bold>6</bold></highlight>. </paragraph>
<paragraph id="P-0149" lvl="0"><number>&lsqb;0149&rsqb;</number> There is a need to deliver the invalid terminal related appending information to the contract expired user. For this reason, the appending information generation control unit <highlight><bold>9</bold></highlight> first retrieves the new contracting user information registered in the contracting user database <highlight><bold>1</bold></highlight> at a prescribed timing through the appending information generation unit <highlight><bold>8</bold></highlight>, similarly as in the case of delivering the valid terminal related appending information described above. </paragraph>
<paragraph id="P-0150" lvl="0"><number>&lsqb;0150&rsqb;</number> Then, the appending information generation unit <highlight><bold>8</bold></highlight> extracts the terminal ID and the contracted channel numbers from the retrieved new contracting user information, and generates the terminal related appending information as shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference> (in this case the contract is to be invalidated so that the invalid terminal related appending information will be generated). In addition, the appending information generation unit <highlight><bold>8</bold></highlight> searches through the seed database <highlight><bold>3</bold></highlight> and extracts the currently valid master key. Then, the terminal related appending information generated earlier is encrypted using this master key, and sent to the appending information generation control unit <highlight><bold>9</bold></highlight>. Then, the appending information generation control unit <highlight><bold>9</bold></highlight> sends it to the broadcast device <highlight><bold>13</bold></highlight>, which broadcasts it using a prescribed bandwidth. </paragraph>
<paragraph id="P-0151" lvl="0"><number>&lsqb;0151&rsqb;</number> Here, in the case of delivering the invalid terminal related appending information, there can be cases where the reception device fails (for some reason) to receive the appending information by a single broadcasting, so that there is a need to broadcast the once transmitted information regularly over several months, because otherwise that reception device would be left in a viewable or listenable state indefinitely and it cannot be said that the reception contract is managed. This situation is similar in the case of delivering the valid terminal related appending information, but in that case it is not necessary to continue broadcasting the appending information so long as in the case of delivering the invalid terminal related appending information, because in that case the reception failure can be detected by a claim from the user so that the unreceived valid terminal related appending information can be delivered using the appending information output request unit <highlight><bold>12</bold></highlight>. </paragraph>
<paragraph id="P-0152" lvl="0"><number>&lsqb;0152&rsqb;</number> Next, the delivery of the channel key for decrypting the contents information in this case will be described. </paragraph>
<paragraph id="P-0153" lvl="0"><number>&lsqb;0153&rsqb;</number> Assuming that the channel key is to be changed once every month, the channel related appending information in a format as shown in <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is generated from the channel key, the channel number, and the channel key ID if necessary, and encrypted using the master key that is valid at that moment. This encrypted channel related appending information is then delivered using the same bandwidth as that used for delivering the terminal related appending information at a prescribed timing. </paragraph>
<paragraph id="P-0154" lvl="0"><number>&lsqb;0154&rsqb;</number> At a time of delivery, it is possible to provide an information such as a bit information for distinguishing the terminal related appending information and the channel related appending information, at non-encrypted portions of the terminal related appending information and the channel related appending information. </paragraph>
<paragraph id="P-0155" lvl="0"><number>&lsqb;0155&rsqb;</number> At the reception device side, this bit information is checked, and if it is the channel related appending information it is decrypted. Also, the channel number contained in the channel related appending information is checked, and if it is the currently reception contracted channel number, the channel key ID and the channel key contained in that channel related appending information are stored. </paragraph>
<paragraph id="P-0156" lvl="0"><number>&lsqb;0156&rsqb;</number> Here, in the case of changing the channel key, it is preferable to deliver the channel key after the change prior to a timing at which the channel key is to be actually changed. In this way, it becomes possible for the reception device side to continually carry out the decryption of the contents information in conjunction with the channel key change. For example, the channel related appending information of the channel key that is to be changed from Jan. 1, 1998 can be delivered starting from Dec. 15, 1997, such that it becomes highly likely for the reception device to receive this channel related appending information of that channel key during 16 days. By storing the received channel related appending information in a prescribed database, the switching of the channel key between Dec. 31, 1997 and Jan. 1, 1998 can be dome smoothly so that it becomes possible for the user to continually view or listen programs of the desired channel. </paragraph>
<paragraph id="P-0157" lvl="0"><number>&lsqb;0157&rsqb;</number> On the other hand, the reception device of the newly contracted user does not store that channel key (because the reception contract has not been made until now). For this reason, there arises a problem that the new contracting user cannot view or listen immediately after the contract is made. In order to resolve this problem, it is necessary to deliver the channel related appending information frequently. However, the channel related appending information as shown in <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is in correspondence to the channel number and not to each user individually (that is, it is an information to be delivered commonly to all users), so that the amount of appending information to be delivered can be less compared with the case of delivering the appending information as shown in <cross-reference target="DRAWINGS">FIG. 9B</cross-reference> which must be delivered individually to each user, and consequently it is quite possible to deliver the channel related appending information frequently. </paragraph>
<paragraph id="P-0158" lvl="0"><number>&lsqb;0158&rsqb;</number> Note that the delivery of the channel related appending information can be made more effective by sending it more frequently immediately before the channel key change (Dec. 31, 1997) and immediately after the channel key change (Jan. 1, 1998) than usual. This is because it is desirable to receive it without failure by this period. The same is also true for a timing of updating the reception contract (a timing at which the new reception contract starts and a timing at which the contract expires). </paragraph>
<paragraph id="P-0159" lvl="0"><number>&lsqb;0159&rsqb;</number> In the above described (2-1), the switching of the channel key directly implied the switching of the contract (contract expiration/contract continuation), so that a timing for switching the channel key and a timing for switching the contract was set at the same timing, but in the case of using the valid/invalid terminal related appending information, it is not absolutely necessary to set them at the same timing. </paragraph>
<paragraph id="P-0160" lvl="0"><number>&lsqb;0160&rsqb;</number> As described, in the case of using the valid/invalid terminal related appending information and the channel related appending information, the appending information content to be delivered to the contracting users is divided into information individual to each user and information common to all users, and it suffices to deliver the terminal related appending information frequently at a time of contract switching while delivering the channel related appending information frequently at a time of the channel key switching, so that the amount of information to be delivered can be distributed. </paragraph>
<paragraph id="P-0161" lvl="0"><number>&lsqb;0161&rsqb;</number> (2-4) </paragraph>
<paragraph id="P-0162" lvl="0"><number>&lsqb;0162&rsqb;</number> In the above described (2-3), whether to permit or refuse the decryption of the contents information at the reception device is controlled by delivering the valid/invalid appending information (a control with respect to the reception terminal at a time of new subscription and a time of contract expiration). The operation similar to this can also be realized using the appending information as shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>B, for example, as follows. </paragraph>
<paragraph id="P-0163" lvl="0"><number>&lsqb;0163&rsqb;</number> Namely, during the contract period, the appending information generation unit <highlight><bold>8</bold></highlight> generates the appending information containing the terminal ID, the channel key, and the channel numbers as shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>B, and delivers it to each user. However, at the end of each month (a period which is the valid period of the channel key as well as the minimum unit of the contract period), for example, the appending information generation unit <highlight><bold>8</bold></highlight> searches through the contract cancelled user database <highlight><bold>6</bold></highlight>, and generates and delivers the appending information that does not contain the channel key for those users whose contracts have expired. At the reception device of such user, it becomes impossible to decrypt the contents information thereafter (because the valid channel key will not be received thereafter). In this way, the appending information that does not contain the channel key can function as a signal for notifying the contract expiration to the reception device of the user as well as a control signal for making it impossible to view or listen at that reception device. </paragraph>
<paragraph id="P-0164" lvl="0"><number>&lsqb;0164&rsqb;</number> Similarly, in the case of using the appending information containing the channel sub-key H as shown in <cross-reference target="DRAWINGS">FIG. 11</cross-reference>B, during the contract period, the appending information generation unit <highlight><bold>8</bold></highlight> generates the appending information containing the terminal ID, the channel sub-key H, and the channel numbers as shown in <cross-reference target="DRAWINGS">FIG. 11</cross-reference>B, and delivers it to each user. However, at the end of each month (a period which is the valid period of the channel key as well as the minimum unit of the contract period), for example, the appending information generation unit <highlight><bold>8</bold></highlight> searches through the contract cancelled user database <highlight><bold>6</bold></highlight>, and generates and delivers the appending information that does not contain the channel sub-key for those users whose contracts have expired. At the reception device of such user, it becomes impossible to decrypt the contents information thereafter (because the channel sub-key necessary in generating the channel key cannot be obtained thereafter). In this way, the appending information that does not contain the channel sub-key can function as a signal for notifying the contract expiration to the reception device of the user as well as a control signal for making it impossible to view or listen at that reception device. </paragraph>
<paragraph id="P-0165" lvl="0"><number>&lsqb;0165&rsqb;</number> (2-5) </paragraph>
<paragraph id="P-0166" lvl="0"><number>&lsqb;0166&rsqb;</number> Next, the scheduling unit <highlight><bold>14</bold></highlight> of the contract management device shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference> will be described. </paragraph>
<paragraph id="P-0167" lvl="0"><number>&lsqb;0167&rsqb;</number> The scheduling unit <highlight><bold>14</bold></highlight> carries out the delivery control such that the appending information will be received by the reception device of each user without failure, at a time of delivering the appending information stored in the appending information database <highlight><bold>5</bold></highlight> and at a time of delivering the appending information by the broadcast device <highlight><bold>13</bold></highlight>. </paragraph>
<paragraph id="P-0168" lvl="0"><number>&lsqb;0168&rsqb;</number> Namely, there is a need to send the appending information frequently immediately after the reception contract is made, at a time of contract change, at a time of contract cancellation, at a time of updating the channel key, etc., for example, so that scheduling unit <highlight><bold>14</bold></highlight> carries out the appending information delivery control according to the delivery schedule of the appending information to that end. It is also effective to use such a delivery schedule of the appending information that the appending information will be delivered frequently at time zones during which popular programs are broadcasted, so as to ensure the delivery to the user side. </paragraph>
<paragraph id="P-0169" lvl="7"><number>&lsqb;0169&rsqb;</number> (3) Reception Device: </paragraph>
<paragraph id="P-0170" lvl="0"><number>&lsqb;0170&rsqb;</number> (3-1) </paragraph>
<paragraph id="P-0171" lvl="0"><number>&lsqb;0171&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 14</cross-reference> shows an exemplary configuration of the reception device <highlight><bold>100</bold></highlight> according to this first embodiment, which receives the appending information generated by the contract management device provided at the broadcast station side as shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference> and broadcast waves outputted from the contents information delivery device as shown in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>. </paragraph>
<paragraph id="P-0172" lvl="0"><number>&lsqb;0172&rsqb;</number> Here, the broadcast waves to be received at the reception device <highlight><bold>100</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 14</cross-reference> are assumed to contain the following information. </paragraph>
<paragraph id="P-0173" lvl="2"><number>&lsqb;0173&rsqb;</number> Master key seed </paragraph>
<paragraph id="P-0174" lvl="2"><number>&lsqb;0174&rsqb;</number> &lsqb;Appending&rsqb;Km: Appending information encrypted using the master key Km </paragraph>
<paragraph id="P-0175" lvl="2"><number>&lsqb;0175&rsqb;</number> Channel sub-key L </paragraph>
<paragraph id="P-0176" lvl="2"><number>&lsqb;0176&rsqb;</number> &lsqb;Contents&rsqb;Kch: Contents information encrypted using the channel key Kch </paragraph>
<paragraph id="P-0177" lvl="0"><number>&lsqb;0177&rsqb;</number> The master key seed is a source data for generating the master key at a master key generation unit <highlight><bold>504</bold></highlight> in the reception device <highlight><bold>100</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 14</cross-reference>. </paragraph>
<paragraph id="P-0178" lvl="0"><number>&lsqb;0178&rsqb;</number> The channel sub-key L is an information for generating the channel key Kch in conjunction with the channel sub-key H that is contained in the appending information. </paragraph>
<paragraph id="P-0179" lvl="0"><number>&lsqb;0179&rsqb;</number> Note that there can be cases where the channel sub-key L is not to be delivered in a form of being multiplexed in the broadcast waves, and in such cases it will be set such that the channel key Kch&equals;the channel sub-key H. </paragraph>
<paragraph id="P-0180" lvl="0"><number>&lsqb;0180&rsqb;</number> The appending information is assumed to contain the following information. </paragraph>
<paragraph id="P-0181" lvl="2"><number>&lsqb;0181&rsqb;</number> Terminal ID: Identification information of the reception device </paragraph>
<paragraph id="P-0182" lvl="2"><number>&lsqb;0182&rsqb;</number> Channel number (or channel numbers) </paragraph>
<paragraph id="P-0183" lvl="2"><number>&lsqb;0183&rsqb;</number> Channel sub-key H </paragraph>
<paragraph id="P-0184" lvl="0"><number>&lsqb;0184&rsqb;</number> In the case where there is only one channel that is covered by the contract with the reception device identified by the terminal ID, it is not absolutely necessary to include the channel number. Also, there are cases where the channel sub-key H is not contained in the appending information. </paragraph>
<paragraph id="P-0185" lvl="0"><number>&lsqb;0185&rsqb;</number> In the case where the channel sub-key H is contained in the appending information, this appending information functions as the so called ON signal which enables viewing or listening of the corresponding channel by the reception device identified by the corresponding terminal ID. </paragraph>
<paragraph id="P-0186" lvl="0"><number>&lsqb;0186&rsqb;</number> On the other hand, in the case where the channel sub-key H is not contained in the appending information, this appending information functions as the so called OFF signal which prohibits the use of the corresponding channel by the reception device identified by the corresponding terminal ID. </paragraph>
<paragraph id="P-0187" lvl="0"><number>&lsqb;0187&rsqb;</number> Now, the outline of the contract management mechanism at the reception device of <cross-reference target="DRAWINGS">FIG. 14</cross-reference> that received the appending information generated and delivered by the above described contract management device will be described. </paragraph>
<paragraph id="P-0188" lvl="0"><number>&lsqb;0188&rsqb;</number> In the case where the appending information contains the channel sub-key H, a decryption unit <highlight><bold>110</bold></highlight> stores the channel sub-key H extracted from the appending information into a channel sub-key storage unit <highlight><bold>508</bold></highlight>. Consequently, a channel decoder <highlight><bold>509</bold></highlight> can acquire the channel sub-key H from the channel sub-key storage unit <highlight><bold>508</bold></highlight> and combine it with the channel sub-key L delivered in a form of being multiplexed in the broadcast waves so as to generate the channel key Kch. Then, the contents information of the corresponding channel can be properly decrypted using the generated channel key Kch. </paragraph>
<paragraph id="P-0189" lvl="0"><number>&lsqb;0189&rsqb;</number> In the case where the terminal ID contained in the appending information does not coincide with the ID given in advance to the reception device, the decryption unit <highlight><bold>110</bold></highlight> does not store the channel sub-key H into the channel sub-key storage unit <highlight><bold>508</bold></highlight>. </paragraph>
<paragraph id="P-0190" lvl="0"><number>&lsqb;0190&rsqb;</number> The contract management device of the broadcast station <highlight><bold>200</bold></highlight> can allow only the contracting reception device to start viewing or listening the contracted channel by broadcasting the appending information containing the ID of the contracting reception device, the contracted viewable or listenable channel number, and the channel sub-key H of that channel, in a form of being multiplexed in the broadcast waves. </paragraph>
<paragraph id="P-0191" lvl="0"><number>&lsqb;0191&rsqb;</number> In the case where the appending information does not contain the channel sub-key H, the decryption unit <highlight><bold>110</bold></highlight> outputs a command for deleting the channel sub-key H to the channel sub-key storage unit <highlight><bold>508</bold></highlight>. The contents information of that channel is encrypted using the channel key Kch, but the channel decoder <highlight><bold>509</bold></highlight> cannot acquire the channel sub-key H and therefore cannot combine it with the channel sub-key L delivered in a form of being multiplexed with the contents information to generate the channel key Kch, so that the reproduction cannot take place because the contents information of that channel cannot be decrypted. </paragraph>
<paragraph id="P-0192" lvl="0"><number>&lsqb;0192&rsqb;</number> The contract management device of the broadcast station <highlight><bold>200</bold></highlight> broadcasts the appending information containing the ID of the contract cancelled reception device and the cancelled channel number but not containing the channel sub-key H, in a form of being multiplexed in the broadcast waves. In this way, it can prohibit (that is, cancel the contract of) only the contract cancelled reception device to view or listen the contracted channel. </paragraph>
<paragraph id="P-0193" lvl="0"><number>&lsqb;0193&rsqb;</number> Next, with references to the flow charts of <cross-reference target="DRAWINGS">FIG. 15</cross-reference> to <cross-reference target="DRAWINGS">FIG. 18</cross-reference>, the processing of the reception device of <cross-reference target="DRAWINGS">FIG. 14</cross-reference> will be described in further detail. </paragraph>
<paragraph id="P-0194" lvl="0"><number>&lsqb;0194&rsqb;</number> First, when a reception unit <highlight><bold>501</bold></highlight> receives the broadcast waves, an A/D converter <highlight><bold>502</bold></highlight> converts them into digital signals, assembles packets from information contained in these signals and outputs them to a filter <highlight><bold>503</bold></highlight> (steps S<highlight><bold>101</bold></highlight> to S<highlight><bold>102</bold></highlight>). </paragraph>
<paragraph id="P-0195" lvl="0"><number>&lsqb;0195&rsqb;</number> Each packet has a flag information that enables to distinguish whether that packet is a packet containing the master key seed, a packet containing the appending information, or a packet containing the contents information. In addition, the last packet for the master key seed and the appending information has an end flag recorded therein. </paragraph>
<paragraph id="P-0196" lvl="0"><number>&lsqb;0196&rsqb;</number> The filter <highlight><bold>503</bold></highlight> has sufficiently large buffers for the master key seed and the appending information respectively. </paragraph>
<paragraph id="P-0197" lvl="0"><number>&lsqb;0197&rsqb;</number> When it is Judged that the entered packet contains the master key seed according to the flag of that packet, this packet is added to the buffer for the master key seed, and when the end flag is detected in the flag of the sequentially entered packet, the packets stored in the buffer for the master key seed up until then are transferred to a master key generation unit <highlight><bold>504</bold></highlight> (step S<highlight><bold>103</bold></highlight> to S<highlight><bold>106</bold></highlight>). </paragraph>
<paragraph id="P-0198" lvl="0"><number>&lsqb;0198&rsqb;</number> When it is Judged that the entered packet contains the appending information according to the flag of that packet, this packet is added to the buffer for the appending information, and when the end flag is detected in the flag of the sequentially entered packet, the packets stored in the buffer for the appending information up until then are transferred to a Judgement unit <highlight><bold>507</bold></highlight> (step S<highlight><bold>107</bold></highlight> to S<highlight><bold>110</bold></highlight>). </paragraph>
<paragraph id="P-0199" lvl="0"><number>&lsqb;0199&rsqb;</number> When it is Judged that the entered packet contains the contents information and the channel sub-key L according to the flag of that packet, this packet is transferred to the channel decoder <highlight><bold>509</bold></highlight> (step S<highlight><bold>111</bold></highlight>). </paragraph>
<paragraph id="P-0200" lvl="0"><number>&lsqb;0200&rsqb;</number> As shown in the flow chart of <cross-reference target="DRAWINGS">FIG. 16</cross-reference>, the master key generation unit <highlight><bold>504</bold></highlight> extracts the master key seed from the packet transferred from the filter <highlight><bold>503</bold></highlight>, generates the master key, and stores the generated master key into a master key storage unit <highlight><bold>505</bold></highlight> (steps S<highlight><bold>121</bold></highlight> to S<highlight><bold>123</bold></highlight>). </paragraph>
<paragraph id="P-0201" lvl="0"><number>&lsqb;0201&rsqb;</number> As shown in the flow chart of <cross-reference target="DRAWINGS">FIG. 17</cross-reference>, upon receiving the packets from the filter <highlight><bold>503</bold></highlight>, the Judgement unit <highlight><bold>507</bold></highlight> first reads out the master key Km from the master key storage unit <highlight><bold>505</bold></highlight>, and then decrypts the appending information extracted from these packets using the master key Km (steps S<highlight><bold>131</bold></highlight> to S<highlight><bold>133</bold></highlight>). </paragraph>
<paragraph id="P-0202" lvl="0"><number>&lsqb;0202&rsqb;</number> The appending information always contains the terminal ID, and may also contain the channel number and the channel sub-key H in addition. </paragraph>
<paragraph id="P-0203" lvl="0"><number>&lsqb;0203&rsqb;</number> The Judgement unit <highlight><bold>507</bold></highlight> extracts the terminal ID from the appending information, compares it with the own terminal ID that is stored in advance in an ID storage unit <highlight><bold>506</bold></highlight>, and executes the subsequent processing only when they coincide. When they do not coincide, the processing is stopped (step S<highlight><bold>134</bold></highlight>). </paragraph>
<paragraph id="P-0204" lvl="0"><number>&lsqb;0204&rsqb;</number> When the terminal ID contained in the appending information coincides with the own terminal ID, whether the channel sub-key H is contained in the appending information or not is checked next (step S<highlight><bold>135</bold></highlight>), and if the channel sub-key H is contained, it is stored into the channel sub-key storage unit <highlight><bold>508</bold></highlight> (step S<highlight><bold>136</bold></highlight>). If the channel sub-key H is not contained in the appending information, it can be judged that this appending information is the OFF signal, so that the channel sub-key H already stored in the channel sub-key storage unit <highlight><bold>508</bold></highlight> is deleted (step S<highlight><bold>137</bold></highlight>). </paragraph>
<paragraph id="P-0205" lvl="0"><number>&lsqb;0205&rsqb;</number> As shown in the flow chart of <cross-reference target="DRAWINGS">FIG. 18</cross-reference>, the channel decoder <highlight><bold>509</bold></highlight> extracts the channel sub-key L from a packet transferred from the filter <highlight><bold>503</bold></highlight> (step S<highlight><bold>141</bold></highlight> to S<highlight><bold>142</bold></highlight>), reads out the channel sub-key H from the channel sub-key storage unit <highlight><bold>508</bold></highlight> (step S<highlight><bold>143</bold></highlight>), and generates the channel key Kch (step S<highlight><bold>144</bold></highlight>). When the channel sub-key H in the channel sub-key storage unit <highlight><bold>508</bold></highlight> is already deleted at the step S<highlight><bold>137</bold></highlight>, the processing is terminated. </paragraph>
<paragraph id="P-0206" lvl="0"><number>&lsqb;0206&rsqb;</number> The algorithm for generating the channel key Kch from the channel sub-keys H and L is stored in advance in the channel decoder <highlight><bold>509</bold></highlight>. </paragraph>
<paragraph id="P-0207" lvl="0"><number>&lsqb;0207&rsqb;</number> After generating the channel key Kch, the channel decoder <highlight><bold>509</bold></highlight> decrypts the encrypted contents information, which is extracted from the packet transferred from the filter <highlight><bold>503</bold></highlight>, using that channel key Kch (step S<highlight><bold>145</bold></highlight>), and sequentially outputs the decrypted contents information to a D/A converter <highlight><bold>510</bold></highlight> (step S<highlight><bold>146</bold></highlight>). </paragraph>
<paragraph id="P-0208" lvl="0"><number>&lsqb;0208&rsqb;</number> The D/A converter <highlight><bold>510</bold></highlight> converts the contents information transferred from the channel decoder <highlight><bold>509</bold></highlight> into analog signals (step S<highlight><bold>147</bold></highlight>), and the reproduction of the analog signals is carried out at a reproduction unit <highlight><bold>511</bold></highlight> (step S<highlight><bold>148</bold></highlight>). </paragraph>
<paragraph id="P-0209" lvl="0"><number>&lsqb;0209&rsqb;</number> From a viewpoint of preventing the improper viewing or listening based on the cryptoanalysis, it is preferable to update the encryption key regularly. For example, the channel key Kch can be changed easily by changing the channel sub-key L that is delivered in a form of being multiplexed in the broadcast waves. Of course, in this case, the contents information of that channel must be encrypted in such a way that it can be decrypted using the new channel key Kch. Note that there can be cases where the channel sub-key L is not to be delivered in a form of being multiplexed in the broadcast waves. In such cases, it will be set such that the channel key Kch&equals;the channel sub-key H. </paragraph>
<paragraph id="P-0210" lvl="0"><number>&lsqb;0210&rsqb;</number> Now, after receiving the appending information for permitting viewing or listening, the reception device <highlight><bold>100</bold></highlight> is capable of viewing or listening programs of the contracted channel until the appending information for prohibiting viewing or listening is received. There can be cases where the user refuses to receive the appending information for prohibiting viewing or listening despite of the fact that the contract for viewing or listening programs of that channel has been cancelled. This can be the case when the power of the reception device is cut off for a certain period of time. For this reason, there is a need to broadcast the appending information for prohibiting viewing or listening (OFF signal) repeatedly over a certain period of time after the contract cancellation. </paragraph>
<paragraph id="P-0211" lvl="0"><number>&lsqb;0211&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 19</cross-reference> shows a change in time of an amount of the appending information regarding new contracts (ON signal) to be transmitted and an amount of the appending information regarding cancellation (OFF signal) to be transmitted. A sum of the amount of the appending information regarding new contracts (ON signal) to be transmitted and the amount of the appending information regarding cancellation (OFF signal) to be transmitted gives a total amount of the appending information to be transmitted. It can be seen that the amount of the appending information regarding new contracts is bursty depending on the number of contracts, whereas the amount of the appending information regarding cancellation changes as an integrated value of the number of cancelled contracts over time. </paragraph>
<paragraph id="P-0212" lvl="0"><number>&lsqb;0212&rsqb;</number> Both the transmission of the appending information regarding new contracts and the transmission of the appending information regarding cancellation lack a guarantee for being surely received by the target reception device. Consequently, it is necessary to broadcast them repeatedly. </paragraph>
<paragraph id="P-0213" lvl="0"><number>&lsqb;0213&rsqb;</number> As described above, when the contract management device provided at the broadcast station side delivers the appending information that functions as the ON signal or the OFF signal, it suffices to deliver the appending information several times repeatedly only at a time of new subscription and at a time of cancellation so that it is possible to reduce the amount of contract management information to be transmitted considerably compared with the scheme for transmitting as many contract data as the number of all the subscribing terminals whenever the contracts are renewed (every month, for example). Consequently, it is possible to increase the amount of transmission of the channel contents information. </paragraph>
<paragraph id="P-0214" lvl="0"><number>&lsqb;0214&rsqb;</number> (3-2) </paragraph>
<paragraph id="P-0215" lvl="0"><number>&lsqb;0215&rsqb;</number> When the multiplexed appending information is removed from the received broadcast waves at the reception device <highlight><bold>100</bold></highlight> in some way, there can be cases where the improper viewing or listening becomes possible by avoiding the reception of the appending information for prohibiting viewing or listening (OFF signal). In order to cope with such improper conducts, the contract management device provided at the broadcast station is set to always transmit the appending information in a form of being multiplexed at interval of a prescribed number of packets. </paragraph>
<paragraph id="P-0216" lvl="0"><number>&lsqb;0216&rsqb;</number> When there is no appending information to be transmitted, a dummy appending information may be transmitted. In such a case, the filter <highlight><bold>503</bold></highlight> of the reception device <highlight><bold>100</bold></highlight> is also equipped with a counter (packet counter) for counting the number of packets, which is reset whenever the appending information arrives. When the counter value becomes greater than a prescribed value N, it is judged as abnormal state and the processing stopping operation such as stopping of the filtering operation is carried out. </paragraph>
<paragraph id="P-0217" lvl="0"><number>&lsqb;0217&rsqb;</number> The flow chart of <cross-reference target="DRAWINGS">FIG. 20</cross-reference> shows an exemplary operation in the case where the filter <highlight><bold>503</bold></highlight> of the reception device <highlight><bold>100</bold></highlight> also carries out the above described processing for monitoring a reception state of the appending information. In <cross-reference target="DRAWINGS">FIG. 20, a</cross-reference> variable &ldquo;count&rdquo; denotes the packet count value. </paragraph>
<paragraph id="P-0218" lvl="0"><number>&lsqb;0218&rsqb;</number> First, the filter <highlight><bold>503</bold></highlight> initializes the packet counter. Namely, the variable &ldquo;count&rdquo; is set to &ldquo;0&rdquo; (step S<highlight><bold>151</bold></highlight>). The filter <highlight><bold>503</bold></highlight> then checks the flag information contained in each packet sequentially entered from the A/D converter <highlight><bold>502</bold></highlight>. </paragraph>
<paragraph id="P-0219" lvl="0"><number>&lsqb;0219&rsqb;</number> When it is judged that the entered packet contains the appending information according to the flag of that packet (step S<highlight><bold>153</bold></highlight>), the packet counter value is reset to &ldquo;0&rdquo; (step S<highlight><bold>154</bold></highlight>) and this packet is added to the buffer for the appending information, and when the end flag is detected in the flag of the sequentially entered packet, the packets stored in the buffer for the appending information up until then are transferred to the judgement unit <highlight><bold>507</bold></highlight> (step S<highlight><bold>155</bold></highlight> to S<highlight><bold>157</bold></highlight>). </paragraph>
<paragraph id="P-0220" lvl="0"><number>&lsqb;0220&rsqb;</number> When it is judged that the entered packet does not contain the appending information according to the flag of that packet (step S<highlight><bold>153</bold></highlight>), the packet counter value is incremented by one (step S<highlight><bold>158</bold></highlight>). Then, when the packet counter value becomes greater than the prescribed value N, it is judged as abnormal packet reception state and the processing stopping operation such as stopping of the filtering operation is carried out (step S<highlight><bold>160</bold></highlight>). </paragraph>
<paragraph id="P-0221" lvl="0"><number>&lsqb;0221&rsqb;</number> On the other hand, when the packet counter value is less than the prescribed value N at the step S<highlight><bold>159</bold></highlight>, the subsequent processing is executed. </paragraph>
<paragraph id="P-0222" lvl="0"><number>&lsqb;0222&rsqb;</number> Namely, when it is judged that the entered packet contains the master key seed according to the flag of that packet (step S<highlight><bold>161</bold></highlight>), this packet is added to the buffer for the master key seed, and when the end flag is detected in the flag of the sequentially entered packet, the packets stored in the buffer for the master key seed up until then are transferred to the master key generation unit <highlight><bold>504</bold></highlight> (step S<highlight><bold>162</bold></highlight> to S<highlight><bold>164</bold></highlight>). </paragraph>
<paragraph id="P-0223" lvl="0"><number>&lsqb;0223&rsqb;</number> Also, when it is judged that the entered packet contains the contents information and the channel sub-key L according to the flag of that packet, this packet is transferred to the channel decoder <highlight><bold>509</bold></highlight> (step S<highlight><bold>165</bold></highlight>). </paragraph>
<paragraph id="P-0224" lvl="0"><number>&lsqb;0224&rsqb;</number> The broadcast station changes the channel sub-key H or the master key regularly (or at appropriate timings). The channel sub-key H is a (component of) key used in encrypting the channel contents information, so that when the channel sub-key H is changed, the encryption of the channel contents information will also be changed. For the reception device which continues to have the reception contract, the appending information containing the corresponding terminal ID, the channel number, and the corresponding channel sub-key H is generated and delivered by broadcast. </paragraph>
<paragraph id="P-0225" lvl="0"><number>&lsqb;0225&rsqb;</number> The change of the master key is carried out from a viewpoint of the security rather than the contract management. The change of the master key is done by delivering the master key seed by broadcast. At a time of changing the master key, it is preferable to change the channel sub-key H at the same time. </paragraph>
<paragraph id="P-0226" lvl="0"><number>&lsqb;0226&rsqb;</number> (3-3) </paragraph>
<paragraph id="P-0227" lvl="0"><number>&lsqb;0227&rsqb;</number> Here, the broadcast waves to be received at the reception device <highlight><bold>100</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 14</cross-reference> are assumed to contain the following information. </paragraph>
<paragraph id="P-0228" lvl="2"><number>&lsqb;0228&rsqb;</number> Master key seed </paragraph>
<paragraph id="P-0229" lvl="2"><number>&lsqb;0229&rsqb;</number> &lsqb;Terminal Appending&rsqb;Km: </paragraph>
<paragraph id="P-0230" lvl="2"><number>&lsqb;0230&rsqb;</number> &lsqb;Channel Appending&rsqb;Km </paragraph>
<paragraph id="P-0231" lvl="2"><number>&lsqb;0231&rsqb;</number> &lsqb;Contents&rsqb;Kch </paragraph>
<paragraph id="P-0232" lvl="0"><number>&lsqb;0232&rsqb;</number> The terminal related appending information is an appending information unique to each contracting user, which contains at least the following information. </paragraph>
<paragraph id="P-0233" lvl="2"><number>&lsqb;0233&rsqb;</number> Terminal ID </paragraph>
<paragraph id="P-0234" lvl="2"><number>&lsqb;0234&rsqb;</number> Channel numbers </paragraph>
<paragraph id="P-0235" lvl="2"><number>&lsqb;0235&rsqb;</number> Valid/invalid information </paragraph>
<paragraph id="P-0236" lvl="0"><number>&lsqb;0236&rsqb;</number> In the case where there is only one contracted channel, it is not absolutely necessary to include the channel number. </paragraph>
<paragraph id="P-0237" lvl="0"><number>&lsqb;0237&rsqb;</number> The channel related appending information contains at least the following information. </paragraph>
<paragraph id="P-0238" lvl="2"><number>&lsqb;0238&rsqb;</number> Channel numbers </paragraph>
<paragraph id="P-0239" lvl="2"><number>&lsqb;0239&rsqb;</number> Channel key </paragraph>
<paragraph id="P-0240" lvl="0"><number>&lsqb;0240&rsqb;</number> Note that the channel related appending information may also contain the channel key ID for identifying the channel key. </paragraph>
<paragraph id="P-0241" lvl="0"><number>&lsqb;0241&rsqb;</number> Next, with references to the flow charts of <cross-reference target="DRAWINGS">FIG. 21</cross-reference> to <cross-reference target="DRAWINGS">FIG. 23</cross-reference>, the processing of the reception device of <cross-reference target="DRAWINGS">FIG. 14</cross-reference> will be described in further detail. </paragraph>
<paragraph id="P-0242" lvl="0"><number>&lsqb;0242&rsqb;</number> First, in <cross-reference target="DRAWINGS">FIG. 21</cross-reference>, when the reception unit <highlight><bold>501</bold></highlight> receives the broadcast waves, the A/D converter <highlight><bold>502</bold></highlight> converts them into digital signals, assembles packets from information contained in these signals and outputs them to the filter <highlight><bold>503</bold></highlight> (steps S<highlight><bold>101</bold></highlight> to S<highlight><bold>102</bold></highlight>). </paragraph>
<paragraph id="P-0243" lvl="0"><number>&lsqb;0243&rsqb;</number> Each packet has a flag information that enables to distinguish whether that packet is a packet containing the master key seed, a packet containing the terminal related appending information or the channel related appending information, or a packet containing the contents information. In addition, the last packet for the master key seed, the terminal related appending information and the channel related appending information has an end flag recorded therein. </paragraph>
<paragraph id="P-0244" lvl="0"><number>&lsqb;0244&rsqb;</number> The filter <highlight><bold>503</bold></highlight> has sufficiently large buffers for the master key seed, the terminal related appending information and the channel related appending information respectively. </paragraph>
<paragraph id="P-0245" lvl="0"><number>&lsqb;0245&rsqb;</number> When it is judged that the entered packet contains the master key seed according to the flag of that packet, this packet is added to the buffer for the master key seed, and when the end flag is detected in the flag of the sequentially entered packet, the packets stored in the buffer for the master key seed up until then are transferred to the master key generation unit <highlight><bold>504</bold></highlight> (step S<highlight><bold>103</bold></highlight> to S<highlight><bold>106</bold></highlight>). </paragraph>
<paragraph id="P-0246" lvl="0"><number>&lsqb;0246&rsqb;</number> When it is judged that the entered packet contains the terminal related appending information according to the flag of that packet, this packet is added to the buffer for the terminal related appending information, and when the end flag is detected in the flag of the sequentially entered packet, the packets stored in the buffer for the terminal related appending information up until then are transferred to the Judgement unit <highlight><bold>507</bold></highlight> (step S<highlight><bold>171</bold></highlight> to S<highlight><bold>174</bold></highlight>). </paragraph>
<paragraph id="P-0247" lvl="0"><number>&lsqb;0247&rsqb;</number> When it is judged that the entered packet contains the channel related appending information according to the flag of that packet, this packet is added to the buffer for the channel related appending information, and when the end flag is detected in the flag of the sequentially entered packet, the packets stored in the buffer for the channel related appending information up until then are transferred to the Judgement unit <highlight><bold>507</bold></highlight> (step S<highlight><bold>175</bold></highlight> to S<highlight><bold>178</bold></highlight>). </paragraph>
<paragraph id="P-0248" lvl="0"><number>&lsqb;0248&rsqb;</number> When it is judged that the entered packet contains the contents information according to the flag of that packet, this packet is transferred to the channel decoder <highlight><bold>509</bold></highlight> (step S<highlight><bold>111</bold></highlight>). </paragraph>
<paragraph id="P-0249" lvl="0"><number>&lsqb;0249&rsqb;</number> The master key generation unit <highlight><bold>504</bold></highlight> carries out the processing according to the flow chart of <cross-reference target="DRAWINGS">FIG. 16</cross-reference> described above. </paragraph>
<paragraph id="P-0250" lvl="0"><number>&lsqb;0250&rsqb;</number> As shown in the flow chart of <cross-reference target="DRAWINGS">FIG. 22</cross-reference>, upon receiving the packets from the filter <highlight><bold>503</bold></highlight>, the Judgement unit <highlight><bold>507</bold></highlight> first reads out the master key Km from the master key storage unit <highlight><bold>505</bold></highlight>, and then decrypts the appending information extracted from these packets using the master key Km (steps S<highlight><bold>181</bold></highlight> to S<highlight><bold>183</bold></highlight>). </paragraph>
<paragraph id="P-0251" lvl="0"><number>&lsqb;0251&rsqb;</number> When it is judged that the entered packet contains the terminal related appending information according to the flag of that packet, the Judgement unit <highlight><bold>507</bold></highlight> extracts the terminal ID from the terminal related appending information, compares it with the own terminal ID that is stored in advance in the ID storage unit <highlight><bold>506</bold></highlight>, and executes the subsequent processing from the step S<highlight><bold>186</bold></highlight> on only when they coincide. When they do not coincide, the processing is stopped (step S<highlight><bold>185</bold></highlight>). </paragraph>
<paragraph id="P-0252" lvl="0"><number>&lsqb;0252&rsqb;</number> At the step S<highlight><bold>186</bold></highlight>, the channel number and the corresponding valid/invalid information are extracted from the terminal related appending information, and if the channel number is indicated as &ldquo;valid&rdquo;, the processing proceeds to the step S<highlight><bold>187</bold></highlight> where it is controlled to be capable of carrying out the decryption/reproduction of the contents information of that channel. To this end, it is possible to provide an array information for the purpose of controlling ON/OFF of respective channels, and set a value &ldquo;1&rdquo; for the channel when that channel is indicated as &ldquo;valid&rdquo;. Also, if the channel number is indicated as &ldquo;invalid&rdquo;, the processing proceeds to the step S<highlight><bold>188</bold></highlight> where it is controlled to be incapable of carrying out the decryption/reproduction of the contents information of that channel. For example, a value &ldquo;0&rdquo; is set for that channel in the above described array information. </paragraph>
<paragraph id="P-0253" lvl="0"><number>&lsqb;0253&rsqb;</number> When it is Judged that the entered packet contains the channel related appending information according to the flag of that packet, the Judgement unit <highlight><bold>507</bold></highlight> extracts the channel key ID and the channel key from the channel related appending information, and stores them into the channel sub-key storage unit <highlight><bold>508</bold></highlight> in correspondence to that channel number. </paragraph>
<paragraph id="P-0254" lvl="0"><number>&lsqb;0254&rsqb;</number> As shown in the flow chart of <cross-reference target="DRAWINGS">FIG. 23</cross-reference>, the channel decoder <highlight><bold>509</bold></highlight> extracts the contents information from a packet transferred from the filter <highlight><bold>503</bold></highlight>, decrypts it using the channel key extracted earlier, and outputs it to the D/A converter <highlight><bold>510</bold></highlight> (steps S<highlight><bold>191</bold></highlight> to S<highlight><bold>194</bold></highlight>). </paragraph>
<paragraph id="P-0255" lvl="0"><number>&lsqb;0255&rsqb;</number> The D/A converter <highlight><bold>510</bold></highlight> converts the contents information transferred from the channel decoder <highlight><bold>509</bold></highlight> into analog signals (step S<highlight><bold>195</bold></highlight>), and the reproduction of the analog signals is carried out at the reproduction unit <highlight><bold>511</bold></highlight> (step S<highlight><bold>196</bold></highlight>). </paragraph>
<paragraph id="P-0256" lvl="0"><number>&lsqb;0256&rsqb;</number> As described above, the channel related appending information is common to all the reception devices, and the terminal related appending information becomes shorter compared with the appending information containing the channel (sub-)key, so that it becomes possible to save the broadcast bandwidth necessary in delivering the contract control information as the appending information. </paragraph>
<paragraph id="P-0257" lvl="0"><number>&lsqb;0257&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 24</cross-reference> to <cross-reference target="DRAWINGS">FIG. 30</cross-reference>, the second embodiment of a conditional access broadcast system according to the present invention will be described in detail. </paragraph>
<paragraph id="P-0258" lvl="7"><number>&lsqb;0258&rsqb;</number> (1) Overview of the Broadcast System: </paragraph>
<paragraph id="P-0259" lvl="0"><number>&lsqb;0259&rsqb;</number> Instead of delivering the appending information to the contracting reception devices by broadcast, it is also possible to deliver the appending information as shown in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>. </paragraph>
<paragraph id="P-0260" lvl="0"><number>&lsqb;0260&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 24</cross-reference> shows a schematic configuration of the broadcast system using the contract management device and the broadcast reception device according to the second embodiment, for an exemplary form of service in which contents are to be provided to a reception device <highlight><bold>100</bold></highlight> of each user who has the reception contract, from a broadcast station <highlight><bold>200</bold></highlight> through a satellite. </paragraph>
<paragraph id="P-0261" lvl="0"><number>&lsqb;0261&rsqb;</number> This second embodiment of <cross-reference target="DRAWINGS">FIG. 24</cross-reference> differs from the first embodiment in that, instead of delivering the appending information for the contract management to each contracting user by broadcast, the appending information is recorded in a portable card shaped recording medium (referred to simply as a card hereafter) P such as a magnetic card for example, and this card P is delivered by the home delivery service or the mail to the user. The contracting user can receive the contracted channels by operating the reception device <highlight><bold>100</bold></highlight> to read the information recorded in the received card P. </paragraph>
<paragraph id="P-0262" lvl="7"><number>&lsqb;0262&rsqb;</number> (2) Contract Management Device: </paragraph>
<paragraph id="P-0263" lvl="0"><number>&lsqb;0263&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 25</cross-reference> shows an exemplary configuration of a contract management device according to this second embodiment, where the elements identical to those in <cross-reference target="DRAWINGS">FIG. 3</cross-reference> are given the same reference numerals and their description will be omitted. In <cross-reference target="DRAWINGS">FIG. 25</cross-reference>, the broadcast device <highlight><bold>13</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is replaced by a card production unit <highlight><bold>15</bold></highlight>, such that the appending information is recorded in a card shaped recording medium (card) such as magnetic card, IC card, etc., and this card is delivered to the contracting user, rather than delivering the appending information through the terrestrial or satellite broadcast. </paragraph>
<paragraph id="P-0264" lvl="0"><number>&lsqb;0264&rsqb;</number> When the command from the appending information generation control unit <highlight><bold>9</bold></highlight> is &ldquo;send an appending information for contracting users who have the contract for four months from Dec. 1, 1997&rdquo;, it is necessary in the contract management device of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> described above to produce the appending information every month so that it is necessary to retrieve the valid channel key and the valid master key and carry out the processing of the flow chart of <cross-reference target="DRAWINGS">FIG. 8</cross-reference> every month. In contrast, in the contract management device of <cross-reference target="DRAWINGS">FIG. 25</cross-reference>, it suffices to write the appending information corresponding to the channel keys of the contracted channels for coming four months in the magnetic card for example and deliver the card to the user, without using the broadcasting. In this way, it becomes unnecessary to deliver the appending information every month so that it is convenient for both the broadcast station side and the user side in a sense that tediousness can be reduced. </paragraph>
<paragraph id="P-0265" lvl="7"><number>&lsqb;0265&rsqb;</number> (3) Reception Device: </paragraph>
<paragraph id="P-0266" lvl="0"><number>&lsqb;0266&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 26</cross-reference> shows an exemplary configuration of the reception device <highlight><bold>100</bold></highlight> according to this second embodiment, which reads out the appending information from the card produced by the contract management device provided at the broadcast station side as shown in <cross-reference target="DRAWINGS">FIG. 25</cross-reference> and receives broadcast waves outputted from the contents information delivery device as shown in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>. </paragraph>
<paragraph id="P-0267" lvl="0"><number>&lsqb;0267&rsqb;</number> Here, the broadcast waves to be received at the reception device <highlight><bold>100</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 26</cross-reference> are assumed to contain the following information. </paragraph>
<paragraph id="P-0268" lvl="2"><number>&lsqb;0268&rsqb;</number> Master key seed </paragraph>
<paragraph id="P-0269" lvl="2"><number>&lsqb;0269&rsqb;</number> Channel sub-key L </paragraph>
<paragraph id="P-0270" lvl="2"><number>&lsqb;0270&rsqb;</number> Channel sub-key ID </paragraph>
<paragraph id="P-0271" lvl="2"><number>&lsqb;0271&rsqb;</number> &lsqb;Contents&rsqb;Kch </paragraph>
<paragraph id="P-0272" lvl="0"><number>&lsqb;0272&rsqb;</number> The channel sub-key ID is an ID for identifying the channel sub-key contained in the appending information, and it is unnecessary when the change of the channel sub-key always takes place in conjunction with the change of the master key. </paragraph>
<paragraph id="P-0273" lvl="0"><number>&lsqb;0273&rsqb;</number> In the card P, the appending information encrypted using the master key is recorded. </paragraph>
<paragraph id="P-0274" lvl="0"><number>&lsqb;0274&rsqb;</number> The appending information is assumed to contain the following information. </paragraph>
<paragraph id="P-0275" lvl="2"><number>&lsqb;0275&rsqb;</number> Terminal ID: </paragraph>
<paragraph id="P-0276" lvl="2"><number>&lsqb;0276&rsqb;</number> Channel number (or channel numbers) </paragraph>
<paragraph id="P-0277" lvl="2"><number>&lsqb;0277&rsqb;</number> Channel sub-key ID </paragraph>
<paragraph id="P-0278" lvl="2"><number>&lsqb;0278&rsqb;</number> Channel sub-key H </paragraph>
<paragraph id="P-0279" lvl="0"><number>&lsqb;0279&rsqb;</number> Note that the appending information may also contain an authentication code (which may be given by appropriate prescribed bit sequence, for example) for the purpose of judging whether the decryption using the master key has been carried out correctly or not at the judgement unit <highlight><bold>507</bold></highlight>. </paragraph>
<paragraph id="P-0280" lvl="0"><number>&lsqb;0280&rsqb;</number> The appending information recorded in the card P may not necessarily be one, and a plurality of appending information with different channel sub-keys H and the encryption keys may be recorded in the case where the contract period extends over plural update timings for the master key or the channel sub-key H. </paragraph>
<paragraph id="P-0281" lvl="0"><number>&lsqb;0281&rsqb;</number> <cross-reference target="DRAWINGS">FIGS. 27A and 27B</cross-reference> show examples of the appending information to be recorded in the card P. <cross-reference target="DRAWINGS">FIG. 27A</cross-reference> is for the case where the update timings for the master key Km and the channel sub-key H are the same (one month for example), while <cross-reference target="DRAWINGS">FIG. 27B</cross-reference> is for the case where the update timing for the master key Km is two months whereas the update timing for the channel sub-key H is one month, for example, and both show the appending information to be recorded in the card P when the user made contract for viewing or listening two channels (channels X and Y) for three months, </paragraph>
<paragraph id="P-0282" lvl="0"><number>&lsqb;0282&rsqb;</number> When the update timings for the master key Km and the channel sub-key H are the same as shown in <cross-reference target="DRAWINGS">FIG. 27</cross-reference>A, the card records three appending information each containing the channel sub-key H of each channel for each month which is encrypted using the master key Km of each month. In this case, there is only one channel sub-key H for each channel, so that the channel sub-key ID is not absolutely necessary. </paragraph>
<paragraph id="P-0283" lvl="0"><number>&lsqb;0283&rsqb;</number> When the update timings for the master key Km and the channel sub-key H are different as shown in <cross-reference target="DRAWINGS">FIG. 27</cross-reference>B, the appending information generated by being encrypted using one master key may record plural channel sub-keys (for two months for example) for each channel depending on the contract period. In such a case, each channel sub-key is identified by the channel sub-key ID. </paragraph>
<paragraph id="P-0284" lvl="0"><number>&lsqb;0284&rsqb;</number> Note that in either case of <cross-reference target="DRAWINGS">FIG. 27</cross-reference>A and <cross-reference target="DRAWINGS">FIG. 27</cross-reference>B, the information unit to be encrypted using one master key may contain an authentication code. </paragraph>
<paragraph id="P-0285" lvl="0"><number>&lsqb;0285&rsqb;</number> Next, with references to the flow charts of <cross-reference target="DRAWINGS">FIG. 28</cross-reference> to <cross-reference target="DRAWINGS">FIG. 30</cross-reference>, the processing of the reception device of <cross-reference target="DRAWINGS">FIG. 26</cross-reference> will be described in further detail. Here, the case where the appending information recorded in the card P is as shown in <cross-reference target="DRAWINGS">FIG. 27B</cross-reference> will be described as an example. </paragraph>
<paragraph id="P-0286" lvl="0"><number>&lsqb;0286&rsqb;</number> First, in <cross-reference target="DRAWINGS">FIG. 28</cross-reference>, the user inserts the card P delivered from the broadcast station side into a card reader <highlight><bold>513</bold></highlight>. The card reader <highlight><bold>513</bold></highlight> then reads out the appending information from the inserted card P, and stores it into an appending information storage unit <highlight><bold>512</bold></highlight> (step S<highlight><bold>201</bold></highlight>). </paragraph>
<paragraph id="P-0287" lvl="0"><number>&lsqb;0287&rsqb;</number> Next, in <cross-reference target="DRAWINGS">FIG. 29</cross-reference>, when a reception unit <highlight><bold>501</bold></highlight> receives the broadcast waves, an A/D converter <highlight><bold>502</bold></highlight> converts them into digital signals, assembles packets from information contained in these signals and outputs them to a filter <highlight><bold>503</bold></highlight> (steps S<highlight><bold>101</bold></highlight> to S<highlight><bold>102</bold></highlight>). </paragraph>
<paragraph id="P-0288" lvl="0"><number>&lsqb;0288&rsqb;</number> Each packet has a flag information that enables to distinguish whether that packet is a packet containing the master key seed, a packet containing the channel sub-key ID, or a packet containing the contents information. In addition, the last packet for the master key seed has an end flag recorded therein. </paragraph>
<paragraph id="P-0289" lvl="0"><number>&lsqb;0289&rsqb;</number> The filter <highlight><bold>503</bold></highlight> has sufficiently large buffers for the master key seed and the appending information respectively. </paragraph>
<paragraph id="P-0290" lvl="0"><number>&lsqb;0290&rsqb;</number> When it is judged that the entered packet contains the master key seed according to the flag of that packet, this packet is added to the buffer for the master key seed, and when the end flag is detected in the flag of the sequentially entered packet, the packets stored in the buffer for the master key seed up until then are transferred to a master key generation unit <highlight><bold>504</bold></highlight> (step S<highlight><bold>103</bold></highlight> to S<highlight><bold>106</bold></highlight>). </paragraph>
<paragraph id="P-0291" lvl="0"><number>&lsqb;0291&rsqb;</number> When it is judged that the entered packet contains the channel sub-key ID according to the flag of that packet, this packet is outputted to the judgement unit <highlight><bold>507</bold></highlight> (steps S<highlight><bold>211</bold></highlight> to S<highlight><bold>213</bold></highlight>). </paragraph>
<paragraph id="P-0292" lvl="0"><number>&lsqb;0292&rsqb;</number> When it is judged that the entered packet is other than the above two according to the flag of that packet, that is, when it is judged that the entered packet contains the contents information and the channel sub-key L according to the flag of that packet, this packet is transferred to the channel decoder <highlight><bold>509</bold></highlight> (step S<highlight><bold>213</bold></highlight>). </paragraph>
<paragraph id="P-0293" lvl="0"><number>&lsqb;0293&rsqb;</number> The processing of the master key generation unit <highlight><bold>504</bold></highlight> is the same as that of the flow chart of <cross-reference target="DRAWINGS">FIG. 16</cross-reference> described above. </paragraph>
<paragraph id="P-0294" lvl="0"><number>&lsqb;0294&rsqb;</number> Next, the judgement unit <highlight><bold>507</bold></highlight> carries out the processing as shown in the flow chart of <cross-reference target="DRAWINGS">FIG. 30</cross-reference>. Here the appending information recorded in the card P is not necessarily one so that a variable &ldquo;i&rdquo; is used as an index for a plurality of appending information recorded in the card P, and each appending information is regarded as a valid appending information upon checking the authentication code for judging whether the decryption using the master key has been carried out correctly or not, which is contained in each appending information. </paragraph>
<paragraph id="P-0295" lvl="0"><number>&lsqb;0295&rsqb;</number> First, the variable &ldquo;i&rdquo; is set to a value &ldquo;0&rdquo; (step S<highlight><bold>221</bold></highlight>), and the appending information stored in the appending information storage unit <highlight><bold>512</bold></highlight> is read out one by one (steps S<highlight><bold>222</bold></highlight> and S<highlight><bold>223</bold></highlight>). Then, the master key Km stored in the master key storage unit <highlight><bold>505</bold></highlight> is read out (step S<highlight><bold>224</bold></highlight>) and the appending information is decrypted using the master key Km (step S<highlight><bold>225</bold></highlight>). When the authentication code is contained in the decrypted appending information, whether that authentication code is a correct one or not is checked (step S<highlight><bold>226</bold></highlight>). </paragraph>
<paragraph id="P-0296" lvl="0"><number>&lsqb;0296&rsqb;</number> When the authentication code is a correct one, it can be judged that it is a valid appending information that has been decrypted using the proper master key within the contract period. Consequently, the judgement processing subsequent to the step S<highlight><bold>228</bold></highlight> is executed according to this appending information. On the other hand, when the authentication code is an incorrect one, the variable &ldquo;i&rdquo; is incremented by one (step S<highlight><bold>227</bold></highlight>) and the steps S<highlight><bold>222</bold></highlight> to S<highlight><bold>226</bold></highlight> are repeated by reading the next appending information stored in the appending information storage unit <highlight><bold>512</bold></highlight>. </paragraph>
<paragraph id="P-0297" lvl="0"><number>&lsqb;0297&rsqb;</number> At the step S<highlight><bold>228</bold></highlight>, the terminal ID is extracted from the appending information, compared with the own terminal ID that is stored in advance in an ID storage unit <highlight><bold>506</bold></highlight>, and the subsequent processing is executed only when they coincide. When they do not coincide, the processing is stopped. </paragraph>
<paragraph id="P-0298" lvl="0"><number>&lsqb;0298&rsqb;</number> Next, the channel sub-key ID for each channel is extracted from the packet transferred from the filter <highlight><bold>503</bold></highlight>, and the channel sub-key ID for each channel is taken out from the appending information one by one, and they are compared (step S<highlight><bold>229</bold></highlight>). When they coincide, the channel sub-key H corresponding to that channel sub-key ID is extracted from the appending information and stored into the channel sub-key storage unit <highlight><bold>508</bold></highlight> (step S<highlight><bold>231</bold></highlight>). When they do not coincide, the next channel sub-key ID of that channel number is taken out from the appending information and compared with the channel sub-key ID extracted from the packet earlier (steps S<highlight><bold>229</bold></highlight> and S<highlight><bold>230</bold></highlight>). </paragraph>
<paragraph id="P-0299" lvl="0"><number>&lsqb;0299&rsqb;</number> The processing of the channel decoder <highlight><bold>509</bold></highlight>, the D/A converter <highlight><bold>510</bold></highlight> and the reproduction unit <highlight><bold>511</bold></highlight> is the same as that of the flow chart of <cross-reference target="DRAWINGS">FIG. 18</cross-reference> described above. </paragraph>
<paragraph id="P-0300" lvl="0"><number>&lsqb;0300&rsqb;</number> At this point, the terms used in the following description will be defined. </paragraph>
<paragraph id="P-0301" lvl="0"><number>&lsqb;0301&rsqb;</number> An information describing a contract state of each channel in order to realize the conditional access will be referred to as a contract information. For example, the channel number is assigned to each channel, and the contract state of the channel can be expressed according to whether a bit corresponding to the channel number is &ldquo;1&rdquo; or not. This form of the contract information will be specifically referred to as a channel contract information. </paragraph>
<paragraph id="P-0302" lvl="0"><number>&lsqb;0302&rsqb;</number> Besides this, the contract information can be given in a variety of forms. For example, a set of the channel sub-key H and the channel number as shown in <cross-reference target="DRAWINGS">FIG. 11B</cross-reference> can be regarded as the contract information indicating that the channel of that channel number is covered by the contract, and a set of the channel number and the valid/invalid information as shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference> can be regarded as the contract information indicating the contract state of that channel number. </paragraph>
<paragraph id="P-0303" lvl="0"><number>&lsqb;0303&rsqb;</number> The contract information and the reception device ID are mutually linked together, and the reception device ID indicates an identifier of the reception device to which the linked contract information applies. In this sense, the contract information and the reception device ID can be regarded as a single entity so that a set of the reception device ID and the contract information may be simply referred to as the contract information. Hereafter, when there is a need to distinguish these two, the former will be referred to as the contract information in a narrow sense, and the latter will be referred to as the contract information in a broad sense. </paragraph>
<paragraph id="P-0304" lvl="0"><number>&lsqb;0304&rsqb;</number> Also, in the following embodiments, the contract information (a set of the contract information and the reception device ID) is delivered by broadcast in an encrypted form, or recorded in a recording medium such as magnetic card and delivered by mail (for the purpose of preventing the alteration or the elimination of disadvantageous contract information), and a data set to be encrypted together with the contract information here will be collectively referred to as a reception contract information. The contract information is contained in the reception contract information. In addition, the reception contract information appended with an information necessary for the present system such as data identifier will be referred to as a contract information packet. </paragraph>
<paragraph id="P-0305" lvl="0"><number>&lsqb;0305&rsqb;</number> The various embodiments of the present invention can be classified according to the levels by which the channel key and the contract information are separated. Namely, they can be distinguished according to how much of the channel key is to be contained in the reception contract information. </paragraph>
<paragraph id="P-0306" lvl="0"><number>&lsqb;0306&rsqb;</number> The first and second embodiments described above are directed to the case where a whole or a part of the channel key is to be contained in the reception contract information or the case where not a single bit of the channel key is to be contained in the reception contract information. </paragraph>
<paragraph id="P-0307" lvl="0"><number>&lsqb;0307&rsqb;</number> The third embodiment to be described below is directed to the case where a channel key decryption key for decrypting the encrypted channel key is to be contained in the reception contract information. </paragraph>
<paragraph id="P-0308" lvl="0"><number>&lsqb;0308&rsqb;</number> The fourth embodiment to be described below is directed to the case where the channel key itself is to be contained in the reception contract information. </paragraph>
<paragraph id="P-0309" lvl="0"><number>&lsqb;0309&rsqb;</number> The fifth embodiment to be described below is directed to a technique that is commonly applicable to the first to fourth embodiments, regarding a configuration of a latch unit for scan path test that is required for manufacturing purpose, in a charging control unit (charging chip). </paragraph>
<paragraph id="P-0310" lvl="0"><number>&lsqb;0310&rsqb;</number> Note that, in the following description of the third and subsequent embodiments, a constituent element for realizing a mechanism of the conditional access within the broadcast reception device will be referred to as a charging control unit. Here, the charging control unit is formed by hardware and preferably large scale integrated. Such as LSI charging control unit may also be referred to as a charging chip. In any case, the charging control unit contains secret information for the purpose of the conditional access, so that it is assumed to have a tamper resistant structure in which the internal memory and the hardware structure cannot be easily read, written or changed from the external. </paragraph>
<paragraph id="P-0311" lvl="0"><number>&lsqb;0311&rsqb;</number> Also, the master key common to all the broadcast reception devices is written in the internal memory of the charging control unit, and mainly used in decrypting the reception contract information. Also, the reception device ID is set up individually for each broadcast reception device, and recorded in a non-volatile memory inside the charging control unit. </paragraph>
<paragraph id="P-0312" lvl="0"><number>&lsqb;0312&rsqb;</number> These terms are related to the terms used in the first and second embodiments described above as follows. Namely, the reception contract information corresponds to the appending information of the first and second embodiments, the charging control unit corresponds to the decryption unit of the first and second embodiments, and the reception device ID corresponds to the terminal ID of the first and second embodiments. Also, the channel identifier and the information identifier used in the third and fourth embodiments correspond to the channel number and the flag information of the first and second embodiments, respectively. </paragraph>
<paragraph id="P-0313" lvl="0"><number>&lsqb;0313&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 31</cross-reference> to <cross-reference target="DRAWINGS">FIG. 50</cross-reference>, <cross-reference target="DRAWINGS">FIG. 68</cross-reference> to <cross-reference target="DRAWINGS">FIG. 70</cross-reference> and <cross-reference target="DRAWINGS">FIG. 72</cross-reference> to <cross-reference target="DRAWINGS">FIG. 78</cross-reference>, the third embodiment of a conditional access broadcast system according to the present invention will be described in detail. </paragraph>
<paragraph id="P-0314" lvl="7"><number>&lsqb;0314&rsqb;</number> (1) Broadcast Reception Device: </paragraph>
<paragraph id="P-0315" lvl="0"><number>&lsqb;0315&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 31</cross-reference> shows an exemplary configuration of a broadcast reception device according to this third embodiment. </paragraph>
<paragraph id="P-0316" lvl="0"><number>&lsqb;0316&rsqb;</number> The broadcast contents of this third embodiment is protected by the four stage encryption mechanism as shown in <cross-reference target="DRAWINGS">FIG. 32</cross-reference>. The channel key Kch is a key for descrambling the scrambled broadcast contents, which is different for each channel in general and changed in a short period of time. </paragraph>
<paragraph id="P-0317" lvl="0"><number>&lsqb;0317&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 33</cross-reference>, the broadcast waves contain two types of information (broadcast contents information, channel key information). Here, the broadcast contents are descrambled using the channel key Kch obtained from the channel key information. </paragraph>
<paragraph id="P-0318" lvl="0"><number>&lsqb;0318&rsqb;</number> Returning now to <cross-reference target="DRAWINGS">FIG. 32</cross-reference>, the channel key Kch contained in the channel key information is encrypted, and can be decrypted using the channel key decryption key K<highlight><subscript>H</subscript></highlight>. This channel key decryption key K<highlight><subscript>H </subscript></highlight>is not channel dependent and commonly used in the system, and contained in the encrypted reception contract information. </paragraph>
<paragraph id="P-0319" lvl="0"><number>&lsqb;0319&rsqb;</number> The encrypted reception contract information is decrypted using the master key KM which is commonly provided with respect to all the broadcast reception devices in advance. In addition, the master key K<highlight><subscript>H </subscript></highlight>is regularly changed according to the master key seed S<highlight><subscript>M</subscript></highlight>. </paragraph>
<paragraph id="P-0320" lvl="0"><number>&lsqb;0320&rsqb;</number> In order to descramble the scrambled broadcast waves, it is necessary to obtain the channel key Kch, and in order to obtain the channel key Kch, it is necessary to decrypt the encrypted channel key, where the decryption key K<highlight><subscript>H </subscript></highlight>is contained in the encrypted reception contract information. The encrypted reception contract information is decrypted using the master key K<highlight><subscript>M</subscript></highlight>. Also, the reception contract information decrypted using the master key contains the contract information in a narrow sense for each reception device in correspondence to the reception device ID, and the broadcast reception device obtains this upon judging that it is for the own broadcast reception device and stores it into the contract information storage unit. </paragraph>
<paragraph id="P-0321" lvl="0"><number>&lsqb;0321&rsqb;</number> At a time of receiving broadcast, the contract information in the contract information storage unit is referred, and the channel key Kch obtained as described above is sent to the descrambling unit only when that channel is the contracted one, so as to descramble the broadcast waves. </paragraph>
<paragraph id="P-0322" lvl="0"><number>&lsqb;0322&rsqb;</number> In such a system, it is necessary to obtain the channel key decryption key K<highlight><subscript>H </subscript></highlight>in order to obtain the channel key Kch, and further the contract information and the channel key decryption key K<highlight><subscript>H </subscript></highlight>become inseparable due to the encryption of the reception contract information, so that it becomes necessary to obtain the contract information in order to obtain the channel key decryption key K<highlight><subscript>H </subscript></highlight>and therefore it becomes possible to enforce the user to obey the contract faithfully. </paragraph>
<paragraph id="P-0323" lvl="0"><number>&lsqb;0323&rsqb;</number> Further details of this third embodiment will now be described. The channels received at the broadcast reception device of this third embodiment include an ordinary channel and a contract information channel, where the broadcast contents are usually transmitted through the ordinary channel in a structure shown in <cross-reference target="DRAWINGS">FIG. 33</cross-reference>. Here, the broadcast contents information can be divided into encrypted broadcast contents (C), a channel key identifier (KID), a channel identifier (CID), and an information identifier (IID) as shown in <cross-reference target="DRAWINGS">FIG. 34</cross-reference>. </paragraph>
<paragraph id="P-0324" lvl="0"><number>&lsqb;0324&rsqb;</number> Here the information identifier indicates that the corresponding information is the broadcast contents information, which may be given in a form of &ldquo;0001&rdquo;, for example. Also, the channel identifier is an information for identifying the channel to which the corresponding broadcast contents information belongs. Also, the channel key identifier is an information for identifying the channel key that can decrypt the corresponding encrypted broadcast contents information. Their usages and structures will be described in detail later. </paragraph>
<paragraph id="P-0325" lvl="0"><number>&lsqb;0325&rsqb;</number> On the other hand, the channel key information comprises encrypted channel key, a channel key identifier, a channel identifier, a channel key decryption key identifier, and an information identifier, as shown in <cross-reference target="DRAWINGS">FIG. 35</cross-reference>. </paragraph>
<paragraph id="P-0326" lvl="0"><number>&lsqb;0326&rsqb;</number> Here the channel key identifier is an information for identifying the corresponding channel key, which is utilized at a time of decrypting the encrypted contents. The channel identifier is an information for indicating the channel of the contents information that can be decrypted using the corresponding channel key. The channel key decryption key identifier is used in identifying the decryption key of the encrypted channel key. Their usages and structures will be described in detail later. The information identifier indicates that the corresponding information is the channel key information, which may be given in a form of &ldquo;0002&rdquo;, for example, in order to distinguish it from the other information such as the broadcast contents information. </paragraph>
<paragraph id="P-0327" lvl="0"><number>&lsqb;0327&rsqb;</number> The contract information channel has a structure as shown in <cross-reference target="DRAWINGS">FIG. 36</cross-reference>, which comprises a contract information packet and a master key seed. </paragraph>
<paragraph id="P-0328" lvl="0"><number>&lsqb;0328&rsqb;</number> Here, as shown in <cross-reference target="DRAWINGS">FIG. 37</cross-reference>, the contract information packet comprises an encrypted reception contract information, a channel key decryption key identifier, a master key identifier, and an information identifier. </paragraph>
<paragraph id="P-0329" lvl="0"><number>&lsqb;0329&rsqb;</number> The channel key decryption key identifier is an information for identifying the channel key decryption key that is contained in the corresponding reception contract information, which is used in identifying the decryption key at a time of decrypting the encrypted channel key. The master key identifier is used in identifying the master key that can decrypt the encrypted reception contract information contained in the corresponding contract information packet. The information identifier indicates that the corresponding information is the contract information packet, which may be given in a form of &ldquo;0003&rdquo;, for example. </paragraph>
<paragraph id="P-0330" lvl="0"><number>&lsqb;0330&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 38</cross-reference>, the reception contract information comprises a reception device ID, a channel contract information, and a channel key decryption key K<highlight><subscript>H</subscript></highlight>. The reception device ID is an identifier (ID) unique to the corresponding reception device, which is used in Judging whether the contract information for the corresponding reception device or not. The channel contract information indicates the contract state of the corresponding reception device by allocating one bit to each one of a plurality of channels that can be provided to the user, and setting &ldquo;1&rdquo; to the bit corresponding to the contracted channel of the user while setting &ldquo;0&rdquo; to the other bits. The channel key decryption key K<highlight><subscript>H </subscript></highlight>is a key for decrypting the channel key Kch. </paragraph>
<paragraph id="P-0331" lvl="0"><number>&lsqb;0331&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 39</cross-reference>, the master key seed information comprises a master key seed, a master key identifier, and an information identifier. The master key seed is a seed information for the purpose of generating the master key. The master key identifier is an identification information of the master key generated using the corresponding master key seed. The information identifier indicates that the corresponding information is the master key seed information, which may be given in a form of &ldquo;0004&rdquo;, for example. </paragraph>
<paragraph id="P-0332" lvl="0"><number>&lsqb;0332&rsqb;</number> Now, the role of the channel key identifier will be described. </paragraph>
<paragraph id="P-0333" lvl="0"><number>&lsqb;0333&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 34</cross-reference>, the broadcast contents information comprises the broadcast contents information C encrypted using the channel key, the channel key identifier KID, the channel identifier CID, and the information identifier IID. The channel key identifier KID indicates the channel key that is used in encrypting the encrypted broadcast contents information C, which is an identifier (ID) assigned uniquely to each channel key. In this case, the channel key for decrypting the scrambled broadcast contents can be determined uniquely. </paragraph>
<paragraph id="P-0334" lvl="0"><number>&lsqb;0334&rsqb;</number> However, in practical implementation, it is not clear as to how long the corresponding channel key should be maintained, and there is also a problem that the length of each ID becomes rather long in order to define each ID uniquely so that a large memory capacity will be required. For this reason, the scheme of assigning a relative ID of one bit length can be used here. Namely, one bit ID of either &ldquo;0&rdquo; or &ldquo;1&rdquo; is assigned (alternately) to each channel key to be transmitted (in encrypted form), and when a new channel key is received, the channel key on the memory (as shown in <cross-reference target="DRAWINGS">FIG. 41</cross-reference>) is updated. </paragraph>
<paragraph id="P-0335" lvl="0"><number>&lsqb;0335&rsqb;</number> In this case, (obviously) the new channel key must be sent prior to the transmission of the corresponding scrambled broadcast waves. As shown in <cross-reference target="DRAWINGS">FIG. 40</cross-reference>, the transmission schedule to this end includes time zones (Tx1, Tx2) at timings for switching the channel keys at which the transmission of the channel key &ldquo;0&rdquo; and the transmission of the channel key &ldquo;1&rdquo; overlap, in consideration of a time required in completing the decryption and the storing of the key at all the broadcast reception devices. How long this time zone should be set depends on how long it is estimated to take for the broadcast reception device to decrypt the encrypted channel key and store it into the memory. In this way, it is possible to use the relative ID for the channel key ID. </paragraph>
<paragraph id="P-0336" lvl="0"><number>&lsqb;0336&rsqb;</number> The concept of the relative ID for the key can be similarly utilized for all the other keys (the channel key decryption key, the master key) used in this third embodiment. </paragraph>
<paragraph id="P-0337" lvl="0"><number>&lsqb;0337&rsqb;</number> Next, the configuration of the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 31</cross-reference> and its operation will be described with references to the flow charts of <cross-reference target="DRAWINGS">FIG. 42</cross-reference> to <cross-reference target="DRAWINGS">FIG. 45</cross-reference>. </paragraph>
<paragraph id="P-0338" lvl="0"><number>&lsqb;0338&rsqb;</number> The broadcast waves are received at a reception unit <highlight><bold>1101</bold></highlight> regardless of channels (step S<highlight><bold>1001</bold></highlight>). The received broadcast waves are then A/D converted by an A/D converter <highlight><bold>1102</bold></highlight> (step S<highlight><bold>1002</bold></highlight>), and the removal of noises introduced during transmission is carried out using the error correction codes or the like at an error detection/correction unit <highlight><bold>1103</bold></highlight> (steps S<highlight><bold>1003</bold></highlight> and S<highlight><bold>1004</bold></highlight>). </paragraph>
<paragraph id="P-0339" lvl="0"><number>&lsqb;0339&rsqb;</number> The noise removed broadcast waves are then sent to a channel selection unit <highlight><bold>1104</bold></highlight>, where the broadcast waves corresponding to the selected channel and the broadcast waves of the contract information channel are sent to a charging control unit <highlight><bold>1106</bold></highlight>, using a channel selection interface <highlight><bold>1105</bold></highlight> for selecting a channel such as that of an ordinary TV set, for example. </paragraph>
<paragraph id="P-0340" lvl="0"><number>&lsqb;0340&rsqb;</number> The charging control unit <highlight><bold>1106</bold></highlight> sends them to a filter unit <highlight><bold>1107</bold></highlight>, where they are separated into the broadcast contents information, the channel key information, the contract information packet, and the master key seed information. This separation is done according to each information identifier. </paragraph>
<paragraph id="P-0341" lvl="0"><number>&lsqb;0341&rsqb;</number> Now, when the received information is the master key seed information (step S<highlight><bold>1013</bold></highlight>), it is separated from the filter unit <highlight><bold>1107</bold></highlight> and entered into a master key generation unit <highlight><bold>1111</bold></highlight> (step S<highlight><bold>1014</bold></highlight>). The master key generation unit <highlight><bold>1111</bold></highlight> then separates the master key seed and the master key identifier from the master key seed information, generates the master key using the random number generation and the encryption algorithm (step S<highlight><bold>1015</bold></highlight>), and stores it into a memory indicated by the master key identifier (&ldquo;0&rdquo; or &ldquo;1&rdquo; of the relative ID, for example) (step S<highlight><bold>1016</bold></highlight>). </paragraph>
<paragraph id="P-0342" lvl="0"><number>&lsqb;0342&rsqb;</number> Here the generation algorithm and the secret information for the purpose of the random number generation are common to all the broadcast reception devices and the broadcast station, and concealed in a non-volatile memory in the charging control unit <highlight><bold>1106</bold></highlight> or a ROM which is inaccessible from the external. For this reason, it is possible to share the same one master key even when the non-encrypted seed is sent. </paragraph>
<paragraph id="P-0343" lvl="0"><number>&lsqb;0343&rsqb;</number> When the received information is the contract information packet (step S<highlight><bold>1011</bold></highlight>), it is sent from the filter unit <highlight><bold>1107</bold></highlight> to a contract information decryption unit <highlight><bold>1110</bold></highlight> (step S<highlight><bold>1012</bold></highlight>) The contract information decryption unit <highlight><bold>1110</bold></highlight> obtains the master key corresponding to the master key identifier contained in the contract information packet from a master key storage unit <highlight><bold>1112</bold></highlight> (step S<highlight><bold>1041</bold></highlight>). At this point, if the corresponding master key does not exist in the master key storage unit <highlight><bold>1112</bold></highlight>, the processing is terminated. Here it is also possible to assume that the master key in a form of &ldquo;NULL&rdquo; (&ldquo;0&rdquo; in all bits) does not exist and Judge that the master key is not stored when &ldquo;NULL&rdquo; is obtained. </paragraph>
<paragraph id="P-0344" lvl="0"><number>&lsqb;0344&rsqb;</number> When the master key is outputted (step S<highlight><bold>1042</bold></highlight>), the encrypted reception contract information contained in the contract information packet is decrypted using that master key (step S<highlight><bold>1043</bold></highlight>). Then, the reception device ID is obtained from the decrypted reception contract information, and an authentication unit <highlight><bold>1114</bold></highlight> compares it with the reception device ID stored in a reception device ID storage unit <highlight><bold>1113</bold></highlight> (step S<highlight><bold>1044</bold></highlight>). If they coincide (step S<highlight><bold>1045</bold></highlight>), the channel contract information linked with that reception device ID is stored into a channel contract information storage unit <highlight><bold>1116</bold></highlight> (step S<highlight><bold>1046</bold></highlight>). Regardless of whether they coincide or not, the channel key decryption key K<highlight><subscript>H </subscript></highlight>is stored into a memory indicated by the channel key decryption key identifier (&ldquo;0&rdquo; or &ldquo;1&rdquo; of the relative ID, for example) contained in that contract information packet (step S<highlight><bold>1047</bold></highlight>). </paragraph>
<paragraph id="P-0345" lvl="0"><number>&lsqb;0345&rsqb;</number> When the received information is the channel key information (step S<highlight><bold>1008</bold></highlight>), and it is the channel key information of the channel selected by the channel selection interface <highlight><bold>1105</bold></highlight> upon checking the channel identifier in that channel key information (step S<highlight><bold>1009</bold></highlight>), it is sent from the filter unit <highlight><bold>1107</bold></highlight> to a channel key decryption unit <highlight><bold>1109</bold></highlight> (step S<highlight><bold>1010</bold></highlight>). </paragraph>
<paragraph id="P-0346" lvl="0"><number>&lsqb;0346&rsqb;</number> The channel key decryption unit <highlight><bold>1109</bold></highlight> obtains the channel key decryption key corresponding to the channel key decryption key identifier contained in the channel key information from a channel key decryption key storage unit <highlight><bold>1115</bold></highlight> (step S<highlight><bold>1031</bold></highlight>). Here, similarly as in the case of obtaining the master key, if the channel key decryption key in a form of &ldquo;NULL&rdquo; is obtained, it is judged that the channel key decryption key is not stored yet and the processing is terminated. When the channel key decryption key that is not in a form of &ldquo;NULL&rdquo; is obtained (step S<highlight><bold>1032</bold></highlight>), the encrypted channel key contained in the channel key information is decrypted using that channel key decryption key (step S<highlight><bold>1033</bold></highlight>). </paragraph>
<paragraph id="P-0347" lvl="0"><number>&lsqb;0347&rsqb;</number> The decrypted channel key is stored into a memory indicated by the channel key identifier (&ldquo;0&rdquo; or &ldquo;1&rdquo; of the relative ID, for example) contained in the channel key information (step S<highlight><bold>1034</bold></highlight>). </paragraph>
<paragraph id="P-0348" lvl="0"><number>&lsqb;0348&rsqb;</number> When the received information is the scrambled broadcast contents information (step S<highlight><bold>1005</bold></highlight>), and it is the broadcast contents information of the channel selected by the channel selection interface <highlight><bold>1105</bold></highlight> upon checking the channel identifier in that broadcast contents information (step S<highlight><bold>1006</bold></highlight>), it is sent from the filter unit <highlight><bold>1107</bold></highlight> to a descrambling unit <highlight><bold>1108</bold></highlight> (step S<highlight><bold>1007</bold></highlight>). </paragraph>
<paragraph id="P-0349" lvl="0"><number>&lsqb;0349&rsqb;</number> The descrambling unit <highlight><bold>1108</bold></highlight> sends the channel identifier to a channel key output unit <highlight><bold>1120</bold></highlight>, and obtains the channel key of that channel (step S<highlight><bold>1021</bold></highlight>). The channel key output unit <highlight><bold>1120</bold></highlight> inquires whether that channel is the contracted one or not to a contract judgement unit <highlight><bold>1118</bold></highlight>. In response, the contract judgement unit <highlight><bold>1118</bold></highlight> refers to the channel contract information in the channel contract information storage unit <highlight><bold>1116</bold></highlight> and judges whether that channel is the contracted one or not, and outputs &ldquo;1&rdquo; if it is the contracted one or &ldquo;0&rdquo; if it is not. </paragraph>
<paragraph id="P-0350" lvl="0"><number>&lsqb;0350&rsqb;</number> When &ldquo;0&rdquo; is outputted from the contract judgement unit <highlight><bold>1118</bold></highlight>, the channel output unit <highlight><bold>1120</bold></highlight> outputs &ldquo;NULL&rdquo; to the descrambling unit <highlight><bold>1108</bold></highlight>, so as to indicate that it is not the contracted one. When &ldquo;1&rdquo; is outputted from the contract judgement unit <highlight><bold>1118</bold></highlight>, the channel key output unit <highlight><bold>1120</bold></highlight> obtains the channel key corresponding to the channel key identifier from the channel key storage unit <highlight><bold>1117</bold></highlight>. Here again, similarly as in the case of obtaining the master key, if the channel key in a form of &ldquo;NULL&rdquo; is obtained, it is Judged that the channel key is not stored yet and the processing is terminated. When the channel key that is not in a form of &ldquo;NULL&rdquo; is obtained (step S<highlight><bold>1022</bold></highlight>), the descrambling unit <highlight><bold>1108</bold></highlight> descrambles the scrambled broadcast contents using that channel key, and outputs the descrambled result (step S<highlight><bold>1023</bold></highlight> and S<highlight><bold>1024</bold></highlight>). </paragraph>
<paragraph id="P-0351" lvl="0"><number>&lsqb;0351&rsqb;</number> Note that it is preferable for the reception device ID storage unit <highlight><bold>1113</bold></highlight> to be formed by a tamper resistant non-volatile memory in the charging control unit <highlight><bold>1106</bold></highlight> such that the reception device will not be outputted outside the charging control unit <highlight><bold>1106</bold></highlight>. In such a charging control unit <highlight><bold>1106</bold></highlight>, it is extremely difficult to read out the reception device ID so that it becomes practically impossible to forge the contract information. </paragraph>
<paragraph id="P-0352" lvl="0"><number>&lsqb;0352&rsqb;</number> Also, when the similar tamper resistant property is assumed also for the master key, it also becomes impossible to carry out an attack by reading out the master key from the memory in the charging control unit <highlight><bold>1106</bold></highlight>, decrypting every reception contract information contained in the contract information packets that are delivered, and eliminating only those contract information packets that contain the reception contract information (for that reception device) which is disadvantageous for that broadcast reception device. </paragraph>
<paragraph id="P-0353" lvl="0"><number>&lsqb;0353&rsqb;</number> Also, when the sufficient tamper resistant property is assumed for the charging control unit <highlight><bold>1106</bold></highlight>, the master key will never be read out so that there will be no need to change the master key by sending the master key seed. In such a case, the master key will be fixed so that it is possible to omit a part for entering the master key seed and changing the master key in the configuration of this third embodiment. </paragraph>
<paragraph id="P-0354" lvl="0"><number>&lsqb;0354&rsqb;</number> In addition, the master key storage unit <highlight><bold>1112</bold></highlight> for storing the master key may be formed by a tamper resistant non-volatile memory in the charging control unit <highlight><bold>1106</bold></highlight> similarly as the reception device ID storage unit <highlight><bold>1113</bold></highlight>, or may be provided as a circuit within the charging control unit <highlight><bold>1106</bold></highlight>. In this way, it is possible to reduce the circuit size. </paragraph>
<paragraph id="P-0355" lvl="0"><number>&lsqb;0355&rsqb;</number> However, there is no perfectly tamper resistant hardware presently. Namely, there are a variety of levels of the tamper resistant property, ranging from a level in which the reading/writing of the content of a memory or a circuit inside the hardware can be made rather easily and using only inexpensive equipments to a level in which the reading/writing of the content of a memory or a circuit inside the hardware is possible only by a person with a certain level of skills in a considerable amount of time using professional equipments. Consequently, there can be cases where it is impossible to utilize the hardware with a strong tamper resistant property for the charging control unit <highlight><bold>1106</bold></highlight> in view of the cost. For this reason, it is very important to reinforce the tamper resistant property at the system side without assuming a very strong tamper resistant property for the charging control unit <highlight><bold>1106</bold></highlight>. </paragraph>
<paragraph id="P-0356" lvl="0"><number>&lsqb;0356&rsqb;</number> When the tamper resistant property breaks down, there is a possibility of having the master key and the reception device ID, that are concealed In the charging control unit <highlight><bold>1106</bold></highlight>, read out from there. In such a case, it becomes possible to forge the contract information, so that it is very important to provide a measure for preventing this such as the following. </paragraph>
<paragraph id="P-0357" lvl="0"><number>&lsqb;0357&rsqb;</number> In order to prevent the forgery of the contract information, the public key cryptosystem is useful. The public key cryptosystem is a scheme in which encrypted data is produced using a secret key at the broadcast station side and this data can be processed using a public key provided in the charging control unit <highlight><bold>1106</bold></highlight>, for example. Here, it is computationally quite difficult and practically impossible to calculate the secret key from the public key so that a person who does not know the secret key cannot produce any data that is meaningful upon decryption using the public key. Namely, even if a contractor attempts to produce the encrypted reception contract information according to his own convenience, it would be quite difficult because he does not know the secret key. In this sense, the use of the public key cryptosystem for the encryption of the reception contract information is quite useful. </paragraph>
<paragraph id="P-0358" lvl="0"><number>&lsqb;0358&rsqb;</number> In addition, it is also useful to adopt a scheme in which a digital signature based on the public key cryptosystem is to be included in the reception contract information. The digital signature is produced by obtaining a value (called hash value) resulting from applying a kind of one-way random function called hash function to a portion of the reception contract information excluding the digital signature, and encrypting this hash value using the secret key. It is practically impossible to produce the digital signature unless the secret key is known just as in the above, and moreover it is possible to verify the digital signature by comparing the hash value obtained by decrypting the digital signature using the public key and the hash value for a portion of the reception contract information excluding the digital signature that can be calculated separately. </paragraph>
<paragraph id="P-0359" lvl="0"><number>&lsqb;0359&rsqb;</number> In this case, it is preferable to verify the digital signature only when the corresponding reception device ID exists in the reception contract information, because the verification of the digital signature is time consuming and there is basically no need to verify the digital signature except when there is a need to update the contract information. </paragraph>
<paragraph id="P-0360" lvl="0"><number>&lsqb;0360&rsqb;</number> In the case of attaching the digital signature to the reception contract information, a configuration of the broadcast reception device can be modified from that of <cross-reference target="DRAWINGS">FIG. 31</cross-reference> by replacing the authentication unit <highlight><bold>1114</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 31</cross-reference> by a configuration shown in <cross-reference target="DRAWINGS">FIG. 68</cross-reference>. A configuration of the reception contract information in that case is shown in <cross-reference target="DRAWINGS">FIG. 69</cross-reference>. Of course, it is also possible to apply the data compression as shown in <cross-reference target="DRAWINGS">FIG. 49</cross-reference> to be described below. </paragraph>
<paragraph id="P-0361" lvl="0"><number>&lsqb;0361&rsqb;</number> However, even when the above described measure is provided, it is still possible to carry out the following attack. Namely, a contractor who have contracted all the channels once keeps records of the contract information packets delivered in that state. Here, if this contractor knows the master key and the reception device ID, it would be possible to identify the contract information of that broadcast reception device, but even if he does not know them, when the contract information broadcast waves are recorded, it is natural to consider that the contract information packets containing the contract information for that broadcast reception device had been transmitted during a certain period of time before the viewing or listening became possible. Next, the contractor cancels contracts for all the channels so that it becomes impossible to view or listen all the channels, but after it becomes impossible to view or listen anything, it is in principle possible to input the earlier recorded contract information packets containing the old encrypted reception contract information somehow into the charging control unit <highlight><bold>1106</bold></highlight> again so as to restore the earlier (advantageous) contract information therein. Moreover, in this case, the digital signature is also correct so that the broadcast reception device would accept that contract information. </paragraph>
<paragraph id="P-0362" lvl="0"><number>&lsqb;0362&rsqb;</number> In order to prevent such an attack, it is necessary to change the public key for the digital signature regularly. The old digital signature becomes invalid when the public key is changed. The changing of the public key can be done by identifying information using the information identifier and storing the public key for the digital signature contained in a packet into a non-volatile memory. This key is the public key so that there is no particular need to encrypt it, but it is also possible to adopt a scheme in which this public key is to be encrypted using the master key for the sake of secret keeping. </paragraph>
<paragraph id="P-0363" lvl="0"><number>&lsqb;0363&rsqb;</number> Also, the broadcast contents are to be delivered sequentially and to be immediately decrypted so that their encryption should preferably be based on the secret key cryptosystem. This is because the secret key cryptosystem is 100 to 1000 times faster than the public key cryptosystem. Similarly the encryption of the channel key should preferably be based on the secret key cryptosystem. It is meaningless to forge the channel key, so that there is no sound reason to adopt the public key cryptosystem for the channel key. </paragraph>
<paragraph id="P-0364" lvl="0"><number>&lsqb;0364&rsqb;</number> As for the master key seed which is to be an input of the master key generation unit <highlight><bold>1111</bold></highlight>, it may be given by a seed of the random number literally, but it may also be given by the master key encrypted using the secret key cryptosystem or the public key cryptosystem. In such a case, the decryption key for the encrypted master key must be recorded in a tamper resistant non-volatile memory or circuit inside the charging control unit <highlight><bold>1106</bold></highlight>. </paragraph>
<paragraph id="P-0365" lvl="0"><number>&lsqb;0365&rsqb;</number> The channel key storage unit <highlight><bold>1117</bold></highlight>, the channel key decryption key storage unit <highlight><bold>1115</bold></highlight>, and the master key storage unit <highlight><bold>1112</bold></highlight> of this third embodiment must be cleared to &ldquo;NULL&rdquo; when the power of the broadcast reception device is turned off. This is because it is highly likely that these keys are already changed when the power is turned on again. By clearing them to &ldquo;NULL&rdquo;, the decryption operation will not be activated while these keys are still not stored so that it is possible to avoid outputting meaningless data by carrying out the decryption using inappropriate keys. </paragraph>
<paragraph id="P-0366" lvl="0"><number>&lsqb;0366&rsqb;</number> Also, in relation to this aspect, consider the case where the charging control unit <highlight><bold>1106</bold></highlight> received an erroneous channel key information. Of course the error detection/correction using the error codes is carried out at the error detection/correction unit <highlight><bold>1103</bold></highlight>, but this error correction can be incomplete. </paragraph>
<paragraph id="P-0367" lvl="0"><number>&lsqb;0367&rsqb;</number> If the charging control unit <highlight><bold>1106</bold></highlight> receives the erroneous key information (the channel key or the master key seed) as it is, the erroneous key or contract information would be stored and the erroneous decryption or conditional access using the erroneous key or contract information would be carried out. In general, in the cryptosystem, the decryption result can turn out to be quite far from the correct result if even a single bit of the key is wrong. This stems from the requirement of the safety that the plaintext (original data) should not be guessed from the key, and the cryptosystem that does not have this property is a weak cryptosystem which cannot be used in practice. For this reason, it is possible to adopt a scheme in which an authenticator is to be attached to the important information including the encrypted key information and the contract information. </paragraph>
<paragraph id="P-0368" lvl="0"><number>&lsqb;0368&rsqb;</number> Now, with references to <cross-reference target="DRAWINGS">FIG. 46</cross-reference> to <cross-reference target="DRAWINGS">FIG. 48</cross-reference>, the case of using an authenticator for the important information including the encrypted key information and the contract information will be described. </paragraph>
<paragraph id="P-0369" lvl="0"><number>&lsqb;0369&rsqb;</number> An authenticator to be attached to the encrypted key information is derived by some algorithm from the key information that can be obtained as a result of decryption. Consequently, a result obtained by the calculation for obtaining the authenticator from the decryption result is compared with the authenticator itself and if they coincide it can be Judged that it is data without errors. Here the authenticator can be given by the upper 32 bits of the key k encrypted using the key k, for example. Assuming that the key is in 64 bits, the authenticator is in at most 64 bits. It should be apparent that this scheme is capable of only detecting errors. </paragraph>
<paragraph id="P-0370" lvl="0"><number>&lsqb;0370&rsqb;</number> Also, a probability for failing to detect actually existing errors is determined by the length of the authenticator, and given by &frac12;<highlight><superscript>l </superscript></highlight>where l is the length of the authenticator. This implies that the probability for failure becomes lower for the longer authenticator. Thus it suffices to determine the length of the authenticator according to the required (tolerable) level of the probability for failure. In this sense, there can be cases where the 64 bits length authenticator is insufficient as the required (tolerable) level of the probability for failure is quite low. In such cases, there is a need to further attach an authenticator of different kind. Here the authenticator of different kind is basically an authenticator produced by another algorithm, but if there is a difficulty in providing another algorithm, it can be given by an authenticator produced by the same algorithm as the original one applied after the key k is converted by some prescribed function. Else, the authenticator of different kind can be produced by applying the same algorithm to the originally obtained authenticator. </paragraph>
<paragraph id="P-0371" lvl="0"><number>&lsqb;0371&rsqb;</number> When the encryption algorithm is used as the authenticator production algorithm, it is possible to produce the authenticator in which the superficial sequence of bits are mutually unrelated. This is because the encryption algorithm itself has a random nature. When the probability for failure nearly equal to 0 is required, sufficiently many authenticators can be provided in this manner, and they can be compressed in a prescribed way. </paragraph>
<paragraph id="P-0372" lvl="0"><number>&lsqb;0372&rsqb;</number> In the case of using the encrypted key information with the authenticator attached thereto in this third embodiment, the encrypted key information portion should be replaced by a structure shown in <cross-reference target="DRAWINGS">FIG. 46</cross-reference>, while the authenticator checking unit should be provided inside each of the channel key decryption unit <highlight><bold>1109</bold></highlight> and the contract information decryption unit <highlight><bold>1110</bold></highlight> (or the authentication unit <highlight><bold>1114</bold></highlight>) of <cross-reference target="DRAWINGS">FIG. 31</cross-reference>, such that the key will not be outputted when the authentication fails. </paragraph>
<paragraph id="P-0373" lvl="0"><number>&lsqb;0373&rsqb;</number> There is also a need to attach the authenticator to the reception contract information and the master key seed, but the master key can be based on the public key cryptosystem so that it may not be given in a block of a convenient size such as 64 bits. The key of the public key cryptosystem is longer than the key of the secret key cryptosystem so that the authenticator can be produced by dividing the key into blocks as shown in <cross-reference target="DRAWINGS">FIG. 47</cross-reference>, producing the authenticator as described above in each block, and calculating the exclusive OR (ExOR) of these authenticators for blocks. </paragraph>
<paragraph id="P-0374" lvl="0"><number>&lsqb;0374&rsqb;</number> Also, when the key information (the channel key decryption key in the case of this third embodiment) is contained in the reception contract information, the authenticator can be produced by encrypting each block obtained by the above described block division from that key information, and calculating the exclusive OR of them similarly as described above. </paragraph>
<paragraph id="P-0375" lvl="0"><number>&lsqb;0375&rsqb;</number> Else, as shown in <cross-reference target="DRAWINGS">FIG. 48</cross-reference>, the first authenticator for the first block is produced as described above, and the exclusive OR of the first authenticator and the second block is calculated. Then, the second authenticator is produced by the above described algorithm from the exclusive OR result. The final authenticator can be produced by repeating this calculation for the subsequent blocks. In any case, in order to realize division into blocks of 64 bits size, NULL data (dummy data) called PAD is inserted according to the need as shown in <cross-reference target="DRAWINGS">FIG. 47</cross-reference>. Thus, even in the case of attaching the authenticator to the master key seed, the verification of the authenticator can be realized by providing a process for checking the authenticator in the master key generation unit <highlight><bold>1111</bold></highlight>. </paragraph>
<paragraph id="P-0376" lvl="0"><number>&lsqb;0376&rsqb;</number> Next, a possible expansion of the reception contract information configuration will be described. </paragraph>
<paragraph id="P-0377" lvl="0"><number>&lsqb;0377&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 38</cross-reference>, the reception contract information comprises the reception device ID (TID), the channel contract information (CHS), and the channel key decryption key. Here, the channel key decryption key has a key size longer than the channel key for the sake of securing safety. For example, in the case of using the standard cryptosystem such as DES (Data Encryption Standard), the channel key is in 64 bits while the channel key decryption key is in 128 bits. Here, the reception device ID (TID) can be given in about 50 bits at most because it suffices to uniquely identify the broadcast reception device. The channel contract information (CHS) requires as many bits as the number of channels so that it can be given in 30 bits if there are 30 channels, for example. Thus the portion other than the channel key decryption key is in 80 bits, and more than a half of the reception contract information is occupied by the channel key decryption key. </paragraph>
<paragraph id="P-0378" lvl="0"><number>&lsqb;0378&rsqb;</number> Note that the channel key decryption key is common to all the broadcast reception devices and it is contained in the reception contract information for the purpose of ensuring the reception of the reception contract information (which contains at least the reception device ID and the channel contract information). This is because the user has no choice but receiving the reception contract information even if it is a disadvantageous one for the user as long as the channel key decryption key is contained in it. From this perspective, there is no problem in containing the reception contract information for a plurality of broadcast reception devices in a single contract information packet, and the amount of data to be transmitted can be reduced this way. </paragraph>
<paragraph id="P-0379" lvl="0"><number>&lsqb;0379&rsqb;</number> For this reason, the contract information packet is formed as shown in <cross-reference target="DRAWINGS">FIG. 49</cross-reference>. Note that <cross-reference target="DRAWINGS">FIG. 49</cross-reference> shows only a portion related to the reception contract information in the contract information packet. </paragraph>
<paragraph id="P-0380" lvl="0"><number>&lsqb;0380&rsqb;</number> Here, a plurality of corresponding set of the reception device ID (TID) and the channel contract information (CHS) are provided on both sides of the channel key decryption key. The reason for not placing the channel key decryption key at a top portion of the contract information packet is the following. In the case of using the secret key cryptosystem such as DES for the encryption of the reception contract information, the encryption is often made in units of 64 bits length blocks, and if the channel key decryption key given in 128 bits is placed at a top portion, the channel key decryption key would occupy the first two blocks. If this fact is revealed, it becomes possible to acquire the channel key decryption key without acquiring the channel contract information by modifying the reception device to decrypt only the first two blocks. The similar consideration also apply to the case of placing the channel key decryption key at a last portion. Note however that this consideration does not apply to the case of using encryption based on the cryptosystem such as the public key cryptosystem which is not carried out in units of 64 bits. </paragraph>
<paragraph id="P-0381" lvl="0"><number>&lsqb;0381&rsqb;</number> Also, in any case, it is preferable to use a configuration in which a border between adjacent encryption blocks does not coincide with a border between adjacent data. In addition, it is preferable to use an overall size that matches with the block size of the cryptosystem used in encrypting the reception contract information in order to eliminate wasteful data. </paragraph>
<paragraph id="P-0382" lvl="0"><number>&lsqb;0382&rsqb;</number> In addition, it becomes possible to transmit more contract information in a single contract information packet by expanding the reception contract information as shown in <cross-reference target="DRAWINGS">FIG. 50</cross-reference>. Note that <cross-reference target="DRAWINGS">FIG. 50</cross-reference> shows only a portion related to the reception contract information in the contract information packet. </paragraph>
<paragraph id="P-0383" lvl="0"><number>&lsqb;0383&rsqb;</number> The reception contract information shown in <cross-reference target="DRAWINGS">FIG. 50</cross-reference> is characterized in that it contains only one channel contract information (CHS), and a plurality of reception device IDs (TID) contained therein are the reception device IDs of those broadcast reception devices which have contracts with the same contract content given by that channel contract information. Namely, instead of recording one channel contract information and one reception device ID in link as in the reception contract information of <cross-reference target="DRAWINGS">FIG. 49</cross-reference>, the reception contract information of <cross-reference target="DRAWINGS">FIG. 50</cross-reference> records one channel contract information and a plurality of reception device IDs in link. In this way, the amount of reception contract information that can be transmitted by a single contract information packet can be increased further. </paragraph>
<paragraph id="P-0384" lvl="0"><number>&lsqb;0384&rsqb;</number> However, this scheme is not without a problem. For example, in the case where there are many types of channel contract information but the number of contractors corresponding to each type is not so many, the format of <cross-reference target="DRAWINGS">FIG. 50</cross-reference> will have a large vacant region so that the efficiency becomes rather poor. Consequently, in the practical implementation of the broadcast reception device, it is generally preferable to use the charging control unit <highlight><bold>1106</bold></highlight> that can deal with both of the formats of <cross-reference target="DRAWINGS">FIG. 49</cross-reference> and <cross-reference target="DRAWINGS">FIG. 50</cross-reference>. To this end, it suffices to distinguish packets of these two formats using the information identifier and provide processing units corresponding to these two formats. </paragraph>
<paragraph id="P-0385" lvl="0"><number>&lsqb;0385&rsqb;</number> In the case of containing the authenticator, the reception contract information has a format as shown in <cross-reference target="DRAWINGS">FIG. 75</cross-reference>, and in the case of containing the digital signature, the reception contract information has a format as shown in <cross-reference target="DRAWINGS">FIG. 76</cross-reference>. It is also possible to apply the contract information packet format of <cross-reference target="DRAWINGS">FIG. 49</cross-reference> or <cross-reference target="DRAWINGS">FIG. 50</cross-reference> to these formats, as shown in <cross-reference target="DRAWINGS">FIG. 77</cross-reference> and <cross-reference target="DRAWINGS">FIG. 78</cross-reference>, respectively. Also, as should be apparent, there is no limitation regarding an order of information elements (although it is necessary to have it determined at the designing stage of the reception device), and many variations to the formats shown in <cross-reference target="DRAWINGS">FIG. 75</cross-reference> to <cross-reference target="DRAWINGS">FIG. 78</cross-reference> can be obtained by changing an order of information elements. </paragraph>
<paragraph id="P-0386" lvl="0"><number>&lsqb;0386&rsqb;</number> Also, in the case of using these plural formats mixedly, it suffices to distinguish these formats using the information identifier and provide processing units corresponding to these formats, as shown in <cross-reference target="DRAWINGS">FIG. 37</cross-reference>. </paragraph>
<paragraph id="P-0387" lvl="7"><number>&lsqb;0387&rsqb;</number> (2) Contract Management Device: </paragraph>
<paragraph id="P-0388" lvl="0"><number>&lsqb;0388&rsqb;</number> Next, the contract management device on the information delivery side which corresponds to the broadcast reception device in the configuration shown in <cross-reference target="DRAWINGS">FIG. 31</cross-reference> will be described. </paragraph>
<paragraph id="P-0389" lvl="0"><number>&lsqb;0389&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 70</cross-reference> shows an exemplary configuration of the contract management device according to this third embodiment, which realizes all the functions described in this third embodiment. A portion corresponding to any functions which are unnecessary in a practical realization of the system may be omitted from this configuration of <cross-reference target="DRAWINGS">FIG. 70</cross-reference>. </paragraph>
<paragraph id="P-0390" lvl="0"><number>&lsqb;0390&rsqb;</number> Note that, in <cross-reference target="DRAWINGS">FIG. 70, a</cross-reference> contracting user database <highlight><bold>2001</bold></highlight>, a payment confirmation waiting database <highlight><bold>2002</bold></highlight>, a contract period checking unit <highlight><bold>2007</bold></highlight>, a contract information database <highlight><bold>2005</bold></highlight>, a scheduling unit <highlight><bold>2014</bold></highlight>, a broadcast device <highlight><bold>2013</bold></highlight>, a contract information packet output request unit <highlight><bold>2012</bold></highlight>, a seed database <highlight><bold>2003</bold></highlight>, and a seed and master key generation unit <highlight><bold>2010</bold></highlight> are substantially the same as the contracting user database <highlight><bold>1</bold></highlight>, the payment confirmation waiting database <highlight><bold>2</bold></highlight>, the contract period checking unit <highlight><bold>7</bold></highlight>, the appending information database <highlight><bold>5</bold></highlight>, the scheduling unit <highlight><bold>14</bold></highlight>, the broadcast device <highlight><bold>13</bold></highlight>, the appending information output request unit <highlight><bold>12</bold></highlight>, the seed database <highlight><bold>3</bold></highlight>, and the seed and master key generation unit <highlight><bold>10</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> described above, respectively, so that their description will be omitted here and only those portions which are characteristic to this third embodiment will be described below. </paragraph>
<paragraph id="P-0391" lvl="0"><number>&lsqb;0391&rsqb;</number> Note also that, in <cross-reference target="DRAWINGS">FIG. 70, a</cross-reference> contract changed user database <highlight><bold>2006</bold></highlight> will store an information (such as the reception device ID, the channel contract information such as channel numbers, etc.) regarding a user who has changed the contract content within a prescribed period of time (including the case of new subscription). </paragraph>
<paragraph id="P-0392" lvl="0"><number>&lsqb;0392&rsqb;</number> The characteristic portion of the contract management device shown in <cross-reference target="DRAWINGS">FIG. 70</cross-reference> is a contract information packet generation unit <highlight><bold>2008</bold></highlight>. An exemplary configuration of this contract information packet generation unit <highlight><bold>2008</bold></highlight> is shown in <cross-reference target="DRAWINGS">FIG. 72</cross-reference>. The configuration and the operation of this contract information packet generation unit <highlight><bold>2008</bold></highlight> will now be described with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 73</cross-reference>. </paragraph>
<paragraph id="P-0393" lvl="0"><number>&lsqb;0393&rsqb;</number> The contract information packet generation unit <highlight><bold>2008</bold></highlight> starts its operation upon receiving a command from a contract information packet control unit <highlight><bold>2009</bold></highlight> of the contract management device at a reception contract information production unit <highlight><bold>2032</bold></highlight> (step S<highlight><bold>1131</bold></highlight>). A command to be sent to the reception contract information production unit <highlight><bold>2032</bold></highlight> can have a content such as &ldquo;Sequentially produce contract information of contractors who have changed contracts within last two months, which is scheduled to be transmitted on Jul. 15, 1998&rdquo;, for example. When such a command is received, the reception contract information production unit <highlight><bold>2032</bold></highlight> searches through the contract change user database <highlight><bold>2006</bold></highlight>, and the contracting user database <highlight><bold>2001</bold></highlight> if necessary, via a contract user information retrieval/input unit <highlight><bold>2031</bold></highlight>, and sequentially extracts information of relevant users (steps S<highlight><bold>1132</bold></highlight> to S<highlight><bold>1133</bold></highlight>). </paragraph>
<paragraph id="P-0394" lvl="0"><number>&lsqb;0394&rsqb;</number> Next, the channel key decryption key corresponding to the transmission timing is retrieved from a channel key decryption key database <highlight><bold>2016</bold></highlight> via a channel key decryption key retrieval/input unit <highlight><bold>2038</bold></highlight> (step S<highlight><bold>1134</bold></highlight>), and a first intermediate data as shown in <cross-reference target="DRAWINGS">FIG. 74</cross-reference> is generated (step S<highlight><bold>1135</bold></highlight>). </paragraph>
<paragraph id="P-0395" lvl="0"><number>&lsqb;0395&rsqb;</number> Next, an authenticator generation unit <highlight><bold>2036</bold></highlight> generates an authenticator for the first intermediate data (step S<highlight><bold>1136</bold></highlight>) and attaches it to the first intermediate data so as to produce a second intermediate data as shown in <cross-reference target="DRAWINGS">FIG. 75</cross-reference>. In addition, a secret key for digital signature corresponding to the transmission timing is retrieved from a key for digital signature database <highlight><bold>2017</bold></highlight> via a key for digital signature retrieval/input unit <highlight><bold>2037</bold></highlight>, and the digital signature is produced using that secret key (step S<highlight><bold>1137</bold></highlight>). Then, this digital signature is attached to the second intermediate data so as to produce the reception contract information as shown in <cross-reference target="DRAWINGS">FIG. 76</cross-reference> (step S<highlight><bold>1138</bold></highlight>). </paragraph>
<paragraph id="P-0396" lvl="0"><number>&lsqb;0396&rsqb;</number> Here, the digital signature may be produced for the first intermediate data alone or for the second intermediate data. In general the latter can realize the stronger security level. </paragraph>
<paragraph id="P-0397" lvl="0"><number>&lsqb;0397&rsqb;</number> Next, the reception contract information is sent to an encryption unit <highlight><bold>2033</bold></highlight>, where the master key matching the broadcast timing is retrieved from the master key database <highlight><bold>2015</bold></highlight> via a master key retrieval/input unit <highlight><bold>2039</bold></highlight> (step S<highlight><bold>1139</bold></highlight>), and the reception contract information is encrypted using that master key (step S<highlight><bold>1140</bold></highlight>). </paragraph>
<paragraph id="P-0398" lvl="0"><number>&lsqb;0398&rsqb;</number> A contract information packet production unit <highlight><bold>2034</bold></highlight> then attaches a channel key decryption key identifier, a master key identifier, and an information identifier to the encrypted reception contract information, so as to produce the contract information packet as shown in <cross-reference target="DRAWINGS">FIG. 37</cross-reference>, for example (step S<highlight><bold>1141</bold></highlight>). In order to produce the contract information packet, it suffices to attach the channel key decryption key identifier, the master key identifier and the information identifier as shown in <cross-reference target="DRAWINGS">FIG. 37</cross-reference>, where the former two can be obtained from the respective databases, and an identifier assigned in advance to the contract information packet can be attached as the information identifier. </paragraph>
<paragraph id="P-0399" lvl="0"><number>&lsqb;0399&rsqb;</number> It is also similarly possible to produce the reception contract information (or the first intermediate data) as shown in <cross-reference target="DRAWINGS">FIG. 49</cross-reference>, or the contracted reception contract information (or the first intermediate data) as shown in <cross-reference target="DRAWINGS">FIG. 50</cross-reference>. In such a case, however, the processing at the contracting user information retrieval/input unit <highlight><bold>2031</bold></highlight> becomes complicated. Namely, it is necessary for the contracting user information retrieval/input unit <highlight><bold>2031</bold></highlight> to search out the contractors who have the same channel contract information. </paragraph>
<paragraph id="P-0400" lvl="0"><number>&lsqb;0400&rsqb;</number> Here, the compressed contract information as shown In <cross-reference target="DRAWINGS">FIG. 50</cross-reference> is effective if the types of contracts are not so many, but when the types of contracts are many it causes an increase of wasteful region so that it is disadvantageous as an amount of transmission increases. For this reason, there is also a need to transmit the format of <cross-reference target="DRAWINGS">FIG. 49</cross-reference> and the format of <cross-reference target="DRAWINGS">FIG. 50</cross-reference> mixedly depending on the channel contract information. In such a case, it is the reception contract information production unit <highlight><bold>2032</bold></highlight> that determines which format should be used, and the reception contract information production unit <highlight><bold>2032</bold></highlight> determines this according to the retrieval result of the contracting user information retrieval/input unit <highlight><bold>2031</bold></highlight>. </paragraph>
<paragraph id="P-0401" lvl="0"><number>&lsqb;0401&rsqb;</number> For example, when the number of channel contract information that fit to the format of <cross-reference target="DRAWINGS">FIG. 49</cross-reference> is 10 and the number of channel contract information that fit to the format of <cross-reference target="DRAWINGS">FIG. 50</cross-reference> is 20, it is possible to process them such that, among those contractors for which the reception contract information production condition is met, the format of <cross-reference target="DRAWINGS">FIG. 49</cross-reference> is used when the number of contractors who have the same channel contract information is 10 or less, or the format of <cross-reference target="DRAWINGS">FIG. 50</cross-reference> is used when the number of contractors who have the same channel contract information is 11 or more. </paragraph>
<paragraph id="P-0402" lvl="0"><number>&lsqb;0402&rsqb;</number> In addition, the processing on the broadcast reception device side becomes impossible unless the distinction between these two formats is explicitly indicated on the packet, and this can be realized by utilizing the information identifier. Namely, a plurality of information identifiers can be used depending on the format used in the contract information packet. This scheme can obviously be adapted to a variety of formats that can be used by the contract information packet. For example, whether or not to attach the digital signature and whether or not to attach the authenticator are factors independent from which one of the format of <cross-reference target="DRAWINGS">FIG. 49</cross-reference> and the format of <cross-reference target="DRAWINGS">FIG. 50</cross-reference> is to be used for the contract information, and the information identifier can also be utilized in explicitly indicating which option is chosen for the contract information packet. </paragraph>
<paragraph id="P-0403" lvl="0"><number>&lsqb;0403&rsqb;</number> Next, the transmission schedule for the contract information will be described. The significance of the present invention lies in that it is possible to guarantee the same safety level with a narrower bandwidth available for the transmission of the contract information, so that the transmission scheme for changing the transmission frequency of the contract information (how frequently the contract information should be transmitted) for different contractors as described here is very significant. Namely, although it depends on the content of the contract change, it is possible to expect the contract changed user to refuse receiving the reception contract information in an attempt to continue to view or listen programs (especially in the case of the disadvantageous contract information). The reception refusal to be considered here is of the simple nature such as that realized by viewing or listen only for a short period of time every day, or that realized by turning the power off for a certain period of time. </paragraph>
<paragraph id="P-0404" lvl="0"><number>&lsqb;0404&rsqb;</number> From this perspective, if the period for sending the contract information after the contract change is held fixed, there is a possibility for becoming impossible to realize the conditional access. For example, if it is fixedly set that the contract information is to be sent for only one year after the contract change, the contract information can remain without being updated if the power of the broadcast reception device is not turned on at all during one year period after the contract change (because the contract information is not acquired during that period), and after that period it would become possible to continue viewing or listening programs using the old contract information. </paragraph>
<paragraph id="P-0405" lvl="0"><number>&lsqb;0405&rsqb;</number> On the other hand, if it is set that the reception contract information is to be sent indefinitely after the contract change, the transmission bandwidth cannot be utilized effectively because the reception contract information for the contractor who had already received it would also have to be transmitted repeatedly. For this reason, there is a need to change the transmission frequency of the contract information depending on a time elapsed since the contract change. Exemplary transmission frequencies of the contract information are as follows. </paragraph>
<paragraph id="P-0406" lvl="2"><number>&lsqb;0406&rsqb;</number> When a time elapsed since the contract change is less than two months: a transmission frequency of once in every 10 minutes; </paragraph>
<paragraph id="P-0407" lvl="2"><number>&lsqb;0407&rsqb;</number> When a time elapsed since the contract change is between two months and six months: a transmission frequency is once in every 30 minutes; </paragraph>
<paragraph id="P-0408" lvl="2"><number>&lsqb;0408&rsqb;</number> When a time elapsed since the contract change is between six months and one year: a transmission frequency is once in every 60 minutes; and </paragraph>
<paragraph id="P-0409" lvl="2"><number>&lsqb;0409&rsqb;</number> When a time elapsed since the contract change is over one year: a transmission frequency is once in every 120 minutes. </paragraph>
<paragraph id="P-0410" lvl="0"><number>&lsqb;0410&rsqb;</number> In this example, it is transmitted once in every ten minutes for the first two months so as to urge the early contract change. It is expected that the most of the reception devices will make the contract change at this stage, but the transmission is continued thereafter for those reception devices which happened to fail to receive the contract information or which could not receive the contract information because the power was turned off, with gradually decreasing transmission frequencies such as once in every 30 minutes from two months later to six months later, once in every 60 minutes from six months later to one year later, and once in every 120 minutes from one year later. In this way, it is possible to realize the conditional access accurately while saving the broadcast bandwidth. </paragraph>
<paragraph id="P-0411" lvl="0"><number>&lsqb;0411&rsqb;</number> On the other hand, as for the new contractor, the contractor himself will desire to receive the contract information soon, and even if the contractor fails to receive the contract information (for some reason) there will be a feedback to the broadcast station side in a form of a claim from the contractor so that it suffices to re-transmit the contract information by then. Consequently it is meaningless to transmit the contract information over a long period of time, and in this sense it suffices to transmit the contract information for the new contractor at the transmission frequency of about once in every ten minutes only for two months after the new subscription. </paragraph>
<paragraph id="P-0412" lvl="0"><number>&lsqb;0412&rsqb;</number> As described above, it is preferable to use the transmission schedule which changes the broadcast frequency of the contract information depending on the type of contract (contract change, new subscription, etc.) and the time elapsed after the contract. In the contract management device of this third embodiment, the contract information packet generation control unit makes the adjustment to carry out the transmission at the above noted frequencies, for example. </paragraph>
<paragraph id="P-0413" lvl="0"><number>&lsqb;0413&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 51</cross-reference> to <cross-reference target="DRAWINGS">FIG. 60</cross-reference>, <cross-reference target="DRAWINGS">FIG. 71</cross-reference>, <cross-reference target="DRAWINGS">FIG. 79</cross-reference> and <cross-reference target="DRAWINGS">FIG. 80</cross-reference>, the fourth embodiment of a conditional access broadcast system according to the present invention will be described in detail. </paragraph>
<paragraph id="P-0414" lvl="0"><number>&lsqb;0414&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 51</cross-reference> shows an exemplary configuration of the broadcast reception device according to this fourth embodiment. This fourth embodiment is a simplification of the third embodiment while maintaining the same level of security. Consequently, those elements which are substantially the same as the corresponding elements of <cross-reference target="DRAWINGS">FIG. 31</cross-reference> will be given the same reference numerals in the figures and their description will be omitted. </paragraph>
<paragraph id="P-0415" lvl="0"><number>&lsqb;0415&rsqb;</number> This fourth embodiment essentially differs from the third embodiment in that the channel key decryption unit <highlight><bold>1109</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 31</cross-reference> is omitted. For this reason, as shown in <cross-reference target="DRAWINGS">FIG. 52</cross-reference>, the key structure for decrypting the encrypted broadcast contents is in three stages. </paragraph>
<paragraph id="P-0416" lvl="0"><number>&lsqb;0416&rsqb;</number> Also, in this fourth embodiment, the channel key is contained in the reception contract information. Consequently, the information on the ordinary channel comprises the scrambled contents alone as shown in <cross-reference target="DRAWINGS">FIG. 53</cross-reference>. In conjunction with this, the contract information packet to be delivered by the contract information channel becomes as shown in <cross-reference target="DRAWINGS">FIG. 54</cross-reference>, where the channel key identifier and the corresponding channel identifier are necessary because the channel key is contained in the reception contract information instead of the channel key decryption key. </paragraph>
<paragraph id="P-0417" lvl="0"><number>&lsqb;0417&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 55</cross-reference>, the reception contract information comprises the reception device ID, the channel contract information, and the channel key. The packing similar to that of <cross-reference target="DRAWINGS">FIG. 49</cross-reference> described above for the third embodiment is also possible for this reception contract information. Also, in the contract information packet shown in <cross-reference target="DRAWINGS">FIG. 54</cross-reference>, the channel identifier is placed at a non-encrypted portion so that it is possible to obtain only the contract information corresponding to the channel identifier of the selected channel. In order to prevent this, the channel identifier and the channel key identifier are contained in the reception contract information and this reception contract information as a whole is encrypted as shown in <cross-reference target="DRAWINGS">FIG. 57</cross-reference>. In this case, the contract information packet has a configuration containing the encrypted reception contract information, the master key identifier and the information identifier as shown in <cross-reference target="DRAWINGS">FIG. 56</cross-reference>. </paragraph>
<paragraph id="P-0418" lvl="0"><number>&lsqb;0418&rsqb;</number> Also, when the reception contract information has a configuration shown in <cross-reference target="DRAWINGS">FIG. 58</cross-reference>, the reception contract information can contain the channel key &ldquo;0&rdquo; and the channel key &ldquo;1&rdquo;, of which one of them can be set as the decryption key of current broadcast contents while the other one can be set as the key that becomes valid next, so that the channel identifier becomes unnecessary. </paragraph>
<paragraph id="P-0419" lvl="0"><number>&lsqb;0419&rsqb;</number> In addition, similarly as the reception contract information of the third embodiment, it is possible to attach the authenticator or the digital signature to the reception contract information, and in such a case, the same effect as described above for the third embodiment can be achieved. As examples, <cross-reference target="DRAWINGS">FIG. 79</cross-reference> and <cross-reference target="DRAWINGS">FIG. 80</cross-reference> show the cases where the reception contract information becomes most complicated, that is, the cases where the reception contract information is described in the formats of <cross-reference target="DRAWINGS">FIG. 49</cross-reference> and <cross-reference target="DRAWINGS">FIG. 50</cross-reference> respectively and the two channel keys are contained as shown in <cross-reference target="DRAWINGS">FIG. 58</cross-reference>. There is also no limitation on an order of information elements similarly as in the third embodiment, and an order can be changed for each data. Also, in the case of using these plurality of formats mixedly, it suffices to distinguish them using the information identifier. </paragraph>
<paragraph id="P-0420" lvl="0"><number>&lsqb;0420&rsqb;</number> Now, at a time of receiving the contract information, the contract information packet is separated at the filter unit <highlight><bold>1107</bold></highlight> and sent to the contract information decryption unit <highlight><bold>1110</bold></highlight>. Then the encrypted reception contract information contained therein is decrypted using the corresponding master key, and the reception device ID contained in the reception contract information is retrieved sequentially (if there are plural reception device IDs), and when the ID of this reception device is found, the channel contract information corresponding to it is stored into the channel contract information storage unit <highlight><bold>1116</bold></highlight>. At the same time, regardless of whether the reception device ID is that of this reception device or not, the channel key contained in the reception contract information is written into a memory (the channel key storage unit <highlight><bold>1117</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 51</cross-reference>), in correspondence to a combination of the channel identifier and the channel key identifier indicated by that reception contract information, as shown in <cross-reference target="DRAWINGS">FIG. 59</cross-reference>. </paragraph>
<paragraph id="P-0421" lvl="0"><number>&lsqb;0421&rsqb;</number> The channel key output unit <highlight><bold>1120</bold></highlight> retrieves the corresponding channel key from the channel key storage unit <highlight><bold>1117</bold></highlight> according to the judgement of the contract Judgement unit <highlight><bold>1118</bold></highlight> in response to a request from the descrambling unit <highlight><bold>1108</bold></highlight>, and outputs it to the descrambling unit <highlight><bold>1108</bold></highlight>. </paragraph>
<paragraph id="P-0422" lvl="0"><number>&lsqb;0422&rsqb;</number> Here, as shown in <cross-reference target="DRAWINGS">FIG. 59</cross-reference>, all the acquired channel keys are stored along with the channel identifiers in the channel key storage unit <highlight><bold>1117</bold></highlight>. However, this is not absolutely necessary because the number of channels that can be viewed or listened simultaneously is at most one. For this reason, it is also possible to refer to the currently viewed or listened channel number at the authentication unit <highlight><bold>1114</bold></highlight>, and store only the necessary channel key into the channel key storage unit <highlight><bold>1117</bold></highlight>. In such a case, the channel key storage unit <highlight><bold>1117</bold></highlight> stores the channel key and its identifier as shown in <cross-reference target="DRAWINGS">FIG. 41</cross-reference>. When this structure is adopted, it is necessary to clear the interior of the channel key storage unit <highlight><bold>1117</bold></highlight> at a time of the channel change, because the channel key of the channel before the channel change is in general different from the channel key of the channel after the channel change and the channel key of the channel before the channel change would remain valid such that incomprehensible broadcast contents would be outputted unless the channel key storage unit is cleared. In this way, at a time of the channel change, it is necessary to clear the channel key storage unit <highlight><bold>1117</bold></highlight> and newly acquire the channel key from the channel contract information, so that it takes some processing time until the descrambling but the memory capacity of the channel key storage unit <highlight><bold>1117</bold></highlight> can be small, and there will be no need to increase the memory capacity even when the number of channels increases. </paragraph>
<paragraph id="P-0423" lvl="0"><number>&lsqb;0423&rsqb;</number> In order to realize such a scheme, there is a need for the authentication unit <highlight><bold>1114</bold></highlight> to acquire the channel number from the channel information input unit <highlight><bold>1119</bold></highlight>, so that a data flow as indicated by a dashed line in <cross-reference target="DRAWINGS">FIG. 51</cross-reference> is additionally necessary. </paragraph>
<paragraph id="P-0424" lvl="0"><number>&lsqb;0424&rsqb;</number> By adopting the scheme of this fourth embodiment, apart from the merit of being able to reduce the key structure by one stage compared with the third embodiment, the following merit can also be obtained. Namely, suppose that the contractor who had contracted all the channels for one month has cancelled all the channels next month. In this case, this contractor does not wish to acquire the new reception contract information destined to the own broadcast reception device because all the channels become impossible to view or listen when the new reception contract information is acquired. However, this contractor cannot choose not to acquire all the new reception contract information because the reception contract information contains information necessary in decrypting the broadcast contents. </paragraph>
<paragraph id="P-0425" lvl="0"><number>&lsqb;0425&rsqb;</number> In the case of the third embodiment, this necessary information was the channel key decryption key K<highlight><subscript>H </subscript></highlight>but this is common to all the channels so that it suffices to acquire at most one reception contract information at a timing at which the channel key decryption key K<highlight><subscript>H </subscript></highlight>is changed. If the channel key decryption key K<highlight><subscript>H </subscript></highlight>is to be changed once every day, it suffices to acquire just one reception contract information each day, and the possibility for this one reception contract information to contain the contract information for the own broadcast reception device is low so that it is quite possible for this contractor to continue viewing or listening for a long period of time without receiving the reception contract information destined to the own broadcast reception device. </paragraph>
<paragraph id="P-0426" lvl="0"><number>&lsqb;0426&rsqb;</number> In contrast, in this fourth embodiment, the necessary information is the channel key itself, and the channel key is different for different channels, so that it is necessary to change it frequently in view of the safety. For this reason, there is also a need to acquire the reception contract information quite frequently as well, and a probability for not receiving the reception contract information destined to the own broadcast reception device can be lowered considerably. </paragraph>
<paragraph id="P-0427" lvl="0"><number>&lsqb;0427&rsqb;</number> Note however that there is also a significant reason to consider the positive use of the four stage key structure of the third embodiment. If there are many channels (1000 channels for example), the channel key of the desired channel can be acquired only after a considerable number (1000 at worst) of the reception contract information are acquired and decrypted at a time of reception start or at a time of the channel change. This causes such a considerable delay in the reception timing that it is not very practical, and moreover, if the reception error occurs, it would become necessary to wait until the decryption of another 1000 of the reception contract information is over. This problem can be resolved by the four stage key structure of the third embodiment. Namely, in the case of the four stage key structure, there is a key common to all the broadcast reception devices called the channel key decryption key, and all the channel keys can be decrypted using this channel key decryption key so that it is possible to realize the decryption within a certain time regardless of the number of channels. </paragraph>
<paragraph id="P-0428" lvl="0"><number>&lsqb;0428&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 60</cross-reference> shows an exemplary configuration of the broadcast reception device which takes advantages of both of these schemes. Here, the contract information packet and the reception contract information are provided in two formats, where one format is as shown in <cross-reference target="DRAWINGS">FIG. 37</cross-reference> and <cross-reference target="DRAWINGS">FIG. 38</cross-reference> of the third embodiment while another format is as shown in <cross-reference target="DRAWINGS">FIG. 54</cross-reference> and <cross-reference target="DRAWINGS">FIG. 55</cross-reference> of the fourth embodiment. The difference between these two formats is judged by the information identifier in the packet, and when the reception contract information contains the channel key decryption key, the authentication unit <highlight><bold>1114</bold></highlight> sends it to the channel key decryption key storage unit <highlight><bold>1115</bold></highlight>, whereas when the reception contract information contains the channel key, the authentication unit <highlight><bold>1114</bold></highlight> sends it to the channel key storage unit <highlight><bold>1117</bold></highlight>. </paragraph>
<paragraph id="P-0429" lvl="0"><number>&lsqb;0429&rsqb;</number> Here the broadcast station (contract management device) side makes adjustment such that the channel key information will be sent by the ordinary channel separately when the channel key decryption key is contained in the reception contract information, or the channel key information will not be sent otherwise. As a result, it is possible to operate consistently even when circuits for both schemes are mixedly present. </paragraph>
<paragraph id="P-0430" lvl="7"><number>&lsqb;0430&rsqb;</number> (2) Contract Management Device. </paragraph>
<paragraph id="P-0431" lvl="0"><number>&lsqb;0431&rsqb;</number> Next, the contract management device on the information delivery side which corresponds to the broadcast reception device according to this fourth embodiment will be described. </paragraph>
<paragraph id="P-0432" lvl="0"><number>&lsqb;0432&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 71</cross-reference> shows an exemplary configuration of the contract management device according to this fourth embodiment, which realizes all the functions described in this fourth embodiment. A portion corresponding to any functions which are unnecessary in a practical realization of the system may be omitted from this configuration of <cross-reference target="DRAWINGS">FIG. 71</cross-reference>. </paragraph>
<paragraph id="P-0433" lvl="0"><number>&lsqb;0433&rsqb;</number> Note that, in the contract management device shown in <cross-reference target="DRAWINGS">FIG. 71</cross-reference>, those elements which are substantially the same as the corresponding elements in the contract management device of the third embodiment shown in <cross-reference target="DRAWINGS">FIG. 70</cross-reference> will be given the same reference numerals and their description will be omitted. </paragraph>
<paragraph id="P-0434" lvl="0"><number>&lsqb;0434&rsqb;</number> In <cross-reference target="DRAWINGS">FIG. 71</cross-reference>, the channel key decryption key database <highlight><bold>2016</bold></highlight> and the channel key decryption key generation unit <highlight><bold>2018</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 70</cross-reference> are replaced by a channel key database <highlight><bold>2021</bold></highlight> and a channel key generation unit <highlight><bold>2022</bold></highlight> respectively, and the operation of the channel key database <highlight><bold>2021</bold></highlight> and the channel key generation unit <highlight><bold>2022</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 71</cross-reference> are similar to that of the channel key decryption key database <highlight><bold>2016</bold></highlight> and the channel key decryption key generation unit <highlight><bold>2018</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 70</cross-reference> described above except that each occurrence of the channel key decryption key should be replaced by the channel key. </paragraph>
<paragraph id="P-0435" lvl="0"><number>&lsqb;0435&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 61</cross-reference> to <cross-reference target="DRAWINGS">FIG. 67</cross-reference>, the fifth embodiment of a conditional access broadcast system according to the present invention will be described in detail. </paragraph>
<paragraph id="P-0436" lvl="0"><number>&lsqb;0436&rsqb;</number> This fifth embodiment is directed to a configuration of a latch unit for scan path test in the charging control unit <highlight><bold>1106</bold></highlight> at the broadcast reception device, which is commonly utilizable in the conditional access broadcast system of the first to fourth embodiments described above. <cross-reference target="DRAWINGS">FIG. 61</cross-reference> shows an exemplary configuration of the broadcast reception device according to this fifth embodiment. </paragraph>
<paragraph id="P-0437" lvl="0"><number>&lsqb;0437&rsqb;</number> In the conditional access broadcast system, because of its structure, there is a possibility for the system as a whole to break down such that it becomes impossible to charge effectively, when the secret information (especially a key and an algorithm for the master key generation) inside the charging control unit <highlight><bold>1106</bold></highlight> is revealed. Also, if the descrambled broadcast contents outputted in the broadcast reception device of <cross-reference target="DRAWINGS">FIG. 31</cross-reference>, for example, are recorded by the user somehow, it would become possible in principle to reproduce them as many times as the user wishes so that it is not desirable. From this perspective, the charging control unit <highlight><bold>1106</bold></highlight> and an MPEG decoder which utilizes the output of the charging control unit <highlight><bold>1106</bold></highlight> should preferably be formed by an integrated chip. </paragraph>
<paragraph id="P-0438" lvl="0"><number>&lsqb;0438&rsqb;</number> On the other hand, at a time of manufacturing an integrated chip, it is difficult to produce the correct chip at once, so that there is a need to monitor the intermediate result through test pins or the like. Also, these test pins will remain even in the finished product, so that they can provide an opportunity for a person trying to analyze this chip to observe the decryption process albeit the intermediate result only, and thereby provide a situation which is convenient for the cryptoanalysis of the encryption algorithm or the decryption key. This fifth embodiment is devised in order to resolve this problem. </paragraph>
<paragraph id="P-0439" lvl="0"><number>&lsqb;0439&rsqb;</number> To this end, as shown in <cross-reference target="DRAWINGS">FIG. 61</cross-reference>, first and second latch units for scan path test <highlight><bold>1201</bold></highlight> and <highlight><bold>1203</bold></highlight> and first and second scan path output units <highlight><bold>1202</bold></highlight> and <highlight><bold>1204</bold></highlight> are to be added to the broadcast reception device of the first to fourth embodiments. </paragraph>
<paragraph id="P-0440" lvl="0"><number>&lsqb;0440&rsqb;</number> The first and second latch units for scan path test <highlight><bold>1201</bold></highlight> and <highlight><bold>1203</bold></highlight> carry out the operation to capture data flowing therethrough and sending it to the respective first and second scan path output units <highlight><bold>1202</bold></highlight> and <highlight><bold>1204</bold></highlight>. </paragraph>
<paragraph id="P-0441" lvl="7"><number>&lsqb;0441&rsqb;</number> (1) First Latch Unit for Scan Path Test (Test Output of the Reception Contract Information): </paragraph>
<paragraph id="P-0442" lvl="0"><number>&lsqb;0442&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 62</cross-reference> show an exemplary basic configuration of the first latch unit for scan path test <highlight><bold>1201</bold></highlight>. The configuration and the operation of this first latch unit for scan path test <highlight><bold>1201</bold></highlight> will now be described with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 63</cross-reference>. </paragraph>
<paragraph id="P-0443" lvl="0"><number>&lsqb;0443&rsqb;</number> In the first latch unit for scan path test <highlight><bold>1201</bold></highlight>, the output from the contract information decryption unit <highlight><bold>1110</bold></highlight> is received at an input unit <highlight><bold>1301</bold></highlight> (step S<highlight><bold>1101</bold></highlight>), and that data is sent to an authentication unit <highlight><bold>1302</bold></highlight> after a data format change or the like is carried out (if necessary). The authentication unit <highlight><bold>1302</bold></highlight> then makes a judgement as to whether it is allowed to output that data or not (step S<highlight><bold>1102</bold></highlight>). When it is judged that output of that data is allowed, that data is sent to an output unit <highlight><bold>1305</bold></highlight> (step S<highlight><bold>1103</bold></highlight>), and the output unit <highlight><bold>1305</bold></highlight> sends this data to the first scan path output unit <highlight><bold>1202</bold></highlight> (step S<highlight><bold>1104</bold></highlight>). The first scan path output unit <highlight><bold>1202</bold></highlight> then outputs this data outside the charging control unit <highlight><bold>1106</bold></highlight> such that this data will be displayed on a display unit such as a display device which is provided outside the charging control unit <highlight><bold>1106</bold></highlight> (step S<highlight><bold>1105</bold></highlight>). </paragraph>
<paragraph id="P-0444" lvl="0"><number>&lsqb;0444&rsqb;</number> After the step S<highlight><bold>1105</bold></highlight> or when it is judged that the decrypted reception contract information is not to be outputted at the step S<highlight><bold>1102</bold></highlight>, this decrypted reception contract information is outputted as it is to the authentication unit <highlight><bold>1114</bold></highlight> that is provided outside the first latch unit for scan path test <highlight><bold>1201</bold></highlight> (step S<highlight><bold>1106</bold></highlight>). </paragraph>
<paragraph id="P-0445" lvl="0"><number>&lsqb;0445&rsqb;</number> Here, the operation of the authentication unit <highlight><bold>1302</bold></highlight> is important. In the following, in order to describe the operation of the authentication unit <highlight><bold>1302</bold></highlight>, the input data format for the charging control unit <highlight><bold>1106</bold></highlight> will be described first. </paragraph>
<paragraph id="P-0446" lvl="0"><number>&lsqb;0446&rsqb;</number> First, for the sake of simplicity, the most simple way of realization will be described. As the information identifier contained in the configuration of the contract information packet for the third and fourth embodiments (see <cross-reference target="DRAWINGS">FIG. 37</cross-reference> and <cross-reference target="DRAWINGS">FIG. 54</cross-reference>), an identifier for indicating that it is the reception contract information which is allowed to be the scan path output is provided in addition to the ordinary identifier (for indicating the reception contract information). Then, by judging this information identifier at the authentication unit <highlight><bold>1302</bold></highlight>, whether that data should be outputted to the first scan path output unit <highlight><bold>1202</bold></highlight> or not is determined. </paragraph>
<paragraph id="P-0447" lvl="0"><number>&lsqb;0447&rsqb;</number> The scan path output is necessary basically at a time of designing or at a time of shipping from the factory, so that it can be safely assumed that the information identifier for allowing the scan path output will not be transmitted by broadcast waves, and therefore it is quite difficult for the general user to analyze what this information identifier is. </paragraph>
<paragraph id="P-0448" lvl="0"><number>&lsqb;0448&rsqb;</number> Next, an exemplary case of judging whether it is the contract information packet containing the reception contract information which is allowed to be the scan path output or not according to the authentication information corresponding to the contract information packet will be described. <cross-reference target="DRAWINGS">FIG. 64</cross-reference> shows a format of the contract information packet to be entered into the contract information decryption unit <highlight><bold>1110</bold></highlight> in this case. </paragraph>
<paragraph id="P-0449" lvl="0"><number>&lsqb;0449&rsqb;</number> This format differs from that of <cross-reference target="DRAWINGS">FIG. 37</cross-reference> in that the authentication information is added after the encrypted reception contract information. Of course, the format of <cross-reference target="DRAWINGS">FIG. 54</cross-reference> can also be modified similarly as in <cross-reference target="DRAWINGS">FIG. 64</cross-reference>. Note that, in order to distinguish this packet from the contract information packet in the ordinary format (without the authentication information), it is possible to set up another information identifier for that purpose. Else, when the common information identifier is to be used, in order to use the uniform format, the authentication information in the ordinary contract information packet can be set as &ldquo;NULL&rdquo; and any packet with &ldquo;NULL&rdquo; as the authentication information can be interpreted as the ordinary contract information packet. Note here that the latter case is easy to implement but also associated with a drawback that the amount of data increases. </paragraph>
<paragraph id="P-0450" lvl="0"><number>&lsqb;0450&rsqb;</number> As the authentication information, the encrypted reception contract information (or its hash value) applied with the digital signature can be considered. Here the hash value of data is like a digest of data which expresses data of arbitrary length in a given length (120 bits for example), but a digest here does not imply a summary of the content itself and it can be regarded as data converted into a given length by applying some one-way random function called hash function (a mathematical function whose inverse function is difficult to obtain). There are several known such hash functions including MD5 and SHA1. Data to which the digital signature is to be attached must be set in a given length of 64 bits or 120 bits that corresponds to one block of the encryption. For this reason, the reception contract information will be multiplied with the hash function if necessary. </paragraph>
<paragraph id="P-0451" lvl="0"><number>&lsqb;0451&rsqb;</number> Now, the operation of the first latch unit for scan path test <highlight><bold>1201</bold></highlight> including a checking process for receiving the authentication information and the encrypted reception contract information along with the decrypted reception contract information and checks the digital signature as the authentication information, will be described with reference to the flow chart of <cross-reference target="DRAWINGS">FIG. 65</cross-reference>. </paragraph>
<paragraph id="P-0452" lvl="0"><number>&lsqb;0452&rsqb;</number> The input unit <highlight><bold>1301</bold></highlight> receives the authentication information and the encrypted reception contract information along with the decrypted reception contract information (step S<highlight><bold>1121</bold></highlight>), and the authentication unit <highlight><bold>1302</bold></highlight> multiplies the hash function (according to the need) to the (entered) encrypted reception contract information first in order to check the digital signature (step S<highlight><bold>1122</bold></highlight>). On the other hand, the digital signature as the authentication information is decrypted using the public key stored in advance in the authentication unit <highlight><bold>1302</bold></highlight> (step S<highlight><bold>1123</bold></highlight>), and compared with the above hash value. If they coincide (step S<highlight><bold>1124</bold></highlight>), the authentication information can be regarded as proper, so that the data output is carried out similarly as the steps S<highlight><bold>1103</bold></highlight> to S<highlight><bold>1105</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 63</cross-reference> (steps S<highlight><bold>1125</bold></highlight> to S<highlight><bold>1127</bold></highlight>). </paragraph>
<paragraph id="P-0453" lvl="0"><number>&lsqb;0453&rsqb;</number> If they do not coincide at the step S<highlight><bold>1124</bold></highlight>, it is Judged that this authentication information is improper, and the data output is not carried out. After the step S<highlight><bold>1127</bold></highlight> or when the authentication information and the hash value do not coincide at the step S<highlight><bold>1124</bold></highlight>, the decrypted reception contract information is outputted as it is to the authentication unit <highlight><bold>1114</bold></highlight> which is provided outside the first latch unit for scan path test <highlight><bold>1201</bold></highlight> (step S<highlight><bold>1128</bold></highlight>). </paragraph>
<paragraph id="P-0454" lvl="0"><number>&lsqb;0454&rsqb;</number> Here, the digital signature using the public key cryptosystem is the data body (the hash value here) encrypted using the secret key. In the public key cryptosystem, what is encrypted using the secret key can only be decrypted using a key different from the secret key called public key. For this reason, the digital signature decrypted using the public key should become equal to the original hash value. Also, based on the safety of the public key cryptosystem, it can be safely assumed that an only person who can produce data that can be decrypted using the public key is a person who knows that secret key, so that the data obtained by encrypting the hash value using the secret key is referred to as the digital signature of the data. Here the significance of employing the digital signature using the public key cryptosystem lies in that the digital signature cannot be produced using only information contained in the charging control unit <highlight><bold>1106</bold></highlight> so that it becomes practically impossible for a general user to produce data which can cause the latch units for scan path test <highlight><bold>1201</bold></highlight> and <highlight><bold>1203</bold></highlight> to output. </paragraph>
<paragraph id="P-0455" lvl="0"><number>&lsqb;0455&rsqb;</number> Also, the digital signature can be realized using the secret key cryptosystem. In such a case, the hash value is encrypted using the secret key, and it is checked by decrypting it using the secret key so that the secret key must be concealed in the latch unit. However, the secret key cryptosystem has a characteristic that it is faster than the public key cryptosystem, and the secret key to be used is concealed in the tamper resistant hardware called charging chip, so that it is quite difficult to read it out. For this reason, the digital signature using the secret key can be also effective. </paragraph>
<paragraph id="P-0456" lvl="0"><number>&lsqb;0456&rsqb;</number> In order to check the encrypted digital signature, the first latch unit for scan path test <highlight><bold>1201</bold></highlight> receives the encrypted reception contract information that is otherwise unnecessary as its input. In order to avoid this, it is possible to verify the digital signature at the contract information decryption unit <highlight><bold>1110</bold></highlight> and send the verification result to the first latch unit for scan path test <highlight><bold>1201</bold></highlight>. Namely, the major part of the authentication unit <highlight><bold>1302</bold></highlight> of the first latch unit for scan path test <highlight><bold>1201</bold></highlight> can be carried out by the contract information decryption unit <highlight><bold>1110</bold></highlight> instead. In this scheme, however, the data that urges the latch unit to output is always the same so that it is easier to induce the malicious use by a third person. </paragraph>
<paragraph id="P-0457" lvl="0"><number>&lsqb;0457&rsqb;</number> In this regard, it is also possible to apply the digital signature to the output of the contract information decryption unit <highlight><bold>1110</bold></highlight> at the contract information decryption unit <highlight><bold>1110</bold></highlight> when the signature is verified at the contract information decryption unit <highlight><bold>1110</bold></highlight>. In this scheme, the above noted problem of the malicious use can be prevented, but the extra processing will be required. Which scheme is to be adopted should be determined according to the nature of application. </paragraph>
<paragraph id="P-0458" lvl="0"><number>&lsqb;0458&rsqb;</number> Next, the data to be outputted from the first latch unit for scan path test <highlight><bold>1201</bold></highlight> will be described. In all the examples described above, it is assumed that a raw data sequence (a sequence of 0 and 1), that is the decrypted contract reception information itself, is to be outputted. However, it is safer if the data sequence is also encrypted. Namely, using a configuration in which the data outputted from the first latch unit for scan path test <highlight><bold>1201</bold></highlight> (which may be outputted unconditionally) is encrypted so that it can only be decrypted by a display device equipped with the decryption key, it becomes quite difficult to analyze the configuration of the charging control unit <highlight><bold>1106</bold></highlight> from the output of this latch unit <highlight><bold>1201</bold></highlight>. </paragraph>
<paragraph id="P-0459" lvl="0"><number>&lsqb;0459&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 66</cross-reference> shows an exemplary configuration of such a first latch unit for scan path test <highlight><bold>1201</bold></highlight>. In <cross-reference target="DRAWINGS">FIG. 66</cross-reference>, it becomes even safer if the public key cryptosystem is introduced into an encryption unit <highlight><bold>1303</bold></highlight> so as to carry out the encryption using the public key, because the encrypted output data can only be decrypted using the secret key which is not contained in the charging control unit <highlight><bold>1106</bold></highlight>. However, in practice, it is probably more likely to use the secret key cryptosystem from a viewpoint of processing time. In such a case, there is a need to conceal the secret key in an encryption key storage unit <highlight><bold>1304</bold></highlight>, because otherwise the secret key can be revealed and the output content can be revealed by decrypting the encrypted output data by a third person. </paragraph>
<paragraph id="P-0460" lvl="7"><number>&lsqb;0460&rsqb;</number> (2) Second Latch Unit for Scan Path Test (Test Output of the Reception Device ID): </paragraph>
<paragraph id="P-0461" lvl="0"><number>&lsqb;0461&rsqb;</number> Next, the second latch unit for scan path test <highlight><bold>1203</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 61</cross-reference> will be described. The operation of the second latch unit for scan path test <highlight><bold>1203</bold></highlight> is basically the same as that of the first latch unit for scan path test <highlight><bold>1201</bold></highlight> described above, but in contrast to the first latch unit <highlight><bold>1201</bold></highlight> in which data simply passes in one direction so to speak, the second latch unit <highlight><bold>1203</bold></highlight> also carries out the reading of the reception device ID from the reception device ID storage unit <highlight><bold>1113</bold></highlight> and latches that result so that its configuration is somewhat more complicated. </paragraph>
<paragraph id="P-0462" lvl="0"><number>&lsqb;0462&rsqb;</number> This second latch unit <highlight><bold>1203</bold></highlight> is provided in order to check whether or not the reception device ID is properly stored in the reception device ID storage unit <highlight><bold>1113</bold></highlight> formed by a non-volatile memory, for example. <cross-reference target="DRAWINGS">FIG. 67</cross-reference> shows an exemplary configuration of the second latch unit for scan path test <highlight><bold>1203</bold></highlight>. </paragraph>
<paragraph id="P-0463" lvl="0"><number>&lsqb;0463&rsqb;</number> The data from the authentication unit <highlight><bold>1114</bold></highlight> is received at a first input unit <highlight><bold>1401</bold></highlight> of the second latch unit for scan path test <highlight><bold>1203</bold></highlight>, and sent to an authentication unit <highlight><bold>1402</bold></highlight>. The authentication unit <highlight><bold>1402</bold></highlight> then carries out the authentication regarding whether the latch output is allowed or not for the input, similarly as the authentication unit <highlight><bold>1302</bold></highlight> of the first latch unit <highlight><bold>1201</bold></highlight> described above. </paragraph>
<paragraph id="P-0464" lvl="0"><number>&lsqb;0464&rsqb;</number> The authentication result is stored in an authentication result storage unit <highlight><bold>1403</bold></highlight>. On the other hand, a command for requesting the output of the reception device ID is sent from the authentication unit <highlight><bold>1402</bold></highlight> to the reception device ID storage unit <highlight><bold>1113</bold></highlight>. Upon receiving this, the reception device ID storage unit <highlight><bold>1113</bold></highlight> outputs the reception device ID, and enters it into a second input unit <highlight><bold>1405</bold></highlight>. The reception device ID is then sent to a latch output permit/reject judgement unit <highlight><bold>1404</bold></highlight>, where the authentication result stored in the authentication result storage unit <highlight><bold>1403</bold></highlight> is referred, and if it is authenticated, the reception device ID is outputted to the second scan path output unit <highlight><bold>1204</bold></highlight>. </paragraph>
<paragraph id="P-0465" lvl="0"><number>&lsqb;0465&rsqb;</number> Note that the latch output permit/reject judgement unit <highlight><bold>1404</bold></highlight> outputs the reception device ID received from the reception device ID storage unit <highlight><bold>1113</bold></highlight> to the external authentication unit <highlight><bold>1114</bold></highlight> regardless of whether it is authenticated or not at the authentication unit <highlight><bold>1402</bold></highlight>. </paragraph>
<paragraph id="P-0466" lvl="0"><number>&lsqb;0466&rsqb;</number> By adding the encryption unit <highlight><bold>1303</bold></highlight> and the encryption key storage unit <highlight><bold>1304</bold></highlight> as shown in <cross-reference target="DRAWINGS">FIG. 66</cross-reference> at a stage subsequent to the latch output permit/reject judgement unit <highlight><bold>1404</bold></highlight>, it also becomes possible to output the reception device ID in an encrypted form similarly as described above. </paragraph>
<paragraph id="P-0467" lvl="0"><number>&lsqb;0467&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 81</cross-reference> and <cross-reference target="DRAWINGS">FIG. 82</cross-reference>, the sixth embodiment of a conditional access broadcast system according to the present invention will be described in detail. </paragraph>
<paragraph id="P-0468" lvl="7"><number>&lsqb;0468&rsqb;</number> (1) Overview of the Broadcast System: </paragraph>
<paragraph id="P-0469" lvl="0"><number>&lsqb;0469&rsqb;</number> This sixth embodiment differs from the third to fifth embodiments in that, instead of delivering the reception contract information to the broadcast reception devices by broadcast, the reception contract information is recorded in a portable card shaped recording medium (referred to simply as a card hereafter) P such as a magnetic card for example, and this card P is delivered by the home delivery service or the mail to the user. The contracting user can receive the contracted channels by operating the broadcast reception device to read the information recorded in the received card P. </paragraph>
<paragraph id="P-0470" lvl="0"><number>&lsqb;0470&rsqb;</number> Here, the contrast management device (see <cross-reference target="DRAWINGS">FIG. 81</cross-reference>) and the broadcast reception device (see <cross-reference target="DRAWINGS">FIG. 82</cross-reference>) which correspond to the contract management device (see <cross-reference target="DRAWINGS">FIG. 70</cross-reference>) and the broadcast reception device (see <cross-reference target="DRAWINGS">FIG. 31</cross-reference>) of the third embodiment will be described as an example, but this sixth embodiment can be similarly applied to the contract management device and the broadcast reception device of the other embodiments. Namely, in the contract management device according to this sixth embodiment, the broadcast device <highlight><bold>2013</bold></highlight> of the contract management device of the third to fifth embodiments is replaced by a card production unit <highlight><bold>2051</bold></highlight>, or the card production unit <highlight><bold>2051</bold></highlight> is added. The card production unit <highlight><bold>2051</bold></highlight> is made to write the encrypted reception contract information into the card P of the contracting user. Also, in the broadcast reception device according to this sixth embodiment, the encrypted reception contract information read out from the card P inserted into a card reader <highlight><bold>2061</bold></highlight> is entered into the contract information decryption unit <highlight><bold>1110</bold></highlight>. </paragraph>
<paragraph id="P-0471" lvl="7"><number>&lsqb;0471&rsqb;</number> (2) Contract Management Device: </paragraph>
<paragraph id="P-0472" lvl="0"><number>&lsqb;0472&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 81</cross-reference> shows an exemplary configuration of the contract management device according to this sixth embodiment, where the elements identical to those in <cross-reference target="DRAWINGS">FIG. 70</cross-reference> are given the same reference numerals and their description will be omitted. Namely, in <cross-reference target="DRAWINGS">FIG. 81</cross-reference>, the broadcast device <highlight><bold>13</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 70</cross-reference> for delivering the reception contract information of each reception device through the terrestrial or satellite broadcast is replaced by a card production unit <highlight><bold>2051</bold></highlight>, or a card production unit <highlight><bold>2051</bold></highlight> is provided in addition and set to be switchable appropriately according to the need. </paragraph>
<paragraph id="P-0473" lvl="0"><number>&lsqb;0473&rsqb;</number> The reception contract information according to the contract period of the reception device corresponding to the card P is recorded into that card P by the card production unit <highlight><bold>2051</bold></highlight> and delivered to the contracting user. </paragraph>
<paragraph id="P-0474" lvl="0"><number>&lsqb;0474&rsqb;</number> When the master key is to be updated every month with respect to the contracting users who have the contract for four months from Dec. 1, 1997, for example, it is necessary in the contract management device of <cross-reference target="DRAWINGS">FIG. 70</cross-reference> described above to produce the reception contract information every month so that it is necessary to retrieve the valid channel key decryption key and the valid master key and carry out the processing of the flow chart of <cross-reference target="DRAWINGS">FIG. 73</cross-reference> every month. In contrast, in the contract management device of <cross-reference target="DRAWINGS">FIG. 81</cross-reference>, it suffices to write the reception contract information corresponding to the channel key decryption keys of the contracted channels for coming four months in the card P for example and deliver the card to the user, without using the broadcasting. In this way, it becomes unnecessary to deliver the reception contract information every month so that it is convenient for both the broadcast station side and the user side in a sense that tediousness can be reduced. </paragraph>
<paragraph id="P-0475" lvl="0"><number>&lsqb;0475&rsqb;</number> Now, in order to produce the reception contract information, it is necessary for the contract management device to know the reception device ID of the broadcast reception device purchased by the contracting user. Of course, this reception device ID is written in the tamper resistant reception device ID storage unit <highlight><bold>1113</bold></highlight> in each broadcast reception device so that it cannot be read out from the external. Consequently, there is a need to provide a way to input the reception device ID of the broadcast reception device purchased by the contracting user into the contract management device. </paragraph>
<paragraph id="P-0476" lvl="0"><number>&lsqb;0476&rsqb;</number> To this end, one way of inputting the reception device ID of the purchased broadcast reception device into the contract management device will now be described. </paragraph>
<paragraph id="P-0477" lvl="0"><number>&lsqb;0477&rsqb;</number> Namely, an open reception device ID (which is an identifier in one-to-one correspondence to the reception device ID and which may be obtained by encrypting the reception device ID itself, for example) of the purchased broadcast reception device is printed on a casing or a package box of that broadcast reception device, for example. Then, as shown in <cross-reference target="DRAWINGS">FIG. 81, a</cross-reference> contract information input unit <highlight><bold>2072</bold></highlight> and an open reception device ID conversion unit <highlight><bold>2071</bold></highlight> are additionally provided in the contract management device. </paragraph>
<paragraph id="P-0478" lvl="0"><number>&lsqb;0478&rsqb;</number> At a time of making contract, the contract information of the user and the open reception device ID of the broadcast reception device purchased by that user are to be entered at the contract information input unit <highlight><bold>2072</bold></highlight>. For this input, a scanner or the like may be used, for example, but it is not limited to any specific manner. </paragraph>
<paragraph id="P-0479" lvl="0"><number>&lsqb;0479&rsqb;</number> The open reception device ID conversion unit <highlight><bold>2071</bold></highlight> stores in advance a conversion table <highlight><bold>2073</bold></highlight> indicating correspondences between the open reception IDs and the reception device IDs. </paragraph>
<paragraph id="P-0480" lvl="0"><number>&lsqb;0480&rsqb;</number> The open reception device ID entered at the contract information input unit <highlight><bold>2072</bold></highlight> is given to the open reception device ID conversion unit <highlight><bold>2071</bold></highlight>, where the open reception device ID is converted into the reception device ID by referring to the conversion table <highlight><bold>2073</bold></highlight> (that is, by retrieving the reception device ID corresponding to the open reception device ID from the conversion table <highlight><bold>2073</bold></highlight>), and the obtained reception device ID is given to the payment confirmation waiting database <highlight><bold>2002</bold></highlight>. </paragraph>
<paragraph id="P-0481" lvl="0"><number>&lsqb;0481&rsqb;</number> On the other hand, the contract information entered at the contract information input unit <highlight><bold>2072</bold></highlight> is given to the payment confirmation waiting database <highlight><bold>2002</bold></highlight>. The payment confirmation waiting database <highlight><bold>2002</bold></highlight> then registers this contract information in correspondence to the reception device ID received from the open reception device ID conversion unit <highlight><bold>2071</bold></highlight>. </paragraph>
<paragraph id="P-0482" lvl="0"><number>&lsqb;0482&rsqb;</number> The subsequent operation with respect to the payment confirmation waiting database <highlight><bold>2002</bold></highlight> is the same as that for the payment confirmation waiting database <highlight><bold>2</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 3</cross-reference>. </paragraph>
<paragraph id="P-0483" lvl="7"><number>&lsqb;0483&rsqb;</number> (3) Reception Device: </paragraph>
<paragraph id="P-0484" lvl="0"><number>&lsqb;0484&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 82</cross-reference> shows an exemplary configuration of the broadcast reception device according to this six embodiment, where the elements identical to those in <cross-reference target="DRAWINGS">FIG. 31</cross-reference> are given the same reference numerals and their description will be omitted. Namely, in <cross-reference target="DRAWINGS">FIG. 82</cross-reference>, the card reader <highlight><bold>2061</bold></highlight> for reading out the encrypted reception contract information from the card P produced at the contract management device that is provided at the broadcast station side as shown in <cross-reference target="DRAWINGS">FIG. 81</cross-reference> is additionally provided, and the encrypted reception contract information read out from the card P at the card reader <highlight><bold>2061</bold></highlight> is entered into the contract information decryption unit <highlight><bold>1110</bold></highlight>. </paragraph>
<paragraph id="P-0485" lvl="0"><number>&lsqb;0485&rsqb;</number> The subsequent operation is the same as in the third embodiment described above. </paragraph>
<paragraph id="P-0486" lvl="0"><number>&lsqb;0486&rsqb;</number> As described above, according to the present invention, it is possible to realize the conditional access while maintaining the same level of safety even when the broadcast bandwidth available to transmission of information related to the conditional access is narrow or when the number of contractors increased beyond the expectation. </paragraph>
<paragraph id="P-0487" lvl="0"><number>&lsqb;0487&rsqb;</number> It is to be noted that, besides those already mentioned above, many modifications and variations of the above embodiments may be made without departing from the novel and advantageous features of the present invention. Accordingly, all such modifications and variations are intended to be included within the scope of the appended claims. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is claimed is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. A broadcast reception device, comprising: 
<claim-text>storage means for storing a master key commonly provided with respect to a plurality of broadcast reception devices and one reception device ID uniquely assigned to said broadcast reception device; </claim-text>
<claim-text>receiving means for receiving encrypted contents information delivered from a broadcast station by broadcast; </claim-text>
<claim-text>decrypting means for decrypting encrypted reception contract information using the master key and the encrypted contents information using a channel key, the encrypted reception contract information being received from the broadcast station and containing at least a contract information for controlling decryption of the encrypted contents information and a reception device ID in correspondence; and </claim-text>
<claim-text>control means for selectively acquiring one contract information corresponding to a reception device ID that coincides with said one reception device ID, from the encrypted reception contract information decrypted by the decrypting means and controlling whether or not to give the channel key to the decrypting means according to said one contract information. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The broadcast reception device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the channel key is received from the broadcast station, separately from the reception contract information, and the control means controls such that the channel key is not given to the decrypting means unless the reception contract information is received. </claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The broadcast reception device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein an encrypted channel key is received from the broadcast station, separately from the reception contract information, and the control means controls such that the encrypted channel key is not decrypted unless the reception contract information containing a channel key decryption key for decrypting the encrypted channel key is received. </claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The broadcast reception device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein one part of the channel key is received from the broadcast station, separately from the reception contract information, and the control unit controls such that the channel key is not obtained from said one part unless the reception contract information containing a remaining part of the channel key is received. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. The broadcast reception device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the channel key is contained in the encrypted reception contract information so that the channel key cannot be obtained unless the encrypted reception contract information is received. </claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The broadcast reception device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the receiving means receives ordinary broadcast waves containing the encrypted contents information and contract broadcast waves containing the encrypted reception contract information, and the channel key is obtained by decrypting an encrypted channel key contained in the ordinary broadcast waves or the contract broadcast waves using the master key, while the contract information is obtained by decrypting the encrypted reception contract information contained in the contract broadcast waves using the master key. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. The broadcast reception device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the receiving means receives ordinary broadcast waves containing the encrypted contents information and contract broadcast waves containing the encrypted reception contract information which contains a channel key decryption key for decrypting an encrypted channel key, and the channel key decryption key and the contract information are obtained by decrypting the encrypted reception contract information contained in the contract broadcast waves using the master key, while the channel key is obtained by decrypting the encrypted channel key contained in the ordinary broadcast waves or the contract broadcast waves using the channel key decryption key. </claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The broadcast reception device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the receiving means receives ordinary broadcast waves containing the encrypted contents information and one part of the channel key and contract broadcast waves containing the encrypted reception contract information which contains a remaining part of the channel key, and the remaining part of the channel key and the contract information are obtained by decrypting the encrypted reception contract information contained in the contract broadcast waves using the master key, while the channel key is obtained from said one part of the channel key contained in the ordinary broadcast waves and the remaining part of or the channel key. </claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. The broadcast reception device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the receiving means receives ordinary broadcast waves containing the encrypted contents information and contract broadcast waves containing the encrypted reception contract information which contains the channel key, and the channel key and the contract information are obtained by decrypting the encrypted reception contract information contained in the contract broadcast waves using the master key. </claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. The broadcast reception device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the receiving means receives data in which an authenticator is attached to each information element which is necessary in decrypting the encrypted contents information and for which an accuracy of content is required, and the control means authenticates each information element using a corresponding authenticator and invalidates each information element for which authentication fails. </claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. The broadcast reception device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the control means verifies a digital signature contained in the encrypted reception contract information, and accepts the contract information contained in the encrypted reception contract information which has the digital signature that is verified as proper. </claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. The broadcast reception device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, further comprising: 
<claim-text>test control means for controlling whether or not to permit test output of internal data, either by checking an identifier indicating a test encrypted reception contract information that is attached to the encrypted reception contract information, or by verifying a digital signature attached to the encrypted reception contract information. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. The broadcast reception device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, further comprising: 
<claim-text>means for reading the encrypted reception contract information from a card shaped recording medium recording the encrypted reception contract information. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. The broadcast reception device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the control means changes a type of processing to be applied to the encrypted reception contract information according to an identifier indicating a type of information which is contained in the encrypted reception contract information. </claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. The broadcast reception device of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein the storage means, the decrypting means, and the control means are provided within a single chip. </claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. A contract management device, comprising: 
<claim-text>management means for managing contract information for controlling decryption of encrypted contents information delivered from a broadcast station by broadcast, with respect to a plurality of broadcast reception devices each of which decrypts the encrypted contents information according to the contract information; and </claim-text>
<claim-text>delivery means for delivering to said plurality of broadcast reception devices a reception contract information containing at least the contract information and a reception device ID in correspondence, the reception device ID being uniquely assigned to each broadcast reception device, by encrypting the reception contract information using a master key which is commonly provided with respect to said plurality of broadcast reception devices. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. The contract management device of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein each broadcast reception device is controlled such that a channel key for decrypting the encrypted contents information is not given to a decryption unit for decrypting the encrypted contents information unless the contract information for own broadcast reception device is received, and the delivery unit also delivers the channel key to said plurality of broadcast reception devices, separately from the reception contract information. </claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. The contract management device of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein each broadcast reception device is controlled such that an encrypted channel key for decrypting the encrypted contents information is not decrypted unless the contract information for own broadcast reception device is received, and the delivery unit delivers the reception contact information which also contains a channel key decryption key for decrypting the encrypted channel key. </claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. The contract management device of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein each broadcast reception device is controlled such that a channel key for decrypting the encrypted contents information is not obtained unless the contract information for own broadcast reception device is received, the delivery means delivering the reception contract information which also contains one part of the channel key and the delivery means also delivering a remaining part of the channel key to said plurality of broadcast reception devices, separately from the reception contract information. </claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. The contract management device of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein each broadcast reception device is controlled such that a channel key for decrypting the encrypted contents information is not obtained unless the contract information for own broadcast reception device is received, and the delivery means delivering the reception contract information which also contains the channel key. </claim-text>
</claim>
<claim id="CLM-00021">
<claim-text><highlight><bold>21</bold></highlight>. The contract management device of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein the delivery means delivers the reception contract information by recording an encrypted reception contract information in a card shaped recording medium and delivering the card shaped recording medium to each broadcast reception device. </claim-text>
</claim>
<claim id="CLM-00022">
<claim-text><highlight><bold>22</bold></highlight>. The contract management device of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein the delivery means selectively delivers the reception contract information of those broadcast reception devices for which the contract information has been changed. </claim-text>
</claim>
<claim id="CLM-00023">
<claim-text><highlight><bold>23</bold></highlight>. The contract management device of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein the delivery means changes a form by which the reception contract information is delivered, depending on a number of broadcast reception devices to which the reception contract information is to be delivered.</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>2</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030002680A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030002680A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030002680A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030002680A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030002680A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030002680A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030002680A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030002680A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030002680A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00009">
<image id="EMI-D00009" file="US20030002680A1-20030102-D00009.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00010">
<image id="EMI-D00010" file="US20030002680A1-20030102-D00010.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00011">
<image id="EMI-D00011" file="US20030002680A1-20030102-D00011.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00012">
<image id="EMI-D00012" file="US20030002680A1-20030102-D00012.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00013">
<image id="EMI-D00013" file="US20030002680A1-20030102-D00013.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00014">
<image id="EMI-D00014" file="US20030002680A1-20030102-D00014.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00015">
<image id="EMI-D00015" file="US20030002680A1-20030102-D00015.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00016">
<image id="EMI-D00016" file="US20030002680A1-20030102-D00016.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00017">
<image id="EMI-D00017" file="US20030002680A1-20030102-D00017.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00018">
<image id="EMI-D00018" file="US20030002680A1-20030102-D00018.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00019">
<image id="EMI-D00019" file="US20030002680A1-20030102-D00019.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00020">
<image id="EMI-D00020" file="US20030002680A1-20030102-D00020.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00021">
<image id="EMI-D00021" file="US20030002680A1-20030102-D00021.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00022">
<image id="EMI-D00022" file="US20030002680A1-20030102-D00022.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00023">
<image id="EMI-D00023" file="US20030002680A1-20030102-D00023.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00024">
<image id="EMI-D00024" file="US20030002680A1-20030102-D00024.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00025">
<image id="EMI-D00025" file="US20030002680A1-20030102-D00025.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00026">
<image id="EMI-D00026" file="US20030002680A1-20030102-D00026.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00027">
<image id="EMI-D00027" file="US20030002680A1-20030102-D00027.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00028">
<image id="EMI-D00028" file="US20030002680A1-20030102-D00028.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00029">
<image id="EMI-D00029" file="US20030002680A1-20030102-D00029.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00030">
<image id="EMI-D00030" file="US20030002680A1-20030102-D00030.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00031">
<image id="EMI-D00031" file="US20030002680A1-20030102-D00031.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00032">
<image id="EMI-D00032" file="US20030002680A1-20030102-D00032.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00033">
<image id="EMI-D00033" file="US20030002680A1-20030102-D00033.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00034">
<image id="EMI-D00034" file="US20030002680A1-20030102-D00034.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00035">
<image id="EMI-D00035" file="US20030002680A1-20030102-D00035.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00036">
<image id="EMI-D00036" file="US20030002680A1-20030102-D00036.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00037">
<image id="EMI-D00037" file="US20030002680A1-20030102-D00037.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00038">
<image id="EMI-D00038" file="US20030002680A1-20030102-D00038.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00039">
<image id="EMI-D00039" file="US20030002680A1-20030102-D00039.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00040">
<image id="EMI-D00040" file="US20030002680A1-20030102-D00040.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00041">
<image id="EMI-D00041" file="US20030002680A1-20030102-D00041.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00042">
<image id="EMI-D00042" file="US20030002680A1-20030102-D00042.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00043">
<image id="EMI-D00043" file="US20030002680A1-20030102-D00043.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00044">
<image id="EMI-D00044" file="US20030002680A1-20030102-D00044.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00045">
<image id="EMI-D00045" file="US20030002680A1-20030102-D00045.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00046">
<image id="EMI-D00046" file="US20030002680A1-20030102-D00046.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00047">
<image id="EMI-D00047" file="US20030002680A1-20030102-D00047.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00048">
<image id="EMI-D00048" file="US20030002680A1-20030102-D00048.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00049">
<image id="EMI-D00049" file="US20030002680A1-20030102-D00049.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00050">
<image id="EMI-D00050" file="US20030002680A1-20030102-D00050.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00051">
<image id="EMI-D00051" file="US20030002680A1-20030102-D00051.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00052">
<image id="EMI-D00052" file="US20030002680A1-20030102-D00052.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00053">
<image id="EMI-D00053" file="US20030002680A1-20030102-D00053.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00054">
<image id="EMI-D00054" file="US20030002680A1-20030102-D00054.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00055">
<image id="EMI-D00055" file="US20030002680A1-20030102-D00055.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00056">
<image id="EMI-D00056" file="US20030002680A1-20030102-D00056.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
