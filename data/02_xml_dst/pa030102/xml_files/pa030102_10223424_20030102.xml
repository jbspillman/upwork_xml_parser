<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030001089A1-20030102-D00000.TIF SYSTEM "US20030001089A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030001089A1-20030102-D00001.TIF SYSTEM "US20030001089A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030001089A1-20030102-D00002.TIF SYSTEM "US20030001089A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030001089A1-20030102-D00003.TIF SYSTEM "US20030001089A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030001089A1-20030102-D00004.TIF SYSTEM "US20030001089A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030001089A1-20030102-D00005.TIF SYSTEM "US20030001089A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030001089A1-20030102-D00006.TIF SYSTEM "US20030001089A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030001089A1-20030102-D00007.TIF SYSTEM "US20030001089A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030001089A1-20030102-D00008.TIF SYSTEM "US20030001089A1-20030102-D00008.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030001089</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10223424</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20020819</filing-date>
</domestic-filing-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>H01J049/40</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>250</class>
<subclass>287000</subclass>
</uspc>
</classification-us-primary>
<classification-us-secondary>
<uspc>
<class>250</class>
<subclass>286000</subclass>
</uspc>
</classification-us-secondary>
</classification-us>
<title-of-invention>Voltage pulser circuit</title-of-invention>
</technical-information>
<continuity-data>
<continuations>
<continuation-of>
<parent-child>
<child>
<document-id>
<doc-number>10223424</doc-number>
<kind-code>A1</kind-code>
<document-date>20020819</document-date>
</document-id>
</child>
<parent>
<document-id>
<doc-number>09313923</doc-number>
<document-date>19990518</document-date>
<country-code>US</country-code>
</document-id>
</parent>
<parent-status>GRANTED</parent-status>
<parent-patent>
<document-id>
<doc-number>6437325</doc-number>
<country-code>US</country-code>
</document-id>
</parent-patent>
</parent-child>
</continuation-of>
</continuations>
</continuity-data>
<inventors>
<first-named-inventor>
<name>
<given-name>James</given-name>
<middle-name>P.</middle-name>
<family-name>Reilly</family-name>
</name>
<residence>
<residence-us>
<city>Bloomington</city>
<state>IN</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Noah</given-name>
<middle-name>P.</middle-name>
<family-name>Christian</family-name>
</name>
<residence>
<residence-us>
<city>Bloomington</city>
<state>IN</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<correspondence-address>
<name-1>BARNES &amp; THORNBURG</name-1>
<name-2></name-2>
<address>
<address-1>11 SOUTH MERIDIAN</address-1>
<city>INDIANAPOLIS</city>
<state>IN</state>
<postalcode>46204</postalcode>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">A time-of-flight mass spectra calibration technique uses time-of-flight mass spectrometer instrument operational parameters and known mass and measured time-of-flight data pairs to optimize values of chosen ones of the instrument operational parameters. Electrostatic time-of-flight calculations are conducted in conjunction with an iterative procedure, preferably a simplex optimization procedure, to thereby minimize a residual error between the electrostatic time-of-flight calculations and the measured time-of-flight data values for each of the known mass values. While conventional curve fitting mass calibration techniques are devoid of information that describe ion behavior, the mass calibration technique of the present invention, by contrast, takes into account all of the instrument operational parameters in arriving at a final calibration. Because the electrostatic TOF calculation is a description of ion behavior in an actual TOF mass spectrometer instrument rather than a polynomial representation of a curve, it is well behaved and does not contain any instabilities where unpredictable calibration errors might occur. Moreover, unlike conventional curve fitting mass calibration techniques, the mass calibration technique of the present invention maintains mass accuracy in extrapolated mass ranges. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">FIELD OF THE INVENTION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> The present invention relates generally to techniques for determining mass values from time-of-flight information in time-of-flight mass spectrometry, and more specifically to techniques for calibrating time-of-flight mass spectra to thereby improve the accuracy of such mass value determinations. </paragraph>
</section>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> In the field of time-of-flight (TOF) mass spectrometry, instrumentation and operational techniques directed at maximizing mass resolution are known. An example of one such technique is detailed in U.S. Pat. Nos. 5,504,326, 5,510,613 and 5,712,479 to Reilly et al., each of which are assigned to the assignee of the present invention. The Reilly et al. references describe a spatial-velocity correlation focusing technique that provides for improved resolution in time-of-flight measurements. However, as with any TOF instrument, the measured time-of-flight data must be subsequently converted to corresponding mass values in order to provide useful mass information. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> Accurate conversion of time-of-flight data to mass values typically requires calibration of experimentally measured time-of-flight mass spectra using known mass value information. Heretofore, various curve fitting techniques have been used for calibrating time of flight mass spectra. It is known that the mass-to-charge ratio (m/z) of an ion traveling through a TOF mass spectrometer is approximately proportional to the square of its time of flight, and this relationship is commonly used in known curve fitting techniques to numerically solve for a set of coefficients in a polynomial representation relating time-of-flight to mass. The exact equation used may vary depending upon the instrument configuration and accuracy required, and a variety of graphing, numerical and mass spectral analysis software packages are commercially available for rapidly performing such calibrations. </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> While curve fitting techniques have been widely accepted and used for performing mass spectra calibrations, such techniques have several drawbacks associated therewith. For example, all known curve fitting and neural network techniques are devoid of information contained in electrostatic ion calculations and are therefore independent of TOF mass spectrometer operating parameters. Ion times of flight, particularly when using delayed extraction techniques, have an infinite expansion of high order non-linearities that can adversely affect the accuracy of curve fitting techniques. Curve fitting techniques can compensate for such non-linearities by including additional terms in the series expansion of the mass/TOF equation, although a regression fit of mass calibrants to a function is generally devoid of information relating to instrument operating conditions that can describe ion behavior, and is therefore missing information that may be useful in mass calibration. A second drawback with known curve fitting techniques used for mass spectra calibration is that the accuracy of such techniques can decrease significantly outside of the mass range of the calibration. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> What is therefore needed is an improved time-of-flight mass spectra calibration technique that addresses at least the foregoing drawbacks of known mass calibration techniques. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> The foregoing shortcomings of the prior art are addressed by the present invention. In accordance with one aspect of the present invention, a system for calibrating time-of-flight (TOF) mass spectra comprises a memory having a plurality of TOF mass spectrometer instrument operational parameters and at least one known mass value and associated measured time of flight value stored therein, and a computer in communication with the memory. The computer is operable to compute a time of flight of said at least one known mass value as an electrostatic function of the plurality of instrument operational parameters and adjust at least one of the plurality of instrument operational parameters to thereby minimize a difference between the computed time of flight and the measured time of flight value. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> In accordance with another aspect of the present invention, a method of calibrating time-of-flight (TOF) mass spectra comprises the steps of providing a plurality of TOF mass spectrometer instrument operational parameters, providing at least one known mass value and associated measured time of flight value therefore, computing a time of flight of said at least one known mass value as an electrostatic function of the plurality of instrument operational parameters, and adjusting at least one of the instrument operational parameters to thereby minimize a difference between the computed time of flight and the measured time of flight value. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> In accordance with a further aspect of the present invention, a method of calibrating time-of-flight (TOF) mass spectra comprises the steps of providing a plurality of TOF mass spectrometer instrument operational parameters, providing at least one known mass value and associated measured time of flight value therefore, computing a time of flight of said at least one known mass value as an electrostatic function of the plurality of instrument operational parameters, and iteratively optimizing at least one of the plurality of instrument operating parameters until the time of flight computed as an electrostatic function of the plurality of instrument operating parameters matches the measured time of flight value within a predetermined error tolerance value. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> One object of the present invention is to provide a system and method for improving the accuracy of mass value determinations based on time-of-flight information provided by a time-of-flight mass spectrometer. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> Another object of the present invention is to improve the accuracy of mass value determinations by providing for an improved technique for calibrating time of flight mass spectra. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> Yet another object of the present invention is to provide a time of flight mass spectra calibration technique that is based on physical operational parameters of the mass spectrometer instrument rather than on a conventional calibration equation containing a collection of terms representing approximate or arbitrary factors. </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> These and other objects of the present invention will become more apparent from the following description of the preferred embodiments. </paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a cross-section of a prior art time-of-flight (TOF) mass spectrometer illustrating at least some of the operational parameters of an instrument of this type. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a diagrammatic illustration of one preferred embodiment of a high voltage switch for use as a voltage pulsing device in the operation of a mass spectrometer instrument such as the instrument illustrated in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, in accordance with one aspect of the present invention. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a diagrammatic illustration of a prior art computer-based electronic interface to the instrument shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a diagrammatic illustration of one preferred embodiment of some of the internal features of the computer illustrated in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>, in accordance with another aspect of the present invention, for calibrating time-of-flight mass spectra. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is a flowchart illustrating one preferred technique for calibrating time-of-flight mass spectra with the electronic interface embodiment shown in <cross-reference target="DRAWINGS">FIGS. 3 and 4</cross-reference>, in accordance with the present invention. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is a diagrammatic illustration of one preferred embodiment of the mass spectra calibration routine of <cross-reference target="DRAWINGS">FIG. 5</cross-reference>, in accordance with the present invention. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a plot of error in fit vs. actual mass for a gold nanoparticle mixture comparing a 5-term conventional curve fit mass spectra calibration technique to a 3-term mass spectra calibration technique of the present invention. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a plot of error in fit vs. actual mass for a gold nanaoparticle mixture similar to that shown in <cross-reference target="DRAWINGS">FIG. 7</cross-reference> wherein the respective mass spectra calibration techniques were conducted over a more narrow mass range than for the plot shown in <cross-reference target="DRAWINGS">FIG. 7</cross-reference>. </paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DESCRIPTION OF THE PREFERRED EMBODIMENTS </heading>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> For the purposes of promoting an understanding of the principles of the invention, reference will now be made to the embodiments illustrated in the drawings and specific language will be used to describe the same. It will nevertheless be understood that no limitation of the scope of the invention is thereby intended, such alterations and further modifications in the illustrated devices, and such further applications of the principles of the invention as illustrated therein being contemplated as would normally occur to one skilled in the art to which the invention relates. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 1, a</cross-reference> prior art time-of-flight (TOF) mass spectrometer <highlight><bold>100</bold></highlight> is shown. In the embodiment <highlight><bold>100</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, power sources <highlight><bold>122</bold></highlight> and <highlight><bold>124</bold></highlight>, and voltage pulser <highlight><bold>128</bold></highlight> are preferably actuated with specific timing and magnitude, depending on the internal geometry of the TOFMS <highlight><bold>100</bold></highlight> and the ion generation geometry, to simultaneously minimize the effects of initial position distribution and initial velocity distribution of the generated ions on the mass resolution of the TOFMS. Further details of such operation as well as details regarding some alternative ion source geometries are provided in U.S. Pat. Nos. 5,504,326, 5,510,613 and 5,712,479 to Reilly et al., each of which are assigned to the assignee of the present invention, and each of which are incorporated herein by reference. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> In a preferred embodiment, power sources <highlight><bold>122</bold></highlight>, <highlight><bold>124</bold></highlight>, <highlight><bold>126</bold></highlight>, and <highlight><bold>129</bold></highlight> are DC high voltage power supplies. Alternatively, supplies <highlight><bold>122</bold></highlight> and/or <highlight><bold>124</bold></highlight> may supply time dependent voltages that originally modify the spatial and velocity distributions of the ions before application of the output from voltage pulser <highlight><bold>128</bold></highlight>. Careful selection of these and other TOFMS parameters significantly reduces the mass spectral peak broadening due to the initial ion velocity and spatial distributions as more fully described in the above-identified Reilly et al. references. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> Voltage plate <highlight><bold>102</bold></highlight> and voltage grid <highlight><bold>106</bold></highlight> are arranged in a juxtaposed relationship and define a first region <highlight><bold>108</bold></highlight> therebetween. Region <highlight><bold>106</bold></highlight> has length d<highlight><subscript>1 </subscript></highlight>and contains the sample source <highlight><bold>104</bold></highlight>. Although sample source <highlight><bold>104</bold></highlight> is shown as being located within a groove of voltage plate <highlight><bold>102</bold></highlight> so that the surface of the sample source <highlight><bold>104</bold></highlight> is coextensive with the surface of plate <highlight><bold>102</bold></highlight>, the present invention contemplates locating sample source <highlight><bold>104</bold></highlight> at a variety of locations within region <highlight><bold>108</bold></highlight>. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> In a preferred embodiment, sample source <highlight><bold>104</bold></highlight> is a stainless steel surface with the sample deposited thereon. Alternatively, sample source <highlight><bold>104</bold></highlight> may be a conductive metal grid or metal plate, a dielectric surface with or without a thin metallic film coating or a comparable structure having an orifice through which sample molecules flow. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> Also in a preferred embodiment, voltage plate <highlight><bold>102</bold></highlight> is a flat, highly conductive, metallic plate having a groove through the center of its surface for receiving the sample source <highlight><bold>104</bold></highlight>. Voltage grid <highlight><bold>113</bold></highlight> is juxtaposed with voltage grid <highlight><bold>106</bold></highlight> and a second region <highlight><bold>110</bold></highlight> of length d<highlight><subscript>2 </subscript></highlight>is defined therebetween. A flight tube <highlight><bold>112</bold></highlight> is connected between voltage grid <highlight><bold>113</bold></highlight> and grid <highlight><bold>115</bold></highlight>. Flight tube <highlight><bold>112</bold></highlight> is constructed of a conducting material, typically stainless steel or aluminum, and has a channel <highlight><bold>114</bold></highlight> disposed therethrough which defines an ion drift region of length L. Ion detector <highlight><bold>116</bold></highlight> is juxtaposed with the grid <highlight><bold>115</bold></highlight> of flight tube <highlight><bold>112</bold></highlight> and a third region of length d<highlight><subscript>3 </subscript></highlight>is defined between grid <highlight><bold>115</bold></highlight> and a front surface <highlight><bold>117</bold></highlight> of a suitable detector <highlight><bold>116</bold></highlight> such as a microchannel plate detector. Supports <highlight><bold>134</bold></highlight> and <highlight><bold>136</bold></highlight> are used to stabilize flight tube <highlight><bold>112</bold></highlight> and voltage plate <highlight><bold>102</bold></highlight> respectively within the TOFMS <highlight><bold>100</bold></highlight>, and are preferably made of Teflon&trade; or ceramic. In one embodiment, structures <highlight><bold>106</bold></highlight>, <highlight><bold>113</bold></highlight> and <highlight><bold>115</bold></highlight> are constructed of high conductivity metal screen or similar structure having slits or apertures disposed therethrough so that ions may pass through such slits or apertures. In an alternative embodiment, structures <highlight><bold>106</bold></highlight>, <highlight><bold>113</bold></highlight> and <highlight><bold>115</bold></highlight> comprise high conductivity gridless metallic plates having a central hole, or a series of holes disposed through the centers thereof, for allowing the passage of ions therethrough. Although not specifically illustrated in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, those skilled in the art will recognize that with gridless structures, electrostatic ion lenses of known construction are typically juxtaposed over the central holes or series of holes for focusing ion packets traveling therethrough as is known in the art. In any event, regardless of the configuration of structures <highlight><bold>106</bold></highlight>, <highlight><bold>113</bold></highlight> and <highlight><bold>115</bold></highlight>, such structures will hereinafter be referred to as &ldquo;grids&rdquo; for ease of description. </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> A first DC power source <highlight><bold>122</bold></highlight> is connected to voltage plate <highlight><bold>102</bold></highlight> for supplying a predetermined DC voltage potential V<highlight><subscript>o </subscript></highlight>thereto and a second DC power source <highlight><bold>124</bold></highlight> is connected to voltage grid <highlight><bold>106</bold></highlight> for supplying another predetermined DC voltage potential V<highlight><subscript>2 </subscript></highlight>thereto. Although V<highlight><subscript>o </subscript></highlight>and V<highlight><subscript>2 </subscript></highlight>may be widely varied, such as within the range of &plus;/&minus;30 kV for example, both plate <highlight><bold>102</bold></highlight> and grid <highlight><bold>106</bold></highlight> are typically maintained at the same voltage, and in one embodiment, this voltage is 15 kV. A first voltage pulser <highlight><bold>128</bold></highlight> is connected through a capacitor C<highlight><subscript>1 </subscript></highlight>to voltage plate <highlight><bold>102</bold></highlight> (or grid <highlight><bold>106</bold></highlight>) for supplying a predetermined duration voltage pulse to plate <highlight><bold>102</bold></highlight> (or grid <highlight><bold>106</bold></highlight>) of a predetermined amplitude. </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> Because the DC voltages applied to plate <highlight><bold>102</bold></highlight> (or grid <highlight><bold>106</bold></highlight>) via power source <highlight><bold>122</bold></highlight> are typically higher than most known high voltage pulser circuits <highlight><bold>128</bold></highlight> can withstand, the voltage pulser circuit <highlight><bold>128</bold></highlight> is isolated from plate <highlight><bold>102</bold></highlight> (or grid <highlight><bold>106</bold></highlight>) by a high voltage capacitor C<highlight><subscript>1</subscript></highlight>. Thus, when voltage pulser <highlight><bold>128</bold></highlight> is idle, it is decoupled from power source <highlight><bold>122</bold></highlight>. When pulsed, the voltage transient produced by voltage pulser <highlight><bold>128</bold></highlight>, typically on the order of a few kilovolts, is coupled to plate <highlight><bold>102</bold></highlight> (or grid <highlight><bold>106</bold></highlight>) having a voltage on the order of tens of kilovolts applied thereto via power source <highlight><bold>122</bold></highlight>. Occasionally in instruments such as TOF mass spectrometer <highlight><bold>100</bold></highlight> operating at high voltages, arcing can occur therein whereby plate <highlight><bold>102</bold></highlight> and/or grid <highlight><bold>106</bold></highlight> may be instantaneously forced to ground or much lower potential. As a result of the capacitive coupling between plate <highlight><bold>102</bold></highlight> (or grid <highlight><bold>106</bold></highlight>) and voltage pulser <highlight><bold>128</bold></highlight>, the entire voltage transient produce by such arcing is impressed upon the output of the voltage pulser <highlight><bold>128</bold></highlight>. Heretofore, known voltage pulser circuits <highlight><bold>128</bold></highlight> have been formed of solid state circuitry that is not designed to withstand large transients produced by such arcing events. Consequently, known voltage pulser circuits <highlight><bold>128</bold></highlight> are routinely destroyed during typical operation of instruments such as instrument <highlight><bold>100</bold></highlight>. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 2, a</cross-reference> robust voltage pulser circuit <highlight><bold>140</bold></highlight>, in accordance with one aspect of the present invention, is shown which overcomes the foregoing drawbacks associated with known voltage pulser circuits <highlight><bold>128</bold></highlight>. Voltage pulser circuit <highlight><bold>140</bold></highlight> may replace the voltage pulser <highlight><bold>128</bold></highlight> and capacitor C<highlight><subscript>1 </subscript></highlight>illustrated in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, wherein voltage pulser circuit <highlight><bold>140</bold></highlight> includes a high voltage source <highlight><bold>142</bold></highlight> connected to one end of a resistor R<highlight><bold>1</bold></highlight> having an opposite end connected to one end of a capacitor C<highlight><bold>1</bold></highlight> and also to an anode <highlight><bold>143</bold></highlight> of a thyratron tube <highlight><bold>144</bold></highlight> of known construction. A grid <highlight><bold>145</bold></highlight> of tube <highlight><bold>144</bold></highlight> is connected to a grid voltage generator <highlight><bold>146</bold></highlight> and a filament <highlight><bold>147</bold></highlight> of tube <highlight><bold>144</bold></highlight> is connected to a filament voltage generator <highlight><bold>148</bold></highlight>. A cathode <highlight><bold>149</bold></highlight> of tube <highlight><bold>144</bold></highlight> is connected to ground potential. The opposite end of capacitor C<highlight><subscript>1 </subscript></highlight>is connected to one end of a resistor R<highlight><bold>2</bold></highlight> having an opposite end connected to ground potential, and to one end of another resistor R<highlight><bold>3</bold></highlight>. The opposite end of resistor R<highlight><bold>3</bold></highlight> is connected to one end of another capacitor C<highlight><bold>2</bold></highlight> having an opposite end adapted for connection to plate <highlight><bold>102</bold></highlight> (or grid <highlight><bold>106</bold></highlight>). </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> High voltage source <highlight><bold>142</bold></highlight> is preferably a DC voltage source supplying a desired DC voltage to the anode <highlight><bold>143</bold></highlight> of tube <highlight><bold>144</bold></highlight>. In one embodiment, thyratron tube <highlight><bold>144</bold></highlight> is a 5C22 thyratron tube commercially available through ITT Corp. having a maximum anode voltage of 16 kV. High voltage source <highlight><bold>142</bold></highlight>, in this embodiment, may accordingly be set at any desired DC voltage less than or equal to 16 kV. It is to be understood, however, that the present invention contemplates using other known embodiments/models of thyratron tube <highlight><bold>144</bold></highlight> that may have a maximum anode voltage rated above or below 16 kV, wherein such alternate thyratron tubes may accordingly be chosen to provide desired pulse voltage values. In this embodiment, R<highlight><bold>1</bold></highlight> is preferably 30 Mohm, R<highlight><bold>2</bold></highlight> is preferably 10 Mohms, R<highlight><bold>3</bold></highlight> is preferably 50 ohms, and C<highlight><bold>1</bold></highlight> and C<highlight><bold>2</bold></highlight> preferably each have values of 500 pf, wherein all such components are preferably rated at 30 kV. It is to be understood that the values of components R<highlight><bold>1</bold></highlight>-R<highlight><bold>3</bold></highlight> and C<highlight><bold>1</bold></highlight>-C<highlight><bold>2</bold></highlight> may be chosen to suit any particular application, wherein the values of such components may be selected to effectuate a desired rise/fall time of the voltage pulse produced at the output of capacitor C<highlight><bold>2</bold></highlight>. </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> The filament voltage generator <highlight><bold>148</bold></highlight> may be of known construction and in the configuration of voltage pulser circuit <highlight><bold>140</bold></highlight> illustrated in <cross-reference target="DRAWINGS">FIG. 2</cross-reference>, generator <highlight><bold>148</bold></highlight> is operable to impress a suitable low voltage upon filament <highlight><bold>147</bold></highlight> as is known in the art. Grid voltage generator <highlight><bold>146</bold></highlight> must be capable of supplying a suitable switched control voltage to grid <highlight><bold>145</bold></highlight> to activate/deactivate the thyratron tube <highlight><bold>144</bold></highlight> in a manner that will be described more fully hereinafter. In an embodiment wherein tube <highlight><bold>144</bold></highlight> is a model 5C22 thyratron tube, the grid <highlight><bold>145</bold></highlight> may be driven between approximately &minus;360 volts and &plus;80 volts. Grid voltage generator <highlight><bold>146</bold></highlight> may accordingly comprise known solid state circuitry capable of switching between these voltages. Alternatively, grid voltage generator <highlight><bold>146</bold></highlight> may comprise a second thyratron tube suitably driven to provide switching between desired voltage values of grid <highlight><bold>145</bold></highlight>. In either case, the triggering or switching of grid voltage generator <highlight><bold>146</bold></highlight> is preferably electronically controlled to thereby accurately control the timing of the voltage pulse supplied by voltage pulser circuit <highlight><bold>140</bold></highlight> to plate <highlight><bold>102</bold></highlight> (or grid <highlight><bold>106</bold></highlight>) of the TOF mass spectrometer <highlight><bold>100</bold></highlight>. </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> In the operation of voltage pulser circuit <highlight><bold>140</bold></highlight>, high voltage source <highlight><bold>142</bold></highlight> defines a desired DC voltage at the anode <highlight><bold>143</bold></highlight> of the thyratron tube <highlight><bold>144</bold></highlight>. When the grid <highlight><bold>145</bold></highlight> is triggered via grid voltage generator <highlight><bold>146</bold></highlight>, the anode <highlight><bold>143</bold></highlight> drops to the grounded potential of the cathode <highlight><bold>149</bold></highlight> of tube <highlight><bold>144</bold></highlight> within a few nanoseconds, thereby transferring a corresponding voltage pulse to plate <highlight><bold>102</bold></highlight> (or grid <highlight><bold>106</bold></highlight>) of a desired potential. Preferably, the grid <highlight><bold>145</bold></highlight> is subsequently de-triggered via grid voltage generator <highlight><bold>146</bold></highlight> before high voltage source <highlight><bold>142</bold></highlight> can transfer significant charge to the anode <highlight><bold>143</bold></highlight> so that a well-defined pulse results at plate <highlight><bold>102</bold></highlight> (or grid <highlight><bold>106</bold></highlight>). </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> In an alternative embodiment of voltage pulser circuit <highlight><bold>140</bold></highlight>, the thyratron tube <highlight><bold>144</bold></highlight> may be connected in an inverted manner such that the cathode <highlight><bold>149</bold></highlight> is connected to the common connection of R<highlight><bold>1</bold></highlight> and C<highlight><bold>1</bold></highlight> and the anode <highlight><bold>143</bold></highlight> is connected to ground potential. The high voltage source <highlight><bold>142</bold></highlight> is configured to supply a suitable negative voltage to cathode <highlight><bold>149</bold></highlight>, and the filament voltage generator <highlight><bold>148</bold></highlight> is preferably configured to power filament <highlight><bold>147</bold></highlight> through a high voltage isolation transformer. In this case, grid <highlight><bold>145</bold></highlight> is suitably controlled via grid voltage generator <highlight><bold>146</bold></highlight> such that cathode <highlight><bold>149</bold></highlight> rises from the negative potential provided by source <highlight><bold>142</bold></highlight> to the grounded potential of the anode <highlight><bold>143</bold></highlight> within a few nanoseconds, thereby transferring a corresponding voltage pulse to plate <highlight><bold>102</bold></highlight> (or grid <highlight><bold>106</bold></highlight>) of a desired potential. As in the previous case, the grid <highlight><bold>145</bold></highlight> is subsequently de-triggered via grid voltage generator <highlight><bold>146</bold></highlight> before high voltage source <highlight><bold>142</bold></highlight> can transfer significant charge to the cathode <highlight><bold>149</bold></highlight> so that a well-defined pulse results at plate <highlight><bold>102</bold></highlight> (or grid <highlight><bold>106</bold></highlight>). In either case, the thyratron tube <highlight><bold>144</bold></highlight> provides a rugged high voltage switch suitable for pulsing plate <highlight><bold>102</bold></highlight> or grid <highlight><bold>106</bold></highlight> of instrument <highlight><bold>100</bold></highlight> that is much less susceptible to transient induced damage than known structures of voltage pulser circuit <highlight><bold>128</bold></highlight>. </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> In any case, voltage pulser <highlight><bold>128</bold></highlight> or <highlight><bold>140</bold></highlight> preferably supplies a voltage pulse V<highlight><subscript>p </subscript></highlight>to voltage plate <highlight><bold>102</bold></highlight> so that the total voltage present at plate <highlight><bold>102</bold></highlight> V<highlight><subscript>1 </subscript></highlight>is the sum of the DC voltage V<highlight><subscript>o </subscript></highlight>and the voltage pulse V<highlight><subscript>p&prime;</subscript></highlight> thereby establishing an electric field E<highlight><subscript>1 </subscript></highlight>of predetermined strength within the first region <highlight><bold>108</bold></highlight> for the duration of the pulse. In an alternate embodiment, the output of voltage pulser <highlight><bold>128</bold></highlight> or <highlight><bold>140</bold></highlight> may be used to change the electric field that had previously been established across region <highlight><bold>108</bold></highlight> by power sources <highlight><bold>122</bold></highlight> and <highlight><bold>124</bold></highlight>. Voltage pulser <highlight><bold>128</bold></highlight> or <highlight><bold>140</bold></highlight> may further be connected to grid <highlight><bold>106</bold></highlight> instead of plate <highlight><bold>102</bold></highlight>. In any case, the electric field E<highlight><subscript>1 </subscript></highlight>established within the first region <highlight><bold>108</bold></highlight> of instrument <highlight><bold>100</bold></highlight> acts to accelerate positively charged ions present within the region <highlight><bold>108</bold></highlight> toward the ion detector <highlight><bold>116</bold></highlight>. The electric field E<highlight><subscript>1 </subscript></highlight>could alternatively be reversed to accelerate negatively charged ions toward the detector <highlight><bold>116</bold></highlight>. </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> A third DC power source <highlight><bold>126</bold></highlight> is connected to voltage grid <highlight><bold>113</bold></highlight> for supplying a predetermined DC voltage potential V<highlight><subscript>3 </subscript></highlight>thereto. Although the voltage V<highlight><subscript>3 </subscript></highlight>on grid <highlight><bold>113</bold></highlight> may also be widely varied, such as within the range of &plus;/&minus;30 kV for example, this voltage is, in operation, maintained below the voltage on grid <highlight><bold>106</bold></highlight> so that a second electric field E<highlight><subscript>2 </subscript></highlight>is established within region <highlight><bold>110</bold></highlight> for further accelerating positively charged ions entering region <highlight><bold>110</bold></highlight> toward the detector <highlight><bold>116</bold></highlight>. In one embodiment, the voltage on grid <highlight><bold>113</bold></highlight> is maintained at approximately 12 kV. </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> A fourth DC power source <highlight><bold>129</bold></highlight> and a second voltage pulser <highlight><bold>130</bold></highlight> or <highlight><bold>140</bold></highlight> are connected to the detector <highlight><bold>116</bold></highlight>. In operation, the fourth DC power source <highlight><bold>129</bold></highlight> supplies a constant potential V<highlight><subscript>4 </subscript></highlight>to the detector <highlight><bold>116</bold></highlight> of sufficient magnitude to establish an electric field E<highlight><subscript>3 </subscript></highlight>for further accelerating ions entering region <highlight><bold>18</bold></highlight> toward the detector <highlight><bold>116</bold></highlight>. Although the voltage V<highlight><subscript>4 </subscript></highlight>on the detector <highlight><bold>116</bold></highlight> may be widely varied, such as within the range of &plusmn;30 kV for example, V<highlight><subscript>4 </subscript></highlight>is typically set at approximately &minus;1.4 kV. In one embodiment, voltage pulser <highlight><bold>130</bold></highlight>, capacitively coupled to the detector <highlight><bold>116</bold></highlight> through a capacitor C<highlight><subscript>2</subscript></highlight>, supplies a voltage pulse to the detector <highlight><bold>116</bold></highlight> to increase the gain of the detector <highlight><bold>116</bold></highlight> for the duration of the pulse to facilitate data capture. Alternatively, a voltage pulser circuit <highlight><bold>140</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 2</cross-reference> may be used to supply such a voltage pulse to the detector <highlight><bold>116</bold></highlight>. In other alternative embodiments, other known methods of momentarily increasing the gain of the detector <highlight><bold>116</bold></highlight> may be used to enhance data capture or data capture may be enhanced by preventing, through the use of pulsed ion deflectors, unwanted ions from reaching the detector. </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> Finally, a laser or other suitable ion excitation source <highlight><bold>132</bold></highlight> is focused on the sample source <highlight><bold>104</bold></highlight> for generating ions therefrom. Typically, the laser is pulsed by suitable control electronics and it is assumed that ions are desorbed from the sample source <highlight><bold>104</bold></highlight> upon being subjected to the laser radiation pulse. </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> Ion time-of-flight within a TOFMS, such as TOFMS <highlight><bold>100</bold></highlight>, is typically mathematically modeled by breaking down the flight path into a series of segments, determining the ion flight time within each segment, and then summing the flight times of the various segments to arrive at a total ion flight time. A variable number of segments may be used to mathematically model the flight time in a time-of-flight instrument. In the example that follows, the TOFMS <highlight><bold>100</bold></highlight> flight path is broken down into four segments corresponding to regions <highlight><bold>108</bold></highlight>, <highlight><bold>110</bold></highlight>, <highlight><bold>114</bold></highlight>, and <highlight><bold>118</bold></highlight>. Alternatively, for example, region <highlight><bold>118</bold></highlight> could be further broken down into region <highlight><bold>121</bold></highlight>, extending between grids <highlight><bold>115</bold></highlight> and <highlight><bold>119</bold></highlight>, and region <highlight><bold>120</bold></highlight>, extending between grid <highlight><bold>119</bold></highlight> and the front surface <highlight><bold>117</bold></highlight> of the microchannel plate detector <highlight><bold>116</bold></highlight>, in which case the flight path would have five segments. </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> Using the four segment approach, in a preferred embodiment where power supplies <highlight><bold>122</bold></highlight>, <highlight><bold>124</bold></highlight>, <highlight><bold>126</bold></highlight>, and <highlight><bold>129</bold></highlight> provide DC voltages, the flight time t<highlight><subscript>1 </subscript></highlight>of ions within region <highlight><bold>108</bold></highlight> is a function of the component of the initial ion velocity along the flight tube axis (parallel to the electric fields E<highlight><subscript>1</subscript></highlight>-E<highlight><subscript>3</subscript></highlight>) v<highlight><subscript>o&prime;</subscript></highlight> the velocity of the ions leaving region <highlight><bold>108</bold></highlight> v<highlight><subscript>1 </subscript></highlight>and the acceleration strength a<highlight><subscript>1 </subscript></highlight>of the electric field E<highlight><subscript>1 </subscript></highlight>established within region <highlight><bold>108</bold></highlight>. Thus </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>t</italic></highlight><highlight><subscript>1</subscript></highlight>&equals;(<highlight><italic>v</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>v</italic></highlight><highlight><subscript>o</subscript></highlight>)/a<highlight><subscript>1</subscript></highlight>&emsp;&emsp;(1). </in-line-formula></paragraph>
<paragraph id="P-0040" lvl="7"><number>&lsqb;0040&rsqb;</number> If x<highlight><subscript>o </subscript></highlight>is the position of a particular ion generated from the sample source <highlight><bold>104</bold></highlight>, then </paragraph>
<paragraph lvl="0"><in-line-formula>v<highlight><subscript>1</subscript></highlight><highlight><bold>&equals;{square root}{square root over (2<highlight><italic>a</italic></highlight><highlight><subscript>1 </subscript></highlight>(<highlight><italic>d</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>&minus;x</italic></highlight><highlight><subscript>o</subscript></highlight>)&plus;<highlight><italic>v</italic></highlight><highlight><subscript>o</subscript></highlight><highlight><superscript>2</superscript></highlight>)}</bold></highlight>&emsp;&emsp;(2). </in-line-formula></paragraph>
<paragraph id="P-0041" lvl="7"><number>&lsqb;0041&rsqb;</number> Similarly, the flight time t<highlight><subscript>2 </subscript></highlight>of ions within region <highlight><bold>110</bold></highlight> is a function of the velocity of ions entering region <highlight><bold>110</bold></highlight> v<highlight><subscript>1</subscript></highlight>, the velocity of ions leaving region <highlight><bold>110</bold></highlight> v<highlight><subscript>2 </subscript></highlight>and the acceleration strength of the electric field E<highlight><subscript>2 </subscript></highlight>established within region <highlight><bold>110</bold></highlight>. Thus, </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>t</italic></highlight><highlight><subscript>2</subscript></highlight>&equals;(<highlight><italic>v</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>&minus;v</italic></highlight><highlight><subscript>1</subscript></highlight>)/<highlight><italic>a</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(3), </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>where </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>v</italic></highlight><highlight><subscript>3</subscript></highlight><highlight><bold>&equals;{square root}{square root over (2<highlight><italic>a</italic></highlight><highlight><subscript>3</subscript></highlight><highlight><italic>d</italic></highlight><highlight><subscript>3</subscript></highlight><highlight><italic>&plus;v</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><superscript>2</superscript></highlight>)}</bold></highlight>&emsp;&emsp;(4) </in-line-formula></paragraph>
<paragraph id="P-0042" lvl="7"><number>&lsqb;0042&rsqb;</number> Furthermore, the flight time t<highlight><subscript>4 </subscript></highlight>of ions within region <highlight><bold>118</bold></highlight> is a function of the velocity of ions entering region <highlight><bold>118</bold></highlight> v<highlight><subscript>2</subscript></highlight>, the velocity of ions leaving region <highlight><bold>118</bold></highlight> v<highlight><subscript>3 </subscript></highlight>and the acceleration strength a<highlight><subscript>3 </subscript></highlight>of the electric field E<highlight><subscript>3 </subscript></highlight>established within region <highlight><bold>118</bold></highlight>. Thus, </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>t</italic></highlight><highlight><subscript>4</subscript></highlight>&equals;(<highlight><italic>v</italic></highlight><highlight><subscript>3</subscript></highlight><highlight><italic>&minus;v</italic></highlight><highlight><subscript>2</subscript></highlight>)/<highlight><italic>a</italic></highlight><highlight><subscript>3</subscript></highlight>&emsp;&emsp;(5), </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula>where </in-line-formula></paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>v</italic></highlight><highlight><subscript>3</subscript></highlight><highlight><bold>&equals;{square root}{square root over (2<highlight><italic>a</italic></highlight><highlight><subscript>3</subscript></highlight><highlight><italic>d</italic></highlight><highlight><subscript>3</subscript></highlight><highlight><italic>&plus;v</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><superscript>2</superscript></highlight>)}</bold></highlight>&emsp;&emsp;(6). </in-line-formula></paragraph>
<paragraph id="P-0043" lvl="7"><number>&lsqb;0043&rsqb;</number> Finally, since region <highlight><bold>114</bold></highlight> is an electric field free ion drift region, the ion flight time t<highlight><subscript>3 </subscript></highlight>is a function only of the ion velocity v<highlight><subscript>2 </subscript></highlight>through region <highlight><bold>114</bold></highlight> and the length L of region <highlight><bold>114</bold></highlight>. Thus </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>t</italic></highlight><highlight><subscript>3</subscript></highlight><highlight><italic>&equals;L/v</italic></highlight><highlight><subscript>2</subscript></highlight>&emsp;&emsp;(7). </in-line-formula></paragraph>
<paragraph id="P-0044" lvl="7"><number>&lsqb;0044&rsqb;</number> Since the total ion flight time within the TOFMS <highlight><bold>100</bold></highlight> is the sum of the four flight time segments, the equation for the total flight time T within TOFMS <highlight><bold>100</bold></highlight> is </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>T&equals;f</italic></highlight>(<highlight><italic>a</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>, a</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>, a</italic></highlight><highlight><subscript>3</subscript></highlight><highlight><italic>, d</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>, d</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>, d</italic></highlight><highlight><subscript>3</subscript></highlight><highlight><italic>, L, x</italic></highlight><highlight><subscript>o</subscript></highlight><highlight><italic>, v</italic></highlight><highlight><subscript>o</subscript></highlight>)&emsp;&emsp;(8). </in-line-formula></paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> In general, the initial ion position x<highlight><subscript>o </subscript></highlight>is a function of the initial ion velocity v<highlight><subscript>o </subscript></highlight>and a delay time &tgr;, wherein &tgr; is the delay time between the generation of ions at the sample source <highlight><bold>104</bold></highlight> and commencement of the pulsed ion drawout electric field E<highlight><subscript>1 </subscript></highlight>established via voltages V<highlight><subscript>1 </subscript></highlight>and V<highlight><subscript>2 </subscript></highlight>at plate <highlight><bold>102</bold></highlight> and grid <highlight><bold>106</bold></highlight> respectively. Via substitution, equation (8) thus becomes </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>T&equals;f</italic></highlight>(<highlight><italic>a</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>, a</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>, a</italic></highlight><highlight><subscript>3</subscript></highlight><highlight><italic>, d</italic></highlight><highlight><subscript>1</subscript></highlight><highlight><italic>, d</italic></highlight><highlight><subscript>2</subscript></highlight><highlight><italic>, d</italic></highlight><highlight><subscript>3</subscript></highlight><highlight><italic>, L, v</italic></highlight><highlight><subscript>o</subscript></highlight>, &tgr;)&emsp;&emsp;(9). </in-line-formula></paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> Equation (9) describes the time-of-flight of an ion in a time-dependent electrostatic field and can be used to calculate theoretical flight times of any ion. Equation (9) will hereinafter be referred to as the electrostatic time-of-flight function and those skilled in the art will recognize that the electrostatic time-of-flight function or equation for any TOF mass spectrometer will be defined by the internal structure of the spectrometer instrument as well as the timing and magnitudes of the various application voltages. All such variables will hereinafter be referred to as TOF mass spectrometer instrument operational parameters. It is to be understood that any TOF mass spectrometer configuration may be used in accordance with the present invention, and as the term &ldquo;time-of-flight mass spectrometer&rdquo; or &ldquo;TOF mass spectrometer&rdquo; is used hereinafter, it is to be understood to include any instrument operable to measure ion times of flight including, but not limited to, reflectron-type and multi-pass TOF mass spectrometers, wherein ion time of flight in any such instrument is definable in terms of a number of the instrument&apos;s operating parameters (i.e., an electrostatic equation). </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 3, a</cross-reference> prior art electronic interface to the TOF mass spectrometer <highlight><bold>100</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is shown. Central to the interface of <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a computer <highlight><bold>150</bold></highlight>. In one embodiment, computer <highlight><bold>150</bold></highlight> is preferably a microprocessor-based personal computer (PC) having at least a keyboard <highlight><bold>152</bold></highlight> and a display <highlight><bold>154</bold></highlight> electrically connected thereto as is known in the art. Alternatively, computer <highlight><bold>150</bold></highlight> may be any known computer suitable for controlling the operation of a TOF mass spectrometer, such as spectrometer <highlight><bold>100</bold></highlight>, and for calibrating TOF mass spectra in accordance with the present invention. In any case, computer <highlight><bold>150</bold></highlight> preferably includes a memory <highlight><bold>155</bold></highlight> for storing application software algorithms and data relating to the operation of spectrometer <highlight><bold>100</bold></highlight> therein. </paragraph>
<paragraph id="P-0048" lvl="0"><number>&lsqb;0048&rsqb;</number> Computer <highlight><bold>150</bold></highlight> is shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference> as being electrically connected to a power supply block <highlight><bold>156</bold></highlight> via a number, N, of signal paths wherein N may be any integer. Power supply block <highlight><bold>156</bold></highlight> is, in turn, electrically connected to the TOF mass spectrometer <highlight><bold>100</bold></highlight> via a number, M, of signal paths wherein M may also be any integer. In one embodiment, power supply block <highlight><bold>156</bold></highlight> includes all of the power sources and voltage pulsers illustrated in <cross-reference target="DRAWINGS">FIG. 1</cross-reference> and/or <cross-reference target="DRAWINGS">FIG. 3</cross-reference> (e.g., sources <highlight><bold>122</bold></highlight>, <highlight><bold>124</bold></highlight>, <highlight><bold>126</bold></highlight> and <highlight><bold>129</bold></highlight>, and voltage pursers <highlight><bold>128</bold></highlight> and <highlight><bold>130</bold></highlight> or <highlight><bold>140</bold></highlight>), wherein computer <highlight><bold>150</bold></highlight> is operable to control the operation of all such sources/pulsers. In the case of voltage pulser <highlight><bold>140</bold></highlight> illustrated in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>, computer <highlight><bold>150</bold></highlight> is operable to at least control the timing of the trigger voltage supplied to the grid <highlight><bold>145</bold></highlight> of thyratron tube <highlight><bold>144</bold></highlight> as described hereinabove. Alternatively, the output voltage values of any one or more of the sources/pulsers may be manually controlled, although at least the activation/trigger times of voltage pulser <highlight><bold>128</bold></highlight> and voltage pulser <highlight><bold>130</bold></highlight> (or voltage pulser <highlight><bold>140</bold></highlight>) are preferably controlled by the computer <highlight><bold>150</bold></highlight> or other known electronic control circuitry (not shown) in either case. </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> The computer <highlight><bold>150</bold></highlight> is also electrically connected to an excitation source <highlight><bold>159</bold></highlight> via a number, J, of signal paths wherein J may be any integer. In one preferred embodiment, and as illustrated in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, excitation source <highlight><bold>158</bold></highlight> is a laser that is preferably positioned outside of the mass spectrometer <highlight><bold>100</bold></highlight>. In this case, spectrometer <highlight><bold>100</bold></highlight> includes a window (not shown) in the vicinity of the sample source <highlight><bold>104</bold></highlight> so that radiation emitted from the laser <highlight><bold>158</bold></highlight> may pass through the window and excite the sample source <highlight><bold>104</bold></highlight> and generate ions therefrom. One example of a laser suitable for use as the excitation source <highlight><bold>158</bold></highlight> is a Quanta Ray DCR-2 Nd:YAG laser at 1.06 microns, although the present invention contemplates using any desired laser source as the excitation source <highlight><bold>158</bold></highlight> ranging from far-UV to far-IR. Additionally, the excitation source <highlight><bold>158</bold></highlight> may include a harmonic generator for multiplying the frequency of the laser radiation as desired. </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> In alternative embodiments, the excitation source <highlight><bold>158</bold></highlight> may be any known excitation source external to the spectrometer <highlight><bold>100</bold></highlight> or internal thereto as shown by the dashed lines surrounding the spectrometer instrument <highlight><bold>100</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>, and may furthermore include the sample source itself. In one alternate embodiment, for example, excitation source <highlight><bold>158</bold></highlight> may be a known electrospray ionization source either internal or external to instrument <highlight><bold>100</bold></highlight>, wherein the electrospray source is operable to supply ions to instrument <highlight><bold>100</bold></highlight> in a known manner. As a specific example of this embodiment, the TOF mass spectrometer <highlight><bold>100</bold></highlight> and electrospray ionization source may be configured to supply a continuous stream of ions through region dl that is substantially parallel to plate <highlight><bold>102</bold></highlight> and grid <highlight><bold>106</bold></highlight>, whereby plate <highlight><bold>102</bold></highlight> and/or grid <highlight><bold>106</bold></highlight> may be suitably pulsed to advance a packet of ions from this continuous stream toward the detector <highlight><bold>116</bold></highlight>. Alternatively, an ion collection trap or ion filter of known construction may be included within region <highlight><bold>108</bold></highlight> or prior thereto, wherein excitation source <highlight><bold>158</bold></highlight> may include either a laser or an electrospray ionization source supplying ions to the ion trap or ion filter. In this embodiment, the computer <highlight><bold>150</bold></highlight> is operable, as is known in the art, to control the ion trap or ion filter in such a manner so as to trap a bulk of ions therein for subsequent injection into region <highlight><bold>108</bold></highlight> or to allow passage therethrough of ions having only selected mass/charge values. It is to be understood, in any case, that the present invention contemplates that the sample source <highlight><bold>104</bold></highlight> and excitation source <highlight><bold>158</bold></highlight> may be provided as any known ion source or combination of ion sources, and that any such ion source or combination of sources are intended to fall within the scope of the present invention. For example, the present invention contemplates employing other known ion sources and/or ion generation techniques as well, including, for example, fast atom bombardment (FAB), plasma desorption (PD), secondary ion generation such as that used in secondary ion mass spectrometry (SIMS), electron bombardment, photo-ionization, inductively coupled plasma (ICP), and the like. </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> An ion detector (<highlight><bold>116</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, but not shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>) is electrically connected to a signal processing circuit <highlight><bold>138</bold></highlight> that is, in turn, electrically connected to computer <highlight><bold>150</bold></highlight>. Preferably, signal processing circuit <highlight><bold>138</bold></highlight> includes circuitry to convert the typically analog time-of-flight signals provided by detector <highlight><bold>116</bold></highlight> to digital signals suitable for use by computer <highlight><bold>150</bold></highlight>. Signal processing circuit <highlight><bold>138</bold></highlight> may accordingly include known signal-to-waveform digitizer circuitry, known time-to-digital conversion circuitry or the like. In any case, computer <highlight><bold>150</bold></highlight> is operable to receive from TOF mass spectrometer <highlight><bold>100</bold></highlight> ion detection signals indicative of detection of ions at the ion detector <highlight><bold>116</bold></highlight>. </paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> In accordance with the present invention, computer <highlight><bold>150</bold></highlight> preferably includes a software algorithm stored within memory <highlight><bold>155</bold></highlight>, whereby computer <highlight><bold>150</bold></highlight> is operable to conduct time-of-flight mass spectra calibrations. Unlike prior art systems that conduct mass spectra calibrations by curve fitting experimental data to a polynomial expression, however, the mass spectra calibration technique of the present invention is operable to optimize numerical values of one or more of the operating parameters of a TOF mass spectrometer, such as TOF mass spectrometer <highlight><bold>100</bold></highlight>, to thereby minimize the residual error between electrostatic TOF calculations and measured TOF values for a range of known ion masses. To this end, <cross-reference target="DRAWINGS">FIG. 4</cross-reference> illustrates one preferred embodiment of some of the internal features of computer <highlight><bold>150</bold></highlight> for carrying out such mass spectra calibrations. It is to be understood that the blocks illustrated in <cross-reference target="DRAWINGS">FIG. 4</cross-reference> are not intended to represent a physical internal structure of computer <highlight><bold>150</bold></highlight>, but are rather intended to represent software functions that are preferably implemented via one or more software algorithms stored within memory <highlight><bold>155</bold></highlight>. </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 4</cross-reference>, computer <highlight><bold>150</bold></highlight> includes a block <highlight><bold>170</bold></highlight> corresponding to the various TOF mass spectrometer instrument operating parameters that, together with known mass/charge values, define times-of-flight of a wide range of ions in a time-dependent electrostatic field. This time-of-flight function, or time-of-flight electrostatic equation, can then be used to calculate theoretical flight times of any ion. Preferably, such instrument operating parameters are stored within memory <highlight><bold>155</bold></highlight> and may be entered therein via a number of known techniques including, but not limited to, keyboard <highlight><bold>152</bold></highlight>, transfer from another storage media such as a diskette, transfer from a remote system via a modem or internet access, or the like. </paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> Using the TOF mass spectrometer of <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, for example, an ion&apos;s time-of-flight is defined in terms of its mass/charge ratio and a plurality of instrument operating parameters including a<highlight><subscript>1</subscript></highlight>-a<highlight><subscript>3</subscript></highlight>, d<highlight><subscript>1</subscript></highlight>-d<highlight><subscript>3</subscript></highlight>, L, v<highlight><subscript>0 </subscript></highlight>and x<highlight><subscript>0 </subscript></highlight>(or &tgr;) (see eqns. 8 and 9). Thus, block <highlight><bold>170</bold></highlight> preferably includes the values of d<highlight><subscript>1</subscript></highlight>-d<highlight><subscript>3</subscript></highlight>, L, v<highlight><subscript>0 </subscript></highlight>and &tgr; as well as the voltage values of voltage source <highlight><bold>122</bold></highlight>, <highlight><bold>124</bold></highlight>, <highlight><bold>126</bold></highlight> and <highlight><bold>129</bold></highlight> and voltage pulsers <highlight><bold>128</bold></highlight> (or <highlight><bold>140</bold></highlight>) and <highlight><bold>130</bold></highlight>. With other TOF mass spectrometer embodiments, additional and/or alternative parameters may be necessary to define the time-of-flight electrostatic equation. For example, equation 8 or 9 may be modified to include time dependent information relating to the pulsed ion drawout electric field described above including, but not limited to, pulse start time and/or pulse rise time. For any embodiment of the TOF mass spectrometer, however, it is to be understood that block <highlight><bold>170</bold></highlight> includes any instrument operating parameters necessary to define an electrostatic time-of-flight equation therefore. </paragraph>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> Computer <highlight><bold>150</bold></highlight> further includes a calibration information block <highlight><bold>172</bold></highlight> that preferably includes a number of pairs of known ion mass values and associated time-of-flight values that were previously measured for these known mass values with the time-of-flight mass spectrometer defining the TOF mass spectrometer instrument parameters of block <highlight><bold>170</bold></highlight>. In general, the range of mass values contained in the calibration information block <highlight><bold>172</bold></highlight> defines the mass range of the subsequent mass spectra calibration. In accordance with an important aspect of the present invention, however, the post-calibration instrument operating range may include mass values well outside the mass calibrant range without losing significant mass accuracy as will be described and demonstrated with respect to <cross-reference target="DRAWINGS">FIG. 8</cross-reference>. The present invention further contemplates that a mass spectra calibration may be conducted using as little as a single known mass value and associated measured time-of-flight value, or alternatively any number of known mass values and associated measured time-of-flight values. Block <highlight><bold>172</bold></highlight> accordingly includes at least one known mass value and associated measured time-of-flight value, and may include any number of mass/time-of-flight data pairs. Preferably, such one or more mass/time-of-flight data pairs are stored within memory <highlight><bold>155</bold></highlight> and may be entered therein via a number of known techniques including, but not limited to, keyboard <highlight><bold>152</bold></highlight>, transfer from another storage media such as a diskette, transfer from a remote system via a modem or internet access, or the like. </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> Computer <highlight><bold>150</bold></highlight> further includes a block <highlight><bold>174</bold></highlight> that corresponds to desired TOF mass spectrometer instrument operating parameters to be optimized. Generally, the values of the various instrument operating parameters defining an electrostatic time-of-flight function may not exactly match their true values due to errors in parameter measurement. Thus any one or more of the mass spectrometer instrument operating parameters may be chosen in block <highlight><bold>174</bold></highlight> for adjustment (optimization) thereof in order to calibrate the electrostatic equation to yield more accurate time-of-flight values (and hence more accurate mass values) based on the known mass and measured time-of-flight calibration information stored in block <highlight><bold>172</bold></highlight>. As a practical matter, however, the best choices for parameters to optimize are those that are most subject to measurement errors. An obvious choice for an optimization parameter is any pulse voltage, since all high voltage pulses are produced by high impedance sources, and any measurement thereof loads the source and accordingly produces a lower measured voltage than is actually impressed. Another good choice for an optimization parameter is the extraction delay time &tgr; since propagation delays in signal lines and delay generators may change the actual delay time from its measured value. Other good choices for optimization parameters have been found to include, for example, ion start time, which corresponds to the time at which source ions are generated, and the length L of the flight tube. </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> Computer <highlight><bold>150</bold></highlight> further includes a mass spectra calibration (MSC) routine block <highlight><bold>176</bold></highlight> that receives the above-described data from blocks <highlight><bold>170</bold></highlight>, <highlight><bold>172</bold></highlight> and <highlight><bold>174</bold></highlight> and produces a &ldquo;new&rdquo; set of TOF mass spectrometer operational parameter values, wherein the new set of instrument operational parameters includes adjusted or optimized values for the instrument parameters chosen in block <highlight><bold>174</bold></highlight>. Given the known mass and measured time-of-flight calibration pairs provided by block <highlight><bold>172</bold></highlight>, the mass spectra calibration block <highlight><bold>176</bold></highlight> is operable, as will be described in greater detail hereinafter, to adjust chosen ones of the various TOF mass spectrometer instrument operational parameters provided by block <highlight><bold>170</bold></highlight> until the calibration pairs agree with the electrostatic TOF function defined by the instrument operational parameters, wherein the instrument operational parameters chosen for adjustment are established by block <highlight><bold>174</bold></highlight>. </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 5, a</cross-reference> flowchart is shown illustrating one preferred embodiment of a software algorithm <highlight><bold>200</bold></highlight> for carrying out a time-of-flight mass spectra calibration in accordance with the foregoing description of <cross-reference target="DRAWINGS">FIG. 4</cross-reference>. As described hereinabove, algorithm <highlight><bold>200</bold></highlight> is preferably stored within memory <highlight><bold>155</bold></highlight> and is executable by computer <highlight><bold>150</bold></highlight>. Algorithm <highlight><bold>200</bold></highlight> begins at step <highlight><bold>202</bold></highlight> and at step <highlight><bold>204</bold></highlight>, the various TOF mass spectrometer instrument operational parameters described with respect to block <highlight><bold>170</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 4</cross-reference> are entered into memory <highlight><bold>155</bold></highlight> according to any of the techniques described above. Thereafter at step <highlight><bold>206</bold></highlight>, a number (at least one) of known mass and associated measured time-of-flight value pairs are entered into memory <highlight><bold>155</bold></highlight> according to any of the techniques previously described. Thereafter at step <highlight><bold>208</bold></highlight>, the TOF mass spectrometer instrument parameters chosen to be optimized are entered into memory <highlight><bold>155</bold></highlight> according to any of the techniques described hereinabove. In one preferred embodiment, as will be described in greater detail hereinafter, the mass spectra calibration routine of block <highlight><bold>176</bold></highlight> is a simplex optimization routine operable to adjust the chosen instrument parameters such that the known mass and measured time-of-flight calibration data corresponds to the electrostatic time-of-flight calculations for the various mass values. </paragraph>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> After the execution of step <highlight><bold>208</bold></highlight>, all data necessary for the time-of-flight mass spectra calibration according to the present invention are stored in memory <highlight><bold>155</bold></highlight>, and algorithm execution continues at step <highlight><bold>210</bold></highlight> where computer <highlight><bold>150</bold></highlight> is operable to run the mass spectra calibration (MSC) routine of block <highlight><bold>176</bold></highlight>. In one preferred embodiment of the present invention, the mass spectra calibration routine of block <highlight><bold>176</bold></highlight> and step <highlight><bold>210</bold></highlight> includes a simplex optimization routine. While various methods are known for determining optimal parameters for a system, simplex algorithms are adaptable to uncompliant optimizations such optimization of empirical variables that are either underdetermined or whose measurements are obscured by experimental error. Such algorithms show improved efficiency when more factors are included in the optimization and computer algorithms utilizing simplex calculations have been known to permit the optimization of systems that are impossible to fit to an analytical expression either for lack of an analytical expression or due to intractably complicated numerical calculations. A simplex algorithm can accordingly be applied to a time-of-flight calculation without determining exact experimental parameters. The process of optimization refines the experimentally determined parameters of the TOF mass spectrometer instrument, thereby allowing for the subsequent accurate determination of unknown masses using measured time-of-flight data. </paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 6, a</cross-reference> block diagram illustrating the mass spectra calibration routine of block <highlight><bold>176</bold></highlight> and step <highlight><bold>210</bold></highlight>, in accordance with a preferred simplex optimization routine, is illustrated. Blocks <highlight><bold>170</bold></highlight>, <highlight><bold>172</bold></highlight> and <highlight><bold>174</bold></highlight>, corresponding to steps <highlight><bold>204</bold></highlight>, <highlight><bold>206</bold></highlight> and <highlight><bold>208</bold></highlight> respectively of algorithm <highlight><bold>200</bold></highlight>, are shown in <cross-reference target="DRAWINGS">FIG. 6</cross-reference> as providing necessary data to a simplex algorithm block <highlight><bold>180</bold></highlight> of the mass spectra calibration block <highlight><bold>176</bold></highlight> (step <highlight><bold>210</bold></highlight>). The simplex algorithm <highlight><bold>180</bold></highlight> is operable to perform reiterative optimization of the electrostatic time-of-flight function <highlight><bold>182</bold></highlight> defined by the TOF mass spectrometer instrument operational parameters provided by block <highlight><bold>204</bold></highlight>, given the input calibration array of mass/time-of-flight data pairs provided by block <highlight><bold>206</bold></highlight> and instrument parameters chosen for optimization by block <highlight><bold>208</bold></highlight>, and produce an output calibration array with errors <highlight><bold>184</bold></highlight> at each iteration. The iteration process continues until the residual error in times-of-flight &Dgr;tof<highlight><subscript>1&minus;n</subscript></highlight>, between the measured time-of-flight values within block <highlight><bold>206</bold></highlight> and the electrostatic time-of-flight calculations is minimized over the mass range defined by the known mass values in the mass calibration information. The result of the simplex optimization routine illustrated in blocks <highlight><bold>180</bold></highlight>-<highlight><bold>184</bold></highlight> is a new set of TOF mass spectrometer operational parameters <highlight><bold>186</bold></highlight> for use in the electrostatic equation which includes the original instrument parameter values provided by block <highlight><bold>204</bold></highlight> for all but the optimized instrument parameters along with the optimized instrument parameter values for those instrument parameters chosen for optimization by block <highlight><bold>208</bold></highlight>. </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> A simplex engine that was developed for block <highlight><bold>180</bold></highlight> of <cross-reference target="DRAWINGS">FIG. 5</cross-reference> was adapted from an amoeba algorithm described in &ldquo;Numerical Recipes in C: The Art of Scientific Computing&rdquo;, W. H. Press, S. A. Teukolsky, W. T. Vetterling, B. P. Flannery, Second Edition, Cambridge University Press (1992). A primary change to this algorithm for mass spectra calibration involved the incorporation therein of a residual error function. In this minimization function, optimized TOF values are calculated using all of the TOF mass spectrometer instrument operational parameters for each calibrant mass. The residual between an array of optimized TOF values and measured TOF values is calculated in this function as described hereinabove. In practice, any known minimization function may be used to compute the residual, although variations in this minimization show differing performance in terms of convergence speed and accuracy. In one preferred embodiment, the difference of the square of TOF values between experimental and optimized values therefore is used. </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> A further change to the amoeba algorithm involves the packing and unpacking of instrument conditions. Packing involves flagging the instrument parameters chosen for optimization and loading these parameters into a compatible matrix. Consistency between packing and unpacking is essential as each iteration of the simplex algorithm requires unpacking of this matrix for the electrostatic TOF calculation. In other words, the simplex algorithm requires a packed matrix to navigate the error simplex, but requires an unpacked matrix for computation of the optimized TOF values. C&plus;&plus; served as an optimal programming language for the simplex algorithm as the object-oriented nature of this language greatly simplifies the foregoing changes. </paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> One parameter of the simplex optimization procedure, termed the &ldquo;delta value&rdquo; can be changed to correct for uncertainties in individual parameters. Lowering the delta value increases the iterative requirements for optimization and the delta value may be different for each instrument parameter. In general, it was found desirable to match the delta value to expected uncertainties in the measurements of instrument parameters. A further parameter, termed the &ldquo;fit tolerance&rdquo;, represents convergence criteria for termination of the simplex optimization process. The fit tolerance value is based on expected error between the measured TOF values and the TOF values determined by the electrostatic equation and, as with the delta value, a smaller fit tolerance value increases the iterative requirements of the overall procedure. </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> Returning again to <cross-reference target="DRAWINGS">FIG. 5</cross-reference>, algorithm <highlight><bold>200</bold></highlight> advances from step <highlight><bold>210</bold></highlight> to step <highlight><bold>212</bold></highlight> where computer <highlight><bold>150</bold></highlight> tests for TOF error convergence, as just described with respect to <cross-reference target="DRAWINGS">FIG. 6</cross-reference>, and loops back to step <highlight><bold>210</bold></highlight> until such convergence occurs. Thereafter at step <highlight><bold>214</bold></highlight>, computer <highlight><bold>150</bold></highlight> is operable to convert the final electrostatic TOF values to mass values. Once optimized instrument operational parameter values are determined at step <highlight><bold>210</bold></highlight>, conversion of resulting electrostatic TOF values to corresponding mass values is necessary to calibrate unknown masses for arbitrary TOF values. In one preferred embodiment, a known high-low search algorithm is employed at step <highlight><bold>214</bold></highlight> which searches the trial masses until the experimental TOF value matches the unknown mass. It has been found that a 133 MHz Pentium-based computer <highlight><bold>150</bold></highlight> can calculate individual masses based on times-of-flight, and calibrate a 16 kilopoint data file in less than one minute to parts-per-trillion accuracy, although the present invention contemplates other embodiments of computer <highlight><bold>150</bold></highlight> as described hereinabove. As a refinement to the above-described high-low search algorithm, the initial mass guess may be based on the previous call, thereby speeding calculations for nearby mass values. In any case, algorithm <highlight><bold>200</bold></highlight> advances from step <highlight><bold>214</bold></highlight> to step <highlight><bold>216</bold></highlight> where algorithm <highlight><bold>200</bold></highlight> is returned to its calling routine. </paragraph>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> It is to be understood that while algorithm <highlight><bold>200</bold></highlight> was described as including a simplex optimization-based mass spectra calibration routine <highlight><bold>176</bold></highlight>, the present invention contemplates utilizing other known parameter optimization procedures, an example of which includes, but is not limited to, a least squares optimization approach. Those skilled in the art will recognize that other such substitute parameter optimization procedures may alternatively be used in practicing the present invention without detracting from the scope thereof. </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> From the foregoing it should now be appreciated that rather than approximating ion TOF values based on an empirical equation as is the case with known curve fitting techniques, the time-of-flight mass spectra calibration technique of the present invention utilizes electrostatic calculations of ion flight times for conducting such calibrations. The electrostatic calculation of ion TOF values constrains ion behavior to physically meaningful values based on the various operational parameters of the particular TOF mass spectrometer used. Deviations in ion TOF values can accordingly be attributed to one or more experimental parameters, and while the factors that represent these parameters can be included in a conventional curve fit equation, the terms of a curve fit equation are representations of multiple constants in an infinite expansion and are therefore not as exact as using all instrument operational parameters in the electrostatic TOF calculation. The mass calibration technique of the present invention, by contrast, takes into account all of the instrument operational parameters in arriving at a final calibration. Because the electrostatic TOF calculation is a description of ion behavior in an actual TOF mass spectrometer instrument rather than a polynomial representation of a curve, it is well behaved and does not contain any instabilities where unpredictable calibration errors might occur. </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> Referring now to <cross-reference target="DRAWINGS">FIG. 7, a</cross-reference> plot of error in fit vs. actual mass for a gold nanoparticle mixture is shown. A 3-term simplex optimization error <highlight><bold>250</bold></highlight>, according to the techniques described hereinabove with respect to FIGS. <highlight><bold>4</bold></highlight>-<highlight><bold>6</bold></highlight>, is compared with a 5-term curve fit error <highlight><bold>252</bold></highlight> using known curve fitting techniques. Inspection of <cross-reference target="DRAWINGS">FIG. 7</cross-reference> reveals that the 3-term simplex optimization technique of the present invention produces results that are at least as accurate as that of the known 5-term curve fitting technique. Referring to <cross-reference target="DRAWINGS">FIG. 8, a</cross-reference> similar plot of error in fit vs. actual mass for a gold nanoparticle mixture is shown wherein a 3-term simplex optimization error <highlight><bold>260</bold></highlight> is again compared with a 5-term curve fit error <highlight><bold>262</bold></highlight>. Comparing <cross-reference target="DRAWINGS">FIG. 7</cross-reference> with <cross-reference target="DRAWINGS">FIG. 8</cross-reference>, the 3-term simplex optimization procedure of the present invention and the 5-term curve fit mass calibration illustrated in <cross-reference target="DRAWINGS">FIG. 8</cross-reference> was conducted over a narrower mass range than that of <cross-reference target="DRAWINGS">FIG. 7</cross-reference> and the results thereof are readily apparent. Outside of the mass range of the known mass values used for the calibration (mass calibrant range), the 5-term curve fit calibration procedure of <cross-reference target="DRAWINGS">FIG. 8</cross-reference> produces potentially highly inaccurate results whereas the 3-term mass calibration procedure of the present invention produces results that are consistent with those within the mass calibrant range. Accordingly, the mass calibration procedure of the present invention advantageously provides greater accuracy in mass value determination than known curve fitting techniques in extrapolated mass ranges. </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> While the invention has been illustrated and described in detail in the foregoing drawings and description, the same is to be considered as illustrative and not restrictive in character, it being understood that only the preferred embodiments have been shown and described and that all changes and modifications that come within the spirit of the invention are desired to be protected. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is claimed is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. A system for calibrating time-of-flight (TOF) mass spectra, comprising: 
<claim-text>a memory having a plurality of TOF mass spectrometer instrument operational parameters and at least one known mass value and associated measured time of flight value stored therein; and </claim-text>
<claim-text>a computer in communication with said memory, said computer computing a time of flight of said at least one known mass value as an electrostatic function of said plurality of instrument operational parameters and adjusting at least one of said plurality of instrument operational parameters to thereby minimize a difference between said computed time of flight and said measured time of flight value. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The system of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> further including means for entering said plurality of TOF mass spectrometer instrument operational parameters and said at least one known mass value and associated measured time of flight value into said memory. </claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The system of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein said memory further includes at least one optimization parameter stored therein corresponding to one of said plurality of TOF mass spectrometer instrument operational parameters desired to be optimized; 
<claim-text>and wherein said at least one of said plurality of instrument operational parameters adjusted by said computer corresponds to said optimization parameter. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The system of <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference> further including means for entering said at least one optimization parameter into said memory. </claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. The system of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein said memory further includes a plurality of optimization parameters stored therein, each of said optimization parameters corresponding to a separate one of said plurality of TOF mass spectrometer instrument operational parameters desired to be optimized; 
<claim-text>and wherein said computer is operable to compute a time of flight of said at least one known mass value as an electrostatic function of said plurality of instrument operational parameters and adjusting at least some of said plurality of instrument operational parameters corresponding to at least some of said plurality of optimization parameters to thereby minimize said difference between said computed time of flight and said measured time of flight value. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The system of <dependent-claim-reference depends_on="CLM-00005">claim 5</dependent-claim-reference> further including means for entering said plurality of optimization parameters into said memory. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. The system of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein said computer includes means for iteratively adjusting said at least one of said plurality of instrument operational parameters to thereby minimize said difference between said computed time of flight and said measured time of flight value. </claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The system of <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference> wherein said memory further includes a simplex optimization algorithm stored therein; 
<claim-text>and wherein said computer is operable to iteratively adjust said at least one of said plurality of instrument operational parameters in accordance with said simplex optimization algorithm. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. The system of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein said memory further includes a plurality of known mass values and associated measured time of flight values stored therein; 
<claim-text>and wherein said computer is operable to compute times of flight of at least some of said plurality of known mass values as a function of said plurality of instrument operational parameters and adjusting at least one of said plurality of instrument operational parameters to thereby minimize differences between said computed times of flight and corresponding ones of said measured time of flight values. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. The system of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference> wherein said at least one known mass value defines a mass calibrant range; 
<claim-text>and wherein post-calibration operation of the TOF mass spectrometer produces substantially accurate measured mass values outside said mass calibrant range. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. A method of calibrating time-of-flight (TOF) mass spectra comprising the steps of: 
<claim-text>providing a plurality of TOF mass spectrometer instrument operational parameters; </claim-text>
<claim-text>providing at least one known mass value and associated measured time of flight value therefore; </claim-text>
<claim-text>computing a time of flight of said at least one known mass value as an electrostatic function of said plurality of instrument operational parameters; and </claim-text>
<claim-text>adjusting at least one of said instrument operational parameters to thereby minimize a difference between said computed time of flight and said measured time of flight value. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference> further including the step of providing at least one optimization parameter corresponding to one of said plurality of TOF mass spectrometer instrument operational parameters; 
<claim-text>and wherein said at least one of said instrument operational parameters in said adjusting step corresponds to said at least one optimization parameter. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference> further including the step of providing a plurality of optimization parameters each corresponding to a separate one of said plurality of instrument operational parameters desired to be optimized; 
<claim-text>and wherein said adjusting step includes adjusting at least some of said plurality of instrument operational parameters corresponding to at least some of said plurality of optimization parameters to thereby minimize said difference between said computed time of flight and said measured time of flight value. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference> wherein said adjusting-step includes iteratively adjusting said at least one of said instrument operational parameters to thereby minimize said difference between said computed time of flight and said measured time of flight value. </claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 14</dependent-claim-reference> wherein said step of iteratively adjusting said at least one of said instrument operational parameters is accomplished via a simplex optimization algorithm. </claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 11</dependent-claim-reference> wherein the step of providing at least one known mass value and associated measured time of flight value includes providing a plurality of known mass values and associated measured time of flight values; 
<claim-text>and wherein the computing step includes computing times of flight of at least some of said plurality of known mass values as an electrostatic function of said plurality of instrument operational parameters; </claim-text>
<claim-text>and wherein said adjusting step includes adjusting at least one of said instrument operational parameters to thereby minimize differences between said computed times of flight and corresponding ones of said measured time of flight values. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. A method of calibrating time-of-flight (TOF) mass spectra comprising the steps of: 
<claim-text>providing a plurality of TOF mass spectrometer instrument operational parameters; </claim-text>
<claim-text>providing at least one known mass value and associated measured time of flight value therefore; </claim-text>
<claim-text>computing a time of flight of said at least one known mass value as an electrostatic function of said plurality of instrument operational parameters; and </claim-text>
<claim-text>iteratively optimizing at least one of said plurality of instrument operating parameters until said time of flight computed as an electrostatic function of said plurality of instrument operating parameters matches said measured time of flight value within a predetermined error tolerance value. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 17</dependent-claim-reference> wherein the step of iteratively optimizing said at least one of said plurality of instrument operating parameters includes iteratively optimizing said at least one of said plurality of instrument operating parameters according to a simplex optimization algorithm. </claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference> further including the step of specifying said predetermined error tolerance value. </claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 18</dependent-claim-reference> further including the step of providing a plurality of optimization parameters each corresponding to a separate one of said plurality of instrument operational parameters desired to be optimized; 
<claim-text>and wherein said iteratively optimizing step includes adjusting at least some of said plurality of instrument operational parameters corresponding to at least some of said plurality of optimization parameters until said time of flight computed as an electrostatic function of said plurality of instrument operating parameters matches said measured time of flight value within said predetermined error tolerance value. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00021">
<claim-text><highlight><bold>21</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00022">claim 20</dependent-claim-reference> wherein the step of providing at least one known mass value and associated measured time of flight value therefore includes providing a plurality of known mass values and associated measured time of flight values therefore; 
<claim-text>and wherein the computing step includes computing times of flight of said at least some of said plurality of known mass values as an electrostatic function of said plurality of instrument operational parameters; and </claim-text>
<claim-text>wherein the optimizing step includes iteratively optimizing at least one of said plurality of instrument operating parameters until at least some of said times of flight computed as an electrostatic function of said plurality of instrument operating parameters matches corresponding ones of said measured time of flight values within said predetermined error tolerance value. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00022">
<claim-text><highlight><bold>22</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 17</dependent-claim-reference> wherein said at least one known mass value defines a mass calibrant range; 
<claim-text>and further including the step of measuring a mass spectra of a sample including ions having at least one mass value outside said mass calibrant range after performing said iteratively optimizing step.</claim-text>
</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>2</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030001089A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030001089A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030001089A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030001089A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030001089A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030001089A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030001089A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030001089A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030001089A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
