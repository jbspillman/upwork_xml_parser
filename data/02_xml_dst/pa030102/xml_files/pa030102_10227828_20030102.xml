<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030004888A1-20030102-D00000.TIF SYSTEM "US20030004888A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00001.TIF SYSTEM "US20030004888A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00002.TIF SYSTEM "US20030004888A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00003.TIF SYSTEM "US20030004888A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00004.TIF SYSTEM "US20030004888A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00005.TIF SYSTEM "US20030004888A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00006.TIF SYSTEM "US20030004888A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00007.TIF SYSTEM "US20030004888A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00008.TIF SYSTEM "US20030004888A1-20030102-D00008.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00009.TIF SYSTEM "US20030004888A1-20030102-D00009.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00010.TIF SYSTEM "US20030004888A1-20030102-D00010.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00011.TIF SYSTEM "US20030004888A1-20030102-D00011.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00012.TIF SYSTEM "US20030004888A1-20030102-D00012.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00013.TIF SYSTEM "US20030004888A1-20030102-D00013.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00014.TIF SYSTEM "US20030004888A1-20030102-D00014.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00015.TIF SYSTEM "US20030004888A1-20030102-D00015.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00016.TIF SYSTEM "US20030004888A1-20030102-D00016.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00017.TIF SYSTEM "US20030004888A1-20030102-D00017.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00018.TIF SYSTEM "US20030004888A1-20030102-D00018.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00019.TIF SYSTEM "US20030004888A1-20030102-D00019.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00020.TIF SYSTEM "US20030004888A1-20030102-D00020.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00021.TIF SYSTEM "US20030004888A1-20030102-D00021.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00022.TIF SYSTEM "US20030004888A1-20030102-D00022.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00023.TIF SYSTEM "US20030004888A1-20030102-D00023.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00024.TIF SYSTEM "US20030004888A1-20030102-D00024.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00025.TIF SYSTEM "US20030004888A1-20030102-D00025.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00026.TIF SYSTEM "US20030004888A1-20030102-D00026.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00027.TIF SYSTEM "US20030004888A1-20030102-D00027.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00028.TIF SYSTEM "US20030004888A1-20030102-D00028.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00029.TIF SYSTEM "US20030004888A1-20030102-D00029.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00030.TIF SYSTEM "US20030004888A1-20030102-D00030.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00031.TIF SYSTEM "US20030004888A1-20030102-D00031.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00032.TIF SYSTEM "US20030004888A1-20030102-D00032.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00033.TIF SYSTEM "US20030004888A1-20030102-D00033.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00034.TIF SYSTEM "US20030004888A1-20030102-D00034.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00035.TIF SYSTEM "US20030004888A1-20030102-D00035.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00036.TIF SYSTEM "US20030004888A1-20030102-D00036.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00037.TIF SYSTEM "US20030004888A1-20030102-D00037.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00038.TIF SYSTEM "US20030004888A1-20030102-D00038.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00039.TIF SYSTEM "US20030004888A1-20030102-D00039.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00040.TIF SYSTEM "US20030004888A1-20030102-D00040.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00041.TIF SYSTEM "US20030004888A1-20030102-D00041.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00042.TIF SYSTEM "US20030004888A1-20030102-D00042.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00043.TIF SYSTEM "US20030004888A1-20030102-D00043.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00044.TIF SYSTEM "US20030004888A1-20030102-D00044.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00045.TIF SYSTEM "US20030004888A1-20030102-D00045.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00046.TIF SYSTEM "US20030004888A1-20030102-D00046.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00047.TIF SYSTEM "US20030004888A1-20030102-D00047.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00048.TIF SYSTEM "US20030004888A1-20030102-D00048.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00049.TIF SYSTEM "US20030004888A1-20030102-D00049.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00050.TIF SYSTEM "US20030004888A1-20030102-D00050.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00051.TIF SYSTEM "US20030004888A1-20030102-D00051.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00052.TIF SYSTEM "US20030004888A1-20030102-D00052.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00053.TIF SYSTEM "US20030004888A1-20030102-D00053.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00054.TIF SYSTEM "US20030004888A1-20030102-D00054.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00055.TIF SYSTEM "US20030004888A1-20030102-D00055.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00056.TIF SYSTEM "US20030004888A1-20030102-D00056.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00057.TIF SYSTEM "US20030004888A1-20030102-D00057.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00058.TIF SYSTEM "US20030004888A1-20030102-D00058.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00059.TIF SYSTEM "US20030004888A1-20030102-D00059.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00060.TIF SYSTEM "US20030004888A1-20030102-D00060.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00061.TIF SYSTEM "US20030004888A1-20030102-D00061.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00062.TIF SYSTEM "US20030004888A1-20030102-D00062.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00063.TIF SYSTEM "US20030004888A1-20030102-D00063.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00064.TIF SYSTEM "US20030004888A1-20030102-D00064.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00065.TIF SYSTEM "US20030004888A1-20030102-D00065.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00066.TIF SYSTEM "US20030004888A1-20030102-D00066.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00067.TIF SYSTEM "US20030004888A1-20030102-D00067.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00068.TIF SYSTEM "US20030004888A1-20030102-D00068.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00069.TIF SYSTEM "US20030004888A1-20030102-D00069.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00070.TIF SYSTEM "US20030004888A1-20030102-D00070.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00071.TIF SYSTEM "US20030004888A1-20030102-D00071.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00072.TIF SYSTEM "US20030004888A1-20030102-D00072.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00073.TIF SYSTEM "US20030004888A1-20030102-D00073.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00074.TIF SYSTEM "US20030004888A1-20030102-D00074.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00075.TIF SYSTEM "US20030004888A1-20030102-D00075.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00076.TIF SYSTEM "US20030004888A1-20030102-D00076.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00077.TIF SYSTEM "US20030004888A1-20030102-D00077.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00078.TIF SYSTEM "US20030004888A1-20030102-D00078.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00079.TIF SYSTEM "US20030004888A1-20030102-D00079.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00080.TIF SYSTEM "US20030004888A1-20030102-D00080.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00081.TIF SYSTEM "US20030004888A1-20030102-D00081.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00082.TIF SYSTEM "US20030004888A1-20030102-D00082.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00083.TIF SYSTEM "US20030004888A1-20030102-D00083.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00084.TIF SYSTEM "US20030004888A1-20030102-D00084.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00085.TIF SYSTEM "US20030004888A1-20030102-D00085.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00086.TIF SYSTEM "US20030004888A1-20030102-D00086.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00087.TIF SYSTEM "US20030004888A1-20030102-D00087.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00088.TIF SYSTEM "US20030004888A1-20030102-D00088.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00089.TIF SYSTEM "US20030004888A1-20030102-D00089.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00090.TIF SYSTEM "US20030004888A1-20030102-D00090.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00091.TIF SYSTEM "US20030004888A1-20030102-D00091.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00092.TIF SYSTEM "US20030004888A1-20030102-D00092.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00093.TIF SYSTEM "US20030004888A1-20030102-D00093.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00094.TIF SYSTEM "US20030004888A1-20030102-D00094.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00095.TIF SYSTEM "US20030004888A1-20030102-D00095.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00096.TIF SYSTEM "US20030004888A1-20030102-D00096.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00097.TIF SYSTEM "US20030004888A1-20030102-D00097.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00098.TIF SYSTEM "US20030004888A1-20030102-D00098.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00099.TIF SYSTEM "US20030004888A1-20030102-D00099.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00100.TIF SYSTEM "US20030004888A1-20030102-D00100.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00101.TIF SYSTEM "US20030004888A1-20030102-D00101.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00102.TIF SYSTEM "US20030004888A1-20030102-D00102.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00103.TIF SYSTEM "US20030004888A1-20030102-D00103.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00104.TIF SYSTEM "US20030004888A1-20030102-D00104.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00105.TIF SYSTEM "US20030004888A1-20030102-D00105.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00106.TIF SYSTEM "US20030004888A1-20030102-D00106.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00107.TIF SYSTEM "US20030004888A1-20030102-D00107.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00108.TIF SYSTEM "US20030004888A1-20030102-D00108.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00109.TIF SYSTEM "US20030004888A1-20030102-D00109.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00110.TIF SYSTEM "US20030004888A1-20030102-D00110.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00111.TIF SYSTEM "US20030004888A1-20030102-D00111.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00112.TIF SYSTEM "US20030004888A1-20030102-D00112.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00113.TIF SYSTEM "US20030004888A1-20030102-D00113.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00114.TIF SYSTEM "US20030004888A1-20030102-D00114.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00115.TIF SYSTEM "US20030004888A1-20030102-D00115.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00116.TIF SYSTEM "US20030004888A1-20030102-D00116.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00117.TIF SYSTEM "US20030004888A1-20030102-D00117.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00118.TIF SYSTEM "US20030004888A1-20030102-D00118.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00119.TIF SYSTEM "US20030004888A1-20030102-D00119.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00120.TIF SYSTEM "US20030004888A1-20030102-D00120.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00121.TIF SYSTEM "US20030004888A1-20030102-D00121.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00122.TIF SYSTEM "US20030004888A1-20030102-D00122.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00123.TIF SYSTEM "US20030004888A1-20030102-D00123.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00124.TIF SYSTEM "US20030004888A1-20030102-D00124.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00125.TIF SYSTEM "US20030004888A1-20030102-D00125.TIF" NDATA TIF>
<!ENTITY US20030004888A1-20030102-D00126.TIF SYSTEM "US20030004888A1-20030102-D00126.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030004888</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10227828</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20020827</filing-date>
</domestic-filing-data>
<foreign-priority-data>
<priority-application-number>
<doc-number>9-122511</doc-number>
</priority-application-number>
<filing-date>19970513</filing-date>
<country-code>JP</country-code>
</foreign-priority-data>
<foreign-priority-data>
<priority-application-number>
<doc-number>10-016618</doc-number>
</priority-application-number>
<filing-date>19980129</filing-date>
<country-code>JP</country-code>
</foreign-priority-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>G06F017/60</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>705</class>
<subclass>059000</subclass>
</uspc>
</classification-us-primary>
</classification-us>
<title-of-invention>Information recording apparatus, information reproducing apparatus, and information distribution system</title-of-invention>
</technical-information>
<continuity-data>
<division-of>
<parent-child>
<child>
<document-id>
<doc-number>10227828</doc-number>
<kind-code>A1</kind-code>
<document-date>20020827</document-date>
</document-id>
</child>
<parent>
<document-id>
<doc-number>09076826</doc-number>
<document-date>19980513</document-date>
<country-code>US</country-code>
</document-id>
</parent>
<parent-status>GRANTED</parent-status>
<parent-patent>
<document-id>
<doc-number>6477649</doc-number>
<country-code>US</country-code>
</document-id>
</parent-patent>
</parent-child>
</division-of>
</continuity-data>
<inventors>
<first-named-inventor>
<name>
<given-name>Toru</given-name>
<family-name>Kambayashi</family-name>
</name>
<residence>
<residence-non-us>
<city>Chigasaki-shi</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Koichiro</given-name>
<family-name>Akiyama</family-name>
</name>
<residence>
<residence-non-us>
<city>Naka-gun</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Shuichi</given-name>
<family-name>Tsujimoto</family-name>
</name>
<residence>
<residence-non-us>
<city>Yokohama-shi</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Kazuo</given-name>
<family-name>Sumita</family-name>
</name>
<residence>
<residence-non-us>
<city>Yokohama-shi</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Hideki</given-name>
<family-name>Hirakawa</family-name>
</name>
<residence>
<residence-non-us>
<city>Yokohama-shi</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Toshihiro</given-name>
<family-name>Sugaya</family-name>
</name>
<residence>
<residence-non-us>
<city>Kitasoma-gun</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<correspondence-address>
<name-1>OBLON SPIVAK MCCLELLAND MAIER &amp; NEUSTADT PC</name-1>
<name-2>FOURTH FLOOR</name-2>
<address>
<address-1>1755 JEFFERSON DAVIS HIGHWAY</address-1>
<city>ARLINGTON</city>
<state>VA</state>
<postalcode>22202</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">An information recording apparatus comprises an encryption section encrypting contents information and also a license condition referred to to limit use of the contents information and a decoding key for decoding the encrypted contents information to generate license information, and a recording section recording the encrypted contents information and the generated license information on a recording medium. An information reproducing apparatus comprises a decoder unit decoding the license information recorded on the recording medium using a second decoding key for decoding the license information and deciding on the basis of the license condition contained in the decoded license information whether the contents information can be used. If it is decided that the contents information can be used, the encrypted contents information recorded on the recording medium is decoded using the first decoding key contained in the decoded license information. </paragraph>
</subdoc-abstract>
<subdoc-description>
<summary-of-invention>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> The present invention relates to an information recording apparatus for recording information on a recording medium such as a DVD, an information reproducing apparatus for reproducing information recorded on a recording medium such as a DVD, and an information distribution system including an information recording/reproducing apparatus for charging for use of information recorded on a recording medium or distributed through a network or by broadcasting. </paragraph>
<paragraph id="P-0002" lvl="0"><number>&lsqb;0002&rsqb;</number> In recent years, the advance of digital information processing technology and communication technology such as a broadband ISDN, and the development of an advanced information recording medium such as a DVD which realizes a large capacity and high-quality image and sound are progressing. Along with such development of a variety of advanced information transmission means, the circumstances are allowing users to make use of an enormous number of digitized works which are distributed to the users through a network, a recording medium, or the like. These circumstances increase opportunities for copies and alterations without permission of authors or distribution unintended by authors, so copyright holders are anxious about infringement on their benefits. </paragraph>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> An important challenge for wiping out such anxiety of copyright holders is the development of a system which allows quick and easy distribution of digitized works and provides a fair digital information usage environment assuming protection by copyright. </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> A DVD is a large-capacity personal computer medium replacing a CD-ROM, and various applications to movie, music, game, karaoke, and the like can be expected. For popularization of DVDs, inexpensive DVD titles or spread of a rental DVD market is expected. From these viewpoints as well, it is essential to provide an information distribution system assuming protection by copyright of information, i.e., a system based on a concept of charging not for possession of a digitized work recorded on a recording medium such as a DVD but for use of the digitized work. </paragraph>
</section>
<section>
<heading lvl="1">BRIEF SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> It is an object of the present invention to provide an information recording apparatus, an information reproducing apparatus, and an accounting apparatus to constitute an information distribution system which allows quick and easy distribution of digitized works and provides a digital information usage environment assuming protection by copyright. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> It is another object of the present invention to provide an information recording apparatus for quickly and easily distributing digitized works which are distributed through a network or a recording medium and constituting a digital information usage environment assuming protection by copyright by charging for use of digital information, an apparatus for reproducing the recorded information, and an accounting apparatus for charging for use of information. </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> According to an aspect of the present invention, there is provided an information recording apparatus comprising an encryption section for encrypting contents information, a license information generator for encrypting at least a license condition referred to limit use of the contents information and a decoding key for decoding the encrypted contents information to generate license information, and a recording section for recording the contents information encrypted by the encryption section and the license information generated by the license information generator on a recording medium. </paragraph>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> According to another aspect of the present invention, there is provided an information reproducing apparatus comprising a storage section for storing second decoding key information for decoding license information, a first decoder section for decoding the license information recorded on the recording medium using the second decoding key stored in the storage section, a decision section for deciding, on the basis of a license condition contained in the license information decoded by the first decoder section, whether contents information can be used, a second decoder section for decoding the encrypted contents information recorded on the recording medium using the first decoding key contained in the license information decoded by the first decoder section when the decision section decides that the contents information can be used, and a reproduction section for reproducing the contents information decoded by the second decoder section. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> According to the information recording apparatus of the present invention, the encrypted contents information and the license condition of the contents information are inseparately recorded on the recording medium. Only the information reproducing apparatus having an authentic decoding key for decoding the license information can reproduce the contents information recorded on the recording medium. In addition, since, before decoding, it is always decided on the basis of the license condition contained in the license information whether the contents information can be used, use of the contents information under an illicit use condition is disabled. Therefore, digital information assuming protection by, copyright of the contents information can be quickly and easily distributed. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> According to still another aspect of the present invention, there is provided an accounting apparatus for charging for use of contents information recorded on a recording medium, comprising an input section for inputting a desired condition for use of the contents information recorded on the recording medium, a fee claiming section for claiming a fee for use of the contents information on the basis of the condition input by the input section, and a recording section for, upon confirming fee payment in response to the claim, recording, on the recording medium, license information containing at least a license condition for limiting use of the contents information recorded on the recording medium on the basis of the condition input by the input section. With this arrangement, for the recording medium on which the contents information and the license information containing the license condition for limiting use of the contents information are recorded, appropriate charging for use of the contents information is enabled. In addition, digital information assuming protection by copyright of the contents information can be quickly and easily distributed. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> According to still another aspect of the present invention, there is provided an accounting apparatus for charging for use of contents information through a recording medium on which contents information and encrypted license information containing at least a license condition referred to to limit the use of the contents information are recorded, comprising a license information input-section for inputting the encrypted license information recorded on the recording medium, a decoder section for decoding the encrypted license information input by the license information input section, a condition acceptance section for accepting a desired condition for use of the contents information, a fee claiming section for claiming a fee for use of the contents information on the basis of the condition accepted by the condition acceptance section, a license information update section for, upon confirming fee payment in response to the claim, updating the license information decoded by the decoder section, on the basis of the condition input by the condition input section, an encryption section for encrypting the license information updated by the license information update section, and an output section for outputting the license information encrypted by the encryption section. With this arrangement, for the recording medium on which the contents information and the license information containing the license condition for limiting use of the contents information are recorded, appropriate charging for use of the contents information is enabled. In addition, digital information assuming protection by copyright of the contents information can be quickly and easily distributed. </paragraph>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> According to still another aspect of the present invention, there is provided a decision apparatus for deciding, on the basis of encrypted license information containing at least a license condition referred to to limit use of contents information and key information for decoding the contents information, whether the contents information can be used, comprising a key generator for generating a public key used to encrypt the license information and a secret key for decoding the license information at a predetermined timing, the secret key corresponding to the public key, a decoder section for decoding the input license information using the secret key generated by the key generator, a decision section for deciding on the basis of the license condition contained in the license information decoded by the decoder section, whether the contents information can be decoded, and an output section for outputting key information contained in the license information decoded by the decoder section when the decision section decides that the contents information can be used. </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> According to the present invention, since the secret parameter for decoding the license information is generated in a decoder unit A at a predetermined timing and used only within a predetermined period, information security for the license information containing the license condition of the contents information and contents information decoding key can be improved. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> According to an update apparatus of the present invention, which updates license information on the basis of a request for updating the license information upon receiving at least a newly designated license condition and second key generation information necessary for generating second key information from a decision device for deciding, on the basis of encrypted license information containing at least a license condition referred to to limit use of contents information, encrypted first key information for decoding the contents information, and first key generation information necessary for generating the second key information for decoding the encrypted first key information, whether the contents information can be used, the license condition and the first key generation information are updated, the second key information is updated on the basis of the updated first key generation information and the second key generation information, and the first key information is encrypted using the updated second key information to generate encrypted license information containing at least the updated license condition, the first key information encrypted using the updated second key information, and the updated first key generation information. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> According to the present invention, when the license information is to be updated, the license information can be updated while ensuring the information security without supplying the contents decoding key. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> According to an update apparatus of the present invention, which updates license information on the basis of a request for updating the license information upon receiving at least a newly designated license condition, second key generation information necessary for generating second key information, and an updated public key from a decision device for deciding, on the basis of the license information containing at least a license condition referred to to limit use of contents information, encrypted first key information for decoding the contents information, and first key generation information necessary for generating the second key information for decoding the encrypted first key information, whether the contents information can be used, the license information being encrypted using a public key, the license condition and the first key generation information are updated, the second key information is updated on the basis of the updated first key generation information and the second key generation information, and the first key information is encrypted using the updated second key information to generate license information containing at least the updated license condition, the first key information encrypted using the updated second key information, and the updated first key generation information, and the generated license information is encrypted using the supplied public key. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> According to the present invention, when the license information is to be updated, the license information can be updated while ensuring the information security without supplying the contents decoding key. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> According to the present invention, there is provided an information usage apparatus which receives encrypted first key information for decoding encrypted contents information and first key generation information necessary for generating second key information for decoding the first key information and decodes and uses the contents information, wherein second key generation information necessary for generating the second key information for decoding the first key information is held, the second key information is generated on the basis of the second key generation information and the input first key generation information, and the encrypted contents information is decoded using the generated second key information. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> According to the present invention, since the decoding key (first key information) of the contents information is input to the information usage apparatus while being kept encrypted, the information security between the device for outputting the first key information and the information usage apparatus can be improved. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> According to still another aspect of the present invention, there is provided an information reproducing apparatus for reproducing contents information from a recording medium on which encrypted contents information and license information containing at least a license condition referred to to limit use of the contents information and first key information for decoding the contents information are recorded, comprising an instrument section for measuring a date and time, a decision section for deciding, on the basis of the date and time measured by the instrument section and the license information recorded on the recording medium, whether the contents information can be used, and an information reproduction section for, when the decision section decides that the contents information can be used, decoding and reproducing the contents information recorded on the recording medium using the first key information output from the decision section, wherein information for notifying the decision section of the date and time from the instrument section and the first key information output from the decision section to the information reproduction section are encrypted. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> According to the present invention, the security of information to be transferred among the functional units (the instrument section, the decision section, and the information reproduction section) in the information generation device can be improved. </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> According to still another aspect of the present invention, there is provided an information recording method of recording, on a recording medium on which at least encrypted contents information is recorded, encrypted license information containing at least a license condition referred to to limit use of the contents information and a decoding key of the contents information, comprising transmitting information for designating second key information for encrypting first key information for encrypting the license information to a decision device for deciding whether the contents information can be used, receiving, from the portable recording medium, the first key information for encrypting the license information, which is encrypted using the designated second key information, and recording, on the recording medium, license information generated on the basis of a designated license condition and encrypted using the first key information. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> According to the present invention, the contents information recorded on the recording medium cannot be normally decoded unless the decision device which has been used to record the license information in the recording medium is not used. Therefore, illicit use of the contents information can be prevented. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> Additional objects and advantages of the invention will be set forth in the description which follows, and in part will be obvious from the description, or may be learned by practice of the invention. The objects and advantages of the invention may be realized and obtained by means of the instrumentalities and combinations particularly pointed out hereinbefore.</paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE SEVERAL VIEWS OF THE DRAWING </heading>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> The accompanying drawings, which are incorporated in and constitute a part of the specification, illustrate presently preferred embodiments of the invention, and together with the general description given above and the detailed description of the preferred embodiments give below, serve to explain the principles of the invention. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a block diagram showing the first arrangement of an information recording apparatus according to the first embodiment of the present invention; </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a flow chart for explaining the operation of the first information recording apparatus shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>; </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a block diagram showing the second arrangement of the information recording apparatus according to the first embodiment of the present invention; </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a flow chart for explaining the operation of the second information recording apparatus shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>; </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> <cross-reference target="DRAWINGS">FIGS. 5A and 5B</cross-reference> are views for explaining a method of separating accounting object information; </paragraph>
<paragraph id="P-0031" lvl="0"><number>&lsqb;0031&rsqb;</number> <cross-reference target="DRAWINGS">FIGS. 6A and 6B</cross-reference> are views for explaining another method of separating accounting object information; </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is a block diagram showing the third arrangement of the information recording apparatus according to the first embodiment of the present invention; </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a block diagram showing the first arrangement of an information reproducing apparatus according to the first embodiment of the present invention; </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is a block diagram showing an arrangement of a decoder unit shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>; </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a flow chart for explaining the operation of the first information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>; </paragraph>
<paragraph id="P-0036" lvl="0"><number>&lsqb;0036&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 11</cross-reference> is a flow chart for explaining the operation of the decoder unit shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>; </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 12</cross-reference> is a block diagram showing another arrangement of the decoder unit having a clock for disabling time update; </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is a flow chart for explaining the operation of the clock of the decoder unit, which disables time update; </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 14</cross-reference> is a flow chart for explaining the operation of the decoder unit shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference>; </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 15</cross-reference> is a block diagram showing an arrangement of the clock of the decoder unit capable of updating time; </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 16</cross-reference> is a flow chart for explaining the time update operation of the clock shown in <cross-reference target="DRAWINGS">FIG. 15</cross-reference>; </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 17</cross-reference> is a view showing a system constituted by a client and a server to update time of the clock of the decoder unit through a network; </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 18</cross-reference> is a block diagram showing an arrangement of a time setting client shown in <cross-reference target="DRAWINGS">FIG. 17</cross-reference>; </paragraph>
<paragraph id="P-0044" lvl="0"><number>&lsqb;0044&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 19</cross-reference> is a block diagram showing an arrangement of a time setting server shown in <cross-reference target="DRAWINGS">FIG. 17</cross-reference>; </paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 20</cross-reference> is a flow chart for explaining the operation of the time setting client shown in <cross-reference target="DRAWINGS">FIG. 18</cross-reference>; </paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 21</cross-reference> is a flow chart for explaining the operation of the time setting server shown in <cross-reference target="DRAWINGS">FIG. 19</cross-reference>; </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 22</cross-reference> is a flow chart for explaining the operation of the time setting server shown in <cross-reference target="DRAWINGS">FIG. 19</cross-reference>; </paragraph>
<paragraph id="P-0048" lvl="0"><number>&lsqb;0048&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 23</cross-reference> is a block diagram showing an arrangement of a clock incorporated in the time setting client shown in <cross-reference target="DRAWINGS">FIG. 18</cross-reference>; </paragraph>
<paragraph id="P-0049" lvl="0"><number>&lsqb;0049&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 24</cross-reference> is a flow chart for explaining the operation of the clock shown in <cross-reference target="DRAWINGS">FIG. 23</cross-reference>; </paragraph>
<paragraph id="P-0050" lvl="0"><number>&lsqb;0050&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 25</cross-reference> is a flow chart for explaining the operation of the clock shown in <cross-reference target="DRAWINGS">FIG. 23</cross-reference>; </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 26</cross-reference> is a block diagram showing an arrangement of an information reproducing apparatus (second information reproducing apparatus) having a function of updating license information and performing charging; </paragraph>
<paragraph id="P-0052" lvl="0"><number>&lsqb;0052&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 27</cross-reference> is a block diagram showing an arrangement of a decoder unit shown in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>; </paragraph>
<paragraph id="P-0053" lvl="0"><number>&lsqb;0053&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 28</cross-reference> is a flow chart for explaining the operation of the decoder unit shown in <cross-reference target="DRAWINGS">FIG. 27</cross-reference>; </paragraph>
<paragraph id="P-0054" lvl="0"><number>&lsqb;0054&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 29</cross-reference> is a block diagram showing an arrangement of a license information update client section shown in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>; </paragraph>
<paragraph id="P-0055" lvl="0"><number>&lsqb;0055&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 30</cross-reference> is a flow chart for explaining the operation of the license information update client section shown in <cross-reference target="DRAWINGS">FIG. 29</cross-reference>; </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 31</cross-reference> is a block diagram showing an arrangement of a license information update server shown in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>; </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 32</cross-reference> is a flow chart for explaining the operation of the license information update server shown in <cross-reference target="DRAWINGS">FIG. 31</cross-reference>; </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 33</cross-reference> is a view showing an example of contents of fee claiming for use of accounting object information output from the license information update server; </paragraph>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 34</cross-reference> is a flow chart for explaining the operation of the entire system (the server and the client communicating with each other through the network) shown in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>; </paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 35</cross-reference> is a block diagram showing an arrangement of a license information update unit; </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 36</cross-reference> is a flow-chart for explaining the operation of the license information update unit shown in <cross-reference target="DRAWINGS">FIG. 35</cross-reference>; </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 37</cross-reference> is a flow chart for explaining the operation of the license information update unit shown in <cross-reference target="DRAWINGS">FIG. 35</cross-reference>; </paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 38</cross-reference> is a block diagram showing an arrangement of an accounting apparatus for charging for use of accounting object information; </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 39</cross-reference> is a block diagram showing an arrangement of a decoder unit in an information reproducing apparatus with a measure for an illicit copy of accounting object information (decision is made on the basis of a decoder unit ID); </paragraph>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 40</cross-reference> is a flow chart for explaining the operation of the decoder unit shown in <cross-reference target="DRAWINGS">FIG. 39</cross-reference>; </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 41</cross-reference> is a block diagram showing an arrangement of a license information update unit with a measure for an illicit copy of accounting object information; </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 42</cross-reference> is a flow chart for explaining the operation of the license information update unit shown in <cross-reference target="DRAWINGS">FIG. 41</cross-reference>; </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 43</cross-reference> is a block diagram showing another arrangement of the decoder unit with a measure for an illicit copy of accounting object information (decision is made on the basis of a decoder unit ID and medium ID); </paragraph>
<paragraph id="P-0069" lvl="0"><number>&lsqb;0069&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 44</cross-reference> is a flow chart for explaining the operation of the decoder unit shown in <cross-reference target="DRAWINGS">FIG. 43</cross-reference>; </paragraph>
<paragraph id="P-0070" lvl="0"><number>&lsqb;0070&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 45</cross-reference> is a block diagram showing an arrangement of a copying apparatus; </paragraph>
<paragraph id="P-0071" lvl="0"><number>&lsqb;0071&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 46</cross-reference> is a flow chart for explaining the operation of the copying apparatus shown in <cross-reference target="DRAWINGS">FIG. 45</cross-reference>; </paragraph>
<paragraph id="P-0072" lvl="0"><number>&lsqb;0072&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 47</cross-reference> is a block diagram showing an arrangement of a license information copy unit shown in <cross-reference target="DRAWINGS">FIG. 45</cross-reference>; </paragraph>
<paragraph id="P-0073" lvl="0"><number>&lsqb;0073&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 48</cross-reference> is a flow chart for explaining the operation of the license information copy unit shown in <cross-reference target="DRAWINGS">FIG. 47</cross-reference>; </paragraph>
<paragraph id="P-0074" lvl="0"><number>&lsqb;0074&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 49</cross-reference> is a block diagram showing an arrangement of an information reproducing apparatus (third information reproducing apparatus) according to the first embodiment of the present invention, which reproduces subsidiary information; </paragraph>
<paragraph id="P-0075" lvl="0"><number>&lsqb;0075&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 50</cross-reference> is a block diagram showing an arrangement of the third information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 49</cross-reference>; </paragraph>
<paragraph id="P-0076" lvl="0"><number>&lsqb;0076&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 51</cross-reference> is a block diagram showing an arrangement of a decoder unit shown in <cross-reference target="DRAWINGS">FIG. 49</cross-reference>; </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 52</cross-reference> is a flow chart for explaining the operation of the decoder unit shown in <cross-reference target="DRAWINGS">FIG. 51</cross-reference>; </paragraph>
<paragraph id="P-0078" lvl="0"><number>&lsqb;0078&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 53</cross-reference> is a block diagram showing an arrangement of an information distribution system using the information recording apparatus and information reproducing apparatus of the present invention; </paragraph>
<paragraph id="P-0079" lvl="0"><number>&lsqb;0079&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 54</cross-reference> is a block diagram showing an arrangement of a decoder unit A according to the second embodiment of the present invention; </paragraph>
<paragraph id="P-0080" lvl="0"><number>&lsqb;0080&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 55</cross-reference> is a view showing an example of license information input to the decoder unit A; </paragraph>
<paragraph id="P-0081" lvl="0"><number>&lsqb;0081&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 56</cross-reference> is a view showing an example of updated information output from the decoder unit A; </paragraph>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 57</cross-reference> is a flow chart for explaining the processing operation of the decoder unit A; </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 58</cross-reference> is a flow chart for explaining the schematic procedure of key generation processing in a key holder section and key generation section of the decoder unit A; </paragraph>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 59</cross-reference> is a block diagram showing an arrangement of a decoder unit B; </paragraph>
<paragraph id="P-0085" lvl="0"><number>&lsqb;0085&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 60</cross-reference> is a view showing an example of license information input to the decoder unit B; </paragraph>
<paragraph id="P-0086" lvl="0"><number>&lsqb;0086&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 61</cross-reference> is a flow chart for explaining the processing operation of the decoder unit B; </paragraph>
<paragraph id="P-0087" lvl="0"><number>&lsqb;0087&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 62</cross-reference> is a view showing an example of updated information output from the decoder unit B; </paragraph>
<paragraph id="P-0088" lvl="0"><number>&lsqb;0088&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 63</cross-reference> is a block diagram showing an arrangement of a decoder unit C; </paragraph>
<paragraph id="P-0089" lvl="0"><number>&lsqb;0089&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 64</cross-reference> is a view showing an example of updated information output from the decoder unit C; </paragraph>
<paragraph id="P-0090" lvl="0"><number>&lsqb;0090&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 65</cross-reference> is a block diagram showing an arrangement of a decoder unit D; </paragraph>
<paragraph id="P-0091" lvl="0"><number>&lsqb;0091&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 66</cross-reference> is a view showing an example of license information input to the decoder unit D; </paragraph>
<paragraph id="P-0092" lvl="0"><number>&lsqb;0092&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 67</cross-reference> is a flow chart for explaining the processing operation of the decoder unit D; </paragraph>
<paragraph id="P-0093" lvl="0"><number>&lsqb;0093&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 68</cross-reference> is a flow chart for explaining the processing operation of the decoder unit D; </paragraph>
<paragraph id="P-0094" lvl="0"><number>&lsqb;0094&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 69</cross-reference> is a view showing an example of updated information output from the decoder unit D; </paragraph>
<paragraph id="P-0095" lvl="0"><number>&lsqb;0095&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 70</cross-reference> is a block diagram showing an arrangement of a decoder unit D&prime;; </paragraph>
<paragraph id="P-0096" lvl="0"><number>&lsqb;0096&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 71</cross-reference> is a block diagram showing an arrangement of a license information update apparatus corresponding to the decoder unit A; </paragraph>
<paragraph id="P-0097" lvl="0"><number>&lsqb;0097&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 72</cross-reference> is a flow chart for explaining the processing operation of the license information update apparatus shown in <cross-reference target="DRAWINGS">FIG. 71</cross-reference>; </paragraph>
<paragraph id="P-0098" lvl="0"><number>&lsqb;0098&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 73</cross-reference> is a block diagram showing an arrangement of a license information update apparatus corresponding to the decoder unit B; </paragraph>
<paragraph id="P-0099" lvl="0"><number>&lsqb;0099&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 74</cross-reference> is a flow chart for explaining the processing operation of the license information update apparatus shown in <cross-reference target="DRAWINGS">FIG. 73</cross-reference>; </paragraph>
<paragraph id="P-0100" lvl="0"><number>&lsqb;0100&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 75</cross-reference> is a block diagram showing an arrangement of an information distribution system according to the third embodiment; </paragraph>
<paragraph id="P-0101" lvl="0"><number>&lsqb;0101&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 76</cross-reference> is a block diagram showing another arrangement of the information distribution system according to the third embodiment; </paragraph>
<paragraph id="P-0102" lvl="0"><number>&lsqb;0102&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 77</cross-reference> is a block diagram showing an arrangement of the main part of an information reproducing apparatus in which a decoding decision card is mounted; </paragraph>
<paragraph id="P-0103" lvl="0"><number>&lsqb;0103&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 78</cross-reference> is a flow chart for explaining the processing operation of the information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 77</cross-reference> which is used in the information distribution system shown in <cross-reference target="DRAWINGS">FIG. 75</cross-reference>; </paragraph>
<paragraph id="P-0104" lvl="0"><number>&lsqb;0104&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 79</cross-reference> is a block diagram showing an arrangement of the main part of the decoding decision card; </paragraph>
<paragraph id="P-0105" lvl="0"><number>&lsqb;0105&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 80</cross-reference> is a flow chart for explaining the processing operation of the decoding decision card shown in <cross-reference target="DRAWINGS">FIG. 79</cross-reference>; </paragraph>
<paragraph id="P-0106" lvl="0"><number>&lsqb;0106&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 81</cross-reference> is a block diagram showing an arrangement of a time transfer section in the decoding decision card shown in <cross-reference target="DRAWINGS">FIG. 79</cross-reference>; </paragraph>
<paragraph id="P-0107" lvl="0"><number>&lsqb;0107&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 82</cross-reference> is a block diagram showing an arrangement of a certification section in the time transfer section shown in <cross-reference target="DRAWINGS">FIG. 81</cross-reference>; </paragraph>
<paragraph id="P-0108" lvl="0"><number>&lsqb;0108&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 83</cross-reference> is a flow chart for explaining the processing operation of the certification section shown in <cross-reference target="DRAWINGS">FIG. 82</cross-reference>; </paragraph>
<paragraph id="P-0109" lvl="0"><number>&lsqb;0109&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 84</cross-reference> is a block diagram showing an arrangement of a contents key transfer section in the decoding decision card shown in <cross-reference target="DRAWINGS">FIG. 79</cross-reference>; </paragraph>
<paragraph id="P-0110" lvl="0"><number>&lsqb;0110&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 85</cross-reference> is a block diagram showing an arrangement of a certification section in the contents key transfer section shown in <cross-reference target="DRAWINGS">FIG. 84</cross-reference>; </paragraph>
<paragraph id="P-0111" lvl="0"><number>&lsqb;0111&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 86</cross-reference> is a flow chart for explaining the processing operation of the certification section shown in <cross-reference target="DRAWINGS">FIG. 85</cross-reference>; </paragraph>
<paragraph id="P-0112" lvl="0"><number>&lsqb;0112&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 87</cross-reference> is a block diagram showing an arrangement of a clock shown in <cross-reference target="DRAWINGS">FIG. 77</cross-reference>; </paragraph>
<paragraph id="P-0113" lvl="0"><number>&lsqb;0113&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 88</cross-reference> is a block diagram showing an arrangement of a certification section in the clock shown in <cross-reference target="DRAWINGS">FIG. 87</cross-reference>; </paragraph>
<paragraph id="P-0114" lvl="0"><number>&lsqb;0114&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 89</cross-reference> is a flow chart for explaining the processing operation of the certification section shown in <cross-reference target="DRAWINGS">FIG. 88</cross-reference>; </paragraph>
<paragraph id="P-0115" lvl="0"><number>&lsqb;0115&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 90</cross-reference> is a block diagram showing an arrangement of a decoding decision section shown in <cross-reference target="DRAWINGS">FIG. 79</cross-reference>; </paragraph>
<paragraph id="P-0116" lvl="0"><number>&lsqb;0116&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 91</cross-reference> is a flow chart for explaining the processing operation of the decoding decision section shown in <cross-reference target="DRAWINGS">FIG. 90</cross-reference>; </paragraph>
<paragraph id="P-0117" lvl="0"><number>&lsqb;0117&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 92</cross-reference> is a block diagram showing an arrangement of an information reproduction section shown in <cross-reference target="DRAWINGS">FIG. 77</cross-reference>; </paragraph>
<paragraph id="P-0118" lvl="0"><number>&lsqb;0118&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 93</cross-reference> is a flow chart for explaining the processing operation of the information reproduction section shown in <cross-reference target="DRAWINGS">FIG. 92</cross-reference>; </paragraph>
<paragraph id="P-0119" lvl="0"><number>&lsqb;0119&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 94</cross-reference> is a block diagram showing an arrangement of a certification section in the information reproduction section shown in <cross-reference target="DRAWINGS">FIG. 92</cross-reference>; </paragraph>
<paragraph id="P-0120" lvl="0"><number>&lsqb;0120&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 95</cross-reference> is a flow chart for explaining the processing operation of the certification section shown in <cross-reference target="DRAWINGS">FIG. 94</cross-reference>; </paragraph>
<paragraph id="P-0121" lvl="0"><number>&lsqb;0121&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 96</cross-reference> is a block diagram showing another arrangement of the information reproduction section shown in <cross-reference target="DRAWINGS">FIG. 77</cross-reference>; </paragraph>
<paragraph id="P-0122" lvl="0"><number>&lsqb;0122&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 97</cross-reference> is a block diagram showing an arrangement of a license update apparatus; </paragraph>
<paragraph id="P-0123" lvl="0"><number>&lsqb;0123&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 98</cross-reference> is a flow chart for explaining the processing operation of the license update apparatus; </paragraph>
<paragraph id="P-0124" lvl="0"><number>&lsqb;0124&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 99</cross-reference> is a block diagram showing an arrangement of the main part of a decoding decision card as an interface with the update IF of the license update apparatus; </paragraph>
<paragraph id="P-0125" lvl="0"><number>&lsqb;0125&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 100</cross-reference> is a flow chart for explaining the processing operation of the decoding decision card in updating the license; </paragraph>
<paragraph id="P-0126" lvl="0"><number>&lsqb;0126&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 101</cross-reference> is a block diagram showing an arrangement of a license server; </paragraph>
<paragraph id="P-0127" lvl="0"><number>&lsqb;0127&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 102</cross-reference> is a flow chart for explaining the processing operation of the license server; </paragraph>
<paragraph id="P-0128" lvl="0"><number>&lsqb;0128&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 103</cross-reference> is a block diagram showing a system configuration constituted by a user terminal, a license server, and an electronic banking apparatus in updating the license using electronic banking; </paragraph>
<paragraph id="P-0129" lvl="0"><number>&lsqb;0129&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 104</cross-reference> is a block diagram showing an arrangement of a license update apparatus in the system configuration shown in <cross-reference target="DRAWINGS">FIG. 103</cross-reference>; </paragraph>
<paragraph id="P-0130" lvl="0"><number>&lsqb;0130&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 105</cross-reference> is a block diagram showing an arrangement of the license server in the system configuration shown in <cross-reference target="DRAWINGS">FIG. 103</cross-reference>; </paragraph>
<paragraph id="P-0131" lvl="0"><number>&lsqb;0131&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 106</cross-reference> is a flow chart for explaining the processing operation of the entire system in updating the license in the system configuration shown in <cross-reference target="DRAWINGS">FIG. 103</cross-reference>; </paragraph>
<paragraph id="P-0132" lvl="0"><number>&lsqb;0132&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 107</cross-reference> is a block diagram showing an entire arrangement of an information reproduction system according to the fourth embodiment of the present invention; </paragraph>
<paragraph id="P-0133" lvl="0"><number>&lsqb;0133&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 108</cross-reference> is a block diagram showing an arrangement of a license decision unit shown in <cross-reference target="DRAWINGS">FIG. 107</cross-reference>; </paragraph>
<paragraph id="P-0134" lvl="0"><number>&lsqb;0134&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 109</cross-reference> is a flow chart for explaining the processing operation of the information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 107</cross-reference>; </paragraph>
<paragraph id="P-0135" lvl="0"><number>&lsqb;0135&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 110</cross-reference> is a flow chart for explaining the processing operation of the information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 107</cross-reference>; </paragraph>
<paragraph id="P-0136" lvl="0"><number>&lsqb;0136&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 111</cross-reference> is a flow chart for explaining the processing operation of the information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 107</cross-reference> until license information is stored in a license database; </paragraph>
<paragraph id="P-0137" lvl="0"><number>&lsqb;0137&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 112</cross-reference> is a flow chart for explaining the license information decoding key generation processing of the information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 107</cross-reference>; </paragraph>
<paragraph id="P-0138" lvl="0"><number>&lsqb;0138&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 113</cross-reference> is a view showing a structure of contents information; </paragraph>
<paragraph id="P-0139" lvl="0"><number>&lsqb;0139&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 114</cross-reference> is a view showing a structure of license information; </paragraph>
<paragraph id="P-0140" lvl="0"><number>&lsqb;0140&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 115</cross-reference> is a view showing an example of storage of license information in a license information database; </paragraph>
<paragraph id="P-0141" lvl="0"><number>&lsqb;0141&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 116</cross-reference> is a view showing a structure of license update information; </paragraph>
<paragraph id="P-0142" lvl="0"><number>&lsqb;0142&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 117</cross-reference> is a view showing another example of storage of license information in the license information database; </paragraph>
<paragraph id="P-0143" lvl="0"><number>&lsqb;0143&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 118</cross-reference> is a block diagram showing another arrangement of the information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 107</cross-reference>; </paragraph>
<paragraph id="P-0144" lvl="0"><number>&lsqb;0144&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 119</cross-reference> is a block diagram showing another arrangement of the license decision unit shown in <cross-reference target="DRAWINGS">FIG. 107</cross-reference>; </paragraph>
<paragraph id="P-0145" lvl="0"><number>&lsqb;0145&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 120</cross-reference> is a flow chart for explaining the operation of the information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 118</cross-reference> until encrypted license information and decoding key seed information are separated from a received broadcasting wave to generate a decoding key; </paragraph>
<paragraph id="P-0146" lvl="0"><number>&lsqb;0146&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 121</cross-reference> is a view showing an example of the data structure of a broadcasting wave; </paragraph>
<paragraph id="P-0147" lvl="0"><number>&lsqb;0147&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 122</cross-reference> is a block diagram showing an arrangement of an information distribution system according to the fifth embodiment of the present invention; </paragraph>
<paragraph id="P-0148" lvl="0"><number>&lsqb;0148&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 123</cross-reference> is a view showing an example of data recorded on a rental disk; </paragraph>
<paragraph id="P-0149" lvl="0"><number>&lsqb;0149&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 124</cross-reference> is a view showing an example of storage of a disk key in a contents database prepared in a center; </paragraph>
<paragraph id="P-0150" lvl="0"><number>&lsqb;0150&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 125</cross-reference> is a view schematically showing the disk key distribution scheme in the information distribution system shown in <cross-reference target="DRAWINGS">FIG. 122</cross-reference>; </paragraph>
<paragraph id="P-0151" lvl="0"><number>&lsqb;0151&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 126</cross-reference> is a block diagram showing an arrangement of a license creation device; </paragraph>
<paragraph id="P-0152" lvl="0"><number>&lsqb;0152&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 127</cross-reference> is a block diagram showing an arrangement of a license issuing device; </paragraph>
<paragraph id="P-0153" lvl="0"><number>&lsqb;0153&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 128</cross-reference> is a block diagram showing an arrangement of a card; </paragraph>
<paragraph id="P-0154" lvl="0"><number>&lsqb;0154&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 129</cross-reference> is a block diagram showing an arrangement of a card adapter; </paragraph>
<paragraph id="P-0155" lvl="0"><number>&lsqb;0155&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 130</cross-reference> is a block diagram showing an arrangement of a player; </paragraph>
<paragraph id="P-0156" lvl="0"><number>&lsqb;0156&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 131</cross-reference> is a flow chart for explaining the disk information creation processing of the license creation device; </paragraph>
<paragraph id="P-0157" lvl="0"><number>&lsqb;0157&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 132</cross-reference> is a view showing an example of storage of disk information in a license database in the license issuing device; </paragraph>
<paragraph id="P-0158" lvl="0"><number>&lsqb;0158&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 133</cross-reference> is a view showing the schematic sequence of a disk key distribution procedure in the information distribution system shown in <cross-reference target="DRAWINGS">FIG. 122</cross-reference> about subscription to a disk rental service, rental of a disk, and reproduction of contents; </paragraph>
<paragraph id="P-0159" lvl="0"><number>&lsqb;0159&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 134</cross-reference> is a flow chart showing the disk key distribution procedure shown in <cross-reference target="DRAWINGS">FIG. 133</cross-reference> in more detail; </paragraph>
<paragraph id="P-0160" lvl="0"><number>&lsqb;0160&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 135</cross-reference> is a flow chart showing the disk key distribution procedure shown in <cross-reference target="DRAWINGS">FIG. 133</cross-reference> in more detail; </paragraph>
<paragraph id="P-0161" lvl="0"><number>&lsqb;0161&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 136</cross-reference> is a flow chart showing the disk key distribution procedure shown in <cross-reference target="DRAWINGS">FIG. 133</cross-reference> in more detail; </paragraph>
<paragraph id="P-0162" lvl="0"><number>&lsqb;0162&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 137</cross-reference> is a flow chart showing the disk key distribution procedure shown in <cross-reference target="DRAWINGS">FIG. 133</cross-reference> in more detail; </paragraph>
<paragraph id="P-0163" lvl="0"><number>&lsqb;0163&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 138</cross-reference> is a flow chart showing the disk key distribution procedure shown in <cross-reference target="DRAWINGS">FIG. 133</cross-reference> in more detail; </paragraph>
<paragraph id="P-0164" lvl="0"><number>&lsqb;0164&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 139</cross-reference> is a flow chart showing the disk key distribution procedure shown in <cross-reference target="DRAWINGS">FIG. 133</cross-reference> in more detail; </paragraph>
<paragraph id="P-0165" lvl="0"><number>&lsqb;0165&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 140</cross-reference> is a flow chart showing the disk key distribution procedure shown in <cross-reference target="DRAWINGS">FIG. 133</cross-reference> in more detail; </paragraph>
<paragraph id="P-0166" lvl="0"><number>&lsqb;0166&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 141</cross-reference> is a view showing the schematic sequence of another disk key distribution procedure in the information distribution system shown in <cross-reference target="DRAWINGS">FIG. 122</cross-reference> about subscription to a disk rental service, rental of a disk, and reproduction of contents; </paragraph>
<paragraph id="P-0167" lvl="0"><number>&lsqb;0167&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 142</cross-reference> is a flow chart showing the disk key distribution procedure shown in <cross-reference target="DRAWINGS">FIG. 141</cross-reference> in more detail; </paragraph>
<paragraph id="P-0168" lvl="0"><number>&lsqb;0168&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 143</cross-reference> is a flow chart showing the disk key distribution procedure shown in <cross-reference target="DRAWINGS">FIG. 141</cross-reference> in more detail; </paragraph>
<paragraph id="P-0169" lvl="0"><number>&lsqb;0169&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 144</cross-reference> is a flow chart showing the disk key distribution procedure shown in <cross-reference target="DRAWINGS">FIG. 141</cross-reference> in more detail; </paragraph>
<paragraph id="P-0170" lvl="0"><number>&lsqb;0170&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 145</cross-reference> is a flow chart showing the disk key distribution procedure shown in <cross-reference target="DRAWINGS">FIG. 141</cross-reference> in more detail: </paragraph>
<paragraph id="P-0171" lvl="0"><number>&lsqb;0171&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 146</cross-reference> is a flow chart showing the disk key distribution procedure shown in <cross-reference target="DRAWINGS">FIG. 141</cross-reference> in more detail; </paragraph>
<paragraph id="P-0172" lvl="0"><number>&lsqb;0172&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 147</cross-reference> is a flow chart for explaining encryption parameter update processing; </paragraph>
<paragraph id="P-0173" lvl="0"><number>&lsqb;0173&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 148</cross-reference> is a flow chart for explaining encryption parameter update processing; and </paragraph>
<paragraph id="P-0174" lvl="0"><number>&lsqb;0174&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 149</cross-reference> is a flow chart for explaining encryption parameter update processing.</paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DETAILED DESCRIPTION OF THE INVENTION </heading>
<paragraph id="P-0175" lvl="0"><number>&lsqb;0175&rsqb;</number> Embodiments of the present invention will be described below with reference to the accompanying drawing. </paragraph>
<paragraph id="P-0176" lvl="0"><number>&lsqb;0176&rsqb;</number> The entire configuration of an information distribution system using an information recording apparatus and information reproducing apparatus according to the first embodiment of the present invention will be briefly described first. </paragraph>
<paragraph id="P-0177" lvl="0"><number>&lsqb;0177&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 53</cross-reference> shows an arrangement of an information distribution system using the information recording apparatus and information reproducing apparatus of the present invention. Referring to <cross-reference target="DRAWINGS">FIG. 53, a</cross-reference> license information generation section <highlight><bold>1002</bold></highlight> and an information storage section <highlight><bold>1003</bold></highlight> are equivalent to those shown in <cross-reference target="DRAWINGS">FIGS. 1, 3</cross-reference>, <highlight><bold>7</bold></highlight>, or the like, and a decoder unit <highlight><bold>1013</bold></highlight> is equivalent to that shown in <cross-reference target="DRAWINGS">FIGS. 9, 12</cross-reference>, <highlight><bold>27</bold></highlight>, <highlight><bold>39</bold></highlight>, <highlight><bold>43</bold></highlight>, or the like. A reproduction section <highlight><bold>1014</bold></highlight> and a readout section <highlight><bold>1012</bold></highlight> are also equivalent to those in the information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference> or the like. </paragraph>
<paragraph id="P-0178" lvl="0"><number>&lsqb;0178&rsqb;</number> The operation of the entire system shown in <cross-reference target="DRAWINGS">FIG. 53</cross-reference> will be briefly described below. Accounting object information is encrypted by an encryption key ke(1) (accounting object information ke(1)). First, a decoding key kd(1) of the accounting object information and a license condition such as an expiration date are input to the license information generation section <highlight><bold>1002</bold></highlight> (steps S<highlight><bold>701</bold></highlight> and S<highlight><bold>702</bold></highlight>). </paragraph>
<paragraph id="P-0179" lvl="0"><number>&lsqb;0179&rsqb;</number> The license information generation section <highlight><bold>1002</bold></highlight> merges the decoding key kd(1) with the license condition and then performs encryption using the encryption key ke to generate license information and sends it to the information storage section <highlight><bold>1003</bold></highlight> (step S<highlight><bold>703</bold></highlight>). The encrypted accounting object information is also input to the information storage section <highlight><bold>1003</bold></highlight> (step S<highlight><bold>704</bold></highlight>) and recorded on an information storage section <highlight><bold>1004</bold></highlight> together with the license information (step S<highlight><bold>705</bold></highlight>). </paragraph>
<paragraph id="P-0180" lvl="0"><number>&lsqb;0180&rsqb;</number> The information storage section <highlight><bold>1004</bold></highlight> comprises a medium such as a DVD-ROM, a DVD-RAM, or a hard disk. Information recorded on this medium is transferred to another medium (i.e., an information storage section <highlight><bold>1015</bold></highlight>) directly or through broadcasting or the Internet and read out by the readout section <highlight><bold>1012</bold></highlight> in an information reproducing apparatus <highlight><bold>1011</bold></highlight> (step S<highlight><bold>706</bold></highlight>). The readout license information is sent to the decoder unit <highlight><bold>1013</bold></highlight> (step S<highlight><bold>707</bold></highlight>). The decoder unit <highlight><bold>1013</bold></highlight> holding the decoding key kd corresponding to the encryption key ke decodes the license information and extracts the decoding key kd(1) and license condition of the accounting object information. The decoder unit <highlight><bold>1013</bold></highlight> checks the license condition to decide whether the accounting object information can be used. If the accounting object information is usable, the decoder unit outputs the decoding key kd(1) to the reproduction section <highlight><bold>1014</bold></highlight> (step S<highlight><bold>708</bold></highlight>). The reproduction section <highlight><bold>1014</bold></highlight> extracts the &lsqb;accounting object information&rsqb; ke(1) from the readout section <highlight><bold>1012</bold></highlight> (step S<highlight><bold>709</bold></highlight>) and decodes it using the decoding key kd(1) to reproduce the accounting object information. </paragraph>
<paragraph id="P-0181" lvl="0"><number>&lsqb;0181&rsqb;</number> The decoder unit <highlight><bold>1013</bold></highlight> holds the decoding key kd and an algorithm for decoding license information. To avoid attack on security, the decoder unit <highlight><bold>1013</bold></highlight> is preferably mounted not, as software but as, e.g., an IC chip. In this case, the decoder unit <highlight><bold>1013</bold></highlight> comprises an IC chip having a license information input section and an output section for outputting the decoding key of accounting object information (upon deciding that the accounting object information is usable). Decoding and decision of the use enable/disable condition are performed in the chip. </paragraph>
<paragraph id="P-0182" lvl="0"><number>&lsqb;0182&rsqb;</number> As one gist of the present invention, the license information generation section <highlight><bold>1002</bold></highlight> merges the decoding key kd(1) of accounting object information with the license condition and then performs encryption. Generally, encryption is performed by scrambling information bits to be encrypted. Therefore, once encryption is performed, two pieces of information which have simultaneously been encrypted cannot be separated (without using decoding). It is important to disable separation of accounting object information from the license condition using the nature of encryption. </paragraph>
<paragraph id="P-0183" lvl="0"><number>&lsqb;0183&rsqb;</number> In the above-described example, the accounting object information is encrypted by the encryption key ke(1). Therefore, </paragraph>
<paragraph id="P-0184" lvl="2"><number>&lsqb;0184&rsqb;</number> 1. To use the accounting object information, the decoding key kd(1) is required. However, the decoding key kd(1) is encrypted into license information such that the decoding key and the license condition are inseparable. Although the license information and the accounting object information can be separated from each other, invalid license information does not contain the decoding key for properly decoding the accounting object information, so &ldquo;substitution&rdquo; of license information is meaningless. </paragraph>
<paragraph id="P-0185" lvl="2"><number>&lsqb;0185&rsqb;</number> 2. To obtain the correct decoding key kd(1), valid license information must be decoded. However, </paragraph>
<paragraph id="P-0186" lvl="2"><number>&lsqb;0186&rsqb;</number> 3. Only a proper decoder unit having the decoding key kd can perform this decoding. </paragraph>
<paragraph id="P-0187" lvl="2"><number>&lsqb;0187&rsqb;</number> 4. The proper decoder unit always refers to the license condition contained in the license information to decide the use enable/disable condition. Therefore, </paragraph>
<paragraph id="P-0188" lvl="2"><number>&lsqb;0188&rsqb;</number> 5. In the apparatus including the license information generation section and decoder unit of the present invention, the accounting object information cannot be used under an invalid license condition in principle. </paragraph>
<paragraph id="P-0189" lvl="0"><number>&lsqb;0189&rsqb;</number> If the decoder unit <highlight><bold>1013</bold></highlight> decides that the accounting object information cannot be used and does not output the decoding key kd(1), the license information must be updated or valid license information must be added to use the accounting object information. At this timing, accounting for the user of the information is generated. The user must update the license information or acquire new license information somehow by a shop or vending machine or through the Internet. An apparatus or vending machine set in a shop or a network server holds the decoding key kd and the encryption key ke and therefore can decode the license information and rewrite and reencrypt the information so as to update the license information. </paragraph>
<paragraph id="P-0190" lvl="0"><number>&lsqb;0190&rsqb;</number> If the user wants to update the license information (or obtain new license information), (one of) the license information added to the accounting object information must be sent to an apparatus having a license information update function. </paragraph>
<paragraph id="P-0191" lvl="2"><number>&lsqb;0191&rsqb;</number> 1&prime;. Only a proper apparatus having the decoding key kd and the encryption key ke can decode/separate the decoding key kd(1) and the license condition of the accounting object information. </paragraph>
<paragraph id="P-0192" lvl="2"><number>&lsqb;0192&rsqb;</number> 2&prime;. Only a proper apparatus having the decoding key kd and the encryption key ke can reencrypt the license information after the rewrite of the license condition. </paragraph>
<paragraph id="P-0193" lvl="0"><number>&lsqb;0193&rsqb;</number> The updated license information is output from the license information update apparatus (a license information update client section <highlight><bold>403</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 26, a</cross-reference> license information update unit <highlight><bold>603</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 38, a</cross-reference> license information update unit <highlight><bold>702</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 41</cross-reference>, or a license information update unit <highlight><bold>804</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 47</cross-reference>) and returned to the user&apos;s medium. The license information is kept encrypted outside the license information update apparatus. </paragraph>
<paragraph id="P-0194" lvl="2"><number>&lsqb;0194&rsqb;</number> 3&prime;. Since the license information has undergone encryption as a characteristic feature of the present invention, the license condition cannot be inadequately changed. </paragraph>
<paragraph id="P-0195" lvl="0"><number>&lsqb;0195&rsqb;</number> Generally, to transmit a decoding key through a network, the decoding key is often reencrypted using another key. However, as the characteristic feature of the present invention, the decoding key kd(1) for decoding the encrypted accounting object information is merged with the license condition and then encrypted. This provides a significant effect in protection and charge for accounting object information such as a work, as described above. </paragraph>
<paragraph id="P-0196" lvl="0"><number>&lsqb;0196&rsqb;</number> The arrangements and operations of the information recording apparatus, the information reproducing apparatus, and the accounting apparatus of the present invention will be described below in detail. </paragraph>
<paragraph id="P-0197" lvl="7"><number>&lsqb;0197&rsqb;</number> (1) Information Recording Apparatus </paragraph>
<paragraph id="P-0198" lvl="7"><number>&lsqb;0198&rsqb;</number> (1-1) First Example of Information Recording Apparatus </paragraph>
<paragraph id="P-0199" lvl="0"><number>&lsqb;0199&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> shows the first arrangement of an information recording apparatus according to the present invention. More specifically, <cross-reference target="DRAWINGS">FIG. 1</cross-reference> shows an arrangement of an information recording apparatus which encrypts contents information (to be referred to as accounting object information hereinafter) as an accounting object such as a digitized work, encrypts the license condition of the accounting object information and a decoding key for decoding the encrypted accounting object information to generate license information, and records the encrypted accounting object information and license information on a predetermined recording medium. </paragraph>
<paragraph id="P-0200" lvl="0"><number>&lsqb;0200&rsqb;</number> The information recording apparatus roughly comprises an accounting object information input section <highlight><bold>2</bold></highlight>, a license information generation section <highlight><bold>3</bold></highlight>, and a recording section <highlight><bold>8</bold></highlight>. </paragraph>
<paragraph id="P-0201" lvl="0"><number>&lsqb;0201&rsqb;</number> Accounting object information is encrypted in advance using the encryption key ke(1) and input to the accounting object information input section <highlight><bold>2</bold></highlight>. A decoding key corresponding to the encryption key ke(1) is the decoding key kd(1). Encryption of information X using an encryption key K will often be expressed as &lsqb;X&rsqb; k hereinafter, as needed. </paragraph>
<paragraph id="P-0202" lvl="0"><number>&lsqb;0202&rsqb;</number> The license information generation section <highlight><bold>3</bold></highlight> is constituted by a license condition input section <highlight><bold>4</bold></highlight>, a decoding key input section <highlight><bold>5</bold></highlight>, a key holder section <highlight><bold>6</bold></highlight>, and an encryption section <highlight><bold>7</bold></highlight>. </paragraph>
<paragraph id="P-0203" lvl="0"><number>&lsqb;0203&rsqb;</number> The encryption key ke is stored in the key holder section <highlight><bold>6</bold></highlight> in advance. This encryption key ke does not always agree with the encryption key ke(1). </paragraph>
<paragraph id="P-0204" lvl="0"><number>&lsqb;0204&rsqb;</number> A license condition is input to the license condition input section <highlight><bold>4</bold></highlight>. The license condition includes at least one of the expiration date of the accounting object information, the license information write time, the contents ID, the medium ID, and the decoder unit ID. </paragraph>
<paragraph id="P-0205" lvl="0"><number>&lsqb;0205&rsqb;</number> The decoding key kd(1) corresponding to the encryption key ke(1), which is used to decode the encrypted accounting object information, is input to the decoding key input section <highlight><bold>5</bold></highlight>. </paragraph>
<paragraph id="P-0206" lvl="0"><number>&lsqb;0206&rsqb;</number> The license condition and the decoding key kd(1) are input to the encryption section <highlight><bold>7</bold></highlight> respectively through the license condition input section <highlight><bold>4</bold></highlight> and the decoding key input section <highlight><bold>5</bold></highlight>. The license condition and the decoding key kd(1) are merged. </paragraph>
<paragraph id="P-0207" lvl="0"><number>&lsqb;0207&rsqb;</number> After this, the merged license condition and decoding key kd(1) are encrypted using the encryption key ke stored in the key holder section <highlight><bold>6</bold></highlight>. Generally, encryption schema are roughly classified into a public key scheme and a secret key scheme, and either can be employed. The encrypted data is called license information. As the characteristic feature of the encryption section <highlight><bold>7</bold></highlight>, the license condition and the encryption key ke(1) are inseparably combined by merging and encryption. Therefore, an apparatus capable of decoding data encrypted using the encryption key ke, i.e., an apparatus having the decoding key kd corresponding to the encryption key ke can exclusively separate the license condition from the encryption key ke(1). The decoding key kd(1) is a key for decoding the encrypted accounting object information, so the accounting object information and the license condition are inseparably combined. The accounting object information and the license information as data can be always separated. However, without valid license information, the accounting object information cannot be decoded to use the contents. </paragraph>
<paragraph id="P-0208" lvl="0"><number>&lsqb;0208&rsqb;</number> The recording section <highlight><bold>8</bold></highlight> writes the license information in an information storage section <highlight><bold>9</bold></highlight> and then writes the encrypted accounting object information subsequent to the license condition. </paragraph>
<paragraph id="P-0209" lvl="0"><number>&lsqb;0209&rsqb;</number> The information storage section <highlight><bold>9</bold></highlight> may be a recording medium such as a DVD-ROM, a DVD-RAM, or a hard disk. Such a recording medium having information is set in a predetermined reproducing apparatus to reproduce the information. Alternatively, the information may be transferred from the information storage section <highlight><bold>9</bold></highlight> to another recording medium through a network such as the Internet or by broadcasting and reproduced by a predetermined reproducing apparatus. </paragraph>
<paragraph id="P-0210" lvl="0"><number>&lsqb;0210&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a flow chart for explaining the operation of an information recording apparatus <highlight><bold>1</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. First, the encrypted accounting object information ke(1) is input to the accounting object information input section <highlight><bold>2</bold></highlight> (step S<highlight><bold>1</bold></highlight>), the license condition is input to the license condition input section <highlight><bold>4</bold></highlight> (step S<highlight><bold>2</bold></highlight>), and the decoding key kd(1) is input to the decoding key input section <highlight><bold>5</bold></highlight> (step S<highlight><bold>3</bold></highlight>). The encrypted accounting object information is transferred from the accounting object information input section <highlight><bold>2</bold></highlight> to the recording section <highlight><bold>8</bold></highlight> (step S<highlight><bold>4</bold></highlight>), the license condition is transferred from the license condition input section <highlight><bold>4</bold></highlight> to the encryption section <highlight><bold>7</bold></highlight> (step S<highlight><bold>5</bold></highlight>), and the decoding key kd(1) is transferred from the decoding key input section <highlight><bold>5</bold></highlight> to the encryption section <highlight><bold>7</bold></highlight> (step S<highlight><bold>6</bold></highlight>). The encryption key ke held in the key holder section <highlight><bold>6</bold></highlight> in advance is transferred to the encryption section <highlight><bold>7</bold></highlight> (step S<highlight><bold>7</bold></highlight>). The encryption section <highlight><bold>7</bold></highlight> merges the license condition and the decoding key kd(1) and then performs encryption using the encryption key ke to generate license information (step S<highlight><bold>8</bold></highlight>). The generated license information is transferred to the recording section <highlight><bold>8</bold></highlight> (step S<highlight><bold>9</bold></highlight>). The recording section <highlight><bold>8</bold></highlight> merges the encrypted accounting object information and license information and records them on the information storage section <highlight><bold>9</bold></highlight> (step S<highlight><bold>10</bold></highlight>). </paragraph>
<paragraph id="P-0211" lvl="7"><number>&lsqb;0211&rsqb;</number> (1-2) Second Example of Information Recording Apparatus </paragraph>
<paragraph id="P-0212" lvl="0"><number>&lsqb;0212&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> shows the second arrangement of an information recording apparatus according to the present invention. More specifically, <cross-reference target="DRAWINGS">FIG. 3</cross-reference> shows an arrangement of an information recording apparatus which encrypts part of accounting object information as an accounting object such as a digitized work together with a license condition to generate license information and records the remaining portion of the accounting object information and license information in a predetermined recording medium. As in the first arrangement shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, part of accounting object information is encrypted together with a license condition to inseparately combine the accounting object information with the license condition. </paragraph>
<paragraph id="P-0213" lvl="0"><number>&lsqb;0213&rsqb;</number> The information recording apparatus roughly comprises a data separation section <highlight><bold>12</bold></highlight>, a license information generation section <highlight><bold>13</bold></highlight>, and a recording section <highlight><bold>18</bold></highlight>. </paragraph>
<paragraph id="P-0214" lvl="0"><number>&lsqb;0214&rsqb;</number> The data separation section <highlight><bold>12</bold></highlight> divides accounting object information into two parts. <cross-reference target="DRAWINGS">FIGS. 5A, 5B</cross-reference>, <highlight><bold>6</bold></highlight>A, and <highlight><bold>6</bold></highlight>B show examples of data separation by the data separation section. For the descriptive convenience, a still picture will be exemplified, though this method can be used for a motion picture and the like. </paragraph>
<paragraph id="P-0215" lvl="0"><number>&lsqb;0215&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 5</cross-reference>A, part (face regions in <cross-reference target="DRAWINGS">FIG. 5A</cross-reference>) of a still picture may be extracted, and the face regions as shown in <cross-reference target="DRAWINGS">FIG. 5B</cross-reference> may be encrypted as part of license information. In this case, the image can be seen without decoding the license information (i.e., without paying the fee) although the image is partially omitted. As shown in <cross-reference target="DRAWINGS">FIG. 6</cross-reference>A, an image is subjected to Fourier transformation to extract a frequency component. A high-frequency component as shown in <cross-reference target="DRAWINGS">FIG. 6B</cross-reference> may be encrypted as part of license information. In this case, unless the license information cannot be decoded (i.e., unless the fee is paid), no clear image can be obtained by reproducing the image with the frequency component shown in <cross-reference target="DRAWINGS">FIG. 6A</cross-reference>. </paragraph>
<paragraph id="P-0216" lvl="0"><number>&lsqb;0216&rsqb;</number> The license information generation section <highlight><bold>13</bold></highlight> is constituted by a license condition input section <highlight><bold>14</bold></highlight>, an encryption section <highlight><bold>17</bold></highlight>, and a key holder section <highlight><bold>16</bold></highlight>. </paragraph>
<paragraph id="P-0217" lvl="0"><number>&lsqb;0217&rsqb;</number> The key holder section <highlight><bold>16</bold></highlight> stores the encryption key ke in advance. The license condition input section <highlight><bold>14</bold></highlight> receives a license condition. The license condition includes at least one of the expiration date of the accounting object information, the license information write time, the contents ID, the medium ID, and the decoder unit ID. The license condition is input to the encryption section <highlight><bold>17</bold></highlight> through the license condition input section <highlight><bold>14</bold></highlight>. Part of accounting object information, which is obtained by dividing the accounting object information into two parts, is also input from the data separation section <highlight><bold>12</bold></highlight> to the encryption section <highlight><bold>17</bold></highlight>. The license condition and part of the accounting object information are merged and then encrypted using the encryption key ke stored in the key holder section <highlight><bold>16</bold></highlight> to generate license information. </paragraph>
<paragraph id="P-0218" lvl="0"><number>&lsqb;0218&rsqb;</number> The recording section <highlight><bold>18</bold></highlight> writes the license information in an information storage section <highlight><bold>19</bold></highlight> and then writes the remaining part of the accounting object information, which is obtained by dividing the accounting object information into two parts by the data separation section <highlight><bold>12</bold></highlight>, subsequent to the license information. </paragraph>
<paragraph id="P-0219" lvl="0"><number>&lsqb;0219&rsqb;</number> The information storage section <highlight><bold>19</bold></highlight> may be a recording medium such as a DVD-ROM, a DVD-RAM, or a hard disk. Such a recording medium having information is set in a predetermined reproducing apparatus to reproduce the information. Alternatively, the information may be transferred from the information storage section <highlight><bold>19</bold></highlight> to another recording medium through a network such as the Internet or by broadcasting and reproduced by a predetermined reproducing apparatus. </paragraph>
<paragraph id="P-0220" lvl="0"><number>&lsqb;0220&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is a flow chart for explaining the operation of an information recording apparatus <highlight><bold>11</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>. Accounting object information is input to the data separation section <highlight><bold>12</bold></highlight> (step S<highlight><bold>21</bold></highlight>), and the license condition is input to the license condition input section <highlight><bold>14</bold></highlight> (step S<highlight><bold>22</bold></highlight>). The data separation section <highlight><bold>12</bold></highlight> divides the input accounting object information into two parts (step S<highlight><bold>23</bold></highlight>), transfers one part of the accounting object information to the encryption section <highlight><bold>17</bold></highlight> (step S<highlight><bold>24</bold></highlight>), and transfers the remaining part of the accounting object information to the recording section <highlight><bold>18</bold></highlight> (step S<highlight><bold>25</bold></highlight>). The license condition is transferred from the license condition input section <highlight><bold>14</bold></highlight> to the encryption section <highlight><bold>17</bold></highlight> (step S<highlight><bold>26</bold></highlight>). The encryption key ke is transferred from the key holder section <highlight><bold>16</bold></highlight> to the encryption section <highlight><bold>17</bold></highlight> (step S<highlight><bold>27</bold></highlight>). The encryption section <highlight><bold>17</bold></highlight> merges the license condition and the part of the accounting object information transferred from the data separation section <highlight><bold>12</bold></highlight> and then encrypts them to generate license information (step S<highlight><bold>28</bold></highlight>). The generated license information is transferred to the recording section <highlight><bold>18</bold></highlight> (step S<highlight><bold>29</bold></highlight>). The recording section <highlight><bold>18</bold></highlight> merges the part of the accounting object information transferred from the data separation section <highlight><bold>12</bold></highlight> and the license information and records them on the information storage section <highlight><bold>19</bold></highlight> (step S<highlight><bold>30</bold></highlight>). </paragraph>
<paragraph id="P-0221" lvl="7"><number>&lsqb;0221&rsqb;</number> (1-3) Third Example of Information Recording Apparatus </paragraph>
<paragraph id="P-0222" lvl="0"><number>&lsqb;0222&rsqb;</number> As still another example, the entire accounting object information may be encrypted together with a license condition to inseparately combine the accounting object information with the license condition. </paragraph>
<paragraph id="P-0223" lvl="0"><number>&lsqb;0223&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> shows the third arrangement of the information recording apparatus according to the first embodiment of the present invention. The same reference numerals as in <cross-reference target="DRAWINGS">FIG. 3</cross-reference> denote the same parts in <cross-reference target="DRAWINGS">FIG. 7</cross-reference>, and only different parts will be described below. In <cross-reference target="DRAWINGS">FIG. 7</cross-reference>, the data separation section <highlight><bold>12</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is replaced with the accounting object information input section <highlight><bold>2</bold></highlight> so that the accounting object information input to the accounting object information input section <highlight><bold>2</bold></highlight> is directly transferred to the encryption section <highlight><bold>17</bold></highlight>. The encryption section <highlight><bold>17</bold></highlight> merges the entire accounting object information with the license condition and then encrypts them using the encryption key ke. </paragraph>
<paragraph id="P-0224" lvl="0"><number>&lsqb;0224&rsqb;</number> As described above, in the first example of the information recording apparatus, the decoding key kd(1) for decoding the encrypted accounting object information and the license condition are merged and encrypted using the encryption key ke to generate license information. In addition, the encrypted accounting object information and the license information are merged and recorded on the information storage section <highlight><bold>9</bold></highlight>, so the accounting object information and the license condition can be inseparately combined. In this case, only an information reproducing apparatus having the encryption key ke corresponding to the encryption key ke can separate the license condition and the decoding key kd(1) from each other so the encrypted accounting object information can be decoded using the separated decoding key kd(1) and reproduced. </paragraph>
<paragraph id="P-0225" lvl="0"><number>&lsqb;0225&rsqb;</number> In the second example of the information recording apparatus, part of the accounting object information and the license condition are merged and encrypted using the encryption key ke to generate license information. The remaining part of the accounting object information and the license information are merged and stored in the information storage section <highlight><bold>19</bold></highlight>. With this processing, the accounting object information and the license condition can be inseparately combined. In this case, only an information reproducing apparatus having the decoding key kd corresponding to the encryption key ke can decode the part of the accounting object information and the license condition and separate them from each other so the accounting object information can be reproduced from the decoded and separated part of the accounting object information and the remaining part. </paragraph>
<paragraph id="P-0226" lvl="0"><number>&lsqb;0226&rsqb;</number> In the third example of the information recording apparatus, the entire accounting object information and the license condition are merged, encrypted using the encryption key ke, and recorded on the information storage section <highlight><bold>19</bold></highlight>, thereby inseparately combining the accounting object information with the license condition. In this case, only an information reproducing apparatus having the decoding key kd corresponding to the encryption key ke can decode, separate, and reproduce the accounting object information and the license condition. </paragraph>
<paragraph id="P-0227" lvl="0"><number>&lsqb;0227&rsqb;</number> All of these arrangements disable to separate the accounting object information from the license condition without decoding. </paragraph>
<paragraph id="P-0228" lvl="0"><number>&lsqb;0228&rsqb;</number> The information storage section <highlight><bold>9</bold></highlight> or <highlight><bold>19</bold></highlight> may be a recording medium such as a DVD-ROM, a DVD-RAM, or a hard disk. Such a recording medium having information is set in a predetermined reproducing apparatus to reproduce the information. Alternatively, the information may be transferred from the information storage section <highlight><bold>9</bold></highlight> or <highlight><bold>19</bold></highlight> to another recording medium through a network such as the Internet or by broadcasting and reproduced by a predetermined reproducing apparatus. </paragraph>
<paragraph id="P-0229" lvl="7"><number>&lsqb;0229&rsqb;</number> (2) Information Reproducing Apparatus </paragraph>
<paragraph id="P-0230" lvl="7"><number>&lsqb;0230&rsqb;</number> (2-1) First Example of Information Reproducing Apparatus </paragraph>
<paragraph id="P-0231" lvl="0"><number>&lsqb;0231&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> shows the first arrangement of an information reproducing apparatus according to the present invention. More specifically, <cross-reference target="DRAWINGS">FIG. 8</cross-reference> shows an arrangement of an information reproducing apparatus for reproducing information recorded on the information storage section <highlight><bold>9</bold></highlight> or <highlight><bold>19</bold></highlight> in the first information recording apparatus shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>, the second information recording apparatus shown in <cross-reference target="DRAWINGS">FIG. 3</cross-reference>, or the third information recording apparatus shown in <cross-reference target="DRAWINGS">FIG. 7</cross-reference> and distributed to a user by a recording medium or through a network or broadcasting. </paragraph>
<paragraph id="P-0232" lvl="0"><number>&lsqb;0232&rsqb;</number> The unit information recorded on, e.g., the information storage section <highlight><bold>9</bold></highlight> in the first information recording apparatus includes accounting object information encrypted and merged with license information generated by encrypting the decoding key kd(1) for decoding the accounting object information together with the license condition using the encryption key ke. </paragraph>
<paragraph id="P-0233" lvl="0"><number>&lsqb;0233&rsqb;</number> The license condition includes, e.g., the expiration date. The expiration date means an expiration date of accounting object information corresponding to a predetermined fee paid by the user. The license condition may also include the license information recording time. The license information recording time is a time when the license information has been recorded on, e.g., the information storage section <highlight><bold>9</bold></highlight> in the first information recording apparatus shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference> and, more specifically, time information read from, e.g., a clock incorporated in the license condition input section <highlight><bold>4</bold></highlight> in generating the license information by the license information generation section <highlight><bold>3</bold></highlight>. </paragraph>
<paragraph id="P-0234" lvl="0"><number>&lsqb;0234&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 8</cross-reference>, the information reproducing apparatus roughly comprises an information storage section <highlight><bold>101</bold></highlight>, a readout section <highlight><bold>102</bold></highlight>, a decoder unit <highlight><bold>103</bold></highlight>, and a reproduction section <highlight><bold>104</bold></highlight>. </paragraph>
<paragraph id="P-0235" lvl="0"><number>&lsqb;0235&rsqb;</number> The information storage section <highlight><bold>101</bold></highlight> may be a recording medium such as a DVD-ROM, a DVD-RAM, or a hard disk. Alternatively, information recorded on the information storage section <highlight><bold>101</bold></highlight> may be transferred from the information storage section <highlight><bold>9</bold></highlight> or <highlight><bold>19</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 1, 3</cross-reference>, or <highlight><bold>7</bold></highlight> through a network such as the Internet or by broadcasting. </paragraph>
<paragraph id="P-0236" lvl="0"><number>&lsqb;0236&rsqb;</number> The readout section <highlight><bold>102</bold></highlight> reads out one unit of information from the information storage section <highlight><bold>101</bold></highlight>, transfers the license information to the decoder unit <highlight><bold>103</bold></highlight>, and transfers the encrypted accounting object information to the reproduction section <highlight><bold>104</bold></highlight>. </paragraph>
<paragraph id="P-0237" lvl="0"><number>&lsqb;0237&rsqb;</number> The decoder unit <highlight><bold>103</bold></highlight> decodes the license information using the decoding key kd stored in advance and decides on the basis of the obtained license condition whether the decoding key kd(1) for decoding the encrypted accounting object information is to be output to the reproduction section <highlight><bold>104</bold></highlight>, thereby realizing protection by copyright. </paragraph>
<paragraph id="P-0238" lvl="0"><number>&lsqb;0238&rsqb;</number> Since the accounting object information is encrypted using the encryption key ke(1), the accounting object information cannot be reproduced unless the reproduction section <highlight><bold>104</bold></highlight> obtains the decoding key kd(1) corresponding to the encryption key ke(1). The decoding key kd(1) is transferred from the decoder unit <highlight><bold>103</bold></highlight> to the reproduction section <highlight><bold>104</bold></highlight>. When the decoding key kd(1) is to be transferred from the decoder unit <highlight><bold>103</bold></highlight> to the reproduction section <highlight><bold>104</bold></highlight>, the decoding key kd(1) is normally protected. This is because if the decoding key kd(1) is acquired/stored during transfer, reproduction is enabled without intervening the decoder unit <highlight><bold>103</bold></highlight>, and protection by copyright such as license condition check by the decoder unit <highlight><bold>103</bold></highlight> becomes meaningless. A specific example of transfer protection is described in, e.g., &ldquo;News Report, Nikkei Electronics&rdquo;, Nov. 18, 1996 (No. 676), pp. 13-14. </paragraph>
<paragraph id="P-0239" lvl="0"><number>&lsqb;0239&rsqb;</number> The reproduction section <highlight><bold>104</bold></highlight> has a decoder section <highlight><bold>105</bold></highlight>. The decoder section <highlight><bold>105</bold></highlight> decodes the encrypted accounting object information transferred from the readout section <highlight><bold>102</bold></highlight> using the decoding key kd(1) transferred from the decoder unit <highlight><bold>103</bold></highlight>. The reproduction section <highlight><bold>104</bold></highlight> performs predetermined decoding for displaying the accounting object information obtained upon decoding by the decoder section <highlight><bold>105</bold></highlight> and displays the accounting object information on a predetermined display device. </paragraph>
<paragraph id="P-0240" lvl="0"><number>&lsqb;0240&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> shows an arrangement of the decoder unit <highlight><bold>103</bold></highlight>. The decoder unit <highlight><bold>103</bold></highlight> comprises a license information input section <highlight><bold>103</bold></highlight><highlight><italic>a</italic></highlight>, a decoder section <highlight><bold>103</bold></highlight><highlight><italic>b</italic></highlight>, a decoding key holder section <highlight><bold>103</bold></highlight><highlight><italic>c</italic></highlight>, a decision section <highlight><bold>103</bold></highlight><highlight><italic>d</italic></highlight>, a clock reference section <highlight><bold>103</bold></highlight><highlight><italic>e</italic></highlight>, and a clock <highlight><bold>103</bold></highlight><highlight><italic>f. </italic></highlight></paragraph>
<paragraph id="P-0241" lvl="0"><number>&lsqb;0241&rsqb;</number> The license information input section <highlight><bold>103</bold></highlight><highlight><italic>a </italic></highlight>receives license information transferred from the readout section <highlight><bold>102</bold></highlight> and outputs the license information to the decoder section <highlight><bold>103</bold></highlight><highlight><italic>b. </italic></highlight></paragraph>
<paragraph id="P-0242" lvl="0"><number>&lsqb;0242&rsqb;</number> The decoder section <highlight><bold>103</bold></highlight><highlight><italic>b </italic></highlight>decodes the license information using the decoding key kd stored in the decoding key holder section <highlight><bold>103</bold></highlight><highlight><italic>c </italic></highlight>in advance and outputs the obtained license condition, i.e., the expiration date and the decoding key kd(1) to the decision section <highlight><bold>103</bold></highlight><highlight><italic>d. </italic></highlight></paragraph>
<paragraph id="P-0243" lvl="0"><number>&lsqb;0243&rsqb;</number> The clock reference section <highlight><bold>103</bold></highlight><highlight><italic>e </italic></highlight>reads time (clock time) indicated by the clock <highlight><bold>103</bold></highlight><highlight><italic>f. </italic></highlight></paragraph>
<paragraph id="P-0244" lvl="0"><number>&lsqb;0244&rsqb;</number> The decision section <highlight><bold>103</bold></highlight><highlight><italic>d </italic></highlight>compares the clock time (indicating the current time) acquired from the clock reference section <highlight><bold>103</bold></highlight><highlight><italic>e </italic></highlight>with the expiration date. If clock time E expiration date, the decision section <highlight><bold>103</bold></highlight><highlight><italic>d </italic></highlight>decides that the accounting object information can be used (i.e., the decoding key kd(1) can be output) and outputs the decoding key kd(1) to the reproduction section <highlight><bold>104</bold></highlight>. </paragraph>
<paragraph id="P-0245" lvl="0"><number>&lsqb;0245&rsqb;</number> When the license condition also includes license information recording time, check of the expiration date and the license information recording time is also performed. More specifically, when the expiration date is valid, the decision section <highlight><bold>103</bold></highlight><highlight><italic>d </italic></highlight>compares the clock time with the license information recording time. If clock time <highlight><bold>3</bold></highlight> license information recording time holds, the decision section <highlight><bold>103</bold></highlight><highlight><italic>d </italic></highlight>outputs the decoding key kd(1) to the reproduction section <highlight><bold>104</bold></highlight>. This check is performed to only confirm the fact that &ldquo;the license information has been recorded in the past&rdquo;, though it has great significance. The clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>to be referred to by the clock reference section <highlight><bold>103</bold></highlight><highlight><italic>e </italic></highlight>is not always correct. Especially, excessive time delay in the clock is not preferable from the viewpoint of observance of the expiration date. Check of the license information recording time is meaningful in preventing time delay to some extent. Assume that the clock indicates time one month ago. Also, assume that the license information recording time is 12:00 in a certain day, and the expiration date is set at 12:00 one week after the license information recording time. If the license information recording time is not checked, the user can use the accounting object information for one week&plus;one month. By checking the license information recording time, use of the accounting object information can be inhibited even when the clock time is largely delayed. </paragraph>
<paragraph id="P-0246" lvl="0"><number>&lsqb;0246&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a flow chart for explaining the processing operation of the information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>. The readout section <highlight><bold>102</bold></highlight> reads out the unit information, i.e., the encrypted accounting object information and license information recorded on the information storage section <highlight><bold>101</bold></highlight> (step S<highlight><bold>41</bold></highlight>), transfers the license information to the decoder unit <highlight><bold>103</bold></highlight> (step S<highlight><bold>42</bold></highlight>), and transfers the encrypted accounting object information to the reproduction section <highlight><bold>104</bold></highlight> (step S<highlight><bold>43</bold></highlight>). The decoder unit <highlight><bold>103</bold></highlight> decodes the license information using the decoding key kd stored in advance to obtain the license condition (expiration date) and the decoding key kd(1). It is decided on the basis of the license condition (expiration date) whether the accounting object information can be used (step S<highlight><bold>44</bold></highlight>). If the expiration date is valid, and it is decided that the accounting object information can be used (YES in step S<highlight><bold>45</bold></highlight>), the decoder unit <highlight><bold>103</bold></highlight> transfers the decoding key kd(1) to the reproduction section <highlight><bold>104</bold></highlight> (step S<highlight><bold>46</bold></highlight>). If it is decided that use of the accounting object information is disabled, notification representing that the decoding key kd(1) cannot be output is output to the reproduction section <highlight><bold>104</bold></highlight>, and processing is ended. The reproduction section <highlight><bold>104</bold></highlight> decodes the encrypted accounting object information using the decoding key kd(1) and further performs decoding to reproduce the accounting object information (step S<highlight><bold>47</bold></highlight>). </paragraph>
<paragraph id="P-0247" lvl="0"><number>&lsqb;0247&rsqb;</number> The flow of processing operation of the decoder unit <highlight><bold>103</bold></highlight> in steps S<highlight><bold>44</bold></highlight> to S<highlight><bold>46</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 10</cross-reference> will be described in more detail with reference to <cross-reference target="DRAWINGS">FIGS. 8 and 9</cross-reference> and the flow chart shown in <cross-reference target="DRAWINGS">FIG. 11</cross-reference>. The license information input section <highlight><bold>103</bold></highlight><highlight><italic>a </italic></highlight>of the decoder unit <highlight><bold>103</bold></highlight> receives license information transferred from the readout section <highlight><bold>102</bold></highlight> (step S<highlight><bold>51</bold></highlight>) and transfers the license information to the decoder section <highlight><bold>103</bold></highlight><highlight><italic>b </italic></highlight>(step S<highlight><bold>52</bold></highlight>). When the decoding key kd is transferred from the decoding key holder section <highlight><bold>103</bold></highlight><highlight><italic>c </italic></highlight>(step S<highlight><bold>53</bold></highlight>), the decoder section <highlight><bold>103</bold></highlight><highlight><italic>b </italic></highlight>decodes the license information using the decoding key kd (step S<highlight><bold>54</bold></highlight>). Data obtained by decoding the license information is transferred to the decision section <highlight><bold>103</bold></highlight><highlight><italic>d </italic></highlight>(step S<highlight><bold>55</bold></highlight>). When the clock time is transferred from the clock reference section <highlight><bold>103</bold></highlight><highlight><italic>e </italic></highlight>(step S<highlight><bold>56</bold></highlight>), the decision section <highlight><bold>103</bold></highlight><highlight><italic>d </italic></highlight>compares the license condition (expiration date) with the clock time to decide whether the accounting object information can be used (i.e., whether the decoding key kd(1) is to be output to the reproduction section <highlight><bold>104</bold></highlight>) (step S<highlight><bold>57</bold></highlight>). </paragraph>
<paragraph id="P-0248" lvl="0"><number>&lsqb;0248&rsqb;</number> If it is decided that the accounting object information can be used, the decoding key kd(1) is output to the reproduction section <highlight><bold>104</bold></highlight> (steps S<highlight><bold>58</bold></highlight> and S<highlight><bold>59</bold></highlight>). If it is decided that the accounting object information cannot be used, notification representing that the decoding key kd(1) cannot be output is output to the reproduction section <highlight><bold>104</bold></highlight> (steps S<highlight><bold>58</bold></highlight> and S<highlight><bold>60</bold></highlight>). </paragraph>
<paragraph id="P-0249" lvl="7"><number>&lsqb;0249&rsqb;</number> (2-2) Arrangement of Decoder Unit and Clock Incorporated in Decoder Unit </paragraph>
<paragraph id="P-0250" lvl="0"><number>&lsqb;0250&rsqb;</number> When the expiration date for accounting object information is to be used as a license condition, and the expiration date is to be set for the accounting object information, the accuracy of the clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>incorporated in the decoder unit <highlight><bold>103</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference> is important. In that sense, a mechanism for disabling the user from arbitrary setting time is necessary. <cross-reference target="DRAWINGS">FIG. 12</cross-reference> shows a decoder unit with such a mechanism. The same reference numerals as in <cross-reference target="DRAWINGS">FIG. 9</cross-reference> denote the same parts in <cross-reference target="DRAWINGS">FIG. 12</cross-reference>. </paragraph>
<paragraph id="P-0251" lvl="0"><number>&lsqb;0251&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference>, the clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>has a time setting section <highlight><bold>111</bold></highlight>, a time setting disabling section <highlight><bold>112</bold></highlight>, and a time counter <highlight><bold>113</bold></highlight>. The operation of the clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference> will be described with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 13</cross-reference>. When time setting designation information containing set time information is input through the time setting section <highlight><bold>111</bold></highlight> in shipment from a factory (step S<highlight><bold>71</bold></highlight>), the designated set time is set in the time counter <highlight><bold>113</bold></highlight> (steps S<highlight><bold>72</bold></highlight> and S<highlight><bold>73</bold></highlight>). After this, the time setting disabling section <highlight><bold>112</bold></highlight> takes a measure to disable time setting through the time setting section <highlight><bold>111</bold></highlight> (steps S<highlight><bold>74</bold></highlight> and S<highlight><bold>75</bold></highlight>). For example, the time setting disabling section <highlight><bold>112</bold></highlight> flows an overcurrent to a circuit for connecting the time setting section <highlight><bold>111</bold></highlight> and the time counter <highlight><bold>113</bold></highlight> to physically disconnect the time setting section <highlight><bold>111</bold></highlight> and the time counter <highlight><bold>113</bold></highlight>. Upon taking the time setting disabling measure, any time setting becomes impossible. </paragraph>
<paragraph id="P-0252" lvl="0"><number>&lsqb;0252&rsqb;</number> An error evaluation section <highlight><bold>103</bold></highlight><highlight><italic>g </italic></highlight>determines the maximum cumulative error by, e.g., the following method. The error evaluation section holds the &ldquo;maximum time delay&rdquo; and &ldquo;maximum time advance&rdquo; of the clock <highlight><bold>103</bold></highlight><highlight><italic>f</italic></highlight>. The error evaluation section <highlight><bold>103</bold></highlight><highlight><italic>g </italic></highlight>also has a time counter for error evaluation. This time counter adds the maximum delay or maximum advance per hour and transfers the cumulative maximum delay or cumulative maximum advance (these are inclusively called a cumulative error) as a sum value to the decision section <highlight><bold>103</bold></highlight><highlight><italic>d. </italic></highlight></paragraph>
<paragraph id="P-0253" lvl="0"><number>&lsqb;0253&rsqb;</number> The cumulative maximum advance or cumulative maximum delay means the cumulative time of errors generated due to, e.g., the abnormal operation of the clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>itself. Therefore, when the clock time indicated by the clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>is to be compared with the expiration date or license information recording time, this cumulative error must be taken into consideration. </paragraph>
<paragraph id="P-0254" lvl="0"><number>&lsqb;0254&rsqb;</number> In this case, the decision section <highlight><bold>103</bold></highlight><highlight><italic>d </italic></highlight>of the decoder unit <highlight><bold>103</bold></highlight> checks whether the following relationships hold. </paragraph>
<paragraph id="P-0255" lvl="0"><number>&lsqb;0255&rsqb;</number> Clock time E expiration date &plus;cumulative maximum advance </paragraph>
<paragraph lvl="0"><in-line-formula>Clock time <highlight><superscript>3 </superscript></highlight>license information recording (update) time&minus;cumulative maximum delay </in-line-formula></paragraph>
<paragraph id="P-0256" lvl="0"><number>&lsqb;0256&rsqb;</number> If the two relations simultaneously hold, it is decided that the accounting object information can be used. When information recorded on the information storage section <highlight><bold>9</bold></highlight> by the first information recording apparatus is to be reproduced, it is decided that the decoding key kd(1) can be output. When information recorded on the information storage section <highlight><bold>19</bold></highlight> by the second information recording apparatus is to be reproduced, it is decided that part of the accounting object information can be output. </paragraph>
<paragraph id="P-0257" lvl="0"><number>&lsqb;0257&rsqb;</number> The processing operation of the decoder unit shown in <cross-reference target="DRAWINGS">FIG. 12</cross-reference> will be described next with reference to the flow chart in <cross-reference target="DRAWINGS">FIG. 14</cross-reference>. The license information input section <highlight><bold>103</bold></highlight><highlight><italic>a </italic></highlight>of the decoder unit <highlight><bold>103</bold></highlight> receives license information transferred from the readout section <highlight><bold>102</bold></highlight> (step S<highlight><bold>81</bold></highlight>) and transfers the license information to the decoder section <highlight><bold>103</bold></highlight><highlight><italic>b </italic></highlight>(step S<highlight><bold>82</bold></highlight>). When the decoding key kd is transferred from the decoding key holder section <highlight><bold>103</bold></highlight><highlight><italic>c </italic></highlight>(step S<highlight><bold>83</bold></highlight>), the decoder section <highlight><bold>103</bold></highlight><highlight><italic>b </italic></highlight>decodes the license information using the decoding key kd (step S<highlight><bold>84</bold></highlight>). Data obtained upon decoding the license information is transferred to the decision section <highlight><bold>103</bold></highlight><highlight><italic>d </italic></highlight>(step S<highlight><bold>85</bold></highlight>). The clock reference section <highlight><bold>103</bold></highlight><highlight><italic>e </italic></highlight>acquires clock time from the clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>(step S<highlight><bold>86</bold></highlight>) and transfers the acquired clock time to the decision section <highlight><bold>103</bold></highlight><highlight><italic>d </italic></highlight>(step S<highlight><bold>87</bold></highlight>). The decision section <highlight><bold>103</bold></highlight><highlight><italic>d </italic></highlight>acquired the cumulative error from the error evaluation section <highlight><bold>103</bold></highlight><highlight><italic>g </italic></highlight>(step S<highlight><bold>88</bold></highlight>) and compares the license condition (expiration date) with the clock time in consideration of the cumulative error of the clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>to decide whether the accounting object information can be used (i.e., whether the decoding key kd(1) is to be output to the reproduction section <highlight><bold>104</bold></highlight>) (step S<highlight><bold>89</bold></highlight>). If it is decided that the accounting object information can be used, the decoding key kd(1) is output to the reproduction section <highlight><bold>104</bold></highlight> (steps S<highlight><bold>90</bold></highlight> and S<highlight><bold>91</bold></highlight>). If it is decided that the accounting object information cannot be used, notification representing that the decoding key kd(1) cannot be output is output to the reproduction section <highlight><bold>104</bold></highlight> (steps S<highlight><bold>90</bold></highlight> and S<highlight><bold>92</bold></highlight>). </paragraph>
<paragraph id="P-0258" lvl="7"><number>&lsqb;0258&rsqb;</number> (2-3) Time Setting No. 1 for Clock Incorporated in Decoder Unit </paragraph>
<paragraph id="P-0259" lvl="0"><number>&lsqb;0259&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 15</cross-reference> shows another arrangement of the clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>incorporated in the decoder unit <highlight><bold>103</bold></highlight> and, more specifically, an arrangement of the clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>for setting time on the basis of encrypted time setting designation information. </paragraph>
<paragraph id="P-0260" lvl="0"><number>&lsqb;0260&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 15</cross-reference>, the clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>comprises a set time input section <highlight><bold>121</bold></highlight>, a decoder section <highlight><bold>122</bold></highlight>, a command certification section <highlight><bold>123</bold></highlight>, a time setting section <highlight><bold>124</bold></highlight>, and a time counter <highlight><bold>125</bold></highlight>. </paragraph>
<paragraph id="P-0261" lvl="0"><number>&lsqb;0261&rsqb;</number> The operation of the clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>with this arrangement will be described with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 16</cross-reference>. Time setting designation information containing set time information is encrypted in advance. When the encrypted time setting designation information is input to the set time input section <highlight><bold>121</bold></highlight> (step S<highlight><bold>101</bold></highlight>), the set time input section <highlight><bold>121</bold></highlight> transfers the encrypted time setting designation information to the decoder section <highlight><bold>122</bold></highlight> (step S<highlight><bold>102</bold></highlight>). The decoder section <highlight><bold>122</bold></highlight> decodes the encrypted time setting designation information (step S<highlight><bold>103</bold></highlight>) and transfers the decoded time setting designation information to the command certification section <highlight><bold>123</bold></highlight> (step S<highlight><bold>104</bold></highlight>). The command certification section <highlight><bold>123</bold></highlight> confirms the command format of the time setting designation information (step S<highlight><bold>105</bold></highlight>). If the format is correct (YES in step S<highlight><bold>106</bold></highlight>), set time information contained in the time setting designation information is transferred to the time setting section <highlight><bold>124</bold></highlight> (step S<highlight><bold>107</bold></highlight>). The time setting section <highlight><bold>124</bold></highlight> sets time of the time counter <highlight><bold>125</bold></highlight> in accordance with the set time information (step S<highlight><bold>108</bold></highlight>). </paragraph>
<paragraph id="P-0262" lvl="0"><number>&lsqb;0262&rsqb;</number> When the clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>has the arrangement shown in <cross-reference target="DRAWINGS">FIG. 15</cross-reference>, the time setting designation information to be input to the clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>must always be encrypted using a predetermined encryption key. For this reason, an apparatus which cannot perform encryption (i.e., an apparatus having no encryption key) cannot be used to set time. Therefore, the user cannot easily set time of the clock <highlight><bold>103</bold></highlight><highlight><italic>f</italic></highlight>, either. </paragraph>
<paragraph id="P-0263" lvl="7"><number>&lsqb;0263&rsqb;</number> (2-4) Time Setting No. 2 for Clock Incorporated in Decoder Unit </paragraph>
<paragraph id="P-0264" lvl="0"><number>&lsqb;0264&rsqb;</number> Time setting for the clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>incorporated in the decoder unit <highlight><bold>103</bold></highlight> through a network will be described next. </paragraph>
<paragraph id="P-0265" lvl="0"><number>&lsqb;0265&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 17</cross-reference> is a view showing the concept of network time setting. A time setting client includes a clock to be subjected to time setting, i.e., the clock <highlight><bold>103</bold></highlight><highlight><italic>f </italic></highlight>incorporated in the decoder unit <highlight><bold>103</bold></highlight> of the first information reproducing apparatus as shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>. The time indicated by this clock will be called a client time. A time setting server also incorporates a clock, and the time indicated by this clock will be called a server time. In this form, the time setting server sets time for the clock incorporated in the time setting client through a network. </paragraph>
<paragraph id="P-0266" lvl="0"><number>&lsqb;0266&rsqb;</number> Relatively complex processing is required to set time for the clock incorporated in the decoder unit. The reason for this is as follows. The advance in a clock <highlight><bold>201</bold></highlight> of the client must be checked. An operation of confirming that one minute of client time is almost equivalent to one minute of server time must be performed. This confirmation is made by i) designating certification information transmission time from the server, and ii) designating certification information arrival time (setting time out). The certification information is transmitted from the client to the server to prevent false declaration. This is because the server measures the advance in client time using the certification information arrival time. In addition, it must be guaranteed that the time setting command transmitted from the server is input to the clock <highlight><bold>201</bold></highlight> immediately after it has arrived at the client. To guarantee such quick input, time-out (time setting designation receiving time) is set for the clock <highlight><bold>201</bold></highlight> of the client. </paragraph>
<paragraph id="P-0267" lvl="0"><number>&lsqb;0267&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 18</cross-reference> shows an arrangement of the time setting client. As shown in <cross-reference target="DRAWINGS">FIG. 18</cross-reference>, the time setting client is constituted by a network communication section <highlight><bold>202</bold></highlight>, a client certification key storage section <highlight><bold>203</bold></highlight>, and an encryption section <highlight><bold>204</bold></highlight>. </paragraph>
<paragraph id="P-0268" lvl="0"><number>&lsqb;0268&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 19</cross-reference> shows an arrangement of the time setting server. </paragraph>
<paragraph id="P-0269" lvl="0"><number>&lsqb;0269&rsqb;</number> An operation of setting time for the clock <highlight><bold>201</bold></highlight> of the time setting client from the time setting server through a network will be described next with reference to FIGS. <highlight><bold>20</bold></highlight> to <highlight><bold>22</bold></highlight> showing flow charts of the operations of the time setting client and time setting server, <cross-reference target="DRAWINGS">FIG. 23</cross-reference> showing a block diagram of an arrangement of the clock <highlight><bold>201</bold></highlight> of the time setting client, and <cross-reference target="DRAWINGS">FIGS. 24 and 25</cross-reference> showing flow charts of the operation of the clock <highlight><bold>201</bold></highlight>. </paragraph>
<paragraph id="P-0270" lvl="0"><number>&lsqb;0270&rsqb;</number> First, the time setting client sends current client time t1 indicated by the clock <highlight><bold>201</bold></highlight> to the time setting server through the network communication section <highlight><bold>202</bold></highlight> (steps S<highlight><bold>111</bold></highlight> and S<highlight><bold>112</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 20</cross-reference>). More specifically, as shown in <cross-reference target="DRAWINGS">FIG. 23, a</cross-reference> time readout section <highlight><bold>302</bold></highlight> reads out the current client time t1 from a time counter <highlight><bold>301</bold></highlight> (S<highlight><bold>161</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>) and outputs the current client time t1 to the network communication section <highlight><bold>202</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 18</cross-reference> (step S<highlight><bold>162</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>). </paragraph>
<paragraph id="P-0271" lvl="0"><number>&lsqb;0271&rsqb;</number> The time setting server receives the client time t1 through a network connection section <highlight><bold>211</bold></highlight> (step S<highlight><bold>131</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 21</cross-reference>) and transfers the client time t1 to a time designation section <highlight><bold>212</bold></highlight> (step S<highlight><bold>132</bold></highlight>). The time designation section <highlight><bold>212</bold></highlight> notifies an arrival time period setting section <highlight><bold>213</bold></highlight> of arrival of the time t1 from the client (step S<highlight><bold>133</bold></highlight>), adds a predetermined numerical value to the client time t1 to determine certification information transmission time (client time) t2 (step S<highlight><bold>134</bold></highlight>), and transfers the certification information transmission time t2 to the time setting client through the network connection section <highlight><bold>211</bold></highlight> (step S<highlight><bold>135</bold></highlight>). The certification information transmission time t2 is stored in a designation time storage section <highlight><bold>218</bold></highlight> (step S<highlight><bold>136</bold></highlight>). Upon receiving the time arrival notification, the arrival time period setting section <highlight><bold>213</bold></highlight> acquires arrival time (server time) T<highlight><subscript>1 </subscript></highlight>of the time t1 from the client (step S<highlight><bold>137</bold></highlight>), adds a predetermined numerical value to the arrival time T1 to determine certification information arrival time (server time) T2 (step S<highlight><bold>138</bold></highlight>), and stores the time T2 in an arrival time period storage section <highlight><bold>215</bold></highlight> (step S<highlight><bold>139</bold></highlight>). </paragraph>
<paragraph id="P-0272" lvl="0"><number>&lsqb;0272&rsqb;</number> Upon receiving the certification information transmission time t2 through the network communication section <highlight><bold>202</bold></highlight> (step S<highlight><bold>113</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 20</cross-reference>), the time setting client transfers it to the clock <highlight><bold>201</bold></highlight> (step S<highlight><bold>114</bold></highlight>) and waits until the client time t2. At the client time t2, the clock <highlight><bold>201</bold></highlight> reads out the certification information and outputs it to the encryption section <highlight><bold>204</bold></highlight>. At this time, the certification information may be time &ldquo;t2&Prime; (step S<highlight><bold>115</bold></highlight>). More specifically, as shown in <cross-reference target="DRAWINGS">FIG. 23</cross-reference>, the clock <highlight><bold>201</bold></highlight> receives the certification information transmission time t2 and stores it in a designation time storage section <highlight><bold>303</bold></highlight> (step S<highlight><bold>163</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>). A time comparison section <highlight><bold>304</bold></highlight> reads out the certification information transmission time t2 stored in the designation time storage section <highlight><bold>303</bold></highlight> and compares the certification information transmission time t2 with a client time t indicated by the time counter <highlight><bold>301</bold></highlight> while occasionally referring to the client time t. When the certification information transmission time t2 coincides with the client time t, the time readout section <highlight><bold>302</bold></highlight> is designated to read out the client time (steps S<highlight><bold>164</bold></highlight> to S<highlight><bold>168</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>). Upon receiving this designation, the time readout section <highlight><bold>302</bold></highlight> reads out the client time (in this case, the time t2) indicated by the time counter <highlight><bold>301</bold></highlight> and outputs the readout time to the encryption section <highlight><bold>204</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 18</cross-reference> (step S<highlight><bold>169</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>). The clock <highlight><bold>201</bold></highlight> of the time setting client adds a predetermined numerical value to the time t2 to determine time setting designation receiving time (client time) t3 and stores the time t3 in a time setting designation receiving time storage section <highlight><bold>309</bold></highlight> (step S<highlight><bold>170</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>). </paragraph>
<paragraph id="P-0273" lvl="0"><number>&lsqb;0273&rsqb;</number> When an encryption key k&prime;s is transferred from the client certification key storage section <highlight><bold>203</bold></highlight> (step S<highlight><bold>116</bold></highlight>), the encryption section <highlight><bold>204</bold></highlight> of the time setting client encrypts the time &ldquo;t2&rdquo; as certification information using the encryption key k&prime;s (step S<highlight><bold>117</bold></highlight>) and transfers the encrypted certification information (&lsqb;t2&rsqb; k&prime;s) to the time setting server through the network communication section <highlight><bold>202</bold></highlight> (steps S<highlight><bold>118</bold></highlight> and S<highlight><bold>119</bold></highlight>). In the time setting server, a decoding key k&prime;p corresponding to the encryption key k&prime;s is held in a server certification key storage section <highlight><bold>219</bold></highlight>. </paragraph>
<paragraph id="P-0274" lvl="0"><number>&lsqb;0274&rsqb;</number> Upon receiving the encrypted certification information from the time setting client through the network connection section <highlight><bold>211</bold></highlight> (step S<highlight><bold>140</bold></highlight>), the time setting server transfers the certification information to an arrival time period verification section <highlight><bold>216</bold></highlight> (step S<highlight><bold>141</bold></highlight>). The arrival time period verification section <highlight><bold>216</bold></highlight> extracts the certification information arrival time T2 which has been stored in the arrival time period storage section <highlight><bold>215</bold></highlight> and reads out, from a clock <highlight><bold>214</bold></highlight>, time T (server time) at which the encrypted certification information is received (steps S<highlight><bold>142</bold></highlight> to S<highlight><bold>144</bold></highlight>). The certification information receiving time T is compared with the certification information arrival time T2. If T&gt;T2, it is decided that the delay time is too long, and processing is ended (step S<highlight><bold>145</bold></highlight>). If T&pound;T2, the encrypted certification information is transferred to a decoder section <highlight><bold>217</bold></highlight> (step S<highlight><bold>146</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 22</cross-reference>) and decoded using the decoding key k&prime;p stored in the server certification key storage section <highlight><bold>219</bold></highlight> (steps S<highlight><bold>147</bold></highlight> and S<highlight><bold>148</bold></highlight>). The decoded certification information is transferred to a designation time confirmation section <highlight><bold>220</bold></highlight> (step S<highlight><bold>149</bold></highlight>). The certification information transmission time t2 which has been stored in the designation time storage section <highlight><bold>218</bold></highlight> is also transferred to the designation time confirmation section <highlight><bold>220</bold></highlight>. By comparing these times, the clock of the time setting client is certified (steps S<highlight><bold>150</bold></highlight> to S<highlight><bold>152</bold></highlight>). In this case, the time &ldquo;t2&rdquo; is confirmed. If certification of the clock of the time setting client fails, processing is ended. If certification of the clock of the time setting client is successful, the designation time confirmation section <highlight><bold>220</bold></highlight> transmits a time setting designation to a time setting designation generation section <highlight><bold>221</bold></highlight>.(step S<highlight><bold>153</bold></highlight>). Upon receiving this designation, the time setting designation generation section <highlight><bold>221</bold></highlight> reads out the server time at that time point from the clock <highlight><bold>214</bold></highlight> and generates a time setting command containing the server time. The time setting command is encrypted using an encryption key k&prime;t. The clock of the time setting client holds a decoding key k&prime;q corresponding to the encryption key k&prime;t (steps S<highlight><bold>154</bold></highlight> and S<highlight><bold>155</bold></highlight>). The encrypted time setting command is transmitted to the time setting client through the network connection section <highlight><bold>211</bold></highlight> (steps S<highlight><bold>156</bold></highlight> and S<highlight><bold>157</bold></highlight>). </paragraph>
<paragraph id="P-0275" lvl="0"><number>&lsqb;0275&rsqb;</number> Upon receiving the encrypted license server through the network communication section <highlight><bold>202</bold></highlight>, the time setting client inputs the time setting command to the clock <highlight><bold>201</bold></highlight> (steps S<highlight><bold>120</bold></highlight> and S<highlight><bold>121</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 20</cross-reference>). </paragraph>
<paragraph id="P-0276" lvl="0"><number>&lsqb;0276&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 23</cross-reference>, when the encrypted time setting command is received by a set time input section <highlight><bold>305</bold></highlight>, the clock <highlight><bold>201</bold></highlight> notifies a time setting designation input time reference section <highlight><bold>310</bold></highlight> of it (steps S<highlight><bold>171</bold></highlight> and S<highlight><bold>172</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>). Upon receiving this notification, the time setting designation input time reference section <highlight><bold>310</bold></highlight> acquires the client time t from the time counter <highlight><bold>301</bold></highlight> and outputs the client time t to a time comparison section <highlight><bold>311</bold></highlight> (steps S<highlight><bold>173</bold></highlight> and S<highlight><bold>174</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>). The time comparison section <highlight><bold>311</bold></highlight> reads out the time setting designation receiving time t3 which has been stored in the time setting designation receiving time storage section <highlight><bold>309</bold></highlight> and compares the time t3 with the client time t. At this time, the time comparison section <highlight><bold>311</bold></highlight> may do comparison/decision using allowable delay time At stored in an allowable delay time storage section <highlight><bold>312</bold></highlight> in advance (steps S<highlight><bold>175</bold></highlight> to S<highlight><bold>177</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>). If t&gt;t3 &plus;&Dgr;t, it is decided that the delay time is too long, and processing is ended (step S<highlight><bold>178</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>). If t&pound;t3, the time comparison section <highlight><bold>311</bold></highlight> notifies the set time input section <highlight><bold>305</bold></highlight> of a time setting allowance (steps S<highlight><bold>178</bold></highlight> and S<highlight><bold>179</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 24</cross-reference>). In response to this notification, the clock <highlight><bold>201</bold></highlight> of the time setting client performs the time setting operation on the basis of the time setting designation (command) transmitted from the time setting server. </paragraph>
<paragraph id="P-0277" lvl="0"><number>&lsqb;0277&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 23</cross-reference>, upon receiving the time setting allowance notification, the set time input section <highlight><bold>305</bold></highlight> of the clock <highlight><bold>201</bold></highlight> of the time setting client transfers the encrypted time setting designation to a decoder section <highlight><bold>306</bold></highlight> (step S<highlight><bold>180</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 25</cross-reference>). The decoder section <highlight><bold>306</bold></highlight> decodes the encrypted time setting designation using the decoding key k&prime;q and transfers the decoded time setting designation to a command verification section <highlight><bold>307</bold></highlight> (steps S<highlight><bold>181</bold></highlight> and S<highlight><bold>182</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 25</cross-reference>). The command verification section <highlight><bold>307</bold></highlight> confirms the command format of the time setting designation. If the command format is correct, the server time in the time setting designation is transferred to a time setting section <highlight><bold>308</bold></highlight> (step S<highlight><bold>183</bold></highlight> to S<highlight><bold>185</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 25</cross-reference>). The time setting section <highlight><bold>308</bold></highlight> sets the client time indicated by the time counter in accordance with the server time received from the command verification section <highlight><bold>307</bold></highlight> (step S<highlight><bold>186</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 25</cross-reference>). </paragraph>
<paragraph id="P-0278" lvl="7"><number>&lsqb;0278&rsqb;</number> (2-5) Second Example of information Reproducing Apparatus (the License Condition Includes an Accounting Object Information ID) </paragraph>
<paragraph id="P-0279" lvl="0"><number>&lsqb;0279&rsqb;</number> Accounting object information has an accounting object information ID for identifying the accounting object information. The license condition includes at least the expiration date and the accounting object information ID. A case wherein license information which has been stored in the information storage section of an information reproducing apparatus is updated through a network under this condition will be described. </paragraph>
<paragraph id="P-0280" lvl="0"><number>&lsqb;0280&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 26</cross-reference> shows the arrangement of the second information reproducing apparatus and the entire arrangement of a system for updating license information. The second information reproducing apparatus comprises an information storage section <highlight><bold>401</bold></highlight>, a decoder unit <highlight><bold>402</bold></highlight>, a license information update client section <highlight><bold>403</bold></highlight>, a reproduction section <highlight><bold>404</bold></highlight>, a network connection section <highlight><bold>405</bold></highlight>, and an electronic banking section <highlight><bold>406</bold></highlight>. </paragraph>
<paragraph id="P-0281" lvl="0"><number>&lsqb;0281&rsqb;</number> The information storage section <highlight><bold>401</bold></highlight> in the information reproducing apparatus is the same as the information storage section <highlight><bold>101</bold></highlight> in the first information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>. Of the unit information read out by an information readout section (not shown in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>), license information is sent to the decoder unit <highlight><bold>402</bold></highlight>. </paragraph>
<paragraph id="P-0282" lvl="0"><number>&lsqb;0282&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 27</cross-reference> shows an arrangement of the decoder unit <highlight><bold>402</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>. The same reference numerals as in <cross-reference target="DRAWINGS">FIG. 9</cross-reference> denote the same parts in <cross-reference target="DRAWINGS">FIG. 27</cross-reference>. The arrangement shown in <cross-reference target="DRAWINGS">FIG. 27</cross-reference> is different from that shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference> in that an accounting object information ID output section <highlight><bold>103</bold></highlight><highlight><italic>g </italic></highlight>for outputting the accounting object information ID included in the license condition is added. </paragraph>
<paragraph id="P-0283" lvl="0"><number>&lsqb;0283&rsqb;</number> The operation of the decoder unit shown in <cross-reference target="DRAWINGS">FIG. 27</cross-reference> will be described next with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 28</cross-reference>. The license information is input to the license information input section <highlight><bold>103</bold></highlight><highlight><italic>a </italic></highlight>of the decoder unit <highlight><bold>402</bold></highlight> and sent to the decoder section <highlight><bold>103</bold></highlight><highlight><italic>b </italic></highlight>(steps S<highlight><bold>201</bold></highlight> and S<highlight><bold>202</bold></highlight>). The decoder section <highlight><bold>103</bold></highlight><highlight><italic>b </italic></highlight>decodes the license information using the decoding key kd held in the decoding key holder section <highlight><bold>103</bold></highlight><highlight><italic>c </italic></highlight>and transfers the decoded license information to the decision section <highlight><bold>103</bold></highlight><highlight><italic>d </italic></highlight>(steps S<highlight><bold>203</bold></highlight> to S<highlight><bold>205</bold></highlight>). When clock time is transferred from the clock reference section <highlight><bold>103</bold></highlight><highlight><italic>e </italic></highlight>(step S<highlight><bold>206</bold></highlight>), the decision section <highlight><bold>103</bold></highlight><highlight><italic>d </italic></highlight>compares the license condition (expiration date) with the clock time to decide whether the accounting object information can be used (i.e., whether the decoding key kd(1) is to be output to the reproduction section <highlight><bold>404</bold></highlight>). If it is decided that the accounting object information can be used, the decoding key kd(1) is output to the reproduction section <highlight><bold>404</bold></highlight> (steps S<highlight><bold>206</bold></highlight> to S<highlight><bold>209</bold></highlight>). The above operation is the same as that of the decoder unit shown in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>. On the other hand, if the decision section <highlight><bold>103</bold></highlight><highlight><italic>d </italic></highlight>decides that the accounting object information cannot be used, the accounting object information ID contained in the license condition is transferred to the accounting object information ID output section <highlight><bold>103</bold></highlight><highlight><italic>g</italic></highlight>, and simultaneously, notification representing that the decoding key kd(1) cannot be output is output to the reproduction section <highlight><bold>404</bold></highlight> (steps S<highlight><bold>210</bold></highlight> and S<highlight><bold>211</bold></highlight>). The accounting object information ID output section <highlight><bold>103</bold></highlight><highlight><italic>g </italic></highlight>outputs the accounting object information ID to the license information update client section <highlight><bold>403</bold></highlight> (step S<highlight><bold>212</bold></highlight>). </paragraph>
<paragraph id="P-0284" lvl="0"><number>&lsqb;0284&rsqb;</number> The arrangement and operation of the license information update client section <highlight><bold>403</bold></highlight> will be described next mainly with reference to <cross-reference target="DRAWINGS">FIGS. 29 and 30</cross-reference>. The accounting object information ID sent from the decoder unit <highlight><bold>402</bold></highlight> is input to a license information input section <highlight><bold>403</bold></highlight><highlight><italic>a </italic></highlight>(step S<highlight><bold>221</bold></highlight>). At this time, license information other than the accounting object information ID may be input to the license information input section <highlight><bold>403</bold></highlight><highlight><italic>a</italic></highlight>. License information containing at least the accounting object information ID is input to the license information input section <highlight><bold>403</bold></highlight><highlight><italic>a</italic></highlight>. The license information input to the license information input section <highlight><bold>403</bold></highlight><highlight><italic>a </italic></highlight>is output to the network connection section <highlight><bold>405</bold></highlight> through a license information transfer section <highlight><bold>403</bold></highlight><highlight><italic>b </italic></highlight>and then transmitted to a license information update server <highlight><bold>407</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 26</cross-reference> (steps S<highlight><bold>222</bold></highlight> and S<highlight><bold>223</bold></highlight>). The license information transfer section <highlight><bold>403</bold></highlight><highlight><italic>b </italic></highlight>may encrypt the license information and output it to the network connection section <highlight><bold>405</bold></highlight>. </paragraph>
<paragraph id="P-0285" lvl="0"><number>&lsqb;0285&rsqb;</number> When an encrypted fee claim (including a field ID) is transmitted from the license information update server <highlight><bold>407</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 26</cross-reference> in correspondence with the accounting object information ID, the second information reproducing apparatus receives the encrypted fee claim through the network connection section <highlight><bold>405</bold></highlight> and transfers the fee claim to a fee claiming input section <highlight><bold>403</bold></highlight><highlight><italic>c </italic></highlight>of the license information update client section <highlight><bold>403</bold></highlight> (step S<highlight><bold>224</bold></highlight>). The encrypted fee claim is also transferred to a decoder section <highlight><bold>403</bold></highlight><highlight><italic>d </italic></highlight>(step S<highlight><bold>225</bold></highlight>). The decoder section <highlight><bold>403</bold></highlight><highlight><italic>d </italic></highlight>decodes the encrypted fee claim and transfers it to a payment confirmation section <highlight><bold>403</bold></highlight><highlight><italic>e </italic></highlight>(steps S<highlight><bold>226</bold></highlight> and S<highlight><bold>227</bold></highlight>). The payment confirmation section <highlight><bold>403</bold></highlight><highlight><italic>e </italic></highlight>displays the contents of the fee claim on, e.g., a predetermined display device and confirms the user&apos;s will about fee payment for use of the accounting object information (step S<highlight><bold>228</bold></highlight>). </paragraph>
<paragraph id="P-0286" lvl="0"><number>&lsqb;0286&rsqb;</number> If the user designates to pay the fee through a predetermined input device, a payment designation section <highlight><bold>403</bold></highlight><highlight><italic>f </italic></highlight>is requested to issue a payment designation (steps S<highlight><bold>229</bold></highlight> and S<highlight><bold>230</bold></highlight>). The payment designation generated by the payment designation section <highlight><bold>403</bold></highlight><highlight><italic>f </italic></highlight>is transmitted to a server <highlight><bold>408</bold></highlight> of an electronic banking agency through the electronic banking section <highlight><bold>406</bold></highlight> and then a predetermined network (step S<highlight><bold>231</bold></highlight>). </paragraph>
<paragraph id="P-0287" lvl="0"><number>&lsqb;0287&rsqb;</number> When account payment is confirmed by the server <highlight><bold>408</bold></highlight> of the electronic banking agency, the license information update server <highlight><bold>407</bold></highlight> is notified of it. Upon receiving this notification, the license information update server <highlight><bold>407</bold></highlight> generates new license information by postponing the expiration date, encrypts the new license information, and transmits it to the second information reproducing apparatus. Upon receiving the updated license information through the network connection section <highlight><bold>405</bold></highlight> of the second information reproducing apparatus, the license information is input to a license information input section <highlight><bold>403</bold></highlight><highlight><italic>g </italic></highlight>in the license information update client section <highlight><bold>403</bold></highlight> and then transferred to a license information update section <highlight><bold>403</bold></highlight><highlight><italic>h </italic></highlight>(steps S<highlight><bold>232</bold></highlight> and S<highlight><bold>233</bold></highlight>). The license information update section <highlight><bold>403</bold></highlight><highlight><italic>h </italic></highlight>overwrites the received license information on the license information of the accounting object information, which has already been recorded on the information storage section <highlight><bold>401</bold></highlight>, thereby updating the license information (step S<highlight><bold>234</bold></highlight>). </paragraph>
<paragraph id="P-0288" lvl="0"><number>&lsqb;0288&rsqb;</number> The arrangement and operation of the license information update server <highlight><bold>407</bold></highlight> will be described next with reference to <cross-reference target="DRAWINGS">FIGS. 31 and 32</cross-reference>. The license information transmitted from the second information reproducing apparatus in step S<highlight><bold>223</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 30</cross-reference> is received by a network connection section <highlight><bold>407</bold></highlight><highlight><italic>a </italic></highlight>in the license information update server <highlight><bold>407</bold></highlight> and transferred to a license information update unit <highlight><bold>407</bold></highlight><highlight><italic>b </italic></highlight>(steps S<highlight><bold>241</bold></highlight> and S<highlight><bold>242</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 32</cross-reference>). The license information is decoded, as needed, and the decoded license information is registered in a license information database <highlight><bold>407</bold></highlight><highlight><italic>c </italic></highlight>(step S<highlight><bold>243</bold></highlight>). At this time, the license information database <highlight><bold>407</bold></highlight><highlight><italic>c </italic></highlight>adds a field ID to the license information to manage the license information update history. The license information update unit <highlight><bold>407</bold></highlight><highlight><italic>b </italic></highlight>is also notified of this field ID. An accounting database retrieval section <highlight><bold>407</bold></highlight><highlight><italic>d </italic></highlight>searches an accounting database <highlight><bold>407</bold></highlight><highlight><italic>e </italic></highlight>on the basis of the accounting object information ID contained in the license information to generate a fee claim (steps S<highlight><bold>244</bold></highlight> to S<highlight><bold>246</bold></highlight>). </paragraph>
<paragraph id="P-0289" lvl="0"><number>&lsqb;0289&rsqb;</number> As the contents of the fee claim, the accounting object information ID, the fee to be paid for use of the accounting object information (fee corresponding to the expiration date), a fee payment destination, and the like are described, as shown in <cross-reference target="DRAWINGS">FIG. 33</cross-reference>. </paragraph>
<paragraph id="P-0290" lvl="0"><number>&lsqb;0290&rsqb;</number> The generated fee claim is transferred to an encryption section <highlight><bold>407</bold></highlight><highlight><italic>f </italic></highlight>together with the field ID, encrypted, transferred to the network connection section <highlight><bold>407</bold></highlight><highlight><italic>a</italic></highlight>, and then transmitted to the second information reproducing apparatus through the network (steps S<highlight><bold>247</bold></highlight> to S<highlight><bold>250</bold></highlight>). The encrypted fee claim and field ID are received by the second information reproducing apparatus and subjected to processing from step S<highlight><bold>224</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 30</cross-reference>. </paragraph>
<paragraph id="P-0291" lvl="0"><number>&lsqb;0291&rsqb;</number> In the second information reproducing apparatus, payment for use of the accounting object information is performed by issuing a payment designation in step S<highlight><bold>231</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 30</cross-reference>. When the fee claim presented for the user has contents as shown in <cross-reference target="DRAWINGS">FIG. 33</cross-reference>, the contents of the payment designation are described as, e.g., &ldquo;10 yen/week for &ldquo;ABCD&rdquo; to abc, reference number: field ID&rdquo;, and payment is performed through the electronic banking section <highlight><bold>406</bold></highlight>. The reference number is the field ID added to the license information. The server <highlight><bold>408</bold></highlight> of the electronic banking agency which has received the payment designation performs payment processing and then sends a payment confirmation to the license information update server <highlight><bold>407</bold></highlight> together with a specification &ldquo;10 yen/week for &ldquo;ABCD&rdquo; from A to abc, reference number: field ID&rdquo;. In this case, A is the user ID. </paragraph>
<paragraph id="P-0292" lvl="0"><number>&lsqb;0292&rsqb;</number> When the license information update server <highlight><bold>407</bold></highlight> receives the payment confirmation through a network connection section <highlight><bold>407</bold></highlight><highlight><italic>g</italic></highlight>, the license information update unit <highlight><bold>407</bold></highlight><highlight><italic>b </italic></highlight>searches the license information database <highlight><bold>407</bold></highlight><highlight><italic>c </italic></highlight>for license information to be updated, on the basis of the reference number, i.e., the field ID (steps S<highlight><bold>251</bold></highlight> to S<highlight><bold>253</bold></highlight>). The license information update unit <highlight><bold>407</bold></highlight><highlight><italic>b </italic></highlight>updates the license condition in the license information with reference to the payment confirmation, encrypts the license information (step S<highlight><bold>254</bold></highlight>), and transmits the encrypted license information to the second information reproducing apparatus through the network connection section <highlight><bold>407</bold></highlight><highlight><italic>a </italic></highlight>(steps S<highlight><bold>255</bold></highlight> and S<highlight><bold>256</bold></highlight>). </paragraph>
<paragraph id="P-0293" lvl="0"><number>&lsqb;0293&rsqb;</number> The fee claim to be transmitted from the license information update server to the second information reproducing apparatus is encrypted due to the following reason. The communication path used to transmit the fee claim is a public line such as the Internet, and generally, security therefor is not guaranteed. For this reason, the fee claim may be changed, and the user may pay the fee for a wrong destination. The fee claim is encrypted to prevent this. </paragraph>
<paragraph id="P-0294" lvl="0"><number>&lsqb;0294&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 34</cross-reference> is a flow chart for explaining the operation of the entire system including the second information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>. The reference numerals (steps S<highlight><bold>261</bold></highlight> to S<highlight><bold>286</bold></highlight>) in <cross-reference target="DRAWINGS">FIG. 34</cross-reference> correspond to those in <cross-reference target="DRAWINGS">FIG. 26</cross-reference>, and a detailed description thereof will be omitted. </paragraph>
<paragraph id="P-0295" lvl="7"><number>&lsqb;0295&rsqb;</number> (3) License Information Update Unit </paragraph>
<paragraph id="P-0296" lvl="0"><number>&lsqb;0296&rsqb;</number> A license information update unit will be described next. The license information update unit mainly updates the license condition in license information. For example, the license information update unit can be used as an independent unit to update license information recorded on the information storage section by the first information recording apparatus together with accounting object information. To update the license information, the license information update unit must cancel (decode) encryption of the license information, input a desired license condition which has been newly input, confirm whether payment for the license condition has been done, and then, encrypt the license information, and output it as updated license information. </paragraph>
<paragraph id="P-0297" lvl="0"><number>&lsqb;0297&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 35</cross-reference> shows an arrangement of the license information update unit. The arrangement and operation of the license information update unit shown in <cross-reference target="DRAWINGS">FIG. 35</cross-reference> will be described below with reference to the flow charts shown in <cross-reference target="DRAWINGS">FIGS. 36 and 37</cross-reference>. </paragraph>
<paragraph id="P-0298" lvl="0"><number>&lsqb;0298&rsqb;</number> In license information update processing, first, license information is input to a license information input section <highlight><bold>501</bold></highlight>, and a desired license condition is input to a desired license condition input section <highlight><bold>506</bold></highlight> (step S<highlight><bold>301</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 36</cross-reference> and step S<highlight><bold>308</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 37</cross-reference>). In this case, the license information is constituted by the license condition and the decoding key kd(1) of the encrypted accounting object information, which have been described with reference to the first information recording apparatus. The desired license condition means the license condition of a user&apos;s choice and is input from the user side through an appropriate interface. </paragraph>
<paragraph id="P-0299" lvl="0"><number>&lsqb;0299&rsqb;</number> The license information input to the license information input section <highlight><bold>501</bold></highlight> is decoded by a license information decoder section <highlight><bold>502</bold></highlight> using the decoding key held in a decoding key holder section <highlight><bold>503</bold></highlight> (step S<highlight><bold>302</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 36</cross-reference>) to separate the license condition and the accounting information decoding key from each other such that the license information (especially the license condition) can be updated, and simultaneously, information necessary for charging, such as an accounting object information ID, is sent to a fee claiming output section <highlight><bold>507</bold></highlight> (step S<highlight><bold>303</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 36</cross-reference> and step S<highlight><bold>310</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 37</cross-reference>). The license information which can be updated is rewritten by a license information update section <highlight><bold>505</bold></highlight> to the license condition input by the desired license condition input section <highlight><bold>506</bold></highlight> (step S<highlight><bold>304</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 36</cross-reference>). To charge for the desired license condition, the desired license condition input section <highlight><bold>506</bold></highlight> outputs the desired license condition to the fee claiming output section <highlight><bold>507</bold></highlight> to prompt to charge for the input desired license condition. The fee claiming output section <highlight><bold>507</bold></highlight> outputs, outside the apparatus, the desired license condition input from the desired license condition input section <highlight><bold>506</bold></highlight> and the information necessary for accounting, such as the accounting object information ID, input from the license information decoder section <highlight><bold>502</bold></highlight> on the basis of a predetermined protocol (step S<highlight><bold>310</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 37</cross-reference>). In response to this output, the external apparatus starts the accounting procedure. The fee claiming information to be output is determined by the usage environment of the information distribution system (i.e., the information distribution system constituted by the information recording apparatus and the information reproducing apparatus of the present invention) for protection by copyright and accounting, which incorporates the license information update unit. If the copyright holder of the accounting object information has been specified, the accounting object information ID need not be output. If the license condition has been set for all accounting object information in advance, the desired license condition input section <highlight><bold>506</bold></highlight> can be omitted, and the license condition need not be output from the fee claiming output section <highlight><bold>507</bold></highlight>. As described above, the license information update unit of this embodiment takes some self-explanatory variations depending on its usage environment. </paragraph>
<paragraph id="P-0300" lvl="0"><number>&lsqb;0300&rsqb;</number> Upon completing fee payment for the fee claiming information, a payment confirmation signal is sent from the external apparatus to a payment confirmation section <highlight><bold>508</bold></highlight>. When this signal is sent, the updated license information input from the license information update section <highlight><bold>505</bold></highlight> is sent to an updated license information encryption section <highlight><bold>509</bold></highlight> so the license information is encrypted using a predetermined encryption key held in an encryption key holder section <highlight><bold>510</bold></highlight> (steps S<highlight><bold>305</bold></highlight> and S<highlight><bold>306</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 36</cross-reference>). At this time, the updated license information is not sent to the updated license information encryption section <highlight><bold>509</bold></highlight> unless the signal is received. With this function, the license information update unit of this embodiment prevents the updated license information from being output when payment has not been performed yet. </paragraph>
<paragraph id="P-0301" lvl="0"><number>&lsqb;0301&rsqb;</number> The updated license information encrypted by the updated license information encryption section <highlight><bold>509</bold></highlight> is sent to an updated license information output section <highlight><bold>511</bold></highlight> and output to the external apparatus (step S<highlight><bold>307</bold></highlight>). In this case, the accounting object information ID means the ID of the accounting object information, which represents the copyright holder of the information and is necessary for specifying to the accounting amount or the accounting target. </paragraph>
<paragraph id="P-0302" lvl="0"><number>&lsqb;0302&rsqb;</number> The license information update unit shown in <cross-reference target="DRAWINGS">FIG. 35</cross-reference> can be applied not only to update the license information recorded on a recording medium or the like by the above-mentioned first information recording apparatus but also to update license information recorded on a recording medium or the like by the second or third information recording apparatus as a modification of the first information recording apparatus. </paragraph>
<paragraph id="P-0303" lvl="0"><number>&lsqb;0303&rsqb;</number> The license information update unit shown in <cross-reference target="DRAWINGS">FIG. 35</cross-reference> can be used as an independent unit, combined with the information reproducing apparatus of the present invention, or incorporated in the information reproducing apparatus. Alternatively, the license information update unit can be used as the license information update unit <highlight><bold>407</bold></highlight><highlight><italic>b </italic></highlight>in the license information update server shown in <cross-reference target="DRAWINGS">FIG. 31</cross-reference>. </paragraph>
<paragraph id="P-0304" lvl="7"><number>&lsqb;0304&rsqb;</number> (4) Accounting Apparatus for Protection by Copyright </paragraph>
<paragraph id="P-0305" lvl="0"><number>&lsqb;0305&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 38</cross-reference> shows an arrangement of the main part of an accounting apparatus for performing accounting for protection by copyright on the basis of license information recorded on a recording medium or the like by the above-described information recording apparatus. </paragraph>
<paragraph id="P-0306" lvl="0"><number>&lsqb;0306&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 38</cross-reference>, license information is loaded from a recording medium <highlight><bold>615</bold></highlight> such as a magnetic disk, a DVD, or a CD by a license information loading section <highlight><bold>601</bold></highlight>. Simultaneously, a desired license condition is input from a desired license condition input section <highlight><bold>602</bold></highlight> through an input medium <highlight><bold>616</bold></highlight> such as a keyboard or a mouse. The license information and the desired license condition are input to a license information update unit <highlight><bold>603</bold></highlight> and subjected to the same license information update processing as in the above-described license information update unit so that accounting information as a fee claim is sent to an accounting information retrieval section <highlight><bold>604</bold></highlight>. The accounting information is necessary for specifying the desired license condition and accounting target. The accounting information retrieval section <highlight><bold>604</bold></highlight> searches an accounting information database <highlight><bold>609</bold></highlight> for accounting amount information on the basis of the accounting information. If the accounting amount has been determined in advance, the desired license condition need not be output from the license information update unit <highlight><bold>603</bold></highlight>, and the accounting amount itself can be output. In this case, accounting information retrieval need not be performed. If the copyright holder of the accounting object information has been specified, the accounting information such as an accounting object information ID need not be output from the license information update unit <highlight><bold>603</bold></highlight>. In this case, an accounting history administration section <highlight><bold>608</bold></highlight> need to administer only the accounting amount information and not the accounting object information ID. As described above, the accounting information to be output from the license information update unit <highlight><bold>603</bold></highlight> takes self-explanatory variations depending on the situation of application of the accounting apparatus. </paragraph>
<paragraph id="P-0307" lvl="0"><number>&lsqb;0307&rsqb;</number> The accounting information and accounting amount information are sent to an accounting amount information output section <highlight><bold>605</bold></highlight>, so the accounting amount is presented to the user. When the user pays the presented account by some method, a payment decision section <highlight><bold>606</bold></highlight> confirms the payment and sends a signal confirming the payment to the payment confirmation section <highlight><bold>508</bold></highlight> in the license information update unit. If the user is to pay the fee in cash, a note/coin insertion section and a decision section are arranged, and a signal is sent to the payment decision section <highlight><bold>606</bold></highlight> in accordance with decision by the decision section. The payment is done by various methods using an electronic money, a credit card, or a prepaid card, so the decision is also made by various methods. </paragraph>
<paragraph id="P-0308" lvl="0"><number>&lsqb;0308&rsqb;</number> If the payment decision section <highlight><bold>606</bold></highlight> decides that payment is complete, the payment decision section <highlight><bold>606</bold></highlight> sends the accounting information to the accounting history administration section <highlight><bold>608</bold></highlight> such that the accounting information is stored and administered. </paragraph>
<paragraph id="P-0309" lvl="0"><number>&lsqb;0309&rsqb;</number> It is assumed that the accounting apparatus of this embodiment is not connected to an external apparatus through a network or the like, so banking is not complete at that point. For this reason, in this embodiment, the method of distributing such payment must be administered, so the accounting history administration section <highlight><bold>608</bold></highlight> is required. The history information stored in the accounting history administration section <highlight><bold>608</bold></highlight> is periodically read by a predetermined administrator, so the banking is performed by an appropriate section. </paragraph>
<paragraph id="P-0310" lvl="0"><number>&lsqb;0310&rsqb;</number> Finally, the license information update unit <highlight><bold>603</bold></highlight> which has received the signal representing completion of payment from the payment decision section <highlight><bold>606</bold></highlight> outputs the updated license information to an updated license information write-in section <highlight><bold>607</bold></highlight> through the same procedure as that in the above-described license information update unit. The write-in section <highlight><bold>607</bold></highlight> writes the updated license information at an appropriate portion of the input recording medium <highlight><bold>615</bold></highlight>. </paragraph>
<paragraph id="P-0311" lvl="0"><number>&lsqb;0311&rsqb;</number> When the accounting apparatus of this embodiment is combined with the information reproducing apparatus of the present invention, a vending machine for information with a copyright, which has a so-called license information update function, can be realized. As a characteristic feature, the characteristic function of the present invention is realized in one machine. With this arrangement, when accounting object information with a copyright is to be rented or sold, and it is assumed that the (encrypted) accounting object information has already been input to a portable recording medium such as a DVD or CD, appropriate accounting processing can be performed by inserting the recording medium in the accounting apparatus of this embodiment, so anyone is allowed anytime to conveniently buy the license for the contents. </paragraph>
<paragraph id="P-0312" lvl="7"><number>&lsqb;0312&rsqb;</number> (4-1) License Information Update Unit Taking Measure for Preventing Illicit Copy of Accounting Object Information and Decoder Unit in Information Reproducing Apparatus Corresponding to the License Information Update Unit </paragraph>
<paragraph id="P-0313" lvl="0"><number>&lsqb;0313&rsqb;</number> As can be easily understood, when permanent use of accounting object information with a copyright or a very late expiration date is permitted, the storage medium itself may be copied. If copies are distributed in a large volume, the copyright cannot be protected. To solve this problem, when permanent use or a long-term expiration date is to be permitted as a license condition, the decoder unit and license information update unit of this embodiment exclusively allow one incorporated decoder unit to reproduce the accounting object information. In the following description, a &ldquo;definite license&rdquo; or &ldquo;permanent license&rdquo; includes permission of permanent use or a long-term expiration date (this also applies to a description of (4-2) and the like). With this arrangement, even when a different decoder unit is used, the use is refused. Copies of information yield no benefit, and accordingly, the copyright is protected. In this case, however, the permanent license of accounting object information cannot be purchased without knowing the decoder unit ID (ID which specifies a decoder unit). For this reason, as the characteristic feature of the license information update unit of this embodiment, the decoder unit ID is added to the license condition at the first use of permanent license purchase contents. The decoder unit ID is identification information for identifying a decoder unit and can be, e.g., the manufacturing number of the decoder unit. </paragraph>
<paragraph id="P-0314" lvl="0"><number>&lsqb;0314&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 39</cross-reference> shows an arrangement of the decoder unit of this embodiment. The arrangement and operation of a decoder unit <highlight><bold>701</bold></highlight> will be described below with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 40</cross-reference>. </paragraph>
<paragraph id="P-0315" lvl="0"><number>&lsqb;0315&rsqb;</number> When license information is input from a license information input section <highlight><bold>711</bold></highlight> (step S<highlight><bold>401</bold></highlight>), the license information is sent to a decoder section <highlight><bold>712</bold></highlight>. The decoder section decodes the license information using a decoding key held in a decoding key holder section <highlight><bold>713</bold></highlight> (step S<highlight><bold>402</bold></highlight>). The decoded license information is sent to a license condition change necessitating decision section <highlight><bold>714</bold></highlight> (step S<highlight><bold>403</bold></highlight>). When the expiration date in the license condition is indefinite, the decision section <highlight><bold>714</bold></highlight> decides whether the expiration date is limited to a specific decoder unit ID. If the expiration date is not limited to a specific decoder unit ID, the decision section <highlight><bold>714</bold></highlight> decides that the license condition need be changed and causes a license information update unit <highlight><bold>702</bold></highlight> to update the license condition. More specifically, the decision section <highlight><bold>714</bold></highlight> receives the decoded license information, loads the license condition from the license information, and decides whether the expiration date is indefinite (step S<highlight><bold>404</bold></highlight>). If YES in step S<highlight><bold>404</bold></highlight>, it is decided whether the license condition is limited to a decoder unit ID (step S<highlight><bold>405</bold></highlight>). If YES in step S<highlight><bold>405</bold></highlight>, the license condition is sent to a decision section <highlight><bold>715</bold></highlight>. The decision section <highlight><bold>715</bold></highlight> sends a designation for presenting the decoder unit ID to a decoder unit ID reference section <highlight><bold>716</bold></highlight> (step S<highlight><bold>406</bold></highlight>). The decoder unit ID presented by the reference section <highlight><bold>716</bold></highlight> is compared with the decoder unit ID described in the license condition (step S<highlight><bold>407</bold></highlight>). If the decoder unit IDs agree with each other, the decoding key kd(1) of the encrypted accounting object information (contents) is output, and processing is ended (step S<highlight><bold>408</bold></highlight>). If the decoder unit IDs do not agree with each other, e.g., a NULL code (the NULL code is normally set at &ldquo;0&rdquo;) is output to indicate that decoding is disabled, and processing is ended (step S<highlight><bold>409</bold></highlight>). If the expiration date is indefinite, and no decoder unit ID is described in the license condition, the license condition change necessitating decision section <highlight><bold>714</bold></highlight> decides that the decoder unit ID need be described in the license condition, acquires the decoder unit ID from the decoder unit ID reference section <highlight><bold>716</bold></highlight>, and sends the acquired decoder unit ID and the encrypted license information to the license information update unit <highlight><bold>702</bold></highlight> (step S<highlight><bold>410</bold></highlight>). </paragraph>
<paragraph id="P-0316" lvl="0"><number>&lsqb;0316&rsqb;</number> If the license condition is not indefinite (NO in step S<highlight><bold>404</bold></highlight>), the license condition is sent to the decision section <highlight><bold>715</bold></highlight>. The decision section <highlight><bold>715</bold></highlight> receives the current time from a clock reference section <highlight><bold>717</bold></highlight> (step S<highlight><bold>411</bold></highlight>) and decides on the basis of the time whether the accounting object information can be used. If use of the accounting object information is enabled, the decoding key kd(1) of the encrypted accounting object information (contents) is output, and processing is ended (steps S<highlight><bold>412</bold></highlight> and S<highlight><bold>413</bold></highlight>); otherwise, the NULL code is output, as described above, and processing is ended (step S<highlight><bold>414</bold></highlight>). </paragraph>
<paragraph id="P-0317" lvl="0"><number>&lsqb;0317&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 41</cross-reference> shows an arrangement of the license information update unit <highlight><bold>702</bold></highlight>. The arrangement and operation of the license information update unit <highlight><bold>702</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 41</cross-reference> will be described below with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 42</cross-reference>. </paragraph>
<paragraph id="P-0318" lvl="0"><number>&lsqb;0318&rsqb;</number> The license information update unit <highlight><bold>702</bold></highlight> sends license information input to a license information input section <highlight><bold>721</bold></highlight> to a license information decoder section <highlight><bold>723</bold></highlight>. The license information decoder section <highlight><bold>723</bold></highlight> decodes the information on the basis of the decoding key from a decoding key holder section <highlight><bold>724</bold></highlight> (steps S<highlight><bold>421</bold></highlight> and S<highlight><bold>422</bold></highlight>). The decoded license information is sent to a license information update section <highlight><bold>725</bold></highlight> to extract the license condition (step S<highlight><bold>423</bold></highlight>). On the other hand, the decoder unit ID input to a decoder unit ID input section <highlight><bold>722</bold></highlight> is sent to the license information update section <highlight><bold>725</bold></highlight> (step S<highlight><bold>424</bold></highlight>). The license information update section <highlight><bold>725</bold></highlight> adds a limitation of the decoder unit ID to the extracted license condition, thereby updating the license condition (step S<highlight><bold>425</bold></highlight>). New license information is generated on the basis of the updated license condition and sent to an updated license information encryption section <highlight><bold>726</bold></highlight>. The updated license information encryption section <highlight><bold>726</bold></highlight> encrypts the updated license information on the basis of the encryption key presented by an encryption key holder section <highlight><bold>727</bold></highlight> (step S<highlight><bold>426</bold></highlight>) and then sends the license information to an updated license information output section <highlight><bold>728</bold></highlight>, so the license information is sent outside the license information update unit <highlight><bold>702</bold></highlight> (step S<highlight><bold>427</bold></highlight>). </paragraph>
<paragraph id="P-0319" lvl="0"><number>&lsqb;0319&rsqb;</number> The license information update unit <highlight><bold>702</bold></highlight> and the decoder unit <highlight><bold>701</bold></highlight> may be integrated into one unit and replaced with, e.g., the license information update unit <highlight><bold>603</bold></highlight> in the information distribution system shown in <cross-reference target="DRAWINGS">FIG. 38</cross-reference>. </paragraph>
<paragraph id="P-0320" lvl="7"><number>&lsqb;0320&rsqb;</number> (4-2) Another Example of Decoder Unit Taking Measure for Preventing Illicit Copy of Accounting Object Information </paragraph>
<paragraph id="P-0321" lvl="0"><number>&lsqb;0321&rsqb;</number> As described above in (4-1), when permanent license or a long-term expiration date (these two cases will be included in the category of permanent license hereinafter) is permitted, the accounting object information may be copied, and protection by copyright cannot be ensured. This problem is substantially solved by using the license information update unit described in (4-1) and the decoder unit corresponding to the license information update unit. That is, use of accounting object information for which permanent license is permitted is limited to one decoder unit ID. As a problem in this case, the decoder unit ID of the purchaser may be unknown in purchasing the permanent license. In the second decoder unit to be described below, when accounting object information with permanent license is used for the first time, the decoder unit ID to be used is written in the portion where the permanent license is described to prevent use of other decoder unit IDs. </paragraph>
<paragraph id="P-0322" lvl="0"><number>&lsqb;0322&rsqb;</number> In this scheme, however, the accounting object information may be copied before the first use. If an enormous volume of the copied accounting object information with the permanent license is distributed, the copyright cannot be protected. For this reason, in the second decoder unit, a media ID is added to the permanent license and referred to before use. The media ID means the manufacturing number of a DVD or CD. It is generally assumed that the media ID is written in a ROM area to prevent the ID from being changed. Since this license condition is limited to a specific media ID, a copy on another medium cannot be used because the media ID on the copy side does not match the original media ID. </paragraph>
<paragraph id="P-0323" lvl="0"><number>&lsqb;0323&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 43</cross-reference> shows an arrangement of the second decoder unit. The arrangement and operation of the second decoder unit shown in <cross-reference target="DRAWINGS">FIG. 43</cross-reference> will be described below with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 44</cross-reference>. </paragraph>
<paragraph id="P-0324" lvl="0"><number>&lsqb;0324&rsqb;</number> License information is input to a license information input section <highlight><bold>741</bold></highlight> and sent to a decoder section <highlight><bold>742</bold></highlight> (step S<highlight><bold>431</bold></highlight>). The decoder section <highlight><bold>742</bold></highlight> decodes the license information using a decoding key held in a decoding key holder section <highlight><bold>743</bold></highlight> to separate the license condition from the remaining information (step S<highlight><bold>432</bold></highlight>). The separated license condition is sent to a license condition change necessitating decision section <highlight><bold>744</bold></highlight> to decide whether the limitation of the decoder unit ID is to be added to the license condition. More specifically, as described in (4-1), if the expiration date is indefinite, and the decoder unit ID is not limited to a specific decoder unit, the limitation of the decoder unit ID must be added to the license condition. Only in such a case, it is decided that the license condition need be changed. The decoder unit ID is acquired from a decoder unit ID reference section <highlight><bold>746</bold></highlight> and sent to a license information update unit <highlight><bold>732</bold></highlight> together with the extracted license information (steps S<highlight><bold>434</bold></highlight>, S<highlight><bold>435</bold></highlight>, and S<highlight><bold>447</bold></highlight>). Otherwise, the license condition information is sent to a decision section <highlight><bold>745</bold></highlight> to decide the license condition. </paragraph>
<paragraph id="P-0325" lvl="0"><number>&lsqb;0325&rsqb;</number> The decision section <highlight><bold>745</bold></highlight> performs the following processing to decide whether the license condition is valid. If the license condition contains an indefinite expiration date, and the decoder unit ID is limited to a specific decoder unit, it is decided whether the license condition contains a limitation of the media ID. If the license condition contains the limitation of the media ID, the media ID of the medium having the accounting object information, which is held in a media ID holder section <highlight><bold>748</bold></highlight>, is referred to and compared with the media ID as the limitation in the license condition. If both the media IDs coincide with each other, the decoding key kd(1) is output, and processing is ended (steps S<highlight><bold>434</bold></highlight> to S<highlight><bold>440</bold></highlight>). If the media IDs do not coincide with each other, a signal representing that the use is refused, e.g., a NULL code is output, and processing is ended (step S<highlight><bold>441</bold></highlight>). If the limitation of the media ID is absent (NO in step S<highlight><bold>438</bold></highlight>), the decoding key kd(1) is output, and processing is ended (step S<highlight><bold>442</bold></highlight>). The media ID to be referred to at this time is input from a media ID input section <highlight><bold>747</bold></highlight> and held in the media ID holder section <highlight><bold>748</bold></highlight>. </paragraph>
<paragraph id="P-0326" lvl="0"><number>&lsqb;0326&rsqb;</number> If the license condition has a definite expiration date (NO in step S<highlight><bold>434</bold></highlight>), the current time is referred to through a clock reference section <highlight><bold>749</bold></highlight> (step S<highlight><bold>444</bold></highlight>) to decide whether the time is within the period (step S<highlight><bold>445</bold></highlight>). If NO in step S<highlight><bold>445</bold></highlight>, a signal representing that the use is refused, e.g., a NULL code is output, and processing is ended (step S<highlight><bold>446</bold></highlight>). If YES in step S<highlight><bold>445</bold></highlight>, the flow advances to step S<highlight><bold>438</bold></highlight> to decide whether the license condition contains the limitation of the media ID. The validity of the license condition is decided using the same algorithm as in case wherein the expiration date is indefinite, an appropriate signal is output in accordance with the decision result, and processing is ended. </paragraph>
<paragraph id="P-0327" lvl="0"><number>&lsqb;0327&rsqb;</number> It seems that when the expiration date is definite, the limitation of the media ID need not be added to the license condition because of the gist of the media ID. However, the definite period may be long. In this case, the copyright cannot be sufficiently protected in that period. Even before the expiration date, certain accounting object information is disadvantageous if it is copied without any limitation. In this case as well, the second decoder unit can be effectively used. </paragraph>
<paragraph id="P-0328" lvl="0"><number>&lsqb;0328&rsqb;</number> This also applies to the decoder unit ID. Even when the expiration date is definite, the limitation of the decoder unit ID in the license condition is effective and can be realized as in the limitation of the media ID. This also applies to the above-described (4-1). (5) Copy Apparatus </paragraph>
<paragraph id="P-0329" lvl="0"><number>&lsqb;0329&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 45</cross-reference> shows an arrangement of a copy apparatus for copying information recorded on a recording medium or the like by, e.g., the first information recording apparatus shown in <cross-reference target="DRAWINGS">FIG. 1</cross-reference>. The arrangement and operation of the copy apparatus shown in <cross-reference target="DRAWINGS">FIG. 45</cross-reference> will be described below with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 46</cross-reference>. </paragraph>
<paragraph id="P-0330" lvl="0"><number>&lsqb;0330&rsqb;</number> The basic concept of copy is to default the license condition in copying information. More specifically, the license information of accounting object information recorded on a certain medium (medium <highlight><bold>801</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 45</cross-reference>) may include an effective license condition. However, the copy apparatus shown in <cross-reference target="DRAWINGS">FIG. 45</cross-reference> erases the license condition and records the accounting object information on another medium (medium <highlight><bold>802</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 45</cross-reference>). </paragraph>
<paragraph id="P-0331" lvl="0"><number>&lsqb;0331&rsqb;</number> First, the unit information (e.g., encrypted accounting object information and license information thereof) recorded on the medium <highlight><bold>801</bold></highlight> as the copy source is read by a readout section <highlight><bold>803</bold></highlight> (step S<highlight><bold>501</bold></highlight>), and only the license information is transferred to a license information copy unit <highlight><bold>804</bold></highlight> (step S<highlight><bold>502</bold></highlight>). A readout section <highlight><bold>807</bold></highlight> reads the media ID of the medium <highlight><bold>802</bold></highlight> as the copy destination and transfers the media ID to the license information copy unit <highlight><bold>804</bold></highlight> (steps S<highlight><bold>503</bold></highlight> and S<highlight><bold>504</bold></highlight>). The license information copy unit <highlight><bold>804</bold></highlight> defaults the license information read from the medium <highlight><bold>801</bold></highlight> as the copy source and writes the media ID of the medium <highlight><bold>802</bold></highlight> as the copy destination in the license condition, thereby updating the license information (step S<highlight><bold>505</bold></highlight>). The updated license information is output to a write-in section <highlight><bold>806</bold></highlight> (step S<highlight><bold>506</bold></highlight>). </paragraph>
<paragraph id="P-0332" lvl="0"><number>&lsqb;0332&rsqb;</number> The license information copy unit <highlight><bold>804</bold></highlight> has an arrangement as shown in, e.g., <cross-reference target="DRAWINGS">FIG. 47</cross-reference>. The arrangement and operation of the license information copy unit <highlight><bold>804</bold></highlight> will be described below with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 48</cross-reference>. </paragraph>
<paragraph id="P-0333" lvl="0"><number>&lsqb;0333&rsqb;</number> The license information is input to a license information input section <highlight><bold>811</bold></highlight> of the license information copy unit <highlight><bold>804</bold></highlight> (step S<highlight><bold>511</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 48</cross-reference>), transferred to a decoder section <highlight><bold>812</bold></highlight> (step S<highlight><bold>512</bold></highlight>), and decoded by the decoder section <highlight><bold>812</bold></highlight> (step S<highlight><bold>513</bold></highlight>). The decoded license information is transferred to a license information update section <highlight><bold>813</bold></highlight> (step S<highlight><bold>514</bold></highlight>). The media ID of the medium <highlight><bold>802</bold></highlight> as the copy destination is input to a media ID input section <highlight><bold>814</bold></highlight> (step S<highlight><bold>515</bold></highlight>) and transferred to the license information update section <highlight><bold>813</bold></highlight> (step S<highlight><bold>516</bold></highlight>). The license information update section <highlight><bold>813</bold></highlight> defaults the license condition of the license information read from the medium <highlight><bold>801</bold></highlight> as the copy source and writes the media ID of the medium <highlight><bold>802</bold></highlight> as the copy destination in the license condition, thereby updating the license information (steps S<highlight><bold>517</bold></highlight> and S<highlight><bold>518</bold></highlight>). The updated license information is transferred to a license information output section <highlight><bold>815</bold></highlight> (step S<highlight><bold>519</bold></highlight>) and output to the write-in section <highlight><bold>806</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 45</cross-reference> (step S<highlight><bold>520</bold></highlight>). </paragraph>
<paragraph id="P-0334" lvl="0"><number>&lsqb;0334&rsqb;</number> Referring back to <cross-reference target="DRAWINGS">FIG. 45</cross-reference>, the write-in section <highlight><bold>806</bold></highlight> writes the updated license information in the medium <highlight><bold>802</bold></highlight> as the copy destination and simultaneously writes the accounting object information transferred from the readout section <highlight><bold>803</bold></highlight> in the medium <highlight><bold>802</bold></highlight>, and processing is ended (steps S<highlight><bold>507</bold></highlight> to S<highlight><bold>509</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 46</cross-reference>). </paragraph>
<paragraph id="P-0335" lvl="0"><number>&lsqb;0335&rsqb;</number> As described above, in the copy apparatus shown in <cross-reference target="DRAWINGS">FIG. 45</cross-reference>, since the license condition of the license information read from the medium <highlight><bold>801</bold></highlight> as the copy source by the license information copy unit <highlight><bold>804</bold></highlight> is erased, the license information has no valid license condition although the accounting object information recorded on the medium <highlight><bold>802</bold></highlight> as the copy destination is the same as that on the medium <highlight><bold>801</bold></highlight>. Therefore, even when the information recorded on the medium <highlight><bold>802</bold></highlight> is to be reproduced by an information reproducing apparatus having a decoder unit as shown in <cross-reference target="DRAWINGS">FIG. 43</cross-reference>, use of the information is refused. More specifically, only a decoder unit having a decoding key can decode the license information. To decode the encrypted accounting object information, a decoding key corresponding to the accounting object information included in the license information is required, so the accounting object information cannot be used in this state. To use the accounting object information copied in the medium <highlight><bold>802</bold></highlight>, a valid license condition must be added to the license information by some proper accounting procedure. </paragraph>
<paragraph id="P-0336" lvl="0"><number>&lsqb;0336&rsqb;</number> Defaulting the license condition is not limited to erase of the effective license condition. For example, a license condition which enables use of the copy until only one day after copying may be described. For example, assuming that the current time is &ldquo;13:00, April 16&rdquo;, a license condition with an expiration date at &ldquo;23:59, April 17&rdquo; is described. </paragraph>
<paragraph id="P-0337" lvl="0"><number>&lsqb;0337&rsqb;</number> The copy apparatus in <cross-reference target="DRAWINGS">FIG. 45</cross-reference> defaults the license condition and simultaneously writes the media ID of the medium <highlight><bold>802</bold></highlight> as the copy destination. The media ID is a character string for specifying the medium having the accounting object information, such as a manufacturing number described in the ROM area of, e.g., a DVD-RAM. Alternatively, the media ID may be the manufacturing number of the hard disk device. </paragraph>
<paragraph id="P-0338" lvl="0"><number>&lsqb;0338&rsqb;</number> In this embodiment, the media ID is contained in the license information. The decoder unit which is to use the media ID confirms the media ID in decoding the license information. If the media ID of the DVD-RAM having the information to be reproduced does not agree with that contained in the license information, the decoding key for decoding the accounting object information is not output, as described above. This operation of the decoder unit makes the accounting object information itself designate the &ldquo;medium&rdquo;. </paragraph>
<paragraph id="P-0339" lvl="0"><number>&lsqb;0339&rsqb;</number> The accounting object information whose license information contains the media ID can be copied only by a proper copy apparatus (i.e., an apparatus having a decoding key) as described in this embodiment. To reproduce the accounting object information in the medium <highlight><bold>802</bold></highlight> as the copy destination using an information reproducing apparatus having a decoder unit which confirms the media ID, the media ID of the medium <highlight><bold>802</bold></highlight> must be buried in the license condition of the license information. The copy apparatus shown in <cross-reference target="DRAWINGS">FIG. 45</cross-reference> performs processing therefor. </paragraph>
<paragraph id="P-0340" lvl="7"><number>&lsqb;0340&rsqb;</number> (6) Third Example of Information Reproducing Apparatus: Information Reproducing Apparatus Using Decoder Unit to Watch Subsidiary Information (Warning Associated with Advertisement or Use of Copyright) </paragraph>
<paragraph id="P-0341" lvl="0"><number>&lsqb;0341&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 49</cross-reference> shows an arrangement of the third information reproducing apparatus. To ensure proper watching of subsidiary information contained in information recorded on a recording medium or the like by the information recording apparatus of the present invention, watching confirmation data is inserted into the subsidiary information. For example, watching confirmation data is inserted into subsidiary information at two or more positions. An example of subsidiary information will be shown. </paragraph>
<paragraph id="P-0342" lvl="0"><number>&lsqb;0342&rsqb;</number> &ldquo;In 0Th0 beginning did exist Logs. 0is0 Logos 00with the God. Lo0isgos was 0th0 God. In the beginning he was 0ec0 with the God. All0erti0 was created by him0fi0. Of things0cat0 created, nothing0ta. 0was00 not 0da0created by 0ion0 him.&rdquo;</paragraph>
<paragraph id="P-0343" lvl="0"><number>&lsqb;0343&rsqb;</number> A watching confirmation data extraction section <highlight><bold>903</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 49</cross-reference> sends input subsidiary information to a reproduction section <highlight><bold>905</bold></highlight> to reproduce the subsidiary information. At the same time, the watching confirmation data extraction section <highlight><bold>903</bold></highlight> sequentially checks the subsidiary information and extracts characters sandwiched by two &ldquo;0&rdquo;s. If nothing is inserted between two &ldquo;0&rdquo;s, the extracted character string is stored. In the above example, a character string &ldquo;this is the certification data.&rdquo; is extracted as watching confirmation data and stored in a predetermined memory incorporated in the watching confirmation data extraction section <highlight><bold>903</bold></highlight>. It is important to insert the watching confirmation data into the subsidiary information at two or more positions. When the watching confirmation data is inserted into the subsidiary information, the watching confirmation data cannot be reproduced unless the entire subsidiary information is reproduced. Therefore, watching can be confirmed upon reproducing the watching confirmation data. </paragraph>
<paragraph id="P-0344" lvl="0"><number>&lsqb;0344&rsqb;</number> The arrangement and operation of the third information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 49</cross-reference> will be described below with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 50</cross-reference>. </paragraph>
<paragraph id="P-0345" lvl="0"><number>&lsqb;0345&rsqb;</number> An information storage section <highlight><bold>901</bold></highlight> has the same arrangement as that of the information storage section <highlight><bold>101</bold></highlight> in the first information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>. The unit information read from the information storage section <highlight><bold>901</bold></highlight> by an information readout section <highlight><bold>902</bold></highlight> contains encrypted accounting object information, license information, and subsidiary information. Of these pieces of information, the encrypted accounting object information is transferred to the reproduction section <highlight><bold>905</bold></highlight> (step S<highlight><bold>601</bold></highlight>), and the subsidiary information is transferred to the watching confirmation data extraction section <highlight><bold>903</bold></highlight> (step S<highlight><bold>602</bold></highlight>). The watching confirmation data extraction section <highlight><bold>903</bold></highlight> scans the subsidiary information to extract watching confirmation data (step S<highlight><bold>603</bold></highlight>). The readout section <highlight><bold>902</bold></highlight> transfers the license information to a decoder unit <highlight><bold>904</bold></highlight> (step S<highlight><bold>604</bold></highlight>). </paragraph>
<paragraph id="P-0346" lvl="0"><number>&lsqb;0346&rsqb;</number> The license condition of the license information contains watching confirmation data as a reproduction condition for the accounting object information. The decoder unit <highlight><bold>904</bold></highlight> reads out the watching confirmation data which has been confirmed by the watching confirmation data extraction section <highlight><bold>903</bold></highlight> and collates the two watching confirmation data (steps S<highlight><bold>605</bold></highlight> and S<highlight><bold>606</bold></highlight>). If the watching confirmation data agree with each other, processing is continued (step S<highlight><bold>607</bold></highlight>). More specifically, after the license condition such as the expiration date is confirmed, the key for decoding the accounting object information is output to the reproduction section <highlight><bold>905</bold></highlight> to reproduce the accounting object information (steps S<highlight><bold>608</bold></highlight> to S<highlight><bold>611</bold></highlight>). </paragraph>
<paragraph id="P-0347" lvl="0"><number>&lsqb;0347&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 51</cross-reference> shows an arrangement of the decoder unit <highlight><bold>904</bold></highlight>. The arrangement and operation of the decoder unit <highlight><bold>904</bold></highlight> will be described below with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 52</cross-reference>. </paragraph>
<paragraph id="P-0348" lvl="0"><number>&lsqb;0348&rsqb;</number> The license information transferred to the decoder unit <highlight><bold>904</bold></highlight> is input to a license information input section <highlight><bold>904</bold></highlight><highlight><italic>a </italic></highlight>(step S<highlight><bold>621</bold></highlight>) and transferred to a decoder section <highlight><bold>904</bold></highlight><highlight><italic>b </italic></highlight>(step S<highlight><bold>622</bold></highlight>). The decoder section <highlight><bold>904</bold></highlight><highlight><italic>b </italic></highlight>decodes the license information using the decoding key kd held in a decoding key holder section <highlight><bold>904</bold></highlight><highlight><italic>c </italic></highlight>and transfers the license information to a watching confirmation section <highlight><bold>904</bold></highlight><highlight><italic>d </italic></highlight>(steps S<highlight><bold>623</bold></highlight> to S<highlight><bold>625</bold></highlight>). The watching confirmation data sent from the watching confirmation data extraction section <highlight><bold>903</bold></highlight> is input to a watching confirmation data input section <highlight><bold>904</bold></highlight><highlight><italic>e </italic></highlight>and transferred to the watching confirmation section <highlight><bold>904</bold></highlight><highlight><italic>d </italic></highlight>(step S<highlight><bold>626</bold></highlight>). The watching confirmation section <highlight><bold>904</bold></highlight><highlight><italic>d </italic></highlight>collates the watching confirmation data as the accounting object information reproduction condition contained in the license condition of the license information with the watching confirmation data sent from the watching confirmation data extraction section <highlight><bold>903</bold></highlight> (step S<highlight><bold>627</bold></highlight>). If the two watching confirmation data match, the license information is sent to a decision section <highlight><bold>904</bold></highlight><highlight><italic>f </italic></highlight>(steps S<highlight><bold>628</bold></highlight> and S<highlight><bold>629</bold></highlight>). The decision section <highlight><bold>904</bold></highlight><highlight><italic>f </italic></highlight>decides on the basis of the license condition in the license information whether the accounting object information can be used (i.e., whether the decoding key kd(1) is to be output to the reproduction section <highlight><bold>905</bold></highlight>), and in accordance with the decision result, outputs the decoding key to the reproduction section <highlight><bold>905</bold></highlight> (steps S<highlight><bold>630</bold></highlight> to S<highlight><bold>632</bold></highlight>). </paragraph>
<paragraph id="P-0349" lvl="0"><number>&lsqb;0349&rsqb;</number> In the above-described information recording apparatus of the present invention, one accounting object information is recorded on a recording medium or the like in correspondence with one license information. However, one accounting object information may be recorded on a recording medium or the like in correspondence with a plurality of pieces of license information. </paragraph>
<paragraph id="P-0350" lvl="0"><number>&lsqb;0350&rsqb;</number> In the information reproducing apparatus of the present invention, when it is decided whether accounting object information can be used, the license condition contained in one license information corresponding to the accounting object information is referred to. However, the present invention is not limited to this. When a plurality of pieces of license information are recorded on the recording medium in correspondence with one accounting object information, license conditions contained in all the license information may be sequentially referred to to determine whether the accounting object information can be used. That is, if one of license conditions contained in the plurality of pieces of license information is satisfied, it is decided that the accounting object information can be used. </paragraph>
<paragraph id="P-0351" lvl="0"><number>&lsqb;0351&rsqb;</number> In the information reproducing apparatus and accounting apparatus of the present invention, when license information is to be updated, the license information which has already been recorded on a recording medium is rewritten. However, license information may be additionally recorded on the recording medium. Therefore, in the description of updating the license information recorded on the recording medium in the above embodiment, &ldquo;update&rdquo; means not only &ldquo;overwrite recording&rdquo; but also &ldquo;additional recording&rdquo;. </paragraph>
<paragraph id="P-0352" lvl="0"><number>&lsqb;0352&rsqb;</number> In addition, the number of decoder unit IDs or media IDs contained in the license condition is not always one. </paragraph>
<paragraph id="P-0353" lvl="7"><number>&lsqb;0353&rsqb;</number> (Second Embodiment) </paragraph>
<paragraph id="P-0354" lvl="7"><number>&lsqb;0354&rsqb;</number> (1) Decoder Unit A </paragraph>
<paragraph id="P-0355" lvl="0"><number>&lsqb;0355&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 54</cross-reference> shows an arrangement of a decoding decision device, i.e., a decoder unit A according to the second embodiment. </paragraph>
<paragraph id="P-0356" lvl="0"><number>&lsqb;0356&rsqb;</number> The decoder unit A checks on the basis of license information belonging to chargeable data as digital contents whether the use of the contents is enabled (i.e., whether the license for the use of the contents information based on the license condition defined by contract is valid). If the license condition is valid, a contents decoding key required to use the contents information is output to an information usage device such as a video reproducing device for reproducing the contents information or the like. </paragraph>
<paragraph id="P-0357" lvl="0"><number>&lsqb;0357&rsqb;</number> In this case, the contents information is encrypted in advance. The decoding key (to be referred to as a contents decoding key hereinafter) is added to the license information together with the contents license condition such as an expiration date or contents information identification information (ID). All the license information is encrypted and provided to the subscriber together with the encrypted contents information (for example, the license information is distributed through a recording medium storing the license information or broadcast distribution). </paragraph>
<paragraph id="P-0358" lvl="0"><number>&lsqb;0358&rsqb;</number> The license information is decoded using a secret key present in the decoder unit A. <cross-reference target="DRAWINGS">FIG. 55</cross-reference> shows an example of license information. As shown in <cross-reference target="DRAWINGS">FIG. 55</cross-reference>, the license information contains at least the contents decoding key, the contents license condition such as the expiration date for the contents information, and the ID of the contents information. </paragraph>
<paragraph id="P-0359" lvl="0"><number>&lsqb;0359&rsqb;</number> If the secret key for decoding the license information is common to all decoder units, it is convenient for the operation, though leakage of the secret key allows to read all contents decoding keys contained in license information to be decoded using this decoder unit in principle. This is a serious problem for the decoder unit A with a purpose of protecting the license, and the present invention has as its object to solve this problem. </paragraph>
<paragraph id="P-0360" lvl="0"><number>&lsqb;0360&rsqb;</number> To solve this problem, the decoder unit A of this embodiment generates a secret key for decoding license information and uses the secret key only in a predetermined period. </paragraph>
<paragraph id="P-0361" lvl="0"><number>&lsqb;0361&rsqb;</number> The operations of the various portions of the decoder unit A shown in <cross-reference target="DRAWINGS">FIG. 54</cross-reference> will be described next with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 57</cross-reference>. </paragraph>
<paragraph id="P-0362" lvl="0"><number>&lsqb;0362&rsqb;</number> Encrypted license information is input to the decoder unit A through a license information input section <highlight><bold>2001</bold></highlight> (step S<highlight><bold>1001</bold></highlight>), decoded by a decoder section <highlight><bold>2002</bold></highlight> (step S<highlight><bold>1002</bold></highlight>), and sent to a decision section <highlight><bold>2003</bold></highlight> to check the license condition, thereby deciding whether the license is valid (steps S<highlight><bold>1003</bold></highlight> and S<highlight><bold>1004</bold></highlight>). Decision whether the license is valid is made by deciding whether the license condition is satisfied, i.e., whether the license for the contents has not expired. </paragraph>
<paragraph id="P-0363" lvl="0"><number>&lsqb;0363&rsqb;</number> If the decision section <highlight><bold>2003</bold></highlight> decides that the license is valid (the contents can be used), the contents decoding key contained in the license information is output to an information usage device (e.g., a set top box) <highlight><bold>2020</bold></highlight> (step S<highlight><bold>1005</bold></highlight>). </paragraph>
<paragraph id="P-0364" lvl="0"><number>&lsqb;0364&rsqb;</number> If it is decided that the license is invalid (the contents cannot be used), the license information is sent to an updated information generation section <highlight><bold>2004</bold></highlight> to arrange information necessary for updating the license (i.e., updating the license information) and generate updated information for updating the license information. The updated information is output to a license information update device <highlight><bold>2008</bold></highlight> through a predetermined communication line (e.g., a leased line or the Internet) (steps S<highlight><bold>1006</bold></highlight> to S<highlight><bold>1010</bold></highlight>). </paragraph>
<paragraph id="P-0365" lvl="0"><number>&lsqb;0365&rsqb;</number> The updated information generation section <highlight><bold>2004</bold></highlight> generates updated information (<cross-reference target="DRAWINGS">FIG. 56</cross-reference>) containing at least the ID of the contents and a public key of the decoder unit A, which is generated by a key generation section <highlight><bold>2006</bold></highlight>, on the basis of the desired license condition of a user&apos;s choice (later expiration date) input through a license condition input section <highlight><bold>2009</bold></highlight> and the license information sent from the decision section <highlight><bold>2003</bold></highlight>. </paragraph>
<paragraph id="P-0366" lvl="0"><number>&lsqb;0366&rsqb;</number> As described above, the decoder unit A has the key generation section <highlight><bold>2006</bold></highlight> for generating a secret key for decoding encrypted license information. The key generation section <highlight><bold>2006</bold></highlight> generates a key for encrypting/decoding license information. As a key generation method, a key generation algorithm for a public key cipher may be used. For an RSA cipher, a random number and prime number decision algorithm is used to generate two prime numbers p and q each having an appropriate length (e.g., about 512 bits). </paragraph>
<paragraph id="P-0367" lvl="0"><number>&lsqb;0367&rsqb;</number> Even in a random number algorithm common to all decoder units A, when the seed of a random number is set in units of, e.g., microseconds, the same prime number is less likely to be generated. </paragraph>
<paragraph id="P-0368" lvl="0"><number>&lsqb;0368&rsqb;</number> Next, N is obtained from N&equals;p&middot;q. At the same time, M&equals;(p&minus;1)(q&minus;1) is calculated, and integers e and d for satisfying </paragraph>
<paragraph lvl="0"><in-line-formula><highlight><italic>ed&equals;&minus;</italic></highlight>1(mod <highlight><italic>M</italic></highlight>) </in-line-formula></paragraph>
<paragraph id="P-0369" lvl="7"><number>&lsqb;0369&rsqb;</number> are obtained (0&lt;e, and d&lt;M). The integers e and d can be relatively easily obtained by obtaining d first and then obtaining e corresponding to d using an Euclidean algorithm. One (e.g., e) of the integers is used as a secret key, and the other (e.g., d) as a public key. A public key cipher is realized on the basis of the known RSA cipher algorithm using these keys. </paragraph>
<paragraph id="P-0370" lvl="0"><number>&lsqb;0370&rsqb;</number> These keys are unique to the decoder unit A. Even when the keys are read out from the decoder unit by some device, the keys cannot be used in other units. When a key holder section <highlight><bold>2005</bold></highlight> sets the expiration date for the keys, the keys cannot be used even in the same unit after a predetermined period. The key generation section <highlight><bold>2006</bold></highlight> is driven by the key holder section <highlight><bold>2005</bold></highlight>. </paragraph>
<paragraph id="P-0371" lvl="0"><number>&lsqb;0371&rsqb;</number> The key holder section <highlight><bold>2005</bold></highlight> sends a key generation instruction to the key generation section <highlight><bold>2006</bold></highlight> at a predetermined timing. This timing is generally set on the basis of time referred to by, e.g., a clock reference section <highlight><bold>2007</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 54</cross-reference>. </paragraph>
<paragraph id="P-0372" lvl="0"><number>&lsqb;0372&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 58</cross-reference> is a flow chart for explaining the procedure of key generation processing by the key holder section <highlight><bold>2005</bold></highlight> and the key generation section <highlight><bold>2006</bold></highlight>. The key holder section <highlight><bold>2005</bold></highlight> refers to the time through the clock reference section <highlight><bold>2007</bold></highlight> at a predetermined timing (step S<highlight><bold>1021</bold></highlight>). If it is predetermined key update time, a key generation instruction is sent to the key generation section <highlight><bold>2006</bold></highlight>. The key generation section <highlight><bold>2006</bold></highlight> generates the above-described public key and secret key (steps S<highlight><bold>1022</bold></highlight> and S<highlight><bold>1023</bold></highlight>). If the current time is not the key update time, processing waits for a predetermined period (step S<highlight><bold>1025</bold></highlight>). The public key and secret key generated by the key generation section <highlight><bold>2006</bold></highlight> are held in the key holder section <highlight><bold>2005</bold></highlight> (step S<highlight><bold>1024</bold></highlight>). </paragraph>
<paragraph id="P-0373" lvl="0"><number>&lsqb;0373&rsqb;</number> As described above, once keys are generated as the initialization operation for the first use of the decoder unit A, different decoder units A can effectively obtain different keys without generating keys by the key generation section <highlight><bold>2006</bold></highlight> many times. Alternatively, different keys may be set in the key holder section <highlight><bold>2005</bold></highlight> in shipment from the factory, as a matter of course. In this case, the key generation section <highlight><bold>2006</bold></highlight> can be omitted. </paragraph>
<paragraph id="P-0374" lvl="0"><number>&lsqb;0374&rsqb;</number> As the characteristic feature of the decoder unit A of the present invention, to update the license information, the public key held in the key holder section <highlight><bold>2005</bold></highlight> must be transmitted to the license information update device <highlight><bold>2008</bold></highlight> together with other information necessary for updating the license information (the public key is used to encrypt the updated license information generated by the license information update device <highlight><bold>2008</bold></highlight>). This procedure is performed by the updated information generation section <highlight><bold>2004</bold></highlight>. </paragraph>
<paragraph id="P-0375" lvl="0"><number>&lsqb;0375&rsqb;</number> The updated information generation section <highlight><bold>2004</bold></highlight> is started when the decision section <highlight><bold>2003</bold></highlight> decides on the basis of the license information that the contents cannot be used, so that the updated information generation section <highlight><bold>2004</bold></highlight> starts the license condition input section <highlight><bold>2009</bold></highlight> and prompts the user to input a desired license condition (e.g., a later expiration date). Simultaneously, the updated information generation section <highlight><bold>2004</bold></highlight> prompts the key holder section <highlight><bold>2005</bold></highlight> to output the public key, describes the obtained public key and desired license condition in a predetermined format together with information necessary for accounting, e.g., a contents ID sent from the decision section <highlight><bold>2003</bold></highlight>, and sends them to the license information update device <highlight><bold>2008</bold></highlight> as updated information (<cross-reference target="DRAWINGS">FIG. 56</cross-reference>) for updating the license information. </paragraph>
<paragraph id="P-0376" lvl="0"><number>&lsqb;0376&rsqb;</number> The clock reference section <highlight><bold>2007</bold></highlight> which refers to an internal clock <highlight><bold>201</bold></highlight> (external clock, as needed) is used to set the key generation timing of the key holder section <highlight><bold>2005</bold></highlight> or check the expiration date in the license condition. </paragraph>
<paragraph id="P-0377" lvl="7"><number>&lsqb;0377&rsqb;</number> (2) Decoder Unit B </paragraph>
<paragraph id="P-0378" lvl="0"><number>&lsqb;0378&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 59</cross-reference> shows an arrangement of another decoding decision device, i.e., a decoder unit B. The decoder unit B can prevent a contents decoding key from existing in the decoder unit (even temporarily) as unencrypted data. </paragraph>
<paragraph id="P-0379" lvl="0"><number>&lsqb;0379&rsqb;</number> If analysis of the unit reveals that a contents decoding key is present in the unit as unencrypted data, the contents decoding key may be read. If the contents decoding key can be constantly read, any contents decoding key can be acquired using this method (without knowing the secret key of the decoder unit), resulting in a serious problem in security of license protection. This problem cannot be solved by the above-described decoder unit A which generates a new secret key at a predetermined period and replaces it with an old key, because of its nature. </paragraph>
<paragraph id="P-0380" lvl="0"><number>&lsqb;0380&rsqb;</number> In the decoder unit B, the contents decoding key is kept encrypted, so the encrypted contents decoding key cannot be decoded using only information in the decoder unit. </paragraph>
<paragraph id="P-0381" lvl="0"><number>&lsqb;0381&rsqb;</number> The operations of various portions of the decoder unit B shown in <cross-reference target="DRAWINGS">FIG. 59</cross-reference> will be described with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 61</cross-reference>. </paragraph>
<paragraph id="P-0382" lvl="0"><number>&lsqb;0382&rsqb;</number> Encrypted license information is input to the decoder unit B through the license information input section <highlight><bold>2001</bold></highlight> and decoded by the decoder section <highlight><bold>2002</bold></highlight> using a secret key held in the decoder unit B in advance (steps S<highlight><bold>1031</bold></highlight> and S<highlight><bold>1032</bold></highlight>). </paragraph>
<paragraph id="P-0383" lvl="0"><number>&lsqb;0383&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 60</cross-reference> shows an example of license information to be input to the decoder unit B. As shown in <cross-reference target="DRAWINGS">FIG. 60</cross-reference>, the license information contains at least a contents ID, the license condition for the contents, an encrypted contents decoding key &lsqb;kc&rsqb; K<highlight><subscript>AB</subscript></highlight>, and common key generation information ka for decoding the encrypted contents decoding key. The contents decoding key kc is encrypted using the common key K<highlight><subscript>AB</subscript></highlight>. </paragraph>
<paragraph id="P-0384" lvl="0"><number>&lsqb;0384&rsqb;</number> The license information decoded by the decoder section <highlight><bold>2002</bold></highlight> is sent to the decision section <highlight><bold>2003</bold></highlight> to decide the license condition (step S<highlight><bold>1033</bold></highlight>). If the license condition is satisfied, the encrypted contents decoding key &lsqb;kc&rsqb; K<highlight><subscript>AB </subscript></highlight>and the common key generation information ka are sent to the information usage device <highlight><bold>2020</bold></highlight> (steps S<highlight><bold>1034</bold></highlight> and S<highlight><bold>1035</bold></highlight>). </paragraph>
<paragraph id="P-0385" lvl="0"><number>&lsqb;0385&rsqb;</number> If the decision section <highlight><bold>2003</bold></highlight> decides that the contents cannot be used, a contents ID and the like necessary for updating the license are sent to the updated information generation section <highlight><bold>2004</bold></highlight> (steps S<highlight><bold>1034</bold></highlight> and S<highlight><bold>1036</bold></highlight>). </paragraph>
<paragraph id="P-0386" lvl="0"><number>&lsqb;0386&rsqb;</number> The updated information generation section <highlight><bold>2004</bold></highlight> prompts, through a common key generation information extracting section <highlight><bold>2031</bold></highlight>, the information usage device <highlight><bold>2020</bold></highlight> which uses the contents to output common key generation information kb necessary for encrypting the contents decoding key in the license information update device <highlight><bold>2008</bold></highlight>. </paragraph>
<paragraph id="P-0387" lvl="0"><number>&lsqb;0387&rsqb;</number> The pieces of common key generation information ka and kb for encrypting the contents decoding key will be described. For a public key cipher (e.g., an ellipse curve cipher) with security based on the discrete logarithmic problem, the following common key generation protocol can be considered. An element x common to the information usage device <highlight><bold>2020</bold></highlight> and the license information update device <highlight><bold>2008</bold></highlight> is defined in advance. In addition, an integer b (defined at the time of, e.g., shipment) and an element X<highlight><superscript>b </superscript></highlight>calculated from x and b are obtained and stored in the information usage device <highlight><bold>2020</bold></highlight> in advance. If license update is requested, x<highlight><superscript>b </superscript></highlight>is sent to the decoder unit B as the common key generation information kb. </paragraph>
<paragraph id="P-0388" lvl="0"><number>&lsqb;0388&rsqb;</number> The decoder unit B generates updated information (<cross-reference target="DRAWINGS">FIG. 62</cross-reference>) containing not only the desired license condition input by the user from the license condition input section <highlight><bold>2009</bold></highlight> but also the common key generation information kb and contents ID and send the updated information to the license information update device <highlight><bold>2008</bold></highlight>. </paragraph>
<paragraph id="P-0389" lvl="7"><number>&lsqb;0389&rsqb;</number> ti (<highlight><italic>kb</italic></highlight>)<highlight><superscript>a</superscript></highlight>&equals;x<highlight><superscript>ab </superscript></highlight></paragraph>
<paragraph id="P-0390" lvl="7"><number>&lsqb;0390&rsqb;</number> is calculated by the license information update device <highlight><bold>2008</bold></highlight> in correspondence with the common key generation information kb&equals;x<highlight><superscript>b </superscript></highlight>from the decoder unit B using an integer a defined by itself using a random number or the like, and set as the common key K<highlight><subscript>AB </subscript></highlight>for the information usage device <highlight><bold>2020</bold></highlight> for decoding the contents decoding key. </paragraph>
<paragraph id="P-0391" lvl="0"><number>&lsqb;0391&rsqb;</number> The license information update device <highlight><bold>2008</bold></highlight> adds the common key generation information ka generated by the license information update device <highlight><bold>2008</bold></highlight> itself, i.e., x<highlight><superscript>a </superscript></highlight>to the updated license information, as shown in <cross-reference target="DRAWINGS">FIG. 60</cross-reference>. This updated license information is sent to the information usage device <highlight><bold>2020</bold></highlight> through the decoder section <highlight><bold>2002</bold></highlight> and the decision section <highlight><bold>2003</bold></highlight>. </paragraph>
<paragraph id="P-0392" lvl="0"><number>&lsqb;0392&rsqb;</number> The information usage device <highlight><bold>2020</bold></highlight> calculates </paragraph>
<paragraph lvl="0"><in-line-formula>(<highlight><italic>ka</italic></highlight>)<highlight><superscript>b</superscript></highlight>&equals;(<highlight><italic>xa</italic></highlight>)<highlight><superscript>b</superscript></highlight>&equals;x<highlight><superscript>ab</superscript></highlight><highlight><italic>&equals;K</italic></highlight><highlight><subscript>AB </subscript></highlight></in-line-formula></paragraph>
<paragraph id="P-0393" lvl="7"><number>&lsqb;0393&rsqb;</number> from the integer b unique to each information usage device, which is held in advance in the device, and the common key generation information ka sent from the decoder unit B, thereby obtaining the common key K<highlight><subscript>AB</subscript></highlight>. </paragraph>
<paragraph id="P-0394" lvl="0"><number>&lsqb;0394&rsqb;</number> With this arrangement, even when the secret key of the decoder unit B is read, the contents decoding key cannot be obtained only from the information in the decoder unit B. </paragraph>
<paragraph id="P-0395" lvl="0"><number>&lsqb;0395&rsqb;</number> This is because it is difficult in terms of calculation amount to generate K<highlight><subscript>AB</subscript></highlight>&equals;x<highlight><superscript>ab </superscript></highlight>from ka&equals;x<highlight><superscript>a </superscript></highlight>and kb&equals;x<highlight><superscript>b </superscript></highlight>as common key generation information. For this purpose, the integers a and b must be obtained. A problem for obtaining a from x<highlight><superscript>a </superscript></highlight>and the public information x is called a discrete logarithmic problem. For the public key cipher (e.g., the ellipse curve cipher) with security based on the discrete logarithmic problem, the calculation is difficult in terms of calculation amount. For this reason, the contents decoding key can be prevented from existing in the decoder unit B as unencrypted data, so a system for preventing the contents decoding key kc from being extracted even when the secret key for decoding license information in the decoder unit B is read out. </paragraph>
<paragraph id="P-0396" lvl="0"><number>&lsqb;0396&rsqb;</number> Referring back to <cross-reference target="DRAWINGS">FIG. 61</cross-reference>, the information usage device <highlight><bold>2020</bold></highlight> which uses the contents to update the license outputs the key generation information kb in response to the request from the common key generation information extracting section <highlight><bold>2031</bold></highlight>. Upon receiving the key generation information kb, the common key generation information extracting section <highlight><bold>2031</bold></highlight> sends the key generation information kb to the updated information generation section <highlight><bold>2004</bold></highlight> (step S<highlight><bold>1037</bold></highlight>). Simultaneously, the common key generation information extracting section <highlight><bold>2031</bold></highlight> starts the license condition input section <highlight><bold>2009</bold></highlight> to prompt the user to input a desired license condition. The updated information generation section <highlight><bold>2004</bold></highlight> generates updated license information (<cross-reference target="DRAWINGS">FIG. 62</cross-reference>) from the input desired license condition and the contents ID and common key generation information kb which have been separately obtained, and transmits the license information to the license information update device <highlight><bold>2008</bold></highlight> through a predetermined communication line (or the Internet) (steps S<highlight><bold>1038</bold></highlight> to S<highlight><bold>1040</bold></highlight>). </paragraph>
<paragraph id="P-0397" lvl="0"><number>&lsqb;0397&rsqb;</number> As is apparent, a decoder unit C having both the function of the decoder unit A which individually holds or generates the public key and the secret key and the function of the decoder unit B which encrypts the contents decoding key using the common key between the license information update device <highlight><bold>2008</bold></highlight> and the information usage device <highlight><bold>2020</bold></highlight> can be constituted. </paragraph>
<paragraph id="P-0398" lvl="0"><number>&lsqb;0398&rsqb;</number> In this case, license information as shown in <cross-reference target="DRAWINGS">FIG. 60</cross-reference> is encrypted using a public key supplied from the decoder unit C and input to the decoder unit C as shown in <cross-reference target="DRAWINGS">FIG. 63</cross-reference>. The same reference numerals as in the decoder unit A in <cross-reference target="DRAWINGS">FIG. 54</cross-reference> denote the same parts in <cross-reference target="DRAWINGS">FIG. 63</cross-reference>. The decoder unit C is different from the decoder unit A in that the updated information generation section <highlight><bold>2004</bold></highlight> accesses the information usage device <highlight><bold>2020</bold></highlight> to acquire the key generation information kb held in the information usage device <highlight><bold>2020</bold></highlight> in updating the license, generates updated license information as shown in <cross-reference target="DRAWINGS">FIG. 64</cross-reference>, which contains at least the acquired key generation information kb, the public key generated by the key generation section <highlight><bold>2006</bold></highlight>, and the input desired license condition and contents ID, and transmits the license information to the license information update device <highlight><bold>2008</bold></highlight>. </paragraph>
<paragraph id="P-0399" lvl="7"><number>&lsqb;0399&rsqb;</number> (3) Decoder Unit D </paragraph>
<paragraph id="P-0400" lvl="0"><number>&lsqb;0400&rsqb;</number> In a decoder unit D, the decoding key is a common key used for the license information update device <highlight><bold>2008</bold></highlight> only once, unlike the decoder unit A or B. More specifically, the decoding key is generated every time decoding is performed, and no decoding key need be held in the decoder unit D. This means that the decoding key which must be kept secret is temporarily generated and can be erased from the memory immediately after use, so the security of the decoder unit can be effectively improved. </paragraph>
<paragraph id="P-0401" lvl="0"><number>&lsqb;0401&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 66</cross-reference> shows an example of license information input to the decoder unit D. The license information has an encrypted portion and an unencrypted portion, as shown in <cross-reference target="DRAWINGS">FIG. 66</cross-reference>. The encrypted portion contains at least the contents license condition, the contents decoding key kc, and the contents ID, and the entire portion is encrypted using the common key K<highlight><subscript>AB </subscript></highlight>between the decoder unit D and the license information update device <highlight><bold>2008</bold></highlight>. The unencrypted portion is constituted by at least the common key generation information ka generated by the license information update device <highlight><bold>2008</bold></highlight> to generate the common key K<highlight><subscript>AB</subscript></highlight>, and the common key generation information kb generated by the decoder unit D by the method to be described below. The method of generating the common key K<highlight><subscript>AB </subscript></highlight>is the same as that in the decoder unit B. </paragraph>
<paragraph id="P-0402" lvl="0"><number>&lsqb;0402&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 65</cross-reference> shows an arrangement of the decoder unit D. The operations of various portions of the decoder unit D shown in <cross-reference target="DRAWINGS">FIG. 65</cross-reference> will be described below with reference to the flow chart-shown in <cross-reference target="DRAWINGS">FIG. 67</cross-reference>. </paragraph>
<paragraph id="P-0403" lvl="0"><number>&lsqb;0403&rsqb;</number> License information is input through the license information input section <highlight><bold>2001</bold></highlight> (step S<highlight><bold>1051</bold></highlight>). The input license information is divided into the encrypted portion and the unencrypted portion by the license information input section <highlight><bold>2001</bold></highlight>. The encrypted portion is sent to the decoder section <highlight><bold>2002</bold></highlight>, and the pieces of common key generation information ka and kb in the unencrypted portion are sent to a decoding key generation section <highlight><bold>2041</bold></highlight> (step S<highlight><bold>1052</bold></highlight>). </paragraph>
<paragraph id="P-0404" lvl="0"><number>&lsqb;0404&rsqb;</number> The decoding key generation section <highlight><bold>2041</bold></highlight> sends the common key generation information kb to a common key generation information generation section <highlight><bold>2042</bold></highlight> and acquires common key information b corresponding to the common key generation information kb by looking up a table <highlight><bold>2043</bold></highlight> stored in the common key generation information generation section <highlight><bold>2042</bold></highlight> (steps S<highlight><bold>1053</bold></highlight> and S<highlight><bold>1054</bold></highlight>). In response to this, the decoding key generation section <highlight><bold>2041</bold></highlight> generates the common key K<highlight><subscript>AB </subscript></highlight>from the pieces of common key generation information ka and b (step S<highlight><bold>1055</bold></highlight>). </paragraph>
<paragraph id="P-0405" lvl="0"><number>&lsqb;0405&rsqb;</number> The common key K<highlight><subscript>AB </subscript></highlight>is sent to the decoder section <highlight><bold>2002</bold></highlight> and used to decode the encrypted portion of the license information (step S<highlight><bold>1056</bold></highlight>). </paragraph>
<paragraph id="P-0406" lvl="0"><number>&lsqb;0406&rsqb;</number> The decoded license information is sent to the decision section <highlight><bold>2003</bold></highlight> to check the license condition (step S<highlight><bold>1057</bold></highlight>). If it is decided that the contents can be used, the contents decoding key kc is output to the information usage device <highlight><bold>2020</bold></highlight> (steps S<highlight><bold>1058</bold></highlight> and S<highlight><bold>1059</bold></highlight>). If it is decided that the contents cannot be used, the updated information generation section <highlight><bold>2004</bold></highlight> is notified of it and instructs the common key generation information generation section <highlight><bold>2042</bold></highlight> to generate common key generation information. </paragraph>
<paragraph id="P-0407" lvl="0"><number>&lsqb;0407&rsqb;</number> The common key generation information generation section <highlight><bold>2042</bold></highlight> generates a pair of the common key information b and common key generation information kb in accordance with this instruction, and registers them in the table <highlight><bold>2043</bold></highlight> incorporated in the common key generation information generation section <highlight><bold>2042</bold></highlight> (step S<highlight><bold>1060</bold></highlight>). The generated common key generation information kb is sent to the updated information generation section <highlight><bold>2004</bold></highlight>. </paragraph>
<paragraph id="P-0408" lvl="0"><number>&lsqb;0408&rsqb;</number> The updated information generation section <highlight><bold>2004</bold></highlight> prompts the license condition input section <highlight><bold>2009</bold></highlight> to input a desired license condition. The license condition input section <highlight><bold>2009</bold></highlight> receives input of the desired license condition from the user through an appropriate human interface and sends it to the updated information generation section <highlight><bold>2004</bold></highlight>. </paragraph>
<paragraph id="P-0409" lvl="0"><number>&lsqb;0409&rsqb;</number> The updated information generation section <highlight><bold>2004</bold></highlight> generates updated information as shown in <cross-reference target="DRAWINGS">FIG. 69</cross-reference> on the basis of information obtained by the above process, transmits the updated information to the license information update device <highlight><bold>2008</bold></highlight> through a predetermined communication line, and receives the updated license information (steps S<highlight><bold>1061</bold></highlight> to S<highlight><bold>1063</bold></highlight>). </paragraph>
<paragraph id="P-0410" lvl="0"><number>&lsqb;0410&rsqb;</number> The license information update device <highlight><bold>2008</bold></highlight> generates the common key generation information ka and the common key K<highlight><subscript>AB</subscript></highlight>, updates the common key generation information ka shown in <cross-reference target="DRAWINGS">FIG. 66</cross-reference> to the generated common key generation information ka, and the common key generation information kb to the common key generation information kb contained in the updated information, and encrypts the license condition and the like which are updated on the basis of the desired license condition contained in the updated information, using the generated common key K<highlight><subscript>AB</subscript></highlight>, thereby updating the license information. </paragraph>
<paragraph id="P-0411" lvl="0"><number>&lsqb;0411&rsqb;</number> When the decoder unit D is to reproduce and use the contents for the first time, the common key generation information kb has not been generated. For this reason, the decoding key generation section <highlight><bold>2041</bold></highlight> cannot generate the common key K<highlight><subscript>AB</subscript></highlight>, so the license information cannot be decoded (step S<highlight><bold>1053</bold></highlight>). </paragraph>
<paragraph id="P-0412" lvl="0"><number>&lsqb;0412&rsqb;</number> Processing in this case will be described with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 68</cross-reference>. In this case, the unencrypted portion of the license information does not have the common key generation information kb (alternatively, invalid information such as a NULL code is contained). Under this situation, the decoding key generation section <highlight><bold>2041</bold></highlight> detects that this reproduction is to be done for the first use and instructs the common key generation information generation section <highlight><bold>2042</bold></highlight> to generate common key generation information. In response to this instruction, the common key generation information generation section <highlight><bold>2042</bold></highlight> generates the pair of the common key information b and common key generation information kb and sends an instruction for updating the common key generation information kb and license (step S<highlight><bold>1071</bold></highlight>). </paragraph>
<paragraph id="P-0413" lvl="0"><number>&lsqb;0413&rsqb;</number> In this case, the encrypted portion of the license information has been encrypted using a secret key ks (the secret key ks is commonly used for all decoder units D). The decoder section <highlight><bold>2002</bold></highlight> receives the secret key ks from the decoding key generation section <highlight><bold>2041</bold></highlight> and decodes the encrypted portion (step S<highlight><bold>1072</bold></highlight>). The contents ID is extracted from the decoded portion of the license information (step S<highlight><bold>1073</bold></highlight>). </paragraph>
<paragraph id="P-0414" lvl="0"><number>&lsqb;0414&rsqb;</number> In response to this, the updated information generation section <highlight><bold>2004</bold></highlight> prompts the license condition input section <highlight><bold>2009</bold></highlight> to input the desired license condition and receives input of the desired license condition from the user through the license condition input section <highlight><bold>2009</bold></highlight> (step S<highlight><bold>1074</bold></highlight>). The contents ID, the desired license condition, and the common key generation information kb, which are obtained by the above process, are described in a format shown in <cross-reference target="DRAWINGS">FIG. 69</cross-reference> and transmitted to the license information update device <highlight><bold>2008</bold></highlight> (step S<highlight><bold>1075</bold></highlight>). With this processing, the updated license information is issued. </paragraph>
<paragraph id="P-0415" lvl="0"><number>&lsqb;0415&rsqb;</number> In reproduction for the first use, when no effective contents decoding key is inserted into the encrypted portion of the license information, the security is further improved. More specifically, if no contents decoding key is contained in the original license information, no contents decoding key can be extracted even when the common secret key ks leaks. In this case, encryption is made to prevent the contents ID from being changed. </paragraph>
<paragraph id="P-0416" lvl="0"><number>&lsqb;0416&rsqb;</number> In the above arrangement, the decoding key K<highlight><subscript>AB </subscript></highlight>must be generated every time decoding is performed, and a new decoding key K<highlight><subscript>AB </subscript></highlight>must be used for decoding every time the license information is updated (a new decoding key is generated from the common key information b retrieved from the table <highlight><bold>2043</bold></highlight> in correspondence with the common key generation information kb contained in the license information). For this reason, the influence of leakage of the decoding key K<highlight><subscript>AB </subscript></highlight>is minimized. In addition, since the common key cipher at a much higher speed than the public key cipher can be used, even license information with a large data size can be decoded in real time, and the contents use enable/disable state based on the license condition contained in the license information can be reflected. </paragraph>
<paragraph id="P-0417" lvl="0"><number>&lsqb;0417&rsqb;</number> Variations of the decoder unit D will be described next. </paragraph>
<paragraph id="P-0418" lvl="0"><number>&lsqb;0418&rsqb;</number> First, the common key generation information kb to be generated by the decoder unit D may be fixed. In this case, the security lowers to some degree. However, the common key K<highlight><subscript>AB </subscript></highlight>is changed every time the common key generation information ka generated by the license information update device <highlight><bold>2008</bold></highlight> changes, so the validity of the decoder unit D is maintained. The common key generation information generation section <highlight><bold>2042</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 65</cross-reference> can be omitted. Predetermined common key generation information kb and common key information b can be held in the decoding key generation section <highlight><bold>2041</bold></highlight>. </paragraph>
<paragraph id="P-0419" lvl="0"><number>&lsqb;0419&rsqb;</number> When the decoder unit D is to reproduce and use the contents information for the first time, the license must always be updated in accordance with acquisition of the common key generation information kb, as shown in <cross-reference target="DRAWINGS">FIG. 68</cross-reference>. To solve this problem, the license information is encrypted using a predetermined common key K<highlight><subscript>com </subscript></highlight>or public key K<highlight><subscript>p </subscript></highlight>only for the first time. In this case, the secret key K<highlight><subscript>p </subscript></highlight>corresponding to the common key K<highlight><subscript>com </subscript></highlight>or public key K<highlight><subscript>p </subscript></highlight>must be held in the decoder unit D and used only for the first time. In this arrangement, the contents decoding key must always be contained, though it need not be contained in processing for the first use shown in <cross-reference target="DRAWINGS">FIG. 68</cross-reference>. </paragraph>
<paragraph id="P-0420" lvl="0"><number>&lsqb;0420&rsqb;</number> More specifically, in step S<highlight><bold>1053</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 67</cross-reference>, the updated information generation section <highlight><bold>2004</bold></highlight> decides that the reproduction is to be performed for the first time because the pieces of common key generation information ka and kb are not present, and the decoder section <highlight><bold>2002</bold></highlight> decodes the license information using the common key K<highlight><subscript>com </subscript></highlight>or public key K<highlight><subscript>p </subscript></highlight>held in the decoding key generation section <highlight><bold>2041</bold></highlight> or decoder section <highlight><bold>2002</bold></highlight>. Subsequent processing is the same as that from step S<highlight><bold>1054</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 67</cross-reference>. </paragraph>
<paragraph id="P-0421" lvl="0"><number>&lsqb;0421&rsqb;</number> Alternatively, the common key generation information kb to be generated by the decoder unit D may be generated by the information usage device <highlight><bold>2020</bold></highlight>. <cross-reference target="DRAWINGS">FIG. 70</cross-reference> shows the arrangement of a decoder unit D&prime; for this purpose. As shown in <cross-reference target="DRAWINGS">FIG. 70</cross-reference>, the common key generation information generation section <highlight><bold>2042</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 65</cross-reference> is replaced with the information usage device <highlight><bold>2020</bold></highlight>. Since the information usage device <highlight><bold>2020</bold></highlight> is set outside the decoder unit D&prime;, the common key information b must be kept secret. However, this problem can be solved by performing encryption using a temporarily key between the decoding key generation section <highlight><bold>2041</bold></highlight> and the information usage device <highlight><bold>2020</bold></highlight>. In this case, even the common key information b need not be held in the decoder unit D&prime;, so the security is further improved as compared to the decoder unit D. The information usage device <highlight><bold>2020</bold></highlight> is also attacked, and an individual measure must be taken because information usage devices are mounted in different manners. The security level can be changed for each information usage device <highlight><bold>2020</bold></highlight>. The processing operation of the decoder unit D&prime; is the same as that in the flow charts shown in <cross-reference target="DRAWINGS">FIGS. 67 and 68</cross-reference>. </paragraph>
<paragraph id="P-0422" lvl="7"><number>&lsqb;0422&rsqb;</number> (4) License Information Update Device Corresponding to Decoder Unit A </paragraph>
<paragraph id="P-0423" lvl="0"><number>&lsqb;0423&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 71</cross-reference> shows an arrangement of the license information update device <highlight><bold>2008</bold></highlight> corresponding to the above-described decoder unit A. The processing operations of various portions of the license information update device <highlight><bold>2008</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 71</cross-reference> will be described below with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 72</cross-reference>. </paragraph>
<paragraph id="P-0424" lvl="0"><number>&lsqb;0424&rsqb;</number> Updated license information transmitted from the decoder unit A is input to the license information update device <highlight><bold>2008</bold></highlight> through the updated information input section <highlight><bold>2051</bold></highlight> (step S<highlight><bold>1081</bold></highlight>). </paragraph>
<paragraph id="P-0425" lvl="0"><number>&lsqb;0425&rsqb;</number> The updated information to be used at this time is the updated information shown in <cross-reference target="DRAWINGS">FIG. 56, i</cross-reference>.e., information containing the desired license condition, the contents ID, the public key generated by the decoder unit A, and the like, which is necessary for updating the license. The contents ID is used to specify the contents for which the license is to be given. On the basis of the contents ID, accounting information corresponding to the desired license condition can be acquired using the database incorporated in the license information update device <highlight><bold>2008</bold></highlight>, and the contents decoding key can also be acquired using the database. For this reason, the contents decoding key need not be input to the license information update device <highlight><bold>2008</bold></highlight> to update the license information, and the updated information in <cross-reference target="DRAWINGS">FIG. 56</cross-reference> need not be encrypted before transmission. This is the characteristic feature of the license information update device <highlight><bold>2008</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 72</cross-reference>. </paragraph>
<paragraph id="P-0426" lvl="0"><number>&lsqb;0426&rsqb;</number> The updated information shown in <cross-reference target="DRAWINGS">FIG. 56</cross-reference>, which is input from an updated information input section <highlight><bold>2051</bold></highlight>, is sent to a fee claiming section <highlight><bold>2052</bold></highlight>. The desired license condition contained in the updated information is sent to a fee inquiry section <highlight><bold>2057</bold></highlight>. </paragraph>
<paragraph id="P-0427" lvl="0"><number>&lsqb;0427&rsqb;</number> The fee inquiry section <highlight><bold>2057</bold></highlight> accesses a fee database (DB) <highlight><bold>2058</bold></highlight> to acquire a fee corresponding to the desired license condition (steps S<highlight><bold>1082</bold></highlight> and S<highlight><bold>1083</bold></highlight>). If the valid period of &ldquo;two months&rdquo; is designated as desired period, a contents usage fee value corresponding to the period is retrieved and transferred to the fee inquiry section <highlight><bold>2057</bold></highlight> and the fee claiming section <highlight><bold>2052</bold></highlight>. </paragraph>
<paragraph id="P-0428" lvl="0"><number>&lsqb;0428&rsqb;</number> The fee claiming section <highlight><bold>2052</bold></highlight> accesses a predetermined electronic banking system <highlight><bold>2060</bold></highlight> through a predetermined communication line to send, to the client, a fee claim based on the acquired fee value and client data contained in the updated information. The electronic banking system <highlight><bold>2060</bold></highlight> executes predetermined electronic payment processing (step S<highlight><bold>1084</bold></highlight>). </paragraph>
<paragraph id="P-0429" lvl="0"><number>&lsqb;0429&rsqb;</number> A payment confirmation section <highlight><bold>2053</bold></highlight> in the license information update device <highlight><bold>2008</bold></highlight> communicates with the electronic banking system <highlight><bold>2060</bold></highlight> through a predetermined communication line to confirm fee payment, and the flow advances to processing in a contents decoding key acquisition section <highlight><bold>2054</bold></highlight> (step S<highlight><bold>1085</bold></highlight>). </paragraph>
<paragraph id="P-0430" lvl="0"><number>&lsqb;0430&rsqb;</number> The contents decoding key acquisition section <highlight><bold>2054</bold></highlight> searches a contents decoding key database (DB) <highlight><bold>2059</bold></highlight> for a contents decoding key using the contents ID as a key (step S<highlight><bold>1086</bold></highlight>). Since it is assumed that the license information update device <highlight><bold>2008</bold></highlight> is managed and operated by a specific reliable agency, the contents decoding key DB <highlight><bold>2059</bold></highlight> and the obtained contents decoding key need not be encrypted. </paragraph>
<paragraph id="P-0431" lvl="0"><number>&lsqb;0431&rsqb;</number> A license information encryption section <highlight><bold>2055</bold></highlight> constructs license information on the basis of the obtained information (step S<highlight><bold>1087</bold></highlight>), encrypts the license information using a public key contained in the updated information shown in <cross-reference target="DRAWINGS">FIG. 56</cross-reference>, which has been received in advance (step S<highlight><bold>1088</bold></highlight>), and transmits the license information to the client as a license information update request source, i.e., the decoder unit A through a predetermined communication line (step S<highlight><bold>1089</bold></highlight>). </paragraph>
<paragraph id="P-0432" lvl="7"><number>&lsqb;0432&rsqb;</number> (5) License Information Update Device Corresponding to Decoder Unit B </paragraph>
<paragraph id="P-0433" lvl="0"><number>&lsqb;0433&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 73</cross-reference> shows an arrangement of the license information update device <highlight><bold>2008</bold></highlight> corresponding to the above-described decoder unit B. The processing operations of various portions of the license information update device <highlight><bold>2008</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 73</cross-reference> will be described below with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 74</cross-reference>. </paragraph>
<paragraph id="P-0434" lvl="0"><number>&lsqb;0434&rsqb;</number> The same reference numerals as in <cross-reference target="DRAWINGS">FIG. 71</cross-reference> denote the same parts in <cross-reference target="DRAWINGS">FIG. 73</cross-reference>, and only different portions will be described. Referring to <cross-reference target="DRAWINGS">FIG. 73, a</cross-reference> common key generation section <highlight><bold>2061</bold></highlight> and a contents decoding key encryption section <highlight><bold>2062</bold></highlight> are inserted between the contents decoding key acquisition section <highlight><bold>2054</bold></highlight> and the license information encryption section <highlight><bold>2055</bold></highlight>. The same reference symbols as in the flow chart of <cross-reference target="DRAWINGS">FIG. 72</cross-reference> denote the same operations in the flow chart of <cross-reference target="DRAWINGS">FIG. 74</cross-reference>, and only different portions will be described. Between steps S<highlight><bold>1086</bold></highlight> and S<highlight><bold>1087</bold></highlight>, the integer a and the common key generation information ka are generated by the common key generation section <highlight><bold>2061</bold></highlight>. The common key K<highlight><subscript>AB </subscript></highlight>is generated from the integer a and common key generation information ka, and the common key generation information kb unique to the information usage device <highlight><bold>2020</bold></highlight>, which is contained in the updated information (steps S<highlight><bold>1091</bold></highlight> and S<highlight><bold>1092</bold></highlight>). The encryption section <highlight><bold>2062</bold></highlight> encrypts the contents decoding key newly acquired in step S<highlight><bold>1086</bold></highlight> using the newly generated common key K<highlight><subscript>AB </subscript></highlight>(step S<highlight><bold>1093</bold></highlight>). </paragraph>
<paragraph id="P-0435" lvl="0"><number>&lsqb;0435&rsqb;</number> In the arrangement shown in <cross-reference target="DRAWINGS">FIG. 73</cross-reference>, to encrypt the contents decoding key and insert it in the license information, the common key generation section <highlight><bold>2061</bold></highlight> must generate a common key between the information usage device <highlight><bold>2020</bold></highlight> and the license information update device <highlight><bold>2008</bold></highlight> to decode the encrypted contents decoding key. The common key is generated using common key generation information, as described about the decoder unit B. Therefore, the updated information input to the license information update device <highlight><bold>2008</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 73</cross-reference> contains at least the desired license condition, the contents ID, and the common key generation information kb generated by the information usage device <highlight><bold>2020</bold></highlight> using a random number or the like, as shown in <cross-reference target="DRAWINGS">FIG. 62</cross-reference>. </paragraph>
<paragraph id="P-0436" lvl="0"><number>&lsqb;0436&rsqb;</number> In step S<highlight><bold>1088</bold></highlight>, the newly generated license information is encrypted by the license information encryption section <highlight><bold>2055</bold></highlight> using a predetermined public key. </paragraph>
<paragraph id="P-0437" lvl="0"><number>&lsqb;0437&rsqb;</number> In a license information update device corresponding to the decoder unit C having both the function of the decoder unit A which individually holds or generates the public key and the secret key and the function of the decoder unit B which encrypts the contents decoding key using the common key between the license information update device <highlight><bold>2008</bold></highlight> and the information usage device <highlight><bold>2020</bold></highlight>, the updated information to be input also contains a public key generated by the decoder unit C. In step S<highlight><bold>1088</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 74</cross-reference>, the generated license information is encrypted using the public key. </paragraph>
<paragraph id="P-0438" lvl="0"><number>&lsqb;0438&rsqb;</number> A license information update device corresponding to the decoder unit D or D&prime; has almost the same arrangement as described above. As the different point, the encryption section <highlight><bold>2062</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 73</cross-reference> encrypts the license condition, the contents decoding key kc, and the contents ID using the common key K<highlight><subscript>AB </subscript></highlight>to generate license information as shown in <cross-reference target="DRAWINGS">FIG. 66</cross-reference>, and outputs the generated license information directly through the license information output section <highlight><bold>2056</bold></highlight>. </paragraph>
<paragraph id="P-0439" lvl="7"><number>&lsqb;0439&rsqb;</number> (Third Embodiment) </paragraph>
<paragraph id="P-0440" lvl="0"><number>&lsqb;0440&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 75</cross-reference> shows an arrangement of an information distribution system according to the third embodiment. </paragraph>
<paragraph id="P-0441" lvl="0"><number>&lsqb;0441&rsqb;</number> In <cross-reference target="DRAWINGS">FIG. 75</cross-reference>, the user acquires contents information as an accounting object recorded on a removable information storage medium (to be simply referred to as a medium hereinafter) such as a DVD. License information for the contents information is also recorded on the medium. The information reproducing apparatus of the user incorporates a decoder unit, and it is decided on the basis of the license information read from the medium whether the contents can be used. </paragraph>
<paragraph id="P-0442" lvl="0"><number>&lsqb;0442&rsqb;</number> If the contents cannot be used, the license information must be updated for the user to use the contents. More specifically, the license condition contained in the license information, i.e., the license must be updated. The license condition, i.e., the license information is updated in a shop having a license update terminal for this purpose. The license update terminal is connected to a license server operated by a license sales agency. The user designates a desired license condition (e.g., designation of contents and the expiration date therefor) and pays a corresponding license fee (contents fee corresponding to the license condition) to the shop. The license update terminal communicates with the license server and updates the license information recorded on the medium on the basis of information sent from the license server, thereby updating the license. For example, when the user purchases a license with an expiration date, the contents can be used without updating the license before it expires. </paragraph>
<paragraph id="P-0443" lvl="0"><number>&lsqb;0443&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 76</cross-reference> shows another arrangement of the information distribution system. As a different point from <cross-reference target="DRAWINGS">FIG. 75</cross-reference>, at least the function of the decoder unit is incorporated in a card type recording medium such as an IC card. The card type recording medium such as an IC card incorporating a decoder unit will be called a decoding decision card hereinafter. In this case, to update the license, the user goes to the shop having the license update terminal with the decoding decision card. The license update terminal reads a public master key from the decoding decision card and transfers it to the license server. The user designates a desired license condition (e.g., designation of contents and the expiration date therefor) and pays a corresponding license fee (contents fee corresponding to the license condition) to the shop. The license update terminal communicates with the license server and updates the license information recorded on the medium on the basis of information sent from the license server, thereby updating the license. </paragraph>
<paragraph id="P-0444" lvl="0"><number>&lsqb;0444&rsqb;</number> The public master key will be described later. </paragraph>
<paragraph id="P-0445" lvl="0"><number>&lsqb;0445&rsqb;</number> In <cross-reference target="DRAWINGS">FIG. 75</cross-reference>, the decoder unit need not always be incorporated in the information reproducing apparatus and may have the shape of the decoding decision card shown in <cross-reference target="DRAWINGS">FIG. 76</cross-reference> and detachably inserted into the information reproducing apparatus. The information distribution systems shown in <cross-reference target="DRAWINGS">FIGS. 75 and 76</cross-reference> will be described below while exemplifying the use of the decoding decision card. </paragraph>
<paragraph id="P-0446" lvl="7"><number>&lsqb;0446&rsqb;</number> (1) Information Distribution System in <cross-reference target="DRAWINGS">FIG. 75</cross-reference> </paragraph>
<paragraph id="P-0447" lvl="7"><number>&lsqb;0447&rsqb;</number> (1-1) Information Reproducing Apparatus </paragraph>
<paragraph id="P-0448" lvl="0"><number>&lsqb;0448&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 77</cross-reference> shows an arrangement of an information reproducing apparatus having a decoding decision card. The information reproducing apparatus is constituted by connecting, to a bus <highlight><bold>3007</bold></highlight>, a decoding decision card <highlight><bold>3001</bold></highlight>, a media readout device <highlight><bold>3003</bold></highlight>, an information reproduction device <highlight><bold>3004</bold></highlight>, a clock <highlight><bold>3005</bold></highlight>, and a central processing unit <highlight><bold>3006</bold></highlight>. </paragraph>
<paragraph id="P-0449" lvl="0"><number>&lsqb;0449&rsqb;</number> The clock <highlight><bold>3005</bold></highlight> is used to decide whether the expiration date for contents as a license condition is valid/invalid. As described above in the first embodiment, time is set using an encrypted command. In updating the license, a time setting operation is performed to adjust the time of this clock in correspondence with the time of the server. This operation has been described above. With this processing, the clock <highlight><bold>3005</bold></highlight> can maintain almost correct time. </paragraph>
<paragraph id="P-0450" lvl="0"><number>&lsqb;0450&rsqb;</number> The media readout device <highlight><bold>3003</bold></highlight> reads information recorded on a medium <highlight><bold>3002</bold></highlight> such as a DVD. The decoding decision card <highlight><bold>3001</bold></highlight> decides on the basis of the readout information whether the contents information recorded on the medium <highlight><bold>3002</bold></highlight> can be used. If it is decided that the contents information can be used, the information reproduction section <highlight><bold>3004</bold></highlight> can reproduce the contents information read from the medium <highlight><bold>3002</bold></highlight> by the media readout device <highlight><bold>3003</bold></highlight>. The central processing unit <highlight><bold>3006</bold></highlight> controls the operation of each section. </paragraph>
<paragraph id="P-0451" lvl="0"><number>&lsqb;0451&rsqb;</number> Each of the decoding decision card <highlight><bold>3001</bold></highlight> and the clock <highlight><bold>3005</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 77</cross-reference> holds key generation information Kt. Each of the decoding decision card <highlight><bold>3001</bold></highlight> and the information reproduction device <highlight><bold>3004</bold></highlight> holds key generation information K&prime;t. </paragraph>
<paragraph id="P-0452" lvl="0"><number>&lsqb;0452&rsqb;</number> On the basis of random numbers A and B and the key generation information Kt, a transfer key KT which is valid only once to encrypt/decode current time information to be transferred between the clock <highlight><bold>3005</bold></highlight> and the decoding decision card <highlight><bold>3001</bold></highlight> is generated. In addition, on the basis of random numbers C and D and the key generation information K&prime;t, the transfer key KT which is valid only once to encrypt/decode a contents key Kc for decoding contents information encrypted between the decoding decision card <highlight><bold>3001</bold></highlight> and the information reproduction section <highlight><bold>3004</bold></highlight> is generated. With this processing, information transferred through the bus <highlight><bold>3007</bold></highlight> is protected. </paragraph>
<paragraph id="P-0453" lvl="0"><number>&lsqb;0453&rsqb;</number> The medium <highlight><bold>3002</bold></highlight> stores the following information. </paragraph>
<paragraph id="P-0454" lvl="2"><number>&lsqb;0454&rsqb;</number> License information (&lsqb;license information&rsqb; KM) encrypted using a master key KM </paragraph>
<paragraph id="P-0455" lvl="2"><number>&lsqb;0455&rsqb;</number> Master key ID as an identifier (e.g., a number) for designating the master key KM for decoding the license information </paragraph>
<paragraph id="P-0456" lvl="2"><number>&lsqb;0456&rsqb;</number> Contents information (&lsqb;contents information&rsqb; Kc) encrypted using the contents key Kc </paragraph>
<paragraph id="P-0457" lvl="0"><number>&lsqb;0457&rsqb;</number> In the following description, both the encryption and decoding keys to be used to encrypt/decode the license information will be called the master keys KM, and the encryption and decoding keys of the license information are not always identical. </paragraph>
<paragraph id="P-0458" lvl="0"><number>&lsqb;0458&rsqb;</number> The license information has the following information. </paragraph>
<paragraph id="P-0459" lvl="2"><number>&lsqb;0459&rsqb;</number> Contents key Kc </paragraph>
<paragraph id="P-0460" lvl="2"><number>&lsqb;0460&rsqb;</number> Contents ID </paragraph>
<paragraph id="P-0461" lvl="2"><number>&lsqb;0461&rsqb;</number> Contents license condition such as an expiration date, use start time, license information recording time, and the like </paragraph>
<paragraph id="P-0462" lvl="0"><number>&lsqb;0462&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 78</cross-reference> is a flow chart showing the processing operation of the information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 77</cross-reference>, which is used in the information distribution system shown in <cross-reference target="DRAWINGS">FIG. 75</cross-reference>. </paragraph>
<paragraph id="P-0463" lvl="0"><number>&lsqb;0463&rsqb;</number> The media readout device <highlight><bold>3003</bold></highlight> reads out the master key ID and the &lsqb;license information&rsqb; KM from the medium <highlight><bold>3002</bold></highlight> set in the media readout device <highlight><bold>3003</bold></highlight> and transfers them to the decoding decision card <highlight><bold>3001</bold></highlight> (steps S<highlight><bold>3001</bold></highlight> and S<highlight><bold>3002</bold></highlight>). </paragraph>
<paragraph id="P-0464" lvl="0"><number>&lsqb;0464&rsqb;</number> The clock <highlight><bold>3005</bold></highlight> generates the random number A in accordance with a predetermined algorithm and transfers it to the decoding decision card <highlight><bold>3001</bold></highlight> (step S<highlight><bold>3003</bold></highlight>). The decoding decision card <highlight><bold>3001</bold></highlight> also generates the random number B in accordance with a predetermined algorithm and transfers it to the clock <highlight><bold>3005</bold></highlight> (step S<highlight><bold>3004</bold></highlight>). With this processing, the decoding decision card <highlight><bold>3001</bold></highlight> and the clock <highlight><bold>3005</bold></highlight> mutually confirms the random numbers A and B. </paragraph>
<paragraph id="P-0465" lvl="0"><number>&lsqb;0465&rsqb;</number> The decoding decision card <highlight><bold>3001</bold></highlight> and the clock <highlight><bold>3005</bold></highlight> generate the transfer key KT from the random numbers A and B and the key generation information Kt held in them (steps S<highlight><bold>3005</bold></highlight> and S<highlight><bold>3006</bold></highlight>). The clock <highlight><bold>3005</bold></highlight> encrypts current time information using the generated transfer key KT (&lsqb;current time&rsqb; KT) and transfers it to the decoding decision card <highlight><bold>3001</bold></highlight> (step S<highlight><bold>3007</bold></highlight>). </paragraph>
<paragraph id="P-0466" lvl="0"><number>&lsqb;0466&rsqb;</number> The decoding decision card <highlight><bold>3001</bold></highlight> decodes the license information using the master key KM designated by the master key ID, decodes the &lsqb;current time&rsqb; KT transferred from the clock <highlight><bold>3005</bold></highlight> using the generated transfer key KT, and decades on the basis of the decoded license information and time information whether the contents information designated by the contents ID can be used, i.e., decoded (step S<highlight><bold>3008</bold></highlight>). If it is decided that decoding cannot be performed, processing is ended. </paragraph>
<paragraph id="P-0467" lvl="0"><number>&lsqb;0467&rsqb;</number> If it is decided that decoding can be performed (YES in step S<highlight><bold>3009</bold></highlight>), the decoding decision card <highlight><bold>3001</bold></highlight> generates the random number C on the basis of a predetermined algorithm and transfers it to the information reproduction section <highlight><bold>3004</bold></highlight> (step S<highlight><bold>3010</bold></highlight>). The information reproduction device <highlight><bold>3004</bold></highlight> also generates the random number D on the basis of a predetermined algorithm (step S<highlight><bold>3011</bold></highlight>). With this processing, the decoding decision card <highlight><bold>3001</bold></highlight> and the information reproduction section <highlight><bold>3004</bold></highlight> mutually confirm the random numbers C and D. </paragraph>
<paragraph id="P-0468" lvl="0"><number>&lsqb;0468&rsqb;</number> The decoding decision card <highlight><bold>3001</bold></highlight> and the information reproduction section <highlight><bold>3004</bold></highlight> generate a transfer key K&prime;T from the random numbers C and D and the key generation information K&prime;t held in them (steps S<highlight><bold>3012</bold></highlight> and S<highlight><bold>3013</bold></highlight>). The decoding decision card <highlight><bold>3001</bold></highlight> encrypts the contents key Kc contained in the license information using the generated transfer key K&prime;T (&lsqb;Kc&rsqb; K&prime;T) and transfers it to the information reproduction section <highlight><bold>3004</bold></highlight> (step S<highlight><bold>3014</bold></highlight>). </paragraph>
<paragraph id="P-0469" lvl="0"><number>&lsqb;0469&rsqb;</number> The media readout device <highlight><bold>3003</bold></highlight> reads out the &lsqb;contents&rsqb; Kc from the medium <highlight><bold>3002</bold></highlight> and transfers it to the information reproduction section <highlight><bold>3004</bold></highlight> (step S<highlight><bold>3015</bold></highlight>). </paragraph>
<paragraph id="P-0470" lvl="0"><number>&lsqb;0470&rsqb;</number> The information reproduction section <highlight><bold>3004</bold></highlight> decodes &lsqb;Kc&rsqb; K&prime;T using the generated transfer key K&prime;T and decodes the contents information using the resultant contents key Kc (step S<highlight><bold>3016</bold></highlight>). </paragraph>
<paragraph id="P-0471" lvl="7"><number>&lsqb;0471&rsqb;</number> (1-2) Decoding Decision Card </paragraph>
<paragraph id="P-0472" lvl="0"><number>&lsqb;0472&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 79</cross-reference> shows an arrangement of the decoding decision card <highlight><bold>3001</bold></highlight>. </paragraph>
<paragraph id="P-0473" lvl="0"><number>&lsqb;0473&rsqb;</number> A time transfer section <highlight><bold>3012</bold></highlight> receives time information counted by the clock <highlight><bold>3005</bold></highlight> incorporated in the information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 77</cross-reference> and transfers it to a decoding decision section <highlight><bold>3013</bold></highlight>. </paragraph>
<paragraph id="P-0474" lvl="0"><number>&lsqb;0474&rsqb;</number> A contents key transfer section <highlight><bold>3014</bold></highlight> performs an operation of transferring the contents key Kc to the information reproduction section <highlight><bold>3004</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 77</cross-reference> while protecting the contents key Kc. </paragraph>
<paragraph id="P-0475" lvl="0"><number>&lsqb;0475&rsqb;</number> A data transfer section <highlight><bold>3011</bold></highlight> is used to send/receive information other than the time information to be transferred from the clock <highlight><bold>3005</bold></highlight> and the contents key to be transferred to the information reproduction section <highlight><bold>3004</bold></highlight> to/from the media readout device <highlight><bold>3003</bold></highlight>, the information reproduction section <highlight><bold>3004</bold></highlight>, and the decoding decision card <highlight><bold>3001</bold></highlight>. </paragraph>
<paragraph id="P-0476" lvl="0"><number>&lsqb;0476&rsqb;</number> The time transfer section <highlight><bold>3012</bold></highlight> and the data transfer section <highlight><bold>3011</bold></highlight> are separately arranged to perform special processing such as data protection using a temporary key or time-out by the clock in accordance with time transfer. </paragraph>
<paragraph id="P-0477" lvl="0"><number>&lsqb;0477&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 80</cross-reference> is a flow chart showing details of the processing operation of the decoding decision card <highlight><bold>3001</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 79</cross-reference> until output of the contents information use enable/disable decision result. </paragraph>
<paragraph id="P-0478" lvl="0"><number>&lsqb;0478&rsqb;</number> The master key ID and &lsqb;license information&rsqb; KM transferred from the media readout device <highlight><bold>3003</bold></highlight> in step S<highlight><bold>3002</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 78</cross-reference> are input to the decoding decision section <highlight><bold>3013</bold></highlight> through the data transfer section <highlight><bold>3011</bold></highlight> (step S<highlight><bold>3021</bold></highlight>). The random number A transferred from the clock <highlight><bold>3005</bold></highlight> in step S<highlight><bold>3003</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 78</cross-reference> is input to the time transfer section <highlight><bold>3012</bold></highlight> (step S<highlight><bold>3022</bold></highlight>). Upon receiving the random number A, the time output section <highlight><bold>3022</bold></highlight> generates the random number B and generates the transfer key KT from the random number B and the random number A which has been received in advance (steps S<highlight><bold>3023</bold></highlight> and S<highlight><bold>3024</bold></highlight>). The random number B is transferred to the clock <highlight><bold>3005</bold></highlight> (step S<highlight><bold>3025</bold></highlight>). Simultaneously, the time output section <highlight><bold>3022</bold></highlight> starts to increment the clock counter (step S<highlight><bold>3026</bold></highlight>). </paragraph>
<paragraph id="P-0479" lvl="0"><number>&lsqb;0479&rsqb;</number> The &lsqb;current time&rsqb; KT transferred from the clock <highlight><bold>3005</bold></highlight> in step S<highlight><bold>3007</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 78</cross-reference> is input to the time output section <highlight><bold>3022</bold></highlight> (step S<highlight><bold>3027</bold></highlight>). If the counter value of the time output section <highlight><bold>3022</bold></highlight> exceeds a predetermined value Ct, processing is ended (step S<highlight><bold>3028</bold></highlight>). </paragraph>
<paragraph id="P-0480" lvl="0"><number>&lsqb;0480&rsqb;</number> The counter value Ct means the time-out time and is a predetermined positive integer. In this embodiment, the decoding decision card acquires the time information outside the decoding decision card <highlight><bold>3001</bold></highlight>. Therefore, it is important that the acquired time information is valid. For this purpose, the random numbers A and B are exchanged between the clock <highlight><bold>3005</bold></highlight> and the time transfer section <highlight><bold>3012</bold></highlight> of the decoding decision card <highlight><bold>3001</bold></highlight>, and the time information is encrypted using the key KT which is valid only once, and transferred. However, only with this processing, illicitness such as intended delay of time information transfer cannot be prevented. </paragraph>
<paragraph id="P-0481" lvl="0"><number>&lsqb;0481&rsqb;</number> To prevent illicitness of this type, the time transfer section <highlight><bold>3012</bold></highlight> stops processing unless the time information arrival time, i.e., time from output of the random number B from the time transfer section <highlight><bold>3012</bold></highlight> to arrival of the (encrypted) time information at the time transfer section <highlight><bold>3012</bold></highlight> is equal to or shorter than the predetermined time Ct. </paragraph>
<paragraph id="P-0482" lvl="0"><number>&lsqb;0482&rsqb;</number> If the &lsqb;current time&rsqb; KT is input within a predetermined period, the &lsqb;current time&rsqb; KT is decoded using the transfer key KT generated in advance to obtain time information (step S<highlight><bold>3029</bold></highlight>). The time information is transferred to the decoding decision section <highlight><bold>3013</bold></highlight>. The decoding decision section <highlight><bold>3013</bold></highlight> decides on the basis of the decoded license information and time information whether the contents information designated by the contents ID can be used, i.e., decoded (step S<highlight><bold>3031</bold></highlight>). If it is decided that the contents information cannot be decoded, processing is ended. </paragraph>
<paragraph id="P-0483" lvl="0"><number>&lsqb;0483&rsqb;</number> If it is decided that decoding is enabled (YES in step S<highlight><bold>3032</bold></highlight>), the decoding decision section <highlight><bold>3013</bold></highlight> outputs the contents key kc contained in the license information to the contents key transfer section <highlight><bold>3014</bold></highlight> (step S<highlight><bold>3033</bold></highlight>). </paragraph>
<paragraph id="P-0484" lvl="0"><number>&lsqb;0484&rsqb;</number> The contents key transfer section <highlight><bold>3014</bold></highlight> generates the random number C and transfers it to the information reproduction section <highlight><bold>3004</bold></highlight> (step S<highlight><bold>3034</bold></highlight>). When the random number D transferred from the information reproduction section <highlight><bold>3004</bold></highlight> is input to the contents key transfer section <highlight><bold>3014</bold></highlight> in step S<highlight><bold>3011</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 78</cross-reference>, the transfer key K&prime;T is generated from the random numbers D and C (steps S<highlight><bold>3035</bold></highlight> and S<highlight><bold>3036</bold></highlight>). The contents key transfer section <highlight><bold>3014</bold></highlight> encrypts the contents key Kc using the generated transfer key K&prime;T (&lsqb;Kc&rsqb; K&prime;T) and transfers it to the information reproduction device <highlight><bold>3004</bold></highlight> (step S<highlight><bold>3038</bold></highlight>). </paragraph>
<paragraph id="P-0485" lvl="7"><number>&lsqb;0485&rsqb;</number> (1-3) Time Transfer Section of Decoding Decision Card </paragraph>
<paragraph id="P-0486" lvl="0"><number>&lsqb;0486&rsqb;</number> The time transfer section <highlight><bold>3012</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 79</cross-reference> will be described next in more detail. <cross-reference target="DRAWINGS">FIG. 81</cross-reference> shows an arrangement of the time transfer section <highlight><bold>3012</bold></highlight> which has a verification section <highlight><bold>3021</bold></highlight>, a clock counter <highlight><bold>3023</bold></highlight>, and a time output section <highlight><bold>3022</bold></highlight>. </paragraph>
<paragraph id="P-0487" lvl="0"><number>&lsqb;0487&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 81</cross-reference>, the clock counter <highlight><bold>3023</bold></highlight> counts logic driving clocks. </paragraph>
<paragraph id="P-0488" lvl="0"><number>&lsqb;0488&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 82</cross-reference> shows an arrangement of the verification section <highlight><bold>3021</bold></highlight>. </paragraph>
<paragraph id="P-0489" lvl="0"><number>&lsqb;0489&rsqb;</number> In <cross-reference target="DRAWINGS">FIG. 82, a</cross-reference> secret key storage section <highlight><bold>3021</bold></highlight><highlight><italic>e </italic></highlight>holds the key generation information Kt. </paragraph>
<paragraph id="P-0490" lvl="0"><number>&lsqb;0490&rsqb;</number> A transfer key generation section <highlight><bold>3021</bold></highlight><highlight><italic>f </italic></highlight>generates the transfer key KT as a secret key from the random numbers A and B and the key generation information Kt using an appropriate algorithm. This algorithm is the same as the secret key generation algorithm used in a corresponding verification section of the clock <highlight><bold>3005</bold></highlight>, and therefore, the decoding decision card <highlight><bold>3001</bold></highlight> and the clock <highlight><bold>3005</bold></highlight> can share the transfer key KT. </paragraph>
<paragraph id="P-0491" lvl="0"><number>&lsqb;0491&rsqb;</number> An input/output section <highlight><bold>3021</bold></highlight><highlight><italic>a </italic></highlight>holds the predetermined counter value Ct and decides time-out with reference to the value of the clock counter <highlight><bold>3023</bold></highlight>. As the value Ct, the clock count necessary from reception of the random number B by the clock <highlight><bold>3005</bold></highlight> to transmission of encrypted time information is set with a certain margin for transfer. </paragraph>
<paragraph id="P-0492" lvl="0"><number>&lsqb;0492&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 83</cross-reference> is a flow chart for explaining the processing operation of the verification section shown in <cross-reference target="DRAWINGS">FIG. 82</cross-reference>. </paragraph>
<paragraph id="P-0493" lvl="0"><number>&lsqb;0493&rsqb;</number> The random number A input to the time transfer section <highlight><bold>3012</bold></highlight> in step S<highlight><bold>3022</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 80</cross-reference> is input to the input/output section <highlight><bold>3021</bold></highlight><highlight><italic>a </italic></highlight>of the verification section <highlight><bold>3021</bold></highlight> first (step S<highlight><bold>3041</bold></highlight>) and stored in a random number storage section <highlight><bold>3021</bold></highlight><highlight><italic>b </italic></highlight>(step S<highlight><bold>3042</bold></highlight>). Next, a random number generation section <highlight><bold>3021</bold></highlight><highlight><italic>c </italic></highlight>generates the random number B in accordance with a predetermined algorithm (step S<highlight><bold>3043</bold></highlight>) and stores it in a random number storage section <highlight><bold>3021</bold></highlight><highlight><italic>d </italic></highlight>and simultaneously transfers the random number B to the input/output section <highlight><bold>3021</bold></highlight><highlight><italic>a </italic></highlight>(step S<highlight><bold>3045</bold></highlight>). </paragraph>
<paragraph id="P-0494" lvl="0"><number>&lsqb;0494&rsqb;</number> The transfer key generation section <highlight><bold>3021</bold></highlight><highlight><italic>f </italic></highlight>reads out the random numbers A and B stored in the random number storage sections <highlight><bold>3021</bold></highlight><highlight><italic>b </italic></highlight>and <highlight><bold>3021</bold></highlight><highlight><italic>d</italic></highlight>, respectively, and the key generation information Kt stored in the secret key storage section <highlight><bold>3021</bold></highlight><highlight><italic>e </italic></highlight>to generate the transfer key KT (step S<highlight><bold>3046</bold></highlight>) and stores it in a transfer key storage section <highlight><bold>3021</bold></highlight><highlight><italic>g </italic></highlight>(step S<highlight><bold>3047</bold></highlight>). </paragraph>
<paragraph id="P-0495" lvl="0"><number>&lsqb;0495&rsqb;</number> The input/output section <highlight><bold>3021</bold></highlight><highlight><italic>a </italic></highlight>resets the clock counter <highlight><bold>3023</bold></highlight> and transfers the random number B to the clock <highlight><bold>3005</bold></highlight> (steps S<highlight><bold>3048</bold></highlight> and S<highlight><bold>3049</bold></highlight>). </paragraph>
<paragraph id="P-0496" lvl="0"><number>&lsqb;0496&rsqb;</number> The &lsqb;current time&rsqb; KT input to the time transfer section <highlight><bold>3012</bold></highlight> in step S<highlight><bold>3027</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 80</cross-reference> is input to the input/output section <highlight><bold>3021</bold></highlight><highlight><italic>a </italic></highlight>first (step S<highlight><bold>3050</bold></highlight>). The input/output section <highlight><bold>3021</bold></highlight><highlight><italic>a </italic></highlight>reads the counter value of the clock counter <highlight><bold>3023</bold></highlight> and compares it with the value Ct. If the counter value is equal to or smaller than the value Ct, the flow advances to step S<highlight><bold>3053</bold></highlight>. If the counter value exceeds the value Ct (timeout), processing is ended (steps S<highlight><bold>3051</bold></highlight> and S<highlight><bold>3052</bold></highlight>). </paragraph>
<paragraph id="P-0497" lvl="0"><number>&lsqb;0497&rsqb;</number> In step S<highlight><bold>3053</bold></highlight>, the &lsqb;current time&rsqb; KT is transferred to a decoder section <highlight><bold>3021</bold></highlight><highlight><italic>h</italic></highlight>. The decoder section <highlight><bold>3021</bold></highlight><highlight><italic>h </italic></highlight>reads out the transfer key KT from the transfer key storage section <highlight><bold>3021</bold></highlight><highlight><italic>g </italic></highlight>and decodes the &lsqb;current time&rsqb; KT using the transfer key KT, thereby obtaining current time information (steps S<highlight><bold>3053</bold></highlight> and S<highlight><bold>3054</bold></highlight>). </paragraph>
<paragraph id="P-0498" lvl="0"><number>&lsqb;0498&rsqb;</number> A data format confirmation section <highlight><bold>3021</bold></highlight><highlight><italic>i </italic></highlight>confirms the data format of the current time information (step S<highlight><bold>3055</bold></highlight>). For example, the current time information has a data format to be described below. </paragraph>
<paragraph id="P-0499" lvl="2"><number>&lsqb;0499&rsqb;</number> &ldquo;current time&rdquo;/current time/&ldquo;00000000&rdquo;</paragraph>
<paragraph id="P-0500" lvl="0"><number>&lsqb;0500&rsqb;</number> The current time expressed by a character string follows the character string &ldquo;current time&rdquo;. The last one-byte data &ldquo;0&rdquo; is a delimiter. The current time is assumed to be elapsed time from 0:00, Jan. 1, 1998 which is represented on the minute order. </paragraph>
<paragraph id="P-0501" lvl="0"><number>&lsqb;0501&rsqb;</number> The data format confirmation section <highlight><bold>3021</bold></highlight><highlight><italic>i </italic></highlight>outputs the current time information to the time output section <highlight><bold>3022</bold></highlight> only when the data format of the current time information satisfies the above-described predetermined format (step S<highlight><bold>3056</bold></highlight>). </paragraph>
<paragraph id="P-0502" lvl="0"><number>&lsqb;0502&rsqb;</number> The time output section <highlight><bold>3022</bold></highlight> outputs the time information to the decoding decision section <highlight><bold>3013</bold></highlight> (step S<highlight><bold>3030</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 80</cross-reference>). </paragraph>
<paragraph id="P-0503" lvl="0"><number>&lsqb;0503&rsqb;</number> To transfer the current time information, an encryption scheme using identical encryption and decoding keys (KT) is employed. However, the present invention is not limited to this, and transfer protection can be realized in the same arrangement and operation as described above even when different keys are used. </paragraph>
<paragraph id="P-0504" lvl="7"><number>&lsqb;0504&rsqb;</number> (1-4) Contents Key Transfer Section of Decoding Decision Section </paragraph>
<paragraph id="P-0505" lvl="0"><number>&lsqb;0505&rsqb;</number> The contents key transfer section <highlight><bold>3014</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 79</cross-reference> will be described next in more detail. <cross-reference target="DRAWINGS">FIG. 84</cross-reference> shows an arrangement of the contents key transfer section <highlight><bold>3014</bold></highlight> which has a verification section <highlight><bold>3031</bold></highlight> and a contents key input section <highlight><bold>3032</bold></highlight>. </paragraph>
<paragraph id="P-0506" lvl="0"><number>&lsqb;0506&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 85</cross-reference> shows an arrangement of the verification section <highlight><bold>3031</bold></highlight>. The processing operation of the verification section <highlight><bold>3031</bold></highlight> will be described with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 86</cross-reference>. </paragraph>
<paragraph id="P-0507" lvl="0"><number>&lsqb;0507&rsqb;</number> A random number generation section <highlight><bold>3031</bold></highlight><highlight><italic>c </italic></highlight>generates the random number C on the basis of a predetermined algorithm and stores it in a random number storage section <highlight><bold>3031</bold></highlight><highlight><italic>d </italic></highlight>(step S<highlight><bold>3061</bold></highlight>). At the same time, the random number generation section <highlight><bold>3031</bold></highlight><highlight><italic>c </italic></highlight>transfers the random number C to the information reproduction section <highlight><bold>3004</bold></highlight> through an input/output section <highlight><bold>3031</bold></highlight><highlight><italic>a </italic></highlight>(step S<highlight><bold>3062</bold></highlight>). </paragraph>
<paragraph id="P-0508" lvl="0"><number>&lsqb;0508&rsqb;</number> The random number D transferred from the information reproduction section <highlight><bold>3004</bold></highlight> is input through the input/output section <highlight><bold>3031</bold></highlight><highlight><italic>a </italic></highlight>and stored in a random number storage section <highlight><bold>3031</bold></highlight><highlight><italic>b </italic></highlight>(step S<highlight><bold>3064</bold></highlight>). </paragraph>
<paragraph id="P-0509" lvl="0"><number>&lsqb;0509&rsqb;</number> A transfer key generation section <highlight><bold>3031</bold></highlight><highlight><italic>f </italic></highlight>reads out the random numbers C and D which are stored in the random number storage sections <highlight><bold>3031</bold></highlight><highlight><italic>b </italic></highlight>and <highlight><bold>3031</bold></highlight><highlight><italic>d</italic></highlight>, respectively, and the key generation information K&prime;t stored in a secret key storage section <highlight><bold>3031</bold></highlight><highlight><italic>e </italic></highlight>to generate the transfer key K&prime;T and stores it in a transfer key storage section <highlight><bold>3031</bold></highlight><highlight><italic>g </italic></highlight>(steps S<highlight><bold>3065</bold></highlight> and S<highlight><bold>3066</bold></highlight>). </paragraph>
<paragraph id="P-0510" lvl="0"><number>&lsqb;0510&rsqb;</number> If the decoding decision section <highlight><bold>3013</bold></highlight> decides, in step S<highlight><bold>3032</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 80</cross-reference>, that decoding can be performed, the decoding decision section <highlight><bold>3013</bold></highlight> transfers the contents key Kc to the contents key transfer section <highlight><bold>3014</bold></highlight> (step S<highlight><bold>3033</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 80</cross-reference>). The contents key Kc is input to an encryption section <highlight><bold>3031</bold></highlight><highlight><italic>h </italic></highlight>shown in <cross-reference target="DRAWINGS">FIG. 85</cross-reference>. The encryption section <highlight><bold>3031</bold></highlight><highlight><italic>h </italic></highlight>reads out the transfer key K&prime;T from the transfer key storage section <highlight><bold>3031</bold></highlight><highlight><italic>g</italic></highlight>, encrypts the contents key Kc using the transfer key K&prime;T (&lsqb;Kc&rsqb; K&prime;T), and transfers the contents key Kc to the information reproduction section <highlight><bold>3004</bold></highlight> through the input/output section <highlight><bold>3031</bold></highlight><highlight><italic>a </italic></highlight>(step S<highlight><bold>3069</bold></highlight>). </paragraph>
<paragraph id="P-0511" lvl="7"><number>&lsqb;0511&rsqb;</number> (1-5) Clock </paragraph>
<paragraph id="P-0512" lvl="0"><number>&lsqb;0512&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 87</cross-reference> shows an arrangement of the clock <highlight><bold>3005</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 77</cross-reference>. The clock <highlight><bold>3005</bold></highlight> has a verification section <highlight><bold>3041</bold></highlight> and a clock counter <highlight><bold>3042</bold></highlight>. </paragraph>
<paragraph id="P-0513" lvl="0"><number>&lsqb;0513&rsqb;</number> The clock counter <highlight><bold>3042</bold></highlight> counts the time. </paragraph>
<paragraph id="P-0514" lvl="0"><number>&lsqb;0514&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 88</cross-reference> shows an arrangement of the verification section <highlight><bold>3041</bold></highlight> of the clock <highlight><bold>3005</bold></highlight>. The processing operation of the verification section <highlight><bold>3041</bold></highlight> will be described next with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 89</cross-reference>. </paragraph>
<paragraph id="P-0515" lvl="0"><number>&lsqb;0515&rsqb;</number> A random number generation section <highlight><bold>3041</bold></highlight><highlight><italic>c </italic></highlight>generates the random number A using a predetermined algorithm and stores it in a random number storage section <highlight><bold>3041</bold></highlight><highlight><italic>d </italic></highlight>(step S<highlight><bold>3071</bold></highlight>). Simultaneously, the random number generation section <highlight><bold>3041</bold></highlight><highlight><italic>c </italic></highlight>transfers the random number A to the decoding decision card <highlight><bold>3001</bold></highlight> through an input/output section <highlight><bold>3041</bold></highlight><highlight><italic>a </italic></highlight>(step S<highlight><bold>3072</bold></highlight>). </paragraph>
<paragraph id="P-0516" lvl="0"><number>&lsqb;0516&rsqb;</number> The random number B transferred from the decoding decision card <highlight><bold>3001</bold></highlight> is input to the input/output section <highlight><bold>3041</bold></highlight><highlight><italic>a </italic></highlight>and stored in a random number storage section <highlight><bold>3041</bold></highlight><highlight><italic>b </italic></highlight>(step S<highlight><bold>3073</bold></highlight>). </paragraph>
<paragraph id="P-0517" lvl="0"><number>&lsqb;0517&rsqb;</number> A transfer key generation section <highlight><bold>3041</bold></highlight><highlight><italic>f </italic></highlight>reads out the random numbers A and B which are stored in the random number storage sections <highlight><bold>3041</bold></highlight><highlight><italic>d </italic></highlight>and <highlight><bold>3041</bold></highlight><highlight><italic>b</italic></highlight>, respectively, and the key generation information K&prime;t from a secret key storage section <highlight><bold>3041</bold></highlight><highlight><italic>e </italic></highlight>to generate the transfer key K&prime;T and stores it in a transfer key storage section <highlight><bold>3041</bold></highlight><highlight><italic>g </italic></highlight>(steps S<highlight><bold>3074</bold></highlight> and S<highlight><bold>3075</bold></highlight>). </paragraph>
<paragraph id="P-0518" lvl="0"><number>&lsqb;0518&rsqb;</number> Current time information output from the clock counter <highlight><bold>3042</bold></highlight> is input to an encryption section <highlight><bold>3041</bold></highlight><highlight><italic>h </italic></highlight>(step S<highlight><bold>3076</bold></highlight>). </paragraph>
<paragraph id="P-0519" lvl="0"><number>&lsqb;0519&rsqb;</number> The encryption section <highlight><bold>3041</bold></highlight><highlight><italic>h </italic></highlight>reads out the transfer key K&prime;T from the transfer key storage section <highlight><bold>3041</bold></highlight><highlight><italic>g</italic></highlight>, encrypts the current time information using the transfer key K&prime;T (&lsqb;current time&rsqb; K&prime;T), and transfers it to the decoding decision card <highlight><bold>3001</bold></highlight> through the input/output section <highlight><bold>3041</bold></highlight><highlight><italic>a </italic></highlight>(steps S<highlight><bold>3077</bold></highlight> and S<highlight><bold>3078</bold></highlight>). </paragraph>
<paragraph id="P-0520" lvl="7"><number>&lsqb;0520&rsqb;</number> (1-6) Decoding Decision Section of Decoding Decision Card </paragraph>
<paragraph id="P-0521" lvl="0"><number>&lsqb;0521&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 90</cross-reference> shows an arrangement of the decoding decision section <highlight><bold>3013</bold></highlight> of the decoding decision card <highlight><bold>3001</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 79</cross-reference>. </paragraph>
<paragraph id="P-0522" lvl="0"><number>&lsqb;0522&rsqb;</number> The processing operation of the decoding decision section <highlight><bold>3013</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 90</cross-reference> will be described with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 91</cross-reference>. </paragraph>
<paragraph id="P-0523" lvl="0"><number>&lsqb;0523&rsqb;</number> The master key ID and &lsqb;license information&rsqb; KM transferred from the media readout device <highlight><bold>3003</bold></highlight> to the decoding decision card <highlight><bold>3001</bold></highlight> are input to a master key selection section <highlight><bold>3061</bold></highlight> and a decoder section <highlight><bold>3063</bold></highlight>, respectively (steps S<highlight><bold>3101</bold></highlight> and S<highlight><bold>3103</bold></highlight>). </paragraph>
<paragraph id="P-0524" lvl="0"><number>&lsqb;0524&rsqb;</number> The master key selection section <highlight><bold>3061</bold></highlight> searches a master key storage section <highlight><bold>3062</bold></highlight> for a decoding key corresponding to the master key ID and transfers it to the decoder section <highlight><bold>3063</bold></highlight> (step S<highlight><bold>3102</bold></highlight>). </paragraph>
<paragraph id="P-0525" lvl="0"><number>&lsqb;0525&rsqb;</number> The master key ID input to the master key selection section <highlight><bold>3061</bold></highlight> is used to designate a decoding key corresponding to the key for encrypting the &lsqb;license information&rsqb; KM. Unless a correct master key ID is obtained, the decoding key for decoding the license information cannot be selected. </paragraph>
<paragraph id="P-0526" lvl="0"><number>&lsqb;0526&rsqb;</number> The decoder section <highlight><bold>3063</bold></highlight> decodes the &lsqb;license information&rsqb; KM using the decoding key designated by the master key ID and transfers the resultant license information to a decision section <highlight><bold>3064</bold></highlight> (step S<highlight><bold>3105</bold></highlight>). </paragraph>
<paragraph id="P-0527" lvl="0"><number>&lsqb;0527&rsqb;</number> Current time information transferred from the clock <highlight><bold>3005</bold></highlight> to the time transfer section <highlight><bold>3012</bold></highlight> of the decoding decision card <highlight><bold>3001</bold></highlight> and decoded is input to the decision section <highlight><bold>3064</bold></highlight> through a time input section <highlight><bold>3065</bold></highlight> (steps S<highlight><bold>3106</bold></highlight> and S<highlight><bold>3107</bold></highlight>). </paragraph>
<paragraph id="P-0528" lvl="0"><number>&lsqb;0528&rsqb;</number> The decision section <highlight><bold>3064</bold></highlight> decides on the basis of the license information and current time information whether the contents information can be used, i.e., decoded and outputs the decision result to the data transfer section <highlight><bold>3011</bold></highlight> through a decision result output section <highlight><bold>3066</bold></highlight> (steps S<highlight><bold>3108</bold></highlight> to S<highlight><bold>3110</bold></highlight>). If it is decided that decoding is enabled, the contents key Kc contained in the license information is output to the contents key transfer section <highlight><bold>3014</bold></highlight> through a contents key output section <highlight><bold>3067</bold></highlight> (step S<highlight><bold>3111</bold></highlight>). </paragraph>
<paragraph id="P-0529" lvl="0"><number>&lsqb;0529&rsqb;</number> Decision processing of the decision section <highlight><bold>3064</bold></highlight> will be described. If the current time sent from the clock <highlight><bold>3005</bold></highlight> is earlier than the time when the license information has been recorded on the medium <highlight><bold>3002</bold></highlight>, this indicates that the current time delays from correct time. The license information recording time is recorded by the license server and can be substantially regarded as correct time. In this case, the decision flag of the decision section <highlight><bold>3064</bold></highlight> is cleared, and hereafter, all the decision results are &ldquo;use is disabled&rdquo;. To set the decision flag again to make the decision valid, a command from the clock <highlight><bold>3005</bold></highlight> is required. This command is sent to the decoding decision section <highlight><bold>3013</bold></highlight> through the time transfer section <highlight><bold>3012</bold></highlight> of the decoding decision card <highlight><bold>3001</bold></highlight>. Only a command from the authentic (verifiable) clock <highlight><bold>3005</bold></highlight> can set the decision flag again. The clock <highlight><bold>3005</bold></highlight> sets the decision flag again only when the time in the clock <highlight><bold>3005</bold></highlight> is set. </paragraph>
<paragraph id="P-0530" lvl="7"><number>&lsqb;0530&rsqb;</number> (1-7) Master Key </paragraph>
<paragraph id="P-0531" lvl="0"><number>&lsqb;0531&rsqb;</number> The mater key used to encrypt or decode license information will be described. In this case, both the encryption and decoding keys to be used to encrypt/decode the license information will be called master keys, and the encryption and decoding keys of the license information are not always identical. </paragraph>
<paragraph id="P-0532" lvl="0"><number>&lsqb;0532&rsqb;</number> The master key in the master key storage section <highlight><bold>3062</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 90</cross-reference> is stored in the following format together with the master key ID. </paragraph>
</section>
<section>
<heading lvl="1">Km(0), . . . , Km(999), (KP(1000), Ks(1000)), . . . , (KP(1499), Ks(1499)), (KP(1500), Ks(1500)), . . . , (KP(1599), Ks(1599)) </heading>
<paragraph id="P-0533" lvl="0"><number>&lsqb;0533&rsqb;</number> Thousand keys from Km(0) to Km(999) are predetermined secret keys for decoding. Keys from KP(1000) to KP(1599) are public keys for encrypting license information. Six hundred keys from Ks(1000) to Ks(1599) are secret keys for decoding license information in correspondence with KP(1000) to KP(1599), respectively. Keys KP(n) (1000&pound;n&lt;1600) will be called public master keys. </paragraph>
<paragraph id="P-0534" lvl="0"><number>&lsqb;0534&rsqb;</number> For the arbitrary integer n from 1000 to 1600 exclusive, the keys KP(n) and Ks(n) (1000&pound;n&lt;1600) are paired. That is, license information encrypted by KP(n) can be decoded by Ks(n). For each integer n from 1000 to 1600 exclusive, the pair (KP(n), Ks(n)) is occasionally generated by a master key generation section <highlight><bold>3069</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 90</cross-reference> on the basis of a random number generated by a random number generation section <highlight><bold>3068</bold></highlight>. This pair of keys changes depending on the decoding decision card, and even in the same decoding decision card, changes depending on the time period. </paragraph>
<paragraph id="P-0535" lvl="0"><number>&lsqb;0535&rsqb;</number> The public master key is used in the information distribution system shown in <cross-reference target="DRAWINGS">FIG. 76</cross-reference>, as will be described later. </paragraph>
<paragraph id="P-0536" lvl="0"><number>&lsqb;0536&rsqb;</number> Keys (KP(n), Ks(n)) (1500&pound;n&lt;1600) may be used when the valid period when the contents information can be used is shorter than, e.g., 100 hours. More specifically, the master key generation section <highlight><bold>3069</bold></highlight> generates a key pair every, e.g., one hour and sequentially records key pairs from n&equals;1500 to n&equals;1599. In accordance with the designated period, e.g., when the valid period is shorter than the longest period of 100 hours, (KP(1599), Ks(1599)) is recorded, and then (KP(1500), Ks(1500)) is overwritten, and this processing is repeated. </paragraph>
<paragraph id="P-0537" lvl="0"><number>&lsqb;0537&rsqb;</number> When such a master key (KP(n), Ks(n)) (1500&pound;n&lt;1600) is to be used, the latest key KP(n) is always used to encrypt license information. After the license information is recorded, the license information encrypted by the key KP(n) is decoded by the corresponding key Ks(n) within the longest period of 99 hours. However, when the time of 100 hours or more has elapsed, the key Ks(n) is lost (changed by overwrite), so this license information cannot be decoded anymore. With this arrangement, high security can be ensured. Even when a person reads the master key Ks(n) by some technique, this key is valid only for license information generated within a specific period of one hour. </paragraph>
<paragraph id="P-0538" lvl="0"><number>&lsqb;0538&rsqb;</number> As described above, the master key storage section <highlight><bold>3062</bold></highlight> holds three master keys with different natures (i.e., a secret key common to all decoding decision cards, a secret key unique to each decoding decision card, and a secret key to be updated every predetermined time for each decoding decision card), so the security and convenience can be customized. </paragraph>
<paragraph id="P-0539" lvl="0"><number>&lsqb;0539&rsqb;</number> License information encrypted using the encryption keys KM(0) to KM (999) corresponding to Km(0) to Km(999), respectively, can be used by any decoding decision card for decoding decision. However, if the contents of the decoding decision card are illicitly read, protection of the contents fails. </paragraph>
<paragraph id="P-0540" lvl="0"><number>&lsqb;0540&rsqb;</number> On the other hand, in a method using a public master key, the public master key must be sent to the server to update license information, and this increases the labor for the user. However, even when the contents of the decoding decision card are illicitly read, the failure of security affects only the specific decoding decision card. Especially, when the public master key of time change scheme as described above is used, the failure of security is also limited in terms of time. </paragraph>
<paragraph id="P-0541" lvl="7"><number>&lsqb;0541&rsqb;</number> (1-8) Information Reproduction Section </paragraph>
<paragraph id="P-0542" lvl="0"><number>&lsqb;0542&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 92</cross-reference> shows an arrangement of the information reproduction section <highlight><bold>3004</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 77</cross-reference>. The information reproduction section <highlight><bold>3004</bold></highlight> comprises a verification section <highlight><bold>3051</bold></highlight>, a decoder section <highlight><bold>3052</bold></highlight>, a decoder <highlight><bold>3053</bold></highlight>, and a D/A converter <highlight><bold>3054</bold></highlight>. </paragraph>
<paragraph id="P-0543" lvl="0"><number>&lsqb;0543&rsqb;</number> The processing operation of the information reproduction section <highlight><bold>3004</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 92</cross-reference> will be described with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 93</cross-reference>. The information reproduction section <highlight><bold>3004</bold></highlight> reproduces, e.g., a MPEG2 motion picture. </paragraph>
<paragraph id="P-0544" lvl="0"><number>&lsqb;0544&rsqb;</number> The encrypted contents key &lsqb;Kc&rsqb; K&prime;T transferred from the decoding decision card <highlight><bold>3001</bold></highlight> is input to the verification section <highlight><bold>3051</bold></highlight> of the information reproduction section <highlight><bold>3004</bold></highlight>. The verification section <highlight><bold>3051</bold></highlight> decodes &lsqb;Kc&rsqb; k&prime;T using the transfer key K&prime;T generated by the verification section <highlight><bold>3051</bold></highlight> itself to obtain the contents key Kc (step S<highlight><bold>3081</bold></highlight>). </paragraph>
<paragraph id="P-0545" lvl="0"><number>&lsqb;0545&rsqb;</number> On the other hand, contents information encrypted using the contents key Kc read from the medium <highlight><bold>3002</bold></highlight> by the media readout device <highlight><bold>3003</bold></highlight> is input to the decoder section <highlight><bold>3052</bold></highlight>. The decoder section <highlight><bold>3052</bold></highlight> decodes the contents information using the contents key Kc and outputs it to the decoder <highlight><bold>3053</bold></highlight> (step S<highlight><bold>3082</bold></highlight>). </paragraph>
<paragraph id="P-0546" lvl="0"><number>&lsqb;0546&rsqb;</number> The decoder <highlight><bold>3053</bold></highlight> reconstructs coding which has been done for compression, and sends the resultant image data to the D/A converter <highlight><bold>3054</bold></highlight> (step S<highlight><bold>3083</bold></highlight>). </paragraph>
<paragraph id="P-0547" lvl="0"><number>&lsqb;0547&rsqb;</number> The D/A converter <highlight><bold>3054</bold></highlight> converts the data into an analog signal and outputs the signal to a predetermined display device (step S<highlight><bold>3085</bold></highlight>). </paragraph>
<paragraph id="P-0548" lvl="0"><number>&lsqb;0548&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 94</cross-reference> shows an arrangement of the verification section <highlight><bold>3051</bold></highlight> of the information reproduction section <highlight><bold>3004</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 92</cross-reference>. The processing operation of the verification section <highlight><bold>3051</bold></highlight> will be described with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 95</cross-reference>. </paragraph>
<paragraph id="P-0549" lvl="0"><number>&lsqb;0549&rsqb;</number> A random number C transferred from the decoding decision card <highlight><bold>3001</bold></highlight> to the information reproduction section <highlight><bold>3004</bold></highlight> is input to an input/output section <highlight><bold>3051</bold></highlight><highlight><italic>a </italic></highlight>of the verification section <highlight><bold>3051</bold></highlight> and stored in a random number storage section <highlight><bold>3051</bold></highlight><highlight><italic>b </italic></highlight>(step S<highlight><bold>3091</bold></highlight>). </paragraph>
<paragraph id="P-0550" lvl="0"><number>&lsqb;0550&rsqb;</number> A random number generation section <highlight><bold>3051</bold></highlight><highlight><italic>c </italic></highlight>generates the random number D and stores it in a random number storage section <highlight><bold>3051</bold></highlight><highlight><italic>d </italic></highlight>(step S<highlight><bold>3092</bold></highlight>). </paragraph>
<paragraph id="P-0551" lvl="0"><number>&lsqb;0551&rsqb;</number> A transfer key generation section <highlight><bold>3051</bold></highlight><highlight><italic>f </italic></highlight>reads out the random numbers C and D from the random number storage sections <highlight><bold>3051</bold></highlight><highlight><italic>b </italic></highlight>and <highlight><bold>3051</bold></highlight><highlight><italic>d</italic></highlight>, respectively, and also reads out the key generation information K&prime;t from a secret key storage section <highlight><bold>3051</bold></highlight><highlight><italic>e </italic></highlight>to generate the transfer key K&prime;T (step S<highlight><bold>3093</bold></highlight>). The generated transfer key K&prime;T is stored in a transfer key storage section <highlight><bold>3051</bold></highlight><highlight><italic>g </italic></highlight>(step S<highlight><bold>3094</bold></highlight>). </paragraph>
<paragraph id="P-0552" lvl="0"><number>&lsqb;0552&rsqb;</number> The random number D stored in the random number storage section <highlight><bold>3051</bold></highlight><highlight><italic>d </italic></highlight>is transferred to the decoding decision card <highlight><bold>3001</bold></highlight> through the input/output section <highlight><bold>3051</bold></highlight><highlight><italic>a </italic></highlight>(step S<highlight><bold>3095</bold></highlight>). </paragraph>
<paragraph id="P-0553" lvl="0"><number>&lsqb;0553&rsqb;</number> The encrypted contents key &lsqb;Kc&rsqb; K&prime;T transferred from the decoding decision card <highlight><bold>3001</bold></highlight> to the information reproduction section <highlight><bold>3004</bold></highlight> is input to the input/output section <highlight><bold>3051</bold></highlight><highlight><italic>a </italic></highlight>of the verification section <highlight><bold>3051</bold></highlight>. The contents key &lsqb;Kc&rsqb; K&prime;T is output to a decoder section <highlight><bold>3051</bold></highlight><highlight><italic>h </italic></highlight>(step S<highlight><bold>3096</bold></highlight>). </paragraph>
<paragraph id="P-0554" lvl="0"><number>&lsqb;0554&rsqb;</number> The decoder section <highlight><bold>3051</bold></highlight><highlight><italic>h </italic></highlight>reads out the transfer key K&prime;T from the transfer key storage section <highlight><bold>3051</bold></highlight><highlight><italic>g </italic></highlight>to decode &lsqb;Kc&rsqb; K&prime;T, thereby obtaining the contents key Kc (step S<highlight><bold>3097</bold></highlight>). The contents key Kc is output to the decoder section <highlight><bold>3052</bold></highlight> in the information reproduction section <highlight><bold>3004</bold></highlight> (step S<highlight><bold>3098</bold></highlight>). </paragraph>
<paragraph id="P-0555" lvl="7"><number>&lsqb;0555&rsqb;</number> (1-9) Another Information Reproduction Section </paragraph>
<paragraph id="P-0556" lvl="0"><number>&lsqb;0556&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 96</cross-reference> shows another arrangement of the information reproduction section <highlight><bold>3004</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 77</cross-reference>. In this case, the contents information of an accounting object is a program. The contents information of the accounting object is at least partially encrypted using the contents key Kc, and the contents key Kc is contained in license information. </paragraph>
<paragraph id="P-0557" lvl="0"><number>&lsqb;0557&rsqb;</number> The same reference numerals as in <cross-reference target="DRAWINGS">FIG. 92</cross-reference> denote the same parts in <cross-reference target="DRAWINGS">FIG. 96</cross-reference>, and only different portions will be described. In <cross-reference target="DRAWINGS">FIG. 96</cross-reference>, the decoder <highlight><bold>3053</bold></highlight> and the D/A converter <highlight><bold>3054</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 92</cross-reference> are replaced with a program execution section <highlight><bold>3055</bold></highlight>, so that the program as the contents information is executed by the program execution section <highlight><bold>3055</bold></highlight>. </paragraph>
<paragraph id="P-0558" lvl="0"><number>&lsqb;0558&rsqb;</number> The operation until the contents key Kc and the encrypted contents information are sent to the information reproduction section <highlight><bold>3004</bold></highlight> is the same as described above. </paragraph>
<paragraph id="P-0559" lvl="0"><number>&lsqb;0559&rsqb;</number> In this case, the information reproduction section <highlight><bold>3004</bold></highlight> may be a central processing unit constituted by a CPU, a memory, and the like. </paragraph>
<paragraph id="P-0560" lvl="7"><number>&lsqb;0560&rsqb;</number> (1-10) </paragraph>
<paragraph id="P-0561" lvl="0"><number>&lsqb;0561&rsqb;</number> In (1-1) to (1-9), the information reproducing apparatus has the clock <highlight><bold>3005</bold></highlight>, as shown in <cross-reference target="DRAWINGS">FIG. 77</cross-reference>. The decoding decision card <highlight><bold>3001</bold></highlight> itself may incorporate a clock, as a matter of course. In this case, the decoding decision card <highlight><bold>3001</bold></highlight> incorporates a battery for driving the clock. When the clock is incorporated in the decoding decision card <highlight><bold>3001</bold></highlight>, the time transfer section <highlight><bold>3012</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 79</cross-reference> and verification processing for the clock can be omitted. </paragraph>
<paragraph id="P-0562" lvl="7"><number>&lsqb;0562&rsqb;</number> (2) Information Distribution System in <cross-reference target="DRAWINGS">FIG. 76</cross-reference> </paragraph>
<paragraph id="P-0563" lvl="0"><number>&lsqb;0563&rsqb;</number> The arrangement and processing operation of an information reproducing apparatus for this information distribution system are almost the same as those in <cross-reference target="DRAWINGS">FIG. 75</cross-reference>. </paragraph>
<paragraph id="P-0564" lvl="0"><number>&lsqb;0564&rsqb;</number> In the information distribution system shown in <cross-reference target="DRAWINGS">FIG. 76</cross-reference>, not license information but a contents ID and encrypted contents information are recorded on the removable information storage medium in the initial state. When the license is to be updated, the medium and the decoding decision card are set in the license update terminal. The update terminal reads the contents ID from the medium and one of the public master keys from the decoding decision card and transfers them to the license server. The license server having a database of contents to be handled searches the database for a contents key using the contents ID as a key. </paragraph>
<paragraph id="P-0565" lvl="0"><number>&lsqb;0565&rsqb;</number> Subsequently, the license server prepares normal license information containing the contents key, encrypts the license information using the public master key, and transfers it to the update terminal. The update terminal records the received encrypted license information on the medium. Reproduction for the medium after the license information is recorded is the same as that in the information distribution system shown in <cross-reference target="DRAWINGS">FIG. 75</cross-reference>. </paragraph>
<paragraph id="P-0566" lvl="0"><number>&lsqb;0566&rsqb;</number> The license update terminal and license server in the information distribution system shown in <cross-reference target="DRAWINGS">FIG. 76</cross-reference> will be described next in more detail. </paragraph>
<paragraph id="P-0567" lvl="7"><number>&lsqb;0567&rsqb;</number> (2-1) License Update Terminal </paragraph>
<paragraph id="P-0568" lvl="0"><number>&lsqb;0568&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 97</cross-reference> shows an arrangement of the license update terminal. </paragraph>
<paragraph id="P-0569" lvl="0"><number>&lsqb;0569&rsqb;</number> A license update terminal <highlight><bold>4000</bold></highlight> comprises a card interface (IF) <highlight><bold>4001</bold></highlight> for reading predetermined information from an inserted decoding decision card, a removable information storage medium drive <highlight><bold>4002</bold></highlight> for reading out predetermined information from an inserted removable information storage medium, a communication section <highlight><bold>4003</bold></highlight> for performing communication with the license server through a predetermined communication line (e.g., a public line or a leased line), a display section <highlight><bold>4004</bold></highlight> constituted by, e.g., a liquid crystal display panel, and a key input section <highlight><bold>4005</bold></highlight> constituted by a keyboard or touch panel for inputting an instruction from the user. </paragraph>
<paragraph id="P-0570" lvl="0"><number>&lsqb;0570&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 98</cross-reference> is a flow chart showing the processing operation of the license update terminal <highlight><bold>4000</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 97</cross-reference>. The processing operation of the license update terminal will be described below with reference to <cross-reference target="DRAWINGS">FIG. 98</cross-reference>. </paragraph>
<paragraph id="P-0571" lvl="0"><number>&lsqb;0571&rsqb;</number> When the removable information storage medium is set in the removable information storage medium drive <highlight><bold>4002</bold></highlight>, the identification information, i.e., the contents ID of the contents information recorded on the medium is read from the medium (step S<highlight><bold>4001</bold></highlight>), and the read contents ID and the identification information (update terminal ID) of the license update terminal are transmitted to the license server through the communication section <highlight><bold>4003</bold></highlight> (step S<highlight><bold>4002</bold></highlight>). </paragraph>
<paragraph id="P-0572" lvl="0"><number>&lsqb;0572&rsqb;</number> The update terminal ID transmitted from the license update terminal to the license server is stored by the license server together with updated information as an update log. The contents fee may be collected on the basis of the update log. </paragraph>
<paragraph id="P-0573" lvl="0"><number>&lsqb;0573&rsqb;</number> Upon receiving the contents ID and update terminal ID, the license server transmits an accounting menu, request key type information, and a verification key number N to the update terminal (step S<highlight><bold>4003</bold></highlight>). </paragraph>
<paragraph id="P-0574" lvl="0"><number>&lsqb;0574&rsqb;</number> The request key type information sent from the license server to the update terminal is used to designate the master keys of three types. As described above, the request key types are as follows. </paragraph>
<paragraph id="P-0575" lvl="2"><number>&lsqb;0575&rsqb;</number> When the request key type information is &ldquo;0&rdquo;, a predetermined master key for decoding, i.e., one of Km(0) to Km(999) is designated. </paragraph>
<paragraph id="P-0576" lvl="2"><number>&lsqb;0576&rsqb;</number> When the request key type information is &ldquo;1&rdquo;, a master key unique to each decoding decision card for decoding license information, i.e., one of KP(1000) to KP(1499) is designated. </paragraph>
<paragraph id="P-0577" lvl="2"><number>&lsqb;0577&rsqb;</number> When the request key type information is 2&rdquo;, a secret key to be updated every predetermined time for each decoding decision card, i.e., one of KP(1500) to KP(1599) is designated. </paragraph>
<paragraph id="P-0578" lvl="0"><number>&lsqb;0578&rsqb;</number> The verification key number N sent from the license server to the license update terminal is a number for designating a key KN which is held in the decoding decision card for verification in transfer. The master key KP encrypted by the key KN is decoded by a decoding key K&prime;N held in the license server and corresponding to the key KN. The license server encrypts the license information using the key KP obtained in this manner and transmits the license information to the license update terminal. If the decoding decision card does not hold the correct verification key KN (e.g., when an improper device is to operate as the decoding decision card), the license information recorded on the removable information storage medium cannot be decoded using the decoding key Ks corresponding to the key KP. For this reason, the unauthentic decoding decision card is eliminated. </paragraph>
<paragraph id="P-0579" lvl="0"><number>&lsqb;0579&rsqb;</number> The accounting menu is a fee table corresponding to the valid period of the contents information. A desired period is selected from this accounting menu, and the fee is paid. The accounting menu has, e.g., a fee corresponding to a valid period, and an identification number for selecting the valid period. More specifically, when the valid period is seven days, the fee is 200 yen, and the identification number is &ldquo;1&rdquo;. For 30 days, the fee is 500 yen, and the identification number is &ldquo;2&rdquo;. For an indefinite period (conveyance), the fee is 3,000 yen, and the identification number is &ldquo;3&rdquo;. </paragraph>
<paragraph id="P-0580" lvl="0"><number>&lsqb;0580&rsqb;</number> When the request key type information is &ldquo;0&rdquo;, the license update terminal need not send the master key KP to the license server. This is because the license information is encrypted by a key common to all decoding decision cards and sent to the license server. In this case, the license information sent from the server contains designation of the number of Km. This number need not be encrypted. </paragraph>
<paragraph id="P-0581" lvl="0"><number>&lsqb;0581&rsqb;</number> If the communication line between the update terminal and the license server is not a leased line, as a measure for information security, a procedure of mutual verification is preferably performed before communication between a communication section <highlight><bold>4021</bold></highlight> of the license server and the communication section <highlight><bold>4003</bold></highlight> of the update terminal. In this case, charging for license update is performed in a shop having the license update terminal. Unless unauthentic license update terminals are eliminated, illicit charging may take place. In addition, connection to a license server which is not authentic for the organizer of the license update terminal may cause charging for illicit license information for the user. </paragraph>
<paragraph id="P-0582" lvl="0"><number>&lsqb;0582&rsqb;</number> If the communication line is a leased line, and the communication partner is reliable, mutual verification is not required. The communication section <highlight><bold>4003</bold></highlight> of a license update terminal which uses a public line such as the Internet for connection from the license update terminal to the license server may store the record of communication with the license server. The fee is collected on the basis of the record of the license server, so it is preferable that the record be stored on the license update terminal side as well for confirmation. </paragraph>
<paragraph id="P-0583" lvl="0"><number>&lsqb;0583&rsqb;</number> The communication section <highlight><bold>4003</bold></highlight> of the license update terminal transfers, of pieces of information transmitted from the license server, the accounting menu to the display section <highlight><bold>4004</bold></highlight> and the request key identification information and verification key number N to the card IF <highlight><bold>4001</bold></highlight> (step S<highlight><bold>4004</bold></highlight>). </paragraph>
<paragraph id="P-0584" lvl="0"><number>&lsqb;0584&rsqb;</number> The display section <highlight><bold>4004</bold></highlight> presents the accounting menu to prompt the user to select the identification number of period. The card IF <highlight><bold>4001</bold></highlight> transfers the request key identification information and verification key number to the decoding decision card. Upon receiving these pieces of information, the decoding decision card transfers one of the master keys KP (an appropriate one of the plurality of keys KP) corresponding to the request key identification information, which is encrypted using the verification key KN designated by the verification key number, i.e., &lsqb;KP&rsqb; KN to the card IF <highlight><bold>4001</bold></highlight>. At this time, the master key identification information may be simultaneously transferred. </paragraph>
<paragraph id="P-0585" lvl="0"><number>&lsqb;0585&rsqb;</number> The communication section <highlight><bold>4003</bold></highlight> transmits &lsqb;KP&rsqb; KN transferred from the card IF and the identification number of the valid period in the accounting menu, which is designated by the user through the display section <highlight><bold>4004</bold></highlight>, to the license server (steps S<highlight><bold>4005</bold></highlight> to S<highlight><bold>4007</bold></highlight>). </paragraph>
<paragraph id="P-0586" lvl="0"><number>&lsqb;0586&rsqb;</number> Accordingly, the license server transmits license information which is encrypted using the master key KP supplied from the update terminal, i.e., &lsqb;license information&rsqb; KP to the communication section <highlight><bold>4003</bold></highlight> of the update terminal (step S<highlight><bold>4008</bold></highlight>). </paragraph>
<paragraph id="P-0587" lvl="0"><number>&lsqb;0587&rsqb;</number> The &lsqb;license information&rsqb; KP is recorded on the medium set in the removable information storage medium drive <highlight><bold>4002</bold></highlight> (step S<highlight><bold>4009</bold></highlight>). Note that the &lsqb;license information&rsqb; KP sent from the license server and the master key identification information may be recorded on the medium. </paragraph>
<paragraph id="P-0588" lvl="7"><number>&lsqb;0588&rsqb;</number> (2-2) Decoding Decision Card </paragraph>
<paragraph id="P-0589" lvl="0"><number>&lsqb;0589&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 99</cross-reference> shows an arrangement of the main part of the decoding decision card <highlight><bold>3001</bold></highlight>, i.e., an update interface (IF) <highlight><bold>3015</bold></highlight>. </paragraph>
<paragraph id="P-0590" lvl="0"><number>&lsqb;0590&rsqb;</number> The processing operations of various portions shown in <cross-reference target="DRAWINGS">FIG. 99</cross-reference> will be described below with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 100</cross-reference>. </paragraph>
<paragraph id="P-0591" lvl="0"><number>&lsqb;0591&rsqb;</number> The request key identification information and verification key number N transferred from the card IF <highlight><bold>4001</bold></highlight> of the update terminal to the decoding decision card <highlight><bold>3001</bold></highlight> in step S<highlight><bold>4004</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 98</cross-reference> are input to an input/output section <highlight><bold>4011</bold></highlight> (step S<highlight><bold>4011</bold></highlight>). </paragraph>
<paragraph id="P-0592" lvl="0"><number>&lsqb;0592&rsqb;</number> The input/output section <highlight><bold>4011</bold></highlight> transfers the request key identification information to the master key selection section <highlight><bold>3061</bold></highlight> and the verification key number N to a verification key selection section <highlight><bold>4014</bold></highlight> (step S<highlight><bold>4012</bold></highlight>). </paragraph>
<paragraph id="P-0593" lvl="0"><number>&lsqb;0593&rsqb;</number> The master key selection section <highlight><bold>3061</bold></highlight> searches the master key storage section <highlight><bold>3062</bold></highlight> to select the master key KP corresponding to the request key identification information and transfers it to an encryption section <highlight><bold>4012</bold></highlight> (step S<highlight><bold>4013</bold></highlight>). </paragraph>
<paragraph id="P-0594" lvl="0"><number>&lsqb;0594&rsqb;</number> The verification key selection section <highlight><bold>4014</bold></highlight> searches a verification key storage section <highlight><bold>4013</bold></highlight> to select the verification key KN having the verification key number N and transfers it to the encryption section <highlight><bold>4012</bold></highlight> (step S<highlight><bold>4014</bold></highlight>). </paragraph>
<paragraph id="P-0595" lvl="0"><number>&lsqb;0595&rsqb;</number> The encryption section <highlight><bold>4012</bold></highlight> encrypts the master key KP using the verification key KN to generate &lsqb;KPJ KN (step S<highlight><bold>4015</bold></highlight>). The &lsqb;KP&rsqb; KN is output to the license update device through the input/output section <highlight><bold>4011</bold></highlight> (step S<highlight><bold>4016</bold></highlight>). </paragraph>
<paragraph id="P-0596" lvl="7"><number>&lsqb;0596&rsqb;</number> (2-3) License Server </paragraph>
<paragraph id="P-0597" lvl="0"><number>&lsqb;0597&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 101</cross-reference> shows an arrangement of the license server. A contents information database (DB) <highlight><bold>4024</bold></highlight> stores the following information in correspondence with a contents ID. </paragraph>
<paragraph id="P-0598" lvl="2"><number>&lsqb;0598&rsqb;</number> Contents key </paragraph>
<paragraph id="P-0599" lvl="2"><number>&lsqb;0599&rsqb;</number> Accounting menu </paragraph>
<paragraph id="P-0600" lvl="2"><number>&lsqb;0600&rsqb;</number> Request key type </paragraph>
<paragraph id="P-0601" lvl="0"><number>&lsqb;0601&rsqb;</number> The processing operations of various portions of the license server <highlight><bold>4001</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 101</cross-reference> will be described below with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 102</cross-reference>. </paragraph>
<paragraph id="P-0602" lvl="0"><number>&lsqb;0602&rsqb;</number> The contents ID and update terminal ID transmitted from the license update terminal in step S<highlight><bold>4002</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 98</cross-reference> are received by the communication section <highlight><bold>4021</bold></highlight> and transferred to a response section <highlight><bold>4022</bold></highlight> (step S<highlight><bold>4021</bold></highlight>). </paragraph>
<paragraph id="P-0603" lvl="0"><number>&lsqb;0603&rsqb;</number> The response section <highlight><bold>4022</bold></highlight> transfers the contents ID to a contents information retrieval section <highlight><bold>4023</bold></highlight> (step S<highlight><bold>4022</bold></highlight>). The contents information retrieval section <highlight><bold>4023</bold></highlight> reads out a contents key, an accounting menu, and a request key type corresponding to the contents ID and transfers them to the response section <highlight><bold>4022</bold></highlight> (step S<highlight><bold>4023</bold></highlight>). </paragraph>
<paragraph id="P-0604" lvl="0"><number>&lsqb;0604&rsqb;</number> The response section <highlight><bold>4022</bold></highlight> generates the verification key number N (step S<highlight><bold>4024</bold></highlight>). For example, one of a plurality of predetermined verification key numbers may be selected. Information other than the contents key, i.e., the accounting menu, the request key type information, and the verification key number N are transmitted to the license update terminal through the communication section <highlight><bold>4021</bold></highlight> (step S<highlight><bold>4025</bold></highlight>). </paragraph>
<paragraph id="P-0605" lvl="0"><number>&lsqb;0605&rsqb;</number> The &lsqb;KP&rsqb; KN and the identification number of the desired valid period in the accounting menu, which are transmitted from the update terminal in step S<highlight><bold>4007</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 98</cross-reference>, are received by the communication section <highlight><bold>4021</bold></highlight> and transferred to the response section <highlight><bold>4022</bold></highlight> (step S<highlight><bold>4026</bold></highlight>). </paragraph>
<paragraph id="P-0606" lvl="0"><number>&lsqb;0606&rsqb;</number> The response section <highlight><bold>4022</bold></highlight> decodes the &lsqb;KP&rsqb; KN using a decoding key KN&prime; corresponding to the verification key number N, which has been previously generated, to obtain the master key KP (step S<highlight><bold>4027</bold></highlight>). </paragraph>
<paragraph id="P-0607" lvl="0"><number>&lsqb;0607&rsqb;</number> The license information generated by the response section <highlight><bold>4022</bold></highlight> is encrypted by an encryption section <highlight><bold>4025</bold></highlight> using the master key KP (&lsqb;license information&rsqb; KP is generated). The &lsqb;license information&rsqb; KP is transmitted to the license update device through the communication section <highlight><bold>4021</bold></highlight> (steps S<highlight><bold>4028</bold></highlight> and S<highlight><bold>4029</bold></highlight>). </paragraph>
<paragraph id="P-0608" lvl="0"><number>&lsqb;0608&rsqb;</number> The response section <highlight><bold>4022</bold></highlight> records, in an update record database (DB) <highlight><bold>4026</bold></highlight>, the license update history information in correspondence with the update terminal ID received in step S<highlight><bold>4021</bold></highlight> (step S<highlight><bold>4030</bold></highlight>). </paragraph>
<paragraph id="P-0609" lvl="7"><number>&lsqb;0609&rsqb;</number> (3) Information Distribution System in Which License is Updated Using Electronic Banking from User Terminal </paragraph>
<paragraph id="P-0610" lvl="0"><number>&lsqb;0610&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 103</cross-reference> shows an example of a system configuration comprising a user terminal, a license server <highlight><bold>4101</bold></highlight>, and an electronic banking device <highlight><bold>4102</bold></highlight>, which is used to update the license using electronic banking. The user terminal performs accounting processing using electronic banking through a network. </paragraph>
<paragraph id="P-0611" lvl="0"><number>&lsqb;0611&rsqb;</number> The user terminal has at least a license update device <highlight><bold>4103</bold></highlight> and may be constituted by, e.g., a personal computer in which the decoding decision card <highlight><bold>3001</bold></highlight> and a removable information storage medium <highlight><bold>4031</bold></highlight> are inserted. </paragraph>
<paragraph id="P-0612" lvl="0"><number>&lsqb;0612&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 104</cross-reference> shows an arrangement of the license update device <highlight><bold>4103</bold></highlight> incorporated in the user terminal. A control section <highlight><bold>4044</bold></highlight> constituted by, e.g., a CPU controls a communication section <highlight><bold>4041</bold></highlight>, a removable information recording medium IF <highlight><bold>4042</bold></highlight>, a decoding decision card IF <highlight><bold>4043</bold></highlight>, a display section <highlight><bold>4045</bold></highlight>, and an input section <highlight><bold>4046</bold></highlight> to execute processing of updating the license. </paragraph>
<paragraph id="P-0613" lvl="0"><number>&lsqb;0613&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 105</cross-reference> shows an arrangement of the license server <highlight><bold>4101</bold></highlight> in which a control section <highlight><bold>4053</bold></highlight> controls a communication section <highlight><bold>4051</bold></highlight>, a decoder section <highlight><bold>4052</bold></highlight>, an accounting reference number issue section <highlight><bold>4054</bold></highlight>, an accounting processing section <highlight><bold>4055</bold></highlight>, and a license information generation section <highlight><bold>4056</bold></highlight> to execute processing of updating the license. </paragraph>
<paragraph id="P-0614" lvl="0"><number>&lsqb;0614&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 106</cross-reference> is a flow chart showing the processing operation of the entire system shown in <cross-reference target="DRAWINGS">FIG. 103</cross-reference> when license information is encrypted using a master key (e.g., one of Km(0) to Km(999)) common to all license decision cards (i.e., all user terminals). </paragraph>
<paragraph id="P-0615" lvl="0"><number>&lsqb;0615&rsqb;</number> The processing operations of various portions of the license update device <highlight><bold>4103</bold></highlight> and the license server <highlight><bold>4101</bold></highlight> will be described with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 106</cross-reference>. </paragraph>
<paragraph id="P-0616" lvl="0"><number>&lsqb;0616&rsqb;</number> Note that contents information and license information are recorded on the medium <highlight><bold>4031</bold></highlight>, and the license information contains a license condition for deciding the use enable/disable of the contents information, a contents ID, and other information. </paragraph>
<paragraph id="P-0617" lvl="0"><number>&lsqb;0617&rsqb;</number> The removable information recording medium interface (IF) <highlight><bold>4042</bold></highlight> of the license update device <highlight><bold>4103</bold></highlight> reads license information from the medium set in the user terminal and outputs it to the decoding decision card <highlight><bold>3001</bold></highlight> through the decoding decision card interface (IF) <highlight><bold>4043</bold></highlight> (step S<highlight><bold>4041</bold></highlight>). </paragraph>
<paragraph id="P-0618" lvl="0"><number>&lsqb;0618&rsqb;</number> The decoding decision card <highlight><bold>3001</bold></highlight> performs predetermined processing (e.g., the processing operation of the decoder unit A described in the second embodiment) on the basis of the input license information. As a result, when the license is to be updated, the decoding decision card <highlight><bold>3001</bold></highlight> outputs license update information (e.g., for the decoder unit A, the updated information as shown in <cross-reference target="DRAWINGS">FIG. 56</cross-reference>). </paragraph>
<paragraph id="P-0619" lvl="0"><number>&lsqb;0619&rsqb;</number> The decoding decision card IF <highlight><bold>4043</bold></highlight> reads the license server ID from the decoding decision card <highlight><bold>3001</bold></highlight> (step S<highlight><bold>4042</bold></highlight>). The license server ID may be contained in the updated information. </paragraph>
<paragraph id="P-0620" lvl="0"><number>&lsqb;0620&rsqb;</number> The license server ID is identification information for specifying the license server. </paragraph>
<paragraph id="P-0621" lvl="0"><number>&lsqb;0621&rsqb;</number> The license update device <highlight><bold>4103</bold></highlight> accesses the license server specified by the license server ID through the communication section <highlight><bold>4041</bold></highlight> and transmits the updated information for updating the license information (step S<highlight><bold>4043</bold></highlight>). </paragraph>
<paragraph id="P-0622" lvl="0"><number>&lsqb;0622&rsqb;</number> Upon receiving the updated information transmitted from the license update device <highlight><bold>4103</bold></highlight>, the communication section <highlight><bold>4051</bold></highlight> of the license server <highlight><bold>4101</bold></highlight> searches an accounting database (DB) <highlight><bold>4058</bold></highlight> on the basis of the contents ID contained in the updated information to read out at least the accounting menu (the request key type information, the verification key number N, and the like, as needed). The accounting reference number issue section <highlight><bold>4054</bold></highlight> issues an accounting reference number. At least the accounting menu and the accounting reference number (to be referred to as a data group A hereinafter, as needed) are transmitted to the license update device <highlight><bold>4103</bold></highlight> through the communication section <highlight><bold>4051</bold></highlight> (step S<highlight><bold>4044</bold></highlight>). </paragraph>
<paragraph id="P-0623" lvl="0"><number>&lsqb;0623&rsqb;</number> The accounting reference number issued from the license server is a number appropriately assigned to each transaction by the license server. The accounting reference number is used to confirm accounting, as will be described later. </paragraph>
<paragraph id="P-0624" lvl="0"><number>&lsqb;0624&rsqb;</number> The license server normally processes license update requests from a plurality of users, i.e., license update devices. Therefore, the line connection time is preferably made as short as possible. For this purpose, the license update device appropriately disconnects the line to the license server. For example, for the communication section <highlight><bold>4041</bold></highlight> of the license update device, a response wait time Tw from the license server is set in advance. If no response comes from the license server within this wait time, the line may be disconnected. To discriminate license update requests from the plurality of license update devices, the license server must manage license information on the basis of accounting reference numbers. </paragraph>
<paragraph id="P-0625" lvl="0"><number>&lsqb;0625&rsqb;</number> Upon receiving the data group A, the license update device <highlight><bold>4103</bold></highlight> presents the accounting menu on the display section <highlight><bold>4045</bold></highlight> (step S<highlight><bold>4045</bold></highlight>). When the user selects the identification number of a desired valid period (step S<highlight><bold>4046</bold></highlight>), the communication section <highlight><bold>4041</bold></highlight> of the license update device <highlight><bold>4103</bold></highlight> accesses the electronic banking device <highlight><bold>4102</bold></highlight> to send at least the accounting reference number, the license server ID, the identification number of the selected valid period, and a fee claim corresponding to the valid period (step S<highlight><bold>4047</bold></highlight>). </paragraph>
<paragraph id="P-0626" lvl="0"><number>&lsqb;0626&rsqb;</number> The electronic banking device <highlight><bold>4102</bold></highlight> performs predetermined payment processing in accordance with the request from the user. If processing is successful, the identification number of the valid period, the settlement amount, and the accounting reference number are transmitted, as a payment certificate, to the license server <highlight><bold>4101</bold></highlight> designated by the license server ID, so the license server is notified of the success of payment processing. The identification number of the valid period, the settlement amount, and the accounting reference number are also transmitted to the license update device <highlight><bold>4103</bold></highlight> of the fee claiming source as a payment certificate (steps S<highlight><bold>4048</bold></highlight> to S<highlight><bold>4050</bold></highlight>). Upon receiving the settlement amount and accounting reference number, the license update device <highlight><bold>4103</bold></highlight> accesses the license server specified by the license server ID and transmits at least the identification number of the valid period selected in step S<highlight><bold>4046</bold></highlight>, the settlement amount, and the accounting reference number as a payment certificate (step S<highlight><bold>4051</bold></highlight>). </paragraph>
<paragraph id="P-0627" lvl="0"><number>&lsqb;0627&rsqb;</number> The payment certificate transmitted from the electronic banking device <highlight><bold>4102</bold></highlight> and the payment certificate transmitted from the license update device <highlight><bold>4103</bold></highlight>, which are received by the communication section <highlight><bold>4051</bold></highlight> of the license server <highlight><bold>4101</bold></highlight>, are recorded in an accounting processing database (DB) <highlight><bold>4057</bold></highlight> in correspondence with the accounting reference number. </paragraph>
<paragraph id="P-0628" lvl="0"><number>&lsqb;0628&rsqb;</number> The accounting processing DB <highlight><bold>4057</bold></highlight> stores the following information in correspondence with each accounting reference number. </paragraph>
<paragraph id="P-0629" lvl="2"><number>&lsqb;0629&rsqb;</number> ID of the license update terminal </paragraph>
<paragraph id="P-0630" lvl="2"><number>&lsqb;0630&rsqb;</number> Contents key </paragraph>
<paragraph id="P-0631" lvl="2"><number>&lsqb;0631&rsqb;</number> Payment certificate from the electronic banking device (the identification number of the valid period, the settlement amount, and the accounting reference number) </paragraph>
<paragraph id="P-0632" lvl="2"><number>&lsqb;0632&rsqb;</number> Payment certificate from the license update device (the identification number of the valid period, the settlement amount, and the accounting reference number) </paragraph>
<paragraph id="P-0633" lvl="0"><number>&lsqb;0633&rsqb;</number> Upon receiving the payment certificates from the electronic banking device <highlight><bold>4102</bold></highlight> and the license update device <highlight><bold>4103</bold></highlight>, the license server <highlight><bold>4101</bold></highlight> records them in the accounting processing DB <highlight><bold>4057</bold></highlight>. The accounting processing section <highlight><bold>4055</bold></highlight> confirms whether the settlement amounts and identification numbers in the two payment certificates match (step S<highlight><bold>4052</bold></highlight>). Only if YES in step S<highlight><bold>4052</bold></highlight>, it can be decided that appropriate payment has been performed. Simultaneously with this payment certificate confirmation processing, the license information generation section <highlight><bold>4056</bold></highlight> of the license server <highlight><bold>4101</bold></highlight> changes at least the license condition and the contents ID in the license information (updates the license information) on the basis of the license updated information transmitted from the license update device <highlight><bold>4103</bold></highlight> in step S<highlight><bold>4043</bold></highlight> and the contents key corresponding to the contents ID retrieved from the contents information DB <highlight><bold>4024</bold></highlight>. </paragraph>
<paragraph id="P-0634" lvl="0"><number>&lsqb;0634&rsqb;</number> For example, the license information contains the following information. </paragraph>
<paragraph id="P-0635" lvl="2"><number>&lsqb;0635&rsqb;</number> Contents ID </paragraph>
<paragraph id="P-0636" lvl="2"><number>&lsqb;0636&rsqb;</number> Contents key for decoding encrypted contents information </paragraph>
<paragraph id="P-0637" lvl="2"><number>&lsqb;0637&rsqb;</number> License information generation time </paragraph>
<paragraph id="P-0638" lvl="2"><number>&lsqb;0638&rsqb;</number> Update server ID </paragraph>
<paragraph id="P-0639" lvl="2"><number>&lsqb;0639&rsqb;</number> Accounting reference number </paragraph>
<paragraph id="P-0640" lvl="0"><number>&lsqb;0640&rsqb;</number> The update server ID is identification information for specifying the license server which has updated the license. With the update server ID, the server which has performed update can be specified from the license information, as needed. </paragraph>
<paragraph id="P-0641" lvl="0"><number>&lsqb;0641&rsqb;</number> When it is confirmed in step S<highlight><bold>4053</bold></highlight> that appropriate payment has been performed, the license server <highlight><bold>4101</bold></highlight> transmits the updated license information to the license update device <highlight><bold>4103</bold></highlight> as the license update source through the communication section <highlight><bold>4051</bold></highlight> (step S<highlight><bold>4054</bold></highlight>). </paragraph>
<paragraph id="P-0642" lvl="0"><number>&lsqb;0642&rsqb;</number> Upon receiving the updated license information, the license update device <highlight><bold>4103</bold></highlight> records the updated license information on the medium <highlight><bold>4031</bold></highlight> through the removable information recording medium IF <highlight><bold>4042</bold></highlight> (step S<highlight><bold>4055</bold></highlight>). </paragraph>
<paragraph id="P-0643" lvl="0"><number>&lsqb;0643&rsqb;</number> As has been described above, according to the information recording apparatus, the information reproducing apparatus, and the accounting apparatus of the present invention, quick and easy distribution of a digitized work distributed through a network or recording medium is allowed and, a fair digital information usage environment assuming protection by copyright based on charging for the use of digital information can be easily constructed. </paragraph>
<paragraph id="P-0644" lvl="7"><number>&lsqb;0644&rsqb;</number> (Fourth Embodiment) </paragraph>
<paragraph id="P-0645" lvl="0"><number>&lsqb;0645&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 107</cross-reference> shows an entire arrangement of an information reproduction system according to the fourth embodiment. This system is used by the user in the information distribution system as shown in <cross-reference target="DRAWINGS">FIG. 53, 75</cross-reference>, or <highlight><bold>76</bold></highlight> or <cross-reference target="DRAWINGS">FIG. 122</cross-reference> to be described later. Contents information is recorded on a recording medium (information medium) such as a DVD-RAM or DVD-ROM. A right for using (reproducing and watching) the contents information under a predetermined condition is called a license. The user obtains license information by purchasing the license. The license information for allowing reproduction of the contents information may be recorded on the recording medium together with the contents information. Alternatively, the license information may be separately recorded on another recording medium or, e.g., an IC card having a memory and an arithmetic function, read out independently of the contents information, and input to the information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 107</cross-reference>. This license information may be distributed through broadcasting or the Internet. </paragraph>
<paragraph id="P-0646" lvl="0"><number>&lsqb;0646&rsqb;</number> Referring to <cross-reference target="DRAWINGS">FIG. 107</cross-reference>, the information reproduction system comprises an information media driver <highlight><bold>7001</bold></highlight> for reading encrypted contents information, i.e., mainly digital contents from an information medium such as a DVD-ROM or DVD-RAM, an information reproduction device <highlight><bold>7000</bold></highlight> for checking on the basis of license information corresponding to the encrypted contents whether the license is valid, and if the license is valid, outputting a contents decoding key for the use of the contents information, and an information usage device <highlight><bold>7002</bold></highlight> such as a DVD player or a video reproduction device for decoding the encrypted contents using the decoding key output from the information media driver <highlight><bold>7001</bold></highlight> and reproducing the contents information. </paragraph>
<paragraph id="P-0647" lvl="0"><number>&lsqb;0647&rsqb;</number> Assume that the digital contents are encrypted in advance in order to properly collect the license fee. <cross-reference target="DRAWINGS">FIG. 113</cross-reference> shows a structure of contents information to be used in this embodiment. The contents information is constituted by an encrypted portion and an unencrypted portion. Encrypted contents are recorded in the encrypted portion, and a contents ID is recorded in the unencrypted portion. The contents ID is used to link the contents with the license information. </paragraph>
<paragraph id="P-0648" lvl="0"><number>&lsqb;0648&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 114</cross-reference> shows a structure of license information. The license information contains a decoding key (to be referred to as a contents decoding key hereinafter) for decoding the encrypted contents, a license condition such as an expiration date, the ID of the contents, and license authentication information. </paragraph>
<paragraph id="P-0649" lvl="0"><number>&lsqb;0649&rsqb;</number> The license authentication information is a code which is defined in advance to check whether the encrypted license information has been properly decoded. For example, a 4-byte code is represented by a hexadecimal number such as &ldquo;a5fe478el60e325f&rdquo;. This information must be defined among a license generation device, a license update device, and a license decision unit in advance. </paragraph>
<paragraph id="P-0650" lvl="0"><number>&lsqb;0650&rsqb;</number> The entire license information is encrypted using a predetermined decoding key. The license information is decoded using a secret key held in a license decision unit <highlight><bold>7008</bold></highlight> in the information reproduction device <highlight><bold>7000</bold></highlight>, and the license condition is checked on the basis of the decoded license information. The license condition is, e.g., an expiration date and a use count. When the expiration date is employed as the license condition, watching is disabled after the expiration date. Even when both contents and license information required to decode the contents are illicitly copied, the contents information cannot be used after the expiration date, so distribution of pirated editions substantially becomes meaningless. </paragraph>
<paragraph id="P-0651" lvl="0"><number>&lsqb;0651&rsqb;</number> However, when the expiration date is determined, the clock for counting the current time (time will mean the date and time hereinafter) to check the expiration date must be strictly managed, and otherwise, the expiration date itself also becomes meaningless. For example, assume that license information with an expiration date on December 22. is acquired on December 15. as a license for one week. In this case, if the clock to be referred to by the license decision unit <highlight><bold>7008</bold></highlight> indicates June 10, the license is valid for a half year. Especially, when the clock can be adjusted by the user, the clock may be adjusted to the user&apos;s advantage, and the above situation is likely to occur. </paragraph>
<paragraph id="P-0652" lvl="0"><number>&lsqb;0652&rsqb;</number> In this embodiment, an information reproducing apparatus capable of solving the above problem and providing a framework for causing the user to keep the expiration date even when the clock is adjusted to the user&apos;s advantage will be described. The decoding key of license information is generated using a predetermined algorithm at a predetermined period and replaced with the old decoding key. In the license generation device or license update device as well, a corresponding encryption key of license information is generated at the same timing. If the clock time is largely shifted from that in the license generation device or license update device, newly acquired license information cannot be decoded. At least to watch new contents, the clock time must be correctly adjusted. As described above, this embodiment has as its gist to change the decoding key of license information to indirectly adjust the clock to the correct state. In <cross-reference target="DRAWINGS">FIG. 107, a</cross-reference> clock <highlight><bold>7008</bold></highlight><highlight><italic>h </italic></highlight>(<cross-reference target="DRAWINGS">FIG. 108</cross-reference>) for counting the current time is incorporated in the license decision unit <highlight><bold>7008</bold></highlight> (in this case, when the license decision unit <highlight><bold>7008</bold></highlight> is constituted by, e.g., one IC chip, protection can be easily realized on the hardware side to prevent the user from adjusting the time). However, the count time of the clock <highlight><bold>7008</bold></highlight><highlight><italic>h </italic></highlight>may be adjusted by the user. </paragraph>
<paragraph id="P-0653" lvl="0"><number>&lsqb;0653&rsqb;</number> The processing operation of the information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 107</cross-reference> and that of the license decision unit <highlight><bold>7008</bold></highlight> having an arrangement shown in <cross-reference target="DRAWINGS">FIG. 108</cross-reference> will be described next with reference to the flow charts shown in <cross-reference target="DRAWINGS">FIGS. 109 and 110</cross-reference>. </paragraph>
<paragraph id="P-0654" lvl="0"><number>&lsqb;0654&rsqb;</number> Contents information as in <cross-reference target="DRAWINGS">FIG. 113</cross-reference>, which is read from the information media driver <highlight><bold>7001</bold></highlight>, is separated into a contents ID and encrypted contents by a data separation section <highlight><bold>7007</bold></highlight> (steps S<highlight><bold>7001</bold></highlight> and S<highlight><bold>7002</bold></highlight>). The encrypted contents are sent to the information usage device <highlight><bold>7002</bold></highlight> (step S<highlight><bold>7003</bold></highlight>), so the contents decoding key to be output from the license decision unit <highlight><bold>7008</bold></highlight> is waited for. </paragraph>
<paragraph id="P-0655" lvl="0"><number>&lsqb;0655&rsqb;</number> On the other hand, the contents ID is sent to a license information retrieval section <highlight><bold>7006</bold></highlight>. The license information retrieval section <highlight><bold>7006</bold></highlight> searches a license information database (DB) <highlight><bold>7004</bold></highlight> for license information having the contents ID (step S<highlight><bold>7004</bold></highlight>). </paragraph>
<paragraph id="P-0656" lvl="0"><number>&lsqb;0656&rsqb;</number> In license information stored in the license information DB <highlight><bold>7004</bold></highlight>, an unencrypted portion containing at least a contents ID is added to encrypted license information, as shown in <cross-reference target="DRAWINGS">FIG. 115</cross-reference>, so license information corresponding to the contents can be retrieved on the basis of the contents ID. The retrieved license information is sent to the license decision unit <highlight><bold>7008</bold></highlight> (steps S<highlight><bold>7005</bold></highlight> and S<highlight><bold>7006</bold></highlight>). </paragraph>
<paragraph id="P-0657" lvl="0"><number>&lsqb;0657&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 108</cross-reference> shows an arrangement of the license decision unit <highlight><bold>7008</bold></highlight>. The license information retrieved by the license information retrieval section <highlight><bold>7006</bold></highlight> is input to a license information input section <highlight><bold>7008</bold></highlight><highlight><italic>a </italic></highlight>and transferred to a decoder section <highlight><bold>7008</bold></highlight><highlight><italic>b. </italic></highlight></paragraph>
<paragraph id="P-0658" lvl="0"><number>&lsqb;0658&rsqb;</number> The decoder section <highlight><bold>7008</bold></highlight><highlight><italic>b </italic></highlight>decodes the license information using the license information decoding key stored in a decoding key storage section <highlight><bold>7008</bold></highlight><highlight><italic>e </italic></highlight>(steps S<highlight><bold>7007</bold></highlight> and S<highlight><bold>7008</bold></highlight>). </paragraph>
<paragraph id="P-0659" lvl="0"><number>&lsqb;0659&rsqb;</number> The decoded license information is sent to a license information matching confirmation section <highlight><bold>7008</bold></highlight><highlight><italic>c </italic></highlight>so it is confirmed using license authentication information whether the license information has been correctly decoded (step S<highlight><bold>7009</bold></highlight>). After the license information is decoded, it is checked whether the license authentication information is present at a predetermined position in the license information. If the license authentication information is at a predetermined position, it is decided that the license information has been correctly decoded. If decoding has been made using an appropriate decoding key, this code normally becomes random. If it is decided that the license information has not been correctly decoded, the license information retrieval section <highlight><bold>7006</bold></highlight> is requested to retrieve the next candidate of license information. The license information retrieval section <highlight><bold>7006</bold></highlight> searches the license information DB <highlight><bold>7004</bold></highlight>, extracts the next license information having the contents ID, and sends it to the license decision unit <highlight><bold>7008</bold></highlight>. If the license information retrieval section <highlight><bold>7006</bold></highlight> cannot retrieve the next candidate of license information, the flow advances to step S<highlight><bold>7021</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 110</cross-reference> to request to display, on a display section <highlight><bold>7011</bold></highlight>, a message, e.g., &ldquo;license information is invalid, or time of the reference clock is wrong. Current time of the reference clock is YYYY, HH:MM. Please confirm time and update the license&rdquo; (step S<highlight><bold>7021</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 110</cross-reference>). The user confirms the current time, and if the time is largely shifted, corrects the time. </paragraph>
<paragraph id="P-0660" lvl="0"><number>&lsqb;0660&rsqb;</number> A decoding key generation section <highlight><bold>7008</bold></highlight><highlight><italic>f </italic></highlight>generates a new key at a predetermined period together with the license update device and license generation device and stores the key in the decoding key storage section <highlight><bold>7008</bold></highlight><highlight><italic>e</italic></highlight>. If the clock <highlight><bold>7008</bold></highlight><highlight><italic>h </italic></highlight>in the license decision unit <highlight><bold>7008</bold></highlight> indicates time largely shifted from the actual time, the decoding key generated by the license decision unit <highlight><bold>7008</bold></highlight> does not match the encryption key generated by the license update device or license generation device, so even license information with a valid license condition cannot be decoded. For this reason, the message as described above need be displayed to prompt the user to confirm the time of the clock <highlight><bold>7008</bold></highlight><highlight><italic>h</italic></highlight>. After this, the license may be updated in response to the request from the user. </paragraph>
<paragraph id="P-0661" lvl="0"><number>&lsqb;0661&rsqb;</number> In step S<highlight><bold>7010</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 109</cross-reference>, if the license information matching confirmation section <highlight><bold>7008</bold></highlight><highlight><italic>c </italic></highlight>decides that the license information has been correctly decoded, the license information is sent to a license condition decision section <highlight><bold>7008</bold></highlight><highlight><italic>d </italic></highlight>to decide the license condition. The expiration date is used as the license condition. To decide the license condition, the time of the clock <highlight><bold>7008</bold></highlight><highlight><italic>h </italic></highlight>in or, as needed, outside the license decision unit <highlight><bold>7008</bold></highlight> is referred to through a clock reference section <highlight><bold>7008</bold></highlight><highlight><italic>g </italic></highlight>to decide whether the time is before the expiration date (step S<highlight><bold>7011</bold></highlight>). If it is decided that the license condition is satisfied (step S<highlight><bold>7012</bold></highlight>), the contents decoding key is output to the information usage device <highlight><bold>7002</bold></highlight> (step S<highlight><bold>7013</bold></highlight>). The information usage device <highlight><bold>7002</bold></highlight> decodes encrypted contents, which have been separately sent, using the decoding key, and reproduces and uses the contents information (step S<highlight><bold>7014</bold></highlight>). </paragraph>
<paragraph id="P-0662" lvl="0"><number>&lsqb;0662&rsqb;</number> In step S<highlight><bold>3012</bold></highlight>, if the license condition is not satisfied, its message and at least the license information are transferred to the license information retrieval section <highlight><bold>7006</bold></highlight>. The flow advances to step S<highlight><bold>7021</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 10</cross-reference>, and the license may be updated in response to a request from the user. </paragraph>
<paragraph id="P-0663" lvl="0"><number>&lsqb;0663&rsqb;</number> The license is updated following a procedure to be described later in detail. License update information containing at least a contents ID and a desired license condition, as shown in <cross-reference target="DRAWINGS">FIG. 116</cross-reference>, is generated through a license update directing section <highlight><bold>7005</bold></highlight>, a desired license condition input section <highlight><bold>7010</bold></highlight>, and the display section <highlight><bold>7011</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 107</cross-reference>. The generated license update information is sent to the license update device through a predetermined network such as the Internet to update the license. </paragraph>
<paragraph id="P-0664" lvl="0"><number>&lsqb;0664&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 110</cross-reference> is a flow chart of license information update processing. In <cross-reference target="DRAWINGS">FIG. 110</cross-reference>, after a message &ldquo;license information is invalid, or time of the reference clock is wrong. Current time of the reference clock is YYYY, HH:MM. Please confirm time and update the license&rdquo; is displayed on the display section <highlight><bold>7011</bold></highlight> (step S<highlight><bold>7021</bold></highlight>), the license update directing section <highlight><bold>7005</bold></highlight> having an appropriate interface with which the user inputs at least an instruction whether the license is to be updated is started. Assume that (after the time of the clock <highlight><bold>7008</bold></highlight><highlight><italic>h </italic></highlight>is confirmed), the user has input an instruction through the interface to update the license. The license update directing section <highlight><bold>7005</bold></highlight> sends the instruction to the license information retrieval section <highlight><bold>7006</bold></highlight>. The license information retrieval section <highlight><bold>7006</bold></highlight> sends the contents ID to a license update section <highlight><bold>7009</bold></highlight> (steps S<highlight><bold>7022</bold></highlight> to S<highlight><bold>7024</bold></highlight>). </paragraph>
<paragraph id="P-0665" lvl="0"><number>&lsqb;0665&rsqb;</number> The license update section <highlight><bold>7009</bold></highlight> starts the desired license condition input section <highlight><bold>7010</bold></highlight>, generates license update information as shown in <cross-reference target="DRAWINGS">FIG. 116</cross-reference> using the desired license condition input through the appropriate interface of the desired license condition input section <highlight><bold>7010</bold></highlight> and the contents ID sent from the license information retrieval section <highlight><bold>7006</bold></highlight> (steps S<highlight><bold>7025</bold></highlight> to S<highlight><bold>7027</bold></highlight>), and sends the license update information to the license information update device through a predetermined network. </paragraph>
<paragraph id="P-0666" lvl="0"><number>&lsqb;0666&rsqb;</number> In step S<highlight><bold>7024</bold></highlight>, if the user does not want to update the license (i.e., the user inputs an instruction through the license update directing section <highlight><bold>7005</bold></highlight> not to update the license), the license information retrieval section <highlight><bold>7006</bold></highlight> erases the contents ID, and processing is ended. </paragraph>
<paragraph id="P-0667" lvl="0"><number>&lsqb;0667&rsqb;</number> The updated license information is input to a license storage section <highlight><bold>7003</bold></highlight> through an IC card or a predetermined network such as the Internet, converted into a data format shown in <cross-reference target="DRAWINGS">FIG. 115</cross-reference>, and stored in the license information DB (database) <highlight><bold>7004</bold></highlight>, as shown in <cross-reference target="DRAWINGS">FIG. 111</cross-reference>. </paragraph>
<paragraph id="P-0668" lvl="0"><number>&lsqb;0668&rsqb;</number> If the license decision unit <highlight><bold>7008</bold></highlight> decides that the license is invalid (step S<highlight><bold>7005</bold></highlight>, S<highlight><bold>7010</bold></highlight>, or S<highlight><bold>7012</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 109</cross-reference>), processing may be immediately ended (reproduction may be stopped). In this case, the license update directing section <highlight><bold>7005</bold></highlight>, the display section <highlight><bold>7011</bold></highlight>, the license update section <highlight><bold>7009</bold></highlight>, and the desired license condition input section <highlight><bold>7010</bold></highlight> can be omitted. The function of communicating with the license update device can also be omitted, and the arrangement is simplified. To update the license, the user with, e.g., an IC card goes to an agency which updates the license and pays a predetermined fee to cause the agency to write new license information with an updated license condition and the like in the IC card. The user brings the IC card back and inserts it into the information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 107</cross-reference> to load the updated license information and store it in the license information DB <highlight><bold>7004</bold></highlight> through the license storage section <highlight><bold>7003</bold></highlight>. </paragraph>
<paragraph id="P-0669" lvl="0"><number>&lsqb;0669&rsqb;</number> License information decoding key generation processing will be described next with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 112</cross-reference>. </paragraph>
<paragraph id="P-0670" lvl="0"><number>&lsqb;0670&rsqb;</number> The decoding key generation section <highlight><bold>7008</bold></highlight><highlight><italic>f </italic></highlight>in the license decision unit <highlight><bold>7008</bold></highlight> refers to the clock <highlight><bold>7008</bold></highlight><highlight><italic>h </italic></highlight>through the clock reference section <highlight><bold>7008</bold></highlight><highlight><italic>g </italic></highlight>and starts to generate a decoding key at predetermined time (steps S<highlight><bold>7041</bold></highlight> and S<highlight><bold>7042</bold></highlight>). The generated decoding key is stored in the decoding key storage section <highlight><bold>7008</bold></highlight><highlight><italic>e </italic></highlight>(steps S<highlight><bold>7043</bold></highlight> and S<highlight><bold>7044</bold></highlight>). The decoding key must be generated in synchronism with the license generation device and license update device. For example, the decoding key is updated, e.g., once a week at predetermined time such as 15:00 on Monday. As is apparent from the gist of this embodiment, the same key as that in the license generation device or license update device must be generated. For this purpose, the key can be generated using a random number generator using time as a seed. When the key is to be updated on Dec. 15, 1997, the number &ldquo;19971215&rdquo; is used as a seed, and the output from the random number generator incorporated in, e.g., the decoding key generation section <highlight><bold>7008</bold></highlight><highlight><italic>f </italic></highlight>may be used as the decoding key. The license generation device and license update device also generate the license information encryption key by the same scheme, as a matter of course. </paragraph>
<paragraph id="P-0671" lvl="0"><number>&lsqb;0671&rsqb;</number> A method of generating a common key in the common key scheme has been described above. The license decision unit <highlight><bold>7008</bold></highlight> sometimes employs a public key cipher. In this case, as in the key generation section <highlight><bold>2006</bold></highlight> of the above-described decoder unit A, a key generation algorithm of, e.g., RSA cipher can be used to generate the decoding key (secret key). </paragraph>
<paragraph id="P-0672" lvl="0"><number>&lsqb;0672&rsqb;</number> With this arrangement, a mechanism for changing the decoding key on both the license generation device or license update device side and the license decision unit <highlight><bold>7008</bold></highlight> side at a predetermined period can be realized. Even when the user illicitly alters the clock <highlight><bold>7008</bold></highlight><highlight><italic>h </italic></highlight>in the information reproducing apparatus including the license decision unit <highlight><bold>7008</bold></highlight>, newly acquired license information cannot be decoded, so illicit alteration of the clock can be prevented in many cases. </paragraph>
<paragraph id="P-0673" lvl="0"><number>&lsqb;0673&rsqb;</number> Whether the clock <highlight><bold>7008</bold></highlight><highlight><italic>h </italic></highlight>can be altered by the user is not a serious problem because of this characteristic feature. In the key generation process, the key generation start instruction need not always be issued from the decoding key generation section <highlight><bold>7008</bold></highlight><highlight><italic>f </italic></highlight>itself. The clock reference section <highlight><bold>7008</bold></highlight><highlight><italic>g </italic></highlight>or clock <highlight><bold>7008</bold></highlight><highlight><italic>h </italic></highlight>may issue the instruction. In this case, key generation can be performed at more accurate time than that in key generation directed by the decoding key generation section <highlight><bold>7008</bold></highlight><highlight><italic>f. </italic></highlight></paragraph>
<paragraph id="P-0674" lvl="0"><number>&lsqb;0674&rsqb;</number> In this embodiment, a license corresponding to a piece of contents information is retrieved, and then the validity is decided (the expiration date is checked). If the expiration date is valid, the decoding key is output. However, if the expiration date is invalid, a message representing that the license has expired or the reference clock is wrong is displayed without retrieving another license information. This is because it is tacitly assumed that only a piece of license information corresponds to the contents. However, if a license for two weeks is to be purchased/sold, the license information may be separated in units of weeks. In some cases, licenses with not a period limitation but a count limitation are sold, and these licenses may be present with respect to the same contents. In such a case, all existing license information can be retrieved, and the most advantageous license for the user may be used. </paragraph>
<paragraph id="P-0675" lvl="0"><number>&lsqb;0675&rsqb;</number> For example, the license with a period limitation is preferred over the license with a count limitation. While the license with the period limitation is valid, the user need not use the license with the count limitation. In this case, the license information stored in the license information DB <highlight><bold>7004</bold></highlight> preferably contains, in the unencrypted portion, not only the contents ID but also information for identifying the license with a period limitation or the license with a count limitation, as shown in <cross-reference target="DRAWINGS">FIG. 117</cross-reference>. </paragraph>
<paragraph id="P-0676" lvl="0"><number>&lsqb;0676&rsqb;</number> The priority order in selecting the license may be designated by the user himself/herself. For example, the license information retrieval section <highlight><bold>7006</bold></highlight> may displays, on the display section <highlight><bold>7011</bold></highlight>, a menu window to cause the user to select the license with a period limitation or the license with a count limitation. </paragraph>
<paragraph id="P-0677" lvl="0"><number>&lsqb;0677&rsqb;</number> Once the license information with priority has been retrieved, the license information retrieval section <highlight><bold>7006</bold></highlight> may end retrieval at that time point without retrieving all license information. </paragraph>
<paragraph id="P-0678" lvl="0"><number>&lsqb;0678&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 118</cross-reference> shows another arrangement of the information reproduction device <highlight><bold>7000</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 107</cross-reference>. Contents information is recorded on a recording medium (information medium) such as a DVD-ROM or DVD-RAM, and license information is distributed through broadcasting. </paragraph>
<paragraph id="P-0679" lvl="0"><number>&lsqb;0679&rsqb;</number> As the characteristic feature of the information reproducing apparatus shown in <cross-reference target="DRAWINGS">FIG. 118</cross-reference>, the decoding key of encrypted license information to be distributed by broadcasting is generated on the basis of a seed contained in the broadcasting wave. As a result, the decoding key can be generated without using the clock <highlight><bold>7008</bold></highlight><highlight><italic>h. </italic></highlight></paragraph>
<paragraph id="P-0680" lvl="0"><number>&lsqb;0680&rsqb;</number> The same reference numerals as in <cross-reference target="DRAWINGS">FIG. 107</cross-reference> denote the same parts in <cross-reference target="DRAWINGS">FIG. 118</cross-reference>, and only different portions will be described. In the arrangement shown in <cross-reference target="DRAWINGS">FIG. 118</cross-reference>, encrypted license information is sent by a broadcasting wave, and the broadcasting wave includes seed information for generating the decoding key of the encrypted license information. Therefore, the information reproducing apparatus has a license information receiving section <highlight><bold>8001</bold></highlight> for receiving the broadcasting wave and converting it into a digital signal, and a license separation section <highlight><bold>8002</bold></highlight> for separating the encrypted license information and seed information from the received broadcasting wave. A license decision unit <highlight><bold>8009</bold></highlight> generates the decoding key on the basis of the seed information sent together with the broadcasting wave. </paragraph>
<paragraph id="P-0681" lvl="0"><number>&lsqb;0681&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 121</cross-reference> shows an example of the data structure of the broadcasting wave received by the license information receiving section <highlight><bold>8001</bold></highlight>. Identification information with a fixed length is added to the start of each of the license information and seed information to discriminate the license information from the seed information. </paragraph>
<paragraph id="P-0682" lvl="0"><number>&lsqb;0682&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 119</cross-reference> shows an arrangement of the license decision unit <highlight><bold>8009</bold></highlight>. The same reference numerals as in <cross-reference target="DRAWINGS">FIG. 108</cross-reference> denote the same parts in <cross-reference target="DRAWINGS">FIG. 119</cross-reference>, and only different portions will be described. The license decision unit <highlight><bold>8009</bold></highlight> further comprises a decoding key generation seed input section <highlight><bold>8009</bold></highlight><highlight><italic>g </italic></highlight>to which seed information output from the license separation section <highlight><bold>8002</bold></highlight> is input. A decoding key generation section <highlight><bold>8009</bold></highlight><highlight><italic>f </italic></highlight>generates a decoding key from the seed information. </paragraph>
<paragraph id="P-0683" lvl="0"><number>&lsqb;0683&rsqb;</number> An operation from separation of encrypted license information and seed information from a received broadcasting wave to decoding key generation will be described next with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 120</cross-reference>. </paragraph>
<paragraph id="P-0684" lvl="0"><number>&lsqb;0684&rsqb;</number> Upon receiving a broadcasting wave and obtaining received data as shown in <cross-reference target="DRAWINGS">FIG. 121</cross-reference>, the license information receiving section <highlight><bold>8001</bold></highlight> temporarily sends the received data to the license separation section <highlight><bold>8002</bold></highlight> to separate it into license information and seed information using identification information (steps S<highlight><bold>8001</bold></highlight> and S<highlight><bold>8002</bold></highlight>). </paragraph>
<paragraph id="P-0685" lvl="0"><number>&lsqb;0685&rsqb;</number> If the received data is license information, the license information is sent to the license storage section <highlight><bold>7003</bold></highlight> (steps S<highlight><bold>8003</bold></highlight> and S<highlight><bold>8004</bold></highlight>). The license storage section <highlight><bold>7003</bold></highlight> adds a contents ID to the license information, as shown in <cross-reference target="DRAWINGS">FIG. 115</cross-reference>, and stores it in the license information DB <highlight><bold>7004</bold></highlight>. If the received data is seed information, the seed information is sent to the license decision unit (step S<highlight><bold>8005</bold></highlight>). The license decision unit receives the seed information by the decoding key generation seed input section <highlight><bold>8009</bold></highlight><highlight><italic>g </italic></highlight>and sends it to the decoding key generation section <highlight><bold>8009</bold></highlight><highlight><italic>f </italic></highlight>to generate a new decoding key (step S<highlight><bold>8006</bold></highlight>). The decoding key generation section <highlight><bold>8009</bold></highlight><highlight><italic>f </italic></highlight>may generate the decoding key from the seed information using the common key scheme or public key scheme, as in the fourth embodiment. The generated decoding key is stored in a decoding key storage section <highlight><bold>8009</bold></highlight><highlight><italic>e. </italic></highlight></paragraph>
<paragraph id="P-0686" lvl="0"><number>&lsqb;0686&rsqb;</number> License decision or license update processing is the same as in <cross-reference target="DRAWINGS">FIGS. 109 and 110</cross-reference>. </paragraph>
<paragraph id="P-0687" lvl="0"><number>&lsqb;0687&rsqb;</number> When license information is distributed by broadcasting, and the license is sent to all information reproducing apparatuses (reception terminals), watching is allowed to all people having reception terminals in the same specifications, and the license is managed in no way. The license information need be supplied in units of reception terminals. A reception terminal ID is inserted into the license information, and reception terminals except a reception terminal having the reception terminal ID must be prevented from receiving the license information. For this purpose, the reception terminal preferably has identification information (reception terminal ID) for identifying the reception terminal in the license information identification information distributed by broadcasting such that only license information addressed to the reception terminal can be selectively received. The reception terminal ID in the license information identification information is called an effective terminal ID. </paragraph>
<paragraph id="P-0688" lvl="0"><number>&lsqb;0688&rsqb;</number> Each reception terminal, i.e., the license separation section <highlight><bold>8002</bold></highlight> of the information reproducing apparatus as shown in <cross-reference target="DRAWINGS">FIG. 118</cross-reference> has a unique reception terminal ID in advance. Before license information is separated from the received data as shown in <cross-reference target="DRAWINGS">FIG. 121</cross-reference>, the effective terminal ID contained in the license information identification information is compared with the self reception terminal ID. Only when the IDs match, the license information is received. Alternatively, all license information may be temporarily stored in a predetermined memory, the effective terminal ID in the license information identification information stored in the memory may be compared with the reception terminal ID, and unnecessary license information may be erased from the memory. </paragraph>
<paragraph id="P-0689" lvl="0"><number>&lsqb;0689&rsqb;</number> The information reproduction device <highlight><bold>7000</bold></highlight> shown in <cross-reference target="DRAWINGS">FIG. 107</cross-reference> or <highlight><bold>118</bold></highlight> can be constituted using a hardware resource as standard equipment of a general-purpose computer. </paragraph>
<paragraph id="P-0690" lvl="0"><number>&lsqb;0690&rsqb;</number> License information decoding key generation processing described in this embodiment can also be applied to the key generation section <highlight><bold>2006</bold></highlight> of the decoder unit A or C described in the second embodiment. </paragraph>
<paragraph id="P-0691" lvl="0"><number>&lsqb;0691&rsqb;</number> When the license information contains license authentication information as described in this embodiment, processing of the license information matching confirmation section <highlight><bold>7008</bold></highlight><highlight><italic>c</italic></highlight>, i.e., processing of confirming using the license authentication information whether the license information has been correctly decoded can also be performed in the decision section <highlight><bold>2003</bold></highlight> of each of the decoder units A to D described in the second embodiment. The decision section <highlight><bold>2003</bold></highlight> of each of the decoder units A to D can collate the license authentication information, and after it is decided that the license information has been correctly decoded, predetermined license decision can be made. </paragraph>
<paragraph id="P-0692" lvl="0"><number>&lsqb;0692&rsqb;</number> As described above, according to the fourth embodiment, key information for decoding license information is generated at a predetermined period in the license decision unit <highlight><bold>7008</bold></highlight>. With this arrangement, the information security for license information containing the contents information license condition or contents information decoding key can be improved. </paragraph>
<paragraph id="P-0693" lvl="0"><number>&lsqb;0693&rsqb;</number> The decoded license information contains license authentication information for deciding the decoding result. Therefore, even when many decoding keys of license information are generated along with the elapse of time, it can be easily decided whether the license information has been correctly decoded using a proper one of the decoding keys. </paragraph>
<paragraph id="P-0694" lvl="0"><number>&lsqb;0694&rsqb;</number> Since the decoding key of license information is generated in the license decision unit <highlight><bold>8009</bold></highlight> on the basis of seed information distributed to the information reproducing apparatus by broadcasting, the decoding key can be easily updated. </paragraph>
<paragraph id="P-0695" lvl="7"><number>&lsqb;0695&rsqb;</number> (Fifth Embodiment) </paragraph>
<paragraph id="P-0696" lvl="0"><number>&lsqb;0696&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 122</cross-reference> shows an arrangement of an information distribution system according to the fifth embodiment. Encrypted contents information as an accounting object is recorded on a removable information storage medium (to be simply referred to as a disk hereinafter) D such as a DVD in advance. This embodiment provides a rental service in which a license for allowing reproduction of the contents information recorded on the disk D is sold, and the disk D is rented. In this case, the license means the right of using (reproducing and watching) contents information to be rented under a predetermined condition. More specifically, license information for allowing the user to reproduce contents information only within a limited period a limited number of times is sold to the user, thereby granting the user the license. </paragraph>
<paragraph id="P-0697" lvl="0"><number>&lsqb;0697&rsqb;</number> License information for enabling reproduction of contents information is recorded on a card type recording medium (to be simply referred to as a card hereinafter) P such as an IC card having a calculation function and supplied to the user. </paragraph>
<paragraph id="P-0698" lvl="0"><number>&lsqb;0698&rsqb;</number> Each shop for providing the rental disk D has a license issuing device <highlight><bold>5003</bold></highlight>. The license issuing device <highlight><bold>5003</bold></highlight> is connected to a center through a predetermined communication line to form a network. When the user subscribed to the service of the information distribution system as shown in <cross-reference target="DRAWINGS">FIG. 122</cross-reference> goes to an arbitrary shop on the network to rent the disk D having desired contents information, the user undergoes a predetermined procedure such as fee payment for the contents license condition such as a contents information watching period first. The license issuing device <highlight><bold>5003</bold></highlight> generates license information on the basis of disk information containing the disk key and license condition of the disk D, which is sent from the center, and records the license information on the card P. </paragraph>
<paragraph id="P-0699" lvl="0"><number>&lsqb;0699&rsqb;</number> The user takes the disk D and the card P home, inserts the card P into a card adapter <highlight><bold>5004</bold></highlight> adapted to the information distribution system, and sets the disk D in a player <highlight><bold>5005</bold></highlight>. As far as the license condition contained in the license information is satisfied (e.g., within the watching period), the contents information can be reproduced. </paragraph>
<paragraph id="P-0700" lvl="0"><number>&lsqb;0700&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 123</cross-reference> shows an example of data recorded on the rental disk D in the shop. As shown in <cross-reference target="DRAWINGS">FIG. 123</cross-reference>, the disk D has a disk ID, one or a plurality of pieces of (e.g., two pieces of) encrypted contents information, and encrypted contents keys corresponding to the pieces of contents information, respectively, which are used to decode the contents information. </paragraph>
<paragraph id="P-0701" lvl="0"><number>&lsqb;0701&rsqb;</number> The pieces of contents information recorded on one disk are encrypted using contents key corresponding to the pieces of contents information. The contents key is encrypted using a predetermined disk key in the disk ID of the disk. As a characteristic feature, the disk key is not recorded on the disk. </paragraph>
<paragraph id="P-0702" lvl="0"><number>&lsqb;0702&rsqb;</number> The disk ID is identification information for identifying the disk. The disk ID may be uniquely defined for each disk or common to disks storing contents information of the same title. Alternatively, disks manufactured in a factory in a certain day may have a common disk ID. </paragraph>
<paragraph id="P-0703" lvl="0"><number>&lsqb;0703&rsqb;</number> A disk key (the disk key is not recorded on the disk) capable of decoding the encrypted contents key recorded on the disk is uniquely determined, but not vice versa. Even when a disk key is available to decode a contents key, the disk IDs are not always identical. </paragraph>
<paragraph id="P-0704" lvl="0"><number>&lsqb;0704&rsqb;</number> The rental disk D does not have the disk key, as shown in <cross-reference target="DRAWINGS">FIG. 123</cross-reference>. To rent the disk D, a disk key necessary for decoding the contents stored in the disk D must be distributed to the user. </paragraph>
<paragraph id="P-0705" lvl="0"><number>&lsqb;0705&rsqb;</number> When the disk D is to be rented, a license creation device <highlight><bold>5001</bold></highlight> in the center generates disk information containing a disk key corresponding to the disk D. The disk key is stored in a contents DB <highlight><bold>5002</bold></highlight> in the center in correspondence with the disk ID in advance, as shown in <cross-reference target="DRAWINGS">FIG. 124</cross-reference>. </paragraph>
<paragraph id="P-0706" lvl="0"><number>&lsqb;0706&rsqb;</number> The present invention is to provide a safe disk key distribution scheme. </paragraph>
<paragraph id="P-0707" lvl="0"><number>&lsqb;0707&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 125</cross-reference> schematically shows the disk key distribution scheme in the information distribution system shown in <cross-reference target="DRAWINGS">FIG. 122</cross-reference>. Roughly, a key (disk key) distribution device is constituted by the license creation device <highlight><bold>5001</bold></highlight> and the license issuing device <highlight><bold>5003</bold></highlight>, and an information usage device for using (e.g., reproducing) the contents information using the key (disk key) distributed from the key distribution device is constituted by the card adapter <highlight><bold>5004</bold></highlight> and the player <highlight><bold>5005</bold></highlight>. </paragraph>
<paragraph id="P-0708" lvl="0"><number>&lsqb;0708&rsqb;</number> The disk key is encrypted using an encryption key ke together with the disk ID and contents license condition before the disk key is sent from the license creation device <highlight><bold>5001</bold></highlight> to the card adapter <highlight><bold>5004</bold></highlight>. More specifically, the license creation device <highlight><bold>5001</bold></highlight> generates disk information containing the disk key, the disk ID, and the license condition, encrypts the disk information using the encryption key ke, and distributes the disk information. By decoding the disk information by the card adapter <highlight><bold>5004</bold></highlight> which holds a decoding key kd in advance, the risk of disk key decoding midway along the distribution route by tapping or the like can be lowered. </paragraph>
<paragraph id="P-0709" lvl="0"><number>&lsqb;0709&rsqb;</number> The license creation device <highlight><bold>5001</bold></highlight> and the license issuing device <highlight><bold>5003</bold></highlight> which constitute the key distribution device sometimes independently belong to different parties having interests. In this case, to adjust the interests (to prevent the disk information from being illicitly acquired during the process of distributing it from the license creation device <highlight><bold>5001</bold></highlight> to the license issuing device <highlight><bold>5003</bold></highlight>), the license creation device <highlight><bold>5001</bold></highlight> preferably encrypts the disk information and then distributes it to the license issuing device <highlight><bold>5003</bold></highlight>. </paragraph>
<paragraph id="P-0710" lvl="0"><number>&lsqb;0710&rsqb;</number> The encrypted disk information containing the disk key reaches the card adapter <highlight><bold>5004</bold></highlight> through the license issuing device <highlight><bold>5003</bold></highlight> and the card P. To protect the disk information on this distribution route, the encrypted disk information is further encrypted and distributed from the license issuing device <highlight><bold>5003</bold></highlight> to the card adapter <highlight><bold>5004</bold></highlight>. </paragraph>
<paragraph id="P-0711" lvl="0"><number>&lsqb;0711&rsqb;</number> For example, as shown in <cross-reference target="DRAWINGS">FIG. 125</cross-reference>, the license issuing device <highlight><bold>5003</bold></highlight> adds another information to the disk information encrypted using the encryption key ke and distributed from the license creation device <highlight><bold>5001</bold></highlight> to generate license information, encrypts the license information using a common key wl<highlight><bold>2</bold></highlight>, and writes the license information in the card P. </paragraph>
<paragraph id="P-0712" lvl="0"><number>&lsqb;0712&rsqb;</number> The common key wl<highlight><bold>2</bold></highlight> is generated on the basis of publishable information (public parameters) which is exchanged between the card adapter <highlight><bold>5004</bold></highlight> and the license issuing device <highlight><bold>5003</bold></highlight> through the card P and secret parameters held in the card adapter <highlight><bold>5004</bold></highlight> and the license issuing device <highlight><bold>5003</bold></highlight>, as in the DH (Diffie-Hellman) key distribution scheme. The public parameters are generated from the secret parameters held in the card adapter <highlight><bold>5004</bold></highlight> and the license issuing device <highlight><bold>5003</bold></highlight>. A tapper who knows only the public parameters cannot generate the common key wl<highlight><bold>2</bold></highlight>. </paragraph>
<paragraph id="P-0713" lvl="0"><number>&lsqb;0713&rsqb;</number> Only the card adapter <highlight><bold>5004</bold></highlight> which has exchanged the public parameters with the license issuing device <highlight><bold>5003</bold></highlight> can decode the disk information encrypted by the common key wl<highlight><bold>2</bold></highlight>. </paragraph>
<paragraph id="P-0714" lvl="0"><number>&lsqb;0714&rsqb;</number> The card adapter <highlight><bold>5004</bold></highlight> generates the common key wl<highlight><bold>2</bold></highlight> from the public parameters distributed from the license issuing device <highlight><bold>5003</bold></highlight> through the card P and the secret parameters held in the card adapter <highlight><bold>5004</bold></highlight> itself and decodes the encrypted license information distributed from the license issuing device <highlight><bold>5003</bold></highlight> through the card P using the common key, thereby obtaining the encrypted disk information. This encrypted disk information is decoded using the decoding key kd, and the license condition is checked to decide whether reproduction is allowed. If it is decided that reproduction is allowed, the disk key contained in the disk information is transferred to the player <highlight><bold>5005</bold></highlight>. </paragraph>
<paragraph id="P-0715" lvl="0"><number>&lsqb;0715&rsqb;</number> If the path between the card adapter <highlight><bold>5004</bold></highlight> and the player <highlight><bold>5005</bold></highlight> is an unsafe communication path where tapping is likely to occur, the disk key is also preferably encrypted and distributed. As in, e.g., the DH key distribution scheme, the disk key is encrypted by the card adapter <highlight><bold>5004</bold></highlight> using a common key wd<highlight><bold>2</bold></highlight> generated from public parameters exchanged between the card adapter <highlight><bold>5004</bold></highlight> and the player <highlight><bold>5005</bold></highlight> and secret parameters held in the card adapter <highlight><bold>5004</bold></highlight> and the player <highlight><bold>5005</bold></highlight> and then distributed to the player <highlight><bold>5005</bold></highlight>. </paragraph>
<paragraph id="P-0716" lvl="0"><number>&lsqb;0716&rsqb;</number> When the disk key is to be encrypted by the license creation device <highlight><bold>5001</bold></highlight>, the disk ID and contents license condition are added to generate disk information, and then, the disk information is encrypted. When the disk information is to be encrypted by the license issuing device <highlight><bold>5003</bold></highlight>, identification information (KID) of the card P, identification information (AID) of the card adapter <highlight><bold>5004</bold></highlight>, and the like are added to generate license information, and then, the license information is encrypted. The license information may also contain license information generation time. </paragraph>
<paragraph id="P-0717" lvl="0"><number>&lsqb;0717&rsqb;</number> For the card adapter <highlight><bold>5004</bold></highlight> and the card P, the respective pieces of identification information are preferably protected to prevent them from being externally read or corrected. </paragraph>
<paragraph id="P-0718" lvl="0"><number>&lsqb;0718&rsqb;</number> When the identification information (KID) of the card P and the identification information (AID) of the card adapter <highlight><bold>5004</bold></highlight> are to be inserted into the license information, the license issuing device <highlight><bold>5003</bold></highlight> must acquire the pieces of identification information KID and AID before generation of the license information. </paragraph>
<paragraph id="P-0719" lvl="0"><number>&lsqb;0719&rsqb;</number> When the identification information KID of the card P is to be distributed from the card P to the license issuing device <highlight><bold>5003</bold></highlight>, the identification information KID is preferably encrypted and then distributed. For example, as in the DH key distribution scheme, the identification information KID is encrypted in the card P using a common key wk generated from public parameters exchanged between the license issuing device <highlight><bold>5003</bold></highlight> and the card P and secret parameters held in the license issuing device <highlight><bold>5003</bold></highlight> and the card P and distributed to the license issuing device <highlight><bold>5003</bold></highlight>. </paragraph>
<paragraph id="P-0720" lvl="0"><number>&lsqb;0720&rsqb;</number> When the identification information AID of the card adapter <highlight><bold>5004</bold></highlight> is to be distributed from the card adapter <highlight><bold>5004</bold></highlight> to the license issuing device <highlight><bold>5003</bold></highlight> (through the card P), the identification information AID is preferably encrypted and then distributed. For example, as in the DH key distribution scheme, the identification information AID is encrypted in the card adapter <highlight><bold>5004</bold></highlight> using a common key wl<highlight><bold>1</bold></highlight> generated from public parameters exchanged between the license issuing device <highlight><bold>5003</bold></highlight> and the card adapter <highlight><bold>5004</bold></highlight> and secret parameters held in the license issuing device <highlight><bold>5003</bold></highlight> and the card adapter <highlight><bold>5004</bold></highlight> and distributed to the license issuing device <highlight><bold>5003</bold></highlight>. </paragraph>
<paragraph id="P-0721" lvl="0"><number>&lsqb;0721&rsqb;</number> When the license information contains the identification information (KID) of the card P and the identification information (AID) of the card adapter <highlight><bold>5004</bold></highlight>, the card adapter <highlight><bold>5004</bold></highlight> can collate the identification information AID of the card adapter <highlight><bold>5004</bold></highlight> itself with the identification information KID of the card P which is being inserted into the card adapter <highlight><bold>5004</bold></highlight> before it is decided on the basis of the license information whether reproduction is enabled, so the information security can be further improved. </paragraph>
<paragraph id="P-0722" lvl="0"><number>&lsqb;0722&rsqb;</number> As shown in <cross-reference target="DRAWINGS">FIG. 125</cross-reference>, to safely distribute the disk key from the license creation device <highlight><bold>5001</bold></highlight> to the information reproducing apparatus on the user side, the respective devices on the distribution route hold the following secret information. </paragraph>
<paragraph id="P-0723" lvl="2"><number>&lsqb;0723&rsqb;</number> The license creation device <highlight><bold>5001</bold></highlight> holds the encryption key ke for encrypting the disk information, and the card adapter <highlight><bold>5004</bold></highlight> holds the decoding key kd for decoding the disk information. </paragraph>
<paragraph id="P-0724" lvl="2"><number>&lsqb;0724&rsqb;</number> The card adapter <highlight><bold>5004</bold></highlight> and the license issuing device <highlight><bold>5003</bold></highlight> share a number x(1), a key generation algorithm Al(Pl) for generating a given key upon receiving a corresponding seed, and a sufficiently large prime number Prl, which are used for mutual authentication and encryption/decoding of the license information. These pieces of information are used for mutual authentication and encryption/decoding of the license information. In this case, Pl is a parameter of the algorithm Al, and the card adapter <highlight><bold>5004</bold></highlight> and the license issuing device <highlight><bold>5003</bold></highlight> share the algorithm Al and the parameter Pl. X(l), Al, Pl, and Prl are stored in the card adapter <highlight><bold>5004</bold></highlight> and the license issuing device <highlight><bold>5003</bold></highlight> while being protected to prevent these pieces of information from externally being read. </paragraph>
<paragraph id="P-0725" lvl="2"><number>&lsqb;0725&rsqb;</number> The license issuing device <highlight><bold>5003</bold></highlight> and the card P share a number X(k), a key generation algorithm Ak(Pk) for generating a given key upon receiving a corresponding seed, and a sufficiently large prime number Prk. These pieces of information are used for mutual authentication and encryption/decoding of the identification information KID of the card P. In this case, Pk is a parameter of the algorithm Ak, and the license issuing device <highlight><bold>5003</bold></highlight> and the card P share the algorithm Ak and the parameter Pk. X(k), Ak, Pk, and Prk are stored in the license issuing device <highlight><bold>5003</bold></highlight> and the card P while being protected to prevent these pieces of information from externally being read. </paragraph>
<paragraph id="P-0726" lvl="2"><number>&lsqb;0726&rsqb;</number> The card adapter <highlight><bold>5004</bold></highlight> and the card P share the number X(k), the key generation algorithm Ak(Pk) for generating a given key upon receiving a corresponding seed, and the sufficiently large prime number Prk. These pieces of information are used for mutual authentication and encryption/decoding of the identification information KID of the card P. In this case, Pk is a parameter of the algorithm Ak, and the card adapter <highlight><bold>5004</bold></highlight> and the card P share the algorithm Ak and the parameter Pk. X(k), Ak, Pk, and Prk are stored in the card adapter <highlight><bold>5004</bold></highlight> and the card P while being protected to prevent these pieces of information from externally being read. </paragraph>
<paragraph id="P-0727" lvl="2"><number>&lsqb;0727&rsqb;</number> The card adapter <highlight><bold>5004</bold></highlight> and the player <highlight><bold>5005</bold></highlight> share a number X(D), a key generation algorithm AD(PD) for generating a given key upon receiving a corresponding seed, and a sufficiently large prime number PrD. These pieces of information are used for mutual authentication and encryption/decoding of the disk key. In this case, PD is a parameter of the algorithm AD, and the card adapter <highlight><bold>5004</bold></highlight> and the player <highlight><bold>5005</bold></highlight> share the algorithm AD and the parameter PD. X(D), AD, PD, and PrD are stored in the card adapter <highlight><bold>5004</bold></highlight> and the player <highlight><bold>5005</bold></highlight> while being protected to prevent these pieces of information from externally being read. </paragraph>
<paragraph id="P-0728" lvl="2"><number>&lsqb;0728&rsqb;</number> The player <highlight><bold>5005</bold></highlight> stores a decoding key KpD, the card P stores a decoding key KpC, the card adapter <highlight><bold>5004</bold></highlight> stores a decoding key KpA, and the license issuing device <highlight><bold>5003</bold></highlight> stores a decoding key KpL while protecting them to prevent them from externally being read. The decoding keys KpD, KpC, KpA, and KpL are public keys of the public key cipher scheme. The license creation device <highlight><bold>5001</bold></highlight> holds four secret keys KsD, KsA, KsC, and KsL corresponding to these public keys. The public keys and secret keys are used to update the numbers X(l), X(k), and X(D), the parameters Pl, Pk, and PD, and the prime numbers Prl, Prk, and PrD. </paragraph>
<paragraph id="P-0729" lvl="0"><number>&lsqb;0729&rsqb;</number> As described above, the disk key is subjected to double protection using a cipher technique and distributed. </paragraph>
<paragraph id="P-0730" lvl="0"><number>&lsqb;0730&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 126</cross-reference> shows an arrangement of the license creation device <highlight><bold>5001</bold></highlight>. The arrangement and disk information generation processing of the license creation device <highlight><bold>5001</bold></highlight> will be described below with reference to the flow chart shown in <cross-reference target="DRAWINGS">FIG. 131</cross-reference>. </paragraph>
<paragraph id="P-0731" lvl="0"><number>&lsqb;0731&rsqb;</number> Disk information is generated every, e.g., <highlight><bold>12</bold></highlight> hours. For the descriptive convenience, a watchable period (valid period) is used as the license condition of contents, and disk information which grants a license with a contents watchable period of one week is generated. </paragraph>
<paragraph id="P-0732" lvl="0"><number>&lsqb;0732&rsqb;</number> Assume that the watchable period starts at 0:00 and 12:00. The license creation device <highlight><bold>5001</bold></highlight> starts to generate disk information, e.g., three hours before that time. That is, generation of disk information starts at 21:00 and 9:00. Generation of disk information for granting a license whose watchable period starts at 9:00 will be described. At 9:00, a disk information generation instruction is issued from a clock <highlight><bold>5001</bold></highlight><highlight><italic>a </italic></highlight>to an information acquisition section <highlight><bold>5001</bold></highlight><highlight><italic>b </italic></highlight>(steps S<highlight><bold>5001</bold></highlight> and S<highlight><bold>5002</bold></highlight>). The information acquisition section <highlight><bold>5001</bold></highlight><highlight><italic>b </italic></highlight>transmits current date information (e.g., 9:00, Apr. 2, 1981) received from the clock <highlight><bold>5001</bold></highlight><highlight><italic>a </italic></highlight>to a valid period generation section <highlight><bold>5001</bold></highlight><highlight><italic>c </italic></highlight>(step S<highlight><bold>5003</bold></highlight>). </paragraph>
<paragraph id="P-0733" lvl="0"><number>&lsqb;0733&rsqb;</number> The valid period generation section <highlight><bold>5001</bold></highlight><highlight><italic>c </italic></highlight>returns, to the information acquisition section <highlight><bold>5001</bold></highlight><highlight><italic>b</italic></highlight>, the expiration date (e.g., 12:00, Apr. 9, 1981) after one week calculated from 12:00 of the day on the basis of the date information (step S<highlight><bold>5004</bold></highlight>). The information acquisition section <highlight><bold>5001</bold></highlight><highlight><italic>b </italic></highlight>reads out a pair of information, i.e., the disk ID and the disk key from the contents DB <highlight><bold>5002</bold></highlight>, merges them with the expiration date to generate disk information, and transfers it to a first encryption section <highlight><bold>5001</bold></highlight><highlight><italic>d </italic></highlight>(step S<highlight><bold>5005</bold></highlight>). The disk information contains the disk ID, the disk key, and the expiration date. </paragraph>
<paragraph id="P-0734" lvl="0"><number>&lsqb;0734&rsqb;</number> The first encryption section <highlight><bold>5001</bold></highlight><highlight><italic>d </italic></highlight>reads out the encryption key ke from a first encryption key storage section <highlight><bold>5001</bold></highlight><highlight><italic>e </italic></highlight>and encrypts the disk information (step S<highlight><bold>5006</bold></highlight>). The encrypted disk information is added with an unencrypted disk key and distributed to the license issuing device <highlight><bold>5003</bold></highlight> through a predetermined network (step S<highlight><bold>5007</bold></highlight>). </paragraph>
<paragraph id="P-0735" lvl="0"><number>&lsqb;0735&rsqb;</number> Processing in steps S<highlight><bold>5005</bold></highlight> to S<highlight><bold>5007</bold></highlight> is repeated, thereby generating disk information for all contents IDs registered in the contents DB <highlight><bold>5002</bold></highlight> (step S<highlight><bold>5008</bold></highlight>). </paragraph>
<paragraph id="P-0736" lvl="0"><number>&lsqb;0736&rsqb;</number> The license issuing device <highlight><bold>5003</bold></highlight> stores the encrypted disk information received from the license creation device <highlight><bold>5001</bold></highlight> in an internal license DB <highlight><bold>5003</bold></highlight><highlight><italic>f </italic></highlight>(<cross-reference target="DRAWINGS">FIG. 127</cross-reference>) in correspondence with the disk ID, as shown in <cross-reference target="DRAWINGS">FIG. 132</cross-reference>. </paragraph>
<paragraph id="P-0737" lvl="0"><number>&lsqb;0737&rsqb;</number> It is important to insert the expiration date into the disk information. Although the license issuing device <highlight><bold>5003</bold></highlight> is set in the shop and can hardly be attacked, robbery may happen. However, since the disk information containing the expiration date does not guarantee a permanent license, the motive for theft of the license issuing device <highlight><bold>5003</bold></highlight> weakens. In addition, to decode the disk information and steal the permanent license (i.e., acquire the disk key), the decoding key kd stored in the card adapter <highlight><bold>5004</bold></highlight> and the secret information for encrypting/decoding the disk information must be stolen. However, when both the decoding key kd and the secret information are strictly protected on the hardware side, such theft is very difficult. </paragraph>
<paragraph id="P-0738" lvl="0"><number>&lsqb;0738&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 127</cross-reference> shows an arrangement of the license issuing device <highlight><bold>5003</bold></highlight>. </paragraph>
<paragraph id="P-0739" lvl="0"><number>&lsqb;0739&rsqb;</number> The card P is inserted into a card insertion section <highlight><bold>5003</bold></highlight><highlight><italic>a</italic></highlight>. When a card insertion confirmation section <highlight><bold>5003</bold></highlight><highlight><italic>b </italic></highlight>confirms that the card P is normally inserted, the card P and the license issuing device <highlight><bold>5003</bold></highlight> can communicate through the card insertion section <highlight><bold>5003</bold></highlight><highlight><italic>a. </italic></highlight></paragraph>
<paragraph id="P-0740" lvl="0"><number>&lsqb;0740&rsqb;</number> A random number generation section <highlight><bold>5003</bold></highlight><highlight><italic>k </italic></highlight>generates random numbers al, cl, and ak to be used to encrypt/decode the ID of the card P (KID), the ID of the card adapter <highlight><bold>5004</bold></highlight> (AID), and license information (Lic). </paragraph>
<paragraph id="P-0741" lvl="0"><number>&lsqb;0741&rsqb;</number> The secret parameters X(l), Prl, X(k), and Prk are stored in a base storage section <highlight><bold>5003</bold></highlight><highlight><italic>m </italic></highlight>in advance. </paragraph>
<paragraph id="P-0742" lvl="0"><number>&lsqb;0742&rsqb;</number> A power calculation section <highlight><bold>5003</bold></highlight><highlight><italic>j </italic></highlight>calculates public parameters (first seed generation information to third seed generation information) from the random numbers generated by the random number generation section <highlight><bold>5003</bold></highlight><highlight><italic>k </italic></highlight>and the secret parameters stored in the base storage section <highlight><bold>5003</bold></highlight><highlight><italic>m</italic></highlight>. The power calculation section <highlight><bold>5003</bold></highlight><highlight><italic>j </italic></highlight>also generates a first seed from first seed generation information transferred from the card P and the random number ak generated by the random number generation section <highlight><bold>5003</bold></highlight><highlight><italic>k</italic></highlight>. A second seed is also generated from second seed generation information transferred from the card adapter <highlight><bold>5004</bold></highlight> through the card P and the random number al generated by the random number generation section <highlight><bold>5003</bold></highlight><highlight><italic>k</italic></highlight>. A third seed is also generated from the second seed generation information transferred from the card adapter <highlight><bold>5004</bold></highlight> through the card P and the random number cl generated by the random number generation section <highlight><bold>5003</bold></highlight><highlight><italic>k. </italic></highlight></paragraph>
<paragraph id="P-0743" lvl="0"><number>&lsqb;0743&rsqb;</number> For example, the second seed generation information X(l)<highlight><superscript>al</superscript></highlight>(mod Prl) is calculated from the random number al and the secret parameters (X(l) and Prl). A power will be represented as &ldquo;X(l)&circ; al&rdquo; using &ldquo;&circ; &rdquo; hereinafter. In addition, &ldquo;mod&rdquo; represents the residue (in this case, the residue obtained by multiplying X(l)<highlight><superscript>al </superscript></highlight>by the prime number Prl). In addition, the first seed generation information X(k)&circ; ak(mod Prk) is calculated from the random number ak and the secret parameters (X(k) and Prk). </paragraph>
<paragraph id="P-0744" lvl="0"><number>&lsqb;0744&rsqb;</number> A common key generation section <highlight><bold>50031</bold></highlight> stores the key generation algorithms Al(Pl) and Ak(Pk) in advance. The algorithm Ak(Pk) is applied to the first seed to generate a first common key wk<highlight><bold>1</bold></highlight>. The algorithm Al(Pl) is applied to the second seed to generate a second common key wl<highlight><bold>1</bold></highlight>. The algorithm Al(Pl) is applied to the third seed to generate the third common key wl<highlight><bold>2</bold></highlight>. By applying the algorithms Al(Pl) and Ak(Pk) to the first to third seeds, the data length of each of the first to third seeds can be reduced. </paragraph>
<paragraph id="P-0745" lvl="0"><number>&lsqb;0745&rsqb;</number> A decoder section <highlight><bold>5003</bold></highlight><highlight><italic>d </italic></highlight>decodes the encrypted card ID (&lsqb;KID&rsqb; wk<highlight><bold>1</bold></highlight>) and the encrypted card adapter ID (&lsqb;AID&rsqb; wl<highlight><bold>1</bold></highlight>) using the common keys wk<highlight><bold>1</bold></highlight> and wl<highlight><bold>1</bold></highlight> generated by the common key generation section <highlight><bold>50031</bold></highlight>. </paragraph>
<paragraph id="P-0746" lvl="0"><number>&lsqb;0746&rsqb;</number> The disk D for the rental use by the user is inserted into a disk connection section <highlight><bold>5003</bold></highlight><highlight><italic>g </italic></highlight>to read the ID (DID) of the disk D. </paragraph>
<paragraph id="P-0747" lvl="0"><number>&lsqb;0747&rsqb;</number> A card database (DB) <highlight><bold>5003</bold></highlight><highlight><italic>i </italic></highlight>stores the correspondence between the ID of the card P issued to the user and the ID of the corresponding card adapter <highlight><bold>5004</bold></highlight>. </paragraph>
<paragraph id="P-0748" lvl="0"><number>&lsqb;0748&rsqb;</number> The license database (DB) <highlight><bold>5003</bold></highlight><highlight><italic>f </italic></highlight>stores the encrypted disk information transferred from the license creation device <highlight><bold>5001</bold></highlight>. As shown in <cross-reference target="DRAWINGS">FIG. 132</cross-reference>, the encrypted disk information is stored in correspondence with the disk ID (DID). </paragraph>
<paragraph id="P-0749" lvl="0"><number>&lsqb;0749&rsqb;</number> A license generation section <highlight><bold>5003</bold></highlight><highlight><italic>e </italic></highlight>generates a license for a disk when the user is to rent the disk. More specifically, the encrypted disk information is retrieved from the license DB <highlight><bold>5003</bold></highlight><highlight><italic>f </italic></highlight>using the ID (DID) of the disk D, which is read by the disk connection section <highlight><bold>5003</bold></highlight><highlight><italic>g</italic></highlight>, as a key, the IDs (KID and AID) of the card P and the card adapter <highlight><bold>5004</bold></highlight> of the user are read out from the card DB <highlight><bold>5003</bold></highlight><highlight><italic>i</italic></highlight>, and the current time is read from a clock <highlight><bold>5003</bold></highlight><highlight><italic>h</italic></highlight>, thereby generating license information containing the encrypted disk information, the license generation time, and the identification information KID and AID. </paragraph>
<paragraph id="P-0750" lvl="0"><number>&lsqb;0750&rsqb;</number> The generated license information is encrypted using the common key wl<highlight><bold>2</bold></highlight> generated on the basis of the public parameters exchanged with the card adapter <highlight><bold>5004</bold></highlight> through the card P. </paragraph>
<paragraph id="P-0751" lvl="0"><number>&lsqb;0751&rsqb;</number> A control section <highlight><bold>5003</bold></highlight><highlight><italic>c </italic></highlight>controls the entire license issuing device <highlight><bold>5003</bold></highlight>. </paragraph>
<paragraph id="P-0752" lvl="0"><number>&lsqb;0752&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 128</cross-reference> shows an arrangement of the card P. </paragraph>
<paragraph id="P-0753" lvl="0"><number>&lsqb;0753&rsqb;</number> The card P is connected to the license issuing device <highlight><bold>5003</bold></highlight> or card adapter <highlight><bold>5004</bold></highlight> through a device insertion section <highlight><bold>5101</bold></highlight>. When a device insertion confirmation section <highlight><bold>5102</bold></highlight> confirms that the card P is normally inserted into the license issuing device <highlight><bold>5003</bold></highlight> or card adapter <highlight><bold>5004</bold></highlight>, the card P and the card adapter <highlight><bold>5003</bold></highlight> or card adapter <highlight><bold>5004</bold></highlight> can communicate through the device insertion section <highlight><bold>5101</bold></highlight>. </paragraph>
<paragraph id="P-0754" lvl="0"><number>&lsqb;0754&rsqb;</number> A random number generation section <highlight><bold>5107</bold></highlight> generates random numbers bk and dk to be used to encrypt/decode the card ID (KID) before the ID (KID) of the card P is transferred to the license issuing device <highlight><bold>5003</bold></highlight> or card adapter <highlight><bold>5004</bold></highlight>. </paragraph>
<paragraph id="P-0755" lvl="0"><number>&lsqb;0755&rsqb;</number> A base storage section <highlight><bold>5109</bold></highlight> stores the secret parameters X(k) and Prk in advance. </paragraph>
<paragraph id="P-0756" lvl="0"><number>&lsqb;0756&rsqb;</number> A power calculation section <highlight><bold>5106</bold></highlight> calculates public parameters (first seed generation information and fifth seed generation information) from the random numbers generated by the random number generation section <highlight><bold>5107</bold></highlight> and the secret parameters stored in the base storage section <highlight><bold>5109</bold></highlight>. The power calculation section <highlight><bold>5106</bold></highlight> also generates the first seed from the first seed generation information transferred from the license issuing device <highlight><bold>5003</bold></highlight> and the random number bk generated by the random number generation section <highlight><bold>5107</bold></highlight>. A fifth seed is also generated from the fifth seed generation information transferred from the card adapter <highlight><bold>5004</bold></highlight> and the random number dk generated by the random number generation section <highlight><bold>5107</bold></highlight>. </paragraph>
<paragraph id="P-0757" lvl="0"><number>&lsqb;0757&rsqb;</number> A common key generation section <highlight><bold>5108</bold></highlight> stores the key generation algorithm Ak(Pk) in advance. The algorithm Ak(Pk) is applied to the first seed to generate the first common key wk<highlight><bold>1</bold></highlight>. The algorithm Ak(Pk) is applied to the fifth seed to generate the fifth common key wl<highlight><bold>1</bold></highlight>. By applying the key generation algorithm Ak(Pk) to the first and fifth seeds, the data length of each of the first and fifth seeds can be reduced. </paragraph>
<paragraph id="P-0758" lvl="0"><number>&lsqb;0758&rsqb;</number> A KID storage section <highlight><bold>5105</bold></highlight> stores the ID (identification information) for uniquely identifying the card P, i.e., KID in advance. </paragraph>
<paragraph id="P-0759" lvl="0"><number>&lsqb;0759&rsqb;</number> A KID encryption section <highlight><bold>5104</bold></highlight> encrypts the KID stored in the KID storage section <highlight><bold>5105</bold></highlight> using the common keys wk<highlight><bold>1</bold></highlight> and wk<highlight><bold>2</bold></highlight> generated by the common key generation section <highlight><bold>5108</bold></highlight>. </paragraph>
<paragraph id="P-0760" lvl="0"><number>&lsqb;0760&rsqb;</number> A control section <highlight><bold>5103</bold></highlight> controls the entire card P. </paragraph>
<paragraph id="P-0761" lvl="0"><number>&lsqb;0761&rsqb;</number> The card P is inserted into a card insertion section <highlight><bold>5004</bold></highlight><highlight><italic>a</italic></highlight>. When a card insertion confirmation section <highlight><bold>5004</bold></highlight><highlight><italic>b </italic></highlight>confirms that the card P is normally inserted, the card P and the card adapter <highlight><bold>5004</bold></highlight> can communicate through the card insertion section <highlight><bold>5004</bold></highlight><highlight><italic>a. </italic></highlight></paragraph>
<paragraph id="P-0762" lvl="0"><number>&lsqb;0762&rsqb;</number> A random number generation section <highlight><bold>5004</bold></highlight><highlight><italic>k </italic></highlight>generates random numbers bl, aD, ck, and dD to be used to encrypt/decode the ID (AID) of the card adapter <highlight><bold>5004</bold></highlight> itself, which is stored in an AID storage section <highlight><bold>5004</bold></highlight><highlight><italic>f </italic></highlight>in advance, the license information (Lic), the ID (DID) of the disk D set in the player, the ID (KID) of the card P, and the disk key. </paragraph>
<paragraph id="P-0763" lvl="0"><number>&lsqb;0763&rsqb;</number> A random number storage section <highlight><bold>50041</bold></highlight> stores the random numbers b<highlight><bold>1</bold></highlight>, aD, and ck generated by the random number generation section <highlight><bold>5004</bold></highlight><highlight><italic>k. </italic></highlight></paragraph>
<paragraph id="P-0764" lvl="0"><number>&lsqb;0764&rsqb;</number> A base storage section <highlight><bold>5004</bold></highlight><highlight><italic>m </italic></highlight>stores the secret parameters X(l), Prl, X(k), Prk, X(D), and PrD in advance. </paragraph>
<paragraph id="P-0765" lvl="0"><number>&lsqb;0765&rsqb;</number> A power calculation section <highlight><bold>5004</bold></highlight><highlight><italic>j </italic></highlight>calculates public parameters (second seed generation information, fourth seed generation information, fifth seed generation information, and sixth seed generation information) from the random numbers generated by the random number generation section <highlight><bold>5004</bold></highlight><highlight><italic>k </italic></highlight>and the secret parameters stored in the base storage section <highlight><bold>5004</bold></highlight><highlight><italic>m</italic></highlight>. The power calculation section <highlight><bold>5004</bold></highlight><highlight><italic>j </italic></highlight>also generates a second seed from the second seed generation information transferred from the license issuing device <highlight><bold>5003</bold></highlight> through the card P and the random number bl generated by the random number generation section <highlight><bold>5004</bold></highlight><highlight><italic>k</italic></highlight>. A third seed is also generated from the third seed generation information transferred from the license issuing device <highlight><bold>5003</bold></highlight> through the card P and the random number bl generated by the random number generation section <highlight><bold>5004</bold></highlight><highlight><italic>k</italic></highlight>. A fourth seed is also generated from the fourth seed generation information transferred from the player <highlight><bold>5005</bold></highlight> and the random number aD generated by the random number generation section <highlight><bold>5004</bold></highlight><highlight><italic>k</italic></highlight>. A fifth seed is also generated from the fifth seed generation information transferred from the card P and the random number ck generated by the random number generation section <highlight><bold>5004</bold></highlight><highlight><italic>k</italic></highlight>. A sixth seed is also generated from the sixth seed generation information transferred from the player <highlight><bold>5005</bold></highlight> and the random number dD generated by the random number generation section <highlight><bold>5004</bold></highlight><highlight><italic>k. </italic></highlight></paragraph>
<paragraph id="P-0766" lvl="0"><number>&lsqb;0766&rsqb;</number> A common key generation section <highlight><bold>5004</bold></highlight><highlight><italic>i </italic></highlight>stores the key generation algorithms Al(Pl), Ak(Pk), and AD(PD) in advance. The algorithm Al(Pl) is applied to the second seed to generate the second common key wl<highlight><bold>1</bold></highlight>. The algorithm Al(Pl) is applied to the third seed to generate the third common key wl<highlight><bold>2</bold></highlight>. The algorithm AD(PD) is applied to the fourth seed to generate a fourth common key wD<highlight><bold>1</bold></highlight>. The algorithm Ak(Pk) is applied to the fifth seed to generate the fifth common key wk<highlight><bold>2</bold></highlight>. The algorithm AD(PD) is applied to the sixth seed to generate a sixth common key wD<highlight><bold>2</bold></highlight>. By applying the key generation algorithms Al(Pl), Ak(Pk), and AD(PD) to the second to sixth seeds, the data length of each of the second to sixth seeds can be reduced. </paragraph>
<paragraph id="P-0767" lvl="0"><number>&lsqb;0767&rsqb;</number> An encryption/decoder section <highlight><bold>5004</bold></highlight><highlight><italic>o </italic></highlight>encrypts the disk key using the common key wD<highlight><bold>2</bold></highlight> generated by the common key generation section <highlight><bold>5004</bold></highlight><highlight><italic>i</italic></highlight>. The encryption/decoder section <highlight><bold>5004</bold></highlight><highlight><italic>o </italic></highlight>also decodes the encrypted license information &lsqb;Lic&rsqb; wl<highlight><bold>2</bold></highlight>, the encrypted disk ID &lsqb;DID&rsqb; wD<highlight><bold>1</bold></highlight>, and the encrypted card ID &lsqb;KID&rsqb; wk<highlight><bold>2</bold></highlight> using the common keys wl<highlight><bold>2</bold></highlight>, wD<highlight><bold>1</bold></highlight>, and wk<highlight><bold>2</bold></highlight> generated by the common key generation section <highlight><bold>5004</bold></highlight><highlight><italic>i. </italic></highlight></paragraph>
<paragraph id="P-0768" lvl="0"><number>&lsqb;0768&rsqb;</number> The AID storage section <highlight><bold>5004</bold></highlight><highlight><italic>f </italic></highlight>stores the ID (identification information), i.e., AID for uniquely identifying the card adapter <highlight><bold>5004</bold></highlight> in advance. </paragraph>
<paragraph id="P-0769" lvl="0"><number>&lsqb;0769&rsqb;</number> An AID encryption section <highlight><bold>5004</bold></highlight><highlight><italic>d </italic></highlight>encrypts the AID stored in the AID storage section <highlight><bold>5004</bold></highlight><highlight><italic>f </italic></highlight>using the common key wl<highlight><bold>1</bold></highlight> generated by the common key generation section <highlight><bold>5004</bold></highlight><highlight><italic>i. </italic></highlight></paragraph>
<paragraph id="P-0770" lvl="0"><number>&lsqb;0770&rsqb;</number> A kd storage section <highlight><bold>5004</bold></highlight><highlight><italic>g </italic></highlight>stores the decoding key kd for decoding the disk information encrypted using the encryption key ke. </paragraph>
<paragraph id="P-0771" lvl="0"><number>&lsqb;0771&rsqb;</number> The player <highlight><bold>5005</bold></highlight> is connected to a player connection section <highlight><bold>5004</bold></highlight><highlight><italic>n </italic></highlight>to communicate with the card adapter <highlight><bold>5004</bold></highlight>. </paragraph>
<paragraph id="P-0772" lvl="0"><number>&lsqb;0772&rsqb;</number> A license decision section <highlight><bold>5004</bold></highlight><highlight><italic>e </italic></highlight>decodes the encrypted disk information contained in the license information transferred from the license issuing device <highlight><bold>5003</bold></highlight> through the card P using the decoding key kd. In license decision processing (<cross-reference target="DRAWINGS">FIGS. 139 and 140</cross-reference>), the following conditions are checked. </paragraph>
<paragraph id="P-0773" lvl="2"><number>&lsqb;0773&rsqb;</number> Whether the card ID (KID) and card adapter ID (AID) contained in the license information match the card ID (KID) of the card P inserted into the license decision section <highlight><bold>5004</bold></highlight><highlight><italic>e </italic></highlight>and the card adapter ID (AID) stored in the AID storage section <highlight><bold>5004</bold></highlight><highlight><italic>f</italic></highlight>, respectively. </paragraph>
<paragraph id="P-0774" lvl="2"><number>&lsqb;0774&rsqb;</number> Whether the license information generation time is earlier than the current time indicated by a clock <highlight><bold>5004</bold></highlight><highlight><italic>h. </italic></highlight></paragraph>
<paragraph id="P-0775" lvl="2"><number>&lsqb;0775&rsqb;</number> Whether the disk ID (DID) contained in the disk information matches the ID of the disk D which is currently being set in the player <highlight><bold>5005</bold></highlight>. </paragraph>
<paragraph id="P-0776" lvl="2"><number>&lsqb;0776&rsqb;</number> Whether the current time indicated by the clock <highlight><bold>5004</bold></highlight><highlight><italic>h </italic></highlight>satisfies the expiration date contained in the disk information. </paragraph>
<paragraph id="P-0777" lvl="0"><number>&lsqb;0777&rsqb;</number> When the above conditions are satisfied, the license decision section <highlight><bold>5004</bold></highlight><highlight><italic>e </italic></highlight>outputs the disk key contained in the disk information to the player <highlight><bold>5005</bold></highlight>. At this time, the disk key is encrypted using the common key wD<highlight><bold>2</bold></highlight> generated on the basis of the sixth seed generation information exchanged with the player <highlight><bold>5005</bold></highlight> through the player connection section <highlight><bold>5004</bold></highlight><highlight><italic>n. </italic></highlight></paragraph>
<paragraph id="P-0778" lvl="0"><number>&lsqb;0778&rsqb;</number> The card adapter <highlight><bold>5004</bold></highlight> is connected to a card adapter connection section <highlight><bold>5005</bold></highlight><highlight><italic>a </italic></highlight>to communicate with the player <highlight><bold>5005</bold></highlight>. </paragraph>
<paragraph id="P-0779" lvl="0"><number>&lsqb;0779&rsqb;</number> A random number generation section <highlight><bold>5005</bold></highlight><highlight><italic>i </italic></highlight>generates random numbers bD and cD to be used to encrypt/decode the disk key and the ID (DID) of the disk D, which is read from the disk D set in a disk drive <highlight><bold>5005</bold></highlight><highlight><italic>d. </italic></highlight></paragraph>
<paragraph id="P-0780" lvl="0"><number>&lsqb;0780&rsqb;</number> A random number storage section <highlight><bold>5005</bold></highlight><highlight><italic>k </italic></highlight>stores the random number cD generated by the random number generation section <highlight><bold>5005</bold></highlight><highlight><italic>i. </italic></highlight></paragraph>
<paragraph id="P-0781" lvl="0"><number>&lsqb;0781&rsqb;</number> A base storage section <highlight><bold>50051</bold></highlight> stores the secret parameters X(D) and PrD in advance. </paragraph>
<paragraph id="P-0782" lvl="0"><number>&lsqb;0782&rsqb;</number> A power calculation section <highlight><bold>5005</bold></highlight><highlight><italic>h </italic></highlight>calculates public parameters (fourth seed generation information and sixth seed generation information) from the random numbers generated by the random number generation section <highlight><bold>5005</bold></highlight><highlight><italic>i </italic></highlight>and the secret parameters stored in the base storage section <highlight><bold>50051</bold></highlight>. The power calculation section <highlight><bold>5005</bold></highlight><highlight><italic>h </italic></highlight>also generates a fourth seed from the fourth seed generation information transferred from the card adapter <highlight><bold>5004</bold></highlight> and the random number bD generated by the random number generation section <highlight><bold>5005</bold></highlight><highlight><italic>i</italic></highlight>. A sixth seed is also generated from the sixth seed generation information transferred from the card adapter <highlight><bold>5004</bold></highlight> and the random number cD generated by the random number generation section <highlight><bold>5005</bold></highlight><highlight><italic>i. </italic></highlight></paragraph>
<paragraph id="P-0783" lvl="0"><number>&lsqb;0783&rsqb;</number> A common key generation section <highlight><bold>5005</bold></highlight><highlight><italic>j </italic></highlight>stores the key generation algorithm AD (PD) in advance. The algorithm AD(PD) is applied to the fourth seed to generate the common key wD<highlight><bold>1</bold></highlight>. The algorithm AD(PD) is applied to the sixth seed to generate the common key wD<highlight><bold>2</bold></highlight>. By applying the key generation algorithm AD(PD) to the fourth and sixth seeds, the data length of each of the fourth and sixth seeds can be reduced. </paragraph>
<paragraph id="P-0784" lvl="0"><number>&lsqb;0784&rsqb;</number> The disk D is set in the disk drive <highlight><bold>5005</bold></highlight><highlight><italic>d</italic></highlight>, and the disk ID (DID), the encrypted contents information, and the encrypted contents key stored in the disk D are read. The disk ID (DID) is transferred to a DID encryption section <highlight><bold>5005</bold></highlight><highlight><italic>c</italic></highlight>, and the encrypted contents information and the encrypted contents key are transferred to a reproduction section <highlight><bold>5005</bold></highlight><highlight><italic>f. </italic></highlight></paragraph>
<paragraph id="P-0785" lvl="0"><number>&lsqb;0785&rsqb;</number> The DID encryption section <highlight><bold>5005</bold></highlight><highlight><italic>c </italic></highlight>encrypts the disk ID (DID) using the common key wD<highlight><bold>1</bold></highlight> generated by the common key generation section <highlight><bold>5005</bold></highlight><highlight><italic>j. </italic></highlight></paragraph>
<paragraph id="P-0786" lvl="0"><number>&lsqb;0786&rsqb;</number> A disk key decoder section <highlight><bold>5005</bold></highlight><highlight><italic>e </italic></highlight>decodes the encrypted disk key &lsqb;disk key&rsqb; wD<highlight><bold>2</bold></highlight> using the common key wD<highlight><bold>2</bold></highlight> generated by the common key generation section <highlight><bold>5005</bold></highlight><highlight><italic>j</italic></highlight>. The decoded disk key is transferred to the reproduction section <highlight><bold>5005</bold></highlight><highlight><italic>f. </italic></highlight></paragraph>
<paragraph id="P-0787" lvl="0"><number>&lsqb;0787&rsqb;</number> The reproduction section <highlight><bold>5005</bold></highlight><highlight><italic>f </italic></highlight>decodes the encrypted contents key using the disk key, decodes the encrypted contents information using the decoded contents key, reproduces the contents information, and outputs it to an output section <highlight><bold>5005</bold></highlight><highlight><italic>g. </italic></highlight></paragraph>
<paragraph id="P-0788" lvl="0"><number>&lsqb;0788&rsqb;</number> The disk key distribution procedure in the information distribution system shown in <cross-reference target="DRAWINGS">FIG. 122</cross-reference> will be sequentially described next with reference to the view shown in <cross-reference target="DRAWINGS">FIG. 133</cross-reference> and the flow charts shown in FIGS. <highlight><bold>134</bold></highlight> to <highlight><bold>140</bold></highlight> about the subscription to a disk rental service, rental of a disk, and reproduction of contents. </paragraph>
<paragraph id="P-0789" lvl="0"><number>&lsqb;0789&rsqb;</number> The subscription to a disk rental service will be described first. </paragraph>
<paragraph id="P-0790" lvl="0"><number>&lsqb;0790&rsqb;</number> Step x1: The card P issued to the user is inserted into the license issuing device <highlight><bold>5003</bold></highlight>. The license issuing device <highlight><bold>5003</bold></highlight> generates the random number al. To acquire the ID (AID) of the card adapter <highlight><bold>5004</bold></highlight>, a public parameter necessary for encrypting the AID, i.e., the second seed generation information X(l)&circ; al(mod Prl) is calculated from the random number al and the secret parameters (X(l) and Prl) and transferred to the card P (steps S<highlight><bold>6001</bold></highlight> to S<highlight><bold>6003</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 134</cross-reference>). </paragraph>
<paragraph id="P-0791" lvl="0"><number>&lsqb;0791&rsqb;</number> Step x2: The license issuing device <highlight><bold>5003</bold></highlight> also generates the random number ak. To acquire the ID (KID) of the card P, the first seed generation information X(k)&circ; ak(mod Prk) is calculated from the random number ak and the secret parameters (X(k) and Prk) and transferred to the card P (steps S<highlight><bold>6010</bold></highlight> and S<highlight><bold>6011</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 135</cross-reference>). </paragraph>
<paragraph id="P-0792" lvl="0"><number>&lsqb;0792&rsqb;</number> Step x3: Upon receiving the first seed generation information, the card P generates the random number bk. The first seed (X(k)&circ; ak)&circ; bk&equals;X(k)&circ; (ak&middot;bk)(mod Prk) is calculated from the random number bk and the first seed generation information. The algorithm Ak(Pk) stored in advance is applied to the first seed to generate the common key wk<highlight><bold>1</bold></highlight>. The ID (KID) of the card P is encrypted using the common key wk<highlight><bold>1</bold></highlight>. The KID encrypted using the common key wk<highlight><bold>1</bold></highlight> will be represented as &lsqb;KID&rsqb; wk<highlight><bold>1</bold></highlight> hereinafter. The first seed generation information X(k)&circ; bk(mod Prk) necessary for decoding &lsqb;KID&rsqb; wk<highlight><bold>1</bold></highlight> is calculated from the random number bk and the secret parameters (X(k) and Prk). The &lsqb;KID&rsqb; wk<highlight><bold>1</bold></highlight> and the first seed generation information are transferred to the license issuing device <highlight><bold>5003</bold></highlight> (steps S<highlight><bold>6012</bold></highlight> to S<highlight><bold>6016</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 135</cross-reference>). </paragraph>
<paragraph id="P-0793" lvl="0"><number>&lsqb;0793&rsqb;</number> The license issuing device <highlight><bold>5003</bold></highlight> generate the first seed from the first seed generation information transferred from the card P and the previously generated random number ak. The algorithm Ak(Pk) is applied to the first seed to generate the common key wk<highlight><bold>1</bold></highlight>. The &lsqb;KID&rsqb; wk<highlight><bold>1</bold></highlight> is decoded to obtain the ID (KID) of the card P (steps S<highlight><bold>6017</bold></highlight> to S<highlight><bold>6019</bold></highlight>). </paragraph>
<paragraph id="P-0794" lvl="0"><number>&lsqb;0794&rsqb;</number> The ID of the card P acquired in the above manner is stored in the card database (DB) <highlight><bold>5003</bold></highlight><highlight><italic>i </italic></highlight>in correspondence with the previously generated random number al (step S<highlight><bold>6021</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 135</cross-reference>). The information stored in the card DB <highlight><bold>5003</bold></highlight><highlight><italic>i </italic></highlight>is used later to decode the ID (AID) of the card adapter, which is acquired through the card P. At this time point, the second seed generation information X(l)&circ; al(mod Prl) received from the license issuing device is stored in the card P. </paragraph>
<paragraph id="P-0795" lvl="2"><number>&lsqb;0795&rsqb;</number> Step x4: The user takes home the card P which has undergone the above-described processing and inserts the card P into the card adapter <highlight><bold>5004</bold></highlight> at home. The card adapter <highlight><bold>5004</bold></highlight> reads the second seed generation information from the card P. The card adapter <highlight><bold>5004</bold></highlight> generates the random number bl and calculates the second seed X(l)&circ; (al&middot;bl)(mod Prl) from the random number bl and the second seed generation information. The algorithm Al(Pl) stored in advance is applied to the second seed to generate the common key wl<highlight><bold>1</bold></highlight>. The identification information AID of the card adapter <highlight><bold>5004</bold></highlight> is encrypted using the common key wl<highlight><bold>1</bold></highlight>. The AID encrypted using the common key wl<highlight><bold>1</bold></highlight> will be represented as &lsqb;AID&rsqb; wl<highlight><bold>1</bold></highlight> hereinafter. </paragraph>
<paragraph id="P-0796" lvl="0"><number>&lsqb;0796&rsqb;</number> Step x5: The second seed generation information X(l)&circ; bl(mod Prl) is calculated from the previously generated random number bl and the secret parameters (X(l) and Prl), and the second seed generation information and the &lsqb;AID&rsqb; wl<highlight><bold>1</bold></highlight> are transferred to the card P (steps S<highlight><bold>6004</bold></highlight> to S<highlight><bold>6009</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 134</cross-reference>). </paragraph>
<paragraph id="P-0797" lvl="0"><number>&lsqb;0797&rsqb;</number> At this time point, the second seed generation information and the &lsqb;AID&rsqb; wl<highlight><bold>1</bold></highlight> are stored in the card P. The second seed generation information X(l)&circ; al(mod Prl) stored previously may be erased from the card P. The card adapter <highlight><bold>5004</bold></highlight> stores the random number bl in the random number storage section <highlight><bold>50041</bold></highlight> to decode the license information later. </paragraph>
<paragraph id="P-0798" lvl="0"><number>&lsqb;0798&rsqb;</number> To rent a disk, the user goes to, e.g., a member shop of the disk rental service (a shop having where the license issuing device <highlight><bold>5003</bold></highlight> is set), selects a desired disk, and presents the disk and the card P to a clerk. </paragraph>
<paragraph id="P-0799" lvl="0"><number>&lsqb;0799&rsqb;</number> Steps x6 and x7: The presented card P and disk D are inserted into the license issuing device <highlight><bold>5003</bold></highlight>. To acquire the ID (KID) of the card P, the license issuing device <highlight><bold>5003</bold></highlight> obtains the identification information of the card P from the card P, as in steps x2 and x3 (step S<highlight><bold>6001</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 134</cross-reference> and steps S<highlight><bold>6010</bold></highlight> to S<highlight><bold>6019</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 135</cross-reference>). The random numbers ak and bk generated at this time do not always match the random numbers ak and bk in steps x2 and x3, though this poses no problem in acquiring the KID. </paragraph>
<paragraph id="P-0800" lvl="0"><number>&lsqb;0800&rsqb;</number> Step x8: The card P transfers the second seed generation information and &lsqb;AID&rsqb; wl<highlight><bold>1</bold></highlight> to the license issuing device <highlight><bold>5003</bold></highlight>. The license issuing device <highlight><bold>5003</bold></highlight> retrieves the random number al corresponding to the card ID (KID) acquired in step x7 from the card DB <highlight><bold>5003</bold></highlight><highlight><italic>i</italic></highlight>. If the card P has undergone the above-described authentic procedure, the random number al corresponding to the card ID (KID) must be registered in the card DB <highlight><bold>5003</bold></highlight><highlight><italic>i</italic></highlight>. The license issuing device <highlight><bold>5003</bold></highlight> calculates the second seed X(l)&circ; (al&middot;bl)(mod Prl) from the second seed generation information transferred from the card P and the retrieved random number al and applies the algorithm Al(Pl) to the second seed to generate the common key wl<highlight><bold>1</bold></highlight>. The &lsqb;AID&rsqb; wl<highlight><bold>1</bold></highlight> is decoded using the common key wl<highlight><bold>1</bold></highlight> to obtain the ID (AID) of the card adapter <highlight><bold>5004</bold></highlight> (steps S<highlight><bold>6020</bold></highlight> and S<highlight><bold>6021</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 135</cross-reference> and steps S<highlight><bold>6022</bold></highlight> to S<highlight><bold>6026</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 136</cross-reference>). </paragraph>
<paragraph id="P-0801" lvl="0"><number>&lsqb;0801&rsqb;</number> The license issuing device <highlight><bold>5003</bold></highlight> stores the identification information AID of the card adapter <highlight><bold>5004</bold></highlight> in the card DB <highlight><bold>5003</bold></highlight><highlight><italic>i </italic></highlight>in correspondence with the identification information of the card P (step S<highlight><bold>6027</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 136</cross-reference>). </paragraph>
<paragraph id="P-0802" lvl="0"><number>&lsqb;0802&rsqb;</number> With the above procedure, the license issuing device <highlight><bold>5003</bold></highlight> can grasp the combination of the card ID (KID) and the card adapter ID (AID) which are given to the user. Even when the user uses a plurality of card adapters, the license issuing device <highlight><bold>5003</bold></highlight> can grasp IDs of all card adapters of the user. In this case, IDs (AIDs) of the plurality of card adapters are stored in the card DB <highlight><bold>5003</bold></highlight><highlight><italic>i </italic></highlight>in correspondence with one card ID (KID). </paragraph>
<paragraph id="P-0803" lvl="0"><number>&lsqb;0803&rsqb;</number> Step x9: On the other hand; the license issuing device <highlight><bold>5003</bold></highlight> acquires the ID (DID) of the inserted disk D from the disk and encrypted disk information corresponding to the disk ID from the license DB <highlight><bold>5003</bold></highlight><highlight><italic>f</italic></highlight>. This encrypted disk information is merged with current time acquired from the clock <highlight><bold>5003</bold></highlight><highlight><italic>h </italic></highlight>as license information generation time. Information (user&apos;s card ID (KID) or card adapter ID (AID)) stored in the card DB <highlight><bold>5003</bold></highlight><highlight><italic>i </italic></highlight>is also merged, as needed, to generate license information (Lic). That is, </paragraph>
<paragraph id="P-0804" lvl="2"><number>&lsqb;0804&rsqb;</number> Lic&equals;encrypted disk information&plus;license information generation time (&plus;AID &plus;KID) </paragraph>
<paragraph id="P-0805" lvl="7"><number>&lsqb;0805&rsqb;</number> Whether the AID and KID are to be inserted into the license information Lic depends on decision of the shop. Alternatively, the license creation device <highlight><bold>5001</bold></highlight> may decide necessity of AID/KID and record the decision contents in the license DB <highlight><bold>5003</bold></highlight><highlight><italic>f </italic></highlight>in correspondence with the card ID (as additional information) (in this case, when the additional information is present, the license issuing device <highlight><bold>5003</bold></highlight> can merge the AID and KID with the license information Lic). Insertion of the AID into the license information Lic section that the license is limited to a specific card adapter. In addition, insertion of the KID into the license information Lic section that the license is limited to a specific card (steps S<highlight><bold>6028</bold></highlight> to S<highlight><bold>6030</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 136</cross-reference>). </paragraph>
<paragraph id="P-0806" lvl="0"><number>&lsqb;0806&rsqb;</number> The license issuing device <highlight><bold>5003</bold></highlight> generates the random number cl. Since the second seed generation information X(l)&circ; bl(mod Prl) has already been read from the card P, the license issuing device <highlight><bold>5003</bold></highlight> calculates the third seed X(l)&circ; (bl&middot;cl)(mod Prl) from the random number cl and the second seed generation information. The algorithm Al(Pl) is applied to the third seed to generate the key wl<highlight><bold>2</bold></highlight>, and the license information Lic is encrypted. The license information Lic encrypted using the common key wl<highlight><bold>2</bold></highlight> will be represented as &lsqb;Lic&rsqb; wl<highlight><bold>2</bold></highlight> hereinafter. A public parameter necessary for decoding the &lsqb;Lic&rsqb; wl<highlight><bold>2</bold></highlight>, i.e., the third seed generation information X(l)&circ; cl(mod Prl) is calculated from the random number cl and the secret parameters (X(l) and Prl). The third seed generation information and the encrypted license information &lsqb;Lic&rsqb; wl<highlight><bold>2</bold></highlight> are transferred to the card P (steps S<highlight><bold>6031</bold></highlight> to S<highlight><bold>6035</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 136</cross-reference>). </paragraph>
<paragraph id="P-0807" lvl="0"><number>&lsqb;0807&rsqb;</number> At this time point, the encrypted license information &lsqb;Lic&rsqb; wl<highlight><bold>2</bold></highlight> and the third seed generation information are stored in the card P. The &lsqb;AID&rsqb; wl<highlight><bold>1</bold></highlight> previously stored in the card P may be erased because the information has already been transferred to the license issuing device <highlight><bold>5003</bold></highlight>. </paragraph>
<paragraph id="P-0808" lvl="0"><number>&lsqb;0808&rsqb;</number> The user takes home the card P which has undergone the above processing and the disk D and can reproduce the contents using the card adapter <highlight><bold>5004</bold></highlight> and the player <highlight><bold>5005</bold></highlight> at home. </paragraph>
<paragraph id="P-0809" lvl="0"><number>&lsqb;0809&rsqb;</number> Step x11: To reproduce the contents, the user inserts the card P into the card adapter <highlight><bold>5004</bold></highlight> and sets the disk D in the player <highlight><bold>5005</bold></highlight>. The card adapter <highlight><bold>5004</bold></highlight> reads out the encrypted license information &lsqb;Lic&rsqb; wl<highlight><bold>2</bold></highlight> and the third seed generation information from the card P and calculates the third seed X(l)&circ; (bl&middot;cl)(mod Prl) from the third seed generation information and the random number bl temporarily stored in step x5. The algorithm Al(Pl) is applied to the third seed to generate the common key wl<highlight><bold>2</bold></highlight>, thereby decoding the encrypted license information &lsqb;Lic&rsqb; wl<highlight><bold>2</bold></highlight> (steps S<highlight><bold>6046</bold></highlight> to S<highlight><bold>6049</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 138</cross-reference>). </paragraph>
<paragraph id="P-0810" lvl="0"><number>&lsqb;0810&rsqb;</number> Step x12: On the other hand, the player <highlight><bold>5005</bold></highlight> reads the disk ID (DID) from the set disk D. </paragraph>
<paragraph id="P-0811" lvl="0"><number>&lsqb;0811&rsqb;</number> Step s13: The card adapter <highlight><bold>5004</bold></highlight> generates the random number aD. To acquire the disk ID (DID) of the disk D from the player <highlight><bold>5005</bold></highlight>, the card adapter <highlight><bold>5004</bold></highlight> generates a public parameter necessary for decoding encrypting the disk ID (DID), i.e., the fourth seed generation information. More specifically, the fourth seed generation information X(D)&circ; aD(mod PrD) is calculated from the random number aD and the secret parameters (X(D) and PrD) and transferred to the player <highlight><bold>5005</bold></highlight> (step S<highlight><bold>6036</bold></highlight> and S<highlight><bold>6037</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 137</cross-reference>). </paragraph>
<paragraph id="P-0812" lvl="0"><number>&lsqb;0812&rsqb;</number> Step x14: Upon receiving the fourth seed generation information, the player <highlight><bold>5005</bold></highlight> generates the random number bD and calculates the fourth seed X(D)&circ; (aD&middot;bD)(mod PrD) from the fourth seed generation information and the random number bD. The algorithm AD(PD) is applied to generate the common key wD<highlight><bold>1</bold></highlight>, thereby encrypting the disk ID (DID). The DID encrypted using the common key wD<highlight><bold>1</bold></highlight> will be represented as &lsqb;DID&rsqb; wD<highlight><bold>1</bold></highlight> hereinafter. In addition, a public parameter necessary for decoding the &lsqb;DID&rsqb; wD<highlight><bold>1</bold></highlight>, i.e., the fourth seed generation information X(D)&circ; bD(mod PrD) is calculated from the random number bD and the secret parameters (X(D) and PrD), and &lsqb;DID&rsqb; wD<highlight><bold>1</bold></highlight> and the fourth seed generation information are transferred to the card adapter <highlight><bold>5004</bold></highlight> (steps S<highlight><bold>6038</bold></highlight> to S<highlight><bold>6042</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 137</cross-reference>). </paragraph>
<paragraph id="P-0813" lvl="0"><number>&lsqb;0813&rsqb;</number> Upon receiving the fourth seed generation information and &lsqb;DID&rsqb; wD<highlight><bold>1</bold></highlight> transferred from the player <highlight><bold>5005</bold></highlight>, the card adapter <highlight><bold>5004</bold></highlight> calculates the fourth seed X(D)&circ; (aD&middot;bD)(mod PrD) from the fourth seed generation information and the random number aD. The algorithm AD(PD) is applied to the fourth seed to generate the common key wD<highlight><bold>1</bold></highlight>. The &lsqb;DID&rsqb; wD<highlight><bold>1</bold></highlight> is decoded to acquire the disk ID (DID) (steps S<highlight><bold>6043</bold></highlight> to S<highlight><bold>6045</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 137</cross-reference>). </paragraph>
<paragraph id="P-0814" lvl="0"><number>&lsqb;0814&rsqb;</number> The flow advances to step S<highlight><bold>6050</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 138</cross-reference> to perform processing of deciding on the basis of the license information whether the contents information can be decoded (license decision processing) (<cross-reference target="DRAWINGS">FIGS. 139 and 140</cross-reference>). </paragraph>
<paragraph id="P-0815" lvl="0"><number>&lsqb;0815&rsqb;</number> If the license information contains the card adapter ID, the card adapter <highlight><bold>5004</bold></highlight> compares the card adapter ID (AID) stored in the AID storage section <highlight><bold>5004</bold></highlight><highlight><italic>f </italic></highlight>with that contained in the license information. Unless the IDs match, the license information is not adapted to the card adapter <highlight><bold>5004</bold></highlight>, and processing is ended. If the AIDs match, the flow advances to the next processing (steps S<highlight><bold>6061</bold></highlight> and S<highlight><bold>6062</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 139</cross-reference>). </paragraph>
<paragraph id="P-0816" lvl="0"><number>&lsqb;0816&rsqb;</number> Step x15: When the card ID is contained in the license information, to acquire the identification information KID from the card P the card adapter <highlight><bold>5004</bold></highlight> generates the random number ck first and a public parameter necessary for encrypting the card ID (KID) of the card P, i.e., the fifth seed generation information. More specifically, the fifth seed generation information X(k)&circ; ck(mod Prk) is calculated from the random number ck and the secret parameters (X(k) and Prk) and transferred to the card P (steps S<highlight><bold>6063</bold></highlight> to S<highlight><bold>6065</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 139</cross-reference>). </paragraph>
<paragraph id="P-0817" lvl="0"><number>&lsqb;0817&rsqb;</number> Step x16: Upon receiving the fifth seed generation information, the card P generates the random number dk and calculates the fifth seed X(k)&circ; (ck&middot;dk)(mod Prk) from the fifth seed generation information and the random number dk. The algorithm Ak(Pk) is applied to the fifth seed to generate the key wk<highlight><bold>2</bold></highlight>, thereby encrypting the card ID (KID) of the card P. The KID encrypted using the common key wk<highlight><bold>2</bold></highlight> will be represented as &lsqb;KID&rsqb; wk<highlight><bold>2</bold></highlight> hereinafter. In addition, a public parameter necessary for decoding the &lsqb;KID&rsqb; wk<highlight><bold>2</bold></highlight>, i.e., the fifth seed generation information X(k)&circ; &middot;dk(mod Prk) is calculated from the random number dk, and the fifth seed generation information and the &lsqb;KID&rsqb; wk<highlight><bold>2</bold></highlight> are transferred to the card adapter <highlight><bold>5004</bold></highlight> (steps S<highlight><bold>6066</bold></highlight> to S<highlight><bold>6070</bold></highlight>). </paragraph>
<paragraph id="P-0818" lvl="0"><number>&lsqb;0818&rsqb;</number> The card adapter <highlight><bold>5004</bold></highlight> calculates the fifth seed from the fifth seed generation information and the random number dk transferred from the card P. The algorithm Ak(Pk) is applied to the fifth seed to generate the key wk<highlight><bold>2</bold></highlight>. The &lsqb;KID&rsqb; wk<highlight><bold>2</bold></highlight> is decoded to obtain the KID. When the card ID (KID) sent from the card P matches that contained in the license information, the flow advances to the next processing. Otherwise, it is decided that the license information stored in the card P is not adapted to the card P, processing is ended (steps S<highlight><bold>6071</bold></highlight> to S<highlight><bold>6074</bold></highlight>). </paragraph>
<paragraph id="P-0819" lvl="0"><number>&lsqb;0819&rsqb;</number> Step x17: The card adapter <highlight><bold>5004</bold></highlight> checks the license information generation time contained in the license information. The license information generation time is represented as T1. The card adapter <highlight><bold>5004</bold></highlight> acquires current time Tc indicated by the clock <highlight><bold>5004</bold></highlight><highlight><italic>h</italic></highlight>. When Tc&pound;T1, the current time Tc indicated by the clock <highlight><bold>5004</bold></highlight><highlight><italic>h </italic></highlight>is delayed. Actually, the time T1 when the license information has been generated must be earlier than the current time Tc. Therefore, when Tc&pound;T1, the card adapter <highlight><bold>5004</bold></highlight> decides that the clock <highlight><bold>5004</bold></highlight><highlight><italic>h </italic></highlight>is not correct and stops processing. Alternatively, some allowable error range Te (&gt;0) may be set in advance, and when or only when Tc&gt;T1&plus;Te holds, the flow may advance to the next processing (step S<highlight><bold>6075</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 140</cross-reference>). </paragraph>
<paragraph id="P-0820" lvl="0"><number>&lsqb;0820&rsqb;</number> The encrypted disk information contained in the license information is decoded using the decoding key kd held in advance (step S<highlight><bold>6076</bold></highlight>). The disk information contains the disk ID (DID), the disk key, and the expiration date (TL). First, the expiration date TL is compared with the current time Tc indicated by the clock <highlight><bold>5004</bold></highlight><highlight><italic>h</italic></highlight>. If TL&lt;Tc, the license has expired, so the card adapter <highlight><bold>5004</bold></highlight> stops processing. Alternatively, some allowable error range Te&prime; (&gt;0) may be set in advance, and when or only when Tc&pound;TL&plus;Te&prime; holds, the flow may advance to the next processing (step S<highlight><bold>6077</bold></highlight>). </paragraph>
<paragraph id="P-0821" lvl="0"><number>&lsqb;0821&rsqb;</number> Finally, the card adapter <highlight><bold>5004</bold></highlight> compares the disk ID (DID) contained in the disk information with the disk ID of the disk D, which is acquired in advance. If the disk IDs do not match, the license information is information generated for a disk different from the disk D which is currently being set in the player <highlight><bold>5005</bold></highlight>, so the card adapter <highlight><bold>5004</bold></highlight> stops processing. When the disk IDs match, it is decided that the contents information recorded on the disk D can be reproduced (step S<highlight><bold>6078</bold></highlight>). </paragraph>
<paragraph id="P-0822" lvl="0"><number>&lsqb;0822&rsqb;</number> If it is decided that reproduction is enabled, the card adapter <highlight><bold>5004</bold></highlight> instructs the player <highlight><bold>5005</bold></highlight> to generate a random number to transfer the disk key contained in the disk information to the player <highlight><bold>5005</bold></highlight>. </paragraph>
<paragraph id="P-0823" lvl="0"><number>&lsqb;0823&rsqb;</number> Step x18: Upon receiving the random number generation instruction, the player <highlight><bold>5005</bold></highlight> generates the random number cD, calculates the sixth seed generation information X(D)&circ; cD(mod PrD) from the random number cD and the secret parameters (X(D) and PrD), and transfers it to the card adapter <highlight><bold>5004</bold></highlight> (steps S<highlight><bold>6051</bold></highlight> and S<highlight><bold>6052</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 138</cross-reference>). </paragraph>
<paragraph id="P-0824" lvl="0"><number>&lsqb;0824&rsqb;</number> Step x19: Upon receiving the sixth seed generation information, the card adapter <highlight><bold>5004</bold></highlight> generates the random number dD. The sixth seed X(D)&circ; (cD&middot;dD)(mod PrD) is calculated from the sixth seed generation information and the random number dD. The algorithm AD(PD) is applied to the sixth seed to generate the common key wD<highlight><bold>2</bold></highlight> for encrypting the disk key. The disk key is encrypted using the common key wD<highlight><bold>2</bold></highlight>. The disk key encrypted using the common key wD<highlight><bold>2</bold></highlight> will be represented as &lsqb;disk key&rsqb; wD<highlight><bold>2</bold></highlight> hereinafter. In addition, a public parameter necessary for decoding the &lsqb;disk key&rsqb; wD<highlight><bold>2</bold></highlight>, i.e., the sixth seed generation information X(D)&circ; dD(mod PrD) is generated from the random number dD and the secret parameters (X(D) and PrD), and the sixth seed generation information and the &lsqb;disk key&rsqb; wD<highlight><bold>2</bold></highlight> are transferred to the player <highlight><bold>5005</bold></highlight> (steps S<highlight><bold>6053</bold></highlight> to S<highlight><bold>6056</bold></highlight>). </paragraph>
<paragraph id="P-0825" lvl="0"><number>&lsqb;0825&rsqb;</number> The player <highlight><bold>5005</bold></highlight> calculates the sixth seed X(D)&circ; (cD&middot;dD)(mod PrD) from the sixth seed generation information and the random number cD transferred from the card adapter <highlight><bold>5004</bold></highlight>. The algorithm AD(PD) is applied to the sixth seed to generate the common key wD<highlight><bold>2</bold></highlight>, thereby decoding the &lsqb;disk key&rsqb; wD<highlight><bold>2</bold></highlight> (step S<highlight><bold>6057</bold></highlight> to S<highlight><bold>6059</bold></highlight>). </paragraph>
<paragraph id="P-0826" lvl="0"><number>&lsqb;0826&rsqb;</number> The player <highlight><bold>5005</bold></highlight> decodes the encrypted contents key stored in the disk D using the disk key, so the encrypted contents information can be decoded/reproduced using the contents key (step S<highlight><bold>6060</bold></highlight>). </paragraph>
<paragraph id="P-0827" lvl="0"><number>&lsqb;0827&rsqb;</number> The decoding key kd of the encrypted disk information may be stored in the player <highlight><bold>5005</bold></highlight>. In this case, the player <highlight><bold>5005</bold></highlight> decodes the encrypted disk information. Since the clock <highlight><bold>5004</bold></highlight><highlight><italic>h </italic></highlight>which is referred to to decide the validity of the license information generation time or expiration date is incorporated in the card adapter <highlight><bold>5004</bold></highlight>, the expiration date cannot be inserted into the encrypted disk information. Therefore, in this case, the encrypted disk information transferred from the license creation device <highlight><bold>5001</bold></highlight> to the license issuing device <highlight><bold>5003</bold></highlight> contains &ldquo;disk ID&plus;disk key&rdquo; as constituent elements. The expiration date can be merged with the encrypted disk information in generating the license information in step x9, so license information containing the encrypted disk information, the license information generation time, the expiration date, and, as needed, the card ID (KID) and the card adapter ID (AID), can be generated. </paragraph>
<paragraph id="P-0828" lvl="0"><number>&lsqb;0828&rsqb;</number> The card adapter <highlight><bold>5004</bold></highlight> decides the validity of the expiration date without decoding the disk information using the decoding key kd. </paragraph>
<paragraph id="P-0829" lvl="0"><number>&lsqb;0829&rsqb;</number> Storage of the decoding key kd in the player <highlight><bold>5005</bold></highlight> yields the following advantage. </paragraph>
<paragraph id="P-0830" lvl="2"><number>&lsqb;0830&rsqb;</number> Since the encrypted disk information to be stored in the license issuing device <highlight><bold>5003</bold></highlight> does not contain the expiration date, the disk information need not be updated. That is, the license creation device <highlight><bold>5001</bold></highlight> can generate only the encrypted disk information of a newly added rental disk and appropriately transfer it to the license issuing device <highlight><bold>5003</bold></highlight>. </paragraph>
<paragraph id="P-0831" lvl="0"><number>&lsqb;0831&rsqb;</number> Disadvantages are as follows. </paragraph>
<paragraph id="P-0832" lvl="2"><number>&lsqb;0832&rsqb;</number> Since the encrypted disk information is not updated, the motive for illicit use of the license issuing device <highlight><bold>5003</bold></highlight> is strengthened. </paragraph>
<paragraph id="P-0833" lvl="2"><number>&lsqb;0833&rsqb;</number> To protect the decoding key kd in the player <highlight><bold>5005</bold></highlight>, the security of the player <highlight><bold>5005</bold></highlight> must be increased. </paragraph>
<paragraph id="P-0834" lvl="0"><number>&lsqb;0834&rsqb;</number> The procedure required to the user in the above disk key distribution will be briefly described. </paragraph>
<paragraph id="P-0835" lvl="2"><number>&lsqb;0835&rsqb;</number> i) In subscribing to the disk rental service, the user receives issue of the card P in the member shop of the disk rental service. The user purchases or rents the card adapter <highlight><bold>5004</bold></highlight>, as needed. </paragraph>
<paragraph id="P-0836" lvl="2"><number>&lsqb;0836&rsqb;</number> ii) The user inserts the card P into the card adapter <highlight><bold>5004</bold></highlight> connected to the player <highlight><bold>5005</bold></highlight> at home. </paragraph>
<paragraph id="P-0837" lvl="2"><number>&lsqb;0837&rsqb;</number> iii) To rent a disk, the user goes to the shop with the card P selects a desired rental disk D, and pays for the issue of the license into the card P. </paragraph>
<paragraph id="P-0838" lvl="2"><number>&lsqb;0838&rsqb;</number> iv) The user takes the disk D and the card P home, inserts the card P into the card adapter <highlight><bold>5004</bold></highlight>, and reproduces the disk D. The disk D can be reproduced any number of times before the expiration date of the license. </paragraph>
<paragraph id="P-0839" lvl="2"><number>&lsqb;0839&rsqb;</number> V) To rent another disk, the user repeats the processes iii) and iv). </paragraph>
<paragraph id="P-0840" lvl="0"><number>&lsqb;0840&rsqb;</number> It is more advantageous for the user to receive issue of the card P and simultaneously rent the disk in subscribing to the disk rental service. The procedure required to the user at this time will be briefly described. </paragraph>
<paragraph id="P-0841" lvl="2"><number>&lsqb;0841&rsqb;</number> i) In subscribing to the disk rental service, the user receives issue of the card P in the member shop of the disk rental service. The user purchases or rents the card adapter <highlight><bold>5004</bold></highlight>, as needed. </paragraph>
<paragraph id="P-0842" lvl="2"><number>&lsqb;0842&rsqb;</number> ii&prime;) The user selects a desired rental disk D, and pays for the issue of the license into the card P. </paragraph>
<paragraph id="P-0843" lvl="2"><number>&lsqb;0843&rsqb;</number> iii&prime;) The user takes the disk D and the card P home, inserts the card P into the card adapter <highlight><bold>5004</bold></highlight>, and reproduces the disk D. The disk can be reproduced any number of times before the expiration date of the license. </paragraph>
<paragraph id="P-0844" lvl="2"><number>&lsqb;0844&rsqb;</number> iv&prime;) To rent another disk, the user repeats the processes ii&prime;) and iii&prime;). </paragraph>
<paragraph id="P-0845" lvl="0"><number>&lsqb;0845&rsqb;</number> A disk key distribution procedure in this case will be described next. </paragraph>
<paragraph id="P-0846" lvl="0"><number>&lsqb;0846&rsqb;</number> Another disk key distribution procedure in the information distribution system shown in <cross-reference target="DRAWINGS">FIG. 122</cross-reference> will be sequentially described next with reference to the view shown in <cross-reference target="DRAWINGS">FIG. 141</cross-reference> and the flow charts shown in FIGS. <highlight><bold>142</bold></highlight> to <highlight><bold>146</bold></highlight> about the subscription to a disk rental service, rental of a disk, and reproduction of contents. </paragraph>
<paragraph id="P-0847" lvl="0"><number>&lsqb;0847&rsqb;</number> All the card adapters <highlight><bold>5004</bold></highlight> and license issuing devices <highlight><bold>5003</bold></highlight> provided to the subscribers of the disk rental service share a random number bl<highlight><bold>0</bold></highlight>. The random number bl<highlight><bold>0</bold></highlight> is stored in, e.g., a ROM and preferably protected to prevent from being read outside the card adapter. </paragraph>
<paragraph id="P-0848" lvl="0"><number>&lsqb;0848&rsqb;</number> The random number bl<highlight><bold>0</bold></highlight> is stored in the base storage sections <highlight><bold>5003</bold></highlight><highlight><italic>m </italic></highlight>and <highlight><bold>5004</bold></highlight><highlight><italic>m </italic></highlight>of the license issuing device <highlight><bold>5003</bold></highlight> and the card adapter <highlight><bold>5004</bold></highlight> in advance. </paragraph>
<paragraph id="P-0849" lvl="0"><number>&lsqb;0849&rsqb;</number> The subscription to a disk rental service will be described first. </paragraph>
<paragraph id="P-0850" lvl="0"><number>&lsqb;0850&rsqb;</number> Steps y1 and y2: The card P issued to the user is inserted into the license issuing device <highlight><bold>5003</bold></highlight>. The license issuing device <highlight><bold>5003</bold></highlight> acquires the card ID (KID) from the card P in the same manner as in steps x2 and x3 and steps x6 and x7 in <cross-reference target="DRAWINGS">FIG. 133</cross-reference> (step S<highlight><bold>6101</bold></highlight> to S<highlight><bold>6110</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 142</cross-reference>). </paragraph>
<paragraph id="P-0851" lvl="0"><number>&lsqb;0851&rsqb;</number> Step y3: The rental disk D selected by the user is also inserted into the license issuing device <highlight><bold>5003</bold></highlight>. The license issuing device <highlight><bold>5003</bold></highlight> acquires the disk ID (DID) from the inserted disk D and encrypted disk information corresponding to the disk ID from the license DB <highlight><bold>5003</bold></highlight><highlight><italic>f. </italic></highlight></paragraph>
<paragraph id="P-0852" lvl="0"><number>&lsqb;0852&rsqb;</number> The license issuing device <highlight><bold>5003</bold></highlight> merges current time acquired from the clock <highlight><bold>5003</bold></highlight><highlight><italic>h </italic></highlight>as license information generation time and also merges the card ID (KID) of the user to generate license information (Lic) (steps S<highlight><bold>6111</bold></highlight> to S<highlight><bold>6114</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 142</cross-reference>). That is, </paragraph>
<paragraph id="P-0853" lvl="2"><number>&lsqb;0853&rsqb;</number> Lic&equals;encrypted disk information&plus;license information generation time&plus;KID </paragraph>
<paragraph id="P-0854" lvl="0"><number>&lsqb;0854&rsqb;</number> Step y4: The license issuing device <highlight><bold>5003</bold></highlight> generates the random number al. The card ID of the card P and the random number al are stored in the card DB <highlight><bold>5003</bold></highlight><highlight><italic>i. </italic></highlight></paragraph>
<paragraph id="P-0855" lvl="0"><number>&lsqb;0855&rsqb;</number> A seventh seed X(l)&circ; (al&middot;bl<highlight><bold>0</bold></highlight>)(mod Prl) is calculated from the random number al and, e.g., the secret parameters (X(l) and Prl). The algorithm Al (P<highlight><bold>1</bold></highlight>) is applied to the seventh seed to generate a common key wl<highlight><bold>3</bold></highlight>, thereby encrypting the license information Lic. The license information Lic encrypted using the common key wl<highlight><bold>3</bold></highlight> will be represented as &lsqb;Lic&rsqb; wl<highlight><bold>3</bold></highlight> hereinafter. A public parameter necessary for decoding the &lsqb;Lic&rsqb; wl<highlight><bold>3</bold></highlight>, i.e., the seventh seed generation information X(l)&circ; al(mod Prl) is calculated from the random number al and the secret parameters (X(l) and Prl). The seventh seed generation information and the encrypted license information &lsqb;Lic&rsqb; wl<highlight><bold>3</bold></highlight> are transferred to the card P (steps S<highlight><bold>6115</bold></highlight> to S<highlight><bold>6119</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 142</cross-reference>). </paragraph>
<paragraph id="P-0856" lvl="0"><number>&lsqb;0856&rsqb;</number> At this time point, the encrypted license information (Lic&rsqb; wl<highlight><bold>3</bold></highlight> and the seventh seed generation information are stored in the card P. </paragraph>
<paragraph id="P-0857" lvl="0"><number>&lsqb;0857&rsqb;</number> The user takes home the card P which has undergone the above processing and the disk D and can reproduce the contents using the card adapter <highlight><bold>5004</bold></highlight> and the player <highlight><bold>5005</bold></highlight> at home. </paragraph>
<paragraph id="P-0858" lvl="0"><number>&lsqb;0858&rsqb;</number> Step y5: To reproduce the contents, the user inserts the card P into the card adapter <highlight><bold>5004</bold></highlight> and sets the disk D in the player <highlight><bold>5005</bold></highlight>. The card adapter <highlight><bold>5004</bold></highlight> reads the encrypted license information &lsqb;Lic&rsqb; wl<highlight><bold>3</bold></highlight> and the seventh seed generation information from the card P and calculates the seventh seed X(l)&circ; (al&middot;bl<highlight><bold>0</bold></highlight>)(mod Prl) from the seventh seed generation information and the random number bl<highlight><bold>0</bold></highlight> stored in the base storage section <highlight><bold>5004</bold></highlight><highlight><italic>m </italic></highlight>in advance. The algorithm Al(Pl) is applied to the seventh seed to generate the common key wl<highlight><bold>3</bold></highlight>, thereby decoding the encrypted license information &lsqb;Lic&rsqb; wl<highlight><bold>3</bold></highlight>. The card adapter <highlight><bold>5004</bold></highlight> decodes the encrypted disk information contained in the license information using the decoding key kd (steps S<highlight><bold>6120</bold></highlight> to <highlight><bold>6129</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 143</cross-reference>). </paragraph>
<paragraph id="P-0859" lvl="0"><number>&lsqb;0859&rsqb;</number> Steps y8 and y9: The card adapter <highlight><bold>5004</bold></highlight> acquires the card ID (KID) as in steps x15 and x16 in <cross-reference target="DRAWINGS">FIG. 133</cross-reference> (steps S<highlight><bold>6130</bold></highlight> to S<highlight><bold>6139</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 143</cross-reference>). </paragraph>
<paragraph id="P-0860" lvl="0"><number>&lsqb;0860&rsqb;</number> Steps y10 to y12: The card adapter <highlight><bold>5004</bold></highlight> also acquires the disk ID (DID) of the disk D as in steps x12 to x14 in <cross-reference target="DRAWINGS">FIG. 133</cross-reference> (Steps S<highlight><bold>6140</bold></highlight> to S<highlight><bold>6149</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 144</cross-reference>). </paragraph>
<paragraph id="P-0861" lvl="0"><number>&lsqb;0861&rsqb;</number> Step y13: The flow advances to step S<highlight><bold>6150</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 145</cross-reference> to perform processing of deciding on the basis of the license information whether the contents information can be decoded (license decision processing) (<cross-reference target="DRAWINGS">FIG. 146</cross-reference>). </paragraph>
<paragraph id="P-0862" lvl="0"><number>&lsqb;0862&rsqb;</number> In license decision processing (<cross-reference target="DRAWINGS">FIG. 146</cross-reference>), the following conditions are checked. </paragraph>
<paragraph id="P-0863" lvl="2"><number>&lsqb;0863&rsqb;</number> Whether the card ID (KID) contained in the license information matches the card ID of the card P inserted into the card adapter <highlight><bold>5004</bold></highlight>. </paragraph>
<paragraph id="P-0864" lvl="2"><number>&lsqb;0864&rsqb;</number> Whether the disk ID (DID) contained in the disk information matches the disk ID of the disk D which is currently being set in the player <highlight><bold>5005</bold></highlight>. </paragraph>
<paragraph id="P-0865" lvl="2"><number>&lsqb;0865&rsqb;</number> Whether the license information generation time is earlier than the current time indicated by a clock <highlight><bold>5004</bold></highlight><highlight><italic>h. </italic></highlight></paragraph>
<paragraph id="P-0866" lvl="2"><number>&lsqb;0866&rsqb;</number> Whether the current time indicated by the clock <highlight><bold>5004</bold></highlight><highlight><italic>h </italic></highlight>satisfies the expiration date contained in the disk information. </paragraph>
<paragraph id="P-0867" lvl="0"><number>&lsqb;0867&rsqb;</number> Only when the above conditions are satisfied, the card adapter <highlight><bold>5004</bold></highlight> decides that the contents information recorded on the disk D can be reproduced and instructs the player <highlight><bold>5005</bold></highlight> to generate a random number to transfer the disk key contained in the disk information. </paragraph>
<paragraph id="P-0868" lvl="0"><number>&lsqb;0868&rsqb;</number> Steps y14 and y15: As in steps x18 and x19 in <cross-reference target="DRAWINGS">FIG. 133</cross-reference>, the disk key is encrypted using the common key wD<highlight><bold>2</bold></highlight> generated on the basis of the sixth seed generation information exchanged with the player <highlight><bold>5005</bold></highlight>, and transferred to the player <highlight><bold>5005</bold></highlight> (steps S<highlight><bold>6150</bold></highlight> to S<highlight><bold>6161</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 145</cross-reference>). </paragraph>
<paragraph id="P-0869" lvl="0"><number>&lsqb;0869&rsqb;</number> Steps y6 and y7: On the other hand, the card adapter <highlight><bold>5004</bold></highlight> executes processing of transferring the card adapter ID (AID) stored in the AID storage section <highlight><bold>5004</bold></highlight><highlight><italic>f </italic></highlight>in advance to the card P before or after the above license decision processing. At this time, the card adapter ID (AID) is encrypted using the common key wl<highlight><bold>1</bold></highlight> generated on the basis of the seventh seed generation information (the seventh seed generation information is the same as the second seed generation information) transferred from the license issuing device <highlight><bold>5003</bold></highlight> through the card P and the random number bl generated by the random number generation section <highlight><bold>5004</bold></highlight><highlight><italic>k</italic></highlight>, as in steps x4 and x5 in <cross-reference target="DRAWINGS">FIG. 133</cross-reference>. </paragraph>
<paragraph id="P-0870" lvl="0"><number>&lsqb;0870&rsqb;</number> The same processing as in steps x6 to x19 in <cross-reference target="DRAWINGS">FIG. 133</cross-reference> is performed from the second disk rental. In the second disk rental, the license issuing device <highlight><bold>5003</bold></highlight> can acquire the card adapter ID (AID) of the user in step x8 in <cross-reference target="DRAWINGS">FIG. 133</cross-reference>. That is, the correspondence between the card ID (KID) of the card P and the card adapter ID (AID) is stored in the card DB <highlight><bold>5003</bold></highlight><highlight><italic>i. </italic></highlight></paragraph>
<paragraph id="P-0871" lvl="0"><number>&lsqb;0871&rsqb;</number> In distribution of license information containing a disk key in the present invention, partner certification and transfer protection are performed on the basis of the secret parameters of each device on the distribution route and the public parameters (generated from the secret parameters) exchanged between the devices. Therefore, periodically or when attack to the security is suspected, the secret parameters or the decoding key kd of encrypted disk information (the parameters and decoding key will be called encryption parameters hereinafter) are preferably occasionally updated. The update is preferably performed on the basis of directions from the license creation device <highlight><bold>5001</bold></highlight>. </paragraph>
<paragraph id="P-0872" lvl="0"><number>&lsqb;0872&rsqb;</number> The encryption parameters to be updated by the license creation device <highlight><bold>5001</bold></highlight> are, e.g., (X(l), Pl, and Prl), (X(k), Pk, and Prk), X(D), PD, and PrD), and (kd, and ke). Encryption parameter update processing will be described with reference to the flow charts shown in FIGS. <highlight><bold>147</bold></highlight> to <highlight><bold>149</bold></highlight>. </paragraph>
<paragraph id="P-0873" lvl="0"><number>&lsqb;0873&rsqb;</number> An encryption parameter generation section <highlight><bold>5001</bold></highlight><highlight><italic>h </italic></highlight>of the license creation device <highlight><bold>5001</bold></highlight> updates the encryption parameters using, e.g., a random number generator and then generates parameter update information for the respective devices (the player <highlight><bold>5005</bold></highlight>, the card adapter <highlight><bold>5004</bold></highlight>, the card P, and the license issuing device <highlight><bold>5003</bold></highlight>) (step S<highlight><bold>6201</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 147</cross-reference>). </paragraph>
<paragraph id="P-0874" lvl="0"><number>&lsqb;0874&rsqb;</number> Parameter update information for the player contains X(D), PD, and PrD. Parameter update information for the card adapter contains X(l), Pl, Prl, X(k), Pk, Prk, X(D), PD, PrD, and kd. Parameter update information for the card contains X(k), Pk, and Prk. Parameter update information for the license issuing device contains X(l), Pl, Prl, X(k), Pk, and Prk. </paragraph>
<paragraph id="P-0875" lvl="0"><number>&lsqb;0875&rsqb;</number> A second encryption section <highlight><bold>5001</bold></highlight><highlight><italic>g </italic></highlight>encrypts the parameter update information for the respective devices using the encryption keys KsD, KsA, KsC, and KsL stored in a second encryption key storage section <highlight><bold>5001</bold></highlight><highlight><italic>f </italic></highlight>in advance (steps S<highlight><bold>6202</bold></highlight> and S<highlight><bold>6203</bold></highlight>), respectively. More specifically, the parameter update information for the player is encrypted using the encryption key KsD, the parameter update information for the card adapter is encrypted using the encryption key KsA, the parameter update information for the card is encrypted using the encryption key KsP, and the parameter update information for the license issuing device is encrypted using the encryption key KsL. The parameter update information, i.e., the encryption parameter for, e.g., the player encrypted using the corresponding encryption key will be represented as &lsqb;parameter update information&rsqb; KsD. </paragraph>
<paragraph id="P-0876" lvl="0"><number>&lsqb;0876&rsqb;</number> The encryption parameter update information for the respective devices are as follows. </paragraph>
<paragraph id="P-0877" lvl="0"><number>&lsqb;0877&rsqb;</number> The encryption parameter update information for the player (UD): &lsqb;X(D)&plus;PD&plus;PrD&rsqb; KsD The encryption parameter update information for card adapter (UA): </paragraph>
<paragraph lvl="0"><in-line-formula>&lsqb;X(l)&plus;Pl&plus;Prl&plus;X(k)&plus;Pk&plus;Prk&plus;X(D)&plus;PD&plus;PrD&plus;kd&rsqb; KsA </in-line-formula></paragraph>
<paragraph id="P-0878" lvl="0"><number>&lsqb;0878&rsqb;</number> The encryption parameter update information for the card (UC): &lsqb;X(k)&plus;Pk&plus;Prk&rsqb; KsC </paragraph>
<paragraph id="P-0879" lvl="0"><number>&lsqb;0879&rsqb;</number> The encryption parameter update information for the license issuing device (UL): </paragraph>
<paragraph lvl="0"><in-line-formula>&lsqb;X(l)&plus;Pl&plus;Prl&plus;X(k)&plus;Pk&plus;Prk&rsqb; KsL </in-line-formula></paragraph>
<paragraph id="P-0880" lvl="0"><number>&lsqb;0880&rsqb;</number> The current time (encryption parameter update time) is acquired from the clock <highlight><bold>5001</bold></highlight><highlight><italic>a </italic></highlight>and transferred to the license issuing device <highlight><bold>5003</bold></highlight> together with the encryption parameter information for the devices (steps S<highlight><bold>6204</bold></highlight> and S<highlight><bold>6205</bold></highlight>). </paragraph>
<paragraph id="P-0881" lvl="0"><number>&lsqb;0881&rsqb;</number> Upon receiving the encryption parameter information for the devices (UD, UA, UC, and UL) and the update time, the license issuing device stores the pieces of encryption parameter information UD, UA, and UC and the update time in the internal memory (step S<highlight><bold>6206</bold></highlight> in <cross-reference target="DRAWINGS">FIG. 148</cross-reference>). </paragraph>
<paragraph id="P-0882" lvl="0"><number>&lsqb;0882&rsqb;</number> The license issuing device <highlight><bold>5003</bold></highlight> stores the decoding key KpL corresponding to the encryption key KsL in the memory in advance. The encryption parameter update information UL is decoded using the decoding key KpL to update the encryption parameters X(l), Pl, Prl, X(k), Pk, and Prk stored in the base storage section <highlight><bold>5003</bold></highlight><highlight><italic>m </italic></highlight>and the common key generation section <highlight><bold>50031</bold></highlight> (step S<highlight><bold>6208</bold></highlight>). Since Pl and Pk are the parameters of the key generation algorithms Al and Ak, respectively, the key generation algorithms are updated. </paragraph>
<paragraph id="P-0883" lvl="0"><number>&lsqb;0883&rsqb;</number> Processing of updating the encryption parameters of the card P is executed when the card P is inserted into the license issuing device <highlight><bold>5003</bold></highlight>. </paragraph>
<paragraph id="P-0884" lvl="0"><number>&lsqb;0884&rsqb;</number> When the card P of the user is inserted into the license issuing device <highlight><bold>5003</bold></highlight>, the license issuing device <highlight><bold>5003</bold></highlight> acquires the latest encryption parameter update time from the card P. When the update time is older than the update time stored in the license issuing device <highlight><bold>5003</bold></highlight> (update time transferred from the license creation device <highlight><bold>5001</bold></highlight>), the flow advances to step S<highlight><bold>6210</bold></highlight>; otherwise, the encryption parameter update operation is ended, and normal processing such as a write of license information is performed (step S<highlight><bold>6209</bold></highlight>). </paragraph>
<paragraph id="P-0885" lvl="0"><number>&lsqb;0885&rsqb;</number> In step S<highlight><bold>6210</bold></highlight>, the license issuing device <highlight><bold>5003</bold></highlight> transfers the pieces of encryption parameter update information UD, UA, and UC and the update time to the card P. The card P stores the pieces of encryption parameter update information UD and UA and the update time in the internal memory. </paragraph>
<paragraph id="P-0886" lvl="0"><number>&lsqb;0886&rsqb;</number> The card P stores the decoding key KpC corresponding to the encryption key KsC in the memory in advance. The encryption parameter update information UC is decoded using the decoding key KpC to update the encryption parameters X(k), Pk, and Prk stored in the common key generation section <highlight><bold>5108</bold></highlight> (steps S<highlight><bold>6211</bold></highlight> and S<highlight><bold>6212</bold></highlight>). </paragraph>
<paragraph id="P-0887" lvl="0"><number>&lsqb;0887&rsqb;</number> Processing of updating the encryption parameters of the card adapter <highlight><bold>5004</bold></highlight> is executed when the user inserts the card P into the card adapter <highlight><bold>5004</bold></highlight>. More specifically, when the card adapter ID (AID) is to be transferred to the card P, or when license information is to be transferred from the card P to the card adapter <highlight><bold>5004</bold></highlight> to reproduce the disk D, encryption parameter update processing for the card adapter <highlight><bold>5004</bold></highlight> is executed. </paragraph>
<paragraph id="P-0888" lvl="0"><number>&lsqb;0888&rsqb;</number> The card P transfers the latest encryption parameter update time of the card P (the update time transferred from the license issuing device <highlight><bold>5003</bold></highlight>) to the card adapter <highlight><bold>5004</bold></highlight>. When the update time is older than the latest encryption parameter update time stored in the card adapter <highlight><bold>5004</bold></highlight>, the flow advances to step S<highlight><bold>6214</bold></highlight>; otherwise, the encryption parameter update operation is ended, and normal processing is performed (step S<highlight><bold>6213</bold></highlight>). </paragraph>
<paragraph id="P-0889" lvl="0"><number>&lsqb;0889&rsqb;</number> In step S<highlight><bold>6214</bold></highlight>, the card P transfers the pieces of encryption parameter update information UD and UA and the update time to the card adapter <highlight><bold>5004</bold></highlight>. The card adapter <highlight><bold>5004</bold></highlight> stores the encryption parameter update information UD and the update time in the internal memory. </paragraph>
<paragraph id="P-0890" lvl="0"><number>&lsqb;0890&rsqb;</number> The card adapter <highlight><bold>5004</bold></highlight> stores the decoding key KpA corresponding to the encryption key KsA in the memory in advance. The encryption parameter update information UA is decoded using the decoding key KpA to update the encryption parameters X(l), Pl, Prl, X(k), Pk, Prk, X(D), PD, PrD, and kd stored in the base storage section <highlight><bold>5109</bold></highlight>, the common key generation section <highlight><bold>5108</bold></highlight>, and the kd storage section <highlight><bold>5004</bold></highlight><highlight><italic>g </italic></highlight>(steps S<highlight><bold>6215</bold></highlight> and S<highlight><bold>6216</bold></highlight>). After this, normal processing is performed. </paragraph>
<paragraph id="P-0891" lvl="0"><number>&lsqb;0891&rsqb;</number> Processing of updating the encryption parameters of the player <highlight><bold>5005</bold></highlight> is executed when the card adapter <highlight><bold>5004</bold></highlight> and the player <highlight><bold>5005</bold></highlight> are to communicate with each other. More specifically, when the disk ID (DID) is to be transferred from the player <highlight><bold>5005</bold></highlight> to the card adapter <highlight><bold>5004</bold></highlight>, encryption parameter update processing for the player <highlight><bold>5005</bold></highlight> is executed. </paragraph>
<paragraph id="P-0892" lvl="0"><number>&lsqb;0892&rsqb;</number> For example, before the player <highlight><bold>5005</bold></highlight> transfers the disk ID (DID) to the card adapter <highlight><bold>5004</bold></highlight>, the latest encryption parameter update time of the player <highlight><bold>5005</bold></highlight> is transferred to the card adapter <highlight><bold>5004</bold></highlight>. </paragraph>
<paragraph id="P-0893" lvl="0"><number>&lsqb;0893&rsqb;</number> When the update time transferred from the player <highlight><bold>5005</bold></highlight> is older than the latest encryption parameter update time stored in the card adapter <highlight><bold>5004</bold></highlight>, the flow advances to step S<highlight><bold>6218</bold></highlight>; otherwise, the encryption parameter update operation is ended, and normal processing is performed (step S<highlight><bold>6217</bold></highlight>). </paragraph>
<paragraph id="P-0894" lvl="0"><number>&lsqb;0894&rsqb;</number> In step S<highlight><bold>6218</bold></highlight>, the card adapter <highlight><bold>5004</bold></highlight> transfers the encryption parameter update information UD and the update time to the player <highlight><bold>5005</bold></highlight>. The player <highlight><bold>5005</bold></highlight> stores the update time in the internal memory. </paragraph>
<paragraph id="P-0895" lvl="0"><number>&lsqb;0895&rsqb;</number> The player <highlight><bold>5005</bold></highlight> stores the decoding key KpD corresponding to the encryption key KsD in the memory in advance. The encryption parameter update information UD is decoded using the decoding key KpD to update the encryption parameters X(D), PD, and PrD stored in the base storage section <highlight><bold>50051</bold></highlight> and the common key generation section <highlight><bold>5005</bold></highlight><highlight><italic>j </italic></highlight>(steps S<highlight><bold>6219</bold></highlight> and S<highlight><bold>6220</bold></highlight>). After this, normal processing is performed. </paragraph>
<paragraph id="P-0896" lvl="0"><number>&lsqb;0896&rsqb;</number> The encryption parameter update processing is ended. Encryption parameter update is performed for all cards (all cards issued to the user) inserted into the license issuing device <highlight><bold>5003</bold></highlight>. Therefore, encryption parameter update influences all card adapters <highlight><bold>5004</bold></highlight> to which the card P with updated encryption parameters and all players <highlight><bold>5005</bold></highlight> connected to the card adapters <highlight><bold>5004</bold></highlight>. </paragraph>
<paragraph id="P-0897" lvl="0"><number>&lsqb;0897&rsqb;</number> The card adapter <highlight><bold>5004</bold></highlight> and the player <highlight><bold>5005</bold></highlight> may be sometimes constituted as a single device (to be referred to as a second player hereinafter). A procedure of distributing license information containing a disk key in this case will be briefly described with reference to <cross-reference target="DRAWINGS">FIGS. 133 and 141</cross-reference>. In <cross-reference target="DRAWINGS">FIG. 133</cross-reference>, disk ID transfer processing (steps x13 and x14) and disk key transfer processing (steps x18 and x19) between the card adapter <highlight><bold>5004</bold></highlight> and the player <highlight><bold>5005</bold></highlight> can be omitted. The card adapter ID to be transferred to the license issuing device <highlight><bold>5003</bold></highlight> through the card P in step x5 is the ID (PID) of the second player. </paragraph>
<paragraph id="P-0898" lvl="0"><number>&lsqb;0898&rsqb;</number> In <cross-reference target="DRAWINGS">FIG. 141</cross-reference> as well, disk ID transfer processing (steps y11 and y12) and disk key transfer processing (steps y14 and y15) between the card adapter <highlight><bold>5004</bold></highlight> and the player <highlight><bold>5005</bold></highlight> can be omitted. The card adapter ID to be transferred to the license issuing device <highlight><bold>5003</bold></highlight> through the card P in step y7 is the ID (PID) of the second player. </paragraph>
<paragraph id="P-0899" lvl="0"><number>&lsqb;0899&rsqb;</number> The remaining processes are the same as described above. </paragraph>
<paragraph id="P-0900" lvl="0"><number>&lsqb;0900&rsqb;</number> As described above, according to the fifth embodiment, the disk key necessary for decoding contents information can be safely distributed from the distribution source (the license creation device and the license issuing device) to the distribution destination (the card adapter and the player). </paragraph>
<paragraph id="P-0901" lvl="0"><number>&lsqb;0901&rsqb;</number> As described above, the present invention provides apparatuses and methods relating to recording medium such as DVD as follows: </paragraph>
<paragraph id="P-0902" lvl="0"><number>&lsqb;0902&rsqb;</number> An information recording apparatus comprises encryption section for encrypting contents information, license information generation section for generating encrypted license information containing at least a license condition for limiting use of the contents information and a decoding key for decoding the contents information, and recording section for recording, on a recording medium, the contents information encrypted by the encryption section and the license information generated by the license information generation section. </paragraph>
<paragraph id="P-0903" lvl="0"><number>&lsqb;0903&rsqb;</number> An information recording apparatus comprises separation section for separating a part from contents information, license information generation section for generating an encrypted license information containing at least the part of information separated by the separation section and a license condition for limiting use of the contents information, and recording section for recording, on a recording medium, the license information generated by the license information generation section and the remaining part of contents information. </paragraph>
<paragraph id="P-0904" lvl="0"><number>&lsqb;0904&rsqb;</number> An information recording apparatus comprises recording information generation section for generating encrypted recording information containing contents information and at least a license condition for limiting use of the contents information, and recording section for recording the recording information generated by the recording information generation section on a recording medium. </paragraph>
<paragraph id="P-0905" lvl="0"><number>&lsqb;0905&rsqb;</number> An information reproducing apparatus comprises section for receiving a recording medium on which encrypted contents information, and license information containing at least a license condition for limiting use of the contents information and first key information for decoding the contents information are recorded, storage section for storing second key information for decoding the license information, first decoding section for decoding the license information recorded on the recording medium using the second key information stored in the storage section, decision section for deciding, on the basis of the license condition contained in the license information decoded by the first decoding section, whether the contents information can be used, and second decoding section for decoding the contents information recorded on the recording medium using the first key information contained in the license information decoded by the first decoding section when the decision section decides that the contents information can be used. </paragraph>
<paragraph id="P-0906" lvl="0"><number>&lsqb;0906&rsqb;</number> An information reproducing apparatus comprises section for receiving a recording medium on which part of contents information and encrypted license information containing at least a license condition for limiting use of the contents information and the remaining part of the contents information are recorded, storage section for storing key information for decoding the license information, decoding section for decoding the license information recorded on the recording medium using the key information stored in the storage section, decision section for deciding, on the basis of the license condition contained in the license information decoded by the decoding section, whether the contents information can be used, and reproduction section for synthesizing the part of contents information contained in the license information decoded by the decoding section with the part of contents information recorded on the recording medium and reproducing the contents information when the decision section decides that the contents information can be used. </paragraph>
<paragraph id="P-0907" lvl="0"><number>&lsqb;0907&rsqb;</number> An information reproducing apparatus comprises section for receiving a recording medium on which encrypted recording information containing at least contents information and a license condition for limiting use of the contents information is recorded, storage section for storing key information for decoding the recording information, decoding section for decoding the recording information recorded on the recording medium using the key information stored in the storage section, decision section for deciding, on the basis of the license condition contained in the recording information decoded by the decoding section, whether the contents information can be used, and reproduction section for reproducing the contents information decoded by the decoding section when the decision section decides that the contents information can be used. </paragraph>
<paragraph id="P-0908" lvl="0"><number>&lsqb;0908&rsqb;</number> The license condition contains at least an expiration date of the contents information, and the decision section has instrument section for measuring a date, and compares the date measured by the instrument section with the expiration date to decide whether the contents information can be used. </paragraph>
<paragraph id="P-0909" lvl="0"><number>&lsqb;0909&rsqb;</number> The license condition contains at least an expiration date of the contents information, and the, decision section has instrument section for measuring a date and update disabling section for disabling update of the date measured by the instrument section, and compares the date measured by the instrument section with the expiration date to decide whether the contents information can be used. </paragraph>
<paragraph id="P-0910" lvl="0"><number>&lsqb;0910&rsqb;</number> The license condition contains at least an expiration date of the contents information, and the decision section has instrument section for measuring a date, reception section for receiving encrypted update information for updating the date measured by the instrument section, and update section for decoding the encrypted update information received by the reception section and updating the date measured by the instrument section on the basis of the decoded update information, and compares the date measured by the instrument section with the expiration date to decide whether the contents information can be used. </paragraph>
<paragraph id="P-0911" lvl="0"><number>&lsqb;0911&rsqb;</number> The license condition contains at least an expiration date of the contents information and a recording date when the information has been recorded on the recording medium, and the decision section has instrument section for measuring a date, and compares the date measured by the instrument section, the expiration date, and the recording date with each other to decide whether the contents information can be used. </paragraph>
<paragraph id="P-0912" lvl="0"><number>&lsqb;0912&rsqb;</number> The license condition contains at least a contents information identifier for identifying the contents information, and the apparatus further comprises request section for requesting fee payment for use of contents information corresponding to the contents information identifier when the decision section decides that the contents information can be used, and update section for updating at least the license condition recorded on the recording medium when fee payment for the request is confirmed. </paragraph>
<paragraph id="P-0913" lvl="0"><number>&lsqb;0913&rsqb;</number> The license condition contains at least an expiration date of the contents information, the apparatus further comprises license condition update section for adding a decoder unit identifier of a unit capable of decoding the license information to the license condition when the license condition contains no decoder unit identifier for identifying the unit capable of decoding the license information, and the decision section decides, on the basis of the expiration date and the decoder unit identifier, whether the contents information can be used. </paragraph>
<paragraph id="P-0914" lvl="0"><number>&lsqb;0914&rsqb;</number> The license condition contains at least an expiration date of the contents information, the apparatus further comprises license condition update section for adding a decoder unit identifier of a unit capable of decoding the recording information to the license condition when the license condition contains no decoder unit identifier for identifying the unit capable of decoding the recording information, and the decision section decides, on the basis of the expiration date and the decoder unit identifier, whether the contents information can be used. </paragraph>
<paragraph id="P-0915" lvl="0"><number>&lsqb;0915&rsqb;</number> The license condition contains at least a medium identifier for identifying a recording medium capable of recording the contents information, and the decision section decides, on the basis of the medium identifier, whether the contents information can be used. </paragraph>
<paragraph id="P-0916" lvl="0"><number>&lsqb;0916&rsqb;</number> An information reproducing apparatus comprises section for receiving a recording medium on which encrypted contents information and license information containing at least a license condition for limiting use of the contents information and first key information for decoding the contents information are recorded, instrument section for measuring a date, decision section for deciding, on the basis of the date measured by the instrument section and the license information recorded on the recording medium, whether the contents information can be used, and information reproduction section for, when the decision section decides that the contents information can be used, decoding and reproducing the contents information recorded on the recording medium using the first key information output from the decision section, wherein information for notifying the decision section of the date from the instrument section and the first key information output from the decision section to the information reproduction section are encrypted. </paragraph>
<paragraph id="P-0917" lvl="0"><number>&lsqb;0917&rsqb;</number> The information for notifying the decision section of the date from the instrument section is encrypted using key information common to encryption and decoding. </paragraph>
<paragraph id="P-0918" lvl="0"><number>&lsqb;0918&rsqb;</number> The information for notifying the decision section of the date from the instrument section is encrypted and decoded using key information generated by the instrument section and the decision section, respectively. </paragraph>
<paragraph id="P-0919" lvl="0"><number>&lsqb;0919&rsqb;</number> The information for notifying the decision section of the date from the instrument section is encrypted and decoded using key information generated on the basis of first key generation information held in the instrument section and the decision section and random numbers mutually notified between the instrument section and the decision section. </paragraph>
<paragraph id="P-0920" lvl="0"><number>&lsqb;0920&rsqb;</number> The first key information output from the decision section to the information reproduction section is encrypted using key information common to encryption and decoding. </paragraph>
<paragraph id="P-0921" lvl="0"><number>&lsqb;0921&rsqb;</number> The first key information output from the decision section to the information reproduction section is encrypted and decoded using key information generated by the decision section and the information reproduction section, respectively. </paragraph>
<paragraph id="P-0922" lvl="0"><number>&lsqb;0922&rsqb;</number> The first key information output from the decision section to the information reproduction section is encrypted and decoded using key information generated on the basis of second key generation information held in the decision section and the information reproduction section and random numbers mutually notified between the decision section and the information reproduction section. </paragraph>
<paragraph id="P-0923" lvl="0"><number>&lsqb;0923&rsqb;</number> Only when the information for notifying of the date is decoded to reveal that the information has a predetermined data format, the decision section uses the information to decide whether the contents information can be used. </paragraph>
<paragraph id="P-0924" lvl="0"><number>&lsqb;0924&rsqb;</number> Only when time until arrival of the information for notifying of the date is measured to reveal that the time falls within a predetermined value, the decision section uses the information to decide whether the contents information can be used. </paragraph>
<paragraph id="P-0925" lvl="0"><number>&lsqb;0925&rsqb;</number> The decision section comprises storage section for storing a pair of second key information for encrypting the license information and third key information for decoding the license information, the third key information corresponding to the second key information, and decoding section for retrieving the third key information from the storage section on the basis of identification information of the third key information, which is recorded on the recording medium, to decode the license information, and at least part of the pair of the second key information and third key information stored in the storage section is updated. </paragraph>
<paragraph id="P-0926" lvl="0"><number>&lsqb;0926&rsqb;</number> The decision section comprises storage section for storing a pair of second key information for encrypting the license information and third key information for decoding the license information, the third key information corresponding to the second key information, and decoding section for retrieving the third key information from the storage section on the basis of identification information of the third key information, which is recorded on the recording medium, to decode the license information, and at least part of the pair of the second key information and third key information stored in the storage section is unique to each decision section. </paragraph>
<paragraph id="P-0927" lvl="0"><number>&lsqb;0927&rsqb;</number> An accounting apparatus for charging for use of contents information recorded on a recording medium, comprises input section for inputting a license condition of the contents information recorded on the recording medium, fee claiming section for claiming a fee for use of the contents information on the basis of the license condition input by the input section, and recording section for, upon confirming fee payment in response to the claim, recording license information containing at least the license condition input by the input section on the recording medium. </paragraph>
<paragraph id="P-0928" lvl="0"><number>&lsqb;0928&rsqb;</number> An accounting apparatus comprises reproduction section for reproducing encrypted license information from a recording medium on which contents information and the encrypted license information containing at least a license condition for limiting use of the contents information are recorded, decoding section for decoding the encrypted license information reproduced by the reproduction section, license condition input section for inputting a license condition for use of the contents information, fee claiming section for claiming a fee for use of the contents information on the basis of the license condition input by the license condition input section, update section for, upon confirming fee payment in response to the claim, updating the license information decoded by the decoding section, on the basis of the license condition input by the license condition input section, encryption section for encrypting the license information updated by the update section, and output section for outputting the license information encrypted by the encryption section. </paragraph>
<paragraph id="P-0929" lvl="0"><number>&lsqb;0929&rsqb;</number> A decision apparatus comprises section for receiving license information containing at least a license condition for limiting use of contents information and first key information for decoding the contents information, key generation section for generating, every predetermined time, second key information for decoding the license information, decoding section for decoding the input license information using the second key information generated by the key generation section, decision section for deciding, on the basis of the license condition contained in the license information decoded by the decoding section, whether the contents information can be decoded, and output section for outputting the first key information contained in the license information decoded by the decoding section when the decision section decides that the contents information can be used. </paragraph>
<paragraph id="P-0930" lvl="0"><number>&lsqb;0930&rsqb;</number> The key generation section generates a public key used to encrypt the license information and a secret key for decoding the license information, the secret key corresponding to the public key, the apparatus further comprises update request section for, when the decision section decides that the contents information cannot be used, supplying at least newly designated license condition and a public key newly generated by the key generation section to request update of the license information, and the license information updated in response to the license information update request from the update request section is encrypted using the public key newly generated by the key generation section and supplied together with the update request. </paragraph>
<paragraph id="P-0931" lvl="0"><number>&lsqb;0931&rsqb;</number> The key generation section generates the second key information on the basis of time information every predetermined time. </paragraph>
<paragraph id="P-0932" lvl="0"><number>&lsqb;0932&rsqb;</number> A decision apparatus comprises section for receiving encrypted license information containing at least a license condition for limiting use of contents information, encrypted first key information for decoding the contents information, and first key generation information necessary for generating second key information for decoding the encrypted first key information, decoding section for decoding the license information, decision section for deciding, on the basis of the license condition contained in the license information decoded by the decoding section, whether the contents information can be used, and output section for outputting the encrypted first key information and the first key generation information, which are contained in the license information decoded by the decoding section, when the decision section decides that the contents information can be used. </paragraph>
<paragraph id="P-0933" lvl="0"><number>&lsqb;0933&rsqb;</number> The decision apparatus comprises update request section for, when the decision section decides that the contents information cannot be used, notifying at least a newly designated license condition and second key generation information necessary for generating the second key information to request update of the license information, the second key generation information being unique to a usage device of the contents information and acquired from the usage device, thereby updating the license condition, the first key generation information, and the second key information upon receiving the license information update request from the update request section. </paragraph>
<paragraph id="P-0934" lvl="0"><number>&lsqb;0934&rsqb;</number> A decision apparatus comprises section for receiving encrypted license information containing at least a license condition for limiting use of contents information, encrypted first key information for decoding the contents information, and first key generation information necessary for generating second key information for decoding the encrypted first key information, key generation section for generating third key information for decoding the license information every predetermined time, decoding section for decoding the input license information using the third key information generated by the key generation section, decision section for deciding, on the basis of the license condition contained in the license information decoded by the decoding section, whether the contents information can be decoded, and output section for outputting the encrypted first key information and the first key generation information, which are contained in the license information decoded by the decoding section, when the decision section decides that the contents information can be used. </paragraph>
<paragraph id="P-0935" lvl="0"><number>&lsqb;0935&rsqb;</number> The key generation section generates a public key used to encrypt the license information and a secret key for decoding the license information, the secret key corresponding to the public key, and the apparatus further comprises update request section for, when the decision section decides that the contents information cannot be used, notifying at least a newly designated license condition and second key generation information necessary for generating the second key information and the public key newly generated by the key generation section to request update of the license information, the second key generation information being unique to a usage device of the contents information and acquired from the usage device, thereby updating the license condition, the first key generation information, and the second key information upon receiving the license information update request from the update request section, and encrypting the update license information using the public key newly generated by the key generation section and supplied together with the update request. </paragraph>
<paragraph id="P-0936" lvl="0"><number>&lsqb;0936&rsqb;</number> The key generation section generates third key information on the basis of time information every predetermined time. </paragraph>
<paragraph id="P-0937" lvl="0"><number>&lsqb;0937&rsqb;</number> A decision apparatus comprises section for receiving license information containing at least information obtained by encrypting, using second key information, a license condition for limiting use of contents information and first key information for decoding the contents information, and key generation information necessary for generating at least the second key information, key generation section for generating the second key information on the basis of the key generation information contained in the input license information, decoding section for decoding the license condition and the first key information contained in the license information using the second key information generated by the key generation section, decision section for deciding, on the basis of the license condition decoded by the decoding section, whether the contents information can be used, and output section for outputting the first key information decoded by the decoding section when the decision section decides that the contents information can be used. </paragraph>
<paragraph id="P-0938" lvl="0"><number>&lsqb;0938&rsqb;</number> A decision apparatus comprises section for inputting license information containing at least information obtained by encrypting, using second key information, a license condition for limiting use of contents information and first key information for decoding the contents information, and two pieces of key generation information necessary for generating at least the second key information, key generation section for generating the second key information on the basis of the two pieces of key generation information contained in the input license information, decoding section for decoding the license condition and the first key information contained in the license information using the second key information generated by the key generation section, decision section for deciding, on the basis of the license condition decoded by the decoding section, whether the contents information can be used, output section for outputting the first key information decoded by the decoding section when the decision section decides that the contents information can be used, and update request section for, when the decision section decides that the contents information cannot be used, supplying at least one of the two pieces of key generation information or information obtained by updating the one key generation information and a newly designated license condition to request update of the license information, wherein the license condition, the other key generation information, and the second key information are updated upon receiving the license information update request from the update request section. </paragraph>
<paragraph id="P-0939" lvl="0"><number>&lsqb;0939&rsqb;</number> The license information decoded by the decoding section contains certification information for deciding whether the decoding result is correct. </paragraph>
<paragraph id="P-0940" lvl="0"><number>&lsqb;0940&rsqb;</number> A decision apparatus constituted by a portable recording medium having an arithmetic function, comprises section for receiving encrypted license information read from a recording medium on which encrypted contents information and the encrypted license information containing at least a license condition for limiting use of the contents information and first key information for decoding the contents information are recorded, and encrypted date information for notifying a date, first decoding section for decoding the encrypted license information, second decoding section for decoding the encrypted date information, decision section for deciding, on the basis of the information decoded by the first and second decoding section, whether the contents information can be used, and output section for encrypting the first key information and outputting the first key information when the decision section decides that the contents information can be used. </paragraph>
<paragraph id="P-0941" lvl="0"><number>&lsqb;0941&rsqb;</number> The second decoding section performs decoding using key information generated on the basis of first key generation information and a random number, which are held in advance. </paragraph>
<paragraph id="P-0942" lvl="0"><number>&lsqb;0942&rsqb;</number> The decision section uses the date information decoded by the second decoding section to decide whether the contents information can be used only when the date information has a predetermined data format. </paragraph>
<paragraph id="P-0943" lvl="0"><number>&lsqb;0943&rsqb;</number> Only when time until arrival of the encrypted date information is measured to reveal that the time falls within a predetermined value, the decision section uses the date information to decide whether the contents information can be used. </paragraph>
<paragraph id="P-0944" lvl="0"><number>&lsqb;0944&rsqb;</number> The decision apparatus further comprises storage section for storing a pair of second key information for encrypting the license information and third key information for decoding the license information, the third key information corresponding to the second key information, and wherein the first decoding section retrieves the third key information from the storage section on the basis of identification information for designating the third key information, the identification information being read from the recording medium, to decode the license information, and at least part of the pair of the second and third key information stored in the storage section is updated. </paragraph>
<paragraph id="P-0945" lvl="0"><number>&lsqb;0945&rsqb;</number> The decision apparatus further comprises storage section for storing a pair of second key information for encrypting the license information and third key information for decoding the license information, the third key information corresponding to the second key information, and wherein the first decoding section retrieves the third key information from the storage section on the basis of identification information of the third key information, which is recorded on the recording medium, to decode the license information, and at least part of the pair of the second and third key information stored in the storage section is updated. </paragraph>
<paragraph id="P-0946" lvl="0"><number>&lsqb;0946&rsqb;</number> The decision apparatus further comprises storage section for storing a pair of second key information for encrypting the license information and third key information for decoding the license information, the third key information corresponding to the second key information, and wherein the first decoding section retrieves the third key information from the storage section on the basis of identification information of the third key information, which is recorded on the recording medium, to decode the license information, and at least part of the pair of the second and third key information stored in the storage section is unique to each decision section. </paragraph>
<paragraph id="P-0947" lvl="0"><number>&lsqb;0947&rsqb;</number> A decision apparatus comprises section for receiving encrypted license information containing at least a license condition for limiting use of contents information and first key information for decoding the contents information, key generation section for generating second key information for decoding the license information on the basis of first key generation information distributed by broadcasting, decoding section for decoding the input license information using the second key information generated by the key generation section, decision section for deciding, on the basis of the license condition contained in the license information decoded by the decoding section, whether the contents information can be used, and output section for outputting the first key information contained in the license information decoded by the decoding section when the decision section decides that the contents information can be used. </paragraph>
<paragraph id="P-0948" lvl="0"><number>&lsqb;0948&rsqb;</number> The decision apparatus further comprises storage section for storing input encrypted license information, and selection section for selecting encrypted license information corresponding to the contents information from the encrypted license information stored in the storage section, and wherein the decoding section decodes the encrypted license information selected by the selection section. </paragraph>
<paragraph id="P-0949" lvl="0"><number>&lsqb;0949&rsqb;</number> The decision apparatus further comprises storage section for storing input encrypted license information, and selection section for selecting, on the basis of a predetermined priority order of types of license information, encrypted license information corresponding to the contents information from the encrypted license information stored in the storage section, and wherein the decoding section decodes the encrypted license information selected by the selection section. </paragraph>
<paragraph id="P-0950" lvl="0"><number>&lsqb;0950&rsqb;</number> A decision apparatus comprises section for receiving encrypted license information containing at least a license condition for limiting use of contents information and first key information for decoding the contents information, first storage section for storing a first secret parameter shared with a license information distribution device, first key generation section for generating second key information on the basis of the first secret parameter stored in the first storage section and a first public parameter exchanged with the distribution device, first decoding section for decoding the received encrypted license information using the second key information generated by the first key generation section, decision section for deciding, on the basis of the license condition contained in the license information decoded by the first decoding section, whether the contents information can be used, and output section for outputting the first key information contained in the license information decoded by the decoding section when the decision section decides that the contents information can be used. </paragraph>
<paragraph id="P-0951" lvl="0"><number>&lsqb;0951&rsqb;</number> The decision apparatus the output section comprises second storage section for storing a second secret parameter shared with an information usage device which uses the contents information, and second key generation section for generating third key information on the basis of the second secret parameter stored in the second storage section and a second public parameter exchanged with the information usage device, and encrypts the first key information using the third key information generated by the second key generation section and outputs the first key information. </paragraph>
<paragraph id="P-0952" lvl="0"><number>&lsqb;0952&rsqb;</number> The decision apparatus further comprises third storage section for storing a third secret parameter shared with an information usage device which uses the contents information, first reception section for receiving, from the information usage device, encrypted identification information of a first recording medium on which the contents information is recorded, third key generation section for generating fourth key information on the basis of the third secret parameter stored in the third storage section and a third public parameter exchanged with the information usage device, and second decoding section for decoding the encrypted identification information received by the first reception section using the fourth, key information generated by the third key generation section, and wherein the decision section decides, on the basis of the identification information decoded by the second decoding section and the decoded license information, whether the contents information can be used. </paragraph>
<paragraph id="P-0953" lvl="0"><number>&lsqb;0953&rsqb;</number> In the decision apparatus communication with the distribution device is performed through a recording medium having an arithmetic function. </paragraph>
<paragraph id="P-0954" lvl="0"><number>&lsqb;0954&rsqb;</number> In the decision apparatus, communication with the distribution device is performed through a recording medium having an arithmetic function, the apparatus further comprises fourth storage section for storing a fourth secret parameter shared with the recording medium, second reception section for receiving encrypted identification information of the recording medium from the recording medium, fourth key generation section for generating fifth key information on the basis of the fourth secret parameter stored in the fourth storage section and a fourth public parameter exchanged with the recording medium, and third decoding section for decoding the encrypted identification information received by the second reception section using the fifth key information generated by the fourth key generation section, and the decision section decides, on the basis of the identification information decoded by the third decoding section and the decoded license information, whether the contents information can be used. </paragraph>
<paragraph id="P-0955" lvl="0"><number>&lsqb;0955&rsqb;</number> An update apparatus comprises a decision device for deciding, on the basis of license information containing at least a license condition for limiting use of contents information and key information for decoding the contents information, whether the contents information can be used, the license information being encrypted using a public key, update section for updating the license information on the basis of a request for updating the license information upon receiving at least a newly designated license condition and an updated public key from the decision device, and encryption section for encrypting the updated license information using the supplied public key. </paragraph>
<paragraph id="P-0956" lvl="0"><number>&lsqb;0956&rsqb;</number> An update apparatus comprises a decision device for deciding, on the basis of encrypted license information containing at least a license condition for limiting use of contents information, encrypted first key information for decoding the contents information, and first key generation information necessary for generating second key information for decoding the encrypted first key information, whether the contents information can be used, and update section for updating the license information on the basis of a request for updating the license information, upon receiving at least a newly designated license condition and second key generation in formation necessary for generating the second key information from the decision device, </paragraph>
<paragraph id="P-0957" lvl="2"><number>&lsqb;0957&rsqb;</number> wherein the update section updates the license condition and the first key generation information, updates the second key information on the basis of the updated first key generation information and the second key generation information, encrypts the first key information using the updated second key information to generate encrypted license information containing at least the updated license condition, the first key information encrypted using the updated second key information, and the updated first key generation information. </paragraph>
<paragraph id="P-0958" lvl="0"><number>&lsqb;0958&rsqb;</number> An update apparatus comprises a decision device for deciding, on the basis of license information encrypted using a public key and containing at least a license condition for limiting use of contents information, encrypted first key information for decoding the contents information, and first key generation information necessary for generating second key information for decoding the encrypted first key information, whether the contents information can be used, and update section for updating the license information on the basis of a request for updating the license information upon receiving at least a newly designated license condition, second key generation information necessary for generating the second key information, and an updated public key from the decision device, wherein the update section updates the license condition and the first key generation information, updates the second key information on the basis of the updated first key generation information and the second key generation information, encrypts the first key information using the updated second key information to generate license information containing at least the updated license condition, the first key information encrypted using the updated second key information, and the updated first key generation information, and encrypts the generated license information using the supplied public key. </paragraph>
<paragraph id="P-0959" lvl="0"><number>&lsqb;0959&rsqb;</number> An update apparatus comprises decision section for deciding, on the basis of license information containing at least information obtained by encrypting a license condition for limiting use of contents information and first key information for decoding the contents information using second key information, and two pieces of key generation information necessary for generating the second key information, whether the contents information can be used, and update section for updating the license information on the basis of a request for updating the license information upon receiving at least one of the two pieces of key generation information or information obtained by updating the other key generation information and a newly designated license condition from the decision section, wherein the update section updates the license condition and the other key generation information and updates the second key information on the basis of the updated other key generation information and the supplied one key information to generate information obtained by encrypting at least the updated license condition and the first key information using the updated second key information, and license information containing at least the supplied one key generation information and the updated other key generation information. </paragraph>
<paragraph id="P-0960" lvl="0"><number>&lsqb;0960&rsqb;</number> An information usage apparatus comprises section for receiving encrypted first key information for decoding encrypted contents information and first key generation information necessary for generating second key information for decoding the first key information, and section for holding second key generation information necessary for generating the second key information for decoding the first key information, generating the second key information on the basis of the second key generation information and the input first key generation information, and decoding the encrypted contents information using the generated second key information. </paragraph>
<paragraph id="P-0961" lvl="0"><number>&lsqb;0961&rsqb;</number> An information usage apparatus comprises section for receiving encrypted license information containing at least a license condition for limiting use of contents information and first key information for decoding the contents information, first storage section for storing a first secret parameter shared with a license information distribution device, first key generation section for generating second key information on the basis of the first secret parameter stored in the first storage section and a first public parameter exchanged with the distribution device, first decoding section for decoding the received encrypted license information using the second key information generated by the first key generation section, decision section for deciding, on the basis of the license condition contained in the license information decoded by the first decoding section, whether the contents information can be used, and second decoding section for decoding the contents information using the first key information contained in the license information decoded by the first decoding section when the decision section decides that the contents information can be used. </paragraph>
<paragraph id="P-0962" lvl="0"><number>&lsqb;0962&rsqb;</number> The information usage apparatus further comprises second storage section for storing third key information for decoding first encryption information containing at least the first key information and the license condition, the first encryption information being encrypted and contained in the license information, and second decoding section for decoding the first encryption information contained in the license information decoded by the decoding section, using the third key information stored in the second storage section. </paragraph>
<paragraph id="P-0963" lvl="0"><number>&lsqb;0963&rsqb;</number> In the information usage apparatus, communication with the distribution device is performed through a recording medium having an arithmetic function. </paragraph>
<paragraph id="P-0964" lvl="0"><number>&lsqb;0964&rsqb;</number> In the information usage apparatus, communication with the distribution device is performed through a recording medium having an arithmetic function, the apparatus further comprises third storage section for storing a second secret parameter shared with the recording medium, reception section for receiving encrypted identification information of the recording medium from the recording medium, fourth key generation section for generating fourth key information on the basis of the second secret parameter stored in the third storage section and a second public parameter exchanged with the recording medium, and third decoding section for decoding the encrypted identification information received by the reception section using the fourth key information generated by the fourth key generation section, and the decision section decides, on the basis of the identification information decoded by the third decoding section and the decoded license information, whether the contents information can be used. </paragraph>
<paragraph id="P-0965" lvl="0"><number>&lsqb;0965&rsqb;</number> A key distribution apparatus comprises first storage section for storing first key information necessary for decoding encrypted contents information recorded on a recording medium and a first secret parameter shared with an information usage device which uses the contents information, first key generation section for generating second key information on the basis of the first secret parameter stored in the first storage section and a first public parameter exchanged with the information usage device, encryption section for encrypting encrypted first encryption information containing at least the first key information using the second key information generated by the first key generation section, and distribution section for distributing second encryption information encrypted by the encryption section and containing at least the first encryption information to the information usage device. </paragraph>
<paragraph id="P-0966" lvl="0"><number>&lsqb;0966&rsqb;</number> In the information usage apparatus, the first encryption information contains a license condition for limiting use of the contents information. </paragraph>
<paragraph id="P-0967" lvl="0"><number>&lsqb;0967&rsqb;</number> In the information usage apparatus, the second encryption information contains a license condition for limiting use of the contents information. </paragraph>
<paragraph id="P-0968" lvl="0"><number>&lsqb;0968&rsqb;</number> The information usage apparatus further comprises second storage section for storing a second secret parameter shared with the information usage device, reception section for receiving encrypted identification information of the information usage device from the information usage device, second key generation section for generating third key information on the basis of the second secret parameter stored in the second storage section and a second public parameter exchanged with the information usage device, and first decoding section for decoding the encrypted identification information of the information usage device, which is received by the reception section, using the third key information generated by the second key generation section, and wherein the encryption section encrypts the identification information of the information usage device, which is decoded by the first decoding section, together with the first encryption information using the second key information to generate the second encryption information. </paragraph>
<paragraph id="P-0969" lvl="0"><number>&lsqb;0969&rsqb;</number> In the information usage apparatus, communication with the information usage device is performed through a recording medium having an arithmetic function. </paragraph>
<paragraph id="P-0970" lvl="0"><number>&lsqb;0970&rsqb;</number> In the information usage apparatus, communication with the information usage device is performed through a recording medium having an arithmetic function, the apparatus further comprises third storage section for storing a third secret parameter shared with the recording medium, reception section for receiving encrypted identification information of the recording medium from the recording medium, third key generation section for generating fourth key information on the basis of the third secret parameter stored in the third storage section and a third public parameter exchanged with the recording medium, and second decoding section for decoding the encrypted identification information of the recording medium, which is received by the reception section, using the fourth key information generated by the third key generation section, and the encryption section encrypts the identification information of the recording medium, which is decoded by the second decoding section, together with the first encryption information using the second key information to generate the second encryption information. </paragraph>
<paragraph id="P-0971" lvl="0"><number>&lsqb;0971&rsqb;</number> A recording medium having an arithmetic function, on which encrypted license information containing at least a license condition for limiting use of contents information and first key information for decoding the contents information is recorded, comprises first storage section for storing a first secret parameter shared with a license information recording device and a second secret parameter shared with a decision device for deciding on the basis of the license information whether the contents information can be used, second storage section for storing identification information given in advance, first key generation section for generating second key information on the basis of the first secret parameter stored in the first storage section and a first public parameter exchanged with the recording device, first encryption section for encrypting the identification information using the second key information generated by the first key generation section, second key generation section for generating third key information on the basis of the second secret parameter stored in the first storage section and a second public parameter exchanged with the decision device, second encryption section for encrypting the identification information using the third key information generated by the second key generation section, and transmission section for transmitting the identification information encrypted by the first and second encryption section to the recording device and the decision device. </paragraph>
<paragraph id="P-0972" lvl="0"><number>&lsqb;0972&rsqb;</number> A recording medium having an arithmetic function, on which encrypted license information containing at least a license condition for limiting use of contents information and first key information for decoding the contents information is recorded, comprises first storage section for storing a first secret parameter shared with a license information recording device and a second secret parameter shared with an information usage device which uses the contents information on the basis of the license information, second storage section for storing identification information given in advance, first key generation section for generating second key information on the basis of the first secret parameter stored in the first storage section and a first public parameter exchanged with the recording device, first encryption section for encrypting the identification information using the second key information generated by the first key generation section, second key generation section for generating third key information on the basis of the second secret parameter stored in the first storage section and a second public parameter exchanged with the information usage device, second encryption section for encrypting the identification information using the third key information generated by the second key generation section, and transmission section for transmitting the identification information encrypted by the first and second encryption section to the recording device and the information usage device. </paragraph>
<paragraph id="P-0973" lvl="0"><number>&lsqb;0973&rsqb;</number> Additional advantages and modifications will readily occurs to those skilled in the art. Therefore, the invention in its broader aspects is not limited to the specific details and representative embodiments shown and described herein. Accordingly, various modifications may be made without departing from the spirit or scope of the general inventive concept as defined by the appended claims and their equivalents. </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. An information recording apparatus comprising: 
<claim-text>encryption means for encrypting contents information; </claim-text>
<claim-text>license information generation means for generating encrypted license information containing at least a license condition for limiting use of the contents information and a decoding key for decoding the contents information; and </claim-text>
<claim-text>recording means for recording, on a recording medium, the contents information encrypted by said encryption means and the license information generated by said license information generation means. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. An information recording apparatus comprising: 
<claim-text>separation means for separating a part from contents information; </claim-text>
<claim-text>license information generation means for generating an encrypted license information containing at least the part of information separated by said separation means and a license condition for limiting use of said contents information; and </claim-text>
<claim-text>recording means for recording, on a recording medium, the license information generated by said license information generation means and the remaining part of contents information. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. An information recording apparatus comprising: 
<claim-text>recording information generation means for generating encrypted recording information containing contents information and at least a license condition for limiting use of the contents information; and </claim-text>
<claim-text>recording means for recording the recording information generated by said recording information generation means on a recording medium. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. An information reproducing apparatus comprising: 
<claim-text>means for receiving a recording medium on which encrypted contents information, and license information containing at least a license condition for limiting use of the contents information and first key information for decoding the contents information are recorded; </claim-text>
<claim-text>storage means for storing second key information for decoding the license information; </claim-text>
<claim-text>first decoding means for decoding the license information recorded on said recording medium using the second key information stored in said storage means; </claim-text>
<claim-text>decision means for deciding, on the basis of the license condition contained in the license information decoded by said first decoding means, whether the contents information can be used; and </claim-text>
<claim-text>second decoding means for decoding the contents information recorded on said recording medium using the first key information contained in the license information decoded by said first decoding means when said decision means decides that the contents information can be used. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. An apparatus according to <dependent-claim-reference depends_on="CLM-00004">claim 4</dependent-claim-reference>, wherein the license condition contains at least an expiration date of the contents information, and said decision means has instrument means for measuring a date, and compares the date measured by said instrument means with the expiration date to decide whether the contents information can be used. </claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. An apparatus according to <dependent-claim-reference depends_on="CLM-00004">claim 4</dependent-claim-reference>, wherein the license condition contains at least an expiration date of the contents information, and said decision means has instrument means for measuring a date and update disabling means for disabling update of the date measured by said instrument means, and compares the date measured by said instrument means with the expiration date to decide whether the contents information can be used. </claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. An apparatus according to claims <highlight><bold>4</bold></highlight>, wherein the license condition contains at least an expiration date of the contents information, and said decision means has instrument means for measuring a date, reception means for receiving encrypted update information for updating the date measured by said instrument means, and update means for decoding the encrypted update information received by said reception means and updating the date measured by said instrument means on the basis of the decoded update information, and compares the date measured by said instrument means with the expiration date to decide whether the contents information can be used. </claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. An apparatus according to <dependent-claim-reference depends_on="CLM-00004">claim 4</dependent-claim-reference>, wherein the license condition contains at least an expiration date of the contents information and a recording date when the information has been recorded on said recording medium, and said decision means has instrument means for measuring a date, and compares the date measured by said instrument means, the expiration date, and the recording date with each other to decide whether the contents information can be used. </claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. An apparatus according to <dependent-claim-reference depends_on="CLM-00004">claim 4</dependent-claim-reference>, wherein said license condition contains at least a contents information identifier for identifying the contents information, and said apparatus further comprises request means for requesting fee payment for use of contents information corresponding to the contents information identifier when said decision means decides that the contents information can be used, and update means for updating at least the license condition recorded on said recording medium when fee payment for the request is confirmed. </claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. An apparatus according to <dependent-claim-reference depends_on="CLM-00004">claim 4</dependent-claim-reference>, wherein the license condition contains at least an expiration date of the contents information, said apparatus further comprises license condition update means for adding a decoder unit identifier of a unit capable of decoding the license information to the license condition when the license condition contains no decoder unit identifier for identifying the unit capable of decoding the license information, and said decision means decides, on the basis of the expiration date and the decoder unit identifier, whether the contents information can be used. </claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. An information reproducing apparatus comprising: 
<claim-text>means for receiving a recording medium on which part of contents information and encrypted license information containing at least a license condition for limiting use of the contents information and the remaining part of the contents information are recorded; </claim-text>
<claim-text>storage means for storing key information for decoding the license information; </claim-text>
<claim-text>decoding means for decoding the license information recorded on said recording medium using the key information stored in said storage means; </claim-text>
<claim-text>decision means for deciding, on the basis of the license condition contained in the license information decoded by said decoding means, whether the contents information can be used; and </claim-text>
<claim-text>reproduction means for synthesizing the part of contents information contained in the license information decoded by said decoding means with the part of contents information recorded on said recording medium and reproducing the contents information when said decision means decides that the contents information can be used. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. An information reproducing apparatus comprising: 
<claim-text>means for receiving a recording medium on which encrypted recording information containing at least contents information and a license condition for limiting use of the contents information is recorded; </claim-text>
<claim-text>storage means for storing key information for decoding the recording information; </claim-text>
<claim-text>decoding means for decoding the recording information recorded on said recording medium using the key information stored in said storage means; </claim-text>
<claim-text>decision means for deciding, on the basis of the license condition contained in the recording information decoded by said decoding means, whether the contents information can be used; and </claim-text>
<claim-text>reproduction means for reproducing the contents information decoded by said decoding means when said decision means decides that the contents information can be used. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. An information reproducing apparatus comprising: 
<claim-text>means for receiving a recording medium on which encrypted contents information and license information containing at least a license condition for limiting use of the contents information and first key information for decoding the contents information are recorded; </claim-text>
<claim-text>instrument means for measuring a date; </claim-text>
<claim-text>decision means for deciding, on the basis of the date measured by said instrument means and the license information recorded on said recording medium, whether the contents information can be used; and </claim-text>
<claim-text>information reproduction means for, when said decision means decides that the contents information can be used, decoding and reproducing the contents information recorded on said recording medium using the first key information output from said decision means, </claim-text>
<claim-text>wherein information for notifying said decision means of the date from said instrument means and the first key information output from said decision means to said information reproduction means are encrypted. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. An information usage apparatus comprising: 
<claim-text>means for receiving first key generation information necessary for generating encrypted first key information for decoding encrypted contents information; and </claim-text>
<claim-text>means for holding second key generation information necessary for generating second key information for decoding the first key information, generating the second key information on the basis of the second key generation information and the input first key generation information, and decoding the encrypted contents information using the generated second key information. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. An information usage apparatus comprising: 
<claim-text>means for receiving encrypted license information containing at least a license condition for limiting use of contents information and first key information for decoding the contents information; </claim-text>
<claim-text>first storage means for storing a first secret parameter shared with a license information distribution device; </claim-text>
<claim-text>first key generation means for generating second key information on the basis of the first secret parameter stored in said first storage means and a first public parameter exchanged with said distribution device; </claim-text>
<claim-text>first decoding means for decoding the received encrypted license information using the second key information generated by said first key generation means; </claim-text>
<claim-text>decision means for deciding, on the basis of the license condition contained in the license information decoded by said first decoding means, whether the contents information can be used; and </claim-text>
<claim-text>second decoding means for decoding the contents information using the first key information contained in the license information decoded by said first decoding means when said decision means decides that the contents information can be used. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. An apparatus according to <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference>, further comprising second storage means for storing third key information for decoding first encryption information containing at least the first key information and the license condition, the first encryption information being encrypted and contained in the license information, and second decoding means for decoding the first encryption information contained in the license information decoded by said decoding means, using the third key information stored in said second storage means. </claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. An apparatus according to <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference>, wherein communication with said distribution device is performed through a recording medium having an arithmetic function. </claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. An apparatus according to <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference>, wherein communication with said distribution device is performed through a recording medium having an arithmetic function, said apparatus further comprises third storage means for storing a second secret parameter shared with said recording medium, reception means for receiving encrypted identification information of said recording medium from said recording medium, fourth key generation means for generating fourth key information on the basis of the second secret parameter stored in said third storage means and a second public parameter exchanged with said recording medium, and third decoding means for decoding the encrypted identification information received by said reception means using the fourth key information generated by said fourth key generation means, and said decision means decides, on the basis of the identification information decoded by said third decoding means and the decoded license information, whether the contents information can be used. </claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. A recording medium having an arithmetic function, on which encrypted license information containing at least a license condition for limiting use of contents information and first key information for decoding the contents information is recorded, comprising: 
<claim-text>first storage means for storing a first secret parameter shared with a license information recording device and a second secret parameter shared with a decision device for deciding on the basis of the license information whether the contents information can be used; </claim-text>
<claim-text>second storage means for storing identification information given in advance; </claim-text>
<claim-text>first key generation means for generating second key information on the basis of the first secret parameter stored in said first storage means and a first public parameter exchanged with said recording device; </claim-text>
<claim-text>first encryption means for encrypting the identification information using the second key information generated by said first key generation means; </claim-text>
<claim-text>second key generation means for generating third key information on the basis of the second secret parameter stored in said first storage means and a second public parameter exchanged with said decision device; </claim-text>
<claim-text>second encryption means for encrypting the identification information using the third key information generated by said second key generation means; and </claim-text>
<claim-text>transmission means for transmitting the identification information encrypted by said first and second encryption means to said recording device and said decision device. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. A recording medium having an arithmetic function, on which encrypted license information containing at least a license condition for limiting use of contents information and first key information for decoding the contents information is recorded, comprising: 
<claim-text>first storage means for storing a first secret parameter shared with a license information recording device and a second secret parameter shared with an information usage device which uses the contents information on the basis of the license information; </claim-text>
<claim-text>second storage means for storing identification information given in advance; </claim-text>
<claim-text>first key generation means for generating second key information on the basis of the first secret parameter stored in said first storage means and a first public parameter exchanged with said recording device; </claim-text>
<claim-text>first encryption means for encrypting the identification information using the second key information generated by said first key generation means; </claim-text>
<claim-text>second key generation means for generating third key information on the basis of the second secret parameter stored in said first storage means and a second public parameter exchanged with said information usage device; </claim-text>
<claim-text>second encryption means for encrypting the identification information using the third key information generated by said second key generation means; and </claim-text>
<claim-text>transmission means for transmitting the identification information encrypted by said first and second encryption means to said recording device and said information usage device.</claim-text>
</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>1</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030004888A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030004888A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030004888A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030004888A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030004888A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030004888A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030004888A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030004888A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030004888A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00009">
<image id="EMI-D00009" file="US20030004888A1-20030102-D00009.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00010">
<image id="EMI-D00010" file="US20030004888A1-20030102-D00010.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00011">
<image id="EMI-D00011" file="US20030004888A1-20030102-D00011.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00012">
<image id="EMI-D00012" file="US20030004888A1-20030102-D00012.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00013">
<image id="EMI-D00013" file="US20030004888A1-20030102-D00013.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00014">
<image id="EMI-D00014" file="US20030004888A1-20030102-D00014.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00015">
<image id="EMI-D00015" file="US20030004888A1-20030102-D00015.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00016">
<image id="EMI-D00016" file="US20030004888A1-20030102-D00016.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00017">
<image id="EMI-D00017" file="US20030004888A1-20030102-D00017.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00018">
<image id="EMI-D00018" file="US20030004888A1-20030102-D00018.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00019">
<image id="EMI-D00019" file="US20030004888A1-20030102-D00019.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00020">
<image id="EMI-D00020" file="US20030004888A1-20030102-D00020.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00021">
<image id="EMI-D00021" file="US20030004888A1-20030102-D00021.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00022">
<image id="EMI-D00022" file="US20030004888A1-20030102-D00022.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00023">
<image id="EMI-D00023" file="US20030004888A1-20030102-D00023.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00024">
<image id="EMI-D00024" file="US20030004888A1-20030102-D00024.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00025">
<image id="EMI-D00025" file="US20030004888A1-20030102-D00025.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00026">
<image id="EMI-D00026" file="US20030004888A1-20030102-D00026.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00027">
<image id="EMI-D00027" file="US20030004888A1-20030102-D00027.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00028">
<image id="EMI-D00028" file="US20030004888A1-20030102-D00028.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00029">
<image id="EMI-D00029" file="US20030004888A1-20030102-D00029.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00030">
<image id="EMI-D00030" file="US20030004888A1-20030102-D00030.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00031">
<image id="EMI-D00031" file="US20030004888A1-20030102-D00031.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00032">
<image id="EMI-D00032" file="US20030004888A1-20030102-D00032.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00033">
<image id="EMI-D00033" file="US20030004888A1-20030102-D00033.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00034">
<image id="EMI-D00034" file="US20030004888A1-20030102-D00034.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00035">
<image id="EMI-D00035" file="US20030004888A1-20030102-D00035.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00036">
<image id="EMI-D00036" file="US20030004888A1-20030102-D00036.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00037">
<image id="EMI-D00037" file="US20030004888A1-20030102-D00037.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00038">
<image id="EMI-D00038" file="US20030004888A1-20030102-D00038.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00039">
<image id="EMI-D00039" file="US20030004888A1-20030102-D00039.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00040">
<image id="EMI-D00040" file="US20030004888A1-20030102-D00040.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00041">
<image id="EMI-D00041" file="US20030004888A1-20030102-D00041.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00042">
<image id="EMI-D00042" file="US20030004888A1-20030102-D00042.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00043">
<image id="EMI-D00043" file="US20030004888A1-20030102-D00043.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00044">
<image id="EMI-D00044" file="US20030004888A1-20030102-D00044.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00045">
<image id="EMI-D00045" file="US20030004888A1-20030102-D00045.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00046">
<image id="EMI-D00046" file="US20030004888A1-20030102-D00046.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00047">
<image id="EMI-D00047" file="US20030004888A1-20030102-D00047.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00048">
<image id="EMI-D00048" file="US20030004888A1-20030102-D00048.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00049">
<image id="EMI-D00049" file="US20030004888A1-20030102-D00049.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00050">
<image id="EMI-D00050" file="US20030004888A1-20030102-D00050.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00051">
<image id="EMI-D00051" file="US20030004888A1-20030102-D00051.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00052">
<image id="EMI-D00052" file="US20030004888A1-20030102-D00052.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00053">
<image id="EMI-D00053" file="US20030004888A1-20030102-D00053.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00054">
<image id="EMI-D00054" file="US20030004888A1-20030102-D00054.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00055">
<image id="EMI-D00055" file="US20030004888A1-20030102-D00055.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00056">
<image id="EMI-D00056" file="US20030004888A1-20030102-D00056.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00057">
<image id="EMI-D00057" file="US20030004888A1-20030102-D00057.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00058">
<image id="EMI-D00058" file="US20030004888A1-20030102-D00058.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00059">
<image id="EMI-D00059" file="US20030004888A1-20030102-D00059.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00060">
<image id="EMI-D00060" file="US20030004888A1-20030102-D00060.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00061">
<image id="EMI-D00061" file="US20030004888A1-20030102-D00061.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00062">
<image id="EMI-D00062" file="US20030004888A1-20030102-D00062.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00063">
<image id="EMI-D00063" file="US20030004888A1-20030102-D00063.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00064">
<image id="EMI-D00064" file="US20030004888A1-20030102-D00064.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00065">
<image id="EMI-D00065" file="US20030004888A1-20030102-D00065.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00066">
<image id="EMI-D00066" file="US20030004888A1-20030102-D00066.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00067">
<image id="EMI-D00067" file="US20030004888A1-20030102-D00067.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00068">
<image id="EMI-D00068" file="US20030004888A1-20030102-D00068.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00069">
<image id="EMI-D00069" file="US20030004888A1-20030102-D00069.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00070">
<image id="EMI-D00070" file="US20030004888A1-20030102-D00070.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00071">
<image id="EMI-D00071" file="US20030004888A1-20030102-D00071.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00072">
<image id="EMI-D00072" file="US20030004888A1-20030102-D00072.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00073">
<image id="EMI-D00073" file="US20030004888A1-20030102-D00073.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00074">
<image id="EMI-D00074" file="US20030004888A1-20030102-D00074.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00075">
<image id="EMI-D00075" file="US20030004888A1-20030102-D00075.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00076">
<image id="EMI-D00076" file="US20030004888A1-20030102-D00076.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00077">
<image id="EMI-D00077" file="US20030004888A1-20030102-D00077.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00078">
<image id="EMI-D00078" file="US20030004888A1-20030102-D00078.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00079">
<image id="EMI-D00079" file="US20030004888A1-20030102-D00079.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00080">
<image id="EMI-D00080" file="US20030004888A1-20030102-D00080.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00081">
<image id="EMI-D00081" file="US20030004888A1-20030102-D00081.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00082">
<image id="EMI-D00082" file="US20030004888A1-20030102-D00082.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00083">
<image id="EMI-D00083" file="US20030004888A1-20030102-D00083.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00084">
<image id="EMI-D00084" file="US20030004888A1-20030102-D00084.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00085">
<image id="EMI-D00085" file="US20030004888A1-20030102-D00085.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00086">
<image id="EMI-D00086" file="US20030004888A1-20030102-D00086.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00087">
<image id="EMI-D00087" file="US20030004888A1-20030102-D00087.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00088">
<image id="EMI-D00088" file="US20030004888A1-20030102-D00088.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00089">
<image id="EMI-D00089" file="US20030004888A1-20030102-D00089.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00090">
<image id="EMI-D00090" file="US20030004888A1-20030102-D00090.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00091">
<image id="EMI-D00091" file="US20030004888A1-20030102-D00091.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00092">
<image id="EMI-D00092" file="US20030004888A1-20030102-D00092.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00093">
<image id="EMI-D00093" file="US20030004888A1-20030102-D00093.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00094">
<image id="EMI-D00094" file="US20030004888A1-20030102-D00094.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00095">
<image id="EMI-D00095" file="US20030004888A1-20030102-D00095.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00096">
<image id="EMI-D00096" file="US20030004888A1-20030102-D00096.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00097">
<image id="EMI-D00097" file="US20030004888A1-20030102-D00097.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00098">
<image id="EMI-D00098" file="US20030004888A1-20030102-D00098.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00099">
<image id="EMI-D00099" file="US20030004888A1-20030102-D00099.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00100">
<image id="EMI-D00100" file="US20030004888A1-20030102-D00100.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00101">
<image id="EMI-D00101" file="US20030004888A1-20030102-D00101.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00102">
<image id="EMI-D00102" file="US20030004888A1-20030102-D00102.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00103">
<image id="EMI-D00103" file="US20030004888A1-20030102-D00103.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00104">
<image id="EMI-D00104" file="US20030004888A1-20030102-D00104.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00105">
<image id="EMI-D00105" file="US20030004888A1-20030102-D00105.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00106">
<image id="EMI-D00106" file="US20030004888A1-20030102-D00106.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00107">
<image id="EMI-D00107" file="US20030004888A1-20030102-D00107.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00108">
<image id="EMI-D00108" file="US20030004888A1-20030102-D00108.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00109">
<image id="EMI-D00109" file="US20030004888A1-20030102-D00109.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00110">
<image id="EMI-D00110" file="US20030004888A1-20030102-D00110.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00111">
<image id="EMI-D00111" file="US20030004888A1-20030102-D00111.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00112">
<image id="EMI-D00112" file="US20030004888A1-20030102-D00112.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00113">
<image id="EMI-D00113" file="US20030004888A1-20030102-D00113.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00114">
<image id="EMI-D00114" file="US20030004888A1-20030102-D00114.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00115">
<image id="EMI-D00115" file="US20030004888A1-20030102-D00115.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00116">
<image id="EMI-D00116" file="US20030004888A1-20030102-D00116.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00117">
<image id="EMI-D00117" file="US20030004888A1-20030102-D00117.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00118">
<image id="EMI-D00118" file="US20030004888A1-20030102-D00118.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00119">
<image id="EMI-D00119" file="US20030004888A1-20030102-D00119.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00120">
<image id="EMI-D00120" file="US20030004888A1-20030102-D00120.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00121">
<image id="EMI-D00121" file="US20030004888A1-20030102-D00121.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00122">
<image id="EMI-D00122" file="US20030004888A1-20030102-D00122.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00123">
<image id="EMI-D00123" file="US20030004888A1-20030102-D00123.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00124">
<image id="EMI-D00124" file="US20030004888A1-20030102-D00124.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00125">
<image id="EMI-D00125" file="US20030004888A1-20030102-D00125.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00126">
<image id="EMI-D00126" file="US20030004888A1-20030102-D00126.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
