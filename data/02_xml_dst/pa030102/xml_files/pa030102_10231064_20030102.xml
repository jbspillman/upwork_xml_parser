<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE patent-application-publication SYSTEM "pap-v16-2002-01-01.dtd" [
<!ENTITY US20030002723A1-20030102-M00001.NB SYSTEM "US20030002723A1-20030102-M00001.NB" NDATA NB>
<!ENTITY US20030002723A1-20030102-M00001.TIF SYSTEM "US20030002723A1-20030102-M00001.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-M00002.NB SYSTEM "US20030002723A1-20030102-M00002.NB" NDATA NB>
<!ENTITY US20030002723A1-20030102-M00002.TIF SYSTEM "US20030002723A1-20030102-M00002.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00000.TIF SYSTEM "US20030002723A1-20030102-D00000.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00001.TIF SYSTEM "US20030002723A1-20030102-D00001.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00002.TIF SYSTEM "US20030002723A1-20030102-D00002.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00003.TIF SYSTEM "US20030002723A1-20030102-D00003.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00004.TIF SYSTEM "US20030002723A1-20030102-D00004.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00005.TIF SYSTEM "US20030002723A1-20030102-D00005.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00006.TIF SYSTEM "US20030002723A1-20030102-D00006.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00007.TIF SYSTEM "US20030002723A1-20030102-D00007.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00008.TIF SYSTEM "US20030002723A1-20030102-D00008.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00009.TIF SYSTEM "US20030002723A1-20030102-D00009.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00010.TIF SYSTEM "US20030002723A1-20030102-D00010.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00011.TIF SYSTEM "US20030002723A1-20030102-D00011.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00012.TIF SYSTEM "US20030002723A1-20030102-D00012.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00013.TIF SYSTEM "US20030002723A1-20030102-D00013.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00014.TIF SYSTEM "US20030002723A1-20030102-D00014.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00015.TIF SYSTEM "US20030002723A1-20030102-D00015.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00016.TIF SYSTEM "US20030002723A1-20030102-D00016.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00017.TIF SYSTEM "US20030002723A1-20030102-D00017.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00018.TIF SYSTEM "US20030002723A1-20030102-D00018.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00019.TIF SYSTEM "US20030002723A1-20030102-D00019.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00020.TIF SYSTEM "US20030002723A1-20030102-D00020.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00021.TIF SYSTEM "US20030002723A1-20030102-D00021.TIF" NDATA TIF>
<!ENTITY US20030002723A1-20030102-D00022.TIF SYSTEM "US20030002723A1-20030102-D00022.TIF" NDATA TIF>
]>
<patent-application-publication>
<subdoc-bibliographic-information>
<document-id>
<doc-number>20030002723</doc-number>
<kind-code>A1</kind-code>
<document-date>20030102</document-date>
</document-id>
<publication-filing-type>new</publication-filing-type>
<domestic-filing-data>
<application-number>
<doc-number>10231064</doc-number>
</application-number>
<application-number-series-code>10</application-number-series-code>
<filing-date>20020830</filing-date>
</domestic-filing-data>
<technical-information>
<classification-ipc>
<classification-ipc-primary>
<ipc>G06K009/00</ipc>
</classification-ipc-primary>
<classification-ipc-edition>07</classification-ipc-edition>
</classification-ipc>
<classification-us>
<classification-us-primary>
<uspc>
<class>382</class>
<subclass>128000</subclass>
</uspc>
</classification-us-primary>
</classification-us>
<title-of-invention>Process, system and computer readable medium for pulmonary nodule detection using multiple-templates matching</title-of-invention>
</technical-information>
<continuity-data>
<continuations>
<continuation-of>
<parent-child>
<child>
<document-id>
<doc-number>10231064</doc-number>
<kind-code>A1</kind-code>
<document-date>20020830</document-date>
</document-id>
</child>
<parent>
<document-id>
<doc-number>09716335</doc-number>
<document-date>20001121</document-date>
<country-code>US</country-code>
</document-id>
</parent>
<parent-status>GRANTED</parent-status>
<parent-patent>
<document-id>
<doc-number>6470092</doc-number>
<country-code>US</country-code>
</document-id>
</parent-patent>
</parent-child>
</continuation-of>
</continuations>
</continuity-data>
<inventors>
<first-named-inventor>
<name>
<given-name>Qiang</given-name>
<family-name>Li</family-name>
</name>
<residence>
<residence-us>
<city>Clarendon Hills</city>
<state>IL</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</first-named-inventor>
<inventor>
<name>
<given-name>Shigehiko</given-name>
<family-name>Katsuragawa</family-name>
</name>
<residence>
<residence-non-us>
<city>Oita</city>
<country-code>JP</country-code>
</residence-non-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
<inventor>
<name>
<given-name>Kunio</given-name>
<family-name>Doi</family-name>
</name>
<residence>
<residence-us>
<city>Willowbrook</city>
<state>IL</state>
<country-code>US</country-code>
</residence-us>
</residence>
<authority-applicant>INV</authority-applicant>
</inventor>
</inventors>
<assignee>
<organization-name>ARCH DEVELOPMENT CORPORATION</organization-name>
<address>
<city>Chicago</city>
<state>IL</state>
</address>
<assignee-type>02</assignee-type>
</assignee>
<correspondence-address>
<name-1>OBLON SPIVAK MCCLELLAND MAIER &amp; NEUSTADT PC</name-1>
<name-2>FOURTH FLOOR</name-2>
<address>
<address-1>1755 JEFFERSON DAVIS HIGHWAY</address-1>
<city>ARLINGTON</city>
<state>VA</state>
<postalcode>22202</postalcode>
<country>
<country-code>US</country-code>
</country>
</address>
</correspondence-address>
</subdoc-bibliographic-information>
<subdoc-abstract>
<paragraph id="A-0001" lvl="0">A method to determine whether a candidate abnormality in a medical digital image is an actual abnormality, a system which implements the method, and a computer readable medium which stores program steps to implement the method, wherein the method includes obtaining a medical digital image including a candidate abnormality; obtaining plural first templates and plural second templates respectively corresponding to predetermined abnormalities and predetermined non-abnormalities; comparing the candidate abnormality with the obtained first and second templates to derive cross-correlation values between the candidate abnormality and each of the obtained first and second templates; determining the largest cross-correlation value derived in the comparing step and whether the largest cross-correlation value is produced by comparing the candidate abnormality with the first templates or with the second templates; and determining the candidate abnormality to be an actual abnormality when the largest cross-correlation value is produced by comparing the candidate abnormality with the first templates and determining the candidate abnormality to be a non-abnormality when the largest cross-correlation value is produced by comparing the candidate abnormality with the second templates. An actual abnormality is similarly classified as malignant or benign based on further cross-correlation values obtained by comparisons with additional templates corresponding to malignant and benign abnormalities. </paragraph>
</subdoc-abstract>
<subdoc-description>
<cross-reference-to-related-applications>
<heading lvl="1">CROSS-REFERENCE TO RELATED APPLICATION </heading>
<paragraph id="P-0001" lvl="0"><number>&lsqb;0001&rsqb;</number> This application claims benefit of priority under 35 USC &sect;120 to U.S. application Ser. No. 08/716,335, filed Nov. 21, 2000, the entire contents of which are incorporated by reference herein.</paragraph>
</cross-reference-to-related-applications>
<federal-research-statement>
<heading lvl="1">STATEMENT REGARDING FEDERALLY SPONSORED RESEARCH </heading>
<paragraph-federal-research-statement id="P-0002"><number>&lsqb;0002&rsqb;</number> The present invention was made in part with U.S. Government support under USPHS grant numbers CA62625 and CA64370 (National Institute of Health). The U.S. Government has certain rights in the invention.</paragraph-federal-research-statement>
</federal-research-statement>
<summary-of-invention>
<section>
<heading lvl="1">BACKGROUND OF THE INVENTION </heading>
<paragraph id="P-0003" lvl="0"><number>&lsqb;0003&rsqb;</number> 1. Field of the Invention </paragraph>
<paragraph id="P-0004" lvl="0"><number>&lsqb;0004&rsqb;</number> This invention relates to a process, system and computer readable medium for the automated detection of pulmonary nodules in medical images. The present invention also generally relates to computerized techniques for automated analysis of digital images, for example, as disclosed in one or more of U.S. Pat. Nos. 4,839,807; 4,841,555; 4,851,984; 4,875,165; 4,907,156; 4,918,534; 5,072,384; 5,133,020; 5,150,292; 5,224,177; 5,289,374; 5,319,549; 5,343,390; 5,359,513; 5,452,367; 5,463,548; 5,491,627; 5,537,485; 5,598,481; 5,622,171; 5,638,458; 5,657,362; 5,666,434; 5,673,332; 5,668,888; 5,740,268; 5,790,690; 5,832,103; 5,873,824; 5,881,124; 5,931,780; 5,974,165 (PCT Publication WO 95/15537); 5,982,915; 5,984,870; 5,987,345; 6,011,862; 6,058,322; 6,067,373; 6,075,878; 6,078,680; 6,088,473; 6,112,112; 6,138,045; and 6,141,437, as well as U.S. patent application Ser. Nos. 08/173,935; 08/900,188; 08/900,189; 08/979,639; 08/982,282; 09/027,468; 09/028,518; 09/092,004; 09/121,719; 09/141,535; 09/298,852 and 09/471,088; and U.S. provisional patent application Nos. 60/107,095; 60/160,790; 60/176,297; 60/176,304; 60/180,162; 60/193,072 and 60/207,401, all of which are incorporated herein by reference. </paragraph>
<paragraph id="P-0005" lvl="0"><number>&lsqb;0005&rsqb;</number> The present invention includes use of various technologies referenced and described in the above-noted U.S. patents and patent applications, as well as described in the references identified in the appended APPENDIX by the author(s) and year of publication and cross-referenced throughout the specification by bold numerals in brackets corresponding to the respective references listed in the APPENDIX, the entire contents of which, including the related patents and applications listed above and references listed in the APPENDIX, are incorporated herein by reference. </paragraph>
<paragraph id="P-0006" lvl="0"><number>&lsqb;0006&rsqb;</number> 2. Discussion of the Background </paragraph>
<paragraph id="P-0007" lvl="0"><number>&lsqb;0007&rsqb;</number> It has been reported that radiologists can fail to detect pulmonary nodules on chest radiographs in as many as 30% of positive cases. &lsqb;1, 2&rsqb; Many of the lung cancers missed by radiologists were actually visible in retrospect on previous radiographs. &lsqb;3&rsqb; Therefore, the inventors and others at the University of Chicago Department of Radiology have developed a computer-aided diagnostic (CAD) scheme to assist radiologists in the detection of pulmonary nodules on digital chest radiographs. &lsqb;4-9&rsqb; One problem with the pre-existing scheme is the relatively large number of false positives produced by the automated scheme, which constitutes a main difficulty in the clinical application of the CAD scheme for nodule detection. </paragraph>
</section>
<section>
<heading lvl="1">SUMMARY OF THE INVENTION </heading>
<paragraph id="P-0008" lvl="0"><number>&lsqb;0008&rsqb;</number> Accordingly, the object of this invention is to provide CAD process, system and computer program product whereby the number of false positives that are incorrectly reported as nodules is reduced. </paragraph>
<paragraph id="P-0009" lvl="0"><number>&lsqb;0009&rsqb;</number> This and other objects are achieved according to the present invention by providing a new and improved method to determine whether a candidate abnormality in a medical digital image is an actual abnormality, a system which implements the method, and a computer readable medium which stores program steps to implement the method, wherein the method includes obtaining plural first templates and plural second templates respectively corresponding to predetermined abnormalities and predetermined non-abnormalities; comparing the candidate abnormality with the obtained first and second templates to derive cross-correlation values between the candidate abnormality and each of the obtained first and second templates; determining the largest cross-correlation value derived in the comparing step and whether the largest cross-correlation value is produced by comparing the candidate abnormality with the first templates or with the second templates; and determining the candidate abnormality to be an actual abnormality when the largest cross-correlation value is produced by comparing the candidate abnormality with the first templates and determining the candidate abnormality to be a non-abnormality when the largest cross-correlation value is produced by comparing the candidate abnormality with the second templates. An actual abnormality is similarly determined to be malignant or benign based on further cross-correlation values obtained by comparisons with additional templates corresponding to malignant and benign abnormalities. </paragraph>
<paragraph id="P-0010" lvl="0"><number>&lsqb;0010&rsqb;</number> The maximum cross-correlation values obtained with nodule templates and with non-nodule templates for each of the candidates nodules are employed for distinguishing non-nodules from nodules because a nodule is generally more similar to nodule templates than to non-nodule templates, and a non-nodule is more similar to non-nodule templates than to nodule templates. Therefore, the maximum cross-correlation value of a nodule with nodule templates is generally greater than that with non-nodule templates, and vice versa. Accordingly, according to the present invention, the greatest cross-correlation value obtained is determined and the candidate nodule is then determined to be an actual nodule when the greatest cross-correlation value is obtained based on a comparison with a nodule template and to be a false positive when the greatest correlation value is obtained based on a comparison with a non-nodule template. </paragraph>
<paragraph id="P-0011" lvl="0"><number>&lsqb;0011&rsqb;</number> A study implementing the CAD process of the invention was performed, whereby a large number of false positives (44.3%) in chest radiographs were removed with reduction of a very small number of true positives (2.3%) by use of the multiple-templates matching technique. In addition, a similar result on another CAD scheme for detection of nodules on CT images by use of the multiple-templates matching technique was obtained. Thus, the present invention is considered to have applicability to improve the performance of many different CAD schemes for detection of various lesions in medical images, including nodules in chest radiographs, masses and microcalcifications in mammograms, nodules, colon polyps, liver tumors, and aneurysms in CT images as well as breast lesions in ultrasound and magnetic resonance images. Furthermore, the multiple-templates matching technique has application to distinguish benign lesions from malignant lesions, in order to improve the performance of CAD schemes for classification between benign lesions and malignant lesions such as lung cancer, breast cancer, colon cancer and stomach cancer. </paragraph>
</section>
</summary-of-invention>
<brief-description-of-drawings>
<section>
<heading lvl="1">BRIEF DESCRIPTION OF THE DRAWINGS </heading>
<paragraph id="P-0012" lvl="0"><number>&lsqb;0012&rsqb;</number> A more complete appreciation of the invention and many of the attendant advantages thereof will be readily obtained as the same becomes better understood by reference to the following detailed description when considered in connection with the accompanying drawings wherein: </paragraph>
<paragraph id="P-0013" lvl="0"><number>&lsqb;0013&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> is a flow chart illustrating an overall multiple-templates matching process according to the present invention. </paragraph>
<paragraph id="P-0014" lvl="0"><number>&lsqb;0014&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> is a flow chart illustrating a basic process for the creation of a nodule template set. </paragraph>
<paragraph id="P-0015" lvl="0"><number>&lsqb;0015&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> is a flow chart illustrating a basic process for the creation of a non-nodule template set. </paragraph>
<paragraph id="P-0016" lvl="0"><number>&lsqb;0016&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 4</cross-reference> is an illustration of a plurality of examples of nodule templates which are corrected for background trend. </paragraph>
<paragraph id="P-0017" lvl="0"><number>&lsqb;0017&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 5</cross-reference> is an illustration of a plurality of examples of non-nodule templates which are connected for background trend. </paragraph>
<paragraph id="P-0018" lvl="0"><number>&lsqb;0018&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 6</cross-reference> is an illustration of a plurality of examples of original images for nodule templates. </paragraph>
<paragraph id="P-0019" lvl="0"><number>&lsqb;0019&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 7</cross-reference> is an illustration of a plurality of examples of estimated background images obtained by fitting a linear function to the original images in <cross-reference target="DRAWINGS">FIG. 6</cross-reference>. </paragraph>
<paragraph id="P-0020" lvl="0"><number>&lsqb;0020&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> is a graph illustrating the relationship between the maximum cross-correlation correlation values with 108 nodule templates and 178 non-nodule templates, for 60 randomly selected candidates. </paragraph>
<paragraph id="P-0021" lvl="0"><number>&lsqb;0021&rsqb;</number> FIGS. <highlight><bold>9</bold></highlight>(<highlight><italic>a</italic></highlight>), <highlight><bold>9</bold></highlight>(<highlight><italic>b</italic></highlight>) and <highlight><bold>9</bold></highlight>(<highlight><italic>c</italic></highlight>) are graphs illustrating the relationship between the maximum cross-correlation values with nodule templates and non-nodule templates, for 60 randomly selected candidates with (a) mirror nodule templates (216 nodule and 178 non-nodule templates), (b) mirror non-nodule templates (108 nodule and 356 non-nodule template), and (c) mirror templates for both nodules and non-nodules (216 nodule and 356 non-nodule template), respectively </paragraph>
<paragraph id="P-0022" lvl="0"><number>&lsqb;0022&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 10</cross-reference> is a graph illustrating the relationship between the maximum cross-correlation values with 432 nodule templates and 178 non-nodule templates, for 60 randomly selected candidates, with scaling of the nodule templates. </paragraph>
<paragraph id="P-0023" lvl="0"><number>&lsqb;0023&rsqb;</number> FIGS. <highlight><bold>11</bold></highlight>(<highlight><italic>a</italic></highlight>), <highlight><bold>11</bold></highlight>(<highlight><italic>b</italic></highlight>) and <highlight><bold>11</bold></highlight>(<highlight><italic>c</italic></highlight>) are graphs illustrating the relationship between the maximum cross-correlation values with nodule templates and non-nodule templates, for 60 randomly selected candidates with (a) rotation of nodule templates (324 nodule and 178 non-nodule templates), (b) rotation of non-nodule templates (108 nodule and 534 non-nodule templates), and (c) rotation of the nodule and non-nodule templates (324 nodule and 534 non-nodule templates), respectively. </paragraph>
<paragraph id="P-0024" lvl="0"><number>&lsqb;0024&rsqb;</number> FIGS. <highlight><bold>12</bold></highlight>(<highlight><italic>a</italic></highlight>), <highlight><bold>12</bold></highlight>(<highlight><italic>b</italic></highlight>) and <highlight><bold>12</bold></highlight>(<highlight><italic>c</italic></highlight>) are graphs illustrating the relationship between the maximum cross-correlation values with 216 nodule templates and 356 non-nodule templates, for 60 randomly selected candidates when the matrix size of templates is equal to (a) 24&times;24, (b) 36&times;36, and (c) 48&times;48 pixels, respectively. </paragraph>
<paragraph id="P-0025" lvl="0"><number>&lsqb;0025&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 13</cross-reference> is an illustration of examples of nodule-like non-nodule templates. </paragraph>
<paragraph id="P-0026" lvl="0"><number>&lsqb;0026&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 14</cross-reference> is a graph illustrating the relationship between the maximum cross-correlation values with nodule templates and non-nodule templates, for the 44 nodules in the test set, before (x&apos;s) and after (circles) the elimination of nodule-like non-nodule templates. </paragraph>
<paragraph id="P-0027" lvl="0"><number>&lsqb;0027&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 15</cross-reference> is a graph illustrating the relationship between the maximum cross-correlation values with nodule templates and non-nodule templates, for half (189) of the 377 non-nodules in the test set, before (x&apos;s) and after (dots) the elimination of nodule-like non-nodule templates. </paragraph>
<paragraph id="P-0028" lvl="0"><number>&lsqb;0028&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 16</cross-reference> is a graph illustrating the relationship between the maximum cross-correlation values with 5,664 nodule templates and 18,462 non-nodule templates, for 44 nodules (circles) and 377 non-nodules (dots) in the test set, after the elimination of nodule-like non-nodule templates in a validation test. </paragraph>
<paragraph id="P-0029" lvl="0"><number>&lsqb;0029&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 17</cross-reference> is a graph illustrating the relationship between the maximum cross-correlation values with 1,440 CT nodule templates and 1,440 CT non-nodule templates, for 60 CT nodules (circles) and 60 CT non-nodules (dots). </paragraph>
<paragraph id="P-0030" lvl="0"><number>&lsqb;0030&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 18</cross-reference> is a graph illustrating a relationship between the maximum cross-correlation values with 180 malignant nodule templates and 180 benign nodule templates, for 10 malignant nodules (circles) and 10 benign nodules (dots), wherein the 180 malignant nodule templates and 180 benign nodule templates were obtained, respectively, from the 10 typical malignant nodules and 10 typical benign nodules by use of mirror templates, scaled templates, and rotated templates and the dashed line was used as a threshold for distinction between malignant nodules and benign nodules. </paragraph>
</section>
</brief-description-of-drawings>
<detailed-description>
<section>
<heading lvl="1">DESCRIPTION OF THE PREFERRED EMBODIMENTS </heading>
<paragraph id="P-0031" lvl="7"><number>&lsqb;0031&rsqb;</number> Methods and Materials </paragraph>
<paragraph id="P-0032" lvl="0"><number>&lsqb;0032&rsqb;</number> The chest images used in first development of the present invention, as directed to chest radiographs, consisted of 100 abnormal posteroanterior (PA) chest radiographs selected in the Department of Radiology, the University of Chicago Hospitals &lsqb;9&rsqb;. A total of 122 nodules were confirmed, based on the consensus of two radiologists and verified by CT scans or radiographic follow-up. The nodule diameter ranged from 4 mm to 27 mm (average, 13 mm). The digital images were obtained by digitizing of the chest radiographs with a Konica laser film scanner. The original digital image has a pixel size of 0.175 mm, a matrix size of 2000&times;2000, and a gray level range of 10 bits. Because nodules are relatively large in chest images, the matrix size of the digital images was reduced by a factor of 4. Consequently, the final image had a pixel size of 0.7 mm and a matrix size of 500&times;500. In addition to the main database above, a supplemental database, the Japanese Standard Digital Image Database &lsqb;10&rsqb;, was employed solely for creation of nodule templates and for training of the multiple-templates matching technique, but not for the verification of the present CAD scheme with the multiple-templates matching technique. The supplemental database was developed by the Japanese Society of Radiological Technology, and is described hereinafter. </paragraph>
<paragraph id="P-0033" lvl="0"><number>&lsqb;0033&rsqb;</number> With the pre-existing CAD scheme, 116 nodules and 4875 false positives were initially detected from the 100 chest images in our database. A rule-based classification technique was then applied to reduce the number of false positives, &lsqb;9&rsqb; with which 88 nodules and 377 false positives were obtained. For the multiple-templates matching technique, the 116 nodules and 4875 false positives detected initially by the pre-existing CAD scheme were used as initial nodule templates and initial non-nodule templates, respectively. However, the 88 nodules and 377 false positives reported finally by the present CAD scheme were used for training and testing of the final result. Eight non-nodule-like nodule templates and 1798 nodule-like non-nodule templates were systematically eliminated from the nodule template set and the non-nodule template set, respectively, so as to achieve a good performance for the multiple-templates matching technique. It is also noted that the 377 false positives in the test candidate set survived the pre-existing rule-based tests and are, therefore, considered as &ldquo;difficult&rdquo; false positives, which are similar to nodules. In the study, the multiple-templates matching technique was employed to reduce significantly the number of these difficult false positives. Summary of the pre-existing CAD scheme based on rule-based tests </paragraph>
<paragraph id="P-0034" lvl="0"><number>&lsqb;0034&rsqb;</number> First of all, the lung areas in PA chest images were segmented by use of the delineated ribcage edges, lung top, and diaphragm, &lsqb;11, 12&rsqb; and were employed for the subsequent processing of the CAD scheme. A difference image was then obtained by subtraction of a nodule-suppressed image (by use of a smooth filter) from a nodule-enhanced image (by use of a matched filter), so that the complicated background structure could be reduced, and thus nodules could be more conspicuous. In order to detect the initial nodule candidates from the difference image, multiple binary images were obtained by thresholding the difference image with various threshold levels. In each of the binary images, a component labeling technique was used to identify each isolated &ldquo;island,&rdquo; &lsqb;4&rsqb; and two features, the effective diameter and the degree of circularity, were determined for each island. An island was then considered to be an initial nodule candidate if its effective diameter and degree of circularity were equal to or larger than 6.5 mm and 0.65, respectively. For the database of 100 abnormal chest images, a total of 116 (out of 122) nodules and 4875 false positives were identified as initial nodule candidates. </paragraph>
<paragraph id="P-0035" lvl="0"><number>&lsqb;0035&rsqb;</number> Next, a region growing technique &lsqb;5, 6&rsqb; was applied to both the difference image and the original image at the locations of initial nodule candidates, for accurate segmentation of nodule candidates from background in each of the two images. Various features, such as the effective diameter, contrast, degree of circularity, degree of irregularity, edge gradient, slope of circularity, slope of irregularity, and slope of diameter, were then determined from each of the grown regions, and employed for distinction between nodules and false positives by a rule-based classification techniques. After this step, most nodules, 88 (75.9%) out of 116, were retained, and most false positives, 4498 (92.3%) out of 4875, were eliminated; thus, 377 false positives remained. </paragraph>
<paragraph id="P-0036" lvl="7"><number>&lsqb;0036&rsqb;</number> Overall Scheme of the Multiple-Templates Matching Technique for Reduction of False Positives </paragraph>
<paragraph id="P-0037" lvl="0"><number>&lsqb;0037&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 1</cross-reference> shows the overall scheme for the multiple-templates matching process of the present invention. First of all, in step <highlight><bold>10</bold></highlight> a digital chest image is obtained and in step <highlight><bold>20</bold></highlight> a CAD scheme for nodule detection is applied and in step <highlight><bold>30</bold></highlight> candidate nodules are obtained thereby. In steps <highlight><bold>40</bold></highlight> and <highlight><bold>50</bold></highlight>, nodule templet sets and non-nodule templet steps are obtained, and in step <highlight><bold>60</bold></highlight>, for each of the candidate nodules, a cross-correlation technique is employed to calculate the cross-correlation values with the nodule template set and with the non-nodule template set. Finally, two maximum cross-correlation values obtained with the nodule template set and with the non-nodule template set are determined, and employed to eliminate false positives (non-nodules) in step <highlight><bold>70</bold></highlight>. Resulting in the identification of the remaining candidate nodules as actual nodules in step <highlight><bold>80</bold></highlight>. If the maximum cross-correlation value is obtained by comparison of the candidate nodule with a non-nodule template, then the candidate nodule is determined to be a false positive. On the other hand, if the maximum cross-correlation value is obtained by comparison of the candidate nodule with a nodule template, then the candidate nodule is determined to be an actual nodule. </paragraph>
<paragraph id="P-0038" lvl="0"><number>&lsqb;0038&rsqb;</number> In order to apply the multiple-templates matching technique, two multiple-template sets, i.e., one with a large number of nodule templates and another with a large number of non-nodule templates, were created. In this study, the initial nodule candidates (116 nodules and 4875 non-nodules) reported by the pre-existing CAD scheme were used as initial templates, which were small regions of interest (ROIs) of 36&times;36 pixels centered at the locations of the initial nodule candidates. </paragraph>
<paragraph id="P-0039" lvl="0"><number>&lsqb;0039&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 2</cross-reference> shows the basic scheme for creation of the nodule template set from the initial nodule templates. In step <highlight><bold>41</bold></highlight> the initial nodule templates were obtained and then in step <highlight><bold>42</bold></highlight>, each of the nodule templates was first right/left reversed to produce a mirror template so that the number of templates would be doubled. Then in step <highlight><bold>43</bold></highlight>, each of the nodule templates was scaled (minified or magnified), and in step <highlight><bold>44</bold></highlight> also rotated to increase the number of nodule templates further. Finally, in step <highlight><bold>45</bold></highlight> eight non-nodule-like nodule templates (a typical nodules such as very subtle nodules overlapping ribs) were carefully identified as inappropriate nodule templates, and thus excluded from the nodule template set, to derive in step <highlight><bold>46</bold></highlight> the template set for nodules. </paragraph>
<paragraph id="P-0040" lvl="0"><number>&lsqb;0040&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 3</cross-reference> shows a similar scheme for creation of the non-nodule template set. Each of the non-nodule templates obtained in step <highlight><bold>51</bold></highlight> was first right/left reversed in step <highlight><bold>52</bold></highlight>, and also rotated in step <highlight><bold>53</bold></highlight> to increase the number of non-nodule templates. Many (1789) non-nodule templates that had a similar appearance as nodules were then systematically removed in step <highlight><bold>54</bold></highlight> from the non-nodule template set by use of a training set, as will be hereinafter, because the presence of these nodule-like non-nodule templates can considerably degrade the performance of the multiple-templates matching technique. The non-nodule templates were not scaled because a relatively large number of non-nodule templates had been obtained, and also because the templates obtained by use of scaling were slightly obscured. After the removal of non-nodule-like nodule templates and nodule-like non-nodule templates, 3077 non-nodule templates in the non-nodule template set were obtained in step <highlight><bold>55</bold></highlight>, in addition to the 108 nodule templates obtained in the nodule template set. </paragraph>
<paragraph id="P-0041" lvl="0"><number>&lsqb;0041&rsqb;</number> <cross-reference target="DRAWINGS">FIGS. 4 and 5</cross-reference> show typical examples of nodule templates and non-nodule templates, respectively. It is apparent in <cross-reference target="DRAWINGS">FIGS. 4 and 5</cross-reference> that nodule templates and non-nodule templates are quite different in appearance, and are thus the basis for distinction between nodules and non-nodules. </paragraph>
<paragraph id="P-0042" lvl="0"><number>&lsqb;0042&rsqb;</number> The 88 nodules reported finally by the pre-existing CAD scheme were then divided into two sets, each of which had 44 randomly selected nodules. One set was employed, which is called a training set, to systematically eliminate nodule-like non-nodule templates from the non-nodule template set, as described hereinafter. The 44 nodules in the other set plus the 377 non-nodules (false positives), called a test set, were used for verifying the performance of the multiple-templates matching technique of the present invention. Similar to the templates, a test candidate was a small ROI of 40&times;40 pixels centered at the location of nodule candidates in the test set. </paragraph>
<paragraph id="P-0043" lvl="0"><number>&lsqb;0043&rsqb;</number> In addition to the data sets above, a small template set and a small test set were also used, in order to reduce the computation time for determination of the matrix size of templates, and for investigation of the effect of a number of parameters such as scaling and rotation of templates. The small template set included all of the 108 nodule templates in the nodule template set and 178 &ldquo;typical&rdquo; non-nodule templates selected manually from 4875 non-nodules. The small test set included 30 nodules and 30 non-nodules, which were randomly selected from the 88 nodules and 377 non-nodules, respectively. </paragraph>
<paragraph id="P-0044" lvl="7"><number>&lsqb;0044&rsqb;</number> Determination of Maximum Cross-Correlation Values Between a Test Candidate and the Template Sets of Nodules and Non-Nodules </paragraph>
<paragraph id="P-0045" lvl="0"><number>&lsqb;0045&rsqb;</number> A round robin method, i.e., a leave-one-out test method, was used for the determination of cross-correlation values between templates and a test candidate; namely, if a test candidate was included in the set of templates, the corresponding template would not be used for the determination of the cross-correlation value with the test candidate. Before the actual calculation of the cross-correlation value between a template and a test candidate, a preprocessing step was utilized for correction of the background trend included in a template and test candidate. The background trend in the template (or test candidate) was represented by a two-dimensional (surface) linear function, and the coefficients of the linear function were determined by a least square method. The estimated surface function was then subtracted from the original image of the template (or the test candidate) to provide a background-trend corrected image. </paragraph>
<paragraph id="P-0046" lvl="0"><number>&lsqb;0046&rsqb;</number> <cross-reference target="DRAWINGS">FIGS. 6 and 7</cross-reference> show the original images for templates and the estimated background, respectively. The background-trend corrected images, which were obtained by subtraction of the estimated background from the original images, are shown in <cross-reference target="DRAWINGS">FIG. 4</cross-reference>. </paragraph>
<paragraph id="P-0047" lvl="0"><number>&lsqb;0047&rsqb;</number> The matrix size (40&times;40 pixels) of the test candidates is 4 pixels larger than that (36&times;36 pixels) of the templates in both horizontal and vertical directions. In order to determine the cross-correlation value between a template A and a test candidate B, template A was moved for a maximum shift value of 4 pixels in both horizontal and vertical directions, and a cross-correlation value C<highlight><subscript>l,j </subscript></highlight>was calculated at each shift value (i,j) by the equation:  
<math-cwu id="MATH-US-00001">
<number>1</number>
<math>
<mrow>
  <mrow>
    <msubsup>
      <mi>C</mi>
      <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mi>j</mi>
      </mrow>
      <mn>2</mn>
    </msubsup>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mn>1</mn>
        <mrow>
          <mi>M</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mi>N</mi>
        </mrow>
      </mfrac>
      <mo>&it;</mo>
      <mrow>
        <munderover>
          <mo>&Sum;</mo>
          <mrow>
            <mi>m</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mi>M</mi>
        </munderover>
        <mo>&it;</mo>
        <mrow>
          <munderover>
            <mo>&Sum;</mo>
            <mrow>
              <mi>n</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mi>N</mi>
          </munderover>
          <mo>&it;</mo>
          <mfrac>
            <mrow>
              <mrow>
                <mo>{</mo>
                <mrow>
                  <mrow>
                    <mi>A</mi>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>m</mi>
                        <mo>,</mo>
                        <mi>n</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>-</mo>
                  <mover>
                    <mi>A</mi>
                    <mi>_</mi>
                  </mover>
                </mrow>
                <mo>}</mo>
              </mrow>
              <mo>&it;</mo>
              <mrow>
                <mo>{</mo>
                <mrow>
                  <mrow>
                    <msub>
                      <mi>B</mi>
                      <mrow>
                        <mi>i</mi>
                        <mo>,</mo>
                        <mi>j</mi>
                      </mrow>
                    </msub>
                    <mo>&af;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>m</mi>
                        <mo>,</mo>
                        <mi>n</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>-</mo>
                  <mover>
                    <mi>B</mi>
                    <mi>_</mi>
                  </mover>
                </mrow>
                <mo>}</mo>
              </mrow>
            </mrow>
            <mrow>
              <msub>
                <mi>&sigma;</mi>
                <mi>A</mi>
              </msub>
              <mo>&it;</mo>
              <msub>
                <mi>&sigma;</mi>
                <mi>B</mi>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mi>i</mi>
  <mo>,</mo>
  <mrow>
    <mi>j</mi>
    <mo>&Element;</mo>
    <mrow>
      <mo>{</mo>
      <mrow>
        <mn>0</mn>
        <mo>,</mo>
        <mn>1</mn>
        <mo>,</mo>
        <mn>2</mn>
        <mo>,</mo>
        <mn>3</mn>
        <mo>,</mo>
        <mn>4</mn>
      </mrow>
      <mo>}</mo>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
<mathematica-file id="MATHEMATICA-00001" file="US20030002723A1-20030102-M00001.NB"/>
<image id="EMI-M00001" wi="216.027" he="29.9943" file="US20030002723A1-20030102-M00001.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0048" lvl="7"><number>&lsqb;0048&rsqb;</number> where A and &sgr;<highlight><subscript>A</subscript></highlight><highlight><superscript>2 </superscript></highlight>are the mean and variance of the pixel values in the template A, respectively, and B and &sgr;<highlight><subscript>B</subscript></highlight><highlight><superscript>2 </superscript></highlight>are the mean and variance of the pixel values in a subregion, B<highlight><subscript>l,j</subscript></highlight>, of the test candidate B at a shift value (i,j), respectively. The mean and variance of the pixel values in regions A and B<highlight><subscript>l,j </subscript></highlight>are defined by the following equations:  
<math-cwu id="MATH-US-00002">
<number>2</number>
<math>
<mrow>
  <mrow>
    <mover>
      <mi>A</mi>
      <mi>_</mi>
    </mover>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mn>1</mn>
        <mrow>
          <mi>M</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mi>N</mi>
        </mrow>
      </mfrac>
      <mo>&it;</mo>
      <mrow>
        <munderover>
          <mo>&Sum;</mo>
          <mrow>
            <mi>m</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mi>M</mi>
        </munderover>
        <mo>&it;</mo>
        <mrow>
          <munderover>
            <mo>&Sum;</mo>
            <mrow>
              <mi>n</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mi>N</mi>
          </munderover>
          <mo>&it;</mo>
          <mrow>
            <mi>A</mi>
            <mo>&af;</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mi>m</mi>
                <mo>,</mo>
                <mi>n</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mtext>&NewLine;</mtext>
  </mstyle>
  <mo>&it;</mo>
  <mrow>
    <msubsup>
      <mi>&sigma;</mi>
      <mi>B</mi>
      <mn>2</mn>
    </msubsup>
    <mo>=</mo>
    <mrow>
      <mrow>
        <mfrac>
          <mn>1</mn>
          <mrow>
            <mi>M</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>N</mi>
          </mrow>
        </mfrac>
        <mo>&it;</mo>
        <mrow>
          <munderover>
            <mo>&Sum;</mo>
            <mrow>
              <mi>m</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mi>M</mi>
          </munderover>
          <mo>&it;</mo>
          <mrow>
            <munderover>
              <mo>&Sum;</mo>
              <mrow>
                <mi>n</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>N</mi>
            </munderover>
            <mo>&it;</mo>
            <mrow>
              <msup>
                <mrow>
                  <mo>{</mo>
                  <mrow>
                    <mrow>
                      <msub>
                        <mi>B</mi>
                        <mrow>
                          <mi>i</mi>
                          <mo>,</mo>
                          <mi>j</mi>
                        </mrow>
                      </msub>
                      <mo>&af;</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mi>m</mi>
                          <mo>,</mo>
                          <mi>n</mi>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                    <mo>-</mo>
                    <mover>
                      <mi>B</mi>
                      <mi>_</mi>
                    </mover>
                  </mrow>
                  <mo>}</mo>
                </mrow>
                <mn>2</mn>
              </msup>
              <mo>.</mo>
              <mstyle>
                <mtext>&NewLine;</mtext>
              </mstyle>
              <mo>&it;</mo>
              <mover>
                <mi>B</mi>
                <mi>_</mi>
              </mover>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
      <mo>=</mo>
      <mrow>
        <mfrac>
          <mn>1</mn>
          <mrow>
            <mi>M</mi>
            <mo>&it;</mo>
            <mstyle>
              <mtext>&emsp;</mtext>
            </mstyle>
            <mo>&it;</mo>
            <mi>N</mi>
          </mrow>
        </mfrac>
        <mo>&it;</mo>
        <mrow>
          <munderover>
            <mo>&Sum;</mo>
            <mrow>
              <mi>m</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mi>M</mi>
          </munderover>
          <mo>&it;</mo>
          <mrow>
            <munderover>
              <mo>&Sum;</mo>
              <mrow>
                <mi>n</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>N</mi>
            </munderover>
            <mo>&it;</mo>
            <mrow>
              <msub>
                <mi>B</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>j</mi>
                </mrow>
              </msub>
              <mo>&af;</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>m</mi>
                  <mo>,</mo>
                  <mi>n</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mtext>&NewLine;</mtext>
  </mstyle>
  <mo>&it;</mo>
  <mrow>
    <msubsup>
      <mi>&sigma;</mi>
      <mi>A</mi>
      <mn>2</mn>
    </msubsup>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mn>1</mn>
        <mrow>
          <mi>M</mi>
          <mo>&it;</mo>
          <mstyle>
            <mtext>&emsp;</mtext>
          </mstyle>
          <mo>&it;</mo>
          <mi>N</mi>
        </mrow>
      </mfrac>
      <mo>&it;</mo>
      <mrow>
        <munderover>
          <mo>&Sum;</mo>
          <mrow>
            <mi>m</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mi>M</mi>
        </munderover>
        <mo>&it;</mo>
        <mrow>
          <munderover>
            <mo>&Sum;</mo>
            <mrow>
              <mi>n</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mi>N</mi>
          </munderover>
          <mo>&it;</mo>
          <msup>
            <mrow>
              <mo>{</mo>
              <mrow>
                <mrow>
                  <mi>A</mi>
                  <mo>&af;</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>m</mi>
                      <mo>,</mo>
                      <mi>n</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>-</mo>
                <mover>
                  <mi>A</mi>
                  <mi>_</mi>
                </mover>
              </mrow>
              <mo>}</mo>
            </mrow>
            <mn>2</mn>
          </msup>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
<mathematica-file id="MATHEMATICA-00002" file="US20030002723A1-20030102-M00002.NB"/>
<image id="EMI-M00002" wi="216.027" he="108.9774" file="US20030002723A1-20030102-M00002.TIF" imf="TIFF" ti="MF"/>
</math-cwu>
</paragraph>
<paragraph id="P-0049" lvl="7"><number>&lsqb;0049&rsqb;</number> The largest cross-correlation value among all shift values was then determined as the cross-correlation value between the template and the test candidate. Next, the cross-correlation values for the test candidate with all of the nodule templates were computed, and the maximum cross-correlation value was determined, and employed as a unique feature of the test candidate, which indicates the extent of the resemblance to the nodule. Similarly, the maximum cross-correlation value for the test candidate with the non-nodule template set was determined and used as another unique feature of the test candidate. which indicates the extent of the resemblance to the non-nodule. These two features for the candidates in the test set were then employed for distinguishing false positives from nodules, when the maximum cross-correlation values with the non-nodule templates was larger than that with the nodule templates. </paragraph>
<paragraph id="P-0050" lvl="7"><number>&lsqb;0050&rsqb;</number> Creation of Nodule Templates and Non-Nodule Templates </paragraph>
<paragraph id="P-0051" lvl="0"><number>&lsqb;0051&rsqb;</number> A key factor for the success of the multiple-templates matching technique is the number of templates available for nodules and non-nodules. In this study, only 108, which were selected from the 116 nodules initially detected by our CAD scheme for nodule detection nodules, were used as nodule templates. Although any ROIs in a chest radiograph that do not contain a nodule can theoretically be considered as a non-nodule template, as non-nodule templates, the 3077 false positives were selected from the 4875 false positives initially detected by the preexisting CAD scheme because they were considered to be &ldquo;typical&rdquo; non-nodules. The following three methods were then utilized to increase the number of templates in this study: </paragraph>
<paragraph id="P-0052" lvl="2"><number>&lsqb;0052&rsqb;</number> (1) Right/left reversing of a template to create a mirror template, </paragraph>
<paragraph id="P-0053" lvl="2"><number>&lsqb;0053&rsqb;</number> (2) scaling of a template by three different factors of 0.6, 0.8, and 1.2, </paragraph>
<paragraph id="P-0054" lvl="2"><number>&lsqb;0054&rsqb;</number> (3) rotation of a template by two different angles, &minus;10 and &plus;10 degrees. </paragraph>
<paragraph id="P-0055" lvl="7"><number>&lsqb;0055&rsqb;</number> The ROIs obtained directly from the original images were called original templates, and those obtained by right/left reversing, scaling, or rotation of an original template were called derived templates. It should be noted that additional derived templates can be created by scaling with additional factors and also by rotation with additional angles. </paragraph>
<paragraph id="P-0056" lvl="0"><number>&lsqb;0056&rsqb;</number> The right/left reversing enables a template in the right lung to be useful in the left lung and vice versa, and it doubles the number of templates. The scaling and the rotation in this study increased the number of templates by factors of four and three, respectively, and thus the total number of templates can be increased 24 times by a combination of all of these methods. </paragraph>
<paragraph id="P-0057" lvl="0"><number>&lsqb;0057&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 8</cross-reference> shows the relationship between the maximum cross-correlation values with 108 nodule templates and 178 non-nodule templates in the small template set for 60 candidates in the small test set. As has been described previously, the templates were carefully selected from typical nodules and non-nodules. It is apparent in <cross-reference target="DRAWINGS">FIG. 8</cross-reference> that, although there is considerable overlap, nodules tend to have larger maximum correlation values with nodule templates, whereas non-nodules do so with non-nodule templates, i.e., nodules tend to be above the 45-degree line and non-nodules below the 45-degree line. This general trend indicates the usefulness of the multiple-templates matching technique in distinguishing between nodules and non-nodules. However, many test candidates have relatively low cross-correlation values with either nodule or non-nodule templates, which indicates that there were not enough templates, in the template set for nodules or non-nodules, which are very similar to those test candidates. </paragraph>
<paragraph id="P-0058" lvl="0"><number>&lsqb;0058&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 9</cross-reference> shows the relationship between the maximum cross-correlation values with the nodule templates and non-nodule templates for the 60 test candidates, when additional templates were incorporated based on (a) mirror nodule templates only, (b) mirror non-nodule templates only, and (c) mirror templates for both nodules and non-nodules. When <cross-reference target="DRAWINGS">FIG. 8</cross-reference> and <cross-reference target="DRAWINGS">FIG. 9</cross-reference>(<highlight><italic>a</italic></highlight>) are compared, it is clear that most test candidates have moved upward in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>(<highlight><italic>a</italic></highlight>), and thus the maximum cross-correlation values with nodule templates for these test candidates were increased by the use of mirror templates for nodules. In addition, nodules are located on or above the diagonal line in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>(<highlight><italic>a</italic></highlight>), and thus some non-nodules below the diagonal line can be clearly distinguished from nodules. Similarly, it was observed that most test candidates have moved to the right in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>(<highlight><italic>b</italic></highlight>), compared with <cross-reference target="DRAWINGS">FIG. 8</cross-reference>, and thus the use of mirror templates for non-nodules increased the maximum cross-correlation values with non-nodule templates. It is apparent in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>(<highlight><italic>c</italic></highlight>) that the test candidates have moved upward and to the right, and the maximum cross-correlation values with both nodule and non-nodule templates were increased by use of mirror templates. </paragraph>
<paragraph id="P-0059" lvl="0"><number>&lsqb;0059&rsqb;</number> Although the scaling may obscure a template in some cases, it was still applied to the nodule templates because the study had only a very limited number of nodules. <cross-reference target="DRAWINGS">FIG. 10</cross-reference> demonstrates the relationship between the maximum cross-correlation values with the nodule templates and non-nodule templates, together with scaled nodule templates. When the results in <cross-reference target="DRAWINGS">FIG. 10</cross-reference> are compared with the results without scaled nodule templates in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>, it is apparent that the addition of scaled nodule templates resulted in improved maximum cross-correlation values with nodule templates for the test candidates, and also improved distinction between nodules and non-nodules, because most nodules are above the diagonal line. </paragraph>
<paragraph id="P-0060" lvl="0"><number>&lsqb;0060&rsqb;</number> On the other hand, unlike scaling, the rotation was applied to all of the nodule and non-nodule templates. <cross-reference target="DRAWINGS">FIG. 11</cross-reference> shows the relationship between the maximum cross-correlation values with the nodule templates and non-nodule templates, when additional templates were created by (a) rotation of the nodule templates only, (b) rotation of the non-nodule templates only, and (c) rotation of both nodule and non-nodule templates; results without rotated templates are shown in <cross-reference target="DRAWINGS">FIG. 8</cross-reference>. Again, the maximum cross-correlation values with the nodule templates and non-nodule templates became larger by addition of rotated templates. </paragraph>
<paragraph id="P-0061" lvl="0"><number>&lsqb;0061&rsqb;</number> Another parameter for the multiple-templates matching technique is an appropriate choice of the matrix sizes for the templates and the test candidates. In this study, the effect of various matrix sizes ranging from 24&times;24 pixels to 48&times;48 pixels on the overall performance was examined. It was found that the best results were obtained when the matrix sizes for the templates and the test candidates were 36&times;36 pixels (approximately 25&times;25 mm<highlight><superscript>2</superscript></highlight>) and 40&times;40 pixels (28&times;28 mm<highlight><superscript>2</superscript></highlight>), respectively. </paragraph>
<paragraph id="P-0062" lvl="0"><number>&lsqb;0062&rsqb;</number> FIGS. <highlight><bold>12</bold></highlight>(<highlight><italic>a</italic></highlight>), (<highlight><italic>b</italic></highlight>), and (<highlight><italic>c</italic></highlight>) show the relationship between the maximum cross-correlation values with the nodule templates and non-nodule templates for <highlight><bold>60</bold></highlight> candidates, when the matrix size of templates was 24&times;24, 36&times;36, and 48&times;48 pixels, respectively. The templates used included 108 nodules and 178 non-nodules, together with their mirror templates. Although the maximum cross-correlation values were generally large, with a matrix size of 24&times;24 pixels, the overlap of the correlation values between the nodules and non-nodules was large as well, which is not useful for the separation of nodules and non-nodules. On the other hand, when the matrix size was 48&times;48 pixels, the maximum cross-correlation values were usually low and could not be used as reliable features. It is apparent from <cross-reference target="DRAWINGS">FIG. 12</cross-reference> that the best separation between the 30 nodules and 30 non-nodules was achieved when the matrix size of the templates was 36&times;36 pixels. Therefore, the matrix size of the templates used in this study was determined as 36&times;36 pixels. Elimination of nodule-like non-nodules in non-nodule template set </paragraph>
<paragraph id="P-0063" lvl="0"><number>&lsqb;0063&rsqb;</number> It is important to note that not all non-nodule templates can make a useful contribution to the improvement in the performance of the multiple-templates matching technique. In fact, many non-nodule templates do impair the performance of the multiple-templates matching technique. As can be seen in <cross-reference target="DRAWINGS">FIG. 9</cross-reference>(<highlight><italic>c</italic></highlight>), there are 4 nodules located below the diagonal line, which implies that these nodules are more similar to some non-nodule templates used than to all of the nodule templates. <cross-reference target="DRAWINGS">FIG. 13</cross-reference> illustrates examples for such non-nodule templates that pulled some nodules below the diagonal line by increasing the maximum correlation values of nodules with non-nodule templates. It was found that these non-nodule templates typically resembled nodules in appearance. Therefore, it is desirable to eliminate these nodule-like non-nodule templates in order to achieve a good performance for the multiple-templates matching technique. The nodules in the training set and in a supplemental database were employed to achieve this task. </paragraph>
<paragraph id="P-0064" lvl="0"><number>&lsqb;0064&rsqb;</number> In addition to the main database described previously, another supplemental database was also employed solely for creation of more nodule templates and for training of the multiple-templates matching technique, but not for the verification of the present CAD scheme with the multiple-templates matching technique, because the characteristics of the chest images in the supplemental database are quite different from those in the main database. The supplemental database included 128 chest images with solitary lung nodules, which were selected from a total of 154 nodule cases in the Japanese Standard Digital Image Database developed by the Japanese Society of Radiological Technology. &lsqb;10&rsqb; Twenty-six nodule cases were eliminated from the Japanese standard database, each of which contained a nodule with a subtlety rating score of either one or five, corresponding to an extremely subtle nodule or an obvious nodule, respectively. The original chest images were digitized with a 0.175 mm pixel size, a matrix size of 2048&times;2048, and 12-bit gray levels. In this study, the matrix size was reduced to 512&times;512 by subsampling of the original image data by a factor of 4, and the number of gray levels was decreased to 10 bits, in order to be consistent with the chest images in the main database. The 128 nodules in the supplemental database together with the 108 nodules in the main database were used as the nodule template set hereafter for verification of the multiple-templates matching technique. The 128 nodules were also employed for training of the multiple-templates matching technique, namely, for the removal of nodule-like non-nodule templates. </paragraph>
<paragraph id="P-0065" lvl="0"><number>&lsqb;0065&rsqb;</number> As the first step in training for the multiple-templates matching technique, for each of the 128 nodules, twenty non-nodule templates which provided the 20 largest cross-correlation values with the nodule were considered here to be nodule-like non-nodules, and were eliminated from the 4,875 original templates in the initial non-nodule template set. A total of 1,338 original non-nodule templates were thus removed, and 3,537 original non-nodule templates remained in the non-nodule template set. Similarly, the 44 nodules in the training set were employed for further elimination of nodule-like non-nodules from the 3,537 original templates. Thus, 460 original non-nodule templates were again eliminated, and finally, 3,077 original templates were left in the non-nodule template set. A total of 1,798 templates were removed from the initial non-nodule template set by employing the 128 nodules in the supplemental database and the 44 nodules in the training set altogether. For the removal of nodule-like non-nodules in the template set, the 20 largest cross-correlation values were empirically employed as the threshold. However, it is possible to employ a different number of largest cross-correlation values, depending on the number and characteristics of templates available. </paragraph>
<paragraph id="P-0066" lvl="0"><number>&lsqb;0066&rsqb;</number> In order to demonstrate how we improved the performance of the multiple-templates matching technique by elimination of the nodule-like non-nodules, <cross-reference target="DRAWINGS">FIG. 14</cross-reference> shows the relationship between the maximum cross-correlation values with the nodule templates and non-nodule templates for the 44 nodules in the test set, before (indicated by x&apos;s) and after (indicated by circles) the removal of the nodule-like non-nodule templates. The nodule template set used in <cross-reference target="DRAWINGS">FIG. 14</cross-reference> was composed of 5,664 (24&times;236) templates, which included the 108 nodules in the main database and the 128 nodules in the supplemental database, and their mirror templates, scaled templates, and rotated templates. Note that the non-nodule template set contained 29,250 (6&times;4,875) templates and 18,462 (6&times;3077) templates, respectively, before and after the removal of the nodule-like non-nodule templates, which included the original non-nodule templates, their mirror templates, and rotated templates. It is apparent in <cross-reference target="DRAWINGS">FIG. 14</cross-reference> that most nodules are moved significantly to the left by elimination of the nodule-like non-nodule templates, and that all but one nodule are located above the diagonal line, as can be predicted. </paragraph>
<paragraph id="P-0067" lvl="0"><number>&lsqb;0067&rsqb;</number> It should be noted that the elimination of nodule-like non-nodule templates would also affect the non-nodules in the test set. <cross-reference target="DRAWINGS">FIG. 15</cross-reference> shows the relationship between the maximum cross-correlation values with the nodule templates and non-nodule templates, for one half (189) of the 377 non-nodules in the test set, before (indicated by x&apos;s) and after (indicated by dots) the elimination of the non-nodule templates. Note that there were 5,664 templates in the nodule template set, and 29,250 and 18,462 templates in the non-nodule template set, respectively, before and after the elimination of nodule-like non-nodule templates. Only half of the non-nodules are shown in <cross-reference target="DRAWINGS">FIG. 15</cross-reference> for a clearer display. The nodule template set and non-nodule template sets used in <cross-reference target="DRAWINGS">FIG. 15</cross-reference> are the same as those employed in <cross-reference target="DRAWINGS">FIG. 14</cross-reference>. It is apparent in <cross-reference target="DRAWINGS">FIG. 15</cross-reference> that, although some of the 377 non-nodules moved to the left as did the nodules in <cross-reference target="DRAWINGS">FIG. 14</cross-reference>, many non-nodules still remain below the diagonal line after the elimination of the nodule-like non-nodule templates. This findings implies that, after elimination of nodule-like non-nodule templates, it is possible to distinguish the false positives (non-nodules) below the diagonal line in <cross-reference target="DRAWINGS">FIG. 15</cross-reference> from the nodules in <cross-reference target="DRAWINGS">FIG. 14</cross-reference>, because nearly all of the nodules are located above the diagonal lines. </paragraph>
<paragraph id="P-0068" lvl="0"><number>&lsqb;0068&rsqb;</number> With the 5,664 nodule templates and 18,462 non-nodule templates after the elimination of nodule-like non-nodules, a validation test was conducted based on the 44 nodules and 377 non-nodules in the test set. It should be noted that the 44 nodules and 377 non-nodules have not been utilized for training of the multiple-templates matching technique, i.e., for elimination of either nodule-like non-nodules or non-nodule-like nodules in the template set, although the 377 non-nodules were shown in <cross-reference target="DRAWINGS">FIG. 15</cross-reference> to demonstrate the effect of removing nodule-like non-nodule templates. <cross-reference target="DRAWINGS">FIG. 16</cross-reference> shows the relationship between the maximum cross-correlation values with the 5,664 nodule templates and 18,462 non-nodule templates for the 44 nodules and 377 non-nodules in the test set. It is apparent in <cross-reference target="DRAWINGS">FIG. 16</cross-reference> that a significant distinction can be made between the nodules and false positives (non-nodules) based on the two maximum cross-correlation values. For example, if the diagonal line is used as a threshold, namely, if candidates located above the diagonal line are accepted as nodules, then we can eliminate 167 (44.3%) false positives from the 377 non-nodules with a reduction of only one (2.3%) true nodule. This actually constitutes a significant improvement of the existing CAD scheme because many of the 377 false positives are similar to nodules in appearance and are thus considered as &ldquo;difficult&rdquo; false positives. </paragraph>
<paragraph id="P-0069" lvl="0"><number>&lsqb;0069&rsqb;</number> The multiple-templates matching technique requires a relatively large amount of computer time because cross-correlation values are computed with a large number of templates. For example, 24,126 (5,664&plus;18,462) templates were used in the final validation test, which requires about 85 seconds to calculate the cross-correlation values for each of the test candidates on a personal computer with an Intel Pentium-III 733 MHZ CPU and a Linux operating system. In the future, the inventors plan to expand their database greatly in order to achieve a higher performance and reliability, which, in turn, implies a larger template set and more computer time required for computing the cross-correlation values. However, this will not be a serious problem for the multiple-templates matching technique, because this technique is applied solely in the final step of the CAD scheme, which, on average, reports only three or four nodule candidates per chest image. Moreover, computers are, and will be, becoming faster and faster, and thus will significantly reduce the problem caused by the large computational burden of the multiple-templates matching technique. At present, it takes about 5-6 minutes to process each of the chest images for removal of some false positives by use of the multiple-templates matching technique. </paragraph>
<paragraph id="P-0070" lvl="7"><number>&lsqb;0070&rsqb;</number> Application to Computed Tomography </paragraph>
<paragraph id="P-0071" lvl="0"><number>&lsqb;0071&rsqb;</number> In order to demonstrate that the multiple-templates matching technique has the potential to distinguish false positives from nodules in a CAD scheme for nodule detection on computed tomography (CT), a pilot study was conducted to apply the multiple-templates matching technique to a database of 44 CT scans, which contain a total of 237 nodules. The CT scans were obtained with 10 mm collimation, and 10 mm reconstruction intervals. Each CT slice has a matrix size of 512&times;512 pixels and a gray level range of 10 bits. The field of view was optimized for each patient during the examination so that the pixel sizes in the database ranged from 0.566 to 0.781 mm. </paragraph>
<paragraph id="P-0072" lvl="0"><number>&lsqb;0072&rsqb;</number> An existing CAD process &lsqb;13&rsqb; at the University of Chicago Department of Radiology for CT nodule detection first segmented lungs from background in each slice by using a thresholding technique and a rolling-ball algorithm. A multiple gray-level thresholding technique was then applied to the segmented lung areas for detection of initial nodule candidates. For each of the initial nodule candidates, six geometric features (volume, sphericity, radius of equivalent sphere, maximum compactness, maximum circularity, and maximum eccentricity) and three gray level features (mean gray level, standard deviation of gray level, and the gray level threshold at which the nodule candidate was first detected) were determined, and were employed for distinguishing false positives from nodules. With this CAD scheme, 208 (87.8%) nodules and 4923 false positives (approximately three false positives per slice) were reported as nodule candidates. </paragraph>
<paragraph id="P-0073" lvl="0"><number>&lsqb;0073&rsqb;</number> The 208 nodules and 200 false positives, which were randomly selected from the 4923 false positives, were first chosen for construction of a basis for applying the multiple-templates matching technique to the CT nodule detection scheme. In this study, only those nodules and non-nodules that were distant from the boundaries of lung areas were manually selected, so that the templates obtained from these candidates were completely contained inside the lungs. Sixty nodules and sixty non-nodules were thus obtained from the 208 nodules and 200 non-nodules, respectively, and were used as both templates and test candidates. A leave-one-out (round robin) test method was employed so that a test candidate and the corresponding derived templates were not included in the template set used for testing. With the multiple-templates matching technique described above, the maximum cross-correlation values for 60 nodules (circles) and 60 non-nodules (dots) were obtained by use of 1,440 (24&times;60) nodule templates and 1,440 (24&times;60) non-nodule templates, as shown in <cross-reference target="DRAWINGS">FIG. 17</cross-reference>. The 1,440 nodule templates and 1,440 non-nodule templates were obtained, respectively, from the 60 nodules and 60 nodules by use of mirror templates, scaled templates, and rotated templates. The dashed line was used as a threshold for distinction between nodules and non-nodules. </paragraph>
<paragraph id="P-0074" lvl="0"><number>&lsqb;0074&rsqb;</number> It is apparent in <cross-reference target="DRAWINGS">FIG. 17</cross-reference> that nodules tend to be located above the diagonal line, whereas non-nodules tend to be located below the diagonal line, which indicates that nodules are generally more similar to nodule templates, and non-nodules are generally more similar to non-nodule templates. It is important to note in <cross-reference target="DRAWINGS">FIG. 17</cross-reference> that many nodules have very large cross-correlation values with nodule templates, and thus they are distributed above the diagonal line and around the upper-right corner, which implies that each of these nodules has at least one similar nodule template in the template set. It is thus believed that there is a larger probability to find two similar nodules in CT scans than in chest radiographs, because of the simpler background structures in CT scans. If the dashed line is used as a threshold, that is, if those candidates above the dashed line are accepted as nodules and those candidates below the dashed line are accepted as non-nodules, then 29 (48.3%) false positives (non-nodules) can be eliminated with a reduction of only one (1.7%) nodule. This result indicates that the multiple-templates matching technique has the potential to significantly reduce the number of false positives in the CAD scheme for CT nodule detection, and also in many CAD schemes for detection of many different kinds of lesions, such as masses and microcalcifications in mammograms, breast lesions in ultrasound and magnetic resonance images, colon polyps and liver tumors in abdominal CT images, and aneurysms in brain CT images. In addition, the multiple-templates matching technique can be used to distinguish benign nodules from malignant nodules, in order to improve the performance of CAD schemes for classification between benign lesions and malignant lesions due to many cancers, such as lung cancer, breast cancer, colon cancer, and stomach cancer. </paragraph>
<paragraph id="P-0075" lvl="7"><number>&lsqb;0075&rsqb;</number> Application to Benign Nodules </paragraph>
<paragraph id="P-0076" lvl="0"><number>&lsqb;0076&rsqb;</number> A pilot study was also conducted to show that the multiple-templates matching technique can be employed to distinguish benign nodules from malignant nodules in a CAD scheme for nodule classification on digital chest images. A database of 56 chest images, which contained 23 malignant nodules and 33 benign nodules, was used. Each image had a matrix size of 2048&times;2048 pixels, a pixel size of 0.175 mm, and a gray level range of 10 bits. The location and the size for each of the nodules were identified by three radiologists, and the average values for the location and the size were calculated and used for classification between malignant nodules and benign nodules in chest images, as next discussed. </paragraph>
<paragraph id="P-0077" lvl="0"><number>&lsqb;0077&rsqb;</number> 10 &ldquo;typical&rdquo; malignant nodules and 10 &ldquo;typical&rdquo; benign nodules were manually selected for distinction of benign nodules from malignant nodules by applying the multiple-templates matching technique. Because the approximate nodule size was known, an original template was first obtained at the location of a nodule with a variable matrix size so that the area of the nodule was approximately half of the area of the template. The matrix size for all the templates was then normalized (reduced or magnified) to 40&times;40 pixels by use of an image scaling technique. For each of the nodules, the same scaling factor was applied for scaling of the corresponding test candidates, which had the same center location with the corresponding template, and whose matrix size was 48&times;48 pixels. </paragraph>
<paragraph id="P-0078" lvl="0"><number>&lsqb;0078&rsqb;</number> Each template was then right/left reversed, rotated by two angles of &minus;10 and &plus;10 degrees, and scaled by two factors of 0.9 and 1.1 in order to correct the inaccuracy of the estimated nodule size by the radiologists. By combining the three techniques for increasing of the number of templates, we obtained 180 (18&times;10) templates for malignant nodules and 180(18&times;10) templates for benign nodules. The background trend was corrected for all the templates and the test candidates prior to the determination of cross correlation values between them. A round robin test method was employed so that a test candidate and the corresponding derived templates were not included in the template set used for testing. </paragraph>
<paragraph id="P-0079" lvl="0"><number>&lsqb;0079&rsqb;</number> <cross-reference target="DRAWINGS">FIG. 18</cross-reference> shows the maximum cross-correlation values for 10 malignant nodules (circles) and 10 benign nodules (dots) obtained with the multiple-templates matching technique by use of 180 (18&times;10) malignant nodule templates and 180 (18&times;10) benign nodule templates. It is apparent in <cross-reference target="DRAWINGS">FIG. 18</cross-reference> that malignant nodules tend to be located above the diagonal line, whereas benign nodules tend to be located below the diagonal line, which indicates that malignant nodules are generally more similar to malignant nodule templates, and benign nodules are generally more similar to benign nodule templates. If the diagonal line is used as a threshold, that is, if those candidates above the diagonal line are accepted as malignant nodules and those candidates below the diagonal line as benign nodules, then it is possible to eliminate 8 (80%) benign nodules while retaining all the malignant nodules. This result indicates that the multiple-templates matching technique has the ability to distinguish benign nodules from malignant nodules, in order to improve the performance of CAD schemes for classification between benign lesions and malignant lesions due to many cancers, such as lung cancer, breast cancer, colon cancer, and stomach cancer. </paragraph>
<paragraph id="P-0080" lvl="7"><number>&lsqb;0080&rsqb;</number> Computer Program Product </paragraph>
<paragraph id="P-0081" lvl="0"><number>&lsqb;0081&rsqb;</number> The mechanisms and processes set forth in the present description may be implemented using a conventional general purpose microprocessor or computer programmed according to the teachings in the present specification, as will be appreciated by those skilled in the relevant art(s). Appropriate software coding can readily be prepared by skilled programmers based on the teachings of the present disclosure, as will also be apparent to those skilled in the relevant art(s). However, as will be readily apparent to those skilled in the art, the present invention also may be implemented by the preparation of application-specific integrated circuits or by interconnecting an appropriate network of conventional component circuits. </paragraph>
<paragraph id="P-0082" lvl="0"><number>&lsqb;0082&rsqb;</number> The present invention thus also includes a computer-based product which may be hosted on a storage medium and include instructions which can be used to program a general purpose microprocessor or computer to perform processes in accordance with the present invention. This storage medium can include, but is not limited to, any type of disk including floppy disks, optical disks, CD-ROMs, magneto-optical disks, ROMs, RAMs, EPROMs, EEPROMs, flash memory, magnetic or optical cards, or any type of media suitable for storing electronic instructions. </paragraph>
<paragraph id="P-0083" lvl="0"><number>&lsqb;0083&rsqb;</number> The programming of the general purpose microprocessor or computer may include a software module for digitizing and storing images obtained from an image acquisition device (not shown). Alternatively, the present invention can also be implemented to process digital data derived from images obtained by other means, such as a picture archive communication system (PACS) or directly from an imaging device which produces digital image data. In other words, the digital images being processed may already be in existence in digital form and need not be converted to digital form in practicing the invention. </paragraph>
<paragraph id="P-0084" lvl="0"><number>&lsqb;0084&rsqb;</number> Numerous modifications and variations of the present invention are possible in light of the above teachings. It is therefore to be understood that within the scope of the appended claims, the invention may be practiced otherwise than as specifically described herein. </paragraph>
</section>
<section>
<heading lvl="1">LIST OF REFERENCES </heading>
<paragraph id="P-0085" lvl="1"><number>&lsqb;0085&rsqb;</number> 1. J. V. Forrest and P. J. Friedman, &ldquo;Radiologic errors in patients with lung cancers,&rdquo; West J. Med. 134, 485-490, (1981). </paragraph>
<paragraph id="P-0086" lvl="1"><number>&lsqb;0086&rsqb;</number> 2. D. P. Naidichi, E. A. Zerhouni, and S. S. Slegelman, Computer tomography of thorax (Raven, N.Y., 1984), pp. 171-199. </paragraph>
<paragraph id="P-0087" lvl="1"><number>&lsqb;0087&rsqb;</number> 3. J. R. Muhm, R. S. Miller, R. S. Fontana, et al, &ldquo;Lung cancer detected during a screening program using four-month chest radiographs,&rdquo; Radiology 148, 609-615 (1983). </paragraph>
<paragraph id="P-0088" lvl="1"><number>&lsqb;0088&rsqb;</number> 4. M. L. Giger, K. Doi, and H. MacMahon, &ldquo;Image feature analysis and computer-aided diagnosis in digital radiography. <highlight><bold>3</bold></highlight>. Automated detection of nodules in peripheral lung fields,&rdquo; Med. Phys. 15, 158-166 (1988). </paragraph>
<paragraph id="P-0089" lvl="1"><number>&lsqb;0089&rsqb;</number> 5. M. L. Giger, K. Doi, H. MacMahon, C. E. Metz, and F. F. Yin, &ldquo;Pulmonary nodules: computer aided detection in digital chest image,&rdquo; RadioGraphics 10, 41-51 (1990). </paragraph>
<paragraph id="P-0090" lvl="1"><number>&lsqb;0090&rsqb;</number> 6. T. Matsumoto, H. Yoshimura, K. Doi, M. L. Giger, A. Kano, H. MacMahon, K. Abe, and S. M. Montner, &ldquo;Image feature analysis of false-positive diagnoses produced by automated detection of lung nodules,&rdquo; Invest. Radiol. 27, 587-597 (1992). </paragraph>
<paragraph id="P-0091" lvl="1"><number>&lsqb;0091&rsqb;</number> 7. Y. C. Wu, K. Doi, M. L. Giger, C. E. Metz, and W. Zhang, &ldquo;Reduction of false positives in computerized detection of lung nodules in chest radiographs using artificial neural networks, discriminant analysis and a rule-based scheme,&rdquo; J. Digital Imag. 7, 196-207 (1994). </paragraph>
<paragraph id="P-0092" lvl="1"><number>&lsqb;0092&rsqb;</number> 8. T. Kobayashi, X. W. Xu, H. MacMahon, C. E. Metz, and K. Doi, &ldquo;Effect of a computer-aided diagnosis scheme on radiologists&apos; performance in detection of lung nodules on radiographs.&rdquo; Radiology 199, 843-848 (1996). </paragraph>
<paragraph id="P-0093" lvl="1"><number>&lsqb;0093&rsqb;</number> 9. X. W. Xu, K. Doi, T. Kobayashi, H. MacMahon, and M. L. Giger, &ldquo;Development of an improved CAD scheme for automated detection of lung nodules in digital chest images,&rdquo; Med. Phys. 24, 1395-1403(1997). </paragraph>
<paragraph id="P-0094" lvl="1"><number>&lsqb;0094&rsqb;</number> 10. J. Shiraishi, S. Katsuragawa, J. Ikezoe, T. Kobayashi, K. Komatsu, M. Matsui, H. Fujita, Y. Kodera, and K. Doi, &ldquo;Development of a digital image database for chest radiographs with and without a lung nodule: Receiver operating characteristic analysis of radiologists&apos; detection of pulmonary nodules,&rdquo; AJR 147, 71-74 (2000). </paragraph>
<paragraph id="P-0095" lvl="1"><number>&lsqb;0095&rsqb;</number> 11. X. W. Xu, K. Doi, &ldquo;Image feature analysis for computer-aided diagnosis: Accurate determination of ribcage boundary in chest radiographs,&rdquo; Med. Phys. 22, 617-626 (1995). </paragraph>
<paragraph id="P-0096" lvl="1"><number>&lsqb;0096&rsqb;</number> 12. X. W. Xu, K. Doi, &ldquo;Image feature analysis for computer-aided diagnosis: </paragraph>
<paragraph id="P-0097" lvl="0"><number>&lsqb;0097&rsqb;</number> Detection of right and left hemidiaphragm edges and delineation of lung field in chest radiographs,&rdquo; Med. Phys. 23, 1613-1624(1996). </paragraph>
<paragraph id="P-0098" lvl="1"><number>&lsqb;0098&rsqb;</number> 13. S. G. Armato 111, M. L. Giger, C. J. Moran, J. T. Blackburn, K. Doi, and H. MacMahon, &ldquo;Computerized detection of pulmonary nodules on CT scans,&rdquo; Radiographics 19, 1303-131 1, (1999). </paragraph>
</section>
</detailed-description>
</subdoc-description>
<subdoc-claims>
<heading lvl="1">What is new and useful and desired to be secured by Letters Patent of the United States is: </heading>
<claim id="CLM-00001">
<claim-text><highlight><bold>1</bold></highlight>. In a method to determine whether a candidate abnormality in a medical digital image is an actual abnormality, the improvement comprising: 
<claim-text>obtaining plural first templates and plural second templates respectively corresponding to predetermined abnormalities and predetermined non-abnormalities; </claim-text>
<claim-text>comparing the candidate abnormality in the medical digital image with the obtained first and second templates to determine a degree of matching between the candidate abnormality and the first and second templates; and </claim-text>
<claim-text>determining the candidate abnormality to be an actual abnormality or a non-abnormality based on whether a best match is obtained by comparing the candidate abnormality with the first template or the second template. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00002">
<claim-text><highlight><bold>2</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said step of obtaining plural first templates and plural second templates comprises: 
<claim-text>obtaining plural first templates and plural second templates which are smaller in size than the candidate abnormality. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00003">
<claim-text><highlight><bold>3</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00002">claim 2</dependent-claim-reference>, wherein said comparing step comprises: 
<claim-text>comparing the candidate abnormality with the obtained first and second templates to derive cross-correlation values between the candidate abnormality and each of the obtained first and second templates; and </claim-text>
<claim-text>shifting the first and second templates in relation to said candidate abnormality to derive cross-correlation values between the candidate abnormality and each of the shifted first and second templates. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00004">
<claim-text><highlight><bold>4</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said step of obtaining plural first templates and plural second templates comprises: 
<claim-text>producing additional first and second templates which are mirror images of the obtained plural first templates and plural second templates. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00005">
<claim-text><highlight><bold>5</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said step of obtaining plural first templates and plural second templates comprises: 
<claim-text>producing additional first templates which are scaled versions of the obtained plural first templates. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00006">
<claim-text><highlight><bold>6</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said step of obtaining plural first templates and plural second templates comprises: 
<claim-text>producing additional first and second templates which are rotated versions of the obtained plural first templates and plural second templates. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00007">
<claim-text><highlight><bold>7</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, wherein said step of obtaining plural first templates and plural second templates comprises: 
<claim-text>obtaining candidate first templates and candidate second templates; </claim-text>
<claim-text>comparing the candidate first templates to at least one known non-abnormality structure and retaining as first templates only those candidate first templates which exhibit a predetermined degree of non-similarity to the at least one known non-abnormality structure; and </claim-text>
<claim-text>comparing the candidate second templates to at least one known abnormality structure and retaining as second templates only those candidate second templates which exhibit a predetermined degree of non-similarity to the at least one known abnormality structure. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00008">
<claim-text><highlight><bold>8</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00002">claim 2</dependent-claim-reference>, wherein said step of obtaining plural first templates and plural second templates comprises: 
<claim-text>obtaining candidate first templates and candidate second templates; </claim-text>
<claim-text>comparing the candidate first templates to at least one known non-abnormality structure and retaining as first templates only those candidate first templates which exhibit a predetermined degree of non-similarity to the at least one known non-abnormality structure; and </claim-text>
<claim-text>comparing the candidate second templates to at least one known abnormality structure and retaining as second templates only those candidate second templates which exhibit a predetermined degree of non-similarity to the at least one known abnormality structure. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00009">
<claim-text><highlight><bold>9</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, wherein said step of obtaining plural first templates and plural second templates comprises: 
<claim-text>obtaining candidate first templates and candidate second templates; </claim-text>
<claim-text>comparing the candidate first templates to at least one known non-abnormality structure and retaining as first templates only those candidate first templates which exhibit a predetermined degree of non-similarity to the at least one known non-abnormality structure; and </claim-text>
<claim-text>comparing the candidate second templates to at least one known abnormality structure and retaining as second templates only those candidate second templates which exhibit a predetermined degree of non-similarity to the at least one known abnormality structure. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00010">
<claim-text><highlight><bold>10</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00001">claim 1</dependent-claim-reference>, further comprising: 
<claim-text>obtaining plural third templates and plural fourth templates respectively corresponding to predetermined malignant abnormalities and predetermined benign abnormalities; </claim-text>
<claim-text>comparing an actual abnormality with the obtained third and fourth templates to derive cross-correlation values between the actual abnormality and each of the obtained third and fourth templates; </claim-text>
<claim-text>determining the largest cross-correlation value derived in the preceding comparing step and whether the largest cross-correlation value is produced by comparing the actual abnormality with the third templates or with the fourth templates; and </claim-text>
<claim-text>classifying the actual abnormality as a malignant abnormality when the largest cross-correlation value is produced by comparing the actual abnormality with the third templates and classifying the actual abnormality as a benign abnormality when the largest cross-correlation value is produced by comparing the actual abnormality with the fourth templates. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00011">
<claim-text><highlight><bold>11</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00002">claim 2</dependent-claim-reference>, further comprising: 
<claim-text>obtaining plural third templates and plural fourth templates respectively corresponding to predetermined malignant abnormalities and predetermined benign abnormalities; </claim-text>
<claim-text>comparing an actual abnormality with the obtained third and fourth templates to derive cross-correlation values between the actual abnormality and each of the obtained third and fourth templates; </claim-text>
<claim-text>determining the largest cross-correlation value derived in the preceding comparing step and whether the largest cross-correlation value is produced by comparing the actual abnormality with the third templates or with the fourth templates; and </claim-text>
<claim-text>classifying the actual abnormality as a malignant abnormality when the largest cross-correlation value is produced by comparing the actual abnormality with the third templates and classifying the actual abnormality as a benign abnormality when the largest cross-correlation value is produced by comparing the actual abnormality with the fourth templates. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00012">
<claim-text><highlight><bold>12</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00003">claim 3</dependent-claim-reference>, further comprising: 
<claim-text>obtaining plural third templates and plural fourth templates respectively corresponding to predetermined malignant abnormalities and predetermined benign abnormalities; </claim-text>
<claim-text>comparing an actual abnormality with the obtained third and fourth templates to derive cross-correlation values between the actual abnormality and each of the obtained third and fourth templates; </claim-text>
<claim-text>determining the largest cross-correlation value derived in the preceding comparing step and whether the largest cross-correlation value is produced by comparing the actual abnormality with the third templates or with the fourth templates; and </claim-text>
<claim-text>classifying the actual abnormality as a malignant abnormality when the largest cross-correlation value is produced by comparing the actual abnormality with the third templates and classifying the actual abnormality as a benign abnormality when the largest cross-correlation value is produced by comparing the actual abnormality with the fourth templates. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00013">
<claim-text><highlight><bold>13</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00007">claim 7</dependent-claim-reference>, further comprising: 
<claim-text>obtaining plural third templates and plural fourth templates respectively corresponding to predetermined malignant abnormalities and predetermined benign abnormalities; </claim-text>
<claim-text>comparing the actual abnormality with the obtained third and fourth templates to derive cross-correlation values between the actual abnormality and each of the obtained third and fourth templates; </claim-text>
<claim-text>determining the largest cross-correlation value derived in the preceding comparing step and whether the largest cross-correlation value is produced by comparing the actual abnormality with the third templates or with the fourth templates; and </claim-text>
<claim-text>classifying the actual abnormality as a malignant abnormality when the largest cross-correlation value is produced by comparing the actual abnormality with the third templates and classifying the actual abnormality as a benign abnormality when the largest cross-correlation value is produced by comparing the actual abnormality with the fourth templates. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00014">
<claim-text><highlight><bold>14</bold></highlight>. In a method of classifying an abnormality in a medical digital image, the improvement comprising: 
<claim-text>obtaining plural first templates and plural second templates respectively corresponding to predetermined malignant abnormalities and predetermined benign abnormalities; </claim-text>
<claim-text>comparing the candidate abnormality in the medical digital image with the obtained first and second templates to determine a degree of matching between the candidate abnormality and the first and second templates; and </claim-text>
<claim-text>classifying the candidate abnormality to be a malignant abnormality or a benign abnormality based on whether a best match is obtained by comparing the candidate abnormality with the first template or the second template. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00015">
<claim-text><highlight><bold>15</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 14</dependent-claim-reference>, wherein said step of obtaining plural first templates and plural second templates comprises: 
<claim-text>obtaining plural first templates and plural second templates which are smaller in size than said abnormality in said medical digital image. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00016">
<claim-text><highlight><bold>16</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 15</dependent-claim-reference>, wherein said comparing step comprises: 
<claim-text>comparing the candidate abnormality with the obtained first and second templates to derive cross-correlation values between the candidate abnormality and each of the obtained first and second templates; and </claim-text>
<claim-text>shifting the first and second templates in relation to the abnormality to derive cross-correlation values between the abnormality and each of the shifted first and second templates. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00017">
<claim-text><highlight><bold>17</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 14</dependent-claim-reference>, wherein said step of obtaining plural first templates and plural second templates comprises: 
<claim-text>producing additional first and second templates which are mirror images of the obtained plural first templates and plural second templates. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00018">
<claim-text><highlight><bold>18</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 14</dependent-claim-reference>, wherein said step of obtaining plural first templates and plural second templates comprises: 
<claim-text>producing additional first templates which are scaled versions of the obtained plural first templates. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00019">
<claim-text><highlight><bold>19</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 14</dependent-claim-reference>, wherein said step of obtaining plural first templates and plural second templates comprises: 
<claim-text>producing additional first and second templates which are rotated versions of the obtained plural first templates and plural second templates. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00020">
<claim-text><highlight><bold>20</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 14</dependent-claim-reference>, wherein said step of obtaining plural first templates and plural second templates comprises: 
<claim-text>obtaining candidate first templates and candidate second templates; </claim-text>
<claim-text>comparing the candidate first templates to at least one known benign structure and retaining as first templates only those candidate first templates which exhibit a predetermined degree of non-similarity to the at least one known benign structure; and </claim-text>
<claim-text>comparing the candidate second templates to at least one known malignant structure and retaining as second templates only those candidate second templates which exhibit a predetermined degree of non-similarity to the at least one known malignant structure. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00021">
<claim-text><highlight><bold>21</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00002">claim 2</dependent-claim-reference>, wherein said step of obtaining plural first templates and plural second templates comprises: 
<claim-text>obtaining candidate first templates and candidate second templates; </claim-text>
<claim-text>comparing the candidate first templates to at least one known benign structure and retaining as first templates only those candidate first templates which exhibit a predetermined degree of non-similarity to the at least one known benign structure; and </claim-text>
<claim-text>comparing the candidate second templates to at least one known malignant structure and retaining as second templates only those candidate second templates which exhibit a predetermined degree of non-similarity to the at least one known malignant structure. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00022">
<claim-text><highlight><bold>22</bold></highlight>. The method of <dependent-claim-reference depends_on="CLM-00011">claim 16</dependent-claim-reference>, wherein said step of obtaining plural first templates and plural second templates comprises: 
<claim-text>obtaining candidate first templates and candidate second templates; </claim-text>
<claim-text>comparing the candidate first templates to at least one known benign structure and retaining as first templates only those candidate first templates which exhibit a predetermined degree of non-similarity to the at least one known benign structure; and </claim-text>
<claim-text>comparing the candidate second templates to at least one known malignant structure and retaining as second templates only those candidate second templates which exhibit a predetermined degree of non-similarity to the at least one known malignant structure. </claim-text>
</claim-text>
</claim>
<claim id="CLM-00023">
<claim-text><highlight><bold>23</bold></highlight>. A system for implementing the method of any one of claims <highlight><bold>1</bold></highlight>-<highlight><bold>22</bold></highlight>. </claim-text>
</claim>
<claim id="CLM-00024">
<claim-text><highlight><bold>24</bold></highlight>. A computer readable medium storing a program which when executed by a co</claim-text>
</claim>
</subdoc-claims>
<subdoc-drawings id="DRAWINGS">
<heading lvl="0" align="CENTER">Drawings</heading>
<representative-figure>1</representative-figure>
<figure id="figure-D00000">
<image id="EMI-D00000" file="US20030002723A1-20030102-D00000.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00001">
<image id="EMI-D00001" file="US20030002723A1-20030102-D00001.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00002">
<image id="EMI-D00002" file="US20030002723A1-20030102-D00002.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00003">
<image id="EMI-D00003" file="US20030002723A1-20030102-D00003.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00004">
<image id="EMI-D00004" file="US20030002723A1-20030102-D00004.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00005">
<image id="EMI-D00005" file="US20030002723A1-20030102-D00005.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00006">
<image id="EMI-D00006" file="US20030002723A1-20030102-D00006.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00007">
<image id="EMI-D00007" file="US20030002723A1-20030102-D00007.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00008">
<image id="EMI-D00008" file="US20030002723A1-20030102-D00008.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00009">
<image id="EMI-D00009" file="US20030002723A1-20030102-D00009.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00010">
<image id="EMI-D00010" file="US20030002723A1-20030102-D00010.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00011">
<image id="EMI-D00011" file="US20030002723A1-20030102-D00011.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00012">
<image id="EMI-D00012" file="US20030002723A1-20030102-D00012.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00013">
<image id="EMI-D00013" file="US20030002723A1-20030102-D00013.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00014">
<image id="EMI-D00014" file="US20030002723A1-20030102-D00014.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00015">
<image id="EMI-D00015" file="US20030002723A1-20030102-D00015.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00016">
<image id="EMI-D00016" file="US20030002723A1-20030102-D00016.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00017">
<image id="EMI-D00017" file="US20030002723A1-20030102-D00017.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00018">
<image id="EMI-D00018" file="US20030002723A1-20030102-D00018.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00019">
<image id="EMI-D00019" file="US20030002723A1-20030102-D00019.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00020">
<image id="EMI-D00020" file="US20030002723A1-20030102-D00020.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00021">
<image id="EMI-D00021" file="US20030002723A1-20030102-D00021.TIF" imf="TIFF" ti="DR"/>
</figure>
<figure id="figure-D00022">
<image id="EMI-D00022" file="US20030002723A1-20030102-D00022.TIF" imf="TIFF" ti="DR"/>
</figure>
</subdoc-drawings>
</patent-application-publication>
